var gie=Object.defineProperty;var h5=n=>{throw TypeError(n)};var vie=(n,e,t)=>e in n?gie(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Qe=(n,e,t)=>vie(n,typeof e!="symbol"?e+"":e,t),rR=(n,e,t)=>e.has(n)||h5("Cannot "+t);var g=(n,e,t)=>(rR(n,e,"read from private field"),t?t.call(n):e.get(n)),j=(n,e,t)=>e.has(n)?h5("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),U=(n,e,t,r)=>(rR(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),X=(n,e,t)=>(rR(n,e,"access private method"),t);var Ai=(n,e,t,r)=>({set _(i){U(n,e,i,t)},get _(){return g(n,e,r)}});function yie(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var Nv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function S2(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function xie(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var Pj={exports:{}},A2={},Fj={exports:{}},mn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SS=Symbol.for("react.element"),bie=Symbol.for("react.portal"),_ie=Symbol.for("react.fragment"),wie=Symbol.for("react.strict_mode"),Eie=Symbol.for("react.profiler"),Sie=Symbol.for("react.provider"),Aie=Symbol.for("react.context"),Tie=Symbol.for("react.forward_ref"),Mie=Symbol.for("react.suspense"),Cie=Symbol.for("react.memo"),Die=Symbol.for("react.lazy"),d5=Symbol.iterator;function Nie(n){return n===null||typeof n!="object"?null:(n=d5&&n[d5]||n["@@iterator"],typeof n=="function"?n:null)}var Lj={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Oj=Object.assign,kj={};function Cb(n,e,t){this.props=n,this.context=e,this.refs=kj,this.updater=t||Lj}Cb.prototype.isReactComponent={};Cb.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Cb.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function Bj(){}Bj.prototype=Cb.prototype;function zO(n,e,t){this.props=n,this.context=e,this.refs=kj,this.updater=t||Lj}var $O=zO.prototype=new Bj;$O.constructor=zO;Oj($O,Cb.prototype);$O.isPureReactComponent=!0;var f5=Array.isArray,Uj=Object.prototype.hasOwnProperty,HO={current:null},Vj={key:!0,ref:!0,__self:!0,__source:!0};function zj(n,e,t){var r,i={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)Uj.call(e,r)&&!Vj.hasOwnProperty(r)&&(i[r]=e[r]);var o=arguments.length-2;if(o===1)i.children=t;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(n&&n.defaultProps)for(r in o=n.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:SS,type:n,key:s,ref:a,props:i,_owner:HO.current}}function Rie(n,e){return{$$typeof:SS,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function GO(n){return typeof n=="object"&&n!==null&&n.$$typeof===SS}function Iie(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var p5=/\/+/g;function iR(n,e){return typeof n=="object"&&n!==null&&n.key!=null?Iie(""+n.key):e.toString(36)}function JT(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case SS:case bie:a=!0}}if(a)return a=n,i=i(a),n=r===""?"."+iR(a,0):r,f5(i)?(t="",n!=null&&(t=n.replace(p5,"$&/")+"/"),JT(i,e,t,"",function(u){return u})):i!=null&&(GO(i)&&(i=Rie(i,t+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(p5,"$&/")+"/")+n)),e.push(i)),1;if(a=0,r=r===""?".":r+":",f5(n))for(var o=0;o<n.length;o++){s=n[o];var l=r+iR(s,o);a+=JT(s,e,t,l,i)}else if(l=Nie(n),typeof l=="function")for(n=l.call(n),o=0;!(s=n.next()).done;)s=s.value,l=r+iR(s,o++),a+=JT(s,e,t,l,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function TA(n,e,t){if(n==null)return n;var r=[],i=0;return JT(n,r,"","",function(s){return e.call(t,s,i++)}),r}function Pie(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Da={current:null},eM={transition:null},Fie={ReactCurrentDispatcher:Da,ReactCurrentBatchConfig:eM,ReactCurrentOwner:HO};function $j(){throw Error("act(...) is not supported in production builds of React.")}mn.Children={map:TA,forEach:function(n,e,t){TA(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return TA(n,function(){e++}),e},toArray:function(n){return TA(n,function(e){return e})||[]},only:function(n){if(!GO(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};mn.Component=Cb;mn.Fragment=_ie;mn.Profiler=Eie;mn.PureComponent=zO;mn.StrictMode=wie;mn.Suspense=Mie;mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Fie;mn.act=$j;mn.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=Oj({},n.props),i=n.key,s=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=HO.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var o=n.type.defaultProps;for(l in e)Uj.call(e,l)&&!Vj.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];r.children=o}return{$$typeof:SS,type:n.type,key:i,ref:s,props:r,_owner:a}};mn.createContext=function(n){return n={$$typeof:Aie,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:Sie,_context:n},n.Consumer=n};mn.createElement=zj;mn.createFactory=function(n){var e=zj.bind(null,n);return e.type=n,e};mn.createRef=function(){return{current:null}};mn.forwardRef=function(n){return{$$typeof:Tie,render:n}};mn.isValidElement=GO;mn.lazy=function(n){return{$$typeof:Die,_payload:{_status:-1,_result:n},_init:Pie}};mn.memo=function(n,e){return{$$typeof:Cie,type:n,compare:e===void 0?null:e}};mn.startTransition=function(n){var e=eM.transition;eM.transition={};try{n()}finally{eM.transition=e}};mn.unstable_act=$j;mn.useCallback=function(n,e){return Da.current.useCallback(n,e)};mn.useContext=function(n){return Da.current.useContext(n)};mn.useDebugValue=function(){};mn.useDeferredValue=function(n){return Da.current.useDeferredValue(n)};mn.useEffect=function(n,e){return Da.current.useEffect(n,e)};mn.useId=function(){return Da.current.useId()};mn.useImperativeHandle=function(n,e,t){return Da.current.useImperativeHandle(n,e,t)};mn.useInsertionEffect=function(n,e){return Da.current.useInsertionEffect(n,e)};mn.useLayoutEffect=function(n,e){return Da.current.useLayoutEffect(n,e)};mn.useMemo=function(n,e){return Da.current.useMemo(n,e)};mn.useReducer=function(n,e,t){return Da.current.useReducer(n,e,t)};mn.useRef=function(n){return Da.current.useRef(n)};mn.useState=function(n){return Da.current.useState(n)};mn.useSyncExternalStore=function(n,e,t){return Da.current.useSyncExternalStore(n,e,t)};mn.useTransition=function(){return Da.current.useTransition()};mn.version="18.3.1";Fj.exports=mn;var xe=Fj.exports;const Hj=S2(xe),Lie=yie({__proto__:null,default:Hj},[xe]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oie=xe,kie=Symbol.for("react.element"),Bie=Symbol.for("react.fragment"),Uie=Object.prototype.hasOwnProperty,Vie=Oie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zie={key:!0,ref:!0,__self:!0,__source:!0};function Gj(n,e,t){var r,i={},s=null,a=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)Uie.call(e,r)&&!zie.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:kie,type:n,key:s,ref:a,props:i,_owner:Vie.current}}A2.Fragment=Bie;A2.jsx=Gj;A2.jsxs=Gj;Pj.exports=A2;var k=Pj.exports,sP={},jj={exports:{}},zo={},qj={exports:{}},Wj={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e($,H){var Q=$.length;$.push(H);e:for(;0<Q;){var ee=Q-1>>>1,J=$[ee];if(0<i(J,H))$[ee]=H,$[Q]=J,Q=ee;else break e}}function t($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var H=$[0],Q=$.pop();if(Q!==H){$[0]=Q;e:for(var ee=0,J=$.length,L=J>>>1;ee<L;){var se=2*(ee+1)-1,Z=$[se],le=se+1,ue=$[le];if(0>i(Z,Q))le<J&&0>i(ue,Z)?($[ee]=ue,$[le]=Q,ee=le):($[ee]=Z,$[se]=Q,ee=se);else if(le<J&&0>i(ue,Q))$[ee]=ue,$[le]=Q,ee=le;else break e}}return H}function i($,H){var Q=$.sortIndex-H.sortIndex;return Q!==0?Q:$.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],u=[],c=1,h=null,d=3,f=!1,p=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x($){for(var H=t(u);H!==null;){if(H.callback===null)r(u);else if(H.startTime<=$)r(u),H.sortIndex=H.expirationTime,e(l,H);else break;H=t(u)}}function w($){if(m=!1,x($),!p)if(t(l)!==null)p=!0,I(_);else{var H=t(u);H!==null&&B(w,H.startTime-$)}}function _($,H){p=!1,m&&(m=!1,v(T),T=-1),f=!0;var Q=d;try{for(x(H),h=t(l);h!==null&&(!(h.expirationTime>H)||$&&!D());){var ee=h.callback;if(typeof ee=="function"){h.callback=null,d=h.priorityLevel;var J=ee(h.expirationTime<=H);H=n.unstable_now(),typeof J=="function"?h.callback=J:h===t(l)&&r(l),x(H)}else r(l);h=t(l)}if(h!==null)var L=!0;else{var se=t(u);se!==null&&B(w,se.startTime-H),L=!1}return L}finally{h=null,d=Q,f=!1}}var E=!1,A=null,T=-1,S=5,M=-1;function D(){return!(n.unstable_now()-M<S)}function N(){if(A!==null){var $=n.unstable_now();M=$;var H=!0;try{H=A(!0,$)}finally{H?R():(E=!1,A=null)}}else E=!1}var R;if(typeof b=="function")R=function(){b(N)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,G=O.port2;O.port1.onmessage=N,R=function(){G.postMessage(null)}}else R=function(){y(N,0)};function I($){A=$,E||(E=!0,R())}function B($,H){T=y(function(){$(n.unstable_now())},H)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_continueExecution=function(){p||f||(p=!0,I(_))},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return d},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function($){switch(d){case 1:case 2:case 3:var H=3;break;default:H=d}var Q=d;d=H;try{return $()}finally{d=Q}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function($,H){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var Q=d;d=$;try{return H()}finally{d=Q}},n.unstable_scheduleCallback=function($,H,Q){var ee=n.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?ee+Q:ee):Q=ee,$){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=Q+J,$={id:c++,callback:H,priorityLevel:$,startTime:Q,expirationTime:J,sortIndex:-1},Q>ee?($.sortIndex=Q,e(u,$),t(l)===null&&$===t(u)&&(m?(v(T),T=-1):m=!0,B(w,Q-ee))):($.sortIndex=J,e(l,$),p||f||(p=!0,I(_))),$},n.unstable_shouldYield=D,n.unstable_wrapCallback=function($){var H=d;return function(){var Q=d;d=H;try{return $.apply(this,arguments)}finally{d=Q}}}})(Wj);qj.exports=Wj;var $ie=qj.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hie=xe,Uo=$ie;function et(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Xj=new Set,B1={};function Rv(n,e){eb(n,e),eb(n+"Capture",e)}function eb(n,e){for(B1[n]=e,n=0;n<e.length;n++)Xj.add(e[n])}var nd=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),aP=Object.prototype.hasOwnProperty,Gie=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m5={},g5={};function jie(n){return aP.call(g5,n)?!0:aP.call(m5,n)?!1:Gie.test(n)?g5[n]=!0:(m5[n]=!0,!1)}function qie(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function Wie(n,e,t,r){if(e===null||typeof e>"u"||qie(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Na(n,e,t,r,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Ds={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Ds[n]=new Na(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Ds[e]=new Na(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Ds[n]=new Na(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Ds[n]=new Na(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Ds[n]=new Na(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Ds[n]=new Na(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Ds[n]=new Na(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Ds[n]=new Na(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Ds[n]=new Na(n,5,!1,n.toLowerCase(),null,!1,!1)});var jO=/[\-:]([a-z])/g;function qO(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(jO,qO);Ds[e]=new Na(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(jO,qO);Ds[e]=new Na(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(jO,qO);Ds[e]=new Na(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Ds[n]=new Na(n,1,!1,n.toLowerCase(),null,!1,!1)});Ds.xlinkHref=new Na("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Ds[n]=new Na(n,1,!1,n.toLowerCase(),null,!0,!0)});function WO(n,e,t,r){var i=Ds.hasOwnProperty(e)?Ds[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Wie(e,t,i,r)&&(t=null),r||i===null?jie(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var _d=Hie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,MA=Symbol.for("react.element"),U0=Symbol.for("react.portal"),V0=Symbol.for("react.fragment"),XO=Symbol.for("react.strict_mode"),oP=Symbol.for("react.profiler"),Kj=Symbol.for("react.provider"),Yj=Symbol.for("react.context"),KO=Symbol.for("react.forward_ref"),lP=Symbol.for("react.suspense"),uP=Symbol.for("react.suspense_list"),YO=Symbol.for("react.memo"),qd=Symbol.for("react.lazy"),Qj=Symbol.for("react.offscreen"),v5=Symbol.iterator;function l_(n){return n===null||typeof n!="object"?null:(n=v5&&n[v5]||n["@@iterator"],typeof n=="function"?n:null)}var zr=Object.assign,sR;function F_(n){if(sR===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);sR=e&&e[1]||""}return`
`+sR+n}var aR=!1;function oR(n,e){if(!n||aR)return"";aR=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){r=u}n.call(e.prototype)}else{try{throw Error()}catch(u){r=u}n()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=a&&0<=o);break}}}finally{aR=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?F_(n):""}function Xie(n){switch(n.tag){case 5:return F_(n.type);case 16:return F_("Lazy");case 13:return F_("Suspense");case 19:return F_("SuspenseList");case 0:case 2:case 15:return n=oR(n.type,!1),n;case 11:return n=oR(n.type.render,!1),n;case 1:return n=oR(n.type,!0),n;default:return""}}function cP(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case V0:return"Fragment";case U0:return"Portal";case oP:return"Profiler";case XO:return"StrictMode";case lP:return"Suspense";case uP:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Yj:return(n.displayName||"Context")+".Consumer";case Kj:return(n._context.displayName||"Context")+".Provider";case KO:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case YO:return e=n.displayName||null,e!==null?e:cP(n.type)||"Memo";case qd:e=n._payload,n=n._init;try{return cP(n(e))}catch{}}return null}function Kie(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cP(e);case 8:return e===XO?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function vp(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Zj(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Yie(n){var e=Zj(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function CA(n){n._valueTracker||(n._valueTracker=Yie(n))}function Jj(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=Zj(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function mC(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function hP(n,e){var t=e.checked;return zr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function y5(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=vp(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function eq(n,e){e=e.checked,e!=null&&WO(n,"checked",e,!1)}function dP(n,e){eq(n,e);var t=vp(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?fP(n,e.type,t):e.hasOwnProperty("defaultValue")&&fP(n,e.type,vp(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function x5(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function fP(n,e,t){(e!=="number"||mC(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var L_=Array.isArray;function dy(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+vp(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function pP(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(et(91));return zr({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function b5(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(et(92));if(L_(t)){if(1<t.length)throw Error(et(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:vp(t)}}function tq(n,e){var t=vp(e.value),r=vp(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function _5(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function nq(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function mP(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?nq(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var DA,rq=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(DA=DA||document.createElement("div"),DA.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=DA.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function U1(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var g1={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Qie=["Webkit","ms","Moz","O"];Object.keys(g1).forEach(function(n){Qie.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),g1[e]=g1[n]})});function iq(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||g1.hasOwnProperty(n)&&g1[n]?(""+e).trim():e+"px"}function sq(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=iq(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var Zie=zr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gP(n,e){if(e){if(Zie[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(et(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(et(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(et(61))}if(e.style!=null&&typeof e.style!="object")throw Error(et(62))}}function vP(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yP=null;function QO(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var xP=null,fy=null,py=null;function w5(n){if(n=MS(n)){if(typeof xP!="function")throw Error(et(280));var e=n.stateNode;e&&(e=N2(e),xP(n.stateNode,n.type,e))}}function aq(n){fy?py?py.push(n):py=[n]:fy=n}function oq(){if(fy){var n=fy,e=py;if(py=fy=null,w5(n),e)for(n=0;n<e.length;n++)w5(e[n])}}function lq(n,e){return n(e)}function uq(){}var lR=!1;function cq(n,e,t){if(lR)return n(e,t);lR=!0;try{return lq(n,e,t)}finally{lR=!1,(fy!==null||py!==null)&&(uq(),oq())}}function V1(n,e){var t=n.stateNode;if(t===null)return null;var r=N2(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(et(231,e,typeof t));return t}var bP=!1;if(nd)try{var u_={};Object.defineProperty(u_,"passive",{get:function(){bP=!0}}),window.addEventListener("test",u_,u_),window.removeEventListener("test",u_,u_)}catch{bP=!1}function Jie(n,e,t,r,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var v1=!1,gC=null,vC=!1,_P=null,ese={onError:function(n){v1=!0,gC=n}};function tse(n,e,t,r,i,s,a,o,l){v1=!1,gC=null,Jie.apply(ese,arguments)}function nse(n,e,t,r,i,s,a,o,l){if(tse.apply(this,arguments),v1){if(v1){var u=gC;v1=!1,gC=null}else throw Error(et(198));vC||(vC=!0,_P=u)}}function Iv(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function hq(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function E5(n){if(Iv(n)!==n)throw Error(et(188))}function rse(n){var e=n.alternate;if(!e){if(e=Iv(n),e===null)throw Error(et(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return E5(i),n;if(s===r)return E5(i),e;s=s.sibling}throw Error(et(188))}if(t.return!==r.return)t=i,r=s;else{for(var a=!1,o=i.child;o;){if(o===t){a=!0,t=i,r=s;break}if(o===r){a=!0,r=i,t=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===t){a=!0,t=s,r=i;break}if(o===r){a=!0,r=s,t=i;break}o=o.sibling}if(!a)throw Error(et(189))}}if(t.alternate!==r)throw Error(et(190))}if(t.tag!==3)throw Error(et(188));return t.stateNode.current===t?n:e}function dq(n){return n=rse(n),n!==null?fq(n):null}function fq(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=fq(n);if(e!==null)return e;n=n.sibling}return null}var pq=Uo.unstable_scheduleCallback,S5=Uo.unstable_cancelCallback,ise=Uo.unstable_shouldYield,sse=Uo.unstable_requestPaint,ui=Uo.unstable_now,ase=Uo.unstable_getCurrentPriorityLevel,ZO=Uo.unstable_ImmediatePriority,mq=Uo.unstable_UserBlockingPriority,yC=Uo.unstable_NormalPriority,ose=Uo.unstable_LowPriority,gq=Uo.unstable_IdlePriority,T2=null,uc=null;function lse(n){if(uc&&typeof uc.onCommitFiberRoot=="function")try{uc.onCommitFiberRoot(T2,n,void 0,(n.current.flags&128)===128)}catch{}}var cu=Math.clz32?Math.clz32:hse,use=Math.log,cse=Math.LN2;function hse(n){return n>>>=0,n===0?32:31-(use(n)/cse|0)|0}var NA=64,RA=4194304;function O_(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function xC(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,a=t&268435455;if(a!==0){var o=a&~i;o!==0?r=O_(o):(s&=a,s!==0&&(r=O_(s)))}else a=t&~i,a!==0?r=O_(a):s!==0&&(r=O_(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-cu(e),i=1<<t,r|=n[t],e&=~i;return r}function dse(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fse(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var a=31-cu(s),o=1<<a,l=i[a];l===-1?(!(o&t)||o&r)&&(i[a]=dse(o,e)):l<=e&&(n.expiredLanes|=o),s&=~o}}function wP(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function vq(){var n=NA;return NA<<=1,!(NA&4194240)&&(NA=64),n}function uR(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function AS(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-cu(e),n[e]=t}function pse(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-cu(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function JO(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-cu(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var Qn=0;function yq(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var xq,ek,bq,_q,wq,EP=!1,IA=[],rp=null,ip=null,sp=null,z1=new Map,$1=new Map,Yd=[],mse="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function A5(n,e){switch(n){case"focusin":case"focusout":rp=null;break;case"dragenter":case"dragleave":ip=null;break;case"mouseover":case"mouseout":sp=null;break;case"pointerover":case"pointerout":z1.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":$1.delete(e.pointerId)}}function c_(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=MS(e),e!==null&&ek(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function gse(n,e,t,r,i){switch(e){case"focusin":return rp=c_(rp,n,e,t,r,i),!0;case"dragenter":return ip=c_(ip,n,e,t,r,i),!0;case"mouseover":return sp=c_(sp,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return z1.set(s,c_(z1.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,$1.set(s,c_($1.get(s)||null,n,e,t,r,i)),!0}return!1}function Eq(n){var e=Lm(n.target);if(e!==null){var t=Iv(e);if(t!==null){if(e=t.tag,e===13){if(e=hq(t),e!==null){n.blockedOn=e,wq(n.priority,function(){bq(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function tM(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=SP(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);yP=r,t.target.dispatchEvent(r),yP=null}else return e=MS(t),e!==null&&ek(e),n.blockedOn=t,!1;e.shift()}return!0}function T5(n,e,t){tM(n)&&t.delete(e)}function vse(){EP=!1,rp!==null&&tM(rp)&&(rp=null),ip!==null&&tM(ip)&&(ip=null),sp!==null&&tM(sp)&&(sp=null),z1.forEach(T5),$1.forEach(T5)}function h_(n,e){n.blockedOn===e&&(n.blockedOn=null,EP||(EP=!0,Uo.unstable_scheduleCallback(Uo.unstable_NormalPriority,vse)))}function H1(n){function e(i){return h_(i,n)}if(0<IA.length){h_(IA[0],n);for(var t=1;t<IA.length;t++){var r=IA[t];r.blockedOn===n&&(r.blockedOn=null)}}for(rp!==null&&h_(rp,n),ip!==null&&h_(ip,n),sp!==null&&h_(sp,n),z1.forEach(e),$1.forEach(e),t=0;t<Yd.length;t++)r=Yd[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Yd.length&&(t=Yd[0],t.blockedOn===null);)Eq(t),t.blockedOn===null&&Yd.shift()}var my=_d.ReactCurrentBatchConfig,bC=!0;function yse(n,e,t,r){var i=Qn,s=my.transition;my.transition=null;try{Qn=1,tk(n,e,t,r)}finally{Qn=i,my.transition=s}}function xse(n,e,t,r){var i=Qn,s=my.transition;my.transition=null;try{Qn=4,tk(n,e,t,r)}finally{Qn=i,my.transition=s}}function tk(n,e,t,r){if(bC){var i=SP(n,e,t,r);if(i===null)xR(n,e,r,_C,t),A5(n,r);else if(gse(i,n,e,t,r))r.stopPropagation();else if(A5(n,r),e&4&&-1<mse.indexOf(n)){for(;i!==null;){var s=MS(i);if(s!==null&&xq(s),s=SP(n,e,t,r),s===null&&xR(n,e,r,_C,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else xR(n,e,r,null,t)}}var _C=null;function SP(n,e,t,r){if(_C=null,n=QO(r),n=Lm(n),n!==null)if(e=Iv(n),e===null)n=null;else if(t=e.tag,t===13){if(n=hq(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return _C=n,null}function Sq(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ase()){case ZO:return 1;case mq:return 4;case yC:case ose:return 16;case gq:return 536870912;default:return 16}default:return 16}}var Yf=null,nk=null,nM=null;function Aq(){if(nM)return nM;var n,e=nk,t=e.length,r,i="value"in Yf?Yf.value:Yf.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var a=t-n;for(r=1;r<=a&&e[t-r]===i[s-r];r++);return nM=i.slice(n,1<r?1-r:void 0)}function rM(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function PA(){return!0}function M5(){return!1}function $o(n){function e(t,r,i,s,a){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?PA:M5,this.isPropagationStopped=M5,this}return zr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=PA)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=PA)},persist:function(){},isPersistent:PA}),e}var Db={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rk=$o(Db),TS=zr({},Db,{view:0,detail:0}),bse=$o(TS),cR,hR,d_,M2=zr({},TS,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ik,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==d_&&(d_&&n.type==="mousemove"?(cR=n.screenX-d_.screenX,hR=n.screenY-d_.screenY):hR=cR=0,d_=n),cR)},movementY:function(n){return"movementY"in n?n.movementY:hR}}),C5=$o(M2),_se=zr({},M2,{dataTransfer:0}),wse=$o(_se),Ese=zr({},TS,{relatedTarget:0}),dR=$o(Ese),Sse=zr({},Db,{animationName:0,elapsedTime:0,pseudoElement:0}),Ase=$o(Sse),Tse=zr({},Db,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Mse=$o(Tse),Cse=zr({},Db,{data:0}),D5=$o(Cse),Dse={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nse={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Rse={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ise(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=Rse[n])?!!e[n]:!1}function ik(){return Ise}var Pse=zr({},TS,{key:function(n){if(n.key){var e=Dse[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=rM(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Nse[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ik,charCode:function(n){return n.type==="keypress"?rM(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?rM(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Fse=$o(Pse),Lse=zr({},M2,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),N5=$o(Lse),Ose=zr({},TS,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ik}),kse=$o(Ose),Bse=zr({},Db,{propertyName:0,elapsedTime:0,pseudoElement:0}),Use=$o(Bse),Vse=zr({},M2,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),zse=$o(Vse),$se=[9,13,27,32],sk=nd&&"CompositionEvent"in window,y1=null;nd&&"documentMode"in document&&(y1=document.documentMode);var Hse=nd&&"TextEvent"in window&&!y1,Tq=nd&&(!sk||y1&&8<y1&&11>=y1),R5=" ",I5=!1;function Mq(n,e){switch(n){case"keyup":return $se.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Cq(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var z0=!1;function Gse(n,e){switch(n){case"compositionend":return Cq(e);case"keypress":return e.which!==32?null:(I5=!0,R5);case"textInput":return n=e.data,n===R5&&I5?null:n;default:return null}}function jse(n,e){if(z0)return n==="compositionend"||!sk&&Mq(n,e)?(n=Aq(),nM=nk=Yf=null,z0=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Tq&&e.locale!=="ko"?null:e.data;default:return null}}var qse={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function P5(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!qse[n.type]:e==="textarea"}function Dq(n,e,t,r){aq(r),e=wC(e,"onChange"),0<e.length&&(t=new rk("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var x1=null,G1=null;function Wse(n){Vq(n,0)}function C2(n){var e=G0(n);if(Jj(e))return n}function Xse(n,e){if(n==="change")return e}var Nq=!1;if(nd){var fR;if(nd){var pR="oninput"in document;if(!pR){var F5=document.createElement("div");F5.setAttribute("oninput","return;"),pR=typeof F5.oninput=="function"}fR=pR}else fR=!1;Nq=fR&&(!document.documentMode||9<document.documentMode)}function L5(){x1&&(x1.detachEvent("onpropertychange",Rq),G1=x1=null)}function Rq(n){if(n.propertyName==="value"&&C2(G1)){var e=[];Dq(e,G1,n,QO(n)),cq(Wse,e)}}function Kse(n,e,t){n==="focusin"?(L5(),x1=e,G1=t,x1.attachEvent("onpropertychange",Rq)):n==="focusout"&&L5()}function Yse(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return C2(G1)}function Qse(n,e){if(n==="click")return C2(e)}function Zse(n,e){if(n==="input"||n==="change")return C2(e)}function Jse(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var fu=typeof Object.is=="function"?Object.is:Jse;function j1(n,e){if(fu(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!aP.call(e,i)||!fu(n[i],e[i]))return!1}return!0}function O5(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function k5(n,e){var t=O5(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=O5(t)}}function Iq(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?Iq(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function Pq(){for(var n=window,e=mC();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=mC(n.document)}return e}function ak(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function eae(n){var e=Pq(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&Iq(t.ownerDocument.documentElement,t)){if(r!==null&&ak(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=k5(t,s);var a=k5(t,r);i&&a&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var tae=nd&&"documentMode"in document&&11>=document.documentMode,$0=null,AP=null,b1=null,TP=!1;function B5(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;TP||$0==null||$0!==mC(r)||(r=$0,"selectionStart"in r&&ak(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),b1&&j1(b1,r)||(b1=r,r=wC(AP,"onSelect"),0<r.length&&(e=new rk("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=$0)))}function FA(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var H0={animationend:FA("Animation","AnimationEnd"),animationiteration:FA("Animation","AnimationIteration"),animationstart:FA("Animation","AnimationStart"),transitionend:FA("Transition","TransitionEnd")},mR={},Fq={};nd&&(Fq=document.createElement("div").style,"AnimationEvent"in window||(delete H0.animationend.animation,delete H0.animationiteration.animation,delete H0.animationstart.animation),"TransitionEvent"in window||delete H0.transitionend.transition);function D2(n){if(mR[n])return mR[n];if(!H0[n])return n;var e=H0[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in Fq)return mR[n]=e[t];return n}var Lq=D2("animationend"),Oq=D2("animationiteration"),kq=D2("animationstart"),Bq=D2("transitionend"),Uq=new Map,U5="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bp(n,e){Uq.set(n,e),Rv(e,[n])}for(var gR=0;gR<U5.length;gR++){var vR=U5[gR],nae=vR.toLowerCase(),rae=vR[0].toUpperCase()+vR.slice(1);Bp(nae,"on"+rae)}Bp(Lq,"onAnimationEnd");Bp(Oq,"onAnimationIteration");Bp(kq,"onAnimationStart");Bp("dblclick","onDoubleClick");Bp("focusin","onFocus");Bp("focusout","onBlur");Bp(Bq,"onTransitionEnd");eb("onMouseEnter",["mouseout","mouseover"]);eb("onMouseLeave",["mouseout","mouseover"]);eb("onPointerEnter",["pointerout","pointerover"]);eb("onPointerLeave",["pointerout","pointerover"]);Rv("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Rv("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Rv("onBeforeInput",["compositionend","keypress","textInput","paste"]);Rv("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Rv("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Rv("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var k_="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iae=new Set("cancel close invalid load scroll toggle".split(" ").concat(k_));function V5(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,nse(r,e,void 0,n),n.currentTarget=null}function Vq(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;V5(i,o,u),s=l}else for(a=0;a<r.length;a++){if(o=r[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;V5(i,o,u),s=l}}}if(vC)throw n=_P,vC=!1,_P=null,n}function _r(n,e){var t=e[RP];t===void 0&&(t=e[RP]=new Set);var r=n+"__bubble";t.has(r)||(zq(e,n,2,!1),t.add(r))}function yR(n,e,t){var r=0;e&&(r|=4),zq(t,n,r,e)}var LA="_reactListening"+Math.random().toString(36).slice(2);function q1(n){if(!n[LA]){n[LA]=!0,Xj.forEach(function(t){t!=="selectionchange"&&(iae.has(t)||yR(t,!1,n),yR(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[LA]||(e[LA]=!0,yR("selectionchange",!1,e))}}function zq(n,e,t,r){switch(Sq(e)){case 1:var i=yse;break;case 4:i=xse;break;default:i=tk}t=i.bind(null,e,t,n),i=void 0,!bP||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function xR(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Lm(o),a===null)return;if(l=a.tag,l===5||l===6){r=s=a;continue e}o=o.parentNode}}r=r.return}cq(function(){var u=s,c=QO(t),h=[];e:{var d=Uq.get(n);if(d!==void 0){var f=rk,p=n;switch(n){case"keypress":if(rM(t)===0)break e;case"keydown":case"keyup":f=Fse;break;case"focusin":p="focus",f=dR;break;case"focusout":p="blur",f=dR;break;case"beforeblur":case"afterblur":f=dR;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=C5;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=wse;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=kse;break;case Lq:case Oq:case kq:f=Ase;break;case Bq:f=Use;break;case"scroll":f=bse;break;case"wheel":f=zse;break;case"copy":case"cut":case"paste":f=Mse;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=N5}var m=(e&4)!==0,y=!m&&n==="scroll",v=m?d!==null?d+"Capture":null:d;m=[];for(var b=u,x;b!==null;){x=b;var w=x.stateNode;if(x.tag===5&&w!==null&&(x=w,v!==null&&(w=V1(b,v),w!=null&&m.push(W1(b,w,x)))),y)break;b=b.return}0<m.length&&(d=new f(d,p,null,t,c),h.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=n==="mouseover"||n==="pointerover",f=n==="mouseout"||n==="pointerout",d&&t!==yP&&(p=t.relatedTarget||t.fromElement)&&(Lm(p)||p[rd]))break e;if((f||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=t.relatedTarget||t.toElement,f=u,p=p?Lm(p):null,p!==null&&(y=Iv(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=u),f!==p)){if(m=C5,w="onMouseLeave",v="onMouseEnter",b="mouse",(n==="pointerout"||n==="pointerover")&&(m=N5,w="onPointerLeave",v="onPointerEnter",b="pointer"),y=f==null?d:G0(f),x=p==null?d:G0(p),d=new m(w,b+"leave",f,t,c),d.target=y,d.relatedTarget=x,w=null,Lm(c)===u&&(m=new m(v,b+"enter",p,t,c),m.target=x,m.relatedTarget=y,w=m),y=w,f&&p)t:{for(m=f,v=p,b=0,x=m;x;x=r0(x))b++;for(x=0,w=v;w;w=r0(w))x++;for(;0<b-x;)m=r0(m),b--;for(;0<x-b;)v=r0(v),x--;for(;b--;){if(m===v||v!==null&&m===v.alternate)break t;m=r0(m),v=r0(v)}m=null}else m=null;f!==null&&z5(h,d,f,m,!1),p!==null&&y!==null&&z5(h,y,p,m,!0)}}e:{if(d=u?G0(u):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var _=Xse;else if(P5(d))if(Nq)_=Zse;else{_=Yse;var E=Kse}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(_=Qse);if(_&&(_=_(n,u))){Dq(h,_,t,c);break e}E&&E(n,d,u),n==="focusout"&&(E=d._wrapperState)&&E.controlled&&d.type==="number"&&fP(d,"number",d.value)}switch(E=u?G0(u):window,n){case"focusin":(P5(E)||E.contentEditable==="true")&&($0=E,AP=u,b1=null);break;case"focusout":b1=AP=$0=null;break;case"mousedown":TP=!0;break;case"contextmenu":case"mouseup":case"dragend":TP=!1,B5(h,t,c);break;case"selectionchange":if(tae)break;case"keydown":case"keyup":B5(h,t,c)}var A;if(sk)e:{switch(n){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else z0?Mq(n,t)&&(T="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(T="onCompositionStart");T&&(Tq&&t.locale!=="ko"&&(z0||T!=="onCompositionStart"?T==="onCompositionEnd"&&z0&&(A=Aq()):(Yf=c,nk="value"in Yf?Yf.value:Yf.textContent,z0=!0)),E=wC(u,T),0<E.length&&(T=new D5(T,n,null,t,c),h.push({event:T,listeners:E}),A?T.data=A:(A=Cq(t),A!==null&&(T.data=A)))),(A=Hse?Gse(n,t):jse(n,t))&&(u=wC(u,"onBeforeInput"),0<u.length&&(c=new D5("onBeforeInput","beforeinput",null,t,c),h.push({event:c,listeners:u}),c.data=A))}Vq(h,e)})}function W1(n,e,t){return{instance:n,listener:e,currentTarget:t}}function wC(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=V1(n,t),s!=null&&r.unshift(W1(n,s,i)),s=V1(n,e),s!=null&&r.push(W1(n,s,i))),n=n.return}return r}function r0(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function z5(n,e,t,r,i){for(var s=e._reactName,a=[];t!==null&&t!==r;){var o=t,l=o.alternate,u=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&u!==null&&(o=u,i?(l=V1(t,s),l!=null&&a.unshift(W1(t,l,o))):i||(l=V1(t,s),l!=null&&a.push(W1(t,l,o)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var sae=/\r\n?/g,aae=/\u0000|\uFFFD/g;function $5(n){return(typeof n=="string"?n:""+n).replace(sae,`
`).replace(aae,"")}function OA(n,e,t){if(e=$5(e),$5(n)!==e&&t)throw Error(et(425))}function EC(){}var MP=null,CP=null;function DP(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var NP=typeof setTimeout=="function"?setTimeout:void 0,oae=typeof clearTimeout=="function"?clearTimeout:void 0,H5=typeof Promise=="function"?Promise:void 0,lae=typeof queueMicrotask=="function"?queueMicrotask:typeof H5<"u"?function(n){return H5.resolve(null).then(n).catch(uae)}:NP;function uae(n){setTimeout(function(){throw n})}function bR(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),H1(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);H1(e)}function ap(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function G5(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Nb=Math.random().toString(36).slice(2),ic="__reactFiber$"+Nb,X1="__reactProps$"+Nb,rd="__reactContainer$"+Nb,RP="__reactEvents$"+Nb,cae="__reactListeners$"+Nb,hae="__reactHandles$"+Nb;function Lm(n){var e=n[ic];if(e)return e;for(var t=n.parentNode;t;){if(e=t[rd]||t[ic]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=G5(n);n!==null;){if(t=n[ic])return t;n=G5(n)}return e}n=t,t=n.parentNode}return null}function MS(n){return n=n[ic]||n[rd],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function G0(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(et(33))}function N2(n){return n[X1]||null}var IP=[],j0=-1;function Up(n){return{current:n}}function Sr(n){0>j0||(n.current=IP[j0],IP[j0]=null,j0--)}function xr(n,e){j0++,IP[j0]=n.current,n.current=e}var yp={},ta=Up(yp),Ya=Up(!1),pv=yp;function tb(n,e){var t=n.type.contextTypes;if(!t)return yp;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function Qa(n){return n=n.childContextTypes,n!=null}function SC(){Sr(Ya),Sr(ta)}function j5(n,e,t){if(ta.current!==yp)throw Error(et(168));xr(ta,e),xr(Ya,t)}function $q(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(et(108,Kie(n)||"Unknown",i));return zr({},t,r)}function AC(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||yp,pv=ta.current,xr(ta,n),xr(Ya,Ya.current),!0}function q5(n,e,t){var r=n.stateNode;if(!r)throw Error(et(169));t?(n=$q(n,e,pv),r.__reactInternalMemoizedMergedChildContext=n,Sr(Ya),Sr(ta),xr(ta,n)):Sr(Ya),xr(Ya,t)}var th=null,R2=!1,_R=!1;function Hq(n){th===null?th=[n]:th.push(n)}function dae(n){R2=!0,Hq(n)}function Vp(){if(!_R&&th!==null){_R=!0;var n=0,e=Qn;try{var t=th;for(Qn=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}th=null,R2=!1}catch(i){throw th!==null&&(th=th.slice(n+1)),pq(ZO,Vp),i}finally{Qn=e,_R=!1}}return null}var q0=[],W0=0,TC=null,MC=0,pl=[],ml=0,mv=null,Bh=1,Uh="";function bm(n,e){q0[W0++]=MC,q0[W0++]=TC,TC=n,MC=e}function Gq(n,e,t){pl[ml++]=Bh,pl[ml++]=Uh,pl[ml++]=mv,mv=n;var r=Bh;n=Uh;var i=32-cu(r)-1;r&=~(1<<i),t+=1;var s=32-cu(e)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Bh=1<<32-cu(e)+i|t<<i|r,Uh=s+n}else Bh=1<<s|t<<i|r,Uh=n}function ok(n){n.return!==null&&(bm(n,1),Gq(n,1,0))}function lk(n){for(;n===TC;)TC=q0[--W0],q0[W0]=null,MC=q0[--W0],q0[W0]=null;for(;n===mv;)mv=pl[--ml],pl[ml]=null,Uh=pl[--ml],pl[ml]=null,Bh=pl[--ml],pl[ml]=null}var ko=null,Lo=null,Nr=!1,ru=null;function jq(n,e){var t=xl(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function W5(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,ko=n,Lo=ap(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,ko=n,Lo=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=mv!==null?{id:Bh,overflow:Uh}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=xl(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,ko=n,Lo=null,!0):!1;default:return!1}}function PP(n){return(n.mode&1)!==0&&(n.flags&128)===0}function FP(n){if(Nr){var e=Lo;if(e){var t=e;if(!W5(n,e)){if(PP(n))throw Error(et(418));e=ap(t.nextSibling);var r=ko;e&&W5(n,e)?jq(r,t):(n.flags=n.flags&-4097|2,Nr=!1,ko=n)}}else{if(PP(n))throw Error(et(418));n.flags=n.flags&-4097|2,Nr=!1,ko=n}}}function X5(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;ko=n}function kA(n){if(n!==ko)return!1;if(!Nr)return X5(n),Nr=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!DP(n.type,n.memoizedProps)),e&&(e=Lo)){if(PP(n))throw qq(),Error(et(418));for(;e;)jq(n,e),e=ap(e.nextSibling)}if(X5(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(et(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Lo=ap(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Lo=null}}else Lo=ko?ap(n.stateNode.nextSibling):null;return!0}function qq(){for(var n=Lo;n;)n=ap(n.nextSibling)}function nb(){Lo=ko=null,Nr=!1}function uk(n){ru===null?ru=[n]:ru.push(n)}var fae=_d.ReactCurrentBatchConfig;function f_(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(et(309));var r=t.stateNode}if(!r)throw Error(et(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof n!="string")throw Error(et(284));if(!t._owner)throw Error(et(290,n))}return n}function BA(n,e){throw n=Object.prototype.toString.call(e),Error(et(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function K5(n){var e=n._init;return e(n._payload)}function Wq(n){function e(v,b){if(n){var x=v.deletions;x===null?(v.deletions=[b],v.flags|=16):x.push(b)}}function t(v,b){if(!n)return null;for(;b!==null;)e(v,b),b=b.sibling;return null}function r(v,b){for(v=new Map;b!==null;)b.key!==null?v.set(b.key,b):v.set(b.index,b),b=b.sibling;return v}function i(v,b){return v=cp(v,b),v.index=0,v.sibling=null,v}function s(v,b,x){return v.index=x,n?(x=v.alternate,x!==null?(x=x.index,x<b?(v.flags|=2,b):x):(v.flags|=2,b)):(v.flags|=1048576,b)}function a(v){return n&&v.alternate===null&&(v.flags|=2),v}function o(v,b,x,w){return b===null||b.tag!==6?(b=CR(x,v.mode,w),b.return=v,b):(b=i(b,x),b.return=v,b)}function l(v,b,x,w){var _=x.type;return _===V0?c(v,b,x.props.children,w,x.key):b!==null&&(b.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===qd&&K5(_)===b.type)?(w=i(b,x.props),w.ref=f_(v,b,x),w.return=v,w):(w=cM(x.type,x.key,x.props,null,v.mode,w),w.ref=f_(v,b,x),w.return=v,w)}function u(v,b,x,w){return b===null||b.tag!==4||b.stateNode.containerInfo!==x.containerInfo||b.stateNode.implementation!==x.implementation?(b=DR(x,v.mode,w),b.return=v,b):(b=i(b,x.children||[]),b.return=v,b)}function c(v,b,x,w,_){return b===null||b.tag!==7?(b=ov(x,v.mode,w,_),b.return=v,b):(b=i(b,x),b.return=v,b)}function h(v,b,x){if(typeof b=="string"&&b!==""||typeof b=="number")return b=CR(""+b,v.mode,x),b.return=v,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case MA:return x=cM(b.type,b.key,b.props,null,v.mode,x),x.ref=f_(v,null,b),x.return=v,x;case U0:return b=DR(b,v.mode,x),b.return=v,b;case qd:var w=b._init;return h(v,w(b._payload),x)}if(L_(b)||l_(b))return b=ov(b,v.mode,x,null),b.return=v,b;BA(v,b)}return null}function d(v,b,x,w){var _=b!==null?b.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return _!==null?null:o(v,b,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case MA:return x.key===_?l(v,b,x,w):null;case U0:return x.key===_?u(v,b,x,w):null;case qd:return _=x._init,d(v,b,_(x._payload),w)}if(L_(x)||l_(x))return _!==null?null:c(v,b,x,w,null);BA(v,x)}return null}function f(v,b,x,w,_){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(x)||null,o(b,v,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case MA:return v=v.get(w.key===null?x:w.key)||null,l(b,v,w,_);case U0:return v=v.get(w.key===null?x:w.key)||null,u(b,v,w,_);case qd:var E=w._init;return f(v,b,x,E(w._payload),_)}if(L_(w)||l_(w))return v=v.get(x)||null,c(b,v,w,_,null);BA(b,w)}return null}function p(v,b,x,w){for(var _=null,E=null,A=b,T=b=0,S=null;A!==null&&T<x.length;T++){A.index>T?(S=A,A=null):S=A.sibling;var M=d(v,A,x[T],w);if(M===null){A===null&&(A=S);break}n&&A&&M.alternate===null&&e(v,A),b=s(M,b,T),E===null?_=M:E.sibling=M,E=M,A=S}if(T===x.length)return t(v,A),Nr&&bm(v,T),_;if(A===null){for(;T<x.length;T++)A=h(v,x[T],w),A!==null&&(b=s(A,b,T),E===null?_=A:E.sibling=A,E=A);return Nr&&bm(v,T),_}for(A=r(v,A);T<x.length;T++)S=f(A,v,T,x[T],w),S!==null&&(n&&S.alternate!==null&&A.delete(S.key===null?T:S.key),b=s(S,b,T),E===null?_=S:E.sibling=S,E=S);return n&&A.forEach(function(D){return e(v,D)}),Nr&&bm(v,T),_}function m(v,b,x,w){var _=l_(x);if(typeof _!="function")throw Error(et(150));if(x=_.call(x),x==null)throw Error(et(151));for(var E=_=null,A=b,T=b=0,S=null,M=x.next();A!==null&&!M.done;T++,M=x.next()){A.index>T?(S=A,A=null):S=A.sibling;var D=d(v,A,M.value,w);if(D===null){A===null&&(A=S);break}n&&A&&D.alternate===null&&e(v,A),b=s(D,b,T),E===null?_=D:E.sibling=D,E=D,A=S}if(M.done)return t(v,A),Nr&&bm(v,T),_;if(A===null){for(;!M.done;T++,M=x.next())M=h(v,M.value,w),M!==null&&(b=s(M,b,T),E===null?_=M:E.sibling=M,E=M);return Nr&&bm(v,T),_}for(A=r(v,A);!M.done;T++,M=x.next())M=f(A,v,T,M.value,w),M!==null&&(n&&M.alternate!==null&&A.delete(M.key===null?T:M.key),b=s(M,b,T),E===null?_=M:E.sibling=M,E=M);return n&&A.forEach(function(N){return e(v,N)}),Nr&&bm(v,T),_}function y(v,b,x,w){if(typeof x=="object"&&x!==null&&x.type===V0&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case MA:e:{for(var _=x.key,E=b;E!==null;){if(E.key===_){if(_=x.type,_===V0){if(E.tag===7){t(v,E.sibling),b=i(E,x.props.children),b.return=v,v=b;break e}}else if(E.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===qd&&K5(_)===E.type){t(v,E.sibling),b=i(E,x.props),b.ref=f_(v,E,x),b.return=v,v=b;break e}t(v,E);break}else e(v,E);E=E.sibling}x.type===V0?(b=ov(x.props.children,v.mode,w,x.key),b.return=v,v=b):(w=cM(x.type,x.key,x.props,null,v.mode,w),w.ref=f_(v,b,x),w.return=v,v=w)}return a(v);case U0:e:{for(E=x.key;b!==null;){if(b.key===E)if(b.tag===4&&b.stateNode.containerInfo===x.containerInfo&&b.stateNode.implementation===x.implementation){t(v,b.sibling),b=i(b,x.children||[]),b.return=v,v=b;break e}else{t(v,b);break}else e(v,b);b=b.sibling}b=DR(x,v.mode,w),b.return=v,v=b}return a(v);case qd:return E=x._init,y(v,b,E(x._payload),w)}if(L_(x))return p(v,b,x,w);if(l_(x))return m(v,b,x,w);BA(v,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,b!==null&&b.tag===6?(t(v,b.sibling),b=i(b,x),b.return=v,v=b):(t(v,b),b=CR(x,v.mode,w),b.return=v,v=b),a(v)):t(v,b)}return y}var rb=Wq(!0),Xq=Wq(!1),CC=Up(null),DC=null,X0=null,ck=null;function hk(){ck=X0=DC=null}function dk(n){var e=CC.current;Sr(CC),n._currentValue=e}function LP(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function gy(n,e){DC=n,ck=X0=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Xa=!0),n.firstContext=null)}function Tl(n){var e=n._currentValue;if(ck!==n)if(n={context:n,memoizedValue:e,next:null},X0===null){if(DC===null)throw Error(et(308));X0=n,DC.dependencies={lanes:0,firstContext:n}}else X0=X0.next=n;return e}var Om=null;function fk(n){Om===null?Om=[n]:Om.push(n)}function Kq(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,fk(e)):(t.next=i.next,i.next=t),e.interleaved=t,id(n,r)}function id(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Wd=!1;function pk(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Yq(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function jh(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function op(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,Pn&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,id(n,t)}return i=r.interleaved,i===null?(e.next=e,fk(r)):(e.next=i.next,i.next=e),r.interleaved=e,id(n,t)}function iM(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,JO(n,t)}}function Y5(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=a:s=s.next=a,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function NC(n,e,t,r){var i=n.updateQueue;Wd=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var c=n.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==a&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,c=u=l=null,o=s;do{var d=o.lane,f=o.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=n,m=o;switch(d=e,f=t,m.tag){case 1:if(p=m.payload,typeof p=="function"){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,d=typeof p=="function"?p.call(f,h,d):p,d==null)break e;h=zr({},h,d);break e;case 2:Wd=!0}}o.callback!==null&&o.lane!==0&&(n.flags|=64,d=i.effects,d===null?i.effects=[o]:d.push(o))}else f={eventTime:f,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=f,l=h):c=c.next=f,a|=d;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;d=o,o=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(c===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);vv|=a,n.lanes=a,n.memoizedState=h}}function Q5(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(et(191,i));i.call(r)}}}var CS={},cc=Up(CS),K1=Up(CS),Y1=Up(CS);function km(n){if(n===CS)throw Error(et(174));return n}function mk(n,e){switch(xr(Y1,e),xr(K1,n),xr(cc,CS),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:mP(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=mP(e,n)}Sr(cc),xr(cc,e)}function ib(){Sr(cc),Sr(K1),Sr(Y1)}function Qq(n){km(Y1.current);var e=km(cc.current),t=mP(e,n.type);e!==t&&(xr(K1,n),xr(cc,t))}function gk(n){K1.current===n&&(Sr(cc),Sr(K1))}var Or=Up(0);function RC(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var wR=[];function vk(){for(var n=0;n<wR.length;n++)wR[n]._workInProgressVersionPrimary=null;wR.length=0}var sM=_d.ReactCurrentDispatcher,ER=_d.ReactCurrentBatchConfig,gv=0,Br=null,Ni=null,is=null,IC=!1,_1=!1,Q1=0,pae=0;function Fs(){throw Error(et(321))}function yk(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!fu(n[t],e[t]))return!1;return!0}function xk(n,e,t,r,i,s){if(gv=s,Br=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,sM.current=n===null||n.memoizedState===null?yae:xae,n=t(r,i),_1){s=0;do{if(_1=!1,Q1=0,25<=s)throw Error(et(301));s+=1,is=Ni=null,e.updateQueue=null,sM.current=bae,n=t(r,i)}while(_1)}if(sM.current=PC,e=Ni!==null&&Ni.next!==null,gv=0,is=Ni=Br=null,IC=!1,e)throw Error(et(300));return n}function bk(){var n=Q1!==0;return Q1=0,n}function Pu(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return is===null?Br.memoizedState=is=n:is=is.next=n,is}function Ml(){if(Ni===null){var n=Br.alternate;n=n!==null?n.memoizedState:null}else n=Ni.next;var e=is===null?Br.memoizedState:is.next;if(e!==null)is=e,Ni=n;else{if(n===null)throw Error(et(310));Ni=n,n={memoizedState:Ni.memoizedState,baseState:Ni.baseState,baseQueue:Ni.baseQueue,queue:Ni.queue,next:null},is===null?Br.memoizedState=is=n:is=is.next=n}return is}function Z1(n,e){return typeof e=="function"?e(n):e}function SR(n){var e=Ml(),t=e.queue;if(t===null)throw Error(et(311));t.lastRenderedReducer=n;var r=Ni,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var o=a=null,l=null,u=s;do{var c=u.lane;if((gv&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:n(r,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=h,a=r):l=l.next=h,Br.lanes|=c,vv|=c}u=u.next}while(u!==null&&u!==s);l===null?a=r:l.next=o,fu(r,e.memoizedState)||(Xa=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,Br.lanes|=s,vv|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function AR(n){var e=Ml(),t=e.queue;if(t===null)throw Error(et(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var a=i=i.next;do s=n(s,a.action),a=a.next;while(a!==i);fu(s,e.memoizedState)||(Xa=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function Zq(){}function Jq(n,e){var t=Br,r=Ml(),i=e(),s=!fu(r.memoizedState,i);if(s&&(r.memoizedState=i,Xa=!0),r=r.queue,_k(nW.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||is!==null&&is.memoizedState.tag&1){if(t.flags|=2048,J1(9,tW.bind(null,t,r,i,e),void 0,null),as===null)throw Error(et(349));gv&30||eW(t,e,i)}return i}function eW(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Br.updateQueue,e===null?(e={lastEffect:null,stores:null},Br.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function tW(n,e,t,r){e.value=t,e.getSnapshot=r,rW(e)&&iW(n)}function nW(n,e,t){return t(function(){rW(e)&&iW(n)})}function rW(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!fu(n,t)}catch{return!0}}function iW(n){var e=id(n,1);e!==null&&hu(e,n,1,-1)}function Z5(n){var e=Pu();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Z1,lastRenderedState:n},e.queue=n,n=n.dispatch=vae.bind(null,Br,n),[e.memoizedState,n]}function J1(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Br.updateQueue,e===null?(e={lastEffect:null,stores:null},Br.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function sW(){return Ml().memoizedState}function aM(n,e,t,r){var i=Pu();Br.flags|=n,i.memoizedState=J1(1|e,t,void 0,r===void 0?null:r)}function I2(n,e,t,r){var i=Ml();r=r===void 0?null:r;var s=void 0;if(Ni!==null){var a=Ni.memoizedState;if(s=a.destroy,r!==null&&yk(r,a.deps)){i.memoizedState=J1(e,t,s,r);return}}Br.flags|=n,i.memoizedState=J1(1|e,t,s,r)}function J5(n,e){return aM(8390656,8,n,e)}function _k(n,e){return I2(2048,8,n,e)}function aW(n,e){return I2(4,2,n,e)}function oW(n,e){return I2(4,4,n,e)}function lW(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function uW(n,e,t){return t=t!=null?t.concat([n]):null,I2(4,4,lW.bind(null,e,n),t)}function wk(){}function cW(n,e){var t=Ml();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&yk(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function hW(n,e){var t=Ml();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&yk(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function dW(n,e,t){return gv&21?(fu(t,e)||(t=vq(),Br.lanes|=t,vv|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Xa=!0),n.memoizedState=t)}function mae(n,e){var t=Qn;Qn=t!==0&&4>t?t:4,n(!0);var r=ER.transition;ER.transition={};try{n(!1),e()}finally{Qn=t,ER.transition=r}}function fW(){return Ml().memoizedState}function gae(n,e,t){var r=up(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},pW(n))mW(e,t);else if(t=Kq(n,e,t,r),t!==null){var i=_a();hu(t,n,r,i),gW(t,e,r)}}function vae(n,e,t){var r=up(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(pW(n))mW(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,t);if(i.hasEagerState=!0,i.eagerState=o,fu(o,a)){var l=e.interleaved;l===null?(i.next=i,fk(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}t=Kq(n,e,i,r),t!==null&&(i=_a(),hu(t,n,r,i),gW(t,e,r))}}function pW(n){var e=n.alternate;return n===Br||e!==null&&e===Br}function mW(n,e){_1=IC=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function gW(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,JO(n,t)}}var PC={readContext:Tl,useCallback:Fs,useContext:Fs,useEffect:Fs,useImperativeHandle:Fs,useInsertionEffect:Fs,useLayoutEffect:Fs,useMemo:Fs,useReducer:Fs,useRef:Fs,useState:Fs,useDebugValue:Fs,useDeferredValue:Fs,useTransition:Fs,useMutableSource:Fs,useSyncExternalStore:Fs,useId:Fs,unstable_isNewReconciler:!1},yae={readContext:Tl,useCallback:function(n,e){return Pu().memoizedState=[n,e===void 0?null:e],n},useContext:Tl,useEffect:J5,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,aM(4194308,4,lW.bind(null,e,n),t)},useLayoutEffect:function(n,e){return aM(4194308,4,n,e)},useInsertionEffect:function(n,e){return aM(4,2,n,e)},useMemo:function(n,e){var t=Pu();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Pu();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=gae.bind(null,Br,n),[r.memoizedState,n]},useRef:function(n){var e=Pu();return n={current:n},e.memoizedState=n},useState:Z5,useDebugValue:wk,useDeferredValue:function(n){return Pu().memoizedState=n},useTransition:function(){var n=Z5(!1),e=n[0];return n=mae.bind(null,n[1]),Pu().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Br,i=Pu();if(Nr){if(t===void 0)throw Error(et(407));t=t()}else{if(t=e(),as===null)throw Error(et(349));gv&30||eW(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,J5(nW.bind(null,r,s,n),[n]),r.flags|=2048,J1(9,tW.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=Pu(),e=as.identifierPrefix;if(Nr){var t=Uh,r=Bh;t=(r&~(1<<32-cu(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Q1++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=pae++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},xae={readContext:Tl,useCallback:cW,useContext:Tl,useEffect:_k,useImperativeHandle:uW,useInsertionEffect:aW,useLayoutEffect:oW,useMemo:hW,useReducer:SR,useRef:sW,useState:function(){return SR(Z1)},useDebugValue:wk,useDeferredValue:function(n){var e=Ml();return dW(e,Ni.memoizedState,n)},useTransition:function(){var n=SR(Z1)[0],e=Ml().memoizedState;return[n,e]},useMutableSource:Zq,useSyncExternalStore:Jq,useId:fW,unstable_isNewReconciler:!1},bae={readContext:Tl,useCallback:cW,useContext:Tl,useEffect:_k,useImperativeHandle:uW,useInsertionEffect:aW,useLayoutEffect:oW,useMemo:hW,useReducer:AR,useRef:sW,useState:function(){return AR(Z1)},useDebugValue:wk,useDeferredValue:function(n){var e=Ml();return Ni===null?e.memoizedState=n:dW(e,Ni.memoizedState,n)},useTransition:function(){var n=AR(Z1)[0],e=Ml().memoizedState;return[n,e]},useMutableSource:Zq,useSyncExternalStore:Jq,useId:fW,unstable_isNewReconciler:!1};function Hl(n,e){if(n&&n.defaultProps){e=zr({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function OP(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:zr({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var P2={isMounted:function(n){return(n=n._reactInternals)?Iv(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=_a(),i=up(n),s=jh(r,i);s.payload=e,t!=null&&(s.callback=t),e=op(n,s,i),e!==null&&(hu(e,n,i,r),iM(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=_a(),i=up(n),s=jh(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=op(n,s,i),e!==null&&(hu(e,n,i,r),iM(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=_a(),r=up(n),i=jh(t,r);i.tag=2,e!=null&&(i.callback=e),e=op(n,i,r),e!==null&&(hu(e,n,r,t),iM(e,n,r))}};function eV(n,e,t,r,i,s,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!j1(t,r)||!j1(i,s):!0}function vW(n,e,t){var r=!1,i=yp,s=e.contextType;return typeof s=="object"&&s!==null?s=Tl(s):(i=Qa(e)?pv:ta.current,r=e.contextTypes,s=(r=r!=null)?tb(n,i):yp),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=P2,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function tV(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&P2.enqueueReplaceState(e,e.state,null)}function kP(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},pk(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Tl(s):(s=Qa(e)?pv:ta.current,i.context=tb(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(OP(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&P2.enqueueReplaceState(i,i.state,null),NC(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function sb(n,e){try{var t="",r=e;do t+=Xie(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function TR(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function BP(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var _ae=typeof WeakMap=="function"?WeakMap:Map;function yW(n,e,t){t=jh(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){LC||(LC=!0,XP=r),BP(n,e)},t}function xW(n,e,t){t=jh(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){BP(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){BP(n,e),typeof r!="function"&&(lp===null?lp=new Set([this]):lp.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function nV(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new _ae;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=Lae.bind(null,n,e,t),e.then(n,n))}function rV(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function iV(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=jh(-1,1),e.tag=2,op(t,e,1))),t.lanes|=1),n)}var wae=_d.ReactCurrentOwner,Xa=!1;function ya(n,e,t,r){e.child=n===null?Xq(e,null,t,r):rb(e,n.child,t,r)}function sV(n,e,t,r,i){t=t.render;var s=e.ref;return gy(e,i),r=xk(n,e,t,r,s,i),t=bk(),n!==null&&!Xa?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,sd(n,e,i)):(Nr&&t&&ok(e),e.flags|=1,ya(n,e,r,i),e.child)}function aV(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!Nk(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,bW(n,e,s,r,i)):(n=cM(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var a=s.memoizedProps;if(t=t.compare,t=t!==null?t:j1,t(a,r)&&n.ref===e.ref)return sd(n,e,i)}return e.flags|=1,n=cp(s,r),n.ref=e.ref,n.return=e,e.child=n}function bW(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(j1(s,r)&&n.ref===e.ref)if(Xa=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(Xa=!0);else return e.lanes=n.lanes,sd(n,e,i)}return UP(n,e,t,r,i)}function _W(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},xr(Y0,Co),Co|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,xr(Y0,Co),Co|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,xr(Y0,Co),Co|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,xr(Y0,Co),Co|=r;return ya(n,e,i,t),e.child}function wW(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function UP(n,e,t,r,i){var s=Qa(t)?pv:ta.current;return s=tb(e,s),gy(e,i),t=xk(n,e,t,r,s,i),r=bk(),n!==null&&!Xa?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,sd(n,e,i)):(Nr&&r&&ok(e),e.flags|=1,ya(n,e,t,i),e.child)}function oV(n,e,t,r,i){if(Qa(t)){var s=!0;AC(e)}else s=!1;if(gy(e,i),e.stateNode===null)oM(n,e),vW(e,t,r),kP(e,t,r,i),r=!0;else if(n===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=t.contextType;typeof u=="object"&&u!==null?u=Tl(u):(u=Qa(t)?pv:ta.current,u=tb(e,u));var c=t.getDerivedStateFromProps,h=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||l!==u)&&tV(e,a,r,u),Wd=!1;var d=e.memoizedState;a.state=d,NC(e,r,a,i),l=e.memoizedState,o!==r||d!==l||Ya.current||Wd?(typeof c=="function"&&(OP(e,t,c,r),l=e.memoizedState),(o=Wd||eV(e,t,o,r,d,l,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),a.props=r,a.state=l,a.context=u,r=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,Yq(n,e),o=e.memoizedProps,u=e.type===e.elementType?o:Hl(e.type,o),a.props=u,h=e.pendingProps,d=a.context,l=t.contextType,typeof l=="object"&&l!==null?l=Tl(l):(l=Qa(t)?pv:ta.current,l=tb(e,l));var f=t.getDerivedStateFromProps;(c=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&tV(e,a,r,l),Wd=!1,d=e.memoizedState,a.state=d,NC(e,r,a,i);var p=e.memoizedState;o!==h||d!==p||Ya.current||Wd?(typeof f=="function"&&(OP(e,t,f,r),p=e.memoizedState),(u=Wd||eV(e,t,u,r,d,p,l)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,p,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,p,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),a.props=r,a.state=p,a.context=l,r=u):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),r=!1)}return VP(n,e,t,r,s,i)}function VP(n,e,t,r,i,s){wW(n,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&q5(e,t,!1),sd(n,e,s);r=e.stateNode,wae.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&a?(e.child=rb(e,n.child,null,s),e.child=rb(e,null,o,s)):ya(n,e,o,s),e.memoizedState=r.state,i&&q5(e,t,!0),e.child}function EW(n){var e=n.stateNode;e.pendingContext?j5(n,e.pendingContext,e.pendingContext!==e.context):e.context&&j5(n,e.context,!1),mk(n,e.containerInfo)}function lV(n,e,t,r,i){return nb(),uk(i),e.flags|=256,ya(n,e,t,r),e.child}var zP={dehydrated:null,treeContext:null,retryLane:0};function $P(n){return{baseLanes:n,cachePool:null,transitions:null}}function SW(n,e,t){var r=e.pendingProps,i=Or.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=n!==null&&n.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),xr(Or,i&1),n===null)return FP(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,n=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=O2(a,r,0,null),n=ov(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=$P(t),e.memoizedState=zP,n):Ek(e,a));if(i=n.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return Eae(n,e,a,r,o,i,t);if(s){s=r.fallback,a=e.mode,i=n.child,o=i.sibling;var l={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=cp(i,l),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=cp(o,s):(s=ov(s,a,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=n.child.memoizedState,a=a===null?$P(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=n.childLanes&~t,e.memoizedState=zP,r}return s=n.child,n=s.sibling,r=cp(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function Ek(n,e){return e=O2({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function UA(n,e,t,r){return r!==null&&uk(r),rb(e,n.child,null,t),n=Ek(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function Eae(n,e,t,r,i,s,a){if(t)return e.flags&256?(e.flags&=-257,r=TR(Error(et(422))),UA(n,e,a,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=O2({mode:"visible",children:r.children},i,0,null),s=ov(s,i,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&rb(e,n.child,null,a),e.child.memoizedState=$P(a),e.memoizedState=zP,s);if(!(e.mode&1))return UA(n,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(et(419)),r=TR(s,r,void 0),UA(n,e,a,r)}if(o=(a&n.childLanes)!==0,Xa||o){if(r=as,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,id(n,i),hu(r,n,i,-1))}return Dk(),r=TR(Error(et(421))),UA(n,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=Oae.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,Lo=ap(i.nextSibling),ko=e,Nr=!0,ru=null,n!==null&&(pl[ml++]=Bh,pl[ml++]=Uh,pl[ml++]=mv,Bh=n.id,Uh=n.overflow,mv=e),e=Ek(e,r.children),e.flags|=4096,e)}function uV(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),LP(n.return,e,t)}function MR(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function AW(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(ya(n,e,r.children,t),r=Or.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&uV(n,t,e);else if(n.tag===19)uV(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(xr(Or,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&RC(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),MR(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&RC(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}MR(e,!0,t,null,s);break;case"together":MR(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function oM(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function sd(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),vv|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(et(153));if(e.child!==null){for(n=e.child,t=cp(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=cp(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function Sae(n,e,t){switch(e.tag){case 3:EW(e),nb();break;case 5:Qq(e);break;case 1:Qa(e.type)&&AC(e);break;case 4:mk(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;xr(CC,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(xr(Or,Or.current&1),e.flags|=128,null):t&e.child.childLanes?SW(n,e,t):(xr(Or,Or.current&1),n=sd(n,e,t),n!==null?n.sibling:null);xr(Or,Or.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return AW(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),xr(Or,Or.current),r)break;return null;case 22:case 23:return e.lanes=0,_W(n,e,t)}return sd(n,e,t)}var TW,HP,MW,CW;TW=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};HP=function(){};MW=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,km(cc.current);var s=null;switch(t){case"input":i=hP(n,i),r=hP(n,r),s=[];break;case"select":i=zr({},i,{value:void 0}),r=zr({},r,{value:void 0}),s=[];break;case"textarea":i=pP(n,i),r=pP(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=EC)}gP(t,r);var a;t=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(B1.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(o=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(t||(t={}),t[a]=l[a])}else t||(s||(s=[]),s.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(B1.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&_r("scroll",n),s||o===l||(s=[])):(s=s||[]).push(u,l))}t&&(s=s||[]).push("style",t);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};CW=function(n,e,t,r){t!==r&&(e.flags|=4)};function p_(n,e){if(!Nr)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Ls(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function Aae(n,e,t){var r=e.pendingProps;switch(lk(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ls(e),null;case 1:return Qa(e.type)&&SC(),Ls(e),null;case 3:return r=e.stateNode,ib(),Sr(Ya),Sr(ta),vk(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(kA(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ru!==null&&(QP(ru),ru=null))),HP(n,e),Ls(e),null;case 5:gk(e);var i=km(Y1.current);if(t=e.type,n!==null&&e.stateNode!=null)MW(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(et(166));return Ls(e),null}if(n=km(cc.current),kA(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[ic]=e,r[X1]=s,n=(e.mode&1)!==0,t){case"dialog":_r("cancel",r),_r("close",r);break;case"iframe":case"object":case"embed":_r("load",r);break;case"video":case"audio":for(i=0;i<k_.length;i++)_r(k_[i],r);break;case"source":_r("error",r);break;case"img":case"image":case"link":_r("error",r),_r("load",r);break;case"details":_r("toggle",r);break;case"input":y5(r,s),_r("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},_r("invalid",r);break;case"textarea":b5(r,s),_r("invalid",r)}gP(t,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&OA(r.textContent,o,n),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&OA(r.textContent,o,n),i=["children",""+o]):B1.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&_r("scroll",r)}switch(t){case"input":CA(r),x5(r,s,!0);break;case"textarea":CA(r),_5(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=EC)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=nq(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=a.createElement(t,{is:r.is}):(n=a.createElement(t),t==="select"&&(a=n,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):n=a.createElementNS(n,t),n[ic]=e,n[X1]=r,TW(n,e,!1,!1),e.stateNode=n;e:{switch(a=vP(t,r),t){case"dialog":_r("cancel",n),_r("close",n),i=r;break;case"iframe":case"object":case"embed":_r("load",n),i=r;break;case"video":case"audio":for(i=0;i<k_.length;i++)_r(k_[i],n);i=r;break;case"source":_r("error",n),i=r;break;case"img":case"image":case"link":_r("error",n),_r("load",n),i=r;break;case"details":_r("toggle",n),i=r;break;case"input":y5(n,r),i=hP(n,r),_r("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=zr({},r,{value:void 0}),_r("invalid",n);break;case"textarea":b5(n,r),i=pP(n,r),_r("invalid",n);break;default:i=r}gP(t,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?sq(n,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&rq(n,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&U1(n,l):typeof l=="number"&&U1(n,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(B1.hasOwnProperty(s)?l!=null&&s==="onScroll"&&_r("scroll",n):l!=null&&WO(n,s,l,a))}switch(t){case"input":CA(n),x5(n,r,!1);break;case"textarea":CA(n),_5(n);break;case"option":r.value!=null&&n.setAttribute("value",""+vp(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?dy(n,!!r.multiple,s,!1):r.defaultValue!=null&&dy(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=EC)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ls(e),null;case 6:if(n&&e.stateNode!=null)CW(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(et(166));if(t=km(Y1.current),km(cc.current),kA(e)){if(r=e.stateNode,t=e.memoizedProps,r[ic]=e,(s=r.nodeValue!==t)&&(n=ko,n!==null))switch(n.tag){case 3:OA(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&OA(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[ic]=e,e.stateNode=r}return Ls(e),null;case 13:if(Sr(Or),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Nr&&Lo!==null&&e.mode&1&&!(e.flags&128))qq(),nb(),e.flags|=98560,s=!1;else if(s=kA(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(et(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(et(317));s[ic]=e}else nb(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ls(e),s=!1}else ru!==null&&(QP(ru),ru=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Or.current&1?Ii===0&&(Ii=3):Dk())),e.updateQueue!==null&&(e.flags|=4),Ls(e),null);case 4:return ib(),HP(n,e),n===null&&q1(e.stateNode.containerInfo),Ls(e),null;case 10:return dk(e.type._context),Ls(e),null;case 17:return Qa(e.type)&&SC(),Ls(e),null;case 19:if(Sr(Or),s=e.memoizedState,s===null)return Ls(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)p_(s,!1);else{if(Ii!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(a=RC(n),a!==null){for(e.flags|=128,p_(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,n=a.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return xr(Or,Or.current&1|2),e.child}n=n.sibling}s.tail!==null&&ui()>ab&&(e.flags|=128,r=!0,p_(s,!1),e.lanes=4194304)}else{if(!r)if(n=RC(a),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),p_(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Nr)return Ls(e),null}else 2*ui()-s.renderingStartTime>ab&&t!==1073741824&&(e.flags|=128,r=!0,p_(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(t=s.last,t!==null?t.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ui(),e.sibling=null,t=Or.current,xr(Or,r?t&1|2:t&1),e):(Ls(e),null);case 22:case 23:return Ck(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Co&1073741824&&(Ls(e),e.subtreeFlags&6&&(e.flags|=8192)):Ls(e),null;case 24:return null;case 25:return null}throw Error(et(156,e.tag))}function Tae(n,e){switch(lk(e),e.tag){case 1:return Qa(e.type)&&SC(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return ib(),Sr(Ya),Sr(ta),vk(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return gk(e),null;case 13:if(Sr(Or),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(et(340));nb()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Sr(Or),null;case 4:return ib(),null;case 10:return dk(e.type._context),null;case 22:case 23:return Ck(),null;case 24:return null;default:return null}}var VA=!1,Xs=!1,Mae=typeof WeakSet=="function"?WeakSet:Set,gt=null;function K0(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Yr(n,e,r)}else t.current=null}function GP(n,e,t){try{t()}catch(r){Yr(n,e,r)}}var cV=!1;function Cae(n,e){if(MP=bC,n=Pq(),ak(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var a=0,o=-1,l=-1,u=0,c=0,h=n,d=null;t:for(;;){for(var f;h!==t||i!==0&&h.nodeType!==3||(o=a+i),h!==s||r!==0&&h.nodeType!==3||(l=a+r),h.nodeType===3&&(a+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===n)break t;if(d===t&&++u===i&&(o=a),d===s&&++c===r&&(l=a),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(CP={focusedElem:n,selectionRange:t},bC=!1,gt=e;gt!==null;)if(e=gt,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,gt=n;else for(;gt!==null;){e=gt;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,y=p.memoizedState,v=e.stateNode,b=v.getSnapshotBeforeUpdate(e.elementType===e.type?m:Hl(e.type,m),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(et(163))}}catch(w){Yr(e,e.return,w)}if(n=e.sibling,n!==null){n.return=e.return,gt=n;break}gt=e.return}return p=cV,cV=!1,p}function w1(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&GP(e,t,s)}i=i.next}while(i!==r)}}function F2(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function jP(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function DW(n){var e=n.alternate;e!==null&&(n.alternate=null,DW(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[ic],delete e[X1],delete e[RP],delete e[cae],delete e[hae])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function NW(n){return n.tag===5||n.tag===3||n.tag===4}function hV(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||NW(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function qP(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=EC));else if(r!==4&&(n=n.child,n!==null))for(qP(n,e,t),n=n.sibling;n!==null;)qP(n,e,t),n=n.sibling}function WP(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(WP(n,e,t),n=n.sibling;n!==null;)WP(n,e,t),n=n.sibling}var gs=null,nu=!1;function Ld(n,e,t){for(t=t.child;t!==null;)RW(n,e,t),t=t.sibling}function RW(n,e,t){if(uc&&typeof uc.onCommitFiberUnmount=="function")try{uc.onCommitFiberUnmount(T2,t)}catch{}switch(t.tag){case 5:Xs||K0(t,e);case 6:var r=gs,i=nu;gs=null,Ld(n,e,t),gs=r,nu=i,gs!==null&&(nu?(n=gs,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):gs.removeChild(t.stateNode));break;case 18:gs!==null&&(nu?(n=gs,t=t.stateNode,n.nodeType===8?bR(n.parentNode,t):n.nodeType===1&&bR(n,t),H1(n)):bR(gs,t.stateNode));break;case 4:r=gs,i=nu,gs=t.stateNode.containerInfo,nu=!0,Ld(n,e,t),gs=r,nu=i;break;case 0:case 11:case 14:case 15:if(!Xs&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&GP(t,e,a),i=i.next}while(i!==r)}Ld(n,e,t);break;case 1:if(!Xs&&(K0(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(o){Yr(t,e,o)}Ld(n,e,t);break;case 21:Ld(n,e,t);break;case 22:t.mode&1?(Xs=(r=Xs)||t.memoizedState!==null,Ld(n,e,t),Xs=r):Ld(n,e,t);break;default:Ld(n,e,t)}}function dV(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new Mae),e.forEach(function(r){var i=kae.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function Fl(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:gs=o.stateNode,nu=!1;break e;case 3:gs=o.stateNode.containerInfo,nu=!0;break e;case 4:gs=o.stateNode.containerInfo,nu=!0;break e}o=o.return}if(gs===null)throw Error(et(160));RW(s,a,i),gs=null,nu=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Yr(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)IW(e,n),e=e.sibling}function IW(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Fl(e,n),Mu(n),r&4){try{w1(3,n,n.return),F2(3,n)}catch(m){Yr(n,n.return,m)}try{w1(5,n,n.return)}catch(m){Yr(n,n.return,m)}}break;case 1:Fl(e,n),Mu(n),r&512&&t!==null&&K0(t,t.return);break;case 5:if(Fl(e,n),Mu(n),r&512&&t!==null&&K0(t,t.return),n.flags&32){var i=n.stateNode;try{U1(i,"")}catch(m){Yr(n,n.return,m)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,a=t!==null?t.memoizedProps:s,o=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&eq(i,s),vP(o,a);var u=vP(o,s);for(a=0;a<l.length;a+=2){var c=l[a],h=l[a+1];c==="style"?sq(i,h):c==="dangerouslySetInnerHTML"?rq(i,h):c==="children"?U1(i,h):WO(i,c,h,u)}switch(o){case"input":dP(i,s);break;case"textarea":tq(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?dy(i,!!s.multiple,f,!1):d!==!!s.multiple&&(s.defaultValue!=null?dy(i,!!s.multiple,s.defaultValue,!0):dy(i,!!s.multiple,s.multiple?[]:"",!1))}i[X1]=s}catch(m){Yr(n,n.return,m)}}break;case 6:if(Fl(e,n),Mu(n),r&4){if(n.stateNode===null)throw Error(et(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(m){Yr(n,n.return,m)}}break;case 3:if(Fl(e,n),Mu(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{H1(e.containerInfo)}catch(m){Yr(n,n.return,m)}break;case 4:Fl(e,n),Mu(n);break;case 13:Fl(e,n),Mu(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Tk=ui())),r&4&&dV(n);break;case 22:if(c=t!==null&&t.memoizedState!==null,n.mode&1?(Xs=(u=Xs)||c,Fl(e,n),Xs=u):Fl(e,n),Mu(n),r&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!c&&n.mode&1)for(gt=n,c=n.child;c!==null;){for(h=gt=c;gt!==null;){switch(d=gt,f=d.child,d.tag){case 0:case 11:case 14:case 15:w1(4,d,d.return);break;case 1:K0(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){r=d,t=d.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Yr(r,t,m)}}break;case 5:K0(d,d.return);break;case 22:if(d.memoizedState!==null){pV(h);continue}}f!==null?(f.return=d,gt=f):pV(h)}c=c.sibling}e:for(c=null,h=n;;){if(h.tag===5){if(c===null){c=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=iq("display",a))}catch(m){Yr(n,n.return,m)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(m){Yr(n,n.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Fl(e,n),Mu(n),r&4&&dV(n);break;case 21:break;default:Fl(e,n),Mu(n)}}function Mu(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(NW(t)){var r=t;break e}t=t.return}throw Error(et(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(U1(i,""),r.flags&=-33);var s=hV(n);WP(n,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,o=hV(n);qP(n,o,a);break;default:throw Error(et(161))}}catch(l){Yr(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function Dae(n,e,t){gt=n,PW(n)}function PW(n,e,t){for(var r=(n.mode&1)!==0;gt!==null;){var i=gt,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||VA;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Xs;o=VA;var u=Xs;if(VA=a,(Xs=l)&&!u)for(gt=i;gt!==null;)a=gt,l=a.child,a.tag===22&&a.memoizedState!==null?mV(i):l!==null?(l.return=a,gt=l):mV(i);for(;s!==null;)gt=s,PW(s),s=s.sibling;gt=i,VA=o,Xs=u}fV(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,gt=s):fV(n)}}function fV(n){for(;gt!==null;){var e=gt;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Xs||F2(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Xs)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Hl(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Q5(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}Q5(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&H1(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(et(163))}Xs||e.flags&512&&jP(e)}catch(d){Yr(e,e.return,d)}}if(e===n){gt=null;break}if(t=e.sibling,t!==null){t.return=e.return,gt=t;break}gt=e.return}}function pV(n){for(;gt!==null;){var e=gt;if(e===n){gt=null;break}var t=e.sibling;if(t!==null){t.return=e.return,gt=t;break}gt=e.return}}function mV(n){for(;gt!==null;){var e=gt;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{F2(4,e)}catch(l){Yr(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Yr(e,i,l)}}var s=e.return;try{jP(e)}catch(l){Yr(e,s,l)}break;case 5:var a=e.return;try{jP(e)}catch(l){Yr(e,a,l)}}}catch(l){Yr(e,e.return,l)}if(e===n){gt=null;break}var o=e.sibling;if(o!==null){o.return=e.return,gt=o;break}gt=e.return}}var Nae=Math.ceil,FC=_d.ReactCurrentDispatcher,Sk=_d.ReactCurrentOwner,_l=_d.ReactCurrentBatchConfig,Pn=0,as=null,xi=null,Ms=0,Co=0,Y0=Up(0),Ii=0,ew=null,vv=0,L2=0,Ak=0,E1=null,qa=null,Tk=0,ab=1/0,Qc=null,LC=!1,XP=null,lp=null,zA=!1,Qf=null,OC=0,S1=0,KP=null,lM=-1,uM=0;function _a(){return Pn&6?ui():lM!==-1?lM:lM=ui()}function up(n){return n.mode&1?Pn&2&&Ms!==0?Ms&-Ms:fae.transition!==null?(uM===0&&(uM=vq()),uM):(n=Qn,n!==0||(n=window.event,n=n===void 0?16:Sq(n.type)),n):1}function hu(n,e,t,r){if(50<S1)throw S1=0,KP=null,Error(et(185));AS(n,t,r),(!(Pn&2)||n!==as)&&(n===as&&(!(Pn&2)&&(L2|=t),Ii===4&&Qd(n,Ms)),Za(n,r),t===1&&Pn===0&&!(e.mode&1)&&(ab=ui()+500,R2&&Vp()))}function Za(n,e){var t=n.callbackNode;fse(n,e);var r=xC(n,n===as?Ms:0);if(r===0)t!==null&&S5(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&S5(t),e===1)n.tag===0?dae(gV.bind(null,n)):Hq(gV.bind(null,n)),lae(function(){!(Pn&6)&&Vp()}),t=null;else{switch(yq(r)){case 1:t=ZO;break;case 4:t=mq;break;case 16:t=yC;break;case 536870912:t=gq;break;default:t=yC}t=zW(t,FW.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function FW(n,e){if(lM=-1,uM=0,Pn&6)throw Error(et(327));var t=n.callbackNode;if(vy()&&n.callbackNode!==t)return null;var r=xC(n,n===as?Ms:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=kC(n,r);else{e=r;var i=Pn;Pn|=2;var s=OW();(as!==n||Ms!==e)&&(Qc=null,ab=ui()+500,av(n,e));do try{Pae();break}catch(o){LW(n,o)}while(!0);hk(),FC.current=s,Pn=i,xi!==null?e=0:(as=null,Ms=0,e=Ii)}if(e!==0){if(e===2&&(i=wP(n),i!==0&&(r=i,e=YP(n,i))),e===1)throw t=ew,av(n,0),Qd(n,r),Za(n,ui()),t;if(e===6)Qd(n,r);else{if(i=n.current.alternate,!(r&30)&&!Rae(i)&&(e=kC(n,r),e===2&&(s=wP(n),s!==0&&(r=s,e=YP(n,s))),e===1))throw t=ew,av(n,0),Qd(n,r),Za(n,ui()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(et(345));case 2:_m(n,qa,Qc);break;case 3:if(Qd(n,r),(r&130023424)===r&&(e=Tk+500-ui(),10<e)){if(xC(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){_a(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=NP(_m.bind(null,n,qa,Qc),e);break}_m(n,qa,Qc);break;case 4:if(Qd(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var a=31-cu(r);s=1<<a,a=e[a],a>i&&(i=a),r&=~s}if(r=i,r=ui()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Nae(r/1960))-r,10<r){n.timeoutHandle=NP(_m.bind(null,n,qa,Qc),r);break}_m(n,qa,Qc);break;case 5:_m(n,qa,Qc);break;default:throw Error(et(329))}}}return Za(n,ui()),n.callbackNode===t?FW.bind(null,n):null}function YP(n,e){var t=E1;return n.current.memoizedState.isDehydrated&&(av(n,e).flags|=256),n=kC(n,e),n!==2&&(e=qa,qa=t,e!==null&&QP(e)),n}function QP(n){qa===null?qa=n:qa.push.apply(qa,n)}function Rae(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!fu(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Qd(n,e){for(e&=~Ak,e&=~L2,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-cu(e),r=1<<t;n[t]=-1,e&=~r}}function gV(n){if(Pn&6)throw Error(et(327));vy();var e=xC(n,0);if(!(e&1))return Za(n,ui()),null;var t=kC(n,e);if(n.tag!==0&&t===2){var r=wP(n);r!==0&&(e=r,t=YP(n,r))}if(t===1)throw t=ew,av(n,0),Qd(n,e),Za(n,ui()),t;if(t===6)throw Error(et(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,_m(n,qa,Qc),Za(n,ui()),null}function Mk(n,e){var t=Pn;Pn|=1;try{return n(e)}finally{Pn=t,Pn===0&&(ab=ui()+500,R2&&Vp())}}function yv(n){Qf!==null&&Qf.tag===0&&!(Pn&6)&&vy();var e=Pn;Pn|=1;var t=_l.transition,r=Qn;try{if(_l.transition=null,Qn=1,n)return n()}finally{Qn=r,_l.transition=t,Pn=e,!(Pn&6)&&Vp()}}function Ck(){Co=Y0.current,Sr(Y0)}function av(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,oae(t)),xi!==null)for(t=xi.return;t!==null;){var r=t;switch(lk(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&SC();break;case 3:ib(),Sr(Ya),Sr(ta),vk();break;case 5:gk(r);break;case 4:ib();break;case 13:Sr(Or);break;case 19:Sr(Or);break;case 10:dk(r.type._context);break;case 22:case 23:Ck()}t=t.return}if(as=n,xi=n=cp(n.current,null),Ms=Co=e,Ii=0,ew=null,Ak=L2=vv=0,qa=E1=null,Om!==null){for(e=0;e<Om.length;e++)if(t=Om[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}t.pending=r}Om=null}return n}function LW(n,e){do{var t=xi;try{if(hk(),sM.current=PC,IC){for(var r=Br.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}IC=!1}if(gv=0,is=Ni=Br=null,_1=!1,Q1=0,Sk.current=null,t===null||t.return===null){Ii=1,ew=e,xi=null;break}e:{var s=n,a=t.return,o=t,l=e;if(e=Ms,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=rV(a);if(f!==null){f.flags&=-257,iV(f,a,o,s,e),f.mode&1&&nV(s,u,e),e=f,l=u;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){nV(s,u,e),Dk();break e}l=Error(et(426))}}else if(Nr&&o.mode&1){var y=rV(a);if(y!==null){!(y.flags&65536)&&(y.flags|=256),iV(y,a,o,s,e),uk(sb(l,o));break e}}s=l=sb(l,o),Ii!==4&&(Ii=2),E1===null?E1=[s]:E1.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=yW(s,l,e);Y5(s,v);break e;case 1:o=l;var b=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof b.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(lp===null||!lp.has(x)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=xW(s,o,e);Y5(s,w);break e}}s=s.return}while(s!==null)}BW(t)}catch(_){e=_,xi===t&&t!==null&&(xi=t=t.return);continue}break}while(!0)}function OW(){var n=FC.current;return FC.current=PC,n===null?PC:n}function Dk(){(Ii===0||Ii===3||Ii===2)&&(Ii=4),as===null||!(vv&268435455)&&!(L2&268435455)||Qd(as,Ms)}function kC(n,e){var t=Pn;Pn|=2;var r=OW();(as!==n||Ms!==e)&&(Qc=null,av(n,e));do try{Iae();break}catch(i){LW(n,i)}while(!0);if(hk(),Pn=t,FC.current=r,xi!==null)throw Error(et(261));return as=null,Ms=0,Ii}function Iae(){for(;xi!==null;)kW(xi)}function Pae(){for(;xi!==null&&!ise();)kW(xi)}function kW(n){var e=VW(n.alternate,n,Co);n.memoizedProps=n.pendingProps,e===null?BW(n):xi=e,Sk.current=null}function BW(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=Tae(t,e),t!==null){t.flags&=32767,xi=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Ii=6,xi=null;return}}else if(t=Aae(t,e,Co),t!==null){xi=t;return}if(e=e.sibling,e!==null){xi=e;return}xi=e=n}while(e!==null);Ii===0&&(Ii=5)}function _m(n,e,t){var r=Qn,i=_l.transition;try{_l.transition=null,Qn=1,Fae(n,e,t,r)}finally{_l.transition=i,Qn=r}return null}function Fae(n,e,t,r){do vy();while(Qf!==null);if(Pn&6)throw Error(et(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(et(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(pse(n,s),n===as&&(xi=as=null,Ms=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||zA||(zA=!0,zW(yC,function(){return vy(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=_l.transition,_l.transition=null;var a=Qn;Qn=1;var o=Pn;Pn|=4,Sk.current=null,Cae(n,t),IW(t,n),eae(CP),bC=!!MP,CP=MP=null,n.current=t,Dae(t),sse(),Pn=o,Qn=a,_l.transition=s}else n.current=t;if(zA&&(zA=!1,Qf=n,OC=i),s=n.pendingLanes,s===0&&(lp=null),lse(t.stateNode),Za(n,ui()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(LC)throw LC=!1,n=XP,XP=null,n;return OC&1&&n.tag!==0&&vy(),s=n.pendingLanes,s&1?n===KP?S1++:(S1=0,KP=n):S1=0,Vp(),null}function vy(){if(Qf!==null){var n=yq(OC),e=_l.transition,t=Qn;try{if(_l.transition=null,Qn=16>n?16:n,Qf===null)var r=!1;else{if(n=Qf,Qf=null,OC=0,Pn&6)throw Error(et(331));var i=Pn;for(Pn|=4,gt=n.current;gt!==null;){var s=gt,a=s.child;if(gt.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(gt=u;gt!==null;){var c=gt;switch(c.tag){case 0:case 11:case 15:w1(8,c,s)}var h=c.child;if(h!==null)h.return=c,gt=h;else for(;gt!==null;){c=gt;var d=c.sibling,f=c.return;if(DW(c),c===u){gt=null;break}if(d!==null){d.return=f,gt=d;break}gt=f}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(m!==null)}}gt=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,gt=a;else e:for(;gt!==null;){if(s=gt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:w1(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,gt=v;break e}gt=s.return}}var b=n.current;for(gt=b;gt!==null;){a=gt;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,gt=x;else e:for(a=b;gt!==null;){if(o=gt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:F2(9,o)}}catch(_){Yr(o,o.return,_)}if(o===a){gt=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,gt=w;break e}gt=o.return}}if(Pn=i,Vp(),uc&&typeof uc.onPostCommitFiberRoot=="function")try{uc.onPostCommitFiberRoot(T2,n)}catch{}r=!0}return r}finally{Qn=t,_l.transition=e}}return!1}function vV(n,e,t){e=sb(t,e),e=yW(n,e,1),n=op(n,e,1),e=_a(),n!==null&&(AS(n,1,e),Za(n,e))}function Yr(n,e,t){if(n.tag===3)vV(n,n,t);else for(;e!==null;){if(e.tag===3){vV(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(lp===null||!lp.has(r))){n=sb(t,n),n=xW(e,n,1),e=op(e,n,1),n=_a(),e!==null&&(AS(e,1,n),Za(e,n));break}}e=e.return}}function Lae(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=_a(),n.pingedLanes|=n.suspendedLanes&t,as===n&&(Ms&t)===t&&(Ii===4||Ii===3&&(Ms&130023424)===Ms&&500>ui()-Tk?av(n,0):Ak|=t),Za(n,e)}function UW(n,e){e===0&&(n.mode&1?(e=RA,RA<<=1,!(RA&130023424)&&(RA=4194304)):e=1);var t=_a();n=id(n,e),n!==null&&(AS(n,e,t),Za(n,t))}function Oae(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),UW(n,t)}function kae(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(et(314))}r!==null&&r.delete(e),UW(n,t)}var VW;VW=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Ya.current)Xa=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Xa=!1,Sae(n,e,t);Xa=!!(n.flags&131072)}else Xa=!1,Nr&&e.flags&1048576&&Gq(e,MC,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;oM(n,e),n=e.pendingProps;var i=tb(e,ta.current);gy(e,t),i=xk(null,e,r,n,i,t);var s=bk();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Qa(r)?(s=!0,AC(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,pk(e),i.updater=P2,e.stateNode=i,i._reactInternals=e,kP(e,r,n,t),e=VP(null,e,r,!0,s,t)):(e.tag=0,Nr&&s&&ok(e),ya(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(oM(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=Uae(r),n=Hl(r,n),i){case 0:e=UP(null,e,r,n,t);break e;case 1:e=oV(null,e,r,n,t);break e;case 11:e=sV(null,e,r,n,t);break e;case 14:e=aV(null,e,r,Hl(r.type,n),t);break e}throw Error(et(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hl(r,i),UP(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hl(r,i),oV(n,e,r,i,t);case 3:e:{if(EW(e),n===null)throw Error(et(387));r=e.pendingProps,s=e.memoizedState,i=s.element,Yq(n,e),NC(e,r,null,t);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=sb(Error(et(423)),e),e=lV(n,e,r,t,i);break e}else if(r!==i){i=sb(Error(et(424)),e),e=lV(n,e,r,t,i);break e}else for(Lo=ap(e.stateNode.containerInfo.firstChild),ko=e,Nr=!0,ru=null,t=Xq(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(nb(),r===i){e=sd(n,e,t);break e}ya(n,e,r,t)}e=e.child}return e;case 5:return Qq(e),n===null&&FP(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,a=i.children,DP(r,i)?a=null:s!==null&&DP(r,s)&&(e.flags|=32),wW(n,e),ya(n,e,a,t),e.child;case 6:return n===null&&FP(e),null;case 13:return SW(n,e,t);case 4:return mk(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=rb(e,null,r,t):ya(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hl(r,i),sV(n,e,r,i,t);case 7:return ya(n,e,e.pendingProps,t),e.child;case 8:return ya(n,e,e.pendingProps.children,t),e.child;case 12:return ya(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,xr(CC,r._currentValue),r._currentValue=a,s!==null)if(fu(s.value,a)){if(s.children===i.children&&!Ya.current){e=sd(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=jh(-1,t&-t),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),LP(s.return,t,e),o.lanes|=t;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(et(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),LP(a,t,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}ya(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,gy(e,t),i=Tl(i),r=r(i),e.flags|=1,ya(n,e,r,t),e.child;case 14:return r=e.type,i=Hl(r,e.pendingProps),i=Hl(r.type,i),aV(n,e,r,i,t);case 15:return bW(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hl(r,i),oM(n,e),e.tag=1,Qa(r)?(n=!0,AC(e)):n=!1,gy(e,t),vW(e,r,i),kP(e,r,i,t),VP(null,e,r,!0,n,t);case 19:return AW(n,e,t);case 22:return _W(n,e,t)}throw Error(et(156,e.tag))};function zW(n,e){return pq(n,e)}function Bae(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xl(n,e,t,r){return new Bae(n,e,t,r)}function Nk(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Uae(n){if(typeof n=="function")return Nk(n)?1:0;if(n!=null){if(n=n.$$typeof,n===KO)return 11;if(n===YO)return 14}return 2}function cp(n,e){var t=n.alternate;return t===null?(t=xl(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function cM(n,e,t,r,i,s){var a=2;if(r=n,typeof n=="function")Nk(n)&&(a=1);else if(typeof n=="string")a=5;else e:switch(n){case V0:return ov(t.children,i,s,e);case XO:a=8,i|=8;break;case oP:return n=xl(12,t,e,i|2),n.elementType=oP,n.lanes=s,n;case lP:return n=xl(13,t,e,i),n.elementType=lP,n.lanes=s,n;case uP:return n=xl(19,t,e,i),n.elementType=uP,n.lanes=s,n;case Qj:return O2(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Kj:a=10;break e;case Yj:a=9;break e;case KO:a=11;break e;case YO:a=14;break e;case qd:a=16,r=null;break e}throw Error(et(130,n==null?n:typeof n,""))}return e=xl(a,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function ov(n,e,t,r){return n=xl(7,n,r,e),n.lanes=t,n}function O2(n,e,t,r){return n=xl(22,n,r,e),n.elementType=Qj,n.lanes=t,n.stateNode={isHidden:!1},n}function CR(n,e,t){return n=xl(6,n,null,e),n.lanes=t,n}function DR(n,e,t){return e=xl(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function Vae(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=uR(0),this.expirationTimes=uR(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=uR(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Rk(n,e,t,r,i,s,a,o,l){return n=new Vae(n,e,t,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=xl(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},pk(s),n}function zae(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U0,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function $W(n){if(!n)return yp;n=n._reactInternals;e:{if(Iv(n)!==n||n.tag!==1)throw Error(et(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Qa(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(et(171))}if(n.tag===1){var t=n.type;if(Qa(t))return $q(n,t,e)}return e}function HW(n,e,t,r,i,s,a,o,l){return n=Rk(t,r,!0,n,i,s,a,o,l),n.context=$W(null),t=n.current,r=_a(),i=up(t),s=jh(r,i),s.callback=e??null,op(t,s,i),n.current.lanes=i,AS(n,i,r),Za(n,r),n}function k2(n,e,t,r){var i=e.current,s=_a(),a=up(i);return t=$W(t),e.context===null?e.context=t:e.pendingContext=t,e=jh(s,a),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=op(i,e,a),n!==null&&(hu(n,i,a,s),iM(n,i,a)),a}function BC(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function yV(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Ik(n,e){yV(n,e),(n=n.alternate)&&yV(n,e)}function $ae(){return null}var GW=typeof reportError=="function"?reportError:function(n){console.error(n)};function Pk(n){this._internalRoot=n}B2.prototype.render=Pk.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(et(409));k2(n,e,null,null)};B2.prototype.unmount=Pk.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;yv(function(){k2(null,n,null,null)}),e[rd]=null}};function B2(n){this._internalRoot=n}B2.prototype.unstable_scheduleHydration=function(n){if(n){var e=_q();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Yd.length&&e!==0&&e<Yd[t].priority;t++);Yd.splice(t,0,n),t===0&&Eq(n)}};function Fk(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function U2(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function xV(){}function Hae(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=BC(a);s.call(u)}}var a=HW(e,r,n,0,null,!1,!1,"",xV);return n._reactRootContainer=a,n[rd]=a.current,q1(n.nodeType===8?n.parentNode:n),yv(),a}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var u=BC(l);o.call(u)}}var l=Rk(n,0,!1,null,null,!1,!1,"",xV);return n._reactRootContainer=l,n[rd]=l.current,q1(n.nodeType===8?n.parentNode:n),yv(function(){k2(e,l,t,r)}),l}function V2(n,e,t,r,i){var s=t._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=BC(a);o.call(l)}}k2(e,a,n,i)}else a=Hae(t,e,n,i,r);return BC(a)}xq=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=O_(e.pendingLanes);t!==0&&(JO(e,t|1),Za(e,ui()),!(Pn&6)&&(ab=ui()+500,Vp()))}break;case 13:yv(function(){var r=id(n,1);if(r!==null){var i=_a();hu(r,n,1,i)}}),Ik(n,1)}};ek=function(n){if(n.tag===13){var e=id(n,134217728);if(e!==null){var t=_a();hu(e,n,134217728,t)}Ik(n,134217728)}};bq=function(n){if(n.tag===13){var e=up(n),t=id(n,e);if(t!==null){var r=_a();hu(t,n,e,r)}Ik(n,e)}};_q=function(){return Qn};wq=function(n,e){var t=Qn;try{return Qn=n,e()}finally{Qn=t}};xP=function(n,e,t){switch(e){case"input":if(dP(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=N2(r);if(!i)throw Error(et(90));Jj(r),dP(r,i)}}}break;case"textarea":tq(n,t);break;case"select":e=t.value,e!=null&&dy(n,!!t.multiple,e,!1)}};lq=Mk;uq=yv;var Gae={usingClientEntryPoint:!1,Events:[MS,G0,N2,aq,oq,Mk]},m_={findFiberByHostInstance:Lm,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},jae={bundleType:m_.bundleType,version:m_.version,rendererPackageName:m_.rendererPackageName,rendererConfig:m_.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_d.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=dq(n),n===null?null:n.stateNode},findFiberByHostInstance:m_.findFiberByHostInstance||$ae,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $A=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$A.isDisabled&&$A.supportsFiber)try{T2=$A.inject(jae),uc=$A}catch{}}zo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Gae;zo.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fk(e))throw Error(et(200));return zae(n,e,null,t)};zo.createRoot=function(n,e){if(!Fk(n))throw Error(et(299));var t=!1,r="",i=GW;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Rk(n,1,!1,null,null,t,!1,r,i),n[rd]=e.current,q1(n.nodeType===8?n.parentNode:n),new Pk(e)};zo.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(et(188)):(n=Object.keys(n).join(","),Error(et(268,n)));return n=dq(e),n=n===null?null:n.stateNode,n};zo.flushSync=function(n){return yv(n)};zo.hydrate=function(n,e,t){if(!U2(e))throw Error(et(200));return V2(null,n,e,!0,t)};zo.hydrateRoot=function(n,e,t){if(!Fk(n))throw Error(et(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",a=GW;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=HW(e,null,n,1,t??null,i,!1,s,a),n[rd]=e.current,q1(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new B2(e)};zo.render=function(n,e,t){if(!U2(e))throw Error(et(200));return V2(null,n,e,!1,t)};zo.unmountComponentAtNode=function(n){if(!U2(n))throw Error(et(40));return n._reactRootContainer?(yv(function(){V2(null,null,n,!1,function(){n._reactRootContainer=null,n[rd]=null})}),!0):!1};zo.unstable_batchedUpdates=Mk;zo.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!U2(t))throw Error(et(200));if(n==null||n._reactInternals===void 0)throw Error(et(38));return V2(n,e,t,!1,r)};zo.version="18.3.1-next-f1338f8080-20240426";function jW(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jW)}catch(n){console.error(n)}}jW(),jj.exports=zo;var qae=jj.exports,bV=qae;sP.createRoot=bV.createRoot,sP.hydrateRoot=bV.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tw(){return tw=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},tw.apply(this,arguments)}var Zf;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Zf||(Zf={}));const _V="popstate";function Wae(n){n===void 0&&(n={});function e(r,i){let{pathname:s,search:a,hash:o}=r.location;return ZP("",{pathname:s,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){return typeof i=="string"?i:UC(i)}return Kae(e,t,null,n)}function ci(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Lk(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Xae(){return Math.random().toString(36).substr(2,8)}function wV(n,e){return{usr:n.state,key:n.key,idx:e}}function ZP(n,e,t,r){return t===void 0&&(t=null),tw({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Rb(e):e,{state:t,key:e&&e.key||r||Xae()})}function UC(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Rb(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function Kae(n,e,t,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,a=i.history,o=Zf.Pop,l=null,u=c();u==null&&(u=0,a.replaceState(tw({},a.state,{idx:u}),""));function c(){return(a.state||{idx:null}).idx}function h(){o=Zf.Pop;let y=c(),v=y==null?null:y-u;u=y,l&&l({action:o,location:m.location,delta:v})}function d(y,v){o=Zf.Push;let b=ZP(m.location,y,v);u=c()+1;let x=wV(b,u),w=m.createHref(b);try{a.pushState(x,"",w)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;i.location.assign(w)}s&&l&&l({action:o,location:m.location,delta:1})}function f(y,v){o=Zf.Replace;let b=ZP(m.location,y,v);u=c();let x=wV(b,u),w=m.createHref(b);a.replaceState(x,"",w),s&&l&&l({action:o,location:m.location,delta:0})}function p(y){let v=i.location.origin!=="null"?i.location.origin:i.location.href,b=typeof y=="string"?y:UC(y);return b=b.replace(/ $/,"%20"),ci(v,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,v)}let m={get action(){return o},get location(){return n(i,a)},listen(y){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(_V,h),l=y,()=>{i.removeEventListener(_V,h),l=null}},createHref(y){return e(i,y)},createURL:p,encodeLocation(y){let v=p(y);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:d,replace:f,go(y){return a.go(y)}};return m}var EV;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(EV||(EV={}));function Yae(n,e,t){return t===void 0&&(t="/"),Qae(n,e,t)}function Qae(n,e,t,r){let i=typeof e=="string"?Rb(e):e,s=Ok(i.pathname||"/",t);if(s==null)return null;let a=qW(n);Zae(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let u=coe(s);o=ooe(a[l],u)}return o}function qW(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let i=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(ci(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=hp([r,l.relativePath]),c=t.concat(l);s.children&&s.children.length>0&&(ci(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),qW(s.children,e,c,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:soe(u,s.index),routesMeta:c})};return n.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let l of WW(s.path))i(s,a,l)}),e}function WW(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let a=WW(r.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),i&&o.push(...a),o.map(l=>n.startsWith("/")&&l===""?"/":l)}function Zae(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:aoe(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const Jae=/^:[\w-]+$/,eoe=3,toe=2,noe=1,roe=10,ioe=-2,SV=n=>n==="*";function soe(n,e){let t=n.split("/"),r=t.length;return t.some(SV)&&(r+=ioe),e&&(r+=toe),t.filter(i=>!SV(i)).reduce((i,s)=>i+(Jae.test(s)?eoe:s===""?noe:roe),r)}function aoe(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function ooe(n,e,t){let{routesMeta:r}=n,i={},s="/",a=[];for(let o=0;o<r.length;++o){let l=r[o],u=o===r.length-1,c=s==="/"?e:e.slice(s.length)||"/",h=loe({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),d=l.route;if(!h)return null;Object.assign(i,h.params),a.push({params:i,pathname:hp([s,h.pathname]),pathnameBase:moe(hp([s,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(s=hp([s,h.pathnameBase]))}return a}function loe(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=uoe(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:r.reduce((u,c,h)=>{let{paramName:d,isOptional:f}=c;if(d==="*"){let m=o[h]||"";a=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const p=o[h];return f&&!p?u[d]=void 0:u[d]=(p||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:a,pattern:n}}function uoe(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Lk(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(r.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function coe(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Lk(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Ok(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}const hoe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,doe=n=>hoe.test(n);function foe(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?Rb(n):n,s;if(t)if(doe(t))s=t;else{if(t.includes("//")){let a=t;t=t.replace(/\/\/+/g,"/"),Lk(!1,"Pathnames cannot have embedded double slashes - normalizing "+(a+" -> "+t))}t.startsWith("/")?s=AV(t.substring(1),"/"):s=AV(t,e)}else s=e;return{pathname:s,search:goe(r),hash:voe(i)}}function AV(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function NR(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function poe(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function kk(n,e){let t=poe(n);return e?t.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function Bk(n,e,t,r){r===void 0&&(r=!1);let i;typeof n=="string"?i=Rb(n):(i=tw({},n),ci(!i.pathname||!i.pathname.includes("?"),NR("?","pathname","search",i)),ci(!i.pathname||!i.pathname.includes("#"),NR("#","pathname","hash",i)),ci(!i.search||!i.search.includes("#"),NR("#","search","hash",i)));let s=n===""||i.pathname==="",a=s?"/":i.pathname,o;if(a==null)o=t;else{let h=e.length-1;if(!r&&a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),h-=1;i.pathname=d.join("/")}o=h>=0?e[h]:"/"}let l=foe(i,o),u=a&&a!=="/"&&a.endsWith("/"),c=(s||a===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const hp=n=>n.join("/").replace(/\/\/+/g,"/"),moe=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),goe=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,voe=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function yoe(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const XW=["post","put","patch","delete"];new Set(XW);const xoe=["get",...XW];new Set(xoe);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function nw(){return nw=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},nw.apply(this,arguments)}const Uk=xe.createContext(null),boe=xe.createContext(null),zp=xe.createContext(null),z2=xe.createContext(null),Nc=xe.createContext({outlet:null,matches:[],isDataRoute:!1}),KW=xe.createContext(null);function _oe(n,e){let{relative:t}=e===void 0?{}:e;Ib()||ci(!1);let{basename:r,navigator:i}=xe.useContext(zp),{hash:s,pathname:a,search:o}=ZW(n,{relative:t}),l=a;return r!=="/"&&(l=a==="/"?r:hp([r,a])),i.createHref({pathname:l,search:o,hash:s})}function Ib(){return xe.useContext(z2)!=null}function Pb(){return Ib()||ci(!1),xe.useContext(z2).location}function YW(n){xe.useContext(zp).static||xe.useLayoutEffect(n)}function Fb(){let{isDataRoute:n}=xe.useContext(Nc);return n?Ooe():woe()}function woe(){Ib()||ci(!1);let n=xe.useContext(Uk),{basename:e,future:t,navigator:r}=xe.useContext(zp),{matches:i}=xe.useContext(Nc),{pathname:s}=Pb(),a=JSON.stringify(kk(i,t.v7_relativeSplatPath)),o=xe.useRef(!1);return YW(()=>{o.current=!0}),xe.useCallback(function(u,c){if(c===void 0&&(c={}),!o.current)return;if(typeof u=="number"){r.go(u);return}let h=Bk(u,JSON.parse(a),s,c.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:hp([e,h.pathname])),(c.replace?r.replace:r.push)(h,c.state,c)},[e,r,a,s,n])}const Eoe=xe.createContext(null);function Soe(n){let e=xe.useContext(Nc).outlet;return e&&xe.createElement(Eoe.Provider,{value:n},e)}function QW(){let{matches:n}=xe.useContext(Nc),e=n[n.length-1];return e?e.params:{}}function ZW(n,e){let{relative:t}=e===void 0?{}:e,{future:r}=xe.useContext(zp),{matches:i}=xe.useContext(Nc),{pathname:s}=Pb(),a=JSON.stringify(kk(i,r.v7_relativeSplatPath));return xe.useMemo(()=>Bk(n,JSON.parse(a),s,t==="path"),[n,a,s,t])}function Aoe(n,e){return Toe(n,e)}function Toe(n,e,t,r){Ib()||ci(!1);let{navigator:i}=xe.useContext(zp),{matches:s}=xe.useContext(Nc),a=s[s.length-1],o=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let u=Pb(),c;if(e){var h;let y=typeof e=="string"?Rb(e):e;l==="/"||(h=y.pathname)!=null&&h.startsWith(l)||ci(!1),c=y}else c=u;let d=c.pathname||"/",f=d;if(l!=="/"){let y=l.replace(/^\//,"").split("/");f="/"+d.replace(/^\//,"").split("/").slice(y.length).join("/")}let p=Yae(n,{pathname:f}),m=Roe(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},o,y.params),pathname:hp([l,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:hp([l,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,t,r);return e&&m?xe.createElement(z2.Provider,{value:{location:nw({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Zf.Pop}},m):m}function Moe(){let n=Loe(),e=yoe(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return xe.createElement(xe.Fragment,null,xe.createElement("h2",null,"Unexpected Application Error!"),xe.createElement("h3",{style:{fontStyle:"italic"}},e),t?xe.createElement("pre",{style:i},t):null,null)}const Coe=xe.createElement(Moe,null);class Doe extends xe.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?xe.createElement(Nc.Provider,{value:this.props.routeContext},xe.createElement(KW.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Noe(n){let{routeContext:e,match:t,children:r}=n,i=xe.useContext(Uk);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),xe.createElement(Nc.Provider,{value:e},r)}function Roe(n,e,t,r){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var s;if(!t)return null;if(t.errors)n=t.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=(i=t)==null?void 0:i.errors;if(o!=null){let c=a.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);c>=0||ci(!1),a=a.slice(0,Math.min(a.length,c+1))}let l=!1,u=-1;if(t&&r&&r.v7_partialHydration)for(let c=0;c<a.length;c++){let h=a[c];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=c),h.route.id){let{loaderData:d,errors:f}=t,p=h.route.loader&&d[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||p){l=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((c,h,d)=>{let f,p=!1,m=null,y=null;t&&(f=o&&h.route.id?o[h.route.id]:void 0,m=h.route.errorElement||Coe,l&&(u<0&&d===0?(koe("route-fallback"),p=!0,y=null):u===d&&(p=!0,y=h.route.hydrateFallbackElement||null)));let v=e.concat(a.slice(0,d+1)),b=()=>{let x;return f?x=m:p?x=y:h.route.Component?x=xe.createElement(h.route.Component,null):h.route.element?x=h.route.element:x=c,xe.createElement(Noe,{match:h,routeContext:{outlet:c,matches:v,isDataRoute:t!=null},children:x})};return t&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?xe.createElement(Doe,{location:t.location,revalidation:t.revalidation,component:m,error:f,children:b(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):b()},null)}var JW=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(JW||{}),eX=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(eX||{});function Ioe(n){let e=xe.useContext(Uk);return e||ci(!1),e}function Poe(n){let e=xe.useContext(boe);return e||ci(!1),e}function Foe(n){let e=xe.useContext(Nc);return e||ci(!1),e}function tX(n){let e=Foe(),t=e.matches[e.matches.length-1];return t.route.id||ci(!1),t.route.id}function Loe(){var n;let e=xe.useContext(KW),t=Poe(),r=tX();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function Ooe(){let{router:n}=Ioe(JW.UseNavigateStable),e=tX(eX.UseNavigateStable),t=xe.useRef(!1);return YW(()=>{t.current=!0}),xe.useCallback(function(i,s){s===void 0&&(s={}),t.current&&(typeof i=="number"?n.navigate(i):n.navigate(i,nw({fromRouteId:e},s)))},[n,e])}const TV={};function koe(n,e,t){TV[n]||(TV[n]=!0)}function Boe(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function Uoe(n){let{to:e,replace:t,state:r,relative:i}=n;Ib()||ci(!1);let{future:s,static:a}=xe.useContext(zp),{matches:o}=xe.useContext(Nc),{pathname:l}=Pb(),u=Fb(),c=Bk(e,kk(o,s.v7_relativeSplatPath),l,i==="path"),h=JSON.stringify(c);return xe.useEffect(()=>u(JSON.parse(h),{replace:t,state:r,relative:i}),[u,h,i,t,r]),null}function Voe(n){return Soe(n.context)}function us(n){ci(!1)}function zoe(n){let{basename:e="/",children:t=null,location:r,navigationType:i=Zf.Pop,navigator:s,static:a=!1,future:o}=n;Ib()&&ci(!1);let l=e.replace(/^\/*/,"/"),u=xe.useMemo(()=>({basename:l,navigator:s,static:a,future:nw({v7_relativeSplatPath:!1},o)}),[l,o,s,a]);typeof r=="string"&&(r=Rb(r));let{pathname:c="/",search:h="",hash:d="",state:f=null,key:p="default"}=r,m=xe.useMemo(()=>{let y=Ok(c,l);return y==null?null:{location:{pathname:y,search:h,hash:d,state:f,key:p},navigationType:i}},[l,c,h,d,f,p,i]);return m==null?null:xe.createElement(zp.Provider,{value:u},xe.createElement(z2.Provider,{children:t,value:m}))}function $oe(n){let{children:e,location:t}=n;return Aoe(JP(e),t)}new Promise(()=>{});function JP(n,e){e===void 0&&(e=[]);let t=[];return xe.Children.forEach(n,(r,i)=>{if(!xe.isValidElement(r))return;let s=[...e,i];if(r.type===xe.Fragment){t.push.apply(t,JP(r.props.children,s));return}r.type!==us&&ci(!1),!r.props.index||!r.props.children||ci(!1);let a={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=JP(r.props.children,s)),t.push(a)}),t}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function e3(){return e3=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},e3.apply(this,arguments)}function Hoe(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function Goe(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function joe(n,e){return n.button===0&&(!e||e==="_self")&&!Goe(n)}const qoe=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Woe="6";try{window.__reactRouterVersion=Woe}catch{}const Xoe="startTransition",MV=Lie[Xoe];function Koe(n){let{basename:e,children:t,future:r,window:i}=n,s=xe.useRef();s.current==null&&(s.current=Wae({window:i,v5Compat:!0}));let a=s.current,[o,l]=xe.useState({action:a.action,location:a.location}),{v7_startTransition:u}=r||{},c=xe.useCallback(h=>{u&&MV?MV(()=>l(h)):l(h)},[l,u]);return xe.useLayoutEffect(()=>a.listen(c),[a,c]),xe.useEffect(()=>Boe(r),[r]),xe.createElement(zoe,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:a,future:r})}const Yoe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Qoe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,hr=xe.forwardRef(function(e,t){let{onClick:r,relative:i,reloadDocument:s,replace:a,state:o,target:l,to:u,preventScrollReset:c,viewTransition:h}=e,d=Hoe(e,qoe),{basename:f}=xe.useContext(zp),p,m=!1;if(typeof u=="string"&&Qoe.test(u)&&(p=u,Yoe))try{let x=new URL(window.location.href),w=u.startsWith("//")?new URL(x.protocol+u):new URL(u),_=Ok(w.pathname,f);w.origin===x.origin&&_!=null?u=_+w.search+w.hash:m=!0}catch{}let y=_oe(u,{relative:i}),v=Zoe(u,{replace:a,state:o,target:l,preventScrollReset:c,relative:i,viewTransition:h});function b(x){r&&r(x),x.defaultPrevented||v(x)}return xe.createElement("a",e3({},d,{href:p||y,onClick:m||s?r:b,ref:t,target:l}))});var CV;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(CV||(CV={}));var DV;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(DV||(DV={}));function Zoe(n,e){let{target:t,replace:r,state:i,preventScrollReset:s,relative:a,viewTransition:o}=e===void 0?{}:e,l=Fb(),u=Pb(),c=ZW(n,{relative:a});return xe.useCallback(h=>{if(joe(h,t)){h.preventDefault();let d=r!==void 0?r:UC(u)===UC(c);l(n,{replace:d,state:i,preventScrollReset:s,relative:a,viewTransition:o})}},[u,l,c,r,i,t,n,s,a,o])}const nX=xe.createContext(),Nl=()=>{const n=xe.useContext(nX);if(!n)throw new Error("useTheme must be used within ThemeProvider");return n},Joe=({children:n})=>{const[e,t]=xe.useState(()=>{const i=localStorage.getItem("theme");return i?i==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches});xe.useEffect(()=>{const i=document.documentElement;e?i.classList.add("dark"):i.classList.remove("dark"),localStorage.setItem("theme",e?"dark":"light")},[e]);const r=()=>{t(i=>!i)};return k.jsx(nX.Provider,{value:{isDark:e,toggleTheme:r},children:n})},rX="authToken",iX="user",ele=()=>localStorage.getItem(rX),tle=()=>{localStorage.removeItem(rX)},xp=()=>{const n=localStorage.getItem(iX);return n?JSON.parse(n):null},nle=()=>{localStorage.removeItem(iX)},t3=()=>!!ele(),rle=()=>{tle(),nle()};function ile(){const{isDark:n,toggleTheme:e}=Nl(),t=Fb(),[r,i]=xe.useState(!1),[s,a]=xe.useState(!1),[o,l]=xe.useState(null),[u,c]=xe.useState(!1);xe.useEffect(()=>{t3()&&(l(xp()),c(!0));const f=()=>{t3()?(l(xp()),c(!0)):(l(null),c(!1))};return window.addEventListener("auth-change",f),()=>window.removeEventListener("auth-change",f)},[]);const h=()=>{rle(),localStorage.removeItem("user"),localStorage.removeItem("authToken"),l(null),c(!1),a(!1),i(!1),window.dispatchEvent(new Event("auth-change")),t("/")},d=[{to:"/",label:""},{to:"/concepts",label:""},{to:"/papers",label:" "},{to:"/visualizations",label:""},{to:"/calculator",label:""},{to:"/forum",label:""},{to:"/glossary",label:" "},{to:"/references",label:" "},...u&&o?[{to:"/notes",label:""}]:[]];return k.jsx("header",{className:`sticky top-0 z-40 transition-colors duration-300 ${n?"bg-gray-900 border-gray-800":"bg-white border-gray-200"} border-b backdrop-blur`,children:k.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[k.jsxs("div",{className:"flex items-center justify-between",children:[k.jsx(hr,{to:"/",className:"text-xl sm:text-2xl font-bold text-blue-500 dark:text-blue-400 whitespace-nowrap",children:"Astro Hub"}),k.jsxs("nav",{className:"hidden md:flex items-center gap-3 lg:gap-6",children:[d.map(f=>k.jsx(hr,{to:f.to,className:`transition text-sm lg:text-base ${n?"text-gray-300 hover:text-blue-400":"text-gray-600 hover:text-blue-600"}`,children:f.label},f.to)),k.jsx("button",{onClick:e,className:`p-2 rounded-lg border transition text-lg ${n?"border-gray-700 hover:bg-gray-800":"border-gray-300 hover:bg-gray-100"}`,"aria-label":" ",children:n?"":""}),u&&o?k.jsxs("div",{className:"relative",children:[k.jsxs("button",{onClick:()=>a(!s),className:`p-2 rounded-lg border transition ${n?"border-gray-700 hover:bg-gray-800":"border-gray-300 hover:bg-gray-100"}`,children:[" ",o.username]}),s&&k.jsxs("div",{className:`absolute right-0 mt-2 w-48 rounded-lg shadow-lg ${n?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border`,children:[k.jsx(hr,{to:"/profile",className:`block px-4 py-2 first:rounded-t-lg ${n?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-100"}`,onClick:()=>a(!1),children:""}),k.jsx(hr,{to:"/bookmarks",className:`block px-4 py-2 ${n?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-100"}`,onClick:()=>a(!1),children:""}),k.jsx(hr,{to:"/notes",className:`block px-4 py-2 ${n?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-100"}`,onClick:()=>a(!1),children:""}),k.jsx("button",{onClick:h,className:`w-full text-left px-4 py-2 last:rounded-b-lg ${n?"text-red-400 hover:bg-gray-700":"text-red-600 hover:bg-gray-100"}`,children:""})]})]}):k.jsxs("div",{className:"flex gap-2",children:[k.jsx(hr,{to:"/login",className:`px-4 py-2 rounded-lg border transition ${n?"border-blue-400 text-blue-400 hover:bg-blue-400 hover:text-gray-900":"border-blue-600 text-blue-600 hover:bg-blue-600 hover:text-white"}`,children:""}),k.jsx(hr,{to:"/signup",className:`px-4 py-2 rounded-lg transition text-white ${n?"bg-blue-600 hover:bg-blue-700":"bg-blue-500 hover:bg-blue-600"}`,children:""})]})]}),k.jsxs("div",{className:"md:hidden flex items-center gap-3",children:[k.jsx("button",{onClick:e,className:`p-2 rounded-lg border transition text-lg ${n?"border-gray-700 hover:bg-gray-800":"border-gray-300 hover:bg-gray-100"}`,"aria-label":" ",children:n?"":""}),k.jsx("button",{onClick:()=>i(!r),className:`p-2 transition ${n?"text-gray-300 hover:text-blue-400":"text-gray-600 hover:text-blue-600"}`,"aria-label":"",children:r?"":""})]})]}),r&&k.jsxs("nav",{className:`md:hidden mt-4 space-y-2 pb-4 border-t transition-colors duration-300 pt-4 ${n?"border-gray-800":"border-gray-200"}`,children:[d.map(f=>k.jsx(hr,{to:f.to,className:`block py-2 transition ${n?"text-gray-300 hover:text-blue-400":"text-gray-600 hover:text-blue-600"}`,onClick:()=>i(!1),children:f.label},f.to)),u&&o?k.jsx(k.Fragment,{children:k.jsxs("div",{className:`py-2 border-t transition-colors duration-300 ${n?"border-gray-800":"border-gray-200"} mt-2 pt-2`,children:[k.jsx("div",{className:`px-2 py-1 text-sm ${n?"text-gray-400":"text-gray-500"}`,children:o.username}),k.jsx(hr,{to:"/profile",className:`block py-2 transition ${n?"text-gray-300 hover:text-blue-400":"text-gray-600 hover:text-blue-600"}`,onClick:()=>i(!1),children:""}),k.jsx(hr,{to:"/bookmarks",className:`block py-2 transition ${n?"text-gray-300 hover:text-blue-400":"text-gray-600 hover:text-blue-600"}`,onClick:()=>i(!1),children:""}),k.jsx(hr,{to:"/notes",className:`block py-2 transition ${n?"text-gray-300 hover:text-blue-400":"text-gray-600 hover:text-blue-600"}`,onClick:()=>i(!1),children:""}),k.jsx("button",{onClick:h,className:`w-full text-left py-2 transition ${n?"text-red-400 hover:text-red-300":"text-red-600 hover:text-red-700"}`,children:""})]})}):k.jsxs("div",{className:`py-2 border-t transition-colors duration-300 mt-2 pt-2 ${n?"border-gray-800":"border-gray-200"}`,children:[k.jsx(hr,{to:"/login",className:`block py-2 transition ${n?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"}`,onClick:()=>i(!1),children:""}),k.jsx(hr,{to:"/signup",className:`block py-2 transition ${n?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"}`,onClick:()=>i(!1),children:""})]})]})]})})}function sle(){const[n,e]=xe.useState(0);return xe.useEffect(()=>{const t=()=>{const r=window.scrollY,i=document.documentElement.scrollHeight-window.innerHeight,s=i>0?r/i*100:0;e(Math.min(100,Math.max(0,s)))};return window.addEventListener("scroll",t,{passive:!0}),()=>window.removeEventListener("scroll",t)},[]),k.jsx("div",{className:"scroll-progress",children:k.jsx("div",{className:"scroll-progress__bar",style:{transform:`scaleX(${n/100})`}})})}function ale(){const{isDark:n}=Nl();return k.jsxs("div",{className:`min-h-screen transition-colors duration-300 ${n?"bg-gray-950 text-gray-100":"bg-white text-gray-900"}`,children:[k.jsx(sle,{}),k.jsx(ile,{}),k.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:k.jsx(Voe,{})}),k.jsx("footer",{className:`border-t py-6 text-center text-sm transition-colors duration-300 ${n?"bg-gray-900 border-gray-800 text-gray-400":"bg-gray-50 border-gray-200 text-gray-600"}`,children:k.jsx("p",{children:" 2025 Astrophysics Hub    "})})]})}const sX=xe.createContext({});function ole(n){const e=xe.useRef(null);return e.current===null&&(e.current=n()),e.current}const Vk=typeof window<"u",lle=Vk?xe.useLayoutEffect:xe.useEffect,zk=xe.createContext(null);function $k(n,e){n.indexOf(e)===-1&&n.push(e)}function Hk(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const ad=(n,e,t)=>t>e?e:t<n?n:t;let Gk=()=>{};const od={},aX=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function oX(n){return typeof n=="object"&&n!==null}const lX=n=>/^0[^.\s]+$/u.test(n);function jk(n){let e;return()=>(e===void 0&&(e=n()),e)}const wl=n=>n,ule=(n,e)=>t=>e(n(t)),DS=(...n)=>n.reduce(ule),rw=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r};class qk{constructor(){this.subscriptions=[]}add(e){return $k(this.subscriptions,e),()=>Hk(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let s=0;s<i;s++){const a=this.subscriptions[s];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const hc=n=>n*1e3,bl=n=>n/1e3;function uX(n,e){return e?n*(1e3/e):0}const cX=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,cle=1e-7,hle=12;function dle(n,e,t,r,i){let s,a,o=0;do a=e+(t-e)/2,s=cX(a,r,i)-n,s>0?t=a:e=a;while(Math.abs(s)>cle&&++o<hle);return a}function NS(n,e,t,r){if(n===e&&t===r)return wl;const i=s=>dle(s,0,1,n,t);return s=>s===0||s===1?s:cX(i(s),e,r)}const hX=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,dX=n=>e=>1-n(1-e),fX=NS(.33,1.53,.69,.99),Wk=dX(fX),pX=hX(Wk),mX=n=>(n*=2)<1?.5*Wk(n):.5*(2-Math.pow(2,-10*(n-1))),Xk=n=>1-Math.sin(Math.acos(n)),gX=dX(Xk),vX=hX(Xk),fle=NS(.42,0,1,1),ple=NS(0,0,.58,1),yX=NS(.42,0,.58,1),mle=n=>Array.isArray(n)&&typeof n[0]!="number",xX=n=>Array.isArray(n)&&typeof n[0]=="number",gle={linear:wl,easeIn:fle,easeInOut:yX,easeOut:ple,circIn:Xk,circInOut:vX,circOut:gX,backIn:Wk,backInOut:pX,backOut:fX,anticipate:mX},vle=n=>typeof n=="string",NV=n=>{if(xX(n)){Gk(n.length===4);const[e,t,r,i]=n;return NS(e,t,r,i)}else if(vle(n))return gle[n];return n},HA=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function yle(n,e){let t=new Set,r=new Set,i=!1,s=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(c){a.has(c)&&(u.schedule(c),n()),c(o)}const u={schedule:(c,h=!1,d=!1)=>{const p=d&&i?t:r;return h&&a.add(c),p.has(c)||p.add(c),c},cancel:c=>{r.delete(c),a.delete(c)},process:c=>{if(o=c,i){s=!0;return}i=!0,[t,r]=[r,t],t.forEach(l),t.clear(),i=!1,s&&(s=!1,u.process(c))}};return u}const xle=40;function bX(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,a=HA.reduce((x,w)=>(x[w]=yle(s),x),{}),{setup:o,read:l,resolveKeyframes:u,preUpdate:c,update:h,preRender:d,render:f,postRender:p}=a,m=()=>{const x=od.useManualTiming?i.timestamp:performance.now();t=!1,od.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(x-i.timestamp,xle),1)),i.timestamp=x,i.isProcessing=!0,o.process(i),l.process(i),u.process(i),c.process(i),h.process(i),d.process(i),f.process(i),p.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(m))},y=()=>{t=!0,r=!0,i.isProcessing||n(m)};return{schedule:HA.reduce((x,w)=>{const _=a[w];return x[w]=(E,A=!1,T=!1)=>(t||y(),_.schedule(E,A,T)),x},{}),cancel:x=>{for(let w=0;w<HA.length;w++)a[HA[w]].cancel(x)},state:i,steps:a}}const{schedule:Rr,cancel:bp,state:vs,steps:RR}=bX(typeof requestAnimationFrame<"u"?requestAnimationFrame:wl,!0);let hM;function ble(){hM=void 0}const Ka={now:()=>(hM===void 0&&Ka.set(vs.isProcessing||od.useManualTiming?vs.timestamp:performance.now()),hM),set:n=>{hM=n,queueMicrotask(ble)}},_X=n=>e=>typeof e=="string"&&e.startsWith(n),Kk=_X("--"),_le=_X("var(--"),Yk=n=>_le(n)?wle.test(n.split("/*")[0].trim()):!1,wle=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Lb={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},iw={...Lb,transform:n=>ad(0,1,n)},GA={...Lb,default:1},A1=n=>Math.round(n*1e5)/1e5,Qk=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Ele(n){return n==null}const Sle=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Zk=(n,e)=>t=>!!(typeof t=="string"&&Sle.test(t)&&t.startsWith(n)||e&&!Ele(t)&&Object.prototype.hasOwnProperty.call(t,e)),wX=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,s,a,o]=r.match(Qk);return{[n]:parseFloat(i),[e]:parseFloat(s),[t]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},Ale=n=>ad(0,255,n),IR={...Lb,transform:n=>Math.round(Ale(n))},Bm={test:Zk("rgb","red"),parse:wX("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+IR.transform(n)+", "+IR.transform(e)+", "+IR.transform(t)+", "+A1(iw.transform(r))+")"};function Tle(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const n3={test:Zk("#"),parse:Tle,transform:Bm.transform},RS=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Hd=RS("deg"),dc=RS("%"),Bt=RS("px"),Mle=RS("vh"),Cle=RS("vw"),RV={...dc,parse:n=>dc.parse(n)/100,transform:n=>dc.transform(n*100)},Q0={test:Zk("hsl","hue"),parse:wX("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+dc.transform(A1(e))+", "+dc.transform(A1(t))+", "+A1(iw.transform(r))+")"},yi={test:n=>Bm.test(n)||n3.test(n)||Q0.test(n),parse:n=>Bm.test(n)?Bm.parse(n):Q0.test(n)?Q0.parse(n):n3.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Bm.transform(n):Q0.transform(n),getAnimatableNone:n=>{const e=yi.parse(n);return e.alpha=0,yi.transform(e)}},Dle=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Nle(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(Qk))==null?void 0:e.length)||0)+(((t=n.match(Dle))==null?void 0:t.length)||0)>0}const EX="number",SX="color",Rle="var",Ile="var(",IV="${}",Ple=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function sw(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let s=0;const o=e.replace(Ple,l=>(yi.test(l)?(r.color.push(s),i.push(SX),t.push(yi.parse(l))):l.startsWith(Ile)?(r.var.push(s),i.push(Rle),t.push(l)):(r.number.push(s),i.push(EX),t.push(parseFloat(l))),++s,IV)).split(IV);return{values:t,split:o,indexes:r,types:i}}function AX(n){return sw(n).values}function TX(n){const{split:e,types:t}=sw(n),r=e.length;return i=>{let s="";for(let a=0;a<r;a++)if(s+=e[a],i[a]!==void 0){const o=t[a];o===EX?s+=A1(i[a]):o===SX?s+=yi.transform(i[a]):s+=i[a]}return s}}const Fle=n=>typeof n=="number"?0:yi.test(n)?yi.getAnimatableNone(n):n;function Lle(n){const e=AX(n);return TX(n)(e.map(Fle))}const _p={test:Nle,parse:AX,createTransformer:TX,getAnimatableNone:Lle};function PR(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function Ole({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,s=0,a=0;if(!e)i=s=a=t;else{const o=t<.5?t*(1+e):t+e-t*e,l=2*t-o;i=PR(l,o,n+1/3),s=PR(l,o,n),a=PR(l,o,n-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:r}}function VC(n,e){return t=>t>0?e:n}const kr=(n,e,t)=>n+(e-n)*t,FR=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},kle=[n3,Bm,Q0],Ble=n=>kle.find(e=>e.test(n));function PV(n){const e=Ble(n);if(!e)return!1;let t=e.parse(n);return e===Q0&&(t=Ole(t)),t}const FV=(n,e)=>{const t=PV(n),r=PV(e);if(!t||!r)return VC(n,e);const i={...t};return s=>(i.red=FR(t.red,r.red,s),i.green=FR(t.green,r.green,s),i.blue=FR(t.blue,r.blue,s),i.alpha=kr(t.alpha,r.alpha,s),Bm.transform(i))},r3=new Set(["none","hidden"]);function Ule(n,e){return r3.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function Vle(n,e){return t=>kr(n,e,t)}function Jk(n){return typeof n=="number"?Vle:typeof n=="string"?Yk(n)?VC:yi.test(n)?FV:Hle:Array.isArray(n)?MX:typeof n=="object"?yi.test(n)?FV:zle:VC}function MX(n,e){const t=[...n],r=t.length,i=n.map((s,a)=>Jk(s)(s,e[a]));return s=>{for(let a=0;a<r;a++)t[a]=i[a](s);return t}}function zle(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=Jk(n[i])(n[i],e[i]));return i=>{for(const s in r)t[s]=r[s](i);return t}}function $le(n,e){const t=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const s=e.types[i],a=n.indexes[s][r[s]],o=n.values[a]??0;t[i]=o,r[s]++}return t}const Hle=(n,e)=>{const t=_p.createTransformer(e),r=sw(n),i=sw(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?r3.has(n)&&!i.values.length||r3.has(e)&&!r.values.length?Ule(n,e):DS(MX($le(r,i),i.values),t):VC(n,e)};function CX(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?kr(n,e,t):Jk(n)(n,e)}const Gle=n=>{const e=({timestamp:t})=>n(t);return{start:(t=!0)=>Rr.update(e,t),stop:()=>bp(e),now:()=>vs.isProcessing?vs.timestamp:Ka.now()}},DX=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let s=0;s<i;s++)r+=Math.round(n(s/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},zC=2e4;function eB(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<zC;)e+=t,r=n.next(e);return e>=zC?1/0:e}function jle(n,e=100,t){const r=t({...n,keyframes:[0,e]}),i=Math.min(eB(r),zC);return{type:"keyframes",ease:s=>r.next(i*s).value/e,duration:bl(i)}}const qle=5;function NX(n,e,t){const r=Math.max(e-qle,0);return uX(t-n(r),e-r)}const Xr={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},LR=.001;function Wle({duration:n=Xr.duration,bounce:e=Xr.bounce,velocity:t=Xr.velocity,mass:r=Xr.mass}){let i,s,a=1-e;a=ad(Xr.minDamping,Xr.maxDamping,a),n=ad(Xr.minDuration,Xr.maxDuration,bl(n)),a<1?(i=u=>{const c=u*a,h=c*n,d=c-t,f=i3(u,a),p=Math.exp(-h);return LR-d/f*p},s=u=>{const h=u*a*n,d=h*t+t,f=Math.pow(a,2)*Math.pow(u,2)*n,p=Math.exp(-h),m=i3(Math.pow(u,2),a);return(-i(u)+LR>0?-1:1)*((d-f)*p)/m}):(i=u=>{const c=Math.exp(-u*n),h=(u-t)*n+1;return-LR+c*h},s=u=>{const c=Math.exp(-u*n),h=(t-u)*(n*n);return c*h});const o=5/n,l=Kle(i,s,o);if(n=hc(n),isNaN(l))return{stiffness:Xr.stiffness,damping:Xr.damping,duration:n};{const u=Math.pow(l,2)*r;return{stiffness:u,damping:a*2*Math.sqrt(r*u),duration:n}}}const Xle=12;function Kle(n,e,t){let r=t;for(let i=1;i<Xle;i++)r=r-n(r)/e(r);return r}function i3(n,e){return n*Math.sqrt(1-e*e)}const Yle=["duration","bounce"],Qle=["stiffness","damping","mass"];function LV(n,e){return e.some(t=>n[t]!==void 0)}function Zle(n){let e={velocity:Xr.velocity,stiffness:Xr.stiffness,damping:Xr.damping,mass:Xr.mass,isResolvedFromDuration:!1,...n};if(!LV(n,Qle)&&LV(n,Yle))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,s=2*ad(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:Xr.mass,stiffness:i,damping:s}}else{const t=Wle(n);e={...e,...t,mass:Xr.mass},e.isResolvedFromDuration=!0}return e}function $C(n=Xr.visualDuration,e=Xr.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const s=t.keyframes[0],a=t.keyframes[t.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:u,mass:c,duration:h,velocity:d,isResolvedFromDuration:f}=Zle({...t,velocity:-bl(t.velocity||0)}),p=d||0,m=u/(2*Math.sqrt(l*c)),y=a-s,v=bl(Math.sqrt(l/c)),b=Math.abs(y)<5;r||(r=b?Xr.restSpeed.granular:Xr.restSpeed.default),i||(i=b?Xr.restDelta.granular:Xr.restDelta.default);let x;if(m<1){const _=i3(v,m);x=E=>{const A=Math.exp(-m*v*E);return a-A*((p+m*v*y)/_*Math.sin(_*E)+y*Math.cos(_*E))}}else if(m===1)x=_=>a-Math.exp(-v*_)*(y+(p+v*y)*_);else{const _=v*Math.sqrt(m*m-1);x=E=>{const A=Math.exp(-m*v*E),T=Math.min(_*E,300);return a-A*((p+m*v*y)*Math.sinh(T)+_*y*Math.cosh(T))/_}}const w={calculatedDuration:f&&h||null,next:_=>{const E=x(_);if(f)o.done=_>=h;else{let A=_===0?p:0;m<1&&(A=_===0?hc(p):NX(x,_,E));const T=Math.abs(A)<=r,S=Math.abs(a-E)<=i;o.done=T&&S}return o.value=o.done?a:E,o},toString:()=>{const _=Math.min(eB(w),zC),E=DX(A=>w.next(_*A).value,_,30);return _+"ms "+E},toTransition:()=>{}};return w}$C.applyToOptions=n=>{const e=jle(n,100,$C);return n.ease=e.ease,n.duration=hc(e.duration),n.type="keyframes",n};function s3({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:u=.5,restSpeed:c}){const h=n[0],d={done:!1,value:h},f=T=>o!==void 0&&T<o||l!==void 0&&T>l,p=T=>o===void 0?l:l===void 0||Math.abs(o-T)<Math.abs(l-T)?o:l;let m=t*e;const y=h+m,v=a===void 0?y:a(y);v!==y&&(m=v-h);const b=T=>-m*Math.exp(-T/r),x=T=>v+b(T),w=T=>{const S=b(T),M=x(T);d.done=Math.abs(S)<=u,d.value=d.done?v:M};let _,E;const A=T=>{f(d.value)&&(_=T,E=$C({keyframes:[d.value,p(d.value)],velocity:NX(x,T,d.value),damping:i,stiffness:s,restDelta:u,restSpeed:c}))};return A(0),{calculatedDuration:null,next:T=>{let S=!1;return!E&&_===void 0&&(S=!0,w(T),A(T)),_!==void 0&&T>=_?E.next(T-_):(!S&&w(T),d)}}}function Jle(n,e,t){const r=[],i=t||od.mix||CX,s=n.length-1;for(let a=0;a<s;a++){let o=i(n[a],n[a+1]);if(e){const l=Array.isArray(e)?e[a]||wl:e;o=DS(l,o)}r.push(o)}return r}function eue(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const s=n.length;if(Gk(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const a=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const o=Jle(e,r,i),l=o.length,u=c=>{if(a&&c<n[0])return e[0];let h=0;if(l>1)for(;h<n.length-2&&!(c<n[h+1]);h++);const d=rw(n[h],n[h+1],c);return o[h](d)};return t?c=>u(ad(n[0],n[s-1],c)):u}function tue(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=rw(0,e,r);n.push(kr(t,1,i))}}function nue(n){const e=[0];return tue(e,n.length-1),e}function rue(n,e){return n.map(t=>t*e)}function iue(n,e){return n.map(()=>e||yX).splice(0,n.length-1)}function T1({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=mle(r)?r.map(NV):NV(r),s={done:!1,value:e[0]},a=rue(t&&t.length===e.length?t:nue(e),n),o=eue(a,e,{ease:Array.isArray(i)?i:iue(e,i)});return{calculatedDuration:n,next:l=>(s.value=o(l),s.done=l>=n,s)}}const sue=n=>n!==null;function tB(n,{repeat:e,repeatType:t="loop"},r,i=1){const s=n.filter(sue),o=i<0||e&&t!=="loop"&&e%2===1?0:s.length-1;return!o||r===void 0?s[o]:r}const aue={decay:s3,inertia:s3,tween:T1,keyframes:T1,spring:$C};function RX(n){typeof n.type=="string"&&(n.type=aue[n.type])}class nB{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const oue=n=>n/100;class rB extends nB{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var r,i;const{motionValue:t}=this.options;t&&t.updatedAt!==Ka.now()&&this.tick(Ka.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(i=(r=this.options).onStop)==null||i.call(r))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;RX(e);const{type:t=T1,repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:a=0}=e;let{keyframes:o}=e;const l=t||T1;l!==T1&&typeof o[0]!="number"&&(this.mixKeyframes=DS(oue,CX(o[0],o[1])),o=[0,100]);const u=l({...e,keyframes:o});s==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...o].reverse(),velocity:-a})),u.calculatedDuration===null&&(u.calculatedDuration=eB(u));const{calculatedDuration:c}=u;this.calculatedDuration=c,this.resolvedDuration=c+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=u}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:r,totalDuration:i,mixKeyframes:s,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:u=0,keyframes:c,repeat:h,repeatType:d,repeatDelay:f,type:p,onUpdate:m,finalKeyframe:y}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const v=this.currentTime-u*(this.playbackSpeed>=0?1:-1),b=this.playbackSpeed>=0?v<0:v>i;this.currentTime=Math.max(v,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let x=this.currentTime,w=r;if(h){const T=Math.min(this.currentTime,i)/o;let S=Math.floor(T),M=T%1;!M&&T>=1&&(M=1),M===1&&S--,S=Math.min(S,h+1),!!(S%2)&&(d==="reverse"?(M=1-M,f&&(M-=f/o)):d==="mirror"&&(w=a)),x=ad(0,1,M)*o}const _=b?{done:!1,value:c[0]}:w.next(x);s&&(_.value=s(_.value));let{done:E}=_;!b&&l!==null&&(E=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&E);return A&&p!==s3&&(_.value=tB(c,this.options,y,this.speed)),m&&m(_.value),A&&this.finish(),_}then(e,t){return this.finished.then(e,t)}get duration(){return bl(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+bl(e)}get time(){return bl(this.currentTime)}set time(e){var t;e=hc(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(t=this.driver)==null||t.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Ka.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=bl(this.currentTime))}play(){var i,s;if(this.isStopped)return;const{driver:e=Gle,startTime:t}=this.options;this.driver||(this.driver=e(a=>this.tick(a))),(s=(i=this.options).onPlay)==null||s.call(i);const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=t??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ka.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,t;this.notifyFinished(),this.teardown(),this.state="finished",(t=(e=this.options).onComplete)==null||t.call(e)}cancel(){var e,t;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(t=(e=this.options).onCancel)==null||t.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var t;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(t=this.driver)==null||t.stop(),e.observe(this)}}function lue(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const Um=n=>n*180/Math.PI,a3=n=>{const e=Um(Math.atan2(n[1],n[0]));return o3(e)},uue={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:a3,rotateZ:a3,skewX:n=>Um(Math.atan(n[1])),skewY:n=>Um(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},o3=n=>(n=n%360,n<0&&(n+=360),n),OV=a3,kV=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),BV=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),cue={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:kV,scaleY:BV,scale:n=>(kV(n)+BV(n))/2,rotateX:n=>o3(Um(Math.atan2(n[6],n[5]))),rotateY:n=>o3(Um(Math.atan2(-n[2],n[0]))),rotateZ:OV,rotate:OV,skewX:n=>Um(Math.atan(n[4])),skewY:n=>Um(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function l3(n){return n.includes("scale")?1:0}function u3(n,e){if(!n||n==="none")return l3(e);const t=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(t)r=cue,i=t;else{const o=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=uue,i=o}if(!i)return l3(e);const s=r[e],a=i[1].split(",").map(due);return typeof s=="function"?s(a):a[s]}const hue=(n,e)=>{const{transform:t="none"}=getComputedStyle(n);return u3(t,e)};function due(n){return parseFloat(n.trim())}const Ob=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],kb=new Set(Ob),UV=n=>n===Lb||n===Bt,fue=new Set(["x","y","z"]),pue=Ob.filter(n=>!fue.has(n));function mue(n){const e=[];return pue.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const lv={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>u3(e,"x"),y:(n,{transform:e})=>u3(e,"y")};lv.translateX=lv.x;lv.translateY=lv.y;const uv=new Set;let c3=!1,h3=!1,d3=!1;function IX(){if(h3){const n=Array.from(uv).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=mue(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([s,a])=>{var o;(o=r.getValue(s))==null||o.set(a)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}h3=!1,c3=!1,uv.forEach(n=>n.complete(d3)),uv.clear()}function PX(){uv.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(h3=!0)})}function gue(){d3=!0,PX(),IX(),d3=!1}class iB{constructor(e,t,r,i,s,a=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=s,this.isAsync=a}scheduleResolve(){this.state="scheduled",this.isAsync?(uv.add(this),c3||(c3=!0,Rr.read(PX),Rr.resolveKeyframes(IX))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;if(e[0]===null){const s=i==null?void 0:i.get(),a=e[e.length-1];if(s!==void 0)e[0]=s;else if(r&&t){const o=r.readValue(t,a);o!=null&&(e[0]=o)}e[0]===void 0&&(e[0]=a),i&&s===void 0&&i.set(e[0])}lue(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),uv.delete(this)}cancel(){this.state==="scheduled"&&(uv.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const vue=n=>n.startsWith("--");function yue(n,e,t){vue(e)?n.style.setProperty(e,t):n.style[e]=t}const xue=jk(()=>window.ScrollTimeline!==void 0),bue={};function _ue(n,e){const t=jk(n);return()=>bue[e]??t()}const FX=_ue(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),B_=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,VV={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:B_([0,.65,.55,1]),circOut:B_([.55,0,1,.45]),backIn:B_([.31,.01,.66,-.59]),backOut:B_([.33,1.53,.69,.99])};function LX(n,e){if(n)return typeof n=="function"?FX()?DX(n,e):"ease-out":xX(n)?B_(n):Array.isArray(n)?n.map(t=>LX(t,e)||VV.easeOut):VV[n]}function wue(n,e,t,{delay:r=0,duration:i=300,repeat:s=0,repeatType:a="loop",ease:o="easeOut",times:l}={},u=void 0){const c={[e]:t};l&&(c.offset=l);const h=LX(o,i);Array.isArray(h)&&(c.easing=h);const d={delay:r,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"};return u&&(d.pseudoElement=u),n.animate(c,d)}function OX(n){return typeof n=="function"&&"applyToOptions"in n}function Eue({type:n,...e}){return OX(n)&&FX()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class Sue extends nB{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:r,keyframes:i,pseudoElement:s,allowFlatten:a=!1,finalKeyframe:o,onComplete:l}=e;this.isPseudoElement=!!s,this.allowFlatten=a,this.options=e,Gk(typeof e.type!="string");const u=Eue(e);this.animation=wue(t,r,i,u,s),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const c=tB(i,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(c):yue(t,r,c),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,t;(t=(e=this.animation).finish)==null||t.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,t;this.isPseudoElement||(t=(e=this.animation).commitStyles)==null||t.call(e)}get duration(){var t,r;const e=((r=(t=this.animation.effect)==null?void 0:t.getComputedTiming)==null?void 0:r.call(t).duration)||0;return bl(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+bl(e)}get time(){return bl(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=hc(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&xue()?(this.animation.timeline=e,wl):t(this)}}const kX={anticipate:mX,backInOut:pX,circInOut:vX};function Aue(n){return n in kX}function Tue(n){typeof n.ease=="string"&&Aue(n.ease)&&(n.ease=kX[n.ease])}const zV=10;class Mue extends Sue{constructor(e){Tue(e),RX(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:r,onComplete:i,element:s,...a}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const o=new rB({...a,autoplay:!1}),l=hc(this.finishedTime??this.time);t.setWithVelocity(o.sample(l-zV).value,o.sample(l).value,zV),o.stop()}}const $V=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(_p.test(n)||n==="0")&&!n.startsWith("url("));function Cue(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function Due(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],a=$V(i,e),o=$V(s,e);return!a||!o?!1:Cue(n)||(t==="spring"||OX(t))&&r}function f3(n){n.duration=0,n.type="keyframes"}const Nue=new Set(["opacity","clipPath","filter","transform"]),Rue=jk(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Iue(n){var c;const{motionValue:e,name:t,repeatDelay:r,repeatType:i,damping:s,type:a}=n;if(!(((c=e==null?void 0:e.owner)==null?void 0:c.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=e.owner.getProps();return Rue()&&t&&Nue.has(t)&&(t!=="transform"||!u)&&!l&&!r&&i!=="mirror"&&s!==0&&a!=="inertia"}const Pue=40;class Fue extends nB{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:a="loop",keyframes:o,name:l,motionValue:u,element:c,...h}){var p;super(),this.stop=()=>{var m,y;this._animation&&(this._animation.stop(),(m=this.stopTimeline)==null||m.call(this)),(y=this.keyframeResolver)==null||y.cancel()},this.createdAt=Ka.now();const d={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:s,repeatType:a,name:l,motionValue:u,element:c,...h},f=(c==null?void 0:c.KeyframeResolver)||iB;this.keyframeResolver=new f(o,(m,y,v)=>this.onKeyframesResolved(m,y,d,!v),l,u,c),(p=this.keyframeResolver)==null||p.scheduleResolve()}onKeyframesResolved(e,t,r,i){this.keyframeResolver=void 0;const{name:s,type:a,velocity:o,delay:l,isHandoff:u,onUpdate:c}=r;this.resolvedAt=Ka.now(),Due(e,s,a,o)||((od.instantAnimations||!l)&&(c==null||c(tB(e,r,t))),e[0]=e[e.length-1],f3(r),r.repeat=0);const d={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>Pue?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...r,keyframes:e},f=!u&&Iue(d)?new Mue({...d,element:d.motionValue.owner.current}):new rB(d);f.finished.then(()=>this.notifyFinished()).catch(wl),this.pendingTimeline&&(this.stopTimeline=f.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=f}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),gue()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const Lue=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Oue(n){const e=Lue.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function BX(n,e,t=1){const[r,i]=Oue(n);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const a=s.trim();return aX(a)?parseFloat(a):a}return Yk(i)?BX(i,e,t+1):i}function sB(n,e){return(n==null?void 0:n[e])??(n==null?void 0:n.default)??n}const UX=new Set(["width","height","top","left","right","bottom",...Ob]),kue={test:n=>n==="auto",parse:n=>n},VX=n=>e=>e.test(n),zX=[Lb,Bt,dc,Hd,Cle,Mle,kue],HV=n=>zX.find(VX(n));function Bue(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||lX(n):!0}const Uue=new Set(["brightness","contrast","saturate","opacity"]);function Vue(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(Qk)||[];if(!r)return n;const i=t.replace(r,"");let s=Uue.has(e)?1:0;return r!==t&&(s*=100),e+"("+s+i+")"}const zue=/\b([a-z-]*)\(.*?\)/gu,p3={..._p,getAnimatableNone:n=>{const e=n.match(zue);return e?e.map(Vue).join(" "):n}},GV={...Lb,transform:Math.round},$ue={rotate:Hd,rotateX:Hd,rotateY:Hd,rotateZ:Hd,scale:GA,scaleX:GA,scaleY:GA,scaleZ:GA,skew:Hd,skewX:Hd,skewY:Hd,distance:Bt,translateX:Bt,translateY:Bt,translateZ:Bt,x:Bt,y:Bt,z:Bt,perspective:Bt,transformPerspective:Bt,opacity:iw,originX:RV,originY:RV,originZ:Bt},aB={borderWidth:Bt,borderTopWidth:Bt,borderRightWidth:Bt,borderBottomWidth:Bt,borderLeftWidth:Bt,borderRadius:Bt,radius:Bt,borderTopLeftRadius:Bt,borderTopRightRadius:Bt,borderBottomRightRadius:Bt,borderBottomLeftRadius:Bt,width:Bt,maxWidth:Bt,height:Bt,maxHeight:Bt,top:Bt,right:Bt,bottom:Bt,left:Bt,padding:Bt,paddingTop:Bt,paddingRight:Bt,paddingBottom:Bt,paddingLeft:Bt,margin:Bt,marginTop:Bt,marginRight:Bt,marginBottom:Bt,marginLeft:Bt,backgroundPositionX:Bt,backgroundPositionY:Bt,...$ue,zIndex:GV,fillOpacity:iw,strokeOpacity:iw,numOctaves:GV},Hue={...aB,color:yi,backgroundColor:yi,outlineColor:yi,fill:yi,stroke:yi,borderColor:yi,borderTopColor:yi,borderRightColor:yi,borderBottomColor:yi,borderLeftColor:yi,filter:p3,WebkitFilter:p3},$X=n=>Hue[n];function HX(n,e){let t=$X(n);return t!==p3&&(t=_p),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const Gue=new Set(["auto","none","0"]);function jue(n,e,t){let r=0,i;for(;r<n.length&&!i;){const s=n[r];typeof s=="string"&&!Gue.has(s)&&sw(s).values.length&&(i=n[r]),r++}if(i&&t)for(const s of e)n[s]=HX(t,i)}class que extends iB{constructor(e,t,r,i,s){super(e,t,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),Yk(u))){const c=BX(u,t.current);c!==void 0&&(e[l]=c),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!UX.has(r)||e.length!==2)return;const[i,s]=e,a=HV(i),o=HV(s);if(a!==o)if(UV(a)&&UV(o))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else lv[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)(e[i]===null||Bue(e[i]))&&r.push(i);r.length&&jue(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=lv[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var o;const{element:e,name:t,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const i=e.getValue(t);i&&i.jump(this.measuredOrigin,!1);const s=r.length-1,a=r[s];r[s]=lv[t](e.measureViewportBox(),window.getComputedStyle(e.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([l,u])=>{e.getValue(l).set(u)}),this.resolveNoneKeyframes()}}function Wue(n,e,t){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let r=document;const i=(t==null?void 0:t[n])??r.querySelectorAll(n);return i?Array.from(i):[]}return Array.from(n)}const GX=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function Xue(n){return oX(n)&&"offsetHeight"in n}const jV=30,Kue=n=>!isNaN(parseFloat(n));class Yue{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{var s;const i=Ka.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((s=this.events.change)==null||s.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Ka.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Kue(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new qk);const r=this.events[e].add(t);return e==="change"?()=>{r(),Rr.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Ka.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>jV)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,jV);return uX(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,t;(e=this.dependents)==null||e.clear(),(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ob(n,e){return new Yue(n,e)}const{schedule:oB}=bX(queueMicrotask,!1),Vl={x:!1,y:!1};function jX(){return Vl.x||Vl.y}function Que(n){return n==="x"||n==="y"?Vl[n]?null:(Vl[n]=!0,()=>{Vl[n]=!1}):Vl.x||Vl.y?null:(Vl.x=Vl.y=!0,()=>{Vl.x=Vl.y=!1})}function qX(n,e){const t=Wue(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function qV(n){return!(n.pointerType==="touch"||jX())}function Zue(n,e,t={}){const[r,i,s]=qX(n,t),a=o=>{if(!qV(o))return;const{target:l}=o,u=e(l,o);if(typeof u!="function"||!l)return;const c=h=>{qV(h)&&(u(h),l.removeEventListener("pointerleave",c))};l.addEventListener("pointerleave",c,i)};return r.forEach(o=>{o.addEventListener("pointerenter",a,i)}),s}const WX=(n,e)=>e?n===e?!0:WX(n,e.parentElement):!1,lB=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,Jue=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function ece(n){return Jue.has(n.tagName)||n.tabIndex!==-1}const dM=new WeakSet;function WV(n){return e=>{e.key==="Enter"&&n(e)}}function OR(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const tce=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=WV(()=>{if(dM.has(t))return;OR(t,"down");const i=WV(()=>{OR(t,"up")}),s=()=>OR(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function XV(n){return lB(n)&&!jX()}function nce(n,e,t={}){const[r,i,s]=qX(n,t),a=o=>{const l=o.currentTarget;if(!XV(o))return;dM.add(l);const u=e(l,o),c=(f,p)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",d),dM.has(l)&&dM.delete(l),XV(f)&&typeof u=="function"&&u(f,{success:p})},h=f=>{c(f,l===window||l===document||t.useGlobalTarget||WX(l,f.target))},d=f=>{c(f,!1)};window.addEventListener("pointerup",h,i),window.addEventListener("pointercancel",d,i)};return r.forEach(o=>{(t.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),Xue(o)&&(o.addEventListener("focus",u=>tce(u,i)),!ece(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),s}function XX(n){return oX(n)&&"ownerSVGElement"in n}function rce(n){return XX(n)&&n.tagName==="svg"}const Ys=n=>!!(n&&n.getVelocity),ice=[...zX,yi,_p],sce=n=>ice.find(VX(n)),KX=xe.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function ace(n=!0){const e=xe.useContext(zk);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,s=xe.useId();xe.useEffect(()=>{if(n)return i(s)},[n]);const a=xe.useCallback(()=>n&&r&&r(s),[s,r,n]);return!t&&r?[!1,a]:[!0]}const YX=xe.createContext({strict:!1}),KV={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},lb={};for(const n in KV)lb[n]={isEnabled:e=>KV[n].some(t=>!!e[t])};function oce(n){for(const e in n)lb[e]={...lb[e],...n[e]}}const lce=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function HC(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||lce.has(n)}let QX=n=>!HC(n);function uce(n){typeof n=="function"&&(QX=e=>e.startsWith("on")?!HC(e):n(e))}try{uce(require("@emotion/is-prop-valid").default)}catch{}function cce(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(QX(i)||t===!0&&HC(i)||!e&&!HC(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}const $2=xe.createContext({});function H2(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function aw(n){return typeof n=="string"||Array.isArray(n)}const uB=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],cB=["initial",...uB];function G2(n){return H2(n.animate)||cB.some(e=>aw(n[e]))}function ZX(n){return!!(G2(n)||n.variants)}function hce(n,e){if(G2(n)){const{initial:t,animate:r}=n;return{initial:t===!1||aw(t)?t:void 0,animate:aw(r)?r:void 0}}return n.inherit!==!1?e:{}}function dce(n){const{initial:e,animate:t}=hce(n,xe.useContext($2));return xe.useMemo(()=>({initial:e,animate:t}),[YV(e),YV(t)])}function YV(n){return Array.isArray(n)?n.join(" "):n}const ow={};function fce(n){for(const e in n)ow[e]=n[e],Kk(e)&&(ow[e].isCSSVariable=!0)}function JX(n,{layout:e,layoutId:t}){return kb.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!ow[n]||n==="opacity")}const pce={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},mce=Ob.length;function gce(n,e,t){let r="",i=!0;for(let s=0;s<mce;s++){const a=Ob[s],o=n[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||t){const u=GX(o,aB[a]);if(!l){i=!1;const c=pce[a]||a;r+=`${c}(${u}) `}t&&(e[a]=u)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function hB(n,e,t){const{style:r,vars:i,transformOrigin:s}=n;let a=!1,o=!1;for(const l in e){const u=e[l];if(kb.has(l)){a=!0;continue}else if(Kk(l)){i[l]=u;continue}else{const c=GX(u,aB[l]);l.startsWith("origin")?(o=!0,s[l]=c):r[l]=c}}if(e.transform||(a||t?r.transform=gce(e,n.transform,t):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:u="50%",originZ:c=0}=s;r.transformOrigin=`${l} ${u} ${c}`}}const dB=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function eK(n,e,t){for(const r in e)!Ys(e[r])&&!JX(r,t)&&(n[r]=e[r])}function vce({transformTemplate:n},e){return xe.useMemo(()=>{const t=dB();return hB(t,e,n),Object.assign({},t.vars,t.style)},[e])}function yce(n,e){const t=n.style||{},r={};return eK(r,t,n),Object.assign(r,vce(n,e)),r}function xce(n,e){const t={},r=yce(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}const bce={offset:"stroke-dashoffset",array:"stroke-dasharray"},_ce={offset:"strokeDashoffset",array:"strokeDasharray"};function wce(n,e,t=1,r=0,i=!0){n.pathLength=1;const s=i?bce:_ce;n[s.offset]=Bt.transform(-r);const a=Bt.transform(e),o=Bt.transform(t);n[s.array]=`${a} ${o}`}function tK(n,{attrX:e,attrY:t,attrScale:r,pathLength:i,pathSpacing:s=1,pathOffset:a=0,...o},l,u,c){if(hB(n,o,u),l){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:h,style:d}=n;h.transform&&(d.transform=h.transform,delete h.transform),(d.transform||h.transformOrigin)&&(d.transformOrigin=h.transformOrigin??"50% 50%",delete h.transformOrigin),d.transform&&(d.transformBox=(c==null?void 0:c.transformBox)??"fill-box",delete h.transformBox),e!==void 0&&(h.x=e),t!==void 0&&(h.y=t),r!==void 0&&(h.scale=r),i!==void 0&&wce(h,i,s,a,!1)}const nK=()=>({...dB(),attrs:{}}),rK=n=>typeof n=="string"&&n.toLowerCase()==="svg";function Ece(n,e,t,r){const i=xe.useMemo(()=>{const s=nK();return tK(s,e,rK(r),n.transformTemplate,n.style),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};eK(s,n.style,n),i.style={...s,...i.style}}return i}const Sce=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function fB(n){return typeof n!="string"||n.includes("-")?!1:!!(Sce.indexOf(n)>-1||/[A-Z]/u.test(n))}function Ace(n,e,t,{latestValues:r},i,s=!1){const o=(fB(n)?Ece:xce)(e,r,i,n),l=cce(e,typeof n=="string",s),u=n!==xe.Fragment?{...l,...o,ref:t}:{},{children:c}=e,h=xe.useMemo(()=>Ys(c)?c.get():c,[c]);return xe.createElement(n,{...u,children:h})}function QV(n){const e=[{},{}];return n==null||n.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function pB(n,e,t,r){if(typeof e=="function"){const[i,s]=QV(r);e=e(t!==void 0?t:n.custom,i,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,s]=QV(r);e=e(t!==void 0?t:n.custom,i,s)}return e}function fM(n){return Ys(n)?n.get():n}function Tce({scrapeMotionValuesFromProps:n,createRenderState:e},t,r,i){return{latestValues:Mce(t,r,i,n),renderState:e()}}function Mce(n,e,t,r){const i={},s=r(n,{});for(const d in s)i[d]=fM(s[d]);let{initial:a,animate:o}=n;const l=G2(n),u=ZX(n);e&&u&&!l&&n.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let c=t?t.initial===!1:!1;c=c||a===!1;const h=c?o:a;if(h&&typeof h!="boolean"&&!H2(h)){const d=Array.isArray(h)?h:[h];for(let f=0;f<d.length;f++){const p=pB(n,d[f]);if(p){const{transitionEnd:m,transition:y,...v}=p;for(const b in v){let x=v[b];if(Array.isArray(x)){const w=c?x.length-1:0;x=x[w]}x!==null&&(i[b]=x)}for(const b in m)i[b]=m[b]}}}return i}const iK=n=>(e,t)=>{const r=xe.useContext($2),i=xe.useContext(zk),s=()=>Tce(n,e,r,i);return t?s():ole(s)};function mB(n,e,t){var s;const{style:r}=n,i={};for(const a in r)(Ys(r[a])||e.style&&Ys(e.style[a])||JX(a,n)||((s=t==null?void 0:t.getValue(a))==null?void 0:s.liveStyle)!==void 0)&&(i[a]=r[a]);return i}const Cce=iK({scrapeMotionValuesFromProps:mB,createRenderState:dB});function sK(n,e,t){const r=mB(n,e,t);for(const i in n)if(Ys(n[i])||Ys(e[i])){const s=Ob.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=n[i]}return r}const Dce=iK({scrapeMotionValuesFromProps:sK,createRenderState:nK}),Nce=Symbol.for("motionComponentSymbol");function Z0(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function Rce(n,e,t){return xe.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):Z0(t)&&(t.current=r))},[e])}const gB=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Ice="framerAppearId",aK="data-"+gB(Ice),oK=xe.createContext({});function Pce(n,e,t,r,i){var m,y;const{visualElement:s}=xe.useContext($2),a=xe.useContext(YX),o=xe.useContext(zk),l=xe.useContext(KX).reducedMotion,u=xe.useRef(null);r=r||a.renderer,!u.current&&r&&(u.current=r(n,{visualState:e,parent:s,props:t,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const c=u.current,h=xe.useContext(oK);c&&!c.projection&&i&&(c.type==="html"||c.type==="svg")&&Fce(u.current,t,i,h);const d=xe.useRef(!1);xe.useInsertionEffect(()=>{c&&d.current&&c.update(t,o)});const f=t[aK],p=xe.useRef(!!f&&!((m=window.MotionHandoffIsComplete)!=null&&m.call(window,f))&&((y=window.MotionHasOptimisedAnimation)==null?void 0:y.call(window,f)));return lle(()=>{c&&(d.current=!0,window.MotionIsMounted=!0,c.updateFeatures(),c.scheduleRenderMicrotask(),p.current&&c.animationState&&c.animationState.animateChanges())}),xe.useEffect(()=>{c&&(!p.current&&c.animationState&&c.animationState.animateChanges(),p.current&&(queueMicrotask(()=>{var v;(v=window.MotionHandoffMarkAsComplete)==null||v.call(window,f)}),p.current=!1),c.enteringChildren=void 0)}),c}function Fce(n,e,t,r){const{layoutId:i,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:u,layoutCrossfade:c}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:lK(n.parent)),n.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!a||o&&Z0(o),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,crossfade:c,layoutScroll:l,layoutRoot:u})}function lK(n){if(n)return n.options.allowProjection!==!1?n.projection:lK(n.parent)}function kR(n,{forwardMotionProps:e=!1}={},t,r){t&&oce(t);const i=fB(n)?Dce:Cce;function s(o,l){let u;const c={...xe.useContext(KX),...o,layoutId:Lce(o)},{isStatic:h}=c,d=dce(o),f=i(o,h);if(!h&&Vk){Oce();const p=kce(c);u=p.MeasureLayout,d.visualElement=Pce(n,f,c,r,p.ProjectionNode)}return k.jsxs($2.Provider,{value:d,children:[u&&d.visualElement?k.jsx(u,{visualElement:d.visualElement,...c}):null,Ace(n,o,Rce(f,d.visualElement,l),f,h,e)]})}s.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const a=xe.forwardRef(s);return a[Nce]=n,a}function Lce({layoutId:n}){const e=xe.useContext(sX).id;return e&&n!==void 0?e+"-"+n:n}function Oce(n,e){xe.useContext(YX).strict}function kce(n){const{drag:e,layout:t}=lb;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e!=null&&e.isEnabled(n)||t!=null&&t.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function Bce(n,e){if(typeof Proxy>"u")return kR;const t=new Map,r=(s,a)=>kR(s,a,n,e),i=(s,a)=>r(s,a);return new Proxy(i,{get:(s,a)=>a==="create"?r:(t.has(a)||t.set(a,kR(a,void 0,n,e)),t.get(a))})}function uK({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function Uce({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function Vce(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function BR(n){return n===void 0||n===1}function m3({scale:n,scaleX:e,scaleY:t}){return!BR(n)||!BR(e)||!BR(t)}function wm(n){return m3(n)||cK(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function cK(n){return ZV(n.x)||ZV(n.y)}function ZV(n){return n&&n!=="0%"}function GC(n,e,t){const r=n-t,i=e*r;return t+i}function JV(n,e,t,r,i){return i!==void 0&&(n=GC(n,i,r)),GC(n,t,r)+e}function g3(n,e=0,t=1,r,i){n.min=JV(n.min,e,t,r,i),n.max=JV(n.max,e,t,r,i)}function hK(n,{x:e,y:t}){g3(n.x,e.translate,e.scale,e.originPoint),g3(n.y,t.translate,t.scale,t.originPoint)}const e6=.999999999999,t6=1.0000000000001;function zce(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let s,a;for(let o=0;o<i;o++){s=t[o],a=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&ey(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,hK(n,a)),r&&wm(s.latestValues)&&ey(n,s.latestValues))}e.x<t6&&e.x>e6&&(e.x=1),e.y<t6&&e.y>e6&&(e.y=1)}function J0(n,e){n.min=n.min+e,n.max=n.max+e}function n6(n,e,t,r,i=.5){const s=kr(n.min,n.max,i);g3(n,e,t,s,r)}function ey(n,e){n6(n.x,e.x,e.scaleX,e.scale,e.originX),n6(n.y,e.y,e.scaleY,e.scale,e.originY)}function dK(n,e){return uK(Vce(n.getBoundingClientRect(),e))}function $ce(n,e,t){const r=dK(n,t),{scroll:i}=e;return i&&(J0(r.x,i.offset.x),J0(r.y,i.offset.y)),r}const r6=()=>({translate:0,scale:1,origin:0,originPoint:0}),ty=()=>({x:r6(),y:r6()}),i6=()=>({min:0,max:0}),si=()=>({x:i6(),y:i6()}),v3={current:null},fK={current:!1};function Hce(){if(fK.current=!0,!!Vk)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>v3.current=n.matches;n.addEventListener("change",e),e()}else v3.current=!1}const Gce=new WeakMap;function jce(n,e,t){for(const r in e){const i=e[r],s=t[r];if(Ys(i))n.addValue(r,i);else if(Ys(s))n.addValue(r,ob(i,{owner:n}));else if(s!==i)if(n.hasValue(r)){const a=n.getValue(r);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=n.getStaticValue(r);n.addValue(r,ob(a!==void 0?a:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const s6=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class qce{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=iB,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const d=Ka.now();this.renderScheduledAt<d&&(this.renderScheduledAt=d,Rr.render(this.render,!1,!0))};const{latestValues:l,renderState:u}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!s,this.isControllingVariants=G2(t),this.isVariantNode=ZX(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:c,...h}=this.scrapeMotionValuesFromProps(t,{},this);for(const d in h){const f=h[d];l[d]!==void 0&&Ys(f)&&f.set(l[d])}}mount(e){var t;this.current=e,Gce.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,i)=>this.bindToMotionValue(i,r)),fK.current||Hce(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:v3.current,(t=this.parent)==null||t.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),bp(this.notifyUpdate),bp(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=kb.has(e);r&&this.onBindTransform&&this.onBindTransform();const i=t.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&Rr.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let s;window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),s&&s(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in lb){const t=lb[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):si()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<s6.length;r++){const i=s6[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,a=e[s];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=jce(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=ob(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(aX(r)||lX(r))?r=parseFloat(r):!sce(r)&&_p.test(t)&&(r=HX(e,t)),this.setBaseTarget(e,Ys(r)?r.get():r)),Ys(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var s;const{initial:t}=this.props;let r;if(typeof t=="string"||typeof t=="object"){const a=pB(this.props,t,(s=this.presenceContext)==null?void 0:s.custom);a&&(r=a[e])}if(t&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Ys(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new qk),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){oB.render(this.render)}}class pK extends qce{constructor(){super(...arguments),this.KeyframeResolver=que}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ys(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function mK(n,{style:e,vars:t},r,i){const s=n.style;let a;for(a in e)s[a]=e[a];i==null||i.applyProjectionStyles(s,r);for(a in t)s.setProperty(a,t[a])}function Wce(n){return window.getComputedStyle(n)}class Xce extends pK{constructor(){super(...arguments),this.type="html",this.renderInstance=mK}readValueFromInstance(e,t){var r;if(kb.has(t))return(r=this.projection)!=null&&r.isProjecting?l3(t):hue(e,t);{const i=Wce(e),s=(Kk(t)?i.getPropertyValue(t):i[t])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:t}){return dK(e,t)}build(e,t,r){hB(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return mB(e,t,r)}}const gK=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Kce(n,e,t,r){mK(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(gK.has(i)?i:gB(i),e.attrs[i])}class Yce extends pK{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=si}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(kb.has(t)){const r=$X(t);return r&&r.default||0}return t=gK.has(t)?t:gB(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return sK(e,t,r)}build(e,t,r){tK(e,t,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,t,r,i){Kce(e,t,r,i)}mount(e){this.isSVGTag=rK(e.tagName),super.mount(e)}}const Qce=(n,e)=>fB(n)?new Yce(e):new Xce(e,{allowProjection:n!==xe.Fragment});function yy(n,e,t){const r=n.getProps();return pB(r,e,t!==void 0?t:r.custom,n)}const y3=n=>Array.isArray(n);function Zce(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,ob(t))}function Jce(n){return y3(n)?n[n.length-1]||0:n}function ehe(n,e){const t=yy(n,e);let{transitionEnd:r={},transition:i={},...s}=t||{};s={...s,...r};for(const a in s){const o=Jce(s[a]);Zce(n,a,o)}}function the(n){return!!(Ys(n)&&n.add)}function x3(n,e){const t=n.getValue("willChange");if(the(t))return t.add(e);if(!t&&od.WillChange){const r=new od.WillChange("auto");n.addValue("willChange",r),r.add(e)}}function vK(n){return n.props[aK]}const nhe=n=>n!==null;function rhe(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(nhe),s=e&&t!=="loop"&&e%2===1?0:i.length-1;return i[s]}const ihe={type:"spring",stiffness:500,damping:25,restSpeed:10},she=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),ahe={type:"keyframes",duration:.8},ohe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},lhe=(n,{keyframes:e})=>e.length>2?ahe:kb.has(n)?n.startsWith("scale")?she(e[1]):ihe:ohe;function uhe({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:u,...c}){return!!Object.keys(c).length}const vB=(n,e,t,r={},i,s)=>a=>{const o=sB(r,n)||{},l=o.delay||r.delay||0;let{elapsed:u=0}=r;u=u-hc(l);const c={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-u,onUpdate:d=>{e.set(d),o.onUpdate&&o.onUpdate(d)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:n,motionValue:e,element:s?void 0:i};uhe(o)||Object.assign(c,lhe(n,c)),c.duration&&(c.duration=hc(c.duration)),c.repeatDelay&&(c.repeatDelay=hc(c.repeatDelay)),c.from!==void 0&&(c.keyframes[0]=c.from);let h=!1;if((c.type===!1||c.duration===0&&!c.repeatDelay)&&(f3(c),c.delay===0&&(h=!0)),(od.instantAnimations||od.skipAnimations)&&(h=!0,f3(c),c.delay=0),c.allowFlatten=!o.type&&!o.ease,h&&!s&&e.get()!==void 0){const d=rhe(c.keyframes,o);if(d!==void 0){Rr.update(()=>{c.onUpdate(d),c.onComplete()});return}}return o.isSync?new rB(c):new Fue(c)};function che({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function yK(n,e,{delay:t=0,transitionOverride:r,type:i}={}){let{transition:s=n.getDefaultTransition(),transitionEnd:a,...o}=e;r&&(s=r);const l=[],u=i&&n.animationState&&n.animationState.getState()[i];for(const c in o){const h=n.getValue(c,n.latestValues[c]??null),d=o[c];if(d===void 0||u&&che(u,c))continue;const f={delay:t,...sB(s||{},c)},p=h.get();if(p!==void 0&&!h.isAnimating&&!Array.isArray(d)&&d===p&&!f.velocity)continue;let m=!1;if(window.MotionHandoffAnimation){const v=vK(n);if(v){const b=window.MotionHandoffAnimation(v,c,Rr);b!==null&&(f.startTime=b,m=!0)}}x3(n,c),h.start(vB(c,h,d,n.shouldReduceMotion&&UX.has(c)?{type:!1}:f,n,m));const y=h.animation;y&&l.push(y)}return a&&Promise.all(l).then(()=>{Rr.update(()=>{a&&ehe(n,a)})}),l}function xK(n,e,t,r=0,i=1){const s=Array.from(n).sort((u,c)=>u.sortNodePosition(c)).indexOf(e),a=n.size,o=(a-1)*r;return typeof t=="function"?t(s,a):i===1?s*r:o-s*r}function b3(n,e,t={}){var l;const r=yy(n,e,t.type==="exit"?(l=n.presenceContext)==null?void 0:l.custom:void 0);let{transition:i=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(i=t.transitionOverride);const s=r?()=>Promise.all(yK(n,r,t)):()=>Promise.resolve(),a=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:c=0,staggerChildren:h,staggerDirection:d}=i;return hhe(n,e,u,c,h,d,t)}:()=>Promise.resolve(),{when:o}=i;if(o){const[u,c]=o==="beforeChildren"?[s,a]:[a,s];return u().then(()=>c())}else return Promise.all([s(),a(t.delay)])}function hhe(n,e,t=0,r=0,i=0,s=1,a){const o=[];for(const l of n.variantChildren)l.notify("AnimationStart",e),o.push(b3(l,e,{...a,delay:t+(typeof r=="function"?0:r)+xK(n.variantChildren,l,r,i,s)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(o)}function dhe(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>b3(n,s,t));r=Promise.all(i)}else if(typeof e=="string")r=b3(n,e,t);else{const i=typeof e=="function"?yy(n,e,t.custom):e;r=Promise.all(yK(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}function bK(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}const fhe=cB.length;function _K(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?_K(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<fhe;t++){const r=cB[t],i=n.props[r];(aw(i)||i===!1)&&(e[r]=i)}return e}const phe=[...uB].reverse(),mhe=uB.length;function ghe(n){return e=>Promise.all(e.map(({animation:t,options:r})=>dhe(n,t,r)))}function vhe(n){let e=ghe(n),t=a6(),r=!0;const i=l=>(u,c)=>{var d;const h=yy(n,c,l==="exit"?(d=n.presenceContext)==null?void 0:d.custom:void 0);if(h){const{transition:f,transitionEnd:p,...m}=h;u={...u,...m,...p}}return u};function s(l){e=l(n)}function a(l){const{props:u}=n,c=_K(n.parent)||{},h=[],d=new Set;let f={},p=1/0;for(let y=0;y<mhe;y++){const v=phe[y],b=t[v],x=u[v]!==void 0?u[v]:c[v],w=aw(x),_=v===l?b.isActive:null;_===!1&&(p=y);let E=x===c[v]&&x!==u[v]&&w;if(E&&r&&n.manuallyAnimateOnMount&&(E=!1),b.protectedKeys={...f},!b.isActive&&_===null||!x&&!b.prevProp||H2(x)||typeof x=="boolean")continue;const A=yhe(b.prevProp,x);let T=A||v===l&&b.isActive&&!E&&w||y>p&&w,S=!1;const M=Array.isArray(x)?x:[x];let D=M.reduce(i(v),{});_===!1&&(D={});const{prevResolvedValues:N={}}=b,R={...N,...D},O=B=>{T=!0,d.has(B)&&(S=!0,d.delete(B)),b.needsAnimating[B]=!0;const $=n.getValue(B);$&&($.liveStyle=!1)};for(const B in R){const $=D[B],H=N[B];if(f.hasOwnProperty(B))continue;let Q=!1;y3($)&&y3(H)?Q=!bK($,H):Q=$!==H,Q?$!=null?O(B):d.add(B):$!==void 0&&d.has(B)?O(B):b.protectedKeys[B]=!0}b.prevProp=x,b.prevResolvedValues=D,b.isActive&&(f={...f,...D}),r&&n.blockInitialAnimation&&(T=!1);const G=E&&A;T&&(!G||S)&&h.push(...M.map(B=>{const $={type:v};if(typeof B=="string"&&r&&!G&&n.manuallyAnimateOnMount&&n.parent){const{parent:H}=n,Q=yy(H,B);if(H.enteringChildren&&Q){const{delayChildren:ee}=Q.transition||{};$.delay=xK(H.enteringChildren,n,ee)}}return{animation:B,options:$}}))}if(d.size){const y={};if(typeof u.initial!="boolean"){const v=yy(n,Array.isArray(u.initial)?u.initial[0]:u.initial);v&&v.transition&&(y.transition=v.transition)}d.forEach(v=>{const b=n.getBaseTarget(v),x=n.getValue(v);x&&(x.liveStyle=!0),y[v]=b??null}),h.push({animation:y})}let m=!!h.length;return r&&(u.initial===!1||u.initial===u.animate)&&!n.manuallyAnimateOnMount&&(m=!1),r=!1,m?e(h):Promise.resolve()}function o(l,u){var h;if(t[l].isActive===u)return Promise.resolve();(h=n.variantChildren)==null||h.forEach(d=>{var f;return(f=d.animationState)==null?void 0:f.setActive(l,u)}),t[l].isActive=u;const c=a(l);for(const d in t)t[d].protectedKeys={};return c}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>t,reset:()=>{t=a6()}}}function yhe(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!bK(e,n):!1}function fm(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function a6(){return{animate:fm(!0),whileInView:fm(),whileHover:fm(),whileTap:fm(),whileDrag:fm(),whileFocus:fm(),exit:fm()}}class $p{constructor(e){this.isMounted=!1,this.node=e}update(){}}class xhe extends $p{constructor(e){super(e),e.animationState||(e.animationState=vhe(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();H2(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let bhe=0;class _he extends $p{constructor(){super(...arguments),this.id=bhe++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const whe={animation:{Feature:xhe},exit:{Feature:_he}};function lw(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function IS(n){return{point:{x:n.pageX,y:n.pageY}}}const Ehe=n=>e=>lB(e)&&n(e,IS(e));function M1(n,e,t,r){return lw(n,e,Ehe(t),r)}const wK=1e-4,She=1-wK,Ahe=1+wK,EK=.01,The=0-EK,Mhe=0+EK;function xa(n){return n.max-n.min}function Che(n,e,t){return Math.abs(n-e)<=t}function o6(n,e,t,r=.5){n.origin=r,n.originPoint=kr(e.min,e.max,n.origin),n.scale=xa(t)/xa(e),n.translate=kr(t.min,t.max,n.origin)-n.originPoint,(n.scale>=She&&n.scale<=Ahe||isNaN(n.scale))&&(n.scale=1),(n.translate>=The&&n.translate<=Mhe||isNaN(n.translate))&&(n.translate=0)}function C1(n,e,t,r){o6(n.x,e.x,t.x,r?r.originX:void 0),o6(n.y,e.y,t.y,r?r.originY:void 0)}function l6(n,e,t){n.min=t.min+e.min,n.max=n.min+xa(e)}function Dhe(n,e,t){l6(n.x,e.x,t.x),l6(n.y,e.y,t.y)}function u6(n,e,t){n.min=e.min-t.min,n.max=n.min+xa(e)}function D1(n,e,t){u6(n.x,e.x,t.x),u6(n.y,e.y,t.y)}function Qo(n){return[n("x"),n("y")]}const SK=({current:n})=>n?n.ownerDocument.defaultView:null,c6=(n,e)=>Math.abs(n-e);function Nhe(n,e){const t=c6(n.x,e.x),r=c6(n.y,e.y);return Math.sqrt(t**2+r**2)}class AK{constructor(e,t,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:s=!1,distanceThreshold:a=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=VR(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,p=Nhe(d.offset,{x:0,y:0})>=this.distanceThreshold;if(!f&&!p)return;const{point:m}=d,{timestamp:y}=vs;this.history.push({...m,timestamp:y});const{onStart:v,onMove:b}=this.handlers;f||(v&&v(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,d)},this.handlePointerMove=(d,f)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=UR(f,this.transformPagePoint),Rr.update(this.updatePoint,!0)},this.handlePointerUp=(d,f)=>{this.end();const{onEnd:p,onSessionEnd:m,resumeAnimation:y}=this.handlers;if(this.dragSnapToOrigin&&y&&y(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=VR(d.type==="pointercancel"?this.lastMoveEventInfo:UR(f,this.transformPagePoint),this.history);this.startEvent&&p&&p(d,v),m&&m(d,v)},!lB(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=r,this.distanceThreshold=a,this.contextWindow=i||window;const o=IS(e),l=UR(o,this.transformPagePoint),{point:u}=l,{timestamp:c}=vs;this.history=[{...u,timestamp:c}];const{onSessionStart:h}=t;h&&h(e,VR(l,this.history)),this.removeListeners=DS(M1(this.contextWindow,"pointermove",this.handlePointerMove),M1(this.contextWindow,"pointerup",this.handlePointerUp),M1(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),bp(this.updatePoint)}}function UR(n,e){return e?{point:e(n.point)}:n}function h6(n,e){return{x:n.x-e.x,y:n.y-e.y}}function VR({point:n},e){return{point:n,delta:h6(n,TK(e)),offset:h6(n,Rhe(e)),velocity:Ihe(e,.1)}}function Rhe(n){return n[0]}function TK(n){return n[n.length-1]}function Ihe(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=TK(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>hc(e)));)t--;if(!r)return{x:0,y:0};const s=bl(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const a={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function Phe(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?kr(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?kr(t,n,r.max):Math.min(n,t)),n}function d6(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function Fhe(n,{top:e,left:t,bottom:r,right:i}){return{x:d6(n.x,t,i),y:d6(n.y,e,r)}}function f6(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function Lhe(n,e){return{x:f6(n.x,e.x),y:f6(n.y,e.y)}}function Ohe(n,e){let t=.5;const r=xa(n),i=xa(e);return i>r?t=rw(e.min,e.max-r,n.min):r>i&&(t=rw(n.min,n.max-i,e.min)),ad(0,1,t)}function khe(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const _3=.35;function Bhe(n=_3){return n===!1?n=0:n===!0&&(n=_3),{x:p6(n,"left","right"),y:p6(n,"top","bottom")}}function p6(n,e,t){return{min:m6(n,e),max:m6(n,t)}}function m6(n,e){return typeof n=="number"?n:n[e]||0}const Uhe=new WeakMap;class Vhe{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=si(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const s=h=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(IS(h).point)},a=(h,d)=>{const{drag:f,dragPropagation:p,onDragStart:m}=this.getProps();if(f&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Que(f),!this.openDragLock))return;this.latestPointerEvent=h,this.latestPanInfo=d,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Qo(v=>{let b=this.getAxisMotionValue(v).get()||0;if(dc.test(b)){const{projection:x}=this.visualElement;if(x&&x.layout){const w=x.layout.layoutBox[v];w&&(b=xa(w)*(parseFloat(b)/100))}}this.originPoint[v]=b}),m&&Rr.postRender(()=>m(h,d)),x3(this.visualElement,"transform");const{animationState:y}=this.visualElement;y&&y.setActive("whileDrag",!0)},o=(h,d)=>{this.latestPointerEvent=h,this.latestPanInfo=d;const{dragPropagation:f,dragDirectionLock:p,onDirectionLock:m,onDrag:y}=this.getProps();if(!f&&!this.openDragLock)return;const{offset:v}=d;if(p&&this.currentDirection===null){this.currentDirection=zhe(v),this.currentDirection!==null&&m&&m(this.currentDirection);return}this.updateAxis("x",d.point,v),this.updateAxis("y",d.point,v),this.visualElement.render(),y&&y(h,d)},l=(h,d)=>{this.latestPointerEvent=h,this.latestPanInfo=d,this.stop(h,d),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>Qo(h=>{var d;return this.getAnimationState(h)==="paused"&&((d=this.getAxisMotionValue(h).animation)==null?void 0:d.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new AK(e,{onSessionStart:s,onStart:a,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,distanceThreshold:r,contextWindow:SK(this.visualElement)})}stop(e,t){const r=e||this.latestPointerEvent,i=t||this.latestPanInfo,s=this.isDragging;if(this.cancel(),!s||!i||!r)return;const{velocity:a}=i;this.startAnimation(a);const{onDragEnd:o}=this.getProps();o&&Rr.postRender(()=>o(r,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!jA(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let a=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(a=Phe(a,this.constraints[e],this.elastic[e])),s.set(a)}resolveConstraints(){var s;const{dragConstraints:e,dragElastic:t}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(s=this.visualElement.projection)==null?void 0:s.layout,i=this.constraints;e&&Z0(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=Fhe(r.layoutBox,e):this.constraints=!1,this.elastic=Bhe(t),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Qo(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=khe(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Z0(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=$ce(r,i.root,this.visualElement.getTransformPagePoint());let a=Lhe(i.layout.layoutBox,s);if(t){const o=t(Uce(a));this.hasMutatedConstraints=!!o,o&&(a=uK(o))}return a}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},u=Qo(c=>{if(!jA(c,t,this.currentDirection))return;let h=l&&l[c]||{};a&&(h={min:0,max:0});const d=i?200:1e6,f=i?40:1e7,p={type:"inertia",velocity:r?e[c]:0,bounceStiffness:d,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...s,...h};return this.startAxisValueAnimation(c,p)});return Promise.all(u).then(o)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return x3(this.visualElement,e),r.start(vB(e,r,0,t,this.visualElement,!1))}stopAnimation(){Qo(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Qo(e=>{var t;return(t=this.getAxisMotionValue(e).animation)==null?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)==null?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Qo(t=>{const{drag:r}=this.getProps();if(!jA(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(t);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[t];s.set(e[t]-kr(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!Z0(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Qo(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();i[a]=Ohe({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Qo(a=>{if(!jA(a,e,null))return;const o=this.getAxisMotionValue(a),{min:l,max:u}=this.constraints[a];o.set(kr(l,u,i[a]))})}addListeners(){if(!this.visualElement.current)return;Uhe.set(this.visualElement,this);const e=this.visualElement.current,t=M1(e,"pointerdown",l=>{const{drag:u,dragListener:c=!0}=this.getProps();u&&c&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();Z0(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),Rr.read(r);const a=lw(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(Qo(c=>{const h=this.getAxisMotionValue(c);h&&(this.originPoint[c]+=l[c].translate,h.set(h.get()+l[c].translate))}),this.visualElement.render())});return()=>{a(),t(),s(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:a=_3,dragMomentum:o=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function jA(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function zhe(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class $he extends $p{constructor(e){super(e),this.removeGroupControls=wl,this.removeListeners=wl,this.controls=new Vhe(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||wl}unmount(){this.removeGroupControls(),this.removeListeners()}}const g6=n=>(e,t)=>{n&&Rr.postRender(()=>n(e,t))};class Hhe extends $p{constructor(){super(...arguments),this.removePointerDownListener=wl}onPointerDown(e){this.session=new AK(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:SK(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:g6(e),onStart:g6(t),onMove:r,onEnd:(s,a)=>{delete this.session,i&&Rr.postRender(()=>i(s,a))}}}mount(){this.removePointerDownListener=M1(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const pM={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function v6(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const g_={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Bt.test(n))n=parseFloat(n);else return n;const t=v6(n,e.target.x),r=v6(n,e.target.y);return`${t}% ${r}%`}},Ghe={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=_p.parse(n);if(i.length>5)return r;const s=_p.createTransformer(n),a=typeof i[0]!="number"?1:0,o=t.x.scale*e.x,l=t.y.scale*e.y;i[0+a]/=o,i[1+a]/=l;const u=kr(o,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=u),typeof i[3+a]=="number"&&(i[3+a]/=u),s(i)}};let zR=!1;class jhe extends xe.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;fce(qhe),s&&(t.group&&t.group.add(s),r&&r.register&&i&&r.register(s),zR&&s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),pM.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:s}=this.props,{projection:a}=r;return a&&(a.isPresent=s,zR=!0,i||e.layoutDependency!==t||t===void 0||e.isPresent!==s?a.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?a.promote():a.relegate()||Rr.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),oB.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;zR=!0,i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function MK(n){const[e,t]=ace(),r=xe.useContext(sX);return k.jsx(jhe,{...n,layoutGroup:r,switchLayoutGroup:xe.useContext(oK),isPresent:e,safeToRemove:t})}const qhe={borderRadius:{...g_,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:g_,borderTopRightRadius:g_,borderBottomLeftRadius:g_,borderBottomRightRadius:g_,boxShadow:Ghe};function Whe(n,e,t){const r=Ys(n)?n:ob(n);return r.start(vB("",r,e,t)),r.animation}const Xhe=(n,e)=>n.depth-e.depth;class Khe{constructor(){this.children=[],this.isDirty=!1}add(e){$k(this.children,e),this.isDirty=!0}remove(e){Hk(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Xhe),this.isDirty=!1,this.children.forEach(e)}}function Yhe(n,e){const t=Ka.now(),r=({timestamp:i})=>{const s=i-t;s>=e&&(bp(r),n(s-e))};return Rr.setup(r,!0),()=>bp(r)}const CK=["TopLeft","TopRight","BottomLeft","BottomRight"],Qhe=CK.length,y6=n=>typeof n=="string"?parseFloat(n):n,x6=n=>typeof n=="number"||Bt.test(n);function Zhe(n,e,t,r,i,s){i?(n.opacity=kr(0,t.opacity??1,Jhe(r)),n.opacityExit=kr(e.opacity??1,0,ede(r))):s&&(n.opacity=kr(e.opacity??1,t.opacity??1,r));for(let a=0;a<Qhe;a++){const o=`border${CK[a]}Radius`;let l=b6(e,o),u=b6(t,o);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||x6(l)===x6(u)?(n[o]=Math.max(kr(y6(l),y6(u),r),0),(dc.test(u)||dc.test(l))&&(n[o]+="%")):n[o]=u}(e.rotate||t.rotate)&&(n.rotate=kr(e.rotate||0,t.rotate||0,r))}function b6(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const Jhe=DK(0,.5,gX),ede=DK(.5,.95,wl);function DK(n,e,t){return r=>r<n?0:r>e?1:t(rw(n,e,r))}function _6(n,e){n.min=e.min,n.max=e.max}function jo(n,e){_6(n.x,e.x),_6(n.y,e.y)}function w6(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function E6(n,e,t,r,i){return n-=e,n=GC(n,1/t,r),i!==void 0&&(n=GC(n,1/i,r)),n}function tde(n,e=0,t=1,r=.5,i,s=n,a=n){if(dc.test(e)&&(e=parseFloat(e),e=kr(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=kr(s.min,s.max,r);n===s&&(o-=e),n.min=E6(n.min,e,t,o,i),n.max=E6(n.max,e,t,o,i)}function S6(n,e,[t,r,i],s,a){tde(n,e[t],e[r],e[i],e.scale,s,a)}const nde=["x","scaleX","originX"],rde=["y","scaleY","originY"];function A6(n,e,t,r){S6(n.x,e,nde,t?t.x:void 0,r?r.x:void 0),S6(n.y,e,rde,t?t.y:void 0,r?r.y:void 0)}function T6(n){return n.translate===0&&n.scale===1}function NK(n){return T6(n.x)&&T6(n.y)}function M6(n,e){return n.min===e.min&&n.max===e.max}function ide(n,e){return M6(n.x,e.x)&&M6(n.y,e.y)}function C6(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function RK(n,e){return C6(n.x,e.x)&&C6(n.y,e.y)}function D6(n){return xa(n.x)/xa(n.y)}function N6(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class sde{constructor(){this.members=[]}add(e){$k(this.members,e),e.scheduleRender()}remove(e){if(Hk(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function ade(n,e,t){let r="";const i=n.x.translate/e.x,s=n.y.translate/e.y,a=(t==null?void 0:t.z)||0;if((i||s||a)&&(r=`translate3d(${i}px, ${s}px, ${a}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:u,rotate:c,rotateX:h,rotateY:d,skewX:f,skewY:p}=t;u&&(r=`perspective(${u}px) ${r}`),c&&(r+=`rotate(${c}deg) `),h&&(r+=`rotateX(${h}deg) `),d&&(r+=`rotateY(${d}deg) `),f&&(r+=`skewX(${f}deg) `),p&&(r+=`skewY(${p}deg) `)}const o=n.x.scale*e.x,l=n.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const $R=["","X","Y","Z"],ode=1e3;let lde=0;function HR(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function IK(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=vK(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Rr,!(i||s))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&IK(r)}function PK({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(a={},o=e==null?void 0:e()){this.id=lde++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(hde),this.nodes.forEach(mde),this.nodes.forEach(gde),this.nodes.forEach(dde)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new Khe)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new qk),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=XX(a)&&!rce(a),this.instance=a;const{layoutId:o,layout:l,visualElement:u}=this.options;if(u&&!u.current&&u.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),n){let c,h=0;const d=()=>this.root.updateBlockedByResize=!1;Rr.read(()=>{h=window.innerWidth}),n(a,()=>{const f=window.innerWidth;f!==h&&(h=f,this.root.updateBlockedByResize=!0,c&&c(),c=Yhe(d,250),pM.hasAnimatedSinceResize&&(pM.hasAnimatedSinceResize=!1,this.nodes.forEach(P6)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&u&&(o||l)&&this.addEventListener("didUpdate",({delta:c,hasLayoutChanged:h,hasRelativeLayoutChanged:d,layout:f})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||u.getDefaultTransition()||_de,{onLayoutAnimationStart:m,onLayoutAnimationComplete:y}=u.getProps(),v=!this.targetLayout||!RK(this.targetLayout,f),b=!h&&d;if(this.options.layoutRoot||this.resumeFrom||b||h&&(v||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const x={...sB(p,"layout"),onPlay:m,onComplete:y};(u.shouldReduceMotion||this.options.layoutRoot)&&(x.delay=0,x.type=!1),this.startAnimation(x),this.setAnimationOrigin(c,b)}else h||P6(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=f})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),bp(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(vde),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&IK(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let c=0;c<this.path.length;c++){const h=this.path[c];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(R6);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(I6);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(pde),this.nodes.forEach(ude),this.nodes.forEach(cde)):this.nodes.forEach(I6),this.clearAllSnapshots();const o=Ka.now();vs.delta=ad(0,1e3/60,o-vs.timestamp),vs.timestamp=o,vs.isProcessing=!0,RR.update.process(vs),RR.preRender.process(vs),RR.render.process(vs),vs.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,oB.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(fde),this.sharedNodes.forEach(yde)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Rr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Rr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!xa(this.snapshot.measuredBox.x)&&!xa(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=si(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!NK(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,c=u!==this.prevTransformTemplateValue;a&&this.instance&&(o||wm(this.latestValues)||c)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),wde(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:a}=this.options;if(!a)return si();const o=a.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(Ede))){const{scroll:c}=this.root;c&&(J0(o.x,c.offset.x),J0(o.y,c.offset.y))}return o}removeElementScroll(a){var l;const o=si();if(jo(o,a),(l=this.scroll)!=null&&l.wasRoot)return o;for(let u=0;u<this.path.length;u++){const c=this.path[u],{scroll:h,options:d}=c;c!==this.root&&h&&d.layoutScroll&&(h.wasRoot&&jo(o,a),J0(o.x,h.offset.x),J0(o.y,h.offset.y))}return o}applyTransform(a,o=!1){const l=si();jo(l,a);for(let u=0;u<this.path.length;u++){const c=this.path[u];!o&&c.options.layoutScroll&&c.scroll&&c!==c.root&&ey(l,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),wm(c.latestValues)&&ey(l,c.latestValues)}return wm(this.latestValues)&&ey(l,this.latestValues),l}removeTransform(a){const o=si();jo(o,a);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!wm(u.latestValues))continue;m3(u.latestValues)&&u.updateSnapshot();const c=si(),h=u.measurePageBox();jo(c,h),A6(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,c)}return wm(this.latestValues)&&A6(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==vs.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var d;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(a||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(d=this.parent)!=null&&d.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:c,layoutId:h}=this.options;if(!(!this.layout||!(c||h))){if(this.resolvedRelativeTargetAt=vs.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=si(),this.relativeTargetOrigin=si(),D1(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),jo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=si(),this.targetWithTransforms=si()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Dhe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):jo(this.target,this.layout.layoutBox),hK(this.target,this.targetDelta)):jo(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=si(),this.relativeTargetOrigin=si(),D1(this.relativeTargetOrigin,this.target,f.target),jo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||m3(this.parent.latestValues)||cK(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var p;const a=this.getLead(),o=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||(p=this.parent)!=null&&p.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===vs.timestamp&&(l=!1),l)return;const{layout:u,layoutId:c}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||c))return;jo(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,d=this.treeScale.y;zce(this.layoutCorrected,this.treeScale,this.path,o),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=si());const{target:f}=a;if(!f){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(w6(this.prevProjectionDelta.x,this.projectionDelta.x),w6(this.prevProjectionDelta.y,this.projectionDelta.y)),C1(this.projectionDelta,this.layoutCorrected,f,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==d||!N6(this.projectionDelta.x,this.prevProjectionDelta.x)||!N6(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",f))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ty(),this.projectionDelta=ty(),this.projectionDeltaWithTransform=ty()}setAnimationOrigin(a,o=!1){const l=this.snapshot,u=l?l.latestValues:{},c={...this.latestValues},h=ty();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const d=si(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,m=f!==p,y=this.getStack(),v=!y||y.members.length<=1,b=!!(m&&!v&&this.options.crossfade===!0&&!this.path.some(bde));this.animationProgress=0;let x;this.mixTargetDelta=w=>{const _=w/1e3;F6(h.x,a.x,_),F6(h.y,a.y,_),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(D1(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),xde(this.relativeTarget,this.relativeTargetOrigin,d,_),x&&ide(this.relativeTarget,x)&&(this.isProjectionDirty=!1),x||(x=si()),jo(x,this.relativeTarget)),m&&(this.animationValues=c,Zhe(c,u,this.latestValues,_,b,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){var o,l,u;this.notifyListeners("animationStart"),(o=this.currentAnimation)==null||o.stop(),(u=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||u.stop(),this.pendingAnimation&&(bp(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Rr.update(()=>{pM.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=ob(0)),this.currentAnimation=Whe(this.motionValue,[0,1e3],{...a,velocity:0,isSync:!0,onUpdate:c=>{this.mixTargetDelta(c),a.onUpdate&&a.onUpdate(c)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(ode),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:u,latestValues:c}=a;if(!(!o||!l||!u)){if(this!==a&&this.layout&&u&&FK(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||si();const h=xa(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+h;const d=xa(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+d}jo(o,l),ey(o,c),C1(this.projectionDeltaWithTransform,this.layoutCorrected,o,c)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new sde),this.sharedNodes.get(a).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const u={};l.z&&HR("z",a,u,this.animationValues);for(let c=0;c<$R.length;c++)HR(`rotate${$R[c]}`,a,u,this.animationValues),HR(`skew${$R[c]}`,a,u,this.animationValues);a.render();for(const c in u)a.setStaticValue(c,u[c]),this.animationValues&&(this.animationValues[c]=u[c]);a.scheduleRender()}applyProjectionStyles(a,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){a.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,a.visibility="",a.opacity="",a.pointerEvents=fM(o==null?void 0:o.pointerEvents)||"",a.transform=l?l(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(a.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,a.pointerEvents=fM(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!wm(this.latestValues)&&(a.transform=l?l({},""):"none",this.hasProjected=!1);return}a.visibility="";const c=u.animationValues||u.latestValues;this.applyTransformsToTarget();let h=ade(this.projectionDeltaWithTransform,this.treeScale,c);l&&(h=l(c,h)),a.transform=h;const{x:d,y:f}=this.projectionDelta;a.transformOrigin=`${d.origin*100}% ${f.origin*100}% 0`,u.animationValues?a.opacity=u===this?c.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:c.opacityExit:a.opacity=u===this?c.opacity!==void 0?c.opacity:"":c.opacityExit!==void 0?c.opacityExit:0;for(const p in ow){if(c[p]===void 0)continue;const{correct:m,applyTo:y,isCSSVariable:v}=ow[p],b=h==="none"?c[p]:m(c[p],u);if(y){const x=y.length;for(let w=0;w<x;w++)a[y[w]]=b}else v?this.options.visualElement.renderState.vars[p]=b:a[p]=b}this.options.layoutId&&(a.pointerEvents=u===this?fM(o==null?void 0:o.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(R6),this.root.sharedNodes.clear()}}}function ude(n){n.updateLayout()}function cde(n){var t;const e=((t=n.resumeFrom)==null?void 0:t.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=n.layout,{animationType:s}=n.options,a=e.source!==n.layout.source;s==="size"?Qo(h=>{const d=a?e.measuredBox[h]:e.layoutBox[h],f=xa(d);d.min=r[h].min,d.max=d.min+f}):FK(s,e.layoutBox,r)&&Qo(h=>{const d=a?e.measuredBox[h]:e.layoutBox[h],f=xa(r[h]);d.max=d.min+f,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[h].max=n.relativeTarget[h].min+f)});const o=ty();C1(o,r,e.layoutBox);const l=ty();a?C1(l,n.applyTransform(i,!0),e.measuredBox):C1(l,r,e.layoutBox);const u=!NK(o);let c=!1;if(!n.resumeFrom){const h=n.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:d,layout:f}=h;if(d&&f){const p=si();D1(p,e.layoutBox,d.layoutBox);const m=si();D1(m,r,f.layoutBox),RK(p,m)||(c=!0),h.options.layoutRoot&&(n.relativeTarget=m,n.relativeTargetOrigin=p,n.relativeParent=h)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:e,delta:l,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:c})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function hde(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function dde(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function fde(n){n.clearSnapshot()}function R6(n){n.clearMeasurements()}function I6(n){n.isLayoutDirty=!1}function pde(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function P6(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function mde(n){n.resolveTargetDelta()}function gde(n){n.calcProjection()}function vde(n){n.resetSkewAndRotation()}function yde(n){n.removeLeadSnapshot()}function F6(n,e,t){n.translate=kr(e.translate,0,t),n.scale=kr(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function L6(n,e,t,r){n.min=kr(e.min,t.min,r),n.max=kr(e.max,t.max,r)}function xde(n,e,t,r){L6(n.x,e.x,t.x,r),L6(n.y,e.y,t.y,r)}function bde(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const _de={duration:.45,ease:[.4,0,.1,1]},O6=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),k6=O6("applewebkit/")&&!O6("chrome/")?Math.round:wl;function B6(n){n.min=k6(n.min),n.max=k6(n.max)}function wde(n){B6(n.x),B6(n.y)}function FK(n,e,t){return n==="position"||n==="preserve-aspect"&&!Che(D6(e),D6(t),.2)}function Ede(n){var e;return n!==n.root&&((e=n.scroll)==null?void 0:e.wasRoot)}const Sde=PK({attachResizeListener:(n,e)=>lw(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),GR={current:void 0},LK=PK({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!GR.current){const n=new Sde({});n.mount(window),n.setOptions({layoutScroll:!0}),GR.current=n}return GR.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),Ade={pan:{Feature:Hhe},drag:{Feature:$he,ProjectionNode:LK,MeasureLayout:MK}};function U6(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,s=r[i];s&&Rr.postRender(()=>s(e,IS(e)))}class Tde extends $p{mount(){const{current:e}=this.node;e&&(this.unmount=Zue(e,(t,r)=>(U6(this.node,r,"Start"),i=>U6(this.node,i,"End"))))}unmount(){}}class Mde extends $p{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=DS(lw(this.node.current,"focus",()=>this.onFocus()),lw(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function V6(n,e,t){const{props:r}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),s=r[i];s&&Rr.postRender(()=>s(e,IS(e)))}class Cde extends $p{mount(){const{current:e}=this.node;e&&(this.unmount=nce(e,(t,r)=>(V6(this.node,r,"Start"),(i,{success:s})=>V6(this.node,i,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const w3=new WeakMap,jR=new WeakMap,Dde=n=>{const e=w3.get(n.target);e&&e(n)},Nde=n=>{n.forEach(Dde)};function Rde({root:n,...e}){const t=n||document;jR.has(t)||jR.set(t,{});const r=jR.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(Nde,{root:n,...e})),r[i]}function Ide(n,e,t){const r=Rde(e);return w3.set(n,t),r.observe(n),()=>{w3.delete(n),r.unobserve(n)}}const Pde={some:0,all:1};class Fde extends $p{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:s}=e,a={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:Pde[i]},o=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,s&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:c,onViewportLeave:h}=this.node.getProps(),d=u?c:h;d&&d(l)};return Ide(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(Lde(e,t))&&this.startObserver()}unmount(){}}function Lde({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const Ode={inView:{Feature:Fde},tap:{Feature:Cde},focus:{Feature:Mde},hover:{Feature:Tde}},kde={layout:{ProjectionNode:LK,MeasureLayout:MK}},Bde={...whe,...Ode,...Ade,...kde},ct=Bce(Bde,Qce),yB=[{slug:"general-relativity",title:"   ",category:"relativity",description:"Einstein Field Equation, Schwarzschild/Kerr ,  ",content:{overview:"    . Schwarzschild Kerr        (vacuum solution).",keyPoints:["Einstein Field Equation: G = 8GT","Schwarzschild :  ,   ","Kerr :  , ergosphere "," :  / ","Shapiro delay:    ",": f = f0(1-2GM/rc)"],keyFormulas:[{tex:"G_{\\mu\\nu} = R_{\\mu\\nu} - \\frac{1}{2}g_{\\mu\\nu}R = \\frac{8\\pi G}{c^4}T_{\\mu\\nu}",desc:"Einstein Field Equation"},{tex:"ds^2 = -\\left(1 - \\frac{2GM}{c^2r}\\right)c^2dt^2 + \\left(1 - \\frac{2GM}{c^2r}\\right)^{-1}dr^2 + r^2(d\\theta^2 + \\sin^2\\theta\\,d\\phi^2)",desc:"Schwarzschild "},{tex:"r_s = \\frac{2GM}{c^2}",desc:"Schwarzschild "},{tex:"\\frac{d^2x^\\lambda}{d\\tau^2} + \\Gamma^\\lambda_{\\mu\\nu}\\frac{dx^\\mu}{d\\tau}\\frac{dx^\\nu}{d\\tau} = 0",desc:" "}],observations:'   (42.98"/century),  ,  ',relatedPapers:["The Mathematical Theory of Black Holes (Chandrasekhar, 1983)","General Relativity (Carroll, 2004)","Gravitational Waves from Coalescing Compact Binaries (Abbott et al. LIGO, 2016)"]}},{slug:"stellar-structure",title:"   ",category:"stars",description:"  , Lane-Emden ,   ",content:{overview:"         .         .",keyPoints:[" : dP/dr = -GM/r","  : radiative flux  opacity ","Lane-Emden  :   "," : PP chain (), CNO cycle ()"," : convection instability criterion (adiabatic gradient vs. radiative gradient)",": photosphere  "],keyFormulas:[{tex:"\\frac{dP}{dr} = -\\rho \\frac{GM(<r)}{r^2}",desc:"  "},{tex:"F_\\mathrm{rad} = -\\frac{c}{3\\kappa\\rho}\\frac{dT^4}{dr}",desc:" "},{tex:"\\frac{d^2u}{d\\xi^2} + \\frac{2}{\\xi}\\frac{du}{d\\xi} + u^n = 0",desc:"Lane-Emden "},{tex:"PP\\,\\mathrm{chain}: {}^1H + {}^1H \\to {}^2H + e^+ + \\nu",desc:"-  "}],observations:"  L=3.82810W,  R=6.9610m,   T_c~1.5710K,  _c~150 g/cm",relatedPapers:["Stellar Interiors: Physical Principles, Structure and Evolution (Hansen, Kawaler & Trimble, 2004)","The Theory of Stellar Structure and Evolution (Kippenhahn, Weigert & Weiss, 2012)"]}},{slug:"black-hole-astrophysics",title:" : Kerr  ",category:"relativity",description:"Kerr ergosphere, ISCO , Hawking ,  ",content:{overview:" (Kerr )   .  (Hawking )   ,       .",keyPoints:["Kerr :   a = J/M ","Ergosphere:   g_tt=0 ","ISCO (Innermost Stable Circular Orbit): a=0  r_ISCO = 6GM/c","Hawking :  T_H = c/(8kGM)","Penrose process:    ","Accretion disk: viscosity   "],keyFormulas:[{tex:"ds^2 = -\\frac{\\Delta}{\\rho^2}(c\\,dt - a\\sin^2\\theta\\,d\\phi)^2 + \\frac{\\rho^2}{\\Delta}dr^2 + \\rho^2 d\\theta^2 + \\frac{\\sin^2\\theta}{\\rho^2}(a c\\,dt - (r^2+a^2)d\\phi)^2",desc:"Kerr  (Boyer-Lindquist )"},{tex:"r_{\\mathrm{ISCO}} = \\frac{GM}{c^2}\\left(3 + Z_2 - \\sqrt{(3-Z_1)(3+Z_1+2Z_2)}\\right)",desc:"ISCO  (Kerr )"},{tex:"T_H = \\frac{\\hbar c^3}{8\\pi k_B G M}",desc:"Hawking "},{tex:"\\eta = 1 - \\sqrt{1 - \\frac{2GM}{c^2 r_{\\mathrm{ISCO}}}}",desc:" "}],observations:"M87   M=(6.50.7)10M (EHT 2019), Sagittarius A*  M=(4.2970.013)10M",relatedPapers:["Black Hole Accretion in Supermassive and Stellar Mass Regimes (Done et al. 2007)","The Event Horizon Telescope Collaboration (2019, ApJ Letters)","Information and the Nature of Reality (Wheeler & Ford, 1998)"]}},{slug:"galaxy-dynamics",title:"  ",category:"galaxies",description:"Jeans ,   , CDM,  ",content:{overview:"  , ,    . Jeans        .",keyPoints:["Jeans :    "," :   NFW  ","Virial theorem: 2K + U = 0 ( )"," :   ~85%","CDM : M0.3, 0.7"," : N-body + hydrodynamics"],keyFormulas:[{tex:"\\frac{d\\sigma_r^2}{dr} + 2\\frac{\\beta}{r}\\sigma_r^2 = -\\frac{GM(<r)}{r^2}",desc:"Jeans "},{tex:"v_{\\mathrm{c}}(r) = \\sqrt{\\frac{GM(<r)}{r}}",desc:"  "},{tex:"\\rho_{\\mathrm{NFW}}(r) = \\frac{\\rho_s}{(r/r_s)(1+r/r_s)^2}",desc:"Navarro-Frenk-White  "},{tex:"2\\langle K \\rangle + \\langle U \\rangle = 0",desc:" Virial "}],observations:"    (220 km/s at 8 kpc),    ( )",relatedPapers:["Galactic Dynamics (Binney & Tremaine, 2008)","The Concentration of Dark Matter Halos (Navarro, Frenk & White, 1997)","Simulations of the formation, evolution and clustering of galaxies and quasars (Springel et al. 2005)"]}},{slug:"cosmology",title:"  ",category:"cosmology",description:"Friedmann , CMB  ,  ",content:{overview:"      . Friedmann     , CMB    CDM  .",keyPoints:["Friedmann : a(t)  "," : t = 13.7870.020 Gyr (Planck 2018)"," : _   120 ","CMB :   T/T ~ 10","  : C_     "," : w(z) = p/(c)"],keyFormulas:[{tex:"\\left(\\frac{\\dot{a}}{a}\\right)^2 + \\frac{k}{a^2} = \\frac{8\\pi G}{3}\\rho",desc:"1 Friedmann "},{tex:"\\frac{\\ddot{a}}{a} = -\\frac{4\\pi G}{3}(\\rho + 3p) + \\frac{\\Lambda}{3}",desc:"2 Friedmann "},{tex:"T(z) = T_0 (1+z)",desc:"  "},{tex:"w = \\frac{p}{\\rho c^2}",desc:"  "}],observations:"CMB: b=0.049, cdm=0.264, =0.684, H0=67.4 km/s/Mpc (Planck 2018)",relatedPapers:["Planck 2018 results (Planck Collaboration, 2018)","A High-Resolution Cosmic Microwave Background Map (WMAP, 2003-2013)","Observational Evidence from Supernovae for an Accelerating Universe (Perlmutter et al. 1999)"]}},{slug:"observational-astronomy",title:" : , , ",category:"observations",description:"Equivalent Width, Voigt profile, CCD photometry,  ",content:{overview:"    .   (Equivalent Width, Doppler shift), CCD ,      .",keyPoints:["Equivalent Width (EW):    ","Voigt profile:  +   ","CCD : -(S/N), (dynamic range)",'X-ray : Chandra  0.5",   100 eV',"IR  (JWST): NIRCam  0.6-5m,  /~1600"," (VLBI): baseline ~10000 km,  ~as"],keyFormulas:[{tex:"EW = \\int_{\\lambda_1}^{\\lambda_2} \\left(1 - \\frac{F_\\lambda}{F_c}\\right)d\\lambda",desc:""},{tex:"f(\\nu) = \\frac{I(\\nu_0)}{\\sqrt{\\pi}}\\int_{-\\infty}^{\\infty}\\frac{e^{-t^2}}{1+(a(\\nu-\\nu_0+t\\Delta\\nu_D)/\\Delta\\nu_D)^2}dt",desc:"Voigt "},{tex:"(S/N)_{\\mathrm{CCD}} = \\frac{Ne}{\\sqrt{Ne + n_r^2 + n_d^2}}",desc:"CCD -"},{tex:"\\theta_{\\mathrm{res}} \\approx 1.22\\frac{\\lambda}{D}",desc:"  (Rayleigh criterion)"}],observations:"JWST NIRCam z~11   (_obs~2m), Chandra    , EHT   (48as)",relatedPapers:["Observational Astrophysics (Birney, Gonzalez & Oesper, 2006)","Modern Observational Astronomy: the Principles, Science and Techniques (Filippenko, 2006)"]}},{slug:"mass-luminosity",title:"- ",category:"stars",description:"    ",content:{overview:"       .       .",keyPoints:[": L  M^3.5 ()","     (2.5~4.5)","     "],keyFormulas:[{tex:"L \\approx M^{3.5}",desc:"-  ()"},{tex:"t_{\\mathrm{lifetime}} \\approx \\frac{M}{L} \\propto M^{-2.5}",desc:"  "}],observations:"  1   1, 10   ~3000",relatedPapers:["Mass-Luminosity Relations (1970)","Stellar Evolution Theory (1995)"]}},{slug:"dark-matter-rotation",title:"  ",category:"galaxies",description:"      ",content:{overview:"            ,    .",keyPoints:["   :    "," :  v  1/r ( )",": v   (100~300 km/s)"," :   ~85%"],keyFormulas:[{tex:"v(r) = \\sqrt{\\frac{GM(<r)}{r}}",desc:"   "},{tex:"M(<r) \\propto r",desc:" r  "}],observations:"M31 ,     ",relatedPapers:["The Rotation of Spiral Nebulae (1975)","Dark Matter and Galaxy Formation (2010)"]}},{slug:"cosmic-microwave-background",title:"  (CMB)",category:"cosmology",description:"    , ,  ",content:{overview:"CMB   38       .      .",keyPoints:[": 1965 Penzias & Wilson",": 2.725 K ( )",":   T/T ~ 10",":   "],keyFormulas:[{tex:"T(z) = T_0 (1 + z)",desc:"  CMB "},{tex:"T_0 = 2.725 \\, \\mathrm{K}",desc:"CMB  "}],observations:"WMAP, Planck   m=0.315, =0.685, H0=67 km/s/Mpc ",relatedPapers:["A Measurement of the Fluctuations in the Cosmic Microwave Background (1992)","Planck 2018 results (2018)"]}},{slug:"gravitational-waves",title:"   ",category:"observations",description:"LIGO/Virgo ,  ,  ,   ",content:{overview:"     . 2015  (GW150914) ,   (BBH),  (BNS),  (NSBH)    . /          .",keyPoints:["LIGO/Virgo :    h ~ 10  "," :  (inspection)  (merger)  (ringdown) 3"," :  , , ,   Bayesian "," : r-process     ",": GW + GRB() + kilonova()  "," :   H0  ,   "],keyFormulas:[{tex:"h_+(t) = \\frac{2G}{c^4}\\frac{M_c^{5/3}}{D_L}\\left(\\pi f(t)\\right)^{2/3}\\cos(\\Phi(t))",desc:"  +  ( )"},{tex:"\\frac{df}{dt} = \\frac{96}{5}\\pi^{8/3}\\frac{G^{5/3}}{c^5}M_c^{5/3}f^{11/3}",desc:"   (chirp)"},{tex:"M_c = \\frac{(m_1 m_2)^{3/5}}{(m_1 + m_2)^{1/5}}",desc:" (chirp mass)"},{tex:"T_{\\mathrm{merge}} = \\frac{5}{256}\\frac{c^5}{G^3}\\frac{1}{M_c^{5/3}\\pi^{8/3}f_0^{8/3}}",desc:"   (f)"},{tex:"Q = \\frac{M \\omega}{c} \\quad (\\text{ISCO})\\, Q_{\\text{Kerr}} \\sim \\frac{c^3}{G M} \\left(1 + \\sqrt{1-a^*/a}\\right)",desc:"  "}],observations:"GW150914:  36+29 M, GW170817:  1.36-1.60 M, GW190814: -  (  9:1)",relatedPapers:["Observation of Gravitational Waves from a Binary Black Hole Merger (Abbott et al., PRL 2016)","GW170817: Observation of Gravitational Waves from a Binary Neutron Star Inspiral (Abbott et al., PRL 2017)","Tests of General Relativity with GW150914 (Abbott et al., PRL 2016)"]}},{slug:"high-energy-astrophysics",title:"  X ",category:"observations",description:"X-ray binary, AGN  , Compton , Synchrotron ",content:{overview:"  X(0.1~100 keV), (>100 keV)   . X , (AGN),      .      Compton  Synchrotron     .",keyPoints:["X-ray binary: / +   ( )","Low-mass X-ray binary (LMXB):   < 1 M,  X ","High-mass X-ray binary (HMXB):   > 10 M,  ","Compton :   +    ,  ","Inverse Compton:   +     X/","Synchrotron :     ","AGN  :   Seyfert 1/2  (  )"],keyFormulas:[{tex:"E_\\gamma \\approx 4\\gamma k_B T_e",desc:"Compton   (Thomson regime)"},{tex:"\\nu_{\\mathrm{sync}} = \\frac{e B}{2\\pi m_e c} \\gamma^2",desc:"Synchrotron  "},{tex:"L_\\mathrm{Edd} = \\frac{4\\pi G M m_p c}{\\sigma_T} \\approx 1.3 \\times 10^{38} \\left(\\frac{M}{M_\\odot}\\right) \\, \\mathrm{erg~s^{-1}}",desc:"Eddington  "},{tex:"\\tau_T = n_e \\sigma_T L",desc:"Thomson "}],observations:"Cygnus X-1 ( HMXB), Sco X-1 ( LMXB), M87  AGN ( ), NGC 4151 ()",relatedPapers:["Physics of Compact Objects (Wheeler et al., 1996)","X-ray Binaries (Lewin & van der Klis, 2006)","AGN Unification Model (Antonucci, 1993)"]}},{slug:"cosmic-ray-physics",title:"   ",category:"observations",description:"Fermi ,  ,   , - ",content:{overview:"    ( ).  ,  ,    . Fermi          .   ,  ,     .",keyPoints:["Fermi 1 :  / ,   (E/E  %)","Fermi 2 :  (magnetic mirror)    ","  : SNe Ia  SNe II  "," : E^(-2.7) power law (  10~10 eV)"," : CR      (  )"," : ~90% , ~10% , ~1%  "," (UHECR): E > 10 eV,  (GZK cutoff)"],keyFormulas:[{tex:"\\frac{dE}{dt} \\propto E",desc:"Fermi 1  (  )"},{tex:"N(E) \\propto E^{-\\alpha}",desc:"  power law (  2.7)"},{tex:"E_c = \\frac{3eB\\,r_L^2}{2\\Delta t}",desc:"Fermi    (  r_L,   t)"},{tex:"E_{\\mathrm{GZK}} \\approx 5 \\times 10^{19} \\, \\mathrm{eV}",desc:"GZK cutoff  (CMB )"}],observations:"  :    , IceCube   ( CR  )",relatedPapers:["The Origin of Cosmic Rays (Jokipii, 1987)","Cosmic Ray Propagation and Solar Modulation (Potgieter, 2013)","Supernova Remnants as Cosmic Ray Accelerators (Berezhko & Vlk, 2007)"]}},{slug:"adaptive-optics-interferometry",title:"  ",category:"observations",description:"  , VLBI,  ,  ",content:{overview:"    . (AO)          . VLBI( )         .",keyPoints:[" seeing:      (typical ~0.5~2 arcsec)"," :  = /(2D), D  ",": (wavefront sensor) +  (deformable mirror)  ","Strehl ratio: AO  . Strehl  1 (), 0 (  )","VLBI (Very Long Baseline Interferometry):   ,   "," : Keck I&II, VLTI (  ~ 1 )"," (phase closure):     "],keyFormulas:[{tex:"\\theta_{\\mathrm{diff}} = 1.22 \\frac{\\lambda}{D}",desc:"Rayleigh  "},{tex:"B_{\\mathrm{eff}} = \\lambda D / d",desc:"   ( , D baseline, d  )"},{tex:"S = \\exp\\left(-\\frac{\\pi^2}{2\\ln 2} \\sigma_\\phi^2\\right)",desc:"Strehl ratio (_: RMS  )"}],observations:"Event Horizon Telescope (EHT): 10  VLBI M87, Sgr A*   (2019, 2022)",relatedPapers:["Adaptive Optics for Astronomy (Roddier, 1999)","VLBI Astrometry (Porcas et al., 2003)","First M87 Event Horizon Telescope Results (EHT Collaboration, 2019)"]}},{slug:"modified-gravity",title:" : MOND TeVeS",category:"relativity",description:"  ,   , CDM ",content:{overview:"           . MOND (  )      , TeVeS  .",keyPoints:["MOND : a < a  F = m(a/a)  (a ~ 1.210 m/s)","  :   MOND   ( )","Deep MOND (Deep Modified Newtonian Dynamics): a << a F  (GMm/r)","TeVeS (Tensor-Vector-Scalar):  MOND,    ","Bullet Cluster :     , MOND  ","  (UV completion): MOND   "],keyFormulas:[{tex:"F = m \\frac{a^2}{a_0}\\,\\, (a << a_0)",desc:"Deep MOND "},{tex:"a_0 = \\frac{cH_0}{6}\\approx 1.2 \\times 10^{-10}\\,\\mathrm{m/s^2}",desc:"MOND "},{tex:"v_\\mathrm{rot} \\approx \\sqrt[4]{GMa_0}\\,\\, (a << a_0)",desc:"MOND   ( )"}],observations:"  ,   , CMB , BBN  ",relatedPapers:["MOND and the Dark Matter Problem (Milgrom, 2015)","Relativistic MOND via TeVeS (Bekenstein, 2004)","The Bullet Cluster Evidence against Dark Matter (Clowe et al., 2006)"]}},{slug:"dark-matter-detection",title:" : WIMPs, Axions,  ",category:"galaxies",description:" ,  ,  ,  ",content:{overview:"    85%   . WIMPs (   ) axions  ,     .",keyPoints:["WIMPs (Weakly Interacting Massive Particles):  10~1000 GeV/c,   ","Axions:    (eV ), QCD  "," : XENON, LUX, SuperCDMS       "," :      ,  "," : LHC      "," :    "],keyFormulas:[{tex:"\\sigma_{\\mathrm{WIMP-nucleon}} \\sim 10^{-45}\\,\\mathrm{cm}^2\\,\\, (\\mathrm{spin\\text{-}independent})",desc:"WIMP-  "},{tex:"m_a \\sim 10^{-6}\\,\\mathrm{eV} \\sim 10^{-2}\\,\\mathrm{eV}",desc:"  "},{tex:"F_a = \\frac{m_e v^2}{g_{a\\gamma\\gamma} m_a}",desc:"  "}],observations:"Planck 2018: _cdm h = 0.1200.001, LHC Run 2: WIMP   , AMS:   ",relatedPapers:["Dark Matter Candidates: From Theory to Direct Detection (Hooper & Kolb, 2010)","Axion Dark Matter Searches (Irastorza & Redondo, 2018)","XENON1T Results on Light Dark Matter Particles (XENON Collaboration, 2019)"]}},{slug:"exoplanet-systems",title:": , ,  ",category:"stars",description:"  ,  ,   , TRAPPIST-1 ",content:{overview:"5500   (2024).   (protoplanetary disk)    , /     .",keyPoints:[" :          (  )"," :        (m sin i)"," (transit photometry):        ( 0.01%)"," :      (HO, CO, CH)","  :         ","TESS/JWST:   ,    "],keyFormulas:[{tex:"\\frac{\\Delta F}{F} = \\frac{R_p^2}{R_*^2}",desc:"   (R_p: , R_*:  )"},{tex:"a_\\mathrm{HZ} = \\sqrt{\\frac{L_*}{L_\\odot}}",desc:"   "},{tex:"K = \\frac{(m \\sin i)}{\\sqrt{1-e^2}} \\sqrt{\\frac{GM_*}{a^3}}",desc:"RV  ( )"}],observations:"Kepler  2662, TESS  600+ (), TRAPPIST-1: 7   (3   )",relatedPapers:["Exoplanet Atmospheres (Seager, 2010)","Planet Formation in Protoplanetary Disks (Nakano et al., 2015)","JWST Transiting Exoplanet Community Early Release Science Program (Louie et al., 2023)"]}},{slug:"supernova-cosmology",title:" :  Ia  ",category:"cosmology",description:"  Ia ,   ,  , w ",content:{overview:'1998,   Type Ia  "  "   (Nobel 2011). SNe Ia      .',keyPoints:["Type Ia SN:       ",":    M_V  -19.3 (0.3)","Phillips :       (  )","Dust extinction:     (E(B-V) )","Hubble diagram:   vs  _ _m  "," :  ()  , w = -1 "],keyFormulas:[{tex:"m = M + 5\\log_{10}(d_L) + 25",desc:"  (m:  , M:  )"},{tex:"d_L = \\frac{1+z}{H_0} \\int_0^z \\frac{dz^\\prime}{E(z^\\prime)}",desc:"  (CDM)"},{tex:"M_V^\\mathrm{corr} = M_V - 2.5\\alpha(s-1)",desc:"Phillips  (s:  )"}],observations:"Riess et al. 1998 42 SNe Ia, Perlmutter et al. 1999 52 SNe Ia,  1000+  , H = 73.041.04 km/s/Mpc (SH0ES 2022)",relatedPapers:["Observational Evidence from Supernovae for an Accelerating Universe (Riess et al., 1998)","Measurements of  and  from 42 High-Redshift Supernovae (Perlmutter et al., 1999)","Local Void is Consistent with CDM (Kenworthy et al., 2021)"]}},{slug:"agn-unified-model",title:"   : , ,  ",category:"galaxies",description:" ,  , Fanaroff-Riley , Eddington ",content:{overview:"AGN (Active Galactic Nuclei)  (SMBH)  .  ( ,  )    ,   .",keyPoints:["SMBH:    10~10 M",":   (inner disk) +   (outer disk)","(Torus):    ,    >> 1","(Jet):   ,    ~ 0.99","Fanaroff-Riley : FR I (,  ) vs FR II (,  )","Eddington : L_Edd = 4GMm_p c/_T  1.410(M/M) W"," (BLR/NLR):    "],keyFormulas:[{tex:"L_\\mathrm{Edd} = \\frac{4\\pi GMm_p c}{\\sigma_T} = 1.4 \\times 10^{31}\\left(\\frac{M}{M_\\odot}\\right)\\,\\mathrm{W}",desc:"Eddington "},{tex:"\\lambda_\\mathrm{Edd} = \\frac{L_\\mathrm{bol}}{L_\\mathrm{Edd}}",desc:"Eddington "},{tex:"\\dot{M} = \\frac{L}{\\eta c^2}",desc:" (: radiative efficiency)"}],observations:"M87 SMBH M=(6.50.7)10M, Centaurus A   >4 Mpc, NGC 1068   (ALMA)",relatedPapers:["AGN Unification: The Quest Continues (Krolik, 2007)","Accretion in Supermassive Black Holes (Narayan & Quataert, 2005)","First M87 Event Horizon Telescope Results (EHT Collaboration, 2019)"]}}],z6=[{term:"Absolute Magnitude ()",definition:"  10 pc    .    ."},{term:"Accretion Disk ( )",definition:",        .  40%   ."},{term:"Adiabatic Gradient ( )",definition:"        . dT/dP = T/(P)."},{term:"Blackbody Radiation ()",definition:"   ,      . Planck  ."},{term:"Blue Shift ()",definition:"      .  < 0."},{term:"CCD Photometry (CCD )",definition:"Charge-Coupled Device    . -  100  ."},{term:"CMB Power Spectrum (CMB )",definition:"CMB      C_ .  ,    ."},{term:"CNO Cycle (CNO )",definition:"   : C  N  C  N  O  N  C + He."},{term:"Doppler Shift ( )",definition:"    . v << c  / = v/c."},{term:"Dynamical Mass ( )",definition:"Jeans     .      ."},{term:"EOS Parameter ( )",definition:" w = p/(c). CDM w = -1.  ."},{term:"Equivalent Width (, EW)",definition:"     .  column density  ."},{term:"Ergosphere ()",definition:"Kerr   g_tt > 0 .       ."},{term:"Friedmann Equation ( )",definition:"    . (/a) + k/a = 8G/3."},{term:"Geodesic ()",definition:'    . Riemannian  "" .'},{term:"Gravitational Redshift ()",definition:"     . / = -GM/cr."},{term:"Gravitational Waves ()",definition:"   .  h ~ 10 (LIGO).  ,   ."},{term:"Gravitational Wave Strain ( )",definition:"LIGO     : h = L/L ~ 10.   ."},{term:"Gravitational Wave Detector ( )",definition:"LIGO, Virgo, KAGRA    .      ."},{term:"MOND (Modified Newtonian Dynamics)",definition:"      . a < a ~ 10 m/s   ."},{term:"TeVeS (Tensor-Vector-Scalar Gravity)",definition:"MOND  .   = ."},{term:"Bullet Cluster ( )",definition:"    . X-        ."},{term:"WIMPs (Weakly Interacting Massive Particles)",definition:" .  10~1000 GeV/c,     ."},{term:"Axion ()",definition:"     (eV~meV ). QCD  Peccei-Quinn  ."},{term:"Exoplanet ()",definition:"    . 5500+  (2024).  ,   ."},{term:"Habitable Zone (  )",definition:"          .    ."},{term:"Type Ia Supernova (Ia )",definition:"      .      ."},{term:"Phillips Relation (Phillips )",definition:"Type Ia SN     .      ."},{term:"AGN (Active Galactic Nuclei)",definition:" .       ."},{term:"SMBH (Supermassive Black Hole)",definition:"   .  10~10 M.     ."},{term:"AGN Torus (AGN )",definition:"AGN     .    >> 1.     ."},{term:"Eddington Luminosity (Eddington )",definition:"    . L_Edd = 4GMm_p c/_T  1.410(M/M) W."},{term:"Fanaroff-Riley Classification",definition:"Radio galaxy  . FR I:    . FR II:    ."},{term:"Hawking Radiation ( )",definition:"   .  T_H = c/(8kGM)."},{term:"Hubble Constant ( )",definition:"   . H  67-73 km/s/Mpc (   )."},{term:"Hubble Distance ( )",definition:"     . d_H = c/H  4400 Mpc."},{term:"ISCO (  )",definition:"Innermost Stable Circular Orbit.     . r_ISCO = 6GM/c (Schwarzschild)."},{term:"Jeans Equation ( )",definition:"   . d_r/dr + 2_r/r = -GM/r."},{term:"Jeans Mass ( )",definition:"    . M_J = (kT/G)^(3/2)(5T/G)^(1/2)."},{term:"Kerr Metric ( )",definition:"   .   a = J/Mc .    ."},{term:"Lane-Emden Equation (- )",definition:"     . du/d + 2/du/d + u^n = 0."},{term:"Luminosity Distance ( )",definition:"      . d_L = (1+z)d_c (CDM)."},{term:"LIGO (Laser Interferometer Gravitational-Wave Observatory)",definition:"  . Hanford & Livingston   .   4 km,   125 W."},{term:"Mass-Luminosity Relation (- )",definition:"L  M^,    3.5.    ."},{term:"MHD Simulations ( )",definition:"     .  , ,   ."},{term:"Matched Filtering ( )",definition:"   .   (cross-correlation) S/N ."},{term:"Merger ()",definition:"   . /     ."},{term:"NFW Profile (NFW  )",definition:"Navarro-Frenk-White   :   1/(r/r_s(1+r/r_s))."},{term:"Neutron Star ()",definition:"     .  ~10 km,  ~10^17 kg/cm,  ."},{term:"Opacity ()",definition:"    .  = /().     ."},{term:"Photometric Redshift ( )",definition:"     .     ."},{term:"Planck Function ( )",definition:"   . B_ = 2h/c1/(e^(h/kT)-1)."},{term:"QFT in Curved Spacetime (  )",definition:" . Hawking   ."},{term:"Radiative Transfer ( )",definition:"    . F_rad = -c/(3)dT/dr."},{term:"Redshift ()",definition:"    . z = (_obs - _emit)/_emit."},{term:"Rotation Curve ()",definition:"   vs  .     ."},{term:"Schwarzschild Metric ( )",definition:"   .   . r_s = 2GM/c ."},{term:"Shapiro Delay ( )",definition:"   . t = (2GM/c)ln(4rr/b)."},{term:"Spectral Classification ( )",definition:"   : O B A F G K M.   100 K ."},{term:"Starburst Galaxy ( )",definition:"     . SFR > 1 M/yr.    ."},{term:"Stefan-Boltzmann Law (- )",definition:"  : L = 4RT,  = 5.6710 W m K."},{term:"Tully-Fisher Relation (- )",definition:"     .    ."},{term:"Tidal Deformability ( )",definition:"    .  .    ."},{term:"Time Delay ( )",definition:"     .  (sky localization) ."},{term:"Virial Theorem ( )",definition:"  : 2K + U = 0 ( )."},{term:"Virgo (  )",definition:" Cascina  .   3 km,   200 W. LIGO 3  ."},{term:"Voigt Profile ( )",definition:" ( + )   .    ."},{term:"White Dwarf ()",definition:"   .    .   (Hubble time > age)."},{term:"X-ray Spectroscopy (X )",definition:"Chandra, XMM-Newton     .  K (6.4 keV)    ."},{term:"Zero-Age Main Sequence (ZAMS)",definition:"      . Hertzsprung-Russell  ."}],Ude=[{id:1,title:"Observation of Gravitational Waves from a Binary Black Hole Merger",authors:"Abbott, B. P. et al. (LIGO/Virgo Collaboration)",year:2016,arxivId:"1602.03837",journal:"Physical Review Letters 116, 061102",doi:"10.1103/PhysRevLett.116.061102",abstract:"On 14 September 2015 at 09:50:45 UTC the two detectors of the Laser Interferometer Gravitational-Wave Observatory observed a transient gravitational-wave signal. The signal sweeps upward in frequency from 35 to 250 Hz, with peak gravitational-wave strain of 1.0  10.",summary:{background:"  100     .        .",methodology:"Matched filtering :     . S/N > 24 . Bayesian parameter estimation , , ,  .",theory:"   : dE/dt = -32/5G/(c)(mm)(m+m)/(a).    Kerr  .",data_analysis:"Advanced LIGO (2 ): N = 510/Hz @ 100Hz. 4 km arm interferometer, Fabry-Prot cavity resonator .  :   , /  subtraction.",results:"  () q = 1.20.1,   M = 65 M,    M_f = 62 M,  E = 3.0 Mc (   ).",limiting_factors:" shot noise  thermal noise ,   0.2  parameter inference  ."}},{id:2,title:"First M87 Event Horizon Telescope Results. I. The Shadow of the Supermassive Black Hole",authors:"Event Horizon Telescope Collaboration",year:2019,arxivId:"1906.11238",journal:"The Astrophysical Journal Letters 875, L1",doi:"10.3847/2041-8213/ab0ec7",abstract:"We present the first Event Horizon Telescope (EHT) observations at 1.3 mm wavelength of the supermassive black hole candidate in the galactic center of the radio galaxy M87. We have resolved the central compact radio source on angular scales of ~5 microarcseconds.",summary:{background:"         . VLBI    10,000 km .",methodology:"Very Long Baseline Interferometry (VLBI): 8    .    . Phase calibration, self-calibration  . Imaging: CLEAN ,   .",theory:"General relativistic magnetohydrodynamics (GRMHD)    . Kerr     (null geodesics).   : r_shadow  5.2 GM/c (M87  r_shadow  42 as).",data_analysis:"Visibility :   . u-v plane   .     . Uncertainty quantification:    .",results:"  M = (6.50.7)10 M.     d = 42.03.0 as.   10%  .    .",limiting_factors:"  ,    ,  (intraday variability) ,    ."}},{id:3,title:"A Universe of Black Holes and Bulges Revealed by JWST",authors:"Labb, I. et al.",year:2023,arxivId:"2306.02465",journal:"Nature ( )",doi:"10.1038/nature25755",abstract:"The James Webb Space Telescope (JWST) has revealed a population of surprisingly massive galaxies at z > 10, indicating accelerated galaxy assembly in the early universe.",summary:{background:"JWST     (z > 6)    .        .",methodology:"NIRCam : 0.6-5 m ,   SED fitting.  : NIRSpec   (R ~ 1000). (PSF) ,  .",theory:"SED modeling: Stellar population synthesis (FSPS, BAGPIPES). Dust attenuation curve . Photometric redshift vs spectroscopic redshift . Virial mass : M_vir = r/G ( ).",data_analysis:": P(z, params | data)  L(data | z, params)  Prior(z, params). Bayesian inference , , SFR .     (confidence interval) .",results:" z = 13.2  JADES-GS-z13-0:  M* = (3.21.9)10 M.  ~500 Myr.    330 Myr   (   a = 0.07).",limiting_factors:"  ,      degeneracy,  -    ,   ."}},{id:4,title:"The Weak Gravitational Lensing Signal and the Clustering of GAMA Galaxies",authors:"Leauthaud, A. et al.",year:2017,arxivId:"1511.06428",journal:"Monthly Notices of the Royal Astronomical Society",doi:"10.1093/mnras/stw2897",abstract:"We present joint measurements of the weak gravitational lensing signal around GAMA galaxies and their clustering. These measurements allow direct constraints on galaxy assembly bias and the dark matter halo profiles.",summary:{background:"          .     .",methodology:"Weak lensing shear : background     (typical  ~ 0.01).  :  = _cr  _tan. 2-point correlation   clustering .",theory:"NFW : (r) = _s / [(r/r_s)(1+r/r_s)].  c  r    M = (4/3)_crit200r. Halo mass function  .",data_analysis:"Forward modeling:   shear     .  galaxy-halo  (P(halo mass | galaxy properties)). Likelihood: L = _i P(data_i | model, params).",results:"  M* = 10 M     M_DM ~ 10 M.   c = 5.01.5.      .",limiting_factors:"    S/N,    (shape noise), systematic lensing , photometric redshift ."}},{id:5,title:"GW170817: Observation of Gravitational Waves from a Binary Neutron Star Inspiral",authors:"Abbott, B. P. et al. (LIGO/Virgo Collaboration)",year:2017,arxivId:"1710.05832",journal:"Physical Review Letters 119, 161101",doi:"10.1103/PhysRevLett.119.161101",abstract:"On August 17, 2017 at 12:41:04 UTC the Advanced LIGO and Advanced Virgo gravitational-wave detectors made their first observation of a binary neutron star inspiral. A loud gravitational-wave signal was detected with a duration of approximately 100 seconds.",summary:{background:"   r-process (  )  .  +  (kilonova)     .",methodology:"Bayesian parameter estimation: 9  ~ , , ,  . Matched filtering  . 3 (LIGO Hanford, LIGO Livingston, Virgo)  source localization (sky position ).",theory:"  :   M_max . Tidal deformability   (compressibility) .    5 (  ).",data_analysis:"  ~100 sec     . Nested sampling    (marginalized probability) . Model comparison: BNS vs NSBH vs BBH.",results:"  : m = 1.36-1.60 M, m = 1.17-1.36 M. Tidal deformability  = 560. r-process    0.03-0.05 M.  kilonova AT2017gfo   .",limiting_factors:"Virgo    source localization  (~600 sq deg),   (gap),  merger   ."}}],A0=[{id:1,name:"  ",description:", ,    "},{id:2,name:" ",description:" , , CCD, , VLBI  "},{id:3,name:" ",description:"LIGO, EHT, JWST     "},{id:4,name:" ",description:"N-body, MHD, hydrodynamics   "},{id:5,name:" ",description:", Bayesian ,   "},{id:6,name:" ",description:", ,  ,   "}],qR={textbooks:[{title:"Gravitational Waves Volume 1: Theory and Experiments",authors:"Maggiore, M.",year:2007},{title:"The Theory of Stellar Structure and Evolution",authors:"Kippenhahn, R., Weigert, A. & Weiss, A.",year:2012},{title:"Galactic Dynamics",authors:"Binney, J. & Tremaine, S.",year:2008},{title:"General Relativity",authors:"Carroll, S. M.",year:2004},{title:"Black Hole Thermodynamics",authors:"Wald, R. M.",year:2001},{title:"Observational Astrophysics",authors:"Birney, D. S., Gonzalez, G. & Oesper, D. A.",year:2006},{title:"The Early Universe",authors:"Kolb, E. W. & Turner, M. S.",year:1990},{title:"Modern Astrophysics",authors:"Carroll, B. W., Ostlie, D. A. & et al.",year:2007}],databases:[{name:"NASA ADS (Astrophysics Data System)",url:"https://ui.adsabs.harvard.edu/",desc:"    . 240+  ."},{name:"arXiv Astro-ph",url:"https://arxiv.org/archive/astro-ph",desc:" .  ~50  .   ."},{name:"Simbad",url:"https://simbad.u-strasbg.fr/",desc:", ,      , ."},{name:"NED (NASA Extragalactic Database)",url:"https://ned.ipac.caltech.edu/",desc:"   . , ,    ."},{name:"VizieR",url:"https://vizier.cds.unistra.fr/",desc:"700+      ."},{name:"Gravitational Wave Open Science Center (GWOSC)",url:"https://gwosc.readthedocs.io/",desc:"LIGO/Virgo  ,  , ."}],tools:[{name:"GIZMO",url:"https://www.tapir.caltech.edu/~phopkins/Site/GIZMO.html",desc:"N-body +  +  +    ."},{name:"ATHENA++",url:"https://www.athena-code.org/",desc:"  (GRMHD) .    ."},{name:"Planck 2018 Legacy Release",url:"https://irsa.ipac.caltech.edu/data/Planck/",desc:"CMB  ,  ,   ."},{name:"FSPS (Flexible Stellar Population Synthesis)",url:"https://github.com/bd-j/fsps",desc:"   . SED ."},{name:"dynesty (Dynamic Nested Sampling)",url:"https://github.com/joshspeagle/dynesty",desc:"   Bayesian .   ."},{name:"SIMBAD Sky Map",url:"http://simbad.u-strasbg.fr/simbad/sim-fcoo",desc:"      ."},{name:"JWST Exposure Time Calculator",url:"https://jwst.etc.stsci.edu/",desc:"JWST     S/N ."}]},mM={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},gM={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4}}};function Vde(){const{isDark:n}=Nl(),e=yB.slice(0,3);return xe.useEffect(()=>{if(!localStorage.getItem("registeredUsers")){const r={[btoa("test@example.com")]:{email:"test@example.com",password:btoa("Test1234"),username:"",affiliation:" ",createdAt:new Date().toISOString()}};localStorage.setItem("registeredUsers",JSON.stringify(r)),console.log("   : test@example.com / Test1234")}},[]),k.jsxs("div",{className:"space-y-8 sm:space-y-12",children:[k.jsxs("section",{className:"py-8 sm:py-12 md:py-20 text-center",children:[k.jsx(ct.div,{initial:{opacity:0,y:-30},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},children:k.jsx("h1",{className:"text-4xl sm:text-5xl md:text-6xl font-bold mb-4 bg-gradient-to-r from-blue-500 to-purple-600 dark:from-blue-400 dark:to-purple-500 bg-clip-text text-transparent",children:" "})}),k.jsx(ct.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"text-base sm:text-lg md:text-xl text-gray-600 dark:text-gray-300 mb-8 px-4",children:" ,  ,   "}),k.jsxs(ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},className:"flex flex-col sm:flex-row gap-4 justify-center px-4",children:[k.jsx(ct.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:k.jsx(hr,{to:"/concepts",className:"block px-8 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 transition font-medium shadow-lg hover:shadow-xl",children:" "})}),k.jsx(ct.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:k.jsx(hr,{to:"/papers",className:"block px-8 py-3 bg-gradient-to-r from-orange-600 to-orange-700 text-white rounded-lg hover:from-orange-700 hover:to-orange-800 transition font-medium shadow-lg hover:shadow-xl",children:" "})})]})]}),k.jsx(ct.section,{variants:mM,initial:"hidden",whileInView:"visible",viewport:{once:!0,amount:.2},className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 sm:gap-6",children:[{title:" ",description:", ,        ",icon:""},{title:" ",description:"    .    ",icon:""},{title:"",description:", ,    .    ",icon:""}].map((t,r)=>k.jsxs(ct.div,{variants:gM,whileHover:{y:-8,boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1)"},className:`p-6 rounded-lg border transition ${n?"bg-gray-800 border-gray-700 hover:border-blue-500":"bg-white border-gray-200 hover:border-blue-500"}`,children:[k.jsx("div",{className:"text-4xl mb-3",children:t.icon}),k.jsx("h3",{className:`text-lg sm:text-xl font-bold mb-2 ${n?"text-white":"text-gray-900"}`,children:t.title}),k.jsx("p",{className:`text-sm sm:text-base ${n?"text-gray-300":"text-gray-600"}`,children:t.description})]},r))}),k.jsxs(ct.section,{initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.6},viewport:{once:!0,amount:.2},children:[k.jsx(ct.h2,{initial:{opacity:0,x:-30},whileInView:{opacity:1,x:0},transition:{duration:.6},viewport:{once:!0},className:"text-2xl sm:text-3xl md:text-4xl font-bold mb-6 text-gray-900 dark:text-white",children:" "}),k.jsx(ct.div,{variants:mM,initial:"hidden",whileInView:"visible",viewport:{once:!0,amount:.1},className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:e.map(t=>k.jsx(ct.div,{variants:gM,whileHover:{y:-8},className:`p-6 rounded-lg border transition cursor-pointer ${n?"bg-gray-800 border-gray-700 hover:border-blue-500":"bg-white border-gray-200 hover:border-blue-500"}`,children:k.jsxs(hr,{to:`/concepts/${t.slug}`,children:[k.jsx("h3",{className:"text-base sm:text-lg font-bold text-blue-600 dark:text-blue-400 mb-2",children:t.title}),k.jsx("p",{className:`text-sm sm:text-base ${n?"text-gray-300":"text-gray-600"}`,children:t.description})]})},t.slug))})]}),k.jsxs(ct.section,{initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.6},viewport:{once:!0,amount:.2},children:[k.jsx(ct.h2,{initial:{opacity:0,x:-30},whileInView:{opacity:1,x:0},transition:{duration:.6},viewport:{once:!0},className:"text-2xl sm:text-3xl md:text-4xl font-bold mb-6 text-gray-900 dark:text-white",children:"  "}),k.jsx(ct.div,{variants:mM,initial:"hidden",whileInView:"visible",viewport:{once:!0,amount:.1},className:"space-y-4",children:Ude.map(t=>k.jsxs(ct.div,{variants:gM,whileHover:{x:8},className:`p-4 sm:p-6 rounded-lg border transition ${n?"bg-gray-800 border-gray-700 hover:border-orange-500":"bg-white border-gray-200 hover:border-orange-500"}`,children:[k.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-2",children:[k.jsxs("div",{className:"flex-1",children:[k.jsx("h3",{className:"font-bold text-blue-600 dark:text-blue-400 text-sm sm:text-base",children:t.title}),k.jsxs("p",{className:`text-xs sm:text-sm ${n?"text-gray-400":"text-gray-500"}`,children:[t.authors," (",t.year,")"]})]}),k.jsx("span",{className:`text-xs px-3 py-1 rounded whitespace-nowrap ${n?"bg-gray-700 text-gray-300":"bg-gray-200 text-gray-700"}`,children:t.year})]}),k.jsx("p",{className:`text-xs sm:text-sm mt-3 ${n?"text-gray-300":"text-gray-600"}`,children:t.abstract})]},t.id))}),k.jsx(ct.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},className:"mt-8 text-center",children:k.jsx(ct.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:k.jsx(hr,{to:"/papers",className:"inline-block px-8 py-3 bg-gradient-to-r from-orange-600 to-orange-700 text-white rounded-lg hover:from-orange-700 hover:to-orange-800 transition font-medium shadow-lg hover:shadow-xl",children:"   "})})})]})]})}function zde(){const{isDark:n}=Nl(),e={relativity:"",stars:"",galaxies:"",cosmology:"",observations:""},t={relativity:"from-red-500 to-pink-500",stars:"from-yellow-500 to-orange-500",galaxies:"from-purple-500 to-indigo-500",cosmology:"from-blue-500 to-cyan-500",observations:"from-green-500 to-emerald-500"};return k.jsxs("div",{className:"space-y-12 sm:space-y-16",children:[k.jsxs(ct.div,{initial:{opacity:0,y:-30},animate:{opacity:1,y:0},transition:{duration:.6},children:[k.jsx("h1",{className:"text-4xl sm:text-5xl font-bold mb-4 bg-gradient-to-r from-blue-600 to-purple-600 dark:from-blue-400 dark:to-purple-400 bg-clip-text text-transparent",children:" "}),k.jsx(ct.p,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.2},className:`text-sm sm:text-base ${n?"text-gray-300":"text-gray-600"}`,children:"  5  , 14     ."})]}),Object.entries(e).map(([r,i],s)=>{const a=yB.filter(o=>o.category===r);return a.length===0?null:k.jsxs(ct.section,{initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.6},viewport:{once:!0,amount:.1},children:[k.jsx(ct.div,{initial:{opacity:0,x:-30},whileInView:{opacity:1,x:0},transition:{duration:.6},viewport:{once:!0},className:"mb-6",children:k.jsx("div",{className:`inline-block bg-gradient-to-r ${t[r]} p-0.5 rounded-lg`,children:k.jsx("div",{className:`px-4 py-2 rounded-md ${n?"bg-gray-900":"bg-white"}`,children:k.jsx("h2",{className:`text-lg sm:text-xl font-bold bg-gradient-to-r ${t[r]} bg-clip-text text-transparent`,children:i})})})}),k.jsx(ct.div,{variants:mM,initial:"hidden",whileInView:"visible",viewport:{once:!0,amount:.1},className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:a.map((o,l)=>k.jsxs(ct.div,{variants:gM,whileHover:{y:-12,boxShadow:"0 20px 40px -10px rgba(0, 0, 0, 0.15)"},className:`group relative overflow-hidden rounded-xl border-2 transition cursor-pointer ${n?"bg-gradient-to-br from-gray-800 to-gray-900 border-gray-700 hover:border-blue-500":"bg-gradient-to-br from-white to-gray-50 border-gray-200 hover:border-blue-500"}`,children:[k.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${t[r]} opacity-0 group-hover:opacity-5 transition-opacity duration-300`}),k.jsxs(hr,{to:`/concepts/${o.slug}`,className:"relative block p-6",children:[k.jsx("div",{className:"mb-4",children:k.jsx("span",{className:`inline-block px-3 py-1 text-xs font-semibold rounded-full ${n?"bg-gray-700 text-blue-300":"bg-blue-100 text-blue-700"}`,children:i})}),k.jsx("h3",{className:"text-base sm:text-lg font-bold mb-2 text-blue-600 dark:text-blue-400 group-hover:translate-x-1 transition-transform",children:o.title}),k.jsx("p",{className:`text-sm sm:text-base line-clamp-2 mb-4 ${n?"text-gray-300":"text-gray-600"}`,children:o.description}),k.jsxs("div",{className:`text-xs space-y-1 ${n?"text-gray-400":"text-gray-500"}`,children:[o.content.keyPoints.slice(0,2).map((u,c)=>k.jsxs("div",{className:"flex items-start gap-2",children:[k.jsx("span",{className:"text-blue-400",children:""}),k.jsx("span",{className:"line-clamp-1",children:u})]},c)),o.content.keyPoints.length>2&&k.jsxs("div",{className:"text-blue-500 font-medium",children:["+ ",o.content.keyPoints.length-2," ..."]})]})]})]},o.slug))})]},r)})]})}function $de({tex:n,display:e=!1}){return xe.useEffect(()=>{if(window.katex)try{window.katex.render(n,document.getElementById(`math-${n}`),{displayMode:e,throwOnError:!1})}catch(t){console.error("KaTeX error:",t)}},[n,e]),k.jsx("div",{id:`math-${n}`,className:"inline-block"})}function Hde(){const{slug:n}=QW(),e=yB.find(r=>r.slug===n);if(!e)return k.jsx("div",{className:"text-center py-12 text-gray-600 dark:text-gray-300",children:"   ."});const{content:t}=e;return k.jsxs("div",{className:"max-w-3xl mx-auto space-y-6 sm:space-y-8",children:[k.jsxs("div",{children:[k.jsx("h1",{className:"text-3xl sm:text-4xl font-bold mb-2 text-gray-900 dark:text-white",children:e.title}),k.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm sm:text-base",children:e.description})]}),k.jsxs("section",{className:"bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 sm:p-6 rounded-lg",children:[k.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-4 text-gray-900 dark:text-white",children:""}),k.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed text-sm sm:text-base",children:t.overview})]}),k.jsxs("section",{className:"px-4 sm:px-0",children:[k.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-4 text-gray-900 dark:text-white",children:" "}),k.jsx("ul",{className:"space-y-2",children:t.keyPoints.map((r,i)=>k.jsxs("li",{className:"flex gap-3 text-sm sm:text-base",children:[k.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-bold flex-shrink-0",children:""}),k.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:r})]},i))})]}),t.keyFormulas&&t.keyFormulas.length>0&&k.jsxs("section",{className:"px-4 sm:px-0",children:[k.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-4 text-gray-900 dark:text-white",children:" "}),k.jsx("div",{className:"space-y-4",children:t.keyFormulas.map((r,i)=>k.jsxs("div",{className:"bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 sm:p-6 rounded-lg overflow-x-auto",children:[k.jsx($de,{tex:r.tex}),k.jsx("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 mt-2",children:r.desc})]},i))})]}),k.jsxs("section",{className:"bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 sm:p-6 rounded-lg",children:[k.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-4 text-gray-900 dark:text-white",children:" "}),k.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm sm:text-base",children:t.observations})]}),t.relatedPapers&&t.relatedPapers.length>0&&k.jsxs("section",{className:"px-4 sm:px-0",children:[k.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-4 text-gray-900 dark:text-white",children:" "}),k.jsx("ul",{className:"space-y-2",children:t.relatedPapers.map((r,i)=>k.jsx("li",{className:"text-gray-700 dark:text-gray-300 border-l-2 border-blue-600 dark:border-blue-400 pl-4 text-sm sm:text-base",children:r},i))})]})]})}const Gde=()=>{};var $6={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OK=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},jde=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],o=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},kK={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,o=a?n[i+1]:0,l=i+2<n.length,u=l?n[i+2]:0,c=s>>2,h=(s&3)<<4|o>>4;let d=(o&15)<<2|u>>6,f=u&63;l||(f=64,a||(d=64)),r.push(t[c],t[h],t[d],t[f])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(OK(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):jde(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],o=i<n.length?t[n.charAt(i)]:0;++i;const u=i<n.length?t[n.charAt(i)]:64;++i;const h=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||o==null||u==null||h==null)throw new qde;const d=s<<2|o>>4;if(r.push(d),u!==64){const f=o<<4&240|u>>2;if(r.push(f),h!==64){const p=u<<6&192|h;r.push(p)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class qde extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Wde=function(n){const e=OK(n);return kK.encodeByteArray(e,!0)},jC=function(n){return Wde(n).replace(/\./g,"")},BK=function(n){try{return kK.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xde(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kde=()=>Xde().__FIREBASE_DEFAULTS__,Yde=()=>{if(typeof process>"u"||typeof $6>"u")return;const n=$6.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Qde=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&BK(n[1]);return e&&JSON.parse(e)},j2=()=>{try{return Gde()||Kde()||Yde()||Qde()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},UK=n=>{var e,t;return(t=(e=j2())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},VK=n=>{const e=UK(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},zK=()=>{var n;return(n=j2())==null?void 0:n.config},$K=n=>{var e;return(e=j2())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zde{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pv(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function xB(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HK(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[jC(JSON.stringify(t)),jC(JSON.stringify(a)),""].join(".")}const N1={};function Jde(){const n={prod:[],emulator:[]};for(const e of Object.keys(N1))N1[e]?n.emulator.push(e):n.prod.push(e);return n}function efe(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let H6=!1;function bB(n,e){if(typeof window>"u"||typeof document>"u"||!Pv(window.location.host)||N1[n]===e||N1[n]||H6)return;N1[n]=e;function t(d){return`__firebase__banner__${d}`}const r="__firebase__banner",s=Jde().prod.length>0;function a(){const d=document.getElementById(r);d&&d.remove()}function o(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function l(d,f){d.setAttribute("width","24"),d.setAttribute("id",f),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function u(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{H6=!0,a()},d}function c(d,f){d.setAttribute("id",f),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function h(){const d=efe(r),f=t("text"),p=document.getElementById(f)||document.createElement("span"),m=t("learnmore"),y=document.getElementById(m)||document.createElement("a"),v=t("preprendIcon"),b=document.getElementById(v)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const x=d.element;o(x),c(y,m);const w=u();l(b,v),x.append(b,p,y,w),document.body.appendChild(x)}s?(p.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,p.innerText="Preview backend running in this workspace."),p.setAttribute("id",f)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function na(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tfe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(na())}function nfe(){var e;const n=(e=j2())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function rfe(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function ife(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function sfe(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function afe(){const n=na();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function ofe(){return!nfe()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function lfe(){try{return typeof indexedDB=="object"}catch{return!1}}function ufe(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cfe="FirebaseError";class Rc extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=cfe,Object.setPrototypeOf(this,Rc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,PS.prototype.create)}}class PS{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?hfe(s,r):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Rc(i,o,r)}}function hfe(n,e){return n.replace(dfe,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const dfe=/\{\$([^}]+)}/g;function ffe(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function xv(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if(G6(s)&&G6(a)){if(!xv(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function G6(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FS(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function U_(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function V_(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function pfe(n,e){const t=new mfe(n,e);return t.subscribe.bind(t)}class mfe{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");gfe(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=WR),i.error===void 0&&(i.error=WR),i.complete===void 0&&(i.complete=WR);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function gfe(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function WR(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oi(n){return n&&n._delegate?n._delegate:n}class wp{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Em="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vfe{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Zde;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(xfe(e))try{this.getOrInitializeService({instanceIdentifier:Em})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Em){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Em){return this.instances.has(e)}getOptions(e=Em){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);r===o&&a.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:yfe(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Em){return this.component?this.component.multipleInstances?e:Em:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function yfe(n){return n===Em?void 0:n}function xfe(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bfe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new vfe(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vn;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(vn||(vn={}));const _fe={debug:vn.DEBUG,verbose:vn.VERBOSE,info:vn.INFO,warn:vn.WARN,error:vn.ERROR,silent:vn.SILENT},wfe=vn.INFO,Efe={[vn.DEBUG]:"log",[vn.VERBOSE]:"log",[vn.INFO]:"info",[vn.WARN]:"warn",[vn.ERROR]:"error"},Sfe=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=Efe[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class _B{constructor(e){this.name=e,this._logLevel=wfe,this._logHandler=Sfe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in vn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?_fe[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,vn.DEBUG,...e),this._logHandler(this,vn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,vn.VERBOSE,...e),this._logHandler(this,vn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,vn.INFO,...e),this._logHandler(this,vn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,vn.WARN,...e),this._logHandler(this,vn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,vn.ERROR,...e),this._logHandler(this,vn.ERROR,...e)}}const Afe=(n,e)=>e.some(t=>n instanceof t);let j6,q6;function Tfe(){return j6||(j6=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Mfe(){return q6||(q6=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const GK=new WeakMap,E3=new WeakMap,jK=new WeakMap,XR=new WeakMap,wB=new WeakMap;function Cfe(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(dp(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&GK.set(t,n)}).catch(()=>{}),wB.set(e,n),e}function Dfe(n){if(E3.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});E3.set(n,e)}let S3={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return E3.get(n);if(e==="objectStoreNames")return n.objectStoreNames||jK.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return dp(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Nfe(n){S3=n(S3)}function Rfe(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(KR(this),e,...t);return jK.set(r,e.sort?e.sort():[e]),dp(r)}:Mfe().includes(n)?function(...e){return n.apply(KR(this),e),dp(GK.get(this))}:function(...e){return dp(n.apply(KR(this),e))}}function Ife(n){return typeof n=="function"?Rfe(n):(n instanceof IDBTransaction&&Dfe(n),Afe(n,Tfe())?new Proxy(n,S3):n)}function dp(n){if(n instanceof IDBRequest)return Cfe(n);if(XR.has(n))return XR.get(n);const e=Ife(n);return e!==n&&(XR.set(n,e),wB.set(e,n)),e}const KR=n=>wB.get(n);function Pfe(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),o=dp(a);return r&&a.addEventListener("upgradeneeded",l=>{r(dp(a.result),l.oldVersion,l.newVersion,dp(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const Ffe=["get","getKey","getAll","getAllKeys","count"],Lfe=["put","add","delete","clear"],YR=new Map;function W6(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(YR.get(e))return YR.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=Lfe.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Ffe.includes(t)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(o.shift())),(await Promise.all([u[t](...o),i&&l.done]))[0]};return YR.set(e,s),s}Nfe(n=>({...n,get:(e,t,r)=>W6(e,t)||n.get(e,t,r),has:(e,t)=>!!W6(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ofe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(kfe(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function kfe(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const A3="@firebase/app",X6="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ld=new _B("@firebase/app"),Bfe="@firebase/app-compat",Ufe="@firebase/analytics-compat",Vfe="@firebase/analytics",zfe="@firebase/app-check-compat",$fe="@firebase/app-check",Hfe="@firebase/auth",Gfe="@firebase/auth-compat",jfe="@firebase/database",qfe="@firebase/data-connect",Wfe="@firebase/database-compat",Xfe="@firebase/functions",Kfe="@firebase/functions-compat",Yfe="@firebase/installations",Qfe="@firebase/installations-compat",Zfe="@firebase/messaging",Jfe="@firebase/messaging-compat",epe="@firebase/performance",tpe="@firebase/performance-compat",npe="@firebase/remote-config",rpe="@firebase/remote-config-compat",ipe="@firebase/storage",spe="@firebase/storage-compat",ape="@firebase/firestore",ope="@firebase/ai",lpe="@firebase/firestore-compat",upe="firebase",cpe="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T3="[DEFAULT]",hpe={[A3]:"fire-core",[Bfe]:"fire-core-compat",[Vfe]:"fire-analytics",[Ufe]:"fire-analytics-compat",[$fe]:"fire-app-check",[zfe]:"fire-app-check-compat",[Hfe]:"fire-auth",[Gfe]:"fire-auth-compat",[jfe]:"fire-rtdb",[qfe]:"fire-data-connect",[Wfe]:"fire-rtdb-compat",[Xfe]:"fire-fn",[Kfe]:"fire-fn-compat",[Yfe]:"fire-iid",[Qfe]:"fire-iid-compat",[Zfe]:"fire-fcm",[Jfe]:"fire-fcm-compat",[epe]:"fire-perf",[tpe]:"fire-perf-compat",[npe]:"fire-rc",[rpe]:"fire-rc-compat",[ipe]:"fire-gcs",[spe]:"fire-gcs-compat",[ape]:"fire-fst",[lpe]:"fire-fst-compat",[ope]:"fire-vertex","fire-js":"fire-js",[upe]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qC=new Map,dpe=new Map,M3=new Map;function K6(n,e){try{n.container.addComponent(e)}catch(t){ld.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function bv(n){const e=n.name;if(M3.has(e))return ld.debug(`There were multiple attempts to register component ${e}.`),!1;M3.set(e,n);for(const t of qC.values())K6(t,n);for(const t of dpe.values())K6(t,n);return!0}function q2(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Po(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fpe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},fp=new PS("app","Firebase",fpe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ppe{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new wp("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw fp.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fv=cpe;function qK(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:T3,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw fp.create("bad-app-name",{appName:String(i)});if(t||(t=zK()),!t)throw fp.create("no-options");const s=qC.get(i);if(s){if(xv(t,s.options)&&xv(r,s.config))return s;throw fp.create("duplicate-app",{appName:i})}const a=new bfe(i);for(const l of M3.values())a.addComponent(l);const o=new ppe(t,r,a);return qC.set(i,o),o}function EB(n=T3){const e=qC.get(n);if(!e&&n===T3&&zK())return qK();if(!e)throw fp.create("no-app",{appName:n});return e}function fc(n,e,t){let r=hpe[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ld.warn(a.join(" "));return}bv(new wp(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mpe="firebase-heartbeat-database",gpe=1,uw="firebase-heartbeat-store";let QR=null;function WK(){return QR||(QR=Pfe(mpe,gpe,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(uw)}catch(t){console.warn(t)}}}}).catch(n=>{throw fp.create("idb-open",{originalErrorMessage:n.message})})),QR}async function vpe(n){try{const t=(await WK()).transaction(uw),r=await t.objectStore(uw).get(XK(n));return await t.done,r}catch(e){if(e instanceof Rc)ld.warn(e.message);else{const t=fp.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ld.warn(t.message)}}}async function Y6(n,e){try{const r=(await WK()).transaction(uw,"readwrite");await r.objectStore(uw).put(e,XK(n)),await r.done}catch(t){if(t instanceof Rc)ld.warn(t.message);else{const r=fp.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ld.warn(r.message)}}}function XK(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ype=1024,xpe=30;class bpe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new wpe(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Q6();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>xpe){const a=Epe(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ld.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Q6(),{heartbeatsToSend:r,unsentEntries:i}=_pe(this._heartbeatsCache.heartbeats),s=jC(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return ld.warn(t),""}}}function Q6(){return new Date().toISOString().substring(0,10)}function _pe(n,e=ype){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Z6(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Z6(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class wpe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return lfe()?ufe().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await vpe(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Y6(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Y6(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Z6(n){return jC(JSON.stringify({version:2,heartbeats:n})).length}function Epe(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Spe(n){bv(new wp("platform-logger",e=>new Ofe(e),"PRIVATE")),bv(new wp("heartbeat",e=>new bpe(e),"PRIVATE")),fc(A3,X6,n),fc(A3,X6,"esm2020"),fc("fire-js","")}Spe("");var J6=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var pp,KK;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,T){function S(){}S.prototype=T.prototype,A.F=T.prototype,A.prototype=new S,A.prototype.constructor=A,A.D=function(M,D,N){for(var R=Array(arguments.length-2),O=2;O<arguments.length;O++)R[O-2]=arguments[O];return T.prototype[D].apply(M,R)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,T,S){S||(S=0);const M=Array(16);if(typeof T=="string")for(var D=0;D<16;++D)M[D]=T.charCodeAt(S++)|T.charCodeAt(S++)<<8|T.charCodeAt(S++)<<16|T.charCodeAt(S++)<<24;else for(D=0;D<16;++D)M[D]=T[S++]|T[S++]<<8|T[S++]<<16|T[S++]<<24;T=A.g[0],S=A.g[1],D=A.g[2];let N=A.g[3],R;R=T+(N^S&(D^N))+M[0]+3614090360&4294967295,T=S+(R<<7&4294967295|R>>>25),R=N+(D^T&(S^D))+M[1]+3905402710&4294967295,N=T+(R<<12&4294967295|R>>>20),R=D+(S^N&(T^S))+M[2]+606105819&4294967295,D=N+(R<<17&4294967295|R>>>15),R=S+(T^D&(N^T))+M[3]+3250441966&4294967295,S=D+(R<<22&4294967295|R>>>10),R=T+(N^S&(D^N))+M[4]+4118548399&4294967295,T=S+(R<<7&4294967295|R>>>25),R=N+(D^T&(S^D))+M[5]+1200080426&4294967295,N=T+(R<<12&4294967295|R>>>20),R=D+(S^N&(T^S))+M[6]+2821735955&4294967295,D=N+(R<<17&4294967295|R>>>15),R=S+(T^D&(N^T))+M[7]+4249261313&4294967295,S=D+(R<<22&4294967295|R>>>10),R=T+(N^S&(D^N))+M[8]+1770035416&4294967295,T=S+(R<<7&4294967295|R>>>25),R=N+(D^T&(S^D))+M[9]+2336552879&4294967295,N=T+(R<<12&4294967295|R>>>20),R=D+(S^N&(T^S))+M[10]+4294925233&4294967295,D=N+(R<<17&4294967295|R>>>15),R=S+(T^D&(N^T))+M[11]+2304563134&4294967295,S=D+(R<<22&4294967295|R>>>10),R=T+(N^S&(D^N))+M[12]+1804603682&4294967295,T=S+(R<<7&4294967295|R>>>25),R=N+(D^T&(S^D))+M[13]+4254626195&4294967295,N=T+(R<<12&4294967295|R>>>20),R=D+(S^N&(T^S))+M[14]+2792965006&4294967295,D=N+(R<<17&4294967295|R>>>15),R=S+(T^D&(N^T))+M[15]+1236535329&4294967295,S=D+(R<<22&4294967295|R>>>10),R=T+(D^N&(S^D))+M[1]+4129170786&4294967295,T=S+(R<<5&4294967295|R>>>27),R=N+(S^D&(T^S))+M[6]+3225465664&4294967295,N=T+(R<<9&4294967295|R>>>23),R=D+(T^S&(N^T))+M[11]+643717713&4294967295,D=N+(R<<14&4294967295|R>>>18),R=S+(N^T&(D^N))+M[0]+3921069994&4294967295,S=D+(R<<20&4294967295|R>>>12),R=T+(D^N&(S^D))+M[5]+3593408605&4294967295,T=S+(R<<5&4294967295|R>>>27),R=N+(S^D&(T^S))+M[10]+38016083&4294967295,N=T+(R<<9&4294967295|R>>>23),R=D+(T^S&(N^T))+M[15]+3634488961&4294967295,D=N+(R<<14&4294967295|R>>>18),R=S+(N^T&(D^N))+M[4]+3889429448&4294967295,S=D+(R<<20&4294967295|R>>>12),R=T+(D^N&(S^D))+M[9]+568446438&4294967295,T=S+(R<<5&4294967295|R>>>27),R=N+(S^D&(T^S))+M[14]+3275163606&4294967295,N=T+(R<<9&4294967295|R>>>23),R=D+(T^S&(N^T))+M[3]+4107603335&4294967295,D=N+(R<<14&4294967295|R>>>18),R=S+(N^T&(D^N))+M[8]+1163531501&4294967295,S=D+(R<<20&4294967295|R>>>12),R=T+(D^N&(S^D))+M[13]+2850285829&4294967295,T=S+(R<<5&4294967295|R>>>27),R=N+(S^D&(T^S))+M[2]+4243563512&4294967295,N=T+(R<<9&4294967295|R>>>23),R=D+(T^S&(N^T))+M[7]+1735328473&4294967295,D=N+(R<<14&4294967295|R>>>18),R=S+(N^T&(D^N))+M[12]+2368359562&4294967295,S=D+(R<<20&4294967295|R>>>12),R=T+(S^D^N)+M[5]+4294588738&4294967295,T=S+(R<<4&4294967295|R>>>28),R=N+(T^S^D)+M[8]+2272392833&4294967295,N=T+(R<<11&4294967295|R>>>21),R=D+(N^T^S)+M[11]+1839030562&4294967295,D=N+(R<<16&4294967295|R>>>16),R=S+(D^N^T)+M[14]+4259657740&4294967295,S=D+(R<<23&4294967295|R>>>9),R=T+(S^D^N)+M[1]+2763975236&4294967295,T=S+(R<<4&4294967295|R>>>28),R=N+(T^S^D)+M[4]+1272893353&4294967295,N=T+(R<<11&4294967295|R>>>21),R=D+(N^T^S)+M[7]+4139469664&4294967295,D=N+(R<<16&4294967295|R>>>16),R=S+(D^N^T)+M[10]+3200236656&4294967295,S=D+(R<<23&4294967295|R>>>9),R=T+(S^D^N)+M[13]+681279174&4294967295,T=S+(R<<4&4294967295|R>>>28),R=N+(T^S^D)+M[0]+3936430074&4294967295,N=T+(R<<11&4294967295|R>>>21),R=D+(N^T^S)+M[3]+3572445317&4294967295,D=N+(R<<16&4294967295|R>>>16),R=S+(D^N^T)+M[6]+76029189&4294967295,S=D+(R<<23&4294967295|R>>>9),R=T+(S^D^N)+M[9]+3654602809&4294967295,T=S+(R<<4&4294967295|R>>>28),R=N+(T^S^D)+M[12]+3873151461&4294967295,N=T+(R<<11&4294967295|R>>>21),R=D+(N^T^S)+M[15]+530742520&4294967295,D=N+(R<<16&4294967295|R>>>16),R=S+(D^N^T)+M[2]+3299628645&4294967295,S=D+(R<<23&4294967295|R>>>9),R=T+(D^(S|~N))+M[0]+4096336452&4294967295,T=S+(R<<6&4294967295|R>>>26),R=N+(S^(T|~D))+M[7]+1126891415&4294967295,N=T+(R<<10&4294967295|R>>>22),R=D+(T^(N|~S))+M[14]+2878612391&4294967295,D=N+(R<<15&4294967295|R>>>17),R=S+(N^(D|~T))+M[5]+4237533241&4294967295,S=D+(R<<21&4294967295|R>>>11),R=T+(D^(S|~N))+M[12]+1700485571&4294967295,T=S+(R<<6&4294967295|R>>>26),R=N+(S^(T|~D))+M[3]+2399980690&4294967295,N=T+(R<<10&4294967295|R>>>22),R=D+(T^(N|~S))+M[10]+4293915773&4294967295,D=N+(R<<15&4294967295|R>>>17),R=S+(N^(D|~T))+M[1]+2240044497&4294967295,S=D+(R<<21&4294967295|R>>>11),R=T+(D^(S|~N))+M[8]+1873313359&4294967295,T=S+(R<<6&4294967295|R>>>26),R=N+(S^(T|~D))+M[15]+4264355552&4294967295,N=T+(R<<10&4294967295|R>>>22),R=D+(T^(N|~S))+M[6]+2734768916&4294967295,D=N+(R<<15&4294967295|R>>>17),R=S+(N^(D|~T))+M[13]+1309151649&4294967295,S=D+(R<<21&4294967295|R>>>11),R=T+(D^(S|~N))+M[4]+4149444226&4294967295,T=S+(R<<6&4294967295|R>>>26),R=N+(S^(T|~D))+M[11]+3174756917&4294967295,N=T+(R<<10&4294967295|R>>>22),R=D+(T^(N|~S))+M[2]+718787259&4294967295,D=N+(R<<15&4294967295|R>>>17),R=S+(N^(D|~T))+M[9]+3951481745&4294967295,A.g[0]=A.g[0]+T&4294967295,A.g[1]=A.g[1]+(D+(R<<21&4294967295|R>>>11))&4294967295,A.g[2]=A.g[2]+D&4294967295,A.g[3]=A.g[3]+N&4294967295}r.prototype.v=function(A,T){T===void 0&&(T=A.length);const S=T-this.blockSize,M=this.C;let D=this.h,N=0;for(;N<T;){if(D==0)for(;N<=S;)i(this,A,N),N+=this.blockSize;if(typeof A=="string"){for(;N<T;)if(M[D++]=A.charCodeAt(N++),D==this.blockSize){i(this,M),D=0;break}}else for(;N<T;)if(M[D++]=A[N++],D==this.blockSize){i(this,M),D=0;break}}this.h=D,this.o+=T},r.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var T=1;T<A.length-8;++T)A[T]=0;T=this.o*8;for(var S=A.length-8;S<A.length;++S)A[S]=T&255,T/=256;for(this.v(A),A=Array(16),T=0,S=0;S<4;++S)for(let M=0;M<32;M+=8)A[T++]=this.g[S]>>>M&255;return A};function s(A,T){var S=o;return Object.prototype.hasOwnProperty.call(S,A)?S[A]:S[A]=T(A)}function a(A,T){this.h=T;const S=[];let M=!0;for(let D=A.length-1;D>=0;D--){const N=A[D]|0;M&&N==T||(S[D]=N,M=!1)}this.g=S}var o={};function l(A){return-128<=A&&A<128?s(A,function(T){return new a([T|0],T<0?-1:0)}):new a([A|0],A<0?-1:0)}function u(A){if(isNaN(A)||!isFinite(A))return h;if(A<0)return y(u(-A));const T=[];let S=1;for(let M=0;A>=S;M++)T[M]=A/S|0,S*=4294967296;return new a(T,0)}function c(A,T){if(A.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(A.charAt(0)=="-")return y(c(A.substring(1),T));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const S=u(Math.pow(T,8));let M=h;for(let N=0;N<A.length;N+=8){var D=Math.min(8,A.length-N);const R=parseInt(A.substring(N,N+D),T);D<8?(D=u(Math.pow(T,D)),M=M.j(D).add(u(R))):(M=M.j(S),M=M.add(u(R)))}return M}var h=l(0),d=l(1),f=l(16777216);n=a.prototype,n.m=function(){if(m(this))return-y(this).m();let A=0,T=1;for(let S=0;S<this.g.length;S++){const M=this.i(S);A+=(M>=0?M:4294967296+M)*T,T*=4294967296}return A},n.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(p(this))return"0";if(m(this))return"-"+y(this).toString(A);const T=u(Math.pow(A,6));var S=this;let M="";for(;;){const D=w(S,T).g;S=v(S,D.j(T));let N=((S.g.length>0?S.g[0]:S.h)>>>0).toString(A);if(S=D,p(S))return N+M;for(;N.length<6;)N="0"+N;M=N+M}},n.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function p(A){if(A.h!=0)return!1;for(let T=0;T<A.g.length;T++)if(A.g[T]!=0)return!1;return!0}function m(A){return A.h==-1}n.l=function(A){return A=v(this,A),m(A)?-1:p(A)?0:1};function y(A){const T=A.g.length,S=[];for(let M=0;M<T;M++)S[M]=~A.g[M];return new a(S,~A.h).add(d)}n.abs=function(){return m(this)?y(this):this},n.add=function(A){const T=Math.max(this.g.length,A.g.length),S=[];let M=0;for(let D=0;D<=T;D++){let N=M+(this.i(D)&65535)+(A.i(D)&65535),R=(N>>>16)+(this.i(D)>>>16)+(A.i(D)>>>16);M=R>>>16,N&=65535,R&=65535,S[D]=R<<16|N}return new a(S,S[S.length-1]&-2147483648?-1:0)};function v(A,T){return A.add(y(T))}n.j=function(A){if(p(this)||p(A))return h;if(m(this))return m(A)?y(this).j(y(A)):y(y(this).j(A));if(m(A))return y(this.j(y(A)));if(this.l(f)<0&&A.l(f)<0)return u(this.m()*A.m());const T=this.g.length+A.g.length,S=[];for(var M=0;M<2*T;M++)S[M]=0;for(M=0;M<this.g.length;M++)for(let D=0;D<A.g.length;D++){const N=this.i(M)>>>16,R=this.i(M)&65535,O=A.i(D)>>>16,G=A.i(D)&65535;S[2*M+2*D]+=R*G,b(S,2*M+2*D),S[2*M+2*D+1]+=N*G,b(S,2*M+2*D+1),S[2*M+2*D+1]+=R*O,b(S,2*M+2*D+1),S[2*M+2*D+2]+=N*O,b(S,2*M+2*D+2)}for(A=0;A<T;A++)S[A]=S[2*A+1]<<16|S[2*A];for(A=T;A<2*T;A++)S[A]=0;return new a(S,0)};function b(A,T){for(;(A[T]&65535)!=A[T];)A[T+1]+=A[T]>>>16,A[T]&=65535,T++}function x(A,T){this.g=A,this.h=T}function w(A,T){if(p(T))throw Error("division by zero");if(p(A))return new x(h,h);if(m(A))return T=w(y(A),T),new x(y(T.g),y(T.h));if(m(T))return T=w(A,y(T)),new x(y(T.g),T.h);if(A.g.length>30){if(m(A)||m(T))throw Error("slowDivide_ only works with positive integers.");for(var S=d,M=T;M.l(A)<=0;)S=_(S),M=_(M);var D=E(S,1),N=E(M,1);for(M=E(M,2),S=E(S,2);!p(M);){var R=N.add(M);R.l(A)<=0&&(D=D.add(S),N=R),M=E(M,1),S=E(S,1)}return T=v(A,D.j(T)),new x(D,T)}for(D=h;A.l(T)>=0;){for(S=Math.max(1,Math.floor(A.m()/T.m())),M=Math.ceil(Math.log(S)/Math.LN2),M=M<=48?1:Math.pow(2,M-48),N=u(S),R=N.j(T);m(R)||R.l(A)>0;)S-=M,N=u(S),R=N.j(T);p(N)&&(N=d),D=D.add(N),A=v(A,R)}return new x(D,A)}n.B=function(A){return w(this,A).h},n.and=function(A){const T=Math.max(this.g.length,A.g.length),S=[];for(let M=0;M<T;M++)S[M]=this.i(M)&A.i(M);return new a(S,this.h&A.h)},n.or=function(A){const T=Math.max(this.g.length,A.g.length),S=[];for(let M=0;M<T;M++)S[M]=this.i(M)|A.i(M);return new a(S,this.h|A.h)},n.xor=function(A){const T=Math.max(this.g.length,A.g.length),S=[];for(let M=0;M<T;M++)S[M]=this.i(M)^A.i(M);return new a(S,this.h^A.h)};function _(A){const T=A.g.length+1,S=[];for(let M=0;M<T;M++)S[M]=A.i(M)<<1|A.i(M-1)>>>31;return new a(S,A.h)}function E(A,T){const S=T>>5;T%=32;const M=A.g.length-S,D=[];for(let N=0;N<M;N++)D[N]=T>0?A.i(N+S)>>>T|A.i(N+S+1)<<32-T:A.i(N+S);return new a(D,A.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,KK=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=c,pp=a}).apply(typeof J6<"u"?J6:typeof self<"u"?self:typeof window<"u"?window:{});var qA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var YK,z_,QK,vM,C3,ZK,JK,eY;(function(){var n,e=Object.defineProperty;function t(C){C=[typeof globalThis=="object"&&globalThis,C,typeof window=="object"&&window,typeof self=="object"&&self,typeof qA=="object"&&qA];for(var V=0;V<C.length;++V){var q=C[V];if(q&&q.Math==Math)return q}throw Error("Cannot find global object")}var r=t(this);function i(C,V){if(V)e:{var q=r;C=C.split(".");for(var he=0;he<C.length-1;he++){var De=C[he];if(!(De in q))break e;q=q[De]}C=C[C.length-1],he=q[C],V=V(he),V!=he&&V!=null&&e(q,C,{configurable:!0,writable:!0,value:V})}}i("Symbol.dispose",function(C){return C||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(C){return C||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(C){return C||function(V){var q=[],he;for(he in V)Object.prototype.hasOwnProperty.call(V,he)&&q.push([he,V[he]]);return q}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},a=this||self;function o(C){var V=typeof C;return V=="object"&&C!=null||V=="function"}function l(C,V,q){return C.call.apply(C.bind,arguments)}function u(C,V,q){return u=l,u.apply(null,arguments)}function c(C,V){var q=Array.prototype.slice.call(arguments,1);return function(){var he=q.slice();return he.push.apply(he,arguments),C.apply(this,he)}}function h(C,V){function q(){}q.prototype=V.prototype,C.Z=V.prototype,C.prototype=new q,C.prototype.constructor=C,C.Ob=function(he,De,ke){for(var rt=Array(arguments.length-2),ln=2;ln<arguments.length;ln++)rt[ln-2]=arguments[ln];return V.prototype[De].apply(he,rt)}}var d=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?C=>C&&AsyncContext.Snapshot.wrap(C):C=>C;function f(C){const V=C.length;if(V>0){const q=Array(V);for(let he=0;he<V;he++)q[he]=C[he];return q}return[]}function p(C,V){for(let he=1;he<arguments.length;he++){const De=arguments[he];var q=typeof De;if(q=q!="object"?q:De?Array.isArray(De)?"array":q:"null",q=="array"||q=="object"&&typeof De.length=="number"){q=C.length||0;const ke=De.length||0;C.length=q+ke;for(let rt=0;rt<ke;rt++)C[q+rt]=De[rt]}else C.push(De)}}class m{constructor(V,q){this.i=V,this.j=q,this.h=0,this.g=null}get(){let V;return this.h>0?(this.h--,V=this.g,this.g=V.next,V.next=null):V=this.i(),V}}function y(C){a.setTimeout(()=>{throw C},0)}function v(){var C=A;let V=null;return C.g&&(V=C.g,C.g=C.g.next,C.g||(C.h=null),V.next=null),V}class b{constructor(){this.h=this.g=null}add(V,q){const he=x.get();he.set(V,q),this.h?this.h.next=he:this.g=he,this.h=he}}var x=new m(()=>new w,C=>C.reset());class w{constructor(){this.next=this.g=this.h=null}set(V,q){this.h=V,this.g=q,this.next=null}reset(){this.next=this.g=this.h=null}}let _,E=!1,A=new b,T=()=>{const C=Promise.resolve(void 0);_=()=>{C.then(S)}};function S(){for(var C;C=v();){try{C.h.call(C.g)}catch(q){y(q)}var V=x;V.j(C),V.h<100&&(V.h++,C.next=V.g,V.g=C)}E=!1}function M(){this.u=this.u,this.C=this.C}M.prototype.u=!1,M.prototype.dispose=function(){this.u||(this.u=!0,this.N())},M.prototype[Symbol.dispose]=function(){this.dispose()},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(C,V){this.type=C,this.g=this.target=V,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var N=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var C=!1,V=Object.defineProperty({},"passive",{get:function(){C=!0}});try{const q=()=>{};a.addEventListener("test",q,V),a.removeEventListener("test",q,V)}catch{}return C}();function R(C){return/^[\s\xa0]*$/.test(C)}function O(C,V){D.call(this,C?C.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,C&&this.init(C,V)}h(O,D),O.prototype.init=function(C,V){const q=this.type=C.type,he=C.changedTouches&&C.changedTouches.length?C.changedTouches[0]:null;this.target=C.target||C.srcElement,this.g=V,V=C.relatedTarget,V||(q=="mouseover"?V=C.fromElement:q=="mouseout"&&(V=C.toElement)),this.relatedTarget=V,he?(this.clientX=he.clientX!==void 0?he.clientX:he.pageX,this.clientY=he.clientY!==void 0?he.clientY:he.pageY,this.screenX=he.screenX||0,this.screenY=he.screenY||0):(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0),this.button=C.button,this.key=C.key||"",this.ctrlKey=C.ctrlKey,this.altKey=C.altKey,this.shiftKey=C.shiftKey,this.metaKey=C.metaKey,this.pointerId=C.pointerId||0,this.pointerType=C.pointerType,this.state=C.state,this.i=C,C.defaultPrevented&&O.Z.h.call(this)},O.prototype.h=function(){O.Z.h.call(this);const C=this.i;C.preventDefault?C.preventDefault():C.returnValue=!1};var G="closure_listenable_"+(Math.random()*1e6|0),I=0;function B(C,V,q,he,De){this.listener=C,this.proxy=null,this.src=V,this.type=q,this.capture=!!he,this.ha=De,this.key=++I,this.da=this.fa=!1}function $(C){C.da=!0,C.listener=null,C.proxy=null,C.src=null,C.ha=null}function H(C,V,q){for(const he in C)V.call(q,C[he],he,C)}function Q(C,V){for(const q in C)V.call(void 0,C[q],q,C)}function ee(C){const V={};for(const q in C)V[q]=C[q];return V}const J="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function L(C,V){let q,he;for(let De=1;De<arguments.length;De++){he=arguments[De];for(q in he)C[q]=he[q];for(let ke=0;ke<J.length;ke++)q=J[ke],Object.prototype.hasOwnProperty.call(he,q)&&(C[q]=he[q])}}function se(C){this.src=C,this.g={},this.h=0}se.prototype.add=function(C,V,q,he,De){const ke=C.toString();C=this.g[ke],C||(C=this.g[ke]=[],this.h++);const rt=le(C,V,he,De);return rt>-1?(V=C[rt],q||(V.fa=!1)):(V=new B(V,this.src,ke,!!he,De),V.fa=q,C.push(V)),V};function Z(C,V){const q=V.type;if(q in C.g){var he=C.g[q],De=Array.prototype.indexOf.call(he,V,void 0),ke;(ke=De>=0)&&Array.prototype.splice.call(he,De,1),ke&&($(V),C.g[q].length==0&&(delete C.g[q],C.h--))}}function le(C,V,q,he){for(let De=0;De<C.length;++De){const ke=C[De];if(!ke.da&&ke.listener==V&&ke.capture==!!q&&ke.ha==he)return De}return-1}var ue="closure_lm_"+(Math.random()*1e6|0),te={};function Y(C,V,q,he,De){if(Array.isArray(V)){for(let ke=0;ke<V.length;ke++)Y(C,V[ke],q,he,De);return null}return q=de(q),C&&C[G]?C.J(V,q,o(he)?!!he.capture:!1,De):ie(C,V,q,!1,he,De)}function ie(C,V,q,he,De,ke){if(!V)throw Error("Invalid event type");const rt=o(De)?!!De.capture:!!De;let ln=$e(C);if(ln||(C[ue]=ln=new se(C)),q=ln.add(V,q,he,rt,ke),q.proxy)return q;if(he=ve(),q.proxy=he,he.src=C,he.listener=q,C.addEventListener)N||(De=rt),De===void 0&&(De=!1),C.addEventListener(V.toString(),he,De);else if(C.attachEvent)C.attachEvent(we(V.toString()),he);else if(C.addListener&&C.removeListener)C.addListener(he);else throw Error("addEventListener and attachEvent are unavailable.");return q}function ve(){function C(q){return V.call(C.src,C.listener,q)}const V=Be;return C}function ge(C,V,q,he,De){if(Array.isArray(V))for(var ke=0;ke<V.length;ke++)ge(C,V[ke],q,he,De);else he=o(he)?!!he.capture:!!he,q=de(q),C&&C[G]?(C=C.i,ke=String(V).toString(),ke in C.g&&(V=C.g[ke],q=le(V,q,he,De),q>-1&&($(V[q]),Array.prototype.splice.call(V,q,1),V.length==0&&(delete C.g[ke],C.h--)))):C&&(C=$e(C))&&(V=C.g[V.toString()],C=-1,V&&(C=le(V,q,he,De)),(q=C>-1?V[C]:null)&&_e(q))}function _e(C){if(typeof C!="number"&&C&&!C.da){var V=C.src;if(V&&V[G])Z(V.i,C);else{var q=C.type,he=C.proxy;V.removeEventListener?V.removeEventListener(q,he,C.capture):V.detachEvent?V.detachEvent(we(q),he):V.addListener&&V.removeListener&&V.removeListener(he),(q=$e(V))?(Z(q,C),q.h==0&&(q.src=null,V[ue]=null)):$(C)}}}function we(C){return C in te?te[C]:te[C]="on"+C}function Be(C,V){if(C.da)C=!0;else{V=new O(V,this);const q=C.listener,he=C.ha||C.src;C.fa&&_e(C),C=q.call(he,V)}return C}function $e(C){return C=C[ue],C instanceof se?C:null}var nt="__closure_events_fn_"+(Math.random()*1e9>>>0);function de(C){return typeof C=="function"?C:(C[nt]||(C[nt]=function(V){return C.handleEvent(V)}),C[nt])}function Ye(){M.call(this),this.i=new se(this),this.M=this,this.G=null}h(Ye,M),Ye.prototype[G]=!0,Ye.prototype.removeEventListener=function(C,V,q,he){ge(this,C,V,q,he)};function Xe(C,V){var q,he=C.G;if(he)for(q=[];he;he=he.G)q.push(he);if(C=C.M,he=V.type||V,typeof V=="string")V=new D(V,C);else if(V instanceof D)V.target=V.target||C;else{var De=V;V=new D(he,C),L(V,De)}De=!0;let ke,rt;if(q)for(rt=q.length-1;rt>=0;rt--)ke=V.g=q[rt],De=ae(ke,he,!0,V)&&De;if(ke=V.g=C,De=ae(ke,he,!0,V)&&De,De=ae(ke,he,!1,V)&&De,q)for(rt=0;rt<q.length;rt++)ke=V.g=q[rt],De=ae(ke,he,!1,V)&&De}Ye.prototype.N=function(){if(Ye.Z.N.call(this),this.i){var C=this.i;for(const V in C.g){const q=C.g[V];for(let he=0;he<q.length;he++)$(q[he]);delete C.g[V],C.h--}}this.G=null},Ye.prototype.J=function(C,V,q,he){return this.i.add(String(C),V,!1,q,he)},Ye.prototype.K=function(C,V,q,he){return this.i.add(String(C),V,!0,q,he)};function ae(C,V,q,he){if(V=C.i.g[String(V)],!V)return!0;V=V.concat();let De=!0;for(let ke=0;ke<V.length;++ke){const rt=V[ke];if(rt&&!rt.da&&rt.capture==q){const ln=rt.listener,Si=rt.ha||rt.src;rt.fa&&Z(C.i,rt),De=ln.call(Si,he)!==!1&&De}}return De&&!he.defaultPrevented}function fe(C,V){if(typeof C!="function")if(C&&typeof C.handleEvent=="function")C=u(C.handleEvent,C);else throw Error("Invalid listener argument");return Number(V)>2147483647?-1:a.setTimeout(C,V||0)}function F(C){C.g=fe(()=>{C.g=null,C.i&&(C.i=!1,F(C))},C.l);const V=C.h;C.h=null,C.m.apply(null,V)}class P extends M{constructor(V,q){super(),this.m=V,this.l=q,this.h=null,this.i=!1,this.g=null}j(V){this.h=arguments,this.g?this.i=!0:F(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function K(C){M.call(this),this.h=C,this.g={}}h(K,M);var oe=[];function pe(C){H(C.g,function(V,q){this.g.hasOwnProperty(q)&&_e(V)},C),C.g={}}K.prototype.N=function(){K.Z.N.call(this),pe(this)},K.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ce=a.JSON.stringify,Te=a.JSON.parse,be=class{stringify(C){return a.JSON.stringify(C,void 0)}parse(C){return a.JSON.parse(C,void 0)}};function Pe(){}function Me(){}var Ne={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ze(){D.call(this,"d")}h(ze,D);function Ke(){D.call(this,"c")}h(Ke,D);var Ge={},qe=null;function z(){return qe=qe||new Ye}Ge.Ia="serverreachability";function W(C){D.call(this,Ge.Ia,C)}h(W,D);function ye(C){const V=z();Xe(V,new W(V))}Ge.STAT_EVENT="statevent";function Ee(C,V){D.call(this,Ge.STAT_EVENT,C),this.stat=V}h(Ee,D);function Fe(C){const V=z();Xe(V,new Ee(V,C))}Ge.Ja="timingevent";function Le(C,V){D.call(this,Ge.Ja,C),this.size=V}h(Le,D);function Ue(C,V){if(typeof C!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){C()},V)}function tt(){this.g=!0}tt.prototype.ua=function(){this.g=!1};function Pt(C,V,q,he,De,ke){C.info(function(){if(C.g)if(ke){var rt="",ln=ke.split("&");for(let lr=0;lr<ln.length;lr++){var Si=ln[lr].split("=");if(Si.length>1){const ji=Si[0];Si=Si[1];const Tu=ji.split("_");rt=Tu.length>=2&&Tu[1]=="type"?rt+(ji+"="+Si+"&"):rt+(ji+"=redacted&")}}}else rt=null;else rt=ke;return"XMLHTTP REQ ("+he+") [attempt "+De+"]: "+V+`
`+q+`
`+rt})}function Vn(C,V,q,he,De,ke,rt){C.info(function(){return"XMLHTTP RESP ("+he+") [ attempt "+De+"]: "+V+`
`+q+`
`+ke+" "+rt})}function dn(C,V,q,he){C.info(function(){return"XMLHTTP TEXT ("+V+"): "+ro(C,q)+(he?" "+he:"")})}function Ia(C,V){C.info(function(){return"TIMEOUT: "+V})}tt.prototype.info=function(){};function ro(C,V){if(!C.g)return V;if(!V)return null;try{const ke=JSON.parse(V);if(ke){for(C=0;C<ke.length;C++)if(Array.isArray(ke[C])){var q=ke[C];if(!(q.length<2)){var he=q[1];if(Array.isArray(he)&&!(he.length<1)){var De=he[0];if(De!="noop"&&De!="stop"&&De!="close")for(let rt=1;rt<he.length;rt++)he[rt]=""}}}}return ce(ke)}catch{return V}}var Sd={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},im={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ad;function sm(){}h(sm,Pe),sm.prototype.g=function(){return new XMLHttpRequest},Ad=new sm;function Eu(C){return encodeURIComponent(String(C))}function Qv(C){var V=1;C=C.split(":");const q=[];for(;V>0&&C.length;)q.push(C.shift()),V--;return C.length&&q.push(C.join(":")),q}function Hi(C,V,q,he){this.j=C,this.i=V,this.l=q,this.S=he||1,this.V=new K(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Td}function Td(){this.i=null,this.g="",this.h=!1}var am={},Md={};function Su(C,V,q){C.M=1,C.A=kn(xt(V)),C.u=q,C.R=!0,om(C,null)}function om(C,V){C.F=Date.now(),Dd(C),C.B=xt(C.A);var q=C.B,he=C.S;Array.isArray(he)||(he=[String(he)]),Au(q.i,"t",he),C.C=0,q=C.j.L,C.h=new Td,C.g=o5(C.j,q?V:null,!C.u),C.P>0&&(C.O=new P(u(C.Y,C,C.g),C.P)),V=C.V,q=C.g,he=C.ba;var De="readystatechange";Array.isArray(De)||(De&&(oe[0]=De.toString()),De=oe);for(let ke=0;ke<De.length;ke++){const rt=Y(q,De[ke],he||V.handleEvent,!1,V.h||V);if(!rt)break;V.g[rt.key]=rt}V=C.J?ee(C.J):{},C.u?(C.v||(C.v="POST"),V["Content-Type"]="application/x-www-form-urlencoded",C.g.ea(C.B,C.v,C.u,V)):(C.v="GET",C.g.ea(C.B,C.v,null,V)),ye(),Pt(C.i,C.v,C.B,C.l,C.S,C.u)}Hi.prototype.ba=function(C){C=C.target;const V=this.O;V&&Id(C)==3?V.j():this.Y(C)},Hi.prototype.Y=function(C){try{if(C==this.g)e:{const ln=Id(this.g),Si=this.g.ya(),lr=this.g.ca();if(!(ln<3)&&(ln!=3||this.g&&(this.h.h||this.g.la()||YU(this.g)))){this.K||ln!=4||Si==7||(Si==8||lr<=0?ye(3):ye(2)),um(this);var V=this.g.ca();this.X=V;var q=Cd(this);if(this.o=V==200,Vn(this.i,this.v,this.B,this.l,this.S,ln,V),this.o){if(this.U&&!this.L){t:{if(this.g){var he,De=this.g;if((he=De.g?De.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(he)){var ke=he;break t}}ke=null}if(C=ke)dn(this.i,this.l,C,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,bn(this,C);else{this.o=!1,this.m=3,Fe(12),la(this),kc(this);break e}}if(this.R){C=!0;let ji;for(;!this.K&&this.C<q.length;)if(ji=Zv(this,q),ji==Md){ln==4&&(this.m=4,Fe(14),C=!1),dn(this.i,this.l,null,"[Incomplete Response]");break}else if(ji==am){this.m=4,Fe(15),dn(this.i,this.l,q,"[Invalid Chunk]"),C=!1;break}else dn(this.i,this.l,ji,null),bn(this,ji);if(lm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ln!=4||q.length!=0||this.h.h||(this.m=1,Fe(16),C=!1),this.o=this.o&&C,!C)dn(this.i,this.l,q,"[Invalid Chunked Response]"),la(this),kc(this);else if(q.length>0&&!this.W){this.W=!0;var rt=this.j;rt.g==this&&rt.aa&&!rt.P&&(rt.j.info("Great, no buffering proxy detected. Bytes received: "+q.length),tR(rt),rt.P=!0,Fe(11))}}else dn(this.i,this.l,q,null),bn(this,q);ln==4&&la(this),this.o&&!this.K&&(ln==4?r5(this.j,this):(this.o=!1,Dd(this)))}else pie(this.g),V==400&&q.indexOf("Unknown SID")>0?(this.m=3,Fe(12)):(this.m=0,Fe(13)),la(this),kc(this)}}}catch{}finally{}};function Cd(C){if(!lm(C))return C.g.la();const V=YU(C.g);if(V==="")return"";let q="";const he=V.length,De=Id(C.g)==4;if(!C.h.i){if(typeof TextDecoder>"u")return la(C),kc(C),"";C.h.i=new a.TextDecoder}for(let ke=0;ke<he;ke++)C.h.h=!0,q+=C.h.i.decode(V[ke],{stream:!(De&&ke==he-1)});return V.length=0,C.h.g+=q,C.C=0,C.h.g}function lm(C){return C.g?C.v=="GET"&&C.M!=2&&C.j.Aa:!1}function Zv(C,V){var q=C.C,he=V.indexOf(`
`,q);return he==-1?Md:(q=Number(V.substring(q,he)),isNaN(q)?am:(he+=1,he+q>V.length?Md:(V=V.slice(he,he+q),C.C=he+q,V)))}Hi.prototype.cancel=function(){this.K=!0,la(this)};function Dd(C){C.T=Date.now()+C.H,Jv(C,C.H)}function Jv(C,V){if(C.D!=null)throw Error("WatchDog timer not null");C.D=Ue(u(C.aa,C),V)}function um(C){C.D&&(a.clearTimeout(C.D),C.D=null)}Hi.prototype.aa=function(){this.D=null;const C=Date.now();C-this.T>=0?(Ia(this.i,this.B),this.M!=2&&(ye(),Fe(17)),la(this),this.m=2,kc(this)):Jv(this,this.T-C)};function kc(C){C.j.I==0||C.K||r5(C.j,C)}function la(C){um(C);var V=C.O;V&&typeof V.dispose=="function"&&V.dispose(),C.O=null,pe(C.V),C.g&&(V=C.g,C.g=null,V.abort(),V.dispose())}function bn(C,V){try{var q=C.j;if(q.I!=0&&(q.g==C||Ce(q.h,C))){if(!C.L&&Ce(q.h,C)&&q.I==3){try{var he=q.Ba.g.parse(V)}catch{he=null}if(Array.isArray(he)&&he.length==3){var De=he;if(De[0]==0){e:if(!q.v){if(q.g)if(q.g.F+3e3<C.F)EA(q),_A(q);else break e;eR(q),Fe(18)}}else q.xa=De[1],0<q.xa-q.K&&De[2]<37500&&q.F&&q.A==0&&!q.C&&(q.C=Ue(u(q.Va,q),6e3));Re(q.h)<=1&&q.ta&&(q.ta=void 0)}else hm(q,11)}else if((C.L||q.g==C)&&EA(q),!R(V))for(De=q.Ba.g.parse(V),V=0;V<De.length;V++){let lr=De[V];const ji=lr[0];if(!(ji<=q.K))if(q.K=ji,lr=lr[1],q.I==2)if(lr[0]=="c"){q.M=lr[1],q.ba=lr[2];const Tu=lr[3];Tu!=null&&(q.ka=Tu,q.j.info("VER="+q.ka));const dm=lr[4];dm!=null&&(q.za=dm,q.j.info("SVER="+q.za));const Pd=lr[5];Pd!=null&&typeof Pd=="number"&&Pd>0&&(he=1.5*Pd,q.O=he,q.j.info("backChannelRequestTimeoutMs_="+he)),he=q;const Fd=C.g;if(Fd){const AA=Fd.g?Fd.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(AA){var ke=he.h;ke.g||AA.indexOf("spdy")==-1&&AA.indexOf("quic")==-1&&AA.indexOf("h2")==-1||(ke.j=ke.l,ke.g=new Set,ke.h&&(it(ke,ke.h),ke.h=null))}if(he.G){const nR=Fd.g?Fd.g.getResponseHeader("X-HTTP-Session-Id"):null;nR&&(he.wa=nR,kt(he.J,he.G,nR))}}q.I=3,q.l&&q.l.ra(),q.aa&&(q.T=Date.now()-C.F,q.j.info("Handshake RTT: "+q.T+"ms")),he=q;var rt=C;if(he.na=a5(he,he.L?he.ba:null,he.W),rt.L){ht(he.h,rt);var ln=rt,Si=he.O;Si&&(ln.H=Si),ln.D&&(um(ln),Dd(ln)),he.g=rt}else t5(he);q.i.length>0&&wA(q)}else lr[0]!="stop"&&lr[0]!="close"||hm(q,7);else q.I==3&&(lr[0]=="stop"||lr[0]=="close"?lr[0]=="stop"?hm(q,7):JN(q):lr[0]!="noop"&&q.l&&q.l.qa(lr),q.A=0)}}ye(4)}catch{}}var ne=class{constructor(C,V){this.g=C,this.map=V}};function Se(C){this.l=C||10,a.PerformanceNavigationTiming?(C=a.performance.getEntriesByType("navigation"),C=C.length>0&&(C[0].nextHopProtocol=="hq"||C[0].nextHopProtocol=="h2")):C=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=C?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ie(C){return C.h?!0:C.g?C.g.size>=C.j:!1}function Re(C){return C.h?1:C.g?C.g.size:0}function Ce(C,V){return C.h?C.h==V:C.g?C.g.has(V):!1}function it(C,V){C.g?C.g.add(V):C.h=V}function ht(C,V){C.h&&C.h==V?C.h=null:C.g&&C.g.has(V)&&C.g.delete(V)}Se.prototype.cancel=function(){if(this.i=at(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const C of this.g.values())C.cancel();this.g.clear()}};function at(C){if(C.h!=null)return C.i.concat(C.h.G);if(C.g!=null&&C.g.size!==0){let V=C.i;for(const q of C.g.values())V=V.concat(q.G);return V}return f(C.i)}var mt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wt(C,V){if(C){C=C.split("&");for(let q=0;q<C.length;q++){const he=C[q].indexOf("=");let De,ke=null;he>=0?(De=C[q].substring(0,he),ke=C[q].substring(he+1)):De=C[q],V(De,ke?decodeURIComponent(ke.replace(/\+/g," ")):"")}}}function At(C){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let V;C instanceof At?(this.l=C.l,Wt(this,C.j),this.o=C.o,this.g=C.g,Dn(this,C.u),this.h=C.h,mr(this,GU(C.i)),this.m=C.m):C&&(V=String(C).match(mt))?(this.l=!1,Wt(this,V[1]||"",!0),this.o=St(V[2]||""),this.g=St(V[3]||"",!0),Dn(this,V[4]),this.h=St(V[5]||"",!0),mr(this,V[6]||"",!0),this.m=St(V[7]||"")):(this.l=!1,this.i=new hi(null,this.l))}At.prototype.toString=function(){const C=[];var V=this.j;V&&C.push(_n(V,Ps,!0),":");var q=this.g;return(q||V=="file")&&(C.push("//"),(V=this.o)&&C.push(_n(V,Ps,!0),"@"),C.push(Eu(q).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),q=this.u,q!=null&&C.push(":",String(q))),(q=this.h)&&(this.g&&q.charAt(0)!="/"&&C.push("/"),C.push(_n(q,q.charAt(0)=="/"?ua:Nd,!0))),(q=this.i.toString())&&C.push("?",q),(q=this.m)&&C.push("#",_n(q,Jn)),C.join("")},At.prototype.resolve=function(C){const V=xt(this);let q=!!C.j;q?Wt(V,C.j):q=!!C.o,q?V.o=C.o:q=!!C.g,q?V.g=C.g:q=C.u!=null;var he=C.h;if(q)Dn(V,C.u);else if(q=!!C.h){if(he.charAt(0)!="/")if(this.g&&!this.h)he="/"+he;else{var De=V.h.lastIndexOf("/");De!=-1&&(he=V.h.slice(0,De+1)+he)}if(De=he,De==".."||De==".")he="";else if(De.indexOf("./")!=-1||De.indexOf("/.")!=-1){he=De.lastIndexOf("/",0)==0,De=De.split("/");const ke=[];for(let rt=0;rt<De.length;){const ln=De[rt++];ln=="."?he&&rt==De.length&&ke.push(""):ln==".."?((ke.length>1||ke.length==1&&ke[0]!="")&&ke.pop(),he&&rt==De.length&&ke.push("")):(ke.push(ln),he=!0)}he=ke.join("/")}else he=De}return q?V.h=he:q=C.i.toString()!=="",q?mr(V,GU(C.i)):q=!!C.m,q&&(V.m=C.m),V};function xt(C){return new At(C)}function Wt(C,V,q){C.j=q?St(V,!0):V,C.j&&(C.j=C.j.replace(/:$/,""))}function Dn(C,V){if(V){if(V=Number(V),isNaN(V)||V<0)throw Error("Bad port number "+V);C.u=V}else C.u=null}function mr(C,V,q){V instanceof hi?(C.i=V,lie(C.i,C.l)):(q||(V=_n(V,cm)),C.i=new hi(V,C.l))}function kt(C,V,q){C.i.set(V,q)}function kn(C){return kt(C,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),C}function St(C,V){return C?V?decodeURI(C.replace(/%25/g,"%2525")):decodeURIComponent(C):""}function _n(C,V,q){return typeof C=="string"?(C=encodeURI(C).replace(V,Nn),q&&(C=C.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C):null}function Nn(C){return C=C.charCodeAt(0),"%"+(C>>4&15).toString(16)+(C&15).toString(16)}var Ps=/[#\/\?@]/g,Nd=/[#\?:]/g,ua=/[#\?]/g,cm=/[#\?@]/g,Jn=/#/g;function hi(C,V){this.h=this.g=null,this.i=C||null,this.j=!!V}function di(C){C.g||(C.g=new Map,C.h=0,C.i&&wt(C.i,function(V,q){C.add(decodeURIComponent(V.replace(/\+/g," ")),q)}))}n=hi.prototype,n.add=function(C,V){di(this),this.i=null,C=t0(this,C);let q=this.g.get(C);return q||this.g.set(C,q=[]),q.push(V),this.h+=1,this};function Gi(C,V){di(C),V=t0(C,V),C.g.has(V)&&(C.i=null,C.h-=C.g.get(V).length,C.g.delete(V))}function ls(C,V){return di(C),V=t0(C,V),C.g.has(V)}n.forEach=function(C,V){di(this),this.g.forEach(function(q,he){q.forEach(function(De){C.call(V,De,he,this)},this)},this)};function e0(C,V){di(C);let q=[];if(typeof V=="string")ls(C,V)&&(q=q.concat(C.g.get(t0(C,V))));else for(C=Array.from(C.g.values()),V=0;V<C.length;V++)q=q.concat(C[V]);return q}n.set=function(C,V){return di(this),this.i=null,C=t0(this,C),ls(this,C)&&(this.h-=this.g.get(C).length),this.g.set(C,[V]),this.h+=1,this},n.get=function(C,V){return C?(C=e0(this,C),C.length>0?String(C[0]):V):V};function Au(C,V,q){Gi(C,V),q.length>0&&(C.i=null,C.g.set(t0(C,V),f(q)),C.h+=q.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const C=[],V=Array.from(this.g.keys());for(let he=0;he<V.length;he++){var q=V[he];const De=Eu(q);q=e0(this,q);for(let ke=0;ke<q.length;ke++){let rt=De;q[ke]!==""&&(rt+="="+Eu(q[ke])),C.push(rt)}}return this.i=C.join("&")};function GU(C){const V=new hi;return V.i=C.i,C.g&&(V.g=new Map(C.g),V.h=C.h),V}function t0(C,V){return V=String(V),C.j&&(V=V.toLowerCase()),V}function lie(C,V){V&&!C.j&&(di(C),C.i=null,C.g.forEach(function(q,he){const De=he.toLowerCase();he!=De&&(Gi(this,he),Au(this,De,q))},C)),C.j=V}function uie(C,V){const q=new tt;if(a.Image){const he=new Image;he.onload=c(Rd,q,"TestLoadImage: loaded",!0,V,he),he.onerror=c(Rd,q,"TestLoadImage: error",!1,V,he),he.onabort=c(Rd,q,"TestLoadImage: abort",!1,V,he),he.ontimeout=c(Rd,q,"TestLoadImage: timeout",!1,V,he),a.setTimeout(function(){he.ontimeout&&he.ontimeout()},1e4),he.src=C}else V(!1)}function cie(C,V){const q=new tt,he=new AbortController,De=setTimeout(()=>{he.abort(),Rd(q,"TestPingServer: timeout",!1,V)},1e4);fetch(C,{signal:he.signal}).then(ke=>{clearTimeout(De),ke.ok?Rd(q,"TestPingServer: ok",!0,V):Rd(q,"TestPingServer: server error",!1,V)}).catch(()=>{clearTimeout(De),Rd(q,"TestPingServer: error",!1,V)})}function Rd(C,V,q,he,De){try{De&&(De.onload=null,De.onerror=null,De.onabort=null,De.ontimeout=null),he(q)}catch{}}function hie(){this.g=new be}function QN(C){this.i=C.Sb||null,this.h=C.ab||!1}h(QN,Pe),QN.prototype.g=function(){return new xA(this.i,this.h)};function xA(C,V){Ye.call(this),this.H=C,this.o=V,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(xA,Ye),n=xA.prototype,n.open=function(C,V){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=C,this.D=V,this.readyState=1,s_(this)},n.send=function(C){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const V={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};C&&(V.body=C),(this.H||a).fetch(new Request(this.D,V)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,i_(this)),this.readyState=0},n.Pa=function(C){if(this.g&&(this.l=C,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=C.headers,this.readyState=2,s_(this)),this.g&&(this.readyState=3,s_(this),this.g)))if(this.responseType==="arraybuffer")C.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in C){if(this.j=C.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;jU(this)}else C.text().then(this.Oa.bind(this),this.ga.bind(this))};function jU(C){C.j.read().then(C.Ma.bind(C)).catch(C.ga.bind(C))}n.Ma=function(C){if(this.g){if(this.o&&C.value)this.response.push(C.value);else if(!this.o){var V=C.value?C.value:new Uint8Array(0);(V=this.B.decode(V,{stream:!C.done}))&&(this.response=this.responseText+=V)}C.done?i_(this):s_(this),this.readyState==3&&jU(this)}},n.Oa=function(C){this.g&&(this.response=this.responseText=C,i_(this))},n.Na=function(C){this.g&&(this.response=C,i_(this))},n.ga=function(){this.g&&i_(this)};function i_(C){C.readyState=4,C.l=null,C.j=null,C.B=null,s_(C)}n.setRequestHeader=function(C,V){this.A.append(C,V)},n.getResponseHeader=function(C){return this.h&&this.h.get(C.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const C=[],V=this.h.entries();for(var q=V.next();!q.done;)q=q.value,C.push(q[0]+": "+q[1]),q=V.next();return C.join(`\r
`)};function s_(C){C.onreadystatechange&&C.onreadystatechange.call(C)}Object.defineProperty(xA.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(C){this.m=C?"include":"same-origin"}});function qU(C){let V="";return H(C,function(q,he){V+=he,V+=":",V+=q,V+=`\r
`}),V}function ZN(C,V,q){e:{for(he in q){var he=!1;break e}he=!0}he||(q=qU(q),typeof C=="string"?q!=null&&Eu(q):kt(C,V,q))}function Hr(C){Ye.call(this),this.headers=new Map,this.L=C||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(Hr,Ye);var die=/^https?$/i,fie=["POST","PUT"];n=Hr.prototype,n.Fa=function(C){this.H=C},n.ea=function(C,V,q,he){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+C);V=V?V.toUpperCase():"GET",this.D=C,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ad.g(),this.g.onreadystatechange=d(u(this.Ca,this));try{this.B=!0,this.g.open(V,String(C),!0),this.B=!1}catch(ke){WU(this,ke);return}if(C=q||"",q=new Map(this.headers),he)if(Object.getPrototypeOf(he)===Object.prototype)for(var De in he)q.set(De,he[De]);else if(typeof he.keys=="function"&&typeof he.get=="function")for(const ke of he.keys())q.set(ke,he.get(ke));else throw Error("Unknown input type for opt_headers: "+String(he));he=Array.from(q.keys()).find(ke=>ke.toLowerCase()=="content-type"),De=a.FormData&&C instanceof a.FormData,!(Array.prototype.indexOf.call(fie,V,void 0)>=0)||he||De||q.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ke,rt]of q)this.g.setRequestHeader(ke,rt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(C),this.v=!1}catch(ke){WU(this,ke)}};function WU(C,V){C.h=!1,C.g&&(C.j=!0,C.g.abort(),C.j=!1),C.l=V,C.o=5,XU(C),bA(C)}function XU(C){C.A||(C.A=!0,Xe(C,"complete"),Xe(C,"error"))}n.abort=function(C){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=C||7,Xe(this,"complete"),Xe(this,"abort"),bA(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),bA(this,!0)),Hr.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?KU(this):this.Xa())},n.Xa=function(){KU(this)};function KU(C){if(C.h&&typeof s<"u"){if(C.v&&Id(C)==4)setTimeout(C.Ca.bind(C),0);else if(Xe(C,"readystatechange"),Id(C)==4){C.h=!1;try{const ke=C.ca();e:switch(ke){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var V=!0;break e;default:V=!1}var q;if(!(q=V)){var he;if(he=ke===0){let rt=String(C.D).match(mt)[1]||null;!rt&&a.self&&a.self.location&&(rt=a.self.location.protocol.slice(0,-1)),he=!die.test(rt?rt.toLowerCase():"")}q=he}if(q)Xe(C,"complete"),Xe(C,"success");else{C.o=6;try{var De=Id(C)>2?C.g.statusText:""}catch{De=""}C.l=De+" ["+C.ca()+"]",XU(C)}}finally{bA(C)}}}}function bA(C,V){if(C.g){C.m&&(clearTimeout(C.m),C.m=null);const q=C.g;C.g=null,V||Xe(C,"ready");try{q.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Id(C){return C.g?C.g.readyState:0}n.ca=function(){try{return Id(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(C){if(this.g){var V=this.g.responseText;return C&&V.indexOf(C)==0&&(V=V.substring(C.length)),Te(V)}};function YU(C){try{if(!C.g)return null;if("response"in C.g)return C.g.response;switch(C.F){case"":case"text":return C.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in C.g)return C.g.mozResponseArrayBuffer}return null}catch{return null}}function pie(C){const V={};C=(C.g&&Id(C)>=2&&C.g.getAllResponseHeaders()||"").split(`\r
`);for(let he=0;he<C.length;he++){if(R(C[he]))continue;var q=Qv(C[he]);const De=q[0];if(q=q[1],typeof q!="string")continue;q=q.trim();const ke=V[De]||[];V[De]=ke,ke.push(q)}Q(V,function(he){return he.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function a_(C,V,q){return q&&q.internalChannelParams&&q.internalChannelParams[C]||V}function QU(C){this.za=0,this.i=[],this.j=new tt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=a_("failFast",!1,C),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=a_("baseRetryDelayMs",5e3,C),this.Za=a_("retryDelaySeedMs",1e4,C),this.Ta=a_("forwardChannelMaxRetries",2,C),this.va=a_("forwardChannelRequestTimeoutMs",2e4,C),this.ma=C&&C.xmlHttpFactory||void 0,this.Ua=C&&C.Rb||void 0,this.Aa=C&&C.useFetchStreams||!1,this.O=void 0,this.L=C&&C.supportsCrossDomainXhr||!1,this.M="",this.h=new Se(C&&C.concurrentRequestLimit),this.Ba=new hie,this.S=C&&C.fastHandshake||!1,this.R=C&&C.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=C&&C.Pb||!1,C&&C.ua&&this.j.ua(),C&&C.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&C&&C.detectBufferingProxy||!1,this.ia=void 0,C&&C.longPollingTimeout&&C.longPollingTimeout>0&&(this.ia=C.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=QU.prototype,n.ka=8,n.I=1,n.connect=function(C,V,q,he){Fe(0),this.W=C,this.H=V||{},q&&he!==void 0&&(this.H.OSID=q,this.H.OAID=he),this.F=this.X,this.J=a5(this,null,this.W),wA(this)};function JN(C){if(ZU(C),C.I==3){var V=C.V++,q=xt(C.J);if(kt(q,"SID",C.M),kt(q,"RID",V),kt(q,"TYPE","terminate"),o_(C,q),V=new Hi(C,C.j,V),V.M=2,V.A=kn(xt(q)),q=!1,a.navigator&&a.navigator.sendBeacon)try{q=a.navigator.sendBeacon(V.A.toString(),"")}catch{}!q&&a.Image&&(new Image().src=V.A,q=!0),q||(V.g=o5(V.j,null),V.g.ea(V.A)),V.F=Date.now(),Dd(V)}s5(C)}function _A(C){C.g&&(tR(C),C.g.cancel(),C.g=null)}function ZU(C){_A(C),C.v&&(a.clearTimeout(C.v),C.v=null),EA(C),C.h.cancel(),C.m&&(typeof C.m=="number"&&a.clearTimeout(C.m),C.m=null)}function wA(C){if(!Ie(C.h)&&!C.m){C.m=!0;var V=C.Ea;_||T(),E||(_(),E=!0),A.add(V,C),C.D=0}}function mie(C,V){return Re(C.h)>=C.h.j-(C.m?1:0)?!1:C.m?(C.i=V.G.concat(C.i),!0):C.I==1||C.I==2||C.D>=(C.Sa?0:C.Ta)?!1:(C.m=Ue(u(C.Ea,C,V),i5(C,C.D)),C.D++,!0)}n.Ea=function(C){if(this.m)if(this.m=null,this.I==1){if(!C){this.V=Math.floor(Math.random()*1e5),C=this.V++;const De=new Hi(this,this.j,C);let ke=this.o;if(this.U&&(ke?(ke=ee(ke),L(ke,this.U)):ke=this.U),this.u!==null||this.R||(De.J=ke,ke=null),this.S)e:{for(var V=0,q=0;q<this.i.length;q++){t:{var he=this.i[q];if("__data__"in he.map&&(he=he.map.__data__,typeof he=="string")){he=he.length;break t}he=void 0}if(he===void 0)break;if(V+=he,V>4096){V=q;break e}if(V===4096||q===this.i.length-1){V=q+1;break e}}V=1e3}else V=1e3;V=e5(this,De,V),q=xt(this.J),kt(q,"RID",C),kt(q,"CVER",22),this.G&&kt(q,"X-HTTP-Session-Id",this.G),o_(this,q),ke&&(this.R?V="headers="+Eu(qU(ke))+"&"+V:this.u&&ZN(q,this.u,ke)),it(this.h,De),this.Ra&&kt(q,"TYPE","init"),this.S?(kt(q,"$req",V),kt(q,"SID","null"),De.U=!0,Su(De,q,null)):Su(De,q,V),this.I=2}}else this.I==3&&(C?JU(this,C):this.i.length==0||Ie(this.h)||JU(this))};function JU(C,V){var q;V?q=V.l:q=C.V++;const he=xt(C.J);kt(he,"SID",C.M),kt(he,"RID",q),kt(he,"AID",C.K),o_(C,he),C.u&&C.o&&ZN(he,C.u,C.o),q=new Hi(C,C.j,q,C.D+1),C.u===null&&(q.J=C.o),V&&(C.i=V.G.concat(C.i)),V=e5(C,q,1e3),q.H=Math.round(C.va*.5)+Math.round(C.va*.5*Math.random()),it(C.h,q),Su(q,he,V)}function o_(C,V){C.H&&H(C.H,function(q,he){kt(V,he,q)}),C.l&&H({},function(q,he){kt(V,he,q)})}function e5(C,V,q){q=Math.min(C.i.length,q);const he=C.l?u(C.l.Ka,C.l,C):null;e:{var De=C.i;let ln=-1;for(;;){const Si=["count="+q];ln==-1?q>0?(ln=De[0].g,Si.push("ofs="+ln)):ln=0:Si.push("ofs="+ln);let lr=!0;for(let ji=0;ji<q;ji++){var ke=De[ji].g;const Tu=De[ji].map;if(ke-=ln,ke<0)ln=Math.max(0,De[ji].g-100),lr=!1;else try{ke="req"+ke+"_"||"";try{var rt=Tu instanceof Map?Tu:Object.entries(Tu);for(const[dm,Pd]of rt){let Fd=Pd;o(Pd)&&(Fd=ce(Pd)),Si.push(ke+dm+"="+encodeURIComponent(Fd))}}catch(dm){throw Si.push(ke+"type="+encodeURIComponent("_badmap")),dm}}catch{he&&he(Tu)}}if(lr){rt=Si.join("&");break e}}rt=void 0}return C=C.i.splice(0,q),V.G=C,rt}function t5(C){if(!C.g&&!C.v){C.Y=1;var V=C.Da;_||T(),E||(_(),E=!0),A.add(V,C),C.A=0}}function eR(C){return C.g||C.v||C.A>=3?!1:(C.Y++,C.v=Ue(u(C.Da,C),i5(C,C.A)),C.A++,!0)}n.Da=function(){if(this.v=null,n5(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var C=4*this.T;this.j.info("BP detection timer enabled: "+C),this.B=Ue(u(this.Wa,this),C)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Fe(10),_A(this),n5(this))};function tR(C){C.B!=null&&(a.clearTimeout(C.B),C.B=null)}function n5(C){C.g=new Hi(C,C.j,"rpc",C.Y),C.u===null&&(C.g.J=C.o),C.g.P=0;var V=xt(C.na);kt(V,"RID","rpc"),kt(V,"SID",C.M),kt(V,"AID",C.K),kt(V,"CI",C.F?"0":"1"),!C.F&&C.ia&&kt(V,"TO",C.ia),kt(V,"TYPE","xmlhttp"),o_(C,V),C.u&&C.o&&ZN(V,C.u,C.o),C.O&&(C.g.H=C.O);var q=C.g;C=C.ba,q.M=1,q.A=kn(xt(V)),q.u=null,q.R=!0,om(q,C)}n.Va=function(){this.C!=null&&(this.C=null,_A(this),eR(this),Fe(19))};function EA(C){C.C!=null&&(a.clearTimeout(C.C),C.C=null)}function r5(C,V){var q=null;if(C.g==V){EA(C),tR(C),C.g=null;var he=2}else if(Ce(C.h,V))q=V.G,ht(C.h,V),he=1;else return;if(C.I!=0){if(V.o)if(he==1){q=V.u?V.u.length:0,V=Date.now()-V.F;var De=C.D;he=z(),Xe(he,new Le(he,q)),wA(C)}else t5(C);else if(De=V.m,De==3||De==0&&V.X>0||!(he==1&&mie(C,V)||he==2&&eR(C)))switch(q&&q.length>0&&(V=C.h,V.i=V.i.concat(q)),De){case 1:hm(C,5);break;case 4:hm(C,10);break;case 3:hm(C,6);break;default:hm(C,2)}}}function i5(C,V){let q=C.Qa+Math.floor(Math.random()*C.Za);return C.isActive()||(q*=2),q*V}function hm(C,V){if(C.j.info("Error code "+V),V==2){var q=u(C.bb,C),he=C.Ua;const De=!he;he=new At(he||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Wt(he,"https"),kn(he),De?uie(he.toString(),q):cie(he.toString(),q)}else Fe(2);C.I=0,C.l&&C.l.pa(V),s5(C),ZU(C)}n.bb=function(C){C?(this.j.info("Successfully pinged google.com"),Fe(2)):(this.j.info("Failed to ping google.com"),Fe(1))};function s5(C){if(C.I=0,C.ja=[],C.l){const V=at(C.h);(V.length!=0||C.i.length!=0)&&(p(C.ja,V),p(C.ja,C.i),C.h.i.length=0,f(C.i),C.i.length=0),C.l.oa()}}function a5(C,V,q){var he=q instanceof At?xt(q):new At(q);if(he.g!="")V&&(he.g=V+"."+he.g),Dn(he,he.u);else{var De=a.location;he=De.protocol,V=V?V+"."+De.hostname:De.hostname,De=+De.port;const ke=new At(null);he&&Wt(ke,he),V&&(ke.g=V),De&&Dn(ke,De),q&&(ke.h=q),he=ke}return q=C.G,V=C.wa,q&&V&&kt(he,q,V),kt(he,"VER",C.ka),o_(C,he),he}function o5(C,V,q){if(V&&!C.L)throw Error("Can't create secondary domain capable XhrIo object.");return V=C.Aa&&!C.ma?new Hr(new QN({ab:q})):new Hr(C.ma),V.Fa(C.L),V}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function l5(){}n=l5.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function SA(){}SA.prototype.g=function(C,V){return new io(C,V)};function io(C,V){Ye.call(this),this.g=new QU(V),this.l=C,this.h=V&&V.messageUrlParams||null,C=V&&V.messageHeaders||null,V&&V.clientProtocolHeaderRequired&&(C?C["X-Client-Protocol"]="webchannel":C={"X-Client-Protocol":"webchannel"}),this.g.o=C,C=V&&V.initMessageHeaders||null,V&&V.messageContentType&&(C?C["X-WebChannel-Content-Type"]=V.messageContentType:C={"X-WebChannel-Content-Type":V.messageContentType}),V&&V.sa&&(C?C["X-WebChannel-Client-Profile"]=V.sa:C={"X-WebChannel-Client-Profile":V.sa}),this.g.U=C,(C=V&&V.Qb)&&!R(C)&&(this.g.u=C),this.A=V&&V.supportsCrossDomainXhr||!1,this.v=V&&V.sendRawJson||!1,(V=V&&V.httpSessionIdParam)&&!R(V)&&(this.g.G=V,C=this.h,C!==null&&V in C&&(C=this.h,V in C&&delete C[V])),this.j=new n0(this)}h(io,Ye),io.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},io.prototype.close=function(){JN(this.g)},io.prototype.o=function(C){var V=this.g;if(typeof C=="string"){var q={};q.__data__=C,C=q}else this.v&&(q={},q.__data__=ce(C),C=q);V.i.push(new ne(V.Ya++,C)),V.I==3&&wA(V)},io.prototype.N=function(){this.g.l=null,delete this.j,JN(this.g),delete this.g,io.Z.N.call(this)};function u5(C){ze.call(this),C.__headers__&&(this.headers=C.__headers__,this.statusCode=C.__status__,delete C.__headers__,delete C.__status__);var V=C.__sm__;if(V){e:{for(const q in V){C=q;break e}C=void 0}(this.i=C)&&(C=this.i,V=V!==null&&C in V?V[C]:void 0),this.data=V}else this.data=C}h(u5,ze);function c5(){Ke.call(this),this.status=1}h(c5,Ke);function n0(C){this.g=C}h(n0,l5),n0.prototype.ra=function(){Xe(this.g,"a")},n0.prototype.qa=function(C){Xe(this.g,new u5(C))},n0.prototype.pa=function(C){Xe(this.g,new c5)},n0.prototype.oa=function(){Xe(this.g,"b")},SA.prototype.createWebChannel=SA.prototype.g,io.prototype.send=io.prototype.o,io.prototype.open=io.prototype.m,io.prototype.close=io.prototype.close,eY=function(){return new SA},JK=function(){return z()},ZK=Ge,C3={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Sd.NO_ERROR=0,Sd.TIMEOUT=8,Sd.HTTP_ERROR=6,vM=Sd,im.COMPLETE="complete",QK=im,Me.EventType=Ne,Ne.OPEN="a",Ne.CLOSE="b",Ne.ERROR="c",Ne.MESSAGE="d",Ye.prototype.listen=Ye.prototype.J,z_=Me,Hr.prototype.listenOnce=Hr.prototype.K,Hr.prototype.getLastError=Hr.prototype.Ha,Hr.prototype.getLastErrorCode=Hr.prototype.ya,Hr.prototype.getStatus=Hr.prototype.ca,Hr.prototype.getResponseJson=Hr.prototype.La,Hr.prototype.getResponseText=Hr.prototype.la,Hr.prototype.send=Hr.prototype.ea,Hr.prototype.setWithCredentials=Hr.prototype.Fa,YK=Hr}).apply(typeof qA<"u"?qA:typeof self<"u"?self:typeof window<"u"?window:{});const ez="@firebase/firestore",tz="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ws.UNAUTHENTICATED=new Ws(null),Ws.GOOGLE_CREDENTIALS=new Ws("google-credentials-uid"),Ws.FIRST_PARTY=new Ws("first-party-uid"),Ws.MOCK_USER=new Ws("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bb="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _v=new _B("@firebase/firestore");function T0(){return _v.logLevel}function dt(n,...e){if(_v.logLevel<=vn.DEBUG){const t=e.map(SB);_v.debug(`Firestore (${Bb}): ${n}`,...t)}}function ud(n,...e){if(_v.logLevel<=vn.ERROR){const t=e.map(SB);_v.error(`Firestore (${Bb}): ${n}`,...t)}}function ub(n,...e){if(_v.logLevel<=vn.WARN){const t=e.map(SB);_v.warn(`Firestore (${Bb}): ${n}`,...t)}}function SB(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ot(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,tY(n,r,t)}function tY(n,e,t){let r=`FIRESTORE (${Bb}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw ud(r),new Error(r)}function $n(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||tY(e,i,r)}function Yt(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const He={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ut extends Rc{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nY{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Ape{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ws.UNAUTHENTICATED))}shutdown(){}}class Tpe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Mpe{constructor(e){this.t=e,this.currentUser=Ws.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){$n(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let s=new qh;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new qh,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{dt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(dt("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new qh)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(dt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?($n(typeof r.accessToken=="string",31837,{l:r}),new nY(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return $n(e===null||typeof e=="string",2055,{h:e}),new Ws(e)}}class Cpe{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ws.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Dpe{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Cpe(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ws.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class nz{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Npe{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Po(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){$n(this.o===void 0,3512);const r=s=>{s.error!=null&&dt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,dt("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{dt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):dt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new nz(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?($n(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new nz(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rpe(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AB{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=Rpe(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function yn(n,e){return n<e?-1:n>e?1:0}function D3(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),s=e.charAt(r);if(i!==s)return ZR(i)===ZR(s)?yn(i,s):ZR(i)?1:-1}return yn(n.length,e.length)}const Ipe=55296,Ppe=57343;function ZR(n){const e=n.charCodeAt(0);return e>=Ipe&&e<=Ppe}function cb(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rz="__name__";class Fu{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ot(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Ot(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Fu.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Fu?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=Fu.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return yn(e.length,t.length)}static compareSegments(e,t){const r=Fu.isNumericId(e),i=Fu.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Fu.extractNumericId(e).compare(Fu.extractNumericId(t)):D3(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return pp.fromString(e.substring(4,e.length-2))}}class yr extends Fu{construct(e,t,r){return new yr(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ut(He.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new yr(t)}static emptyPath(){return new yr([])}}const Fpe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ws extends Fu{construct(e,t,r){return new ws(e,t,r)}static isValidIdentifier(e){return Fpe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ws.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===rz}static keyField(){return new ws([rz])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ut(He.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new ut(He.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ut(He.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(r+=o,i++):(s(),i++)}if(s(),a)throw new ut(He.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ws(t)}static emptyPath(){return new ws([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e){this.path=e}static fromPath(e){return new Ct(yr.fromString(e))}static fromName(e){return new Ct(yr.fromString(e).popFirst(5))}static empty(){return new Ct(yr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&yr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return yr.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ct(new yr(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rY(n,e,t){if(!t)throw new ut(He.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Lpe(n,e,t,r){if(e===!0&&r===!0)throw new ut(He.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function iz(n){if(!Ct.isDocumentKey(n))throw new ut(He.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function sz(n){if(Ct.isDocumentKey(n))throw new ut(He.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function iY(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function W2(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ot(12329,{type:typeof n})}function Ja(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ut(He.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=W2(n);throw new ut(He.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _i(n,e){const t={typeString:n};return e&&(t.value=e),t}function LS(n,e){if(!iY(n))throw new ut(He.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new ut(He.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const az=-62135596800,oz=1e6;class Er{static now(){return Er.fromMillis(Date.now())}static fromDate(e){return Er.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*oz);return new Er(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ut(He.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ut(He.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<az)throw new ut(He.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ut(He.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/oz}_compareTo(e){return this.seconds===e.seconds?yn(this.nanoseconds,e.nanoseconds):yn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Er._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(LS(e,Er._jsonSchema))return new Er(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-az;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Er._jsonSchemaVersion="firestore/timestamp/1.0",Er._jsonSchema={type:_i("string",Er._jsonSchemaVersion),seconds:_i("number"),nanoseconds:_i("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{static fromTimestamp(e){return new Gt(e)}static min(){return new Gt(new Er(0,0))}static max(){return new Gt(new Er(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cw=-1;function Ope(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Gt.fromTimestamp(r===1e9?new Er(t+1,0):new Er(t,r));return new Ep(i,Ct.empty(),e)}function kpe(n){return new Ep(n.readTime,n.key,cw)}class Ep{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Ep(Gt.min(),Ct.empty(),cw)}static max(){return new Ep(Gt.max(),Ct.empty(),cw)}}function Bpe(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ct.comparator(n.documentKey,e.documentKey),t!==0?t:yn(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Upe="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Vpe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ub(n){if(n.code!==He.FAILED_PRECONDITION||n.message!==Upe)throw n;dt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ot(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new je((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof je?t:je.resolve(t)}catch(t){return je.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):je.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):je.reject(t)}static resolve(e){return new je((t,r)=>{t(e)})}static reject(e){return new je((t,r)=>{r(e)})}static waitFor(e){return new je((t,r)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&t()},l=>r(l))}),a=!0,s===i&&t()})}static or(e){let t=je.resolve(!1);for(const r of e)t=t.next(i=>i?je.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new je((r,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const u=l;t(e[u]).next(c=>{a[u]=c,++o,o===s&&r(a)},c=>i(c))}})}static doWhile(e,t){return new je((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}function zpe(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Vb(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}X2.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TB=-1;function K2(n){return n==null}function WC(n){return n===0&&1/n==-1/0}function $pe(n){return typeof n=="number"&&Number.isInteger(n)&&!WC(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sY="";function Hpe(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=lz(e)),e=Gpe(n.get(t),e);return lz(e)}function Gpe(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case sY:t+="";break;default:t+=s}}return t}function lz(n){return n+sY+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uz(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Hp(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function aY(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(e,t){this.comparator=e,this.root=t||ys.EMPTY}insert(e,t){return new $r(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ys.BLACK,null,null))}remove(e){return new $r(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ys.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new WA(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new WA(this.root,e,this.comparator,!1)}getReverseIterator(){return new WA(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new WA(this.root,e,this.comparator,!0)}}class WA{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ys{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??ys.RED,this.left=i??ys.EMPTY,this.right=s??ys.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new ys(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ys.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return ys.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ys.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ys.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ot(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ot(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ot(27949);return e+(this.isRed()?0:1)}}ys.EMPTY=null,ys.RED=!0,ys.BLACK=!1;ys.EMPTY=new class{constructor(){this.size=0}get key(){throw Ot(57766)}get value(){throw Ot(16141)}get color(){throw Ot(16727)}get left(){throw Ot(29726)}get right(){throw Ot(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new ys(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{constructor(e){this.comparator=e,this.data=new $r(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new cz(this.data.getIterator())}getIteratorFrom(e){return new cz(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Fi)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Fi(this.comparator);return t.data=e,t}}class cz{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e){this.fields=e,e.sort(ws.comparator)}static empty(){return new Oo([])}unionWith(e){let t=new Fi(ws.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Oo(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return cb(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oY extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new oY("Invalid base64 string: "+s):s}}(e);return new Ns(t)}static fromUint8Array(e){const t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Ns(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return yn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ns.EMPTY_BYTE_STRING=new Ns("");const jpe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Sp(n){if($n(!!n,39018),typeof n=="string"){let e=0;const t=jpe.exec(n);if($n(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:oi(n.seconds),nanos:oi(n.nanos)}}function oi(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ap(n){return typeof n=="string"?Ns.fromBase64String(n):Ns.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lY="server_timestamp",uY="__type__",cY="__previous_value__",hY="__local_write_time__";function MB(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[uY])==null?void 0:r.stringValue)===lY}function Y2(n){const e=n.mapValue.fields[cY];return MB(e)?Y2(e):e}function hw(n){const e=Sp(n.mapValue.fields[hY].timestampValue);return new Er(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qpe{constructor(e,t,r,i,s,a,o,l,u,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=c}}const XC="(default)";class dw{constructor(e,t){this.projectId=e,this.database=t||XC}static empty(){return new dw("","")}get isDefaultDatabase(){return this.database===XC}isEqual(e){return e instanceof dw&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dY="__type__",Wpe="__max__",XA={mapValue:{}},fY="__vector__",KC="value";function Tp(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?MB(n)?4:Kpe(n)?9007199254740991:Xpe(n)?10:11:Ot(28295,{value:n})}function wc(n,e){if(n===e)return!0;const t=Tp(n);if(t!==Tp(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return hw(n).isEqual(hw(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Sp(i.timestampValue),o=Sp(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Ap(i.bytesValue).isEqual(Ap(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return oi(i.geoPointValue.latitude)===oi(s.geoPointValue.latitude)&&oi(i.geoPointValue.longitude)===oi(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return oi(i.integerValue)===oi(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=oi(i.doubleValue),o=oi(s.doubleValue);return a===o?WC(a)===WC(o):isNaN(a)&&isNaN(o)}return!1}(n,e);case 9:return cb(n.arrayValue.values||[],e.arrayValue.values||[],wc);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(uz(a)!==uz(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!wc(a[l],o[l])))return!1;return!0}(n,e);default:return Ot(52216,{left:n})}}function fw(n,e){return(n.values||[]).find(t=>wc(t,e))!==void 0}function hb(n,e){if(n===e)return 0;const t=Tp(n),r=Tp(e);if(t!==r)return yn(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return yn(n.booleanValue,e.booleanValue);case 2:return function(s,a){const o=oi(s.integerValue||s.doubleValue),l=oi(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(n,e);case 3:return hz(n.timestampValue,e.timestampValue);case 4:return hz(hw(n),hw(e));case 5:return D3(n.stringValue,e.stringValue);case 6:return function(s,a){const o=Ap(s),l=Ap(a);return o.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const c=yn(o[u],l[u]);if(c!==0)return c}return yn(o.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){const o=yn(oi(s.latitude),oi(a.latitude));return o!==0?o:yn(oi(s.longitude),oi(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return dz(n.arrayValue,e.arrayValue);case 10:return function(s,a){var d,f,p,m;const o=s.fields||{},l=a.fields||{},u=(d=o[KC])==null?void 0:d.arrayValue,c=(f=l[KC])==null?void 0:f.arrayValue,h=yn(((p=u==null?void 0:u.values)==null?void 0:p.length)||0,((m=c==null?void 0:c.values)==null?void 0:m.length)||0);return h!==0?h:dz(u,c)}(n.mapValue,e.mapValue);case 11:return function(s,a){if(s===XA.mapValue&&a===XA.mapValue)return 0;if(s===XA.mapValue)return 1;if(a===XA.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),u=a.fields||{},c=Object.keys(u);l.sort(),c.sort();for(let h=0;h<l.length&&h<c.length;++h){const d=D3(l[h],c[h]);if(d!==0)return d;const f=hb(o[l[h]],u[c[h]]);if(f!==0)return f}return yn(l.length,c.length)}(n.mapValue,e.mapValue);default:throw Ot(23264,{he:t})}}function hz(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return yn(n,e);const t=Sp(n),r=Sp(e),i=yn(t.seconds,r.seconds);return i!==0?i:yn(t.nanos,r.nanos)}function dz(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=hb(t[i],r[i]);if(s)return s}return yn(t.length,r.length)}function db(n){return N3(n)}function N3(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Sp(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ap(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Ct.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=N3(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${N3(t.fields[a])}`;return i+"}"}(n.mapValue):Ot(61005,{value:n})}function yM(n){switch(Tp(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Y2(n);return e?16+yM(e):16;case 5:return 2*n.stringValue.length;case 6:return Ap(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+yM(s),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return Hp(r.fields,(s,a)=>{i+=s.length+yM(a)}),i}(n.mapValue);default:throw Ot(13486,{value:n})}}function fz(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function R3(n){return!!n&&"integerValue"in n}function CB(n){return!!n&&"arrayValue"in n}function pz(n){return!!n&&"nullValue"in n}function mz(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function xM(n){return!!n&&"mapValue"in n}function Xpe(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[dY])==null?void 0:r.stringValue)===fY}function R1(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Hp(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=R1(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=R1(n.arrayValue.values[t]);return e}return{...n}}function Kpe(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Wpe}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e){this.value=e}static empty(){return new Wa({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!xM(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=R1(t)}setAll(e){let t=ws.emptyPath(),r={},i=[];e.forEach((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=o.popLast()}a?r[o.lastSegment()]=R1(a):i.push(o.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());xM(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return wc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];xM(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Hp(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Wa(R1(this.value))}}function pY(n){const e=[];return Hp(n.fields,(t,r)=>{const i=new ws([t]);if(xM(r)){const s=pY(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Oo(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(e,t,r,i,s,a,o){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Ks(e,0,Gt.min(),Gt.min(),Gt.min(),Wa.empty(),0)}static newFoundDocument(e,t,r,i){return new Ks(e,1,t,Gt.min(),r,i,0)}static newNoDocument(e,t){return new Ks(e,2,t,Gt.min(),Gt.min(),Wa.empty(),0)}static newUnknownDocument(e,t){return new Ks(e,3,t,Gt.min(),Gt.min(),Wa.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Gt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Wa.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Wa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Gt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ks&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ks(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e,t){this.position=e,this.inclusive=t}}function gz(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=Ct.comparator(Ct.fromName(a.referenceValue),t.key):r=hb(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function vz(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!wc(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(e,t="asc"){this.field=e,this.dir=t}}function Ype(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mY{}class bi extends mY{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Zpe(e,t,r):t==="array-contains"?new tme(e,r):t==="in"?new nme(e,r):t==="not-in"?new rme(e,r):t==="array-contains-any"?new ime(e,r):new bi(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Jpe(e,r):new eme(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(hb(t,this.value)):t!==null&&Tp(this.value)===Tp(t)&&this.matchesComparison(hb(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ot(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class pu extends mY{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new pu(e,t)}matches(e){return gY(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function gY(n){return n.op==="and"}function vY(n){return Qpe(n)&&gY(n)}function Qpe(n){for(const e of n.filters)if(e instanceof pu)return!1;return!0}function I3(n){if(n instanceof bi)return n.field.canonicalString()+n.op.toString()+db(n.value);if(vY(n))return n.filters.map(e=>I3(e)).join(",");{const e=n.filters.map(t=>I3(t)).join(",");return`${n.op}(${e})`}}function yY(n,e){return n instanceof bi?function(r,i){return i instanceof bi&&r.op===i.op&&r.field.isEqual(i.field)&&wc(r.value,i.value)}(n,e):n instanceof pu?function(r,i){return i instanceof pu&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,o)=>s&&yY(a,i.filters[o]),!0):!1}(n,e):void Ot(19439)}function xY(n){return n instanceof bi?function(t){return`${t.field.canonicalString()} ${t.op} ${db(t.value)}`}(n):n instanceof pu?function(t){return t.op.toString()+" {"+t.getFilters().map(xY).join(" ,")+"}"}(n):"Filter"}class Zpe extends bi{constructor(e,t,r){super(e,t,r),this.key=Ct.fromName(r.referenceValue)}matches(e){const t=Ct.comparator(e.key,this.key);return this.matchesComparison(t)}}class Jpe extends bi{constructor(e,t){super(e,"in",t),this.keys=bY("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class eme extends bi{constructor(e,t){super(e,"not-in",t),this.keys=bY("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function bY(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map(r=>Ct.fromName(r.referenceValue))}class tme extends bi{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return CB(t)&&fw(t.arrayValue,this.value)}}class nme extends bi{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&fw(this.value.arrayValue,t)}}class rme extends bi{constructor(e,t){super(e,"not-in",t)}matches(e){if(fw(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!fw(this.value.arrayValue,t)}}class ime extends bi{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!CB(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>fw(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sme{constructor(e,t=null,r=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.Te=null}}function yz(n,e=null,t=[],r=[],i=null,s=null,a=null){return new sme(n,e,t,r,i,s,a)}function DB(n){const e=Yt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>I3(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),K2(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>db(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>db(r)).join(",")),e.Te=t}return e.Te}function NB(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Ype(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!yY(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!vz(n.startAt,e.startAt)&&vz(n.endAt,e.endAt)}function P3(n){return Ct.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zb{constructor(e,t=null,r=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function ame(n,e,t,r,i,s,a,o){return new zb(n,e,t,r,i,s,a,o)}function Q2(n){return new zb(n)}function xz(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function _Y(n){return n.collectionGroup!==null}function I1(n){const e=Yt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Fi(ws.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(o=o.add(u.field))})}),o})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new pw(s,r))}),t.has(ws.keyField().canonicalString())||e.Ie.push(new pw(ws.keyField(),r))}return e.Ie}function pc(n){const e=Yt(n);return e.Ee||(e.Ee=ome(e,I1(n))),e.Ee}function ome(n,e){if(n.limitType==="F")return yz(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new pw(i.field,s)});const t=n.endAt?new YC(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new YC(n.startAt.position,n.startAt.inclusive):null;return yz(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function F3(n,e){const t=n.filters.concat([e]);return new zb(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function QC(n,e,t){return new zb(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Z2(n,e){return NB(pc(n),pc(e))&&n.limitType===e.limitType}function wY(n){return`${DB(pc(n))}|lt:${n.limitType}`}function M0(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>xY(i)).join(", ")}]`),K2(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>db(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>db(i)).join(",")),`Target(${r})`}(pc(n))}; limitType=${n.limitType})`}function J2(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Ct.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of I1(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,o,l){const u=gz(a,o,l);return a.inclusive?u<=0:u<0}(r.startAt,I1(r),i)||r.endAt&&!function(a,o,l){const u=gz(a,o,l);return a.inclusive?u>=0:u>0}(r.endAt,I1(r),i))}(n,e)}function lme(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function EY(n){return(e,t)=>{let r=!1;for(const i of I1(n)){const s=ume(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function ume(n,e,t){const r=n.field.isKeyField()?Ct.comparator(e.key,t.key):function(s,a,o){const l=a.data.field(s),u=o.data.field(s);return l!==null&&u!==null?hb(l,u):Ot(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ot(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lv{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Hp(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return aY(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cme=new $r(Ct.comparator);function cd(){return cme}const SY=new $r(Ct.comparator);function $_(...n){let e=SY;for(const t of n)e=e.insert(t.key,t);return e}function AY(n){let e=SY;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Vm(){return P1()}function TY(){return P1()}function P1(){return new Lv(n=>n.toString(),(n,e)=>n.isEqual(e))}const hme=new $r(Ct.comparator),dme=new Fi(Ct.comparator);function xn(...n){let e=dme;for(const t of n)e=e.add(t);return e}const fme=new Fi(yn);function pme(){return fme}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RB(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:WC(e)?"-0":e}}function MY(n){return{integerValue:""+n}}function CY(n,e){return $pe(e)?MY(e):RB(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eN{constructor(){this._=void 0}}function mme(n,e,t){return n instanceof mw?function(i,s){const a={fields:{[uY]:{stringValue:lY},[hY]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&MB(s)&&(s=Y2(s)),s&&(a.fields[cY]=s),{mapValue:a}}(t,e):n instanceof gw?NY(n,e):n instanceof vw?RY(n,e):function(i,s){const a=DY(i,s),o=bz(a)+bz(i.Ae);return R3(a)&&R3(i.Ae)?MY(o):RB(i.serializer,o)}(n,e)}function gme(n,e,t){return n instanceof gw?NY(n,e):n instanceof vw?RY(n,e):t}function DY(n,e){return n instanceof yw?function(r){return R3(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class mw extends eN{}class gw extends eN{constructor(e){super(),this.elements=e}}function NY(n,e){const t=IY(e);for(const r of n.elements)t.some(i=>wc(i,r))||t.push(r);return{arrayValue:{values:t}}}class vw extends eN{constructor(e){super(),this.elements=e}}function RY(n,e){let t=IY(e);for(const r of n.elements)t=t.filter(i=>!wc(i,r));return{arrayValue:{values:t}}}class yw extends eN{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function bz(n){return oi(n.integerValue||n.doubleValue)}function IY(n){return CB(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PY{constructor(e,t){this.field=e,this.transform=t}}function vme(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof gw&&i instanceof gw||r instanceof vw&&i instanceof vw?cb(r.elements,i.elements,wc):r instanceof yw&&i instanceof yw?wc(r.Ae,i.Ae):r instanceof mw&&i instanceof mw}(n.transform,e.transform)}class yme{constructor(e,t){this.version=e,this.transformResults=t}}class El{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new El}static exists(e){return new El(void 0,e)}static updateTime(e){return new El(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function bM(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class tN{}function FY(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new IB(n.key,El.none()):new OS(n.key,n.data,El.none());{const t=n.data,r=Wa.empty();let i=new Fi(ws.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new Gp(n.key,r,new Oo(i.toArray()),El.none())}}function xme(n,e,t){n instanceof OS?function(i,s,a){const o=i.value.clone(),l=wz(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(n,e,t):n instanceof Gp?function(i,s,a){if(!bM(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=wz(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(LY(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function F1(n,e,t,r){return n instanceof OS?function(s,a,o,l){if(!bM(s.precondition,a))return o;const u=s.value.clone(),c=Ez(s.fieldTransforms,l,a);return u.setAll(c),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof Gp?function(s,a,o,l){if(!bM(s.precondition,a))return o;const u=Ez(s.fieldTransforms,l,a),c=a.data;return c.setAll(LY(s)),c.setAll(u),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(s,a,o){return bM(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(n,e,t)}function bme(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=DY(r.transform,i||null);s!=null&&(t===null&&(t=Wa.empty()),t.set(r.field,s))}return t||null}function _z(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&cb(r,i,(s,a)=>vme(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class OS extends tN{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Gp extends tN{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function LY(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function wz(n,e,t){const r=new Map;$n(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,o=e.data.field(s.field);r.set(s.field,gme(a,o,t[i]))}return r}function Ez(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,mme(s,a,e))}return r}class IB extends tN{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class _me extends tN{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wme{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&xme(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=F1(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=F1(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=TY();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=t.has(i.key)?null:o;const l=FY(a,o);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Gt.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),xn())}isEqual(e){return this.batchId===e.batchId&&cb(this.mutations,e.mutations,(t,r)=>_z(t,r))&&cb(this.baseMutations,e.baseMutations,(t,r)=>_z(t,r))}}class PB{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){$n(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return hme}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new PB(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eme{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sme{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gi,Rn;function Ame(n){switch(n){case He.OK:return Ot(64938);case He.CANCELLED:case He.UNKNOWN:case He.DEADLINE_EXCEEDED:case He.RESOURCE_EXHAUSTED:case He.INTERNAL:case He.UNAVAILABLE:case He.UNAUTHENTICATED:return!1;case He.INVALID_ARGUMENT:case He.NOT_FOUND:case He.ALREADY_EXISTS:case He.PERMISSION_DENIED:case He.FAILED_PRECONDITION:case He.ABORTED:case He.OUT_OF_RANGE:case He.UNIMPLEMENTED:case He.DATA_LOSS:return!0;default:return Ot(15467,{code:n})}}function OY(n){if(n===void 0)return ud("GRPC error has no .code"),He.UNKNOWN;switch(n){case gi.OK:return He.OK;case gi.CANCELLED:return He.CANCELLED;case gi.UNKNOWN:return He.UNKNOWN;case gi.DEADLINE_EXCEEDED:return He.DEADLINE_EXCEEDED;case gi.RESOURCE_EXHAUSTED:return He.RESOURCE_EXHAUSTED;case gi.INTERNAL:return He.INTERNAL;case gi.UNAVAILABLE:return He.UNAVAILABLE;case gi.UNAUTHENTICATED:return He.UNAUTHENTICATED;case gi.INVALID_ARGUMENT:return He.INVALID_ARGUMENT;case gi.NOT_FOUND:return He.NOT_FOUND;case gi.ALREADY_EXISTS:return He.ALREADY_EXISTS;case gi.PERMISSION_DENIED:return He.PERMISSION_DENIED;case gi.FAILED_PRECONDITION:return He.FAILED_PRECONDITION;case gi.ABORTED:return He.ABORTED;case gi.OUT_OF_RANGE:return He.OUT_OF_RANGE;case gi.UNIMPLEMENTED:return He.UNIMPLEMENTED;case gi.DATA_LOSS:return He.DATA_LOSS;default:return Ot(39323,{code:n})}}(Rn=gi||(gi={}))[Rn.OK=0]="OK",Rn[Rn.CANCELLED=1]="CANCELLED",Rn[Rn.UNKNOWN=2]="UNKNOWN",Rn[Rn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Rn[Rn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Rn[Rn.NOT_FOUND=5]="NOT_FOUND",Rn[Rn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Rn[Rn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Rn[Rn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Rn[Rn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Rn[Rn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Rn[Rn.ABORTED=10]="ABORTED",Rn[Rn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Rn[Rn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Rn[Rn.INTERNAL=13]="INTERNAL",Rn[Rn.UNAVAILABLE=14]="UNAVAILABLE",Rn[Rn.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tme(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mme=new pp([4294967295,4294967295],0);function Sz(n){const e=Tme().encode(n),t=new KK;return t.update(e),new Uint8Array(t.digest())}function Az(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new pp([t,r],0),new pp([i,s],0)]}class FB{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new H_(`Invalid padding: ${t}`);if(r<0)throw new H_(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new H_(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new H_(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=pp.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(pp.fromNumber(r)));return i.compare(Mme)===1&&(i=new pp([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Sz(e),[r,i]=Az(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);if(!this.we(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new FB(s,i,t);return r.forEach(o=>a.insert(o)),a}insert(e){if(this.ge===0)return;const t=Sz(e),[r,i]=Az(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class H_ extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nN{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,kS.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new nN(Gt.min(),i,new $r(yn),cd(),xn())}}class kS{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new kS(r,t,xn(),xn(),xn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _M{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class kY{constructor(e,t){this.targetId=e,this.Ce=t}}class BY{constructor(e,t,r=Ns.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Tz{constructor(){this.ve=0,this.Fe=Mz(),this.Me=Ns.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=xn(),t=xn(),r=xn();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Ot(38017,{changeType:s})}}),new kS(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=Mz()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,$n(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Cme{constructor(e){this.Ge=e,this.ze=new Map,this.je=cd(),this.Je=KA(),this.He=KA(),this.Ye=new $r(yn)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Ot(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((r,i)=>{this.rt(i)&&t(i)})}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(P3(s))if(r===0){const a=new Ct(s.path);this.et(t,a,Ks.newNoDocument(a,Gt.min()))}else $n(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(t);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,u)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,o;try{a=Ap(r).toUint8Array()}catch(l){if(l instanceof oY)return ub("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new FB(a,i,s)}catch(l){return ub(l instanceof H_?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.et(t,s,null),i++)}),i}Tt(e){const t=new Map;this.ze.forEach((s,a)=>{const o=this.ot(a);if(o){if(s.current&&P3(o.target)){const l=new Ct(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Ks.newNoDocument(l,e))}s.Be&&(t.set(a,s.ke()),s.qe())}});let r=xn();this.He.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(r=r.add(s))}),this.je.forEach((s,a)=>a.setReadTime(e));const i=new nN(e,t,this.Ye,this.je,r);return this.je=cd(),this.Je=KA(),this.He=KA(),this.Ye=new $r(yn),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Tz,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Fi(yn),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Fi(yn),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||dt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Tz),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function KA(){return new $r(Ct.comparator)}function Mz(){return new $r(Ct.comparator)}const Dme={asc:"ASCENDING",desc:"DESCENDING"},Nme={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Rme={and:"AND",or:"OR"};class Ime{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function L3(n,e){return n.useProto3Json||K2(e)?e:{value:e}}function ZC(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function UY(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Pme(n,e){return ZC(n,e.toTimestamp())}function mc(n){return $n(!!n,49232),Gt.fromTimestamp(function(t){const r=Sp(t);return new Er(r.seconds,r.nanos)}(n))}function LB(n,e){return O3(n,e).canonicalString()}function O3(n,e){const t=function(i){return new yr(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function VY(n){const e=yr.fromString(n);return $n(jY(e),10190,{key:e.toString()}),e}function k3(n,e){return LB(n.databaseId,e.path)}function JR(n,e){const t=VY(e);if(t.get(1)!==n.databaseId.projectId)throw new ut(He.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ut(He.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ct($Y(t))}function zY(n,e){return LB(n.databaseId,e)}function Fme(n){const e=VY(n);return e.length===4?yr.emptyPath():$Y(e)}function B3(n){return new yr(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function $Y(n){return $n(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Cz(n,e,t){return{name:k3(n,e),fields:t.value.mapValue.fields}}function Lme(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Ot(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,c){return u.useProto3Json?($n(c===void 0||typeof c=="string",58123),Ns.fromBase64String(c||"")):($n(c===void 0||c instanceof Buffer||c instanceof Uint8Array,16193),Ns.fromUint8Array(c||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(u){const c=u.code===void 0?He.UNKNOWN:OY(u.code);return new ut(c,u.message||"")}(a);t=new BY(r,i,s,o||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=JR(n,r.document.name),s=mc(r.document.updateTime),a=r.document.createTime?mc(r.document.createTime):Gt.min(),o=new Wa({mapValue:{fields:r.document.fields}}),l=Ks.newFoundDocument(i,s,a,o),u=r.targetIds||[],c=r.removedTargetIds||[];t=new _M(u,c,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=JR(n,r.document),s=r.readTime?mc(r.readTime):Gt.min(),a=Ks.newNoDocument(i,s),o=r.removedTargetIds||[];t=new _M([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=JR(n,r.document),s=r.removedTargetIds||[];t=new _M([],s,i,null)}else{if(!("filter"in e))return Ot(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new Sme(i,s),o=r.targetId;t=new kY(o,a)}}return t}function Ome(n,e){let t;if(e instanceof OS)t={update:Cz(n,e.key,e.value)};else if(e instanceof IB)t={delete:k3(n,e.key)};else if(e instanceof Gp)t={update:Cz(n,e.key,e.data),updateMask:jme(e.fieldMask)};else{if(!(e instanceof _me))return Ot(16599,{Vt:e.type});t={verify:k3(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){const o=a.transform;if(o instanceof mw)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof gw)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof vw)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof yw)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw Ot(20930,{transform:a.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:Pme(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ot(27497)}(n,e.precondition)),t}function kme(n,e){return n&&n.length>0?($n(e!==void 0,14353),n.map(t=>function(i,s){let a=i.updateTime?mc(i.updateTime):mc(s);return a.isEqual(Gt.min())&&(a=mc(s)),new yme(a,i.transformResults||[])}(t,e))):[]}function Bme(n,e){return{documents:[zY(n,e.path)]}}function Ume(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=zY(n,i);const s=function(u){if(u.length!==0)return GY(pu.create(u,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const a=function(u){if(u.length!==0)return u.map(c=>function(d){return{field:C0(d.field),direction:$me(d.dir)}}(c))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=L3(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:t,parent:i}}function Vme(n){let e=Fme(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){$n(r===1,65062);const c=t.from[0];c.allDescendants?i=c.collectionId:e=e.child(c.collectionId)}let s=[];t.where&&(s=function(h){const d=HY(h);return d instanceof pu&&vY(d)?d.getFilters():[d]}(t.where));let a=[];t.orderBy&&(a=function(h){return h.map(d=>function(p){return new pw(D0(p.field),function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(d))}(t.orderBy));let o=null;t.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,K2(d)?null:d}(t.limit));let l=null;t.startAt&&(l=function(h){const d=!!h.before,f=h.values||[];return new YC(f,d)}(t.startAt));let u=null;return t.endAt&&(u=function(h){const d=!h.before,f=h.values||[];return new YC(f,d)}(t.endAt)),ame(e,i,a,s,o,"F",l,u)}function zme(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ot(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function HY(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=D0(t.unaryFilter.field);return bi.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=D0(t.unaryFilter.field);return bi.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=D0(t.unaryFilter.field);return bi.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=D0(t.unaryFilter.field);return bi.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ot(61313);default:return Ot(60726)}}(n):n.fieldFilter!==void 0?function(t){return bi.create(D0(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ot(58110);default:return Ot(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return pu.create(t.compositeFilter.filters.map(r=>HY(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ot(1026)}}(t.compositeFilter.op))}(n):Ot(30097,{filter:n})}function $me(n){return Dme[n]}function Hme(n){return Nme[n]}function Gme(n){return Rme[n]}function C0(n){return{fieldPath:n.canonicalString()}}function D0(n){return ws.fromServerFormat(n.fieldPath)}function GY(n){return n instanceof bi?function(t){if(t.op==="=="){if(mz(t.value))return{unaryFilter:{field:C0(t.field),op:"IS_NAN"}};if(pz(t.value))return{unaryFilter:{field:C0(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(mz(t.value))return{unaryFilter:{field:C0(t.field),op:"IS_NOT_NAN"}};if(pz(t.value))return{unaryFilter:{field:C0(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:C0(t.field),op:Hme(t.op),value:t.value}}}(n):n instanceof pu?function(t){const r=t.getFilters().map(i=>GY(i));return r.length===1?r[0]:{compositeFilter:{op:Gme(t.op),filters:r}}}(n):Ot(54877,{filter:n})}function jme(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function jY(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf{constructor(e,t,r,i,s=Gt.min(),a=Gt.min(),o=Ns.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Jf(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Jf(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Jf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Jf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qme{constructor(e){this.yt=e}}function Wme(n){const e=Vme({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?QC(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xme{constructor(){this.Cn=new Kme}addToCollectionParentIndex(e,t){return this.Cn.add(t),je.resolve()}getCollectionParents(e,t){return je.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return je.resolve()}deleteFieldIndex(e,t){return je.resolve()}deleteAllFieldIndexes(e){return je.resolve()}createTargetIndexes(e,t){return je.resolve()}getDocumentsMatchingTarget(e,t){return je.resolve(null)}getIndexType(e,t){return je.resolve(0)}getFieldIndexes(e,t){return je.resolve([])}getNextCollectionGroupToUpdate(e){return je.resolve(null)}getMinOffset(e,t){return je.resolve(Ep.min())}getMinOffsetFromCollectionGroup(e,t){return je.resolve(Ep.min())}updateCollectionGroup(e,t,r){return je.resolve()}updateIndexEntries(e,t){return je.resolve()}}class Kme{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Fi(yr.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Fi(yr.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dz={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},qY=41943040;class Ga{static withCacheSize(e){return new Ga(e,Ga.DEFAULT_COLLECTION_PERCENTILE,Ga.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ga.DEFAULT_COLLECTION_PERCENTILE=10,Ga.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ga.DEFAULT=new Ga(qY,Ga.DEFAULT_COLLECTION_PERCENTILE,Ga.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ga.DISABLED=new Ga(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new fb(0)}static cr(){return new fb(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nz="LruGarbageCollector",Yme=1048576;function Rz([n,e],[t,r]){const i=yn(n,t);return i===0?yn(e,r):i}class Qme{constructor(e){this.Ir=e,this.buffer=new Fi(Rz),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Rz(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Zme{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){dt(Nz,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Vb(t)?dt(Nz,"Ignoring IndexedDB error during garbage collection: ",t):await Ub(t)}await this.Vr(3e5)})}}class Jme{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return je.resolve(X2.ce);const r=new Qme(t);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(dt("LruGarbageCollector","Garbage collection skipped; disabled"),je.resolve(Dz)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(dt("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Dz):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,a,o,l,u;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(dt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,a=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,o=Date.now(),this.removeTargets(e,r,t))).next(h=>(s=h,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(u=Date.now(),T0()<=vn.DEBUG&&dt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-c}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(l-o)+`ms
	Removed ${h} documents in `+(u-l)+`ms
Total Duration: ${u-c}ms`),je.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}}function ege(n,e){return new Jme(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tge{constructor(){this.changes=new Lv(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ks.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?je.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nge{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rge{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&F1(r.mutation,i,Oo.empty(),Er.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,xn()).next(()=>r))}getLocalViewOfDocuments(e,t,r=xn()){const i=Vm();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=$_();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const r=Vm();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,xn()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{t.set(a,o)})})}computeViews(e,t,r,i){let s=cd();const a=P1(),o=function(){return P1()}();return t.forEach((l,u)=>{const c=r.get(u.key);i.has(u.key)&&(c===void 0||c.mutation instanceof Gp)?s=s.insert(u.key,u):c!==void 0?(a.set(u.key,c.mutation.getFieldMask()),F1(c.mutation,u,c.mutation.getFieldMask(),Er.now())):a.set(u.key,Oo.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,c)=>a.set(u,c)),t.forEach((u,c)=>o.set(u,new nge(c,a.get(u)??null))),o))}recalculateAndSaveOverlays(e,t){const r=P1();let i=new $r((a,o)=>a-o),s=xn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const o of a)o.keys().forEach(l=>{const u=t.get(l);if(u===null)return;let c=r.get(l)||Oo.empty();c=o.applyToLocalView(u,c),r.set(l,c);const h=(i.get(o.batchId)||xn()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,c=l.value,h=TY();c.forEach(d=>{if(!s.has(d)){const f=FY(t.get(d),r.get(d));f!==null&&h.set(d,f),s=s.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,h))}return je.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return Ct.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):_Y(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):je.resolve(Vm());let o=cw,l=s;return a.next(u=>je.forEach(u,(c,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(c)?je.resolve():this.remoteDocumentCache.getEntry(e,c).next(d=>{l=l.insert(c,d)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,xn())).next(c=>({batchId:o,changes:AY(c)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ct(t)).next(r=>{let i=$_();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=$_();return this.indexManager.getCollectionParents(e,s).next(o=>je.forEach(o,l=>{const u=function(h,d){return new zb(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(c=>{c.forEach((h,d)=>{a=a.insert(h,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((l,u)=>{const c=u.getKey();a.get(c)===null&&(a=a.insert(c,Ks.newInvalidDocument(c)))});let o=$_();return a.forEach((l,u)=>{const c=s.get(l);c!==void 0&&F1(c.mutation,u,Oo.empty(),Er.now()),J2(t,u)&&(o=o.insert(l,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ige{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return je.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:mc(i.createTime)}}(t)),je.resolve()}getNamedQuery(e,t){return je.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(i){return{name:i.name,query:Wme(i.bundledQuery),readTime:mc(i.readTime)}}(t)),je.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sge{constructor(){this.overlays=new $r(Ct.comparator),this.qr=new Map}getOverlay(e,t){return je.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Vm();return je.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.St(e,t,s)}),je.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),je.resolve()}getOverlaysForCollection(e,t,r){const i=Vm(),s=t.length+1,a=new Ct(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return je.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new $r((u,c)=>u-c);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let c=s.get(u.largestBatchId);c===null&&(c=Vm(),s=s.insert(u.largestBatchId,c)),c.set(u.getKey(),u)}}const o=Vm(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,c)=>o.set(u,c)),!(o.size()>=i)););return je.resolve(o)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Eme(t,r));let s=this.qr.get(t);s===void 0&&(s=xn(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class age{constructor(){this.sessionToken=Ns.EMPTY_BYTE_STRING}getSessionToken(e){return je.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,je.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OB{constructor(){this.Qr=new Fi(rs.$r),this.Ur=new Fi(rs.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new rs(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Gr(new rs(e,t))}zr(e,t){e.forEach(r=>this.removeReference(r,t))}jr(e){const t=new Ct(new yr([])),r=new rs(t,e),i=new rs(t,e+1),s=[];return this.Ur.forEachInRange([r,i],a=>{this.Gr(a),s.push(a.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ct(new yr([])),r=new rs(t,e),i=new rs(t,e+1);let s=xn();return this.Ur.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const t=new rs(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class rs{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ct.comparator(e.key,t.key)||yn(e.Yr,t.Yr)}static Kr(e,t){return yn(e.Yr,t.Yr)||Ct.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oge{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Fi(rs.$r)}checkEmpty(e){return je.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new wme(s,t,r,i);this.mutationQueue.push(a);for(const o of i)this.Zr=this.Zr.add(new rs(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return je.resolve(a)}lookupMutationBatch(e,t){return je.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),s=i<0?0:i;return je.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return je.resolve(this.mutationQueue.length===0?TB:this.tr-1)}getAllMutationBatches(e){return je.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new rs(t,0),i=new rs(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],a=>{const o=this.Xr(a.Yr);s.push(o)}),je.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Fi(yn);return t.forEach(i=>{const s=new rs(i,0),a=new rs(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],o=>{r=r.add(o.Yr)})}),je.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;Ct.isDocumentKey(s)||(s=s.child(""));const a=new rs(new Ct(s),0);let o=new Fi(yn);return this.Zr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(o=o.add(l.Yr)),!0)},a),je.resolve(this.ti(o))}ti(e){const t=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){$n(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return je.forEach(t.mutations,i=>{const s=new rs(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,t){const r=new rs(t,0),i=this.Zr.firstAfterOrEqual(r);return je.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,je.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lge{constructor(e){this.ri=e,this.docs=function(){return new $r(Ct.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return je.resolve(r?r.document.mutableCopy():Ks.newInvalidDocument(t))}getEntries(e,t){let r=cd();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ks.newInvalidDocument(i))}),je.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=cd();const a=t.path,o=new Ct(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:c}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||Bpe(kpe(c),r)<=0||(i.has(c.key)||J2(t,c))&&(s=s.insert(c.key,c.mutableCopy()))}return je.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Ot(9500)}ii(e,t){return je.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new uge(this)}getSize(e){return je.resolve(this.size)}}class uge extends tge{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),je.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cge{constructor(e){this.persistence=e,this.si=new Lv(t=>DB(t),NB),this.lastRemoteSnapshotVersion=Gt.min(),this.highestTargetId=0,this.oi=0,this._i=new OB,this.targetCount=0,this.ai=fb.ur()}forEachTarget(e,t){return this.si.forEach((r,i)=>t(i)),je.resolve()}getLastRemoteSnapshotVersion(e){return je.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return je.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),je.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),je.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new fb(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,je.resolve()}updateTargetData(e,t){return this.Pr(t),je.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,je.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.si.forEach((a,o)=>{o.sequenceNumber<=t&&r.get(o.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),je.waitFor(s).next(()=>i)}getTargetCount(e){return je.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return je.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),je.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),je.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),je.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return je.resolve(r)}containsKey(e,t){return je.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WY{constructor(e,t){this.ui={},this.overlays={},this.ci=new X2(0),this.li=!1,this.li=!0,this.hi=new age,this.referenceDelegate=e(this),this.Pi=new cge(this),this.indexManager=new Xme,this.remoteDocumentCache=function(i){return new lge(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new qme(t),this.Ii=new ige(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new sge,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new oge(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){dt("MemoryPersistence","Starting transaction:",e);const i=new hge(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,t){return je.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,t)))}}class hge extends Vpe{constructor(e){super(),this.currentSequenceNumber=e}}class kB{constructor(e){this.persistence=e,this.Ri=new OB,this.Vi=null}static mi(e){return new kB(e)}get fi(){if(this.Vi)return this.Vi;throw Ot(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),je.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),je.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),je.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return je.forEach(this.fi,r=>{const i=Ct.fromPath(r);return this.gi(e,i).next(s=>{s||t.removeEntry(i,Gt.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return je.or([()=>je.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class JC{constructor(e,t){this.persistence=e,this.pi=new Lv(r=>Hpe(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=ege(this,t)}static mi(e,t){return new JC(e,t)}Ei(){}di(e){return je.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}wr(e){let t=0;return this.pr(e,r=>{t++}).next(()=>t)}pr(e,t){return je.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?je.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,a=>this.br(e,a,t).next(o=>{o||(r++,s.removeEntry(a,Gt.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),je.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),je.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),je.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),je.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=yM(e.data.value)),t}br(e,t,r){return je.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return je.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BB{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=xn(),i=xn();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new BB(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dge{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fge{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return ofe()?8:zpe(na())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ys(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ws(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new dge;return this.Ss(e,t,a).next(o=>{if(s.result=o,this.Vs)return this.bs(e,t,a,o.size)})}).next(()=>s.result)}bs(e,t,r,i){return r.documentReadCount<this.fs?(T0()<=vn.DEBUG&&dt("QueryEngine","SDK will not create cache indexes for query:",M0(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),je.resolve()):(T0()<=vn.DEBUG&&dt("QueryEngine","Query:",M0(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(T0()<=vn.DEBUG&&dt("QueryEngine","The SDK decides to create cache indexes for query:",M0(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,pc(t))):je.resolve())}ys(e,t){if(xz(t))return je.resolve(null);let r=pc(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=QC(t,null,"F"),r=pc(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=xn(...s);return this.ps.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.Ds(t,o);return this.Cs(t,u,a,l.readTime)?this.ys(e,QC(t,null,"F")):this.vs(e,u,t,l)}))})))}ws(e,t,r,i){return xz(t)||i.isEqual(Gt.min())?je.resolve(null):this.ps.getDocuments(e,r).next(s=>{const a=this.Ds(t,s);return this.Cs(t,a,r,i)?je.resolve(null):(T0()<=vn.DEBUG&&dt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),M0(t)),this.vs(e,a,t,Ope(i,cw)).next(o=>o))})}Ds(e,t){let r=new Fi(EY(e));return t.forEach((i,s)=>{J2(e,s)&&(r=r.add(s))}),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return T0()<=vn.DEBUG&&dt("QueryEngine","Using full collection scan to execute query:",M0(t)),this.ps.getDocumentsMatchingQuery(e,t,Ep.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UB="LocalStore",pge=3e8;class mge{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new $r(yn),this.xs=new Lv(s=>DB(s),NB),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new rge(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function gge(n,e,t,r){return new mge(n,e,t,r)}async function XY(n,e){const t=Yt(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],o=[];let l=xn();for(const u of i){a.push(u.batchId);for(const c of u.mutations)l=l.add(c.key)}for(const u of s){o.push(u.batchId);for(const c of u.mutations)l=l.add(c.key)}return t.localDocuments.getDocuments(r,l).next(u=>({Ls:u,removedBatchIds:a,addedBatchIds:o}))})})}function vge(n,e){const t=Yt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return function(o,l,u,c){const h=u.batch,d=h.keys();let f=je.resolve();return d.forEach(p=>{f=f.next(()=>c.getEntry(l,p)).next(m=>{const y=u.docVersions.get(p);$n(y!==null,48541),m.version.compareTo(y)<0&&(h.applyToRemoteDocument(m,u),m.isValidDocument()&&(m.setReadTime(u.commitVersion),c.addEntry(m)))})}),f.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let l=xn();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function KY(n){const e=Yt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function yge(n,e){const t=Yt(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const o=[];e.targetChanges.forEach((c,h)=>{const d=i.get(h);if(!d)return;o.push(t.Pi.removeMatchingKeys(s,c.removedDocuments,h).next(()=>t.Pi.addMatchingKeys(s,c.addedDocuments,h)));let f=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?f=f.withResumeToken(Ns.EMPTY_BYTE_STRING,Gt.min()).withLastLimboFreeSnapshotVersion(Gt.min()):c.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(c.resumeToken,r)),i=i.insert(h,f),function(m,y,v){return m.resumeToken.approximateByteSize()===0||y.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=pge?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(d,f,c)&&o.push(t.Pi.updateTargetData(s,f))});let l=cd(),u=xn();if(e.documentUpdates.forEach(c=>{e.resolvedLimboDocuments.has(c)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,c))}),o.push(xge(s,a,e.documentUpdates).next(c=>{l=c.ks,u=c.qs})),!r.isEqual(Gt.min())){const c=t.Pi.getLastRemoteSnapshotVersion(s).next(h=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));o.push(c)}return je.waitFor(o).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(t.Ms=i,s))}function xge(n,e,t){let r=xn(),i=xn();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=cd();return t.forEach((o,l)=>{const u=s.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Gt.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):dt(UB,"Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)}),{ks:a,qs:i}})}function bge(n,e){const t=Yt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=TB),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function _ge(n,e){const t=Yt(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Pi.getTargetData(r,e).next(s=>s?(i=s,je.resolve(i)):t.Pi.allocateTargetId(r).next(a=>(i=new Jf(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r})}async function U3(n,e,t){const r=Yt(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Vb(a))throw a;dt(UB,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function Iz(n,e,t){const r=Yt(n);let i=Gt.min(),s=xn();return r.persistence.runTransaction("Execute query","readwrite",a=>function(l,u,c){const h=Yt(l),d=h.xs.get(c);return d!==void 0?je.resolve(h.Ms.get(d)):h.Pi.getTargetData(u,c)}(r,a,pc(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(a,e,t?i:Gt.min(),t?s:xn())).next(o=>(wge(r,lme(e),o),{documents:o,Qs:s})))}function wge(n,e,t){let r=n.Os.get(e)||Gt.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.Os.set(e,r)}class Pz{constructor(){this.activeTargetIds=pme()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ege{constructor(){this.Mo=new Pz,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Pz,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sge{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fz="ConnectivityMonitor";class Lz{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){dt(Fz,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){dt(Fz,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let YA=null;function V3(){return YA===null?YA=function(){return 268435456+Math.round(2147483648*Math.random())}():YA++,"0x"+YA.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI="RestConnection",Age={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Tge{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===XC?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){const a=V3(),o=this.zo(e,t.toUriEncodedString());dt(eI,`Sending RPC '${e}' ${a}:`,o,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(o),c=Pv(u);return this.Jo(e,o,l,r,c).then(h=>(dt(eI,`Received RPC '${e}' ${a}: `,h),h),h=>{throw ub(eI,`RPC '${e}' ${a} failed with error: `,h,"url: ",o,"request:",r),h})}Ho(e,t,r,i,s,a){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Bb}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,t){const r=Age[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mge{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Os="WebChannelConnection";class Cge extends Tge{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){const a=V3();return new Promise((o,l)=>{const u=new YK;u.setWithCredentials(!0),u.listenOnce(QK.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case vM.NO_ERROR:const h=u.getResponseJson();dt(Os,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(h)),o(h);break;case vM.TIMEOUT:dt(Os,`RPC '${e}' ${a} timed out`),l(new ut(He.DEADLINE_EXCEEDED,"Request time out"));break;case vM.HTTP_ERROR:const d=u.getStatus();if(dt(Os,`RPC '${e}' ${a} failed with status:`,d,"response text:",u.getResponseText()),d>0){let f=u.getResponseJson();Array.isArray(f)&&(f=f[0]);const p=f==null?void 0:f.error;if(p&&p.status&&p.message){const m=function(v){const b=v.toLowerCase().replace(/_/g,"-");return Object.values(He).indexOf(b)>=0?b:He.UNKNOWN}(p.status);l(new ut(m,p.message))}else l(new ut(He.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new ut(He.UNAVAILABLE,"Connection failed."));break;default:Ot(9055,{l_:e,streamId:a,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{dt(Os,`RPC '${e}' ${a} completed.`)}});const c=JSON.stringify(i);dt(Os,`RPC '${e}' ${a} sending request:`,i),u.send(t,"POST",c,r,15)})}T_(e,t,r){const i=V3(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=eY(),o=JK(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const c=s.join("");dt(Os,`Creating RPC '${e}' stream ${i}: ${c}`,l);const h=a.createWebChannel(c,l);this.I_(h);let d=!1,f=!1;const p=new Mge({Yo:y=>{f?dt(Os,`Not sending because RPC '${e}' stream ${i} is closed:`,y):(d||(dt(Os,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),dt(Os,`RPC '${e}' stream ${i} sending:`,y),h.send(y))},Zo:()=>h.close()}),m=(y,v,b)=>{y.listen(v,x=>{try{b(x)}catch(w){setTimeout(()=>{throw w},0)}})};return m(h,z_.EventType.OPEN,()=>{f||(dt(Os,`RPC '${e}' stream ${i} transport opened.`),p.o_())}),m(h,z_.EventType.CLOSE,()=>{f||(f=!0,dt(Os,`RPC '${e}' stream ${i} transport closed`),p.a_(),this.E_(h))}),m(h,z_.EventType.ERROR,y=>{f||(f=!0,ub(Os,`RPC '${e}' stream ${i} transport errored. Name:`,y.name,"Message:",y.message),p.a_(new ut(He.UNAVAILABLE,"The operation could not be completed")))}),m(h,z_.EventType.MESSAGE,y=>{var v;if(!f){const b=y.data[0];$n(!!b,16349);const x=b,w=(x==null?void 0:x.error)||((v=x[0])==null?void 0:v.error);if(w){dt(Os,`RPC '${e}' stream ${i} received error:`,w);const _=w.status;let E=function(S){const M=gi[S];if(M!==void 0)return OY(M)}(_),A=w.message;E===void 0&&(E=He.INTERNAL,A="Unknown error status: "+_+" with message "+w.message),f=!0,p.a_(new ut(E,A)),h.close()}else dt(Os,`RPC '${e}' stream ${i} received:`,b),p.u_(b)}}),m(o,ZK.STAT_EVENT,y=>{y.stat===C3.PROXY?dt(Os,`RPC '${e}' stream ${i} detected buffering proxy`):y.stat===C3.NOPROXY&&dt(Os,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.__()},0),p}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function tI(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rN(n){return new Ime(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YY{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&dt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oz="PersistentStream";class QY{constructor(e,t,r,i,s,a,o,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new YY(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===He.RESOURCE_EXHAUSTED?(ud(t.toString()),ud("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===He.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===t&&this.G_(r,i)},r=>{e(()=>{const i=new ut(He.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return dt(Oz,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(dt(Oz,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Dge extends QY{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=Lme(this.serializer,e),r=function(s){if(!("targetChange"in s))return Gt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Gt.min():a.readTime?mc(a.readTime):Gt.min()}(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=B3(this.serializer),t.addTarget=function(s,a){let o;const l=a.target;if(o=P3(l)?{documents:Bme(s,l)}:{query:Ume(s,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=UY(s,a.resumeToken);const u=L3(s,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(Gt.min())>0){o.readTime=ZC(s,a.snapshotVersion.toTimestamp());const u=L3(s,a.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const r=zme(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=B3(this.serializer),t.removeTarget=e,this.q_(t)}}class Nge extends QY{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return $n(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,$n(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){$n(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=kme(e.writeResults,e.commitTime),r=mc(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=B3(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Ome(this.serializer,r))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rge{}class Ige extends Rge{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new ut(He.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Go(e,O3(t,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===He.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ut(He.UNKNOWN,s.toString())})}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Ho(e,O3(t,r),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===He.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ut(He.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Pge{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ud(t),this.aa=!1):dt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wv="RemoteStore";class Fge{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(a=>{r.enqueueAndForget(async()=>{Ov(this)&&(dt(wv,"Restarting streams for network reachability change."),await async function(l){const u=Yt(l);u.Ea.add(4),await BS(u),u.Ra.set("Unknown"),u.Ea.delete(4),await iN(u)}(this))})}),this.Ra=new Pge(r,i)}}async function iN(n){if(Ov(n))for(const e of n.da)await e(!0)}async function BS(n){for(const e of n.da)await e(!1)}function ZY(n,e){const t=Yt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),HB(t)?$B(t):$b(t).O_()&&zB(t,e))}function VB(n,e){const t=Yt(n),r=$b(t);t.Ia.delete(e),r.O_()&&JY(t,e),t.Ia.size===0&&(r.O_()?r.L_():Ov(t)&&t.Ra.set("Unknown"))}function zB(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Gt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}$b(n).Y_(e)}function JY(n,e){n.Va.Ue(e),$b(n).Z_(e)}function $B(n){n.Va=new Cme({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),$b(n).start(),n.Ra.ua()}function HB(n){return Ov(n)&&!$b(n).x_()&&n.Ia.size>0}function Ov(n){return Yt(n).Ea.size===0}function eQ(n){n.Va=void 0}async function Lge(n){n.Ra.set("Online")}async function Oge(n){n.Ia.forEach((e,t)=>{zB(n,e)})}async function kge(n,e){eQ(n),HB(n)?(n.Ra.ha(e),$B(n)):n.Ra.set("Unknown")}async function Bge(n,e,t){if(n.Ra.set("Online"),e instanceof BY&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.Ia.delete(o),i.Va.removeTarget(o))}(n,e)}catch(r){dt(wv,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await eD(n,r)}else if(e instanceof _M?n.Va.Ze(e):e instanceof kY?n.Va.st(e):n.Va.tt(e),!t.isEqual(Gt.min()))try{const r=await KY(n.localStore);t.compareTo(r)>=0&&await function(s,a){const o=s.Va.Tt(a);return o.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const c=s.Ia.get(u);c&&s.Ia.set(u,c.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,u)=>{const c=s.Ia.get(l);if(!c)return;s.Ia.set(l,c.withResumeToken(Ns.EMPTY_BYTE_STRING,c.snapshotVersion)),JY(s,l);const h=new Jf(c.target,l,u,c.sequenceNumber);zB(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(n,t)}catch(r){dt(wv,"Failed to raise snapshot:",r),await eD(n,r)}}async function eD(n,e,t){if(!Vb(e))throw e;n.Ea.add(1),await BS(n),n.Ra.set("Offline"),t||(t=()=>KY(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{dt(wv,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await iN(n)})}function tQ(n,e){return e().catch(t=>eD(n,t,e))}async function sN(n){const e=Yt(n),t=Mp(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:TB;for(;Uge(e);)try{const i=await bge(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,Vge(e,i)}catch(i){await eD(e,i)}nQ(e)&&rQ(e)}function Uge(n){return Ov(n)&&n.Ta.length<10}function Vge(n,e){n.Ta.push(e);const t=Mp(n);t.O_()&&t.X_&&t.ea(e.mutations)}function nQ(n){return Ov(n)&&!Mp(n).x_()&&n.Ta.length>0}function rQ(n){Mp(n).start()}async function zge(n){Mp(n).ra()}async function $ge(n){const e=Mp(n);for(const t of n.Ta)e.ea(t.mutations)}async function Hge(n,e,t){const r=n.Ta.shift(),i=PB.from(r,e,t);await tQ(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await sN(n)}async function Gge(n,e){e&&Mp(n).X_&&await async function(r,i){if(function(a){return Ame(a)&&a!==He.ABORTED}(i.code)){const s=r.Ta.shift();Mp(r).B_(),await tQ(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await sN(r)}}(n,e),nQ(n)&&rQ(n)}async function kz(n,e){const t=Yt(n);t.asyncQueue.verifyOperationInProgress(),dt(wv,"RemoteStore received new credentials");const r=Ov(t);t.Ea.add(3),await BS(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await iN(t)}async function jge(n,e){const t=Yt(n);e?(t.Ea.delete(2),await iN(t)):e||(t.Ea.add(2),await BS(t),t.Ra.set("Unknown"))}function $b(n){return n.ma||(n.ma=function(t,r,i){const s=Yt(t);return s.sa(),new Dge(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Xo:Lge.bind(null,n),t_:Oge.bind(null,n),r_:kge.bind(null,n),H_:Bge.bind(null,n)}),n.da.push(async e=>{e?(n.ma.B_(),HB(n)?$B(n):n.Ra.set("Unknown")):(await n.ma.stop(),eQ(n))})),n.ma}function Mp(n){return n.fa||(n.fa=function(t,r,i){const s=Yt(t);return s.sa(),new Nge(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:zge.bind(null,n),r_:Gge.bind(null,n),ta:$ge.bind(null,n),na:Hge.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await sN(n)):(await n.fa.stop(),n.Ta.length>0&&(dt(wv,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GB{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new qh,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,o=new GB(e,t,a,i,s);return o.start(r),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ut(He.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jB(n,e){if(ud("AsyncQueue",`${e}: ${n}`),Vb(n))return new ut(He.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{static emptySet(e){return new xy(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Ct.comparator(t.key,r.key):(t,r)=>Ct.comparator(t.key,r.key),this.keyedMap=$_(),this.sortedSet=new $r(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof xy)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new xy;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bz{constructor(){this.ga=new $r(Ct.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ot(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}}class pb{constructor(e,t,r,i,s,a,o,l,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach(o=>{a.push({type:0,doc:o})}),new pb(e,t,xy.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Z2(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qge{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Wge{constructor(){this.queries=Uz(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=Yt(t),s=i.queries;i.queries=Uz(),s.forEach((a,o)=>{for(const l of o.Sa)l.onError(r)})})(this,new ut(He.ABORTED,"Firestore shutting down"))}}function Uz(){return new Lv(n=>wY(n),Z2)}async function qB(n,e){const t=Yt(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new qge,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const o=jB(a,`Initialization of query '${M0(e.query)}' failed`);return void e.onError(o)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&XB(t)}async function WB(n,e){const t=Yt(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Xge(n,e){const t=Yt(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const o of a.Sa)o.Fa(i)&&(r=!0);a.wa=i}}r&&XB(t)}function Kge(n,e,t){const r=Yt(n),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);r.queries.delete(e)}function XB(n){n.Ca.forEach(e=>{e.next()})}var z3,Vz;(Vz=z3||(z3={})).Ma="default",Vz.Cache="cache";class KB{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new pb(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=pb.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==z3.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iQ{constructor(e){this.key=e}}class sQ{constructor(e){this.key=e}}class Yge{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=xn(),this.mutatedKeys=xn(),this.eu=EY(e),this.tu=new xy(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new Bz,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((c,h)=>{const d=i.get(c),f=J2(this.query,h)?h:null,p=!!d&&this.mutatedKeys.has(d.key),m=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let y=!1;d&&f?d.data.isEqual(f.data)?p!==m&&(r.track({type:3,doc:f}),y=!0):this.su(d,f)||(r.track({type:2,doc:f}),y=!0,(l&&this.eu(f,l)>0||u&&this.eu(f,u)<0)&&(o=!0)):!d&&f?(r.track({type:0,doc:f}),y=!0):d&&!f&&(r.track({type:1,doc:d}),y=!0,(l||u)&&(o=!0)),y&&(f?(a=a.add(f),s=m?s.add(c):s.delete(c)):(a=a.delete(c),s=s.delete(c)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const c=this.query.limitType==="F"?a.last():a.first();a=a.delete(c.key),s=s.delete(c.key),r.track({type:1,doc:c})}return{tu:a,iu:r,Cs:o,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((c,h)=>function(f,p){const m=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ot(20277,{Rt:y})}};return m(f)-m(p)}(c.type,h.type)||this.eu(c.doc,h.doc)),this.ou(r),i=i??!1;const o=t&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,a.length!==0||u?{snapshot:new pb(this.query,e.tu,s,a,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Bz,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=xn(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const t=[];return e.forEach(r=>{this.Xa.has(r)||t.push(new sQ(r))}),this.Xa.forEach(r=>{e.has(r)||t.push(new iQ(r))}),t}cu(e){this.Ya=e.Qs,this.Xa=xn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return pb.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const YB="SyncEngine";class Qge{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Zge{constructor(e){this.key=e,this.hu=!1}}class Jge{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Lv(o=>wY(o),Z2),this.Iu=new Map,this.Eu=new Set,this.du=new $r(Ct.comparator),this.Au=new Map,this.Ru=new OB,this.Vu={},this.mu=new Map,this.fu=fb.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function eve(n,e,t=!0){const r=hQ(n);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await aQ(r,e,t,!0),i}async function tve(n,e){const t=hQ(n);await aQ(t,e,!0,!1)}async function aQ(n,e,t,r){const i=await _ge(n.localStore,pc(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t);let o;return r&&(o=await nve(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&ZY(n.remoteStore,i),o}async function nve(n,e,t,r,i){n.pu=(h,d,f)=>async function(m,y,v,b){let x=y.view.ru(v);x.Cs&&(x=await Iz(m.localStore,y.query,!1).then(({documents:A})=>y.view.ru(A,x)));const w=b&&b.targetChanges.get(y.targetId),_=b&&b.targetMismatches.get(y.targetId)!=null,E=y.view.applyChanges(x,m.isPrimaryClient,w,_);return $z(m,y.targetId,E.au),E.snapshot}(n,h,d,f);const s=await Iz(n.localStore,e,!0),a=new Yge(e,s.Qs),o=a.ru(s.documents),l=kS.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=a.applyChanges(o,n.isPrimaryClient,l);$z(n,t,u.au);const c=new Qge(e,t,a);return n.Tu.set(e,c),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),u.snapshot}async function rve(n,e,t){const r=Yt(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(a=>!Z2(a,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await U3(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&VB(r.remoteStore,i.targetId),$3(r,i.targetId)}).catch(Ub)):($3(r,i.targetId),await U3(r.localStore,i.targetId,!0))}async function ive(n,e){const t=Yt(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),VB(t.remoteStore,r.targetId))}async function sve(n,e,t){const r=dve(n);try{const i=await function(a,o){const l=Yt(a),u=Er.now(),c=o.reduce((f,p)=>f.add(p.key),xn());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=cd(),m=xn();return l.Ns.getEntries(f,c).next(y=>{p=y,p.forEach((v,b)=>{b.isValidDocument()||(m=m.add(v))})}).next(()=>l.localDocuments.getOverlayedDocuments(f,p)).next(y=>{h=y;const v=[];for(const b of o){const x=bme(b,h.get(b.key).overlayedDocument);x!=null&&v.push(new Gp(b.key,x,pY(x.value.mapValue),El.exists(!0)))}return l.mutationQueue.addMutationBatch(f,u,v,o)}).next(y=>{d=y;const v=y.applyToLocalDocumentSet(h,m);return l.documentOverlayCache.saveOverlays(f,y.batchId,v)})}).then(()=>({batchId:d.batchId,changes:AY(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let u=a.Vu[a.currentUser.toKey()];u||(u=new $r(yn)),u=u.insert(o,l),a.Vu[a.currentUser.toKey()]=u}(r,i.batchId,t),await US(r,i.changes),await sN(r.remoteStore)}catch(i){const s=jB(i,"Failed to persist write");t.reject(s)}}async function oQ(n,e){const t=Yt(n);try{const r=await yge(t.localStore,e);e.targetChanges.forEach((i,s)=>{const a=t.Au.get(s);a&&($n(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?$n(a.hu,14607):i.removedDocuments.size>0&&($n(a.hu,42227),a.hu=!1))}),await US(t,r,e)}catch(r){await Ub(r)}}function zz(n,e,t){const r=Yt(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach((s,a)=>{const o=a.view.va(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=Yt(a);l.onlineState=o;let u=!1;l.queries.forEach((c,h)=>{for(const d of h.Sa)d.va(o)&&(u=!0)}),u&&XB(l)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function ave(n,e,t){const r=Yt(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),s=i&&i.key;if(s){let a=new $r(Ct.comparator);a=a.insert(s,Ks.newNoDocument(s,Gt.min()));const o=xn().add(s),l=new nN(Gt.min(),new Map,new $r(yn),a,o);await oQ(r,l),r.du=r.du.remove(s),r.Au.delete(e),QB(r)}else await U3(r.localStore,e,!1).then(()=>$3(r,e,t)).catch(Ub)}async function ove(n,e){const t=Yt(n),r=e.batch.batchId;try{const i=await vge(t.localStore,e);uQ(t,r,null),lQ(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await US(t,i)}catch(i){await Ub(i)}}async function lve(n,e,t){const r=Yt(n);try{const i=await function(a,o){const l=Yt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let c;return l.mutationQueue.lookupMutationBatch(u,o).next(h=>($n(h!==null,37113),c=h.keys(),l.mutationQueue.removeMutationBatch(u,h))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,c,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,c)).next(()=>l.localDocuments.getDocuments(u,c))})}(r.localStore,e);uQ(r,e,t),lQ(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await US(r,i)}catch(i){await Ub(i)}}function lQ(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function uQ(n,e,t){const r=Yt(n);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function $3(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach(r=>{n.Ru.containsKey(r)||cQ(n,r)})}function cQ(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(VB(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),QB(n))}function $z(n,e,t){for(const r of t)r instanceof iQ?(n.Ru.addReference(r.key,e),uve(n,r)):r instanceof sQ?(dt(YB,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||cQ(n,r.key)):Ot(19791,{wu:r})}function uve(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(dt(YB,"New document in limbo: "+t),n.Eu.add(r),QB(n))}function QB(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Ct(yr.fromString(e)),r=n.fu.next();n.Au.set(r,new Zge(t)),n.du=n.du.insert(t,r),ZY(n.remoteStore,new Jf(pc(Q2(t.path)),r,"TargetPurposeLimboResolution",X2.ce))}}async function US(n,e,t){const r=Yt(n),i=[],s=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach((o,l)=>{a.push(r.pu(l,e,t).then(u=>{var c;if((u||t)&&r.isPrimaryClient){const h=u?!u.fromCache:(c=t==null?void 0:t.targetChanges.get(l.targetId))==null?void 0:c.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(u){i.push(u);const h=BB.As(l.targetId,u);s.push(h)}}))}),await Promise.all(a),r.Pu.H_(i),await async function(l,u){const c=Yt(l);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>je.forEach(u,d=>je.forEach(d.Es,f=>c.persistence.referenceDelegate.addReference(h,d.targetId,f)).next(()=>je.forEach(d.ds,f=>c.persistence.referenceDelegate.removeReference(h,d.targetId,f)))))}catch(h){if(!Vb(h))throw h;dt(UB,"Failed to update sequence numbers: "+h)}for(const h of u){const d=h.targetId;if(!h.fromCache){const f=c.Ms.get(d),p=f.snapshotVersion,m=f.withLastLimboFreeSnapshotVersion(p);c.Ms=c.Ms.insert(d,m)}}}(r.localStore,s))}async function cve(n,e){const t=Yt(n);if(!t.currentUser.isEqual(e)){dt(YB,"User change. New user:",e.toKey());const r=await XY(t.localStore,e);t.currentUser=e,function(s,a){s.mu.forEach(o=>{o.forEach(l=>{l.reject(new ut(He.CANCELLED,a))})}),s.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await US(t,r.Ls)}}function hve(n,e){const t=Yt(n),r=t.Au.get(e);if(r&&r.hu)return xn().add(r.key);{let i=xn();const s=t.Iu.get(e);if(!s)return i;for(const a of s){const o=t.Tu.get(a);i=i.unionWith(o.view.nu)}return i}}function hQ(n){const e=Yt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=oQ.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=hve.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ave.bind(null,e),e.Pu.H_=Xge.bind(null,e.eventManager),e.Pu.yu=Kge.bind(null,e.eventManager),e}function dve(n){const e=Yt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ove.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lve.bind(null,e),e}class tD{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=rN(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return gge(this.persistence,new fge,e.initialUser,this.serializer)}Cu(e){return new WY(kB.mi,this.serializer)}Du(e){return new Ege}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}tD.provider={build:()=>new tD};class fve extends tD{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){$n(this.persistence.referenceDelegate instanceof JC,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new Zme(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Ga.withCacheSize(this.cacheSizeBytes):Ga.DEFAULT;return new WY(r=>JC.mi(r,t),this.serializer)}}class H3{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>zz(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=cve.bind(null,this.syncEngine),await jge(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Wge}()}createDatastore(e){const t=rN(e.databaseInfo.databaseId),r=function(s){return new Cge(s)}(e.databaseInfo);return function(s,a,o,l){return new Ige(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,a,o){return new Fge(r,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,t=>zz(this.syncEngine,t,0),function(){return Lz.v()?new Lz:new Sge}())}createSyncEngine(e,t){return function(i,s,a,o,l,u,c){const h=new Jge(i,s,a,o,l,u);return c&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=Yt(i);dt(wv,"RemoteStore shutting down."),s.Ea.add(5),await BS(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}H3.provider={build:()=>new H3};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZB{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ud("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cp="FirestoreClient";class pve{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ws.UNAUTHENTICATED,this.clientId=AB.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async a=>{dt(Cp,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(dt(Cp,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new qh;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=jB(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function nI(n,e){n.asyncQueue.verifyOperationInProgress(),dt(Cp,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await XY(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function Hz(n,e){n.asyncQueue.verifyOperationInProgress();const t=await mve(n);dt(Cp,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>kz(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>kz(e.remoteStore,i)),n._onlineComponents=e}async function mve(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){dt(Cp,"Using user provided OfflineComponentProvider");try{await nI(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===He.FAILED_PRECONDITION||i.code===He.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;ub("Error using user provided cache. Falling back to memory cache: "+t),await nI(n,new tD)}}else dt(Cp,"Using default OfflineComponentProvider"),await nI(n,new fve(void 0));return n._offlineComponents}async function dQ(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(dt(Cp,"Using user provided OnlineComponentProvider"),await Hz(n,n._uninitializedComponentsProvider._online)):(dt(Cp,"Using default OnlineComponentProvider"),await Hz(n,new H3))),n._onlineComponents}function gve(n){return dQ(n).then(e=>e.syncEngine)}async function nD(n){const e=await dQ(n),t=e.eventManager;return t.onListen=eve.bind(null,e.syncEngine),t.onUnlisten=rve.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=tve.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=ive.bind(null,e.syncEngine),t}function vve(n,e,t={}){const r=new qh;return n.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,u){const c=new ZB({next:d=>{c.Nu(),a.enqueueAndForget(()=>WB(s,h));const f=d.docs.has(o);!f&&d.fromCache?u.reject(new ut(He.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&d.fromCache&&l&&l.source==="server"?u.reject(new ut(He.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(d)},error:d=>u.reject(d)}),h=new KB(Q2(o.path),c,{includeMetadataChanges:!0,qa:!0});return qB(s,h)}(await nD(n),n.asyncQueue,e,t,r)),r.promise}function yve(n,e,t={}){const r=new qh;return n.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,u){const c=new ZB({next:d=>{c.Nu(),a.enqueueAndForget(()=>WB(s,h)),d.fromCache&&l.source==="server"?u.reject(new ut(He.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(d)},error:d=>u.reject(d)}),h=new KB(o,c,{includeMetadataChanges:!0,qa:!0});return qB(s,h)}(await nD(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fQ(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gz=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pQ="firestore.googleapis.com",jz=!0;class qz{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ut(He.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=pQ,this.ssl=jz}else this.host=e.host,this.ssl=e.ssl??jz;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=qY;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Yme)throw new ut(He.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Lpe("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fQ(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ut(He.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ut(He.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ut(He.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class aN{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qz({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ut(He.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ut(He.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qz(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Ape;switch(r.type){case"firstParty":return new Dpe(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ut(He.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=Gz.get(t);r&&(dt("ComponentProvider","Removing Datastore"),Gz.delete(t),r.terminate())}(this),Promise.resolve()}}function xve(n,e,t,r={}){var u;n=Ja(n,aN);const i=Pv(e),s=n._getSettings(),a={...s,emulatorOptions:n._getEmulatorOptions()},o=`${e}:${t}`;i&&(xB(`https://${o}`),bB("Firestore",!0)),s.host!==pQ&&s.host!==o&&ub("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:o,ssl:i,emulatorOptions:r};if(!xv(l,a)&&(n._setSettings(l),r.mockUserToken)){let c,h;if(typeof r.mockUserToken=="string")c=r.mockUserToken,h=Ws.MOCK_USER;else{c=HK(r.mockUserToken,(u=n._app)==null?void 0:u.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new ut(He.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Ws(d)}n._authCredentials=new Tpe(new nY(c,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new wd(this.firestore,e,this._query)}}class ti{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mp(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ti(this.firestore,e,this._key)}toJSON(){return{type:ti._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(LS(t,ti._jsonSchema))return new ti(e,r||null,new Ct(yr.fromString(t.referencePath)))}}ti._jsonSchemaVersion="firestore/documentReference/1.0",ti._jsonSchema={type:_i("string",ti._jsonSchemaVersion),referencePath:_i("string")};class mp extends wd{constructor(e,t,r){super(e,t,Q2(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ti(this.firestore,null,new Ct(e))}withConverter(e){return new mp(this.firestore,e,this._path)}}function hd(n,e,...t){if(n=Oi(n),rY("collection","path",e),n instanceof aN){const r=yr.fromString(e,...t);return sz(r),new mp(n,null,r)}{if(!(n instanceof ti||n instanceof mp))throw new ut(He.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(yr.fromString(e,...t));return sz(r),new mp(n.firestore,null,r)}}function Dp(n,e,...t){if(n=Oi(n),arguments.length===1&&(e=AB.newId()),rY("doc","path",e),n instanceof aN){const r=yr.fromString(e,...t);return iz(r),new ti(n,null,new Ct(r))}{if(!(n instanceof ti||n instanceof mp))throw new ut(He.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(yr.fromString(e,...t));return iz(r),new ti(n.firestore,n instanceof mp?n.converter:null,new Ct(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wz="AsyncQueue";class Xz{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new YY(this,"async_queue_retry"),this._c=()=>{const r=tI();r&&dt(Wz,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=tI();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=tI();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new qh;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Vb(e))throw e;dt(Wz,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,ud("INTERNAL UNHANDLED ERROR: ",Kz(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=GB.createAndSchedule(this,e,t,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&Ot(47125,{Pc:Kz(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Kz(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yz(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}class dd extends aN{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Xz,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Xz(e),this._firestoreClient=void 0,await e}}}function bve(n,e){const t=typeof n=="object"?n:EB(),r=typeof n=="string"?n:XC,i=q2(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=VK("firestore");s&&xve(i,...s)}return i}function oN(n){if(n._terminated)throw new ut(He.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||_ve(n),n._firestoreClient}function _ve(n){var r,i,s;const e=n._freezeSettings(),t=function(o,l,u,c){return new qpe(o,l,u,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,fQ(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(n._databaseId,((r=n._app)==null?void 0:r.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new pve(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new gl(Ns.fromBase64String(e))}catch(t){throw new ut(He.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new gl(Ns.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:gl._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(LS(e,gl._jsonSchema))return gl.fromBase64String(e.bytes)}}gl._jsonSchemaVersion="firestore/bytes/1.0",gl._jsonSchema={type:_i("string",gl._jsonSchemaVersion),bytes:_i("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ut(He.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ws(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ut(He.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ut(He.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return yn(this._lat,e._lat)||yn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:gc._jsonSchemaVersion}}static fromJSON(e){if(LS(e,gc._jsonSchema))return new gc(e.latitude,e.longitude)}}gc._jsonSchemaVersion="firestore/geoPoint/1.0",gc._jsonSchema={type:_i("string",gc._jsonSchemaVersion),latitude:_i("number"),longitude:_i("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:vc._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(LS(e,vc._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new vc(e.vectorValues);throw new ut(He.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}vc._jsonSchemaVersion="firestore/vectorValue/1.0",vc._jsonSchema={type:_i("string",vc._jsonSchemaVersion),vectorValues:_i("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wve=/^__.*__$/;class Eve{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Gp(e,this.data,this.fieldMask,t,this.fieldTransforms):new OS(e,this.data,t,this.fieldTransforms)}}class mQ{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Gp(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function gQ(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ot(40011,{Ac:n})}}class JB{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new JB({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const t=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){var i;const t=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return rD(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(gQ(this.Ac)&&wve.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Sve{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||rN(e)}Cc(e,t,r,i=!1){return new JB({Ac:e,methodName:t,Dc:r,path:ws.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function uN(n){const e=n._freezeSettings(),t=rN(n._databaseId);return new Sve(n._databaseId,!!e.ignoreUndefinedProperties,t)}function vQ(n,e,t,r,i,s={}){const a=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);n4("Data must be an object, but it was:",a,r);const o=yQ(r,a);let l,u;if(s.merge)l=new Oo(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const c=[];for(const h of s.mergeFields){const d=G3(e,h,t);if(!a.contains(d))throw new ut(He.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);bQ(c,d)||c.push(d)}l=new Oo(c),u=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,u=a.fieldTransforms;return new Eve(new Wa(o),l,u)}class cN extends VS{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof cN}}class e4 extends VS{_toFieldTransform(e){return new PY(e.path,new mw)}isEqual(e){return e instanceof e4}}class t4 extends VS{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new yw(e.serializer,CY(e.serializer,this.Fc));return new PY(e.path,t)}isEqual(e){return e instanceof t4&&this.Fc===e.Fc}}function Ave(n,e,t,r){const i=n.Cc(1,e,t);n4("Data must be an object, but it was:",i,r);const s=[],a=Wa.empty();Hp(r,(l,u)=>{const c=r4(e,l,t);u=Oi(u);const h=i.yc(c);if(u instanceof cN)s.push(c);else{const d=zS(u,h);d!=null&&(s.push(c),a.set(c,d))}});const o=new Oo(s);return new mQ(a,o,i.fieldTransforms)}function Tve(n,e,t,r,i,s){const a=n.Cc(1,e,t),o=[G3(e,r,t)],l=[i];if(s.length%2!=0)throw new ut(He.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)o.push(G3(e,s[d])),l.push(s[d+1]);const u=[],c=Wa.empty();for(let d=o.length-1;d>=0;--d)if(!bQ(u,o[d])){const f=o[d];let p=l[d];p=Oi(p);const m=a.yc(f);if(p instanceof cN)u.push(f);else{const y=zS(p,m);y!=null&&(u.push(f),c.set(f,y))}}const h=new Oo(u);return new mQ(c,h,a.fieldTransforms)}function Mve(n,e,t,r=!1){return zS(t,n.Cc(r?4:3,e))}function zS(n,e){if(xQ(n=Oi(n)))return n4("Unsupported field value:",e,n),yQ(n,e);if(n instanceof VS)return function(r,i){if(!gQ(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let a=0;for(const o of r){let l=zS(o,i.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Oi(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return CY(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Er.fromDate(r);return{timestampValue:ZC(i.serializer,s)}}if(r instanceof Er){const s=new Er(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ZC(i.serializer,s)}}if(r instanceof gc)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof gl)return{bytesValue:UY(i.serializer,r._byteString)};if(r instanceof ti){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:LB(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof vc)return function(a,o){return{mapValue:{fields:{[dY]:{stringValue:fY},[KC]:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw o.Sc("VectorValues must only contain numeric values.");return RB(o.serializer,u)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${W2(r)}`)}(n,e)}function yQ(n,e){const t={};return aY(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Hp(n,(r,i)=>{const s=zS(i,e.mc(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function xQ(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Er||n instanceof gc||n instanceof gl||n instanceof ti||n instanceof VS||n instanceof vc)}function n4(n,e,t){if(!xQ(t)||!iY(t)){const r=W2(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function G3(n,e,t){if((e=Oi(e))instanceof lN)return e._internalPath;if(typeof e=="string")return r4(n,e);throw rD("Field path arguments must be of type string or ",n,!1,void 0,t)}const Cve=new RegExp("[~\\*/\\[\\]]");function r4(n,e,t){if(e.search(Cve)>=0)throw rD(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new lN(...e.split("."))._internalPath}catch{throw rD(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function rD(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new ut(He.INVALID_ARGUMENT,o+n+l)}function bQ(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _Q{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ti(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Dve(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(hN("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Dve extends _Q{data(){return super.data()}}function hN(n,e){return typeof e=="string"?r4(n,e):e instanceof lN?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wQ(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ut(He.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class i4{}class s4 extends i4{}function $S(n,e,...t){let r=[];e instanceof i4&&r.push(e),r=r.concat(t),function(s){const a=s.filter(l=>l instanceof a4).length,o=s.filter(l=>l instanceof dN).length;if(a>1||a>0&&o>0)throw new ut(He.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class dN extends s4{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new dN(e,t,r)}_apply(e){const t=this._parse(e);return SQ(e._query,t),new wd(e.firestore,e.converter,F3(e._query,t))}_parse(e){const t=uN(e.firestore);return function(s,a,o,l,u,c,h){let d;if(u.isKeyField()){if(c==="array-contains"||c==="array-contains-any")throw new ut(He.INVALID_ARGUMENT,`Invalid Query. You can't perform '${c}' queries on documentId().`);if(c==="in"||c==="not-in"){Zz(h,c);const p=[];for(const m of h)p.push(Qz(l,s,m));d={arrayValue:{values:p}}}else d=Qz(l,s,h)}else c!=="in"&&c!=="not-in"&&c!=="array-contains-any"||Zz(h,c),d=Mve(o,a,h,c==="in"||c==="not-in");return bi.create(u,c,d)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function EQ(n,e,t){const r=e,i=hN("where",n);return dN._create(i,r,t)}class a4 extends i4{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new a4(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:pu.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)SQ(a,l),a=F3(a,l)}(e._query,t),new wd(e.firestore,e.converter,F3(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class o4 extends s4{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new o4(e,t)}_apply(e){const t=function(i,s,a){if(i.startAt!==null)throw new ut(He.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new ut(He.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new pw(s,a)}(e._query,this._field,this._direction);return new wd(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new zb(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function l4(n,e="asc"){const t=e,r=hN("orderBy",n);return o4._create(r,t)}class u4 extends s4{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new u4(e,t,r)}_apply(e){return new wd(e.firestore,e.converter,QC(e._query,this._limit,this._limitType))}}function Nve(n){return u4._create("limit",n,"F")}function Qz(n,e,t){if(typeof(t=Oi(t))=="string"){if(t==="")throw new ut(He.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!_Y(e)&&t.indexOf("/")!==-1)throw new ut(He.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(yr.fromString(t));if(!Ct.isDocumentKey(r))throw new ut(He.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return fz(n,new Ct(r))}if(t instanceof ti)return fz(n,t._key);throw new ut(He.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${W2(t)}.`)}function Zz(n,e){if(!Array.isArray(n)||n.length===0)throw new ut(He.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function SQ(n,e){const t=function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new ut(He.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ut(He.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Rve{convertValue(e,t="none"){switch(Tp(e)){case 0:return null;case 1:return e.booleanValue;case 2:return oi(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ap(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ot(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Hp(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var r,i,s;const t=(s=(i=(r=e.fields)==null?void 0:r[KC].arrayValue)==null?void 0:i.values)==null?void 0:s.map(a=>oi(a.doubleValue));return new vc(t)}convertGeoPoint(e){return new gc(oi(e.latitude),oi(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Y2(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(hw(e));default:return null}}convertTimestamp(e){const t=Sp(e);return new Er(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=yr.fromString(e);$n(jY(r),9688,{name:e});const i=new dw(r.get(1),r.get(3)),s=new Ct(r.popFirst(5));return i.isEqual(t)||ud(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AQ(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class G_{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class cv extends _Q{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new wM(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(hN("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ut(He.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=cv._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}cv._jsonSchemaVersion="firestore/documentSnapshot/1.0",cv._jsonSchema={type:_i("string",cv._jsonSchemaVersion),bundleSource:_i("string","DocumentSnapshot"),bundleName:_i("string"),bundle:_i("string")};class wM extends cv{data(e={}){return super.data(e)}}class hv{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new G_(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new wM(this._firestore,this._userDataWriter,r.key,r,new G_(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ut(He.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new wM(i._firestore,i._userDataWriter,o.doc.key,o.doc,new G_(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new wM(i._firestore,i._userDataWriter,o.doc.key,o.doc,new G_(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,c=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),c=a.indexOf(o.doc.key)),{type:Ive(o.type),doc:l,oldIndex:u,newIndex:c}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ut(He.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=hv._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=AB.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Ive(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ot(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TQ(n){n=Ja(n,ti);const e=Ja(n.firestore,dd);return vve(oN(e),n._key).then(t=>DQ(e,n,t))}hv._jsonSchemaVersion="firestore/querySnapshot/1.0",hv._jsonSchema={type:_i("string",hv._jsonSchemaVersion),bundleSource:_i("string","QuerySnapshot"),bundleName:_i("string"),bundle:_i("string")};class c4 extends Rve{constructor(e){super(),this.firestore=e}convertBytes(e){return new gl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ti(this.firestore,null,t)}}function fN(n){n=Ja(n,wd);const e=Ja(n.firestore,dd),t=oN(e),r=new c4(e);return wQ(n._query),yve(t,n._query).then(i=>new hv(e,r,n,i))}function Pve(n,e,t){n=Ja(n,ti);const r=Ja(n.firestore,dd),i=AQ(n.converter,e);return mN(r,[vQ(uN(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,El.none())])}function MQ(n,e,t,...r){n=Ja(n,ti);const i=Ja(n.firestore,dd),s=uN(i);let a;return a=typeof(e=Oi(e))=="string"||e instanceof lN?Tve(s,"updateDoc",n._key,e,t,r):Ave(s,"updateDoc",n._key,e),mN(i,[a.toMutation(n._key,El.exists(!0))])}function CQ(n){return mN(Ja(n.firestore,dd),[new IB(n._key,El.none())])}function pN(n,e){const t=Ja(n.firestore,dd),r=Dp(n),i=AQ(n.converter,e);return mN(t,[vQ(uN(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,El.exists(!1))]).then(()=>r)}function Fve(n,...e){var l,u,c;n=Oi(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Yz(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Yz(e[r])){const h=e[r];e[r]=(l=h.next)==null?void 0:l.bind(h),e[r+1]=(u=h.error)==null?void 0:u.bind(h),e[r+2]=(c=h.complete)==null?void 0:c.bind(h)}let s,a,o;if(n instanceof ti)a=Ja(n.firestore,dd),o=Q2(n._key.path),s={next:h=>{e[r]&&e[r](DQ(a,n,h))},error:e[r+1],complete:e[r+2]};else{const h=Ja(n,wd);a=Ja(h.firestore,dd),o=h._query;const d=new c4(a);s={next:f=>{e[r]&&e[r](new hv(a,d,h,f))},error:e[r+1],complete:e[r+2]},wQ(n._query)}return function(d,f,p,m){const y=new ZB(m),v=new KB(f,y,p);return d.asyncQueue.enqueueAndForget(async()=>qB(await nD(d),v)),()=>{y.Nu(),d.asyncQueue.enqueueAndForget(async()=>WB(await nD(d),v))}}(oN(a),o,i,s)}function mN(n,e){return function(r,i){const s=new qh;return r.asyncQueue.enqueueAndForget(async()=>sve(await gve(r),i,s)),s.promise}(oN(n),e)}function DQ(n,e,t){const r=t.docs.get(e._key),i=new c4(n);return new cv(n,i,e._key,r,new G_(t.hasPendingWrites,t.fromCache),e.converter)}function Wh(){return new e4("serverTimestamp")}function Lve(n){return new t4("increment",n)}(function(e,t=!0){(function(i){Bb=i})(Fv),bv(new wp("firestore",(r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),o=new dd(new Mpe(r.getProvider("auth-internal")),new Npe(a,r.getProvider("app-check-internal")),function(u,c){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ut(He.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new dw(u.options.projectId,c)}(a,i),a);return s={useFetchStreams:t,...s},o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),fc(ez,tz,e),fc(ez,tz,"esm2020")})();const ga=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),j3=[.001,0,0,.001,0,0],rI=1.35,Mo={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Zd={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},xw="pdfjs_internal_editor_",Jt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},En={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Ove={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},q3={TRIANGLES:1,LATTICE:2},cs={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},EM={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},mi={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},N0={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},gN={ERRORS:0,WARNINGS:1,INFOS:5},bw={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},v_={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},kve={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let vN=gN.WARNINGS;function Bve(n){Number.isInteger(n)&&(vN=n)}function Uve(){return vN}function yN(n){vN>=gN.INFOS&&console.info(`Info: ${n}`)}function Xt(n){vN>=gN.WARNINGS&&console.warn(`Warning: ${n}`)}function fr(n){throw new Error(n)}function Sn(n,e){n||fr(e)}function Vve(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function NQ(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=jve(n)}catch{}}const r=e?URL.parse(n,e):URL.parse(n);return Vve(r)?r:null}function RQ(n,e,t=!1){const r=URL.parse(n);return r?(r.hash=e,r.href):t&&NQ(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Kt(n,e,t,r=!1){return Object.defineProperty(n,e,{value:t,enumerable:!r,configurable:!0,writable:!1}),t}const kv=function(){function e(t,r){this.message=t,this.name=r}return e.prototype=new Error,e.constructor=e,e}();class Jz extends kv{constructor(e,t){super(e,"PasswordException"),this.code=t}}class iI extends kv{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class W3 extends kv{constructor(e){super(e,"InvalidPDFException")}}class iD extends kv{constructor(e,t,r){super(e,"ResponseException"),this.status=t,this.missing=r}}class zve extends kv{constructor(e){super(e,"FormatError")}}class Np extends kv{constructor(e){super(e,"AbortException")}}function IQ(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&fr("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const r=[];for(let i=0;i<e;i+=t){const s=Math.min(i+t,e),a=n.subarray(i,s);r.push(String.fromCharCode.apply(null,a))}return r.join("")}function HS(n){typeof n!="string"&&fr("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let r=0;r<e;++r)t[r]=n.charCodeAt(r)&255;return t}function $ve(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function Hve(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function Gve(){try{return new Function(""),!0}catch{return!1}}class Cs{static get isLittleEndian(){return Kt(this,"isLittleEndian",Hve())}static get isEvalSupported(){return Kt(this,"isEvalSupported",Gve())}static get isOffscreenCanvasSupported(){return Kt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Kt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return Kt(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return Kt(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Kt(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return Kt(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const sI=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var Jh,SM,X3;class yt{static makeHexColor(e,t,r){return`#${sI[e]}${sI[t]}${sI[r]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let r;e[0]?(e[0]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[3],t[3]*=e[3]):(r=t[0],t[0]=t[1],t[1]=r,r=t[2],t[2]=t[3],t[3]=r,e[1]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,r=0){const i=e[r],s=e[r+1];e[r]=i*t[0]+s*t[2]+t[4],e[r+1]=i*t[1]+s*t[3]+t[5]}static applyTransformToBezier(e,t,r=0){const i=t[0],s=t[1],a=t[2],o=t[3],l=t[4],u=t[5];for(let c=0;c<6;c+=2){const h=e[r+c],d=e[r+c+1];e[r+c]=h*i+d*a+l,e[r+c+1]=h*s+d*o+u}}static applyInverseTransform(e,t){const r=e[0],i=e[1],s=t[0]*t[3]-t[1]*t[2];e[0]=(r*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/s,e[1]=(-r*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/s}static axialAlignedBoundingBox(e,t,r){const i=t[0],s=t[1],a=t[2],o=t[3],l=t[4],u=t[5],c=e[0],h=e[1],d=e[2],f=e[3];let p=i*c+l,m=p,y=i*d+l,v=y,b=o*h+u,x=b,w=o*f+u,_=w;if(s!==0||a!==0){const E=s*c,A=s*d,T=a*h,S=a*f;p+=T,v+=T,y+=S,m+=S,b+=E,_+=E,w+=A,x+=A}r[0]=Math.min(r[0],p,y,m,v),r[1]=Math.min(r[1],b,w,x,_),r[2]=Math.max(r[2],p,y,m,v),r[3]=Math.max(r[3],b,w,x,_)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const r=e[0],i=e[1],s=e[2],a=e[3],o=r**2+i**2,l=r*s+i*a,u=s**2+a**2,c=(o+u)/2,h=Math.sqrt(c**2-(o*u-l**2));t[0]=Math.sqrt(c+h||1),t[1]=Math.sqrt(c-h||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const r=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(r>i)return null;const s=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return s>a?null:[r,s,i,a]}static pointBoundingBox(e,t,r){r[0]=Math.min(r[0],e),r[1]=Math.min(r[1],t),r[2]=Math.max(r[2],e),r[3]=Math.max(r[3],t)}static rectBoundingBox(e,t,r,i,s){s[0]=Math.min(s[0],e,r),s[1]=Math.min(s[1],t,i),s[2]=Math.max(s[2],e,r),s[3]=Math.max(s[3],t,i)}static bezierBoundingBox(e,t,r,i,s,a,o,l,u){u[0]=Math.min(u[0],e,o),u[1]=Math.min(u[1],t,l),u[2]=Math.max(u[2],e,o),u[3]=Math.max(u[3],t,l),X(this,Jh,X3).call(this,e,r,s,o,t,i,a,l,3*(-e+3*(r-s)+o),6*(e-2*r+s),3*(r-e),u),X(this,Jh,X3).call(this,e,r,s,o,t,i,a,l,3*(-t+3*(i-a)+l),6*(t-2*i+a),3*(i-t),u)}}Jh=new WeakSet,SM=function(e,t,r,i,s,a,o,l,u,c){if(u<=0||u>=1)return;const h=1-u,d=u*u,f=d*u,p=h*(h*(h*e+3*u*t)+3*d*r)+f*i,m=h*(h*(h*s+3*u*a)+3*d*o)+f*l;c[0]=Math.min(c[0],p),c[1]=Math.min(c[1],m),c[2]=Math.max(c[2],p),c[3]=Math.max(c[3],m)},X3=function(e,t,r,i,s,a,o,l,u,c,h,d){if(Math.abs(u)<1e-12){Math.abs(c)>=1e-12&&X(this,Jh,SM).call(this,e,t,r,i,s,a,o,l,-h/c,d);return}const f=c**2-4*h*u;if(f<0)return;const p=Math.sqrt(f),m=2*u;X(this,Jh,SM).call(this,e,t,r,i,s,a,o,l,(-c+p)/m,d),X(this,Jh,SM).call(this,e,t,r,i,s,a,o,l,(-c-p)/m,d)},j(yt,Jh);function jve(n){return decodeURIComponent(escape(n))}let aI=null,e8=null;function qve(n){return aI||(aI=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,e8=new Map([["","t"]])),n.replaceAll(aI,(e,t,r)=>t?t.normalize("NFKC"):e8.get(r))}function PQ(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),IQ(n)}const ny="pdfjs_internal_id_";function Wve(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[r,i,...s]=t;if(!n(r)&&!Number.isInteger(r)||!e(i))return!1;const a=s.length;let o=!0;switch(i.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const l of s)if(!(typeof l=="number"||o&&l===null))return!1;return!0}function va(n,e,t){return Math.min(Math.max(n,e),t)}function FQ(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(IQ(n))}function Xve(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):HS(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});class _w{static textContent(e){const t=[],r={items:t,styles:Object.create(null)};function i(s){var l;if(!s)return;let a=null;const o=s.name;if(o==="#text")a=s.value;else if(_w.shouldBuildText(o))(l=s==null?void 0:s.attributes)!=null&&l.textContent?a=s.attributes.textContent:s.value&&(a=s.value);else return;if(a!==null&&t.push({str:a}),!!s.children)for(const u of s.children)i(u)}return i(e),r}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class LQ{static setupStorage(e,t,r,i,s){const a=i.getValue(t,{value:null});switch(r.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),s==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})});break;case"input":if(r.attributes.type==="radio"||r.attributes.type==="checkbox"){if(a.value===r.attributes.xfaOn?e.setAttribute("checked",!0):a.value===r.attributes.xfaOff&&e.removeAttribute("checked"),s==="print")break;e.addEventListener("change",o=>{i.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),s==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of r.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,u=l.selectedIndex===-1?"":l[l.selectedIndex].value;i.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:r=null,intent:i,linkService:s}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${i}`);for(const[l,u]of Object.entries(a))if(u!=null)switch(l){case"class":u.length&&e.setAttribute(l,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,u)}o&&s.addLinkAttributes(e,a.href,a.newWindow),r&&a.dataId&&this.setupStorage(e,a.dataId,t,r)}static render(e){var h,d;const t=e.annotationStorage,r=e.linkService,i=e.xfaHtml,s=e.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:s,linkService:r});const o=s!=="richText",l=e.div;if(l.append(a),e.viewport){const f=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=f}o&&l.setAttribute("class","xfaLayer xfaFont");const u=[];if(i.children.length===0){if(i.value){const f=document.createTextNode(i.value);a.append(f),o&&_w.shouldBuildText(i.name)&&u.push(f)}return{textDivs:u}}const c=[[i,-1,a]];for(;c.length>0;){const[f,p,m]=c.at(-1);if(p+1===f.children.length){c.pop();continue}const y=f.children[++c.at(-1)[1]];if(y===null)continue;const{name:v}=y;if(v==="#text"){const x=document.createTextNode(y.value);u.push(x),m.append(x);continue}const b=(h=y==null?void 0:y.attributes)!=null&&h.xmlns?document.createElementNS(y.attributes.xmlns,v):document.createElement(v);if(m.append(b),y.attributes&&this.setAttributes({html:b,element:y,storage:t,intent:s,linkService:r}),((d=y.children)==null?void 0:d.length)>0)c.push([y,-1,b]);else if(y.value){const x=document.createTextNode(y.value);o&&_w.shouldBuildText(v)&&u.push(x),b.append(x)}}for(const f of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Xc="http://www.w3.org/2000/svg",Im=class Im{};Qe(Im,"CSS",96),Qe(Im,"PDF",72),Qe(Im,"PDF_TO_CSS_UNITS",Im.CSS/Im.PDF);let Rp=Im;async function GS(n,e="text"){if(j_(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,r)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}r(new Error(i.statusText))}},i.send(null)})}class jS{constructor({viewBox:e,userUnit:t,scale:r,rotation:i,offsetX:s=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=r,this.rotation=i,this.offsetX=s,this.offsetY=a,r*=t;const l=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let c,h,d,f;switch(i%=360,i<0&&(i+=360),i){case 180:c=-1,h=0,d=0,f=1;break;case 90:c=0,h=1,d=1,f=0;break;case 270:c=0,h=-1,d=-1,f=0;break;case 0:c=1,h=0,d=0,f=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(d=-d,f=-f);let p,m,y,v;c===0?(p=Math.abs(u-e[1])*r+s,m=Math.abs(l-e[0])*r+a,y=(e[3]-e[1])*r,v=(e[2]-e[0])*r):(p=Math.abs(l-e[0])*r+s,m=Math.abs(u-e[1])*r+a,y=(e[2]-e[0])*r,v=(e[3]-e[1])*r),this.transform=[c*r,h*r,d*r,f*r,p-c*r*l-d*r*u,m-h*r*l-f*r*u],this.width=y,this.height=v}get rawDims(){const e=this.viewBox;return Kt(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:r=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}={}){return new jS({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:r,offsetY:i,dontFlip:s})}convertToViewportPoint(e,t){const r=[e,t];return yt.applyTransform(r,this.transform),r}convertToViewportRectangle(e){const t=[e[0],e[1]];yt.applyTransform(t,this.transform);const r=[e[2],e[3]];return yt.applyTransform(r,this.transform),[t[0],t[1],r[0],r[1]]}convertToPdfPoint(e,t){const r=[e,t];return yt.applyInverseTransform(r,this.transform),r}}class h4 extends kv{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function xN(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function d4(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function Kve(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function Yve(n,e="document.pdf"){if(typeof n!="string")return e;if(xN(n))return Xt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const r=(o=>{try{return new URL(o)}catch{try{return new URL(decodeURIComponent(o))}catch{try{return new URL(o,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(o),"https://foo.bar")}catch{return null}}}}})(n);if(!r)return e;const i=o=>{try{let l=decodeURIComponent(o);return l.includes("/")?(l=l.split("/").at(-1),l.test(/^\.pdf$/i)?l:o):l}catch{return o}},s=/\.pdf$/i,a=r.pathname.split("/").at(-1);if(s.test(a))return i(a);if(r.searchParams.size>0){const o=Array.from(r.searchParams.values()).reverse();for(const u of o)if(s.test(u))return i(u);const l=Array.from(r.searchParams.keys()).reverse();for(const u of l)if(s.test(u))return i(u)}if(r.hash){const l=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(r.hash);if(l)return i(l[0])}return e}class t8{constructor(){Qe(this,"started",Object.create(null));Qe(this,"times",[])}time(e){e in this.started&&Xt(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Xt(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:r}of this.times)t=Math.max(r.length,t);for(const{name:r,start:i,end:s}of this.times)e.push(`${r.padEnd(t)} ${s-i}ms
`);return e.join("")}}function j_(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function Cl(n){n.preventDefault()}function Qr(n){n.preventDefault(),n.stopPropagation()}function Qve(n){console.log("Deprecated API usage: "+n)}var Lw;class sD{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;g(this,Lw)||U(this,Lw,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=g(this,Lw).exec(e);if(!t)return null;const r=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const u=t[7]||"Z";let c=parseInt(t[8],10);c=c>=0&&c<=23?c:0;let h=parseInt(t[9],10)||0;return h=h>=0&&h<=59?h:0,u==="-"?(a+=c,o+=h):u==="+"&&(a-=c,o-=h),new Date(Date.UTC(r,i,s,a,o,l))}}Lw=new WeakMap,j(sD,Lw);function Zve(n,{scale:e=1,rotation:t=0}){const{width:r,height:i}=n.attributes.style,s=[0,0,parseInt(r),parseInt(i)];return new jS({viewBox:s,userUnit:1,scale:e,rotation:t})}function qS(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Xt(`Not a valid color format: "${n}"`),[0,0,0])}function Jve(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const r=window.getComputedStyle(e).color;n.set(t,qS(r))}e.remove()}function Lr(n){const{a:e,b:t,c:r,d:i,e:s,f:a}=n.getTransform();return[e,t,r,i,s,a]}function Cu(n){const{a:e,b:t,c:r,d:i,e:s,f:a}=n.getTransform().invertSelf();return[e,t,r,i,s,a]}function Ev(n,e,t=!1,r=!0){if(e instanceof jS){const{pageWidth:i,pageHeight:s}=e.rawDims,{style:a}=n,o=Cs.isCSSRoundSupported,l=`var(--total-scale-factor) * ${i}px`,u=`var(--total-scale-factor) * ${s}px`,c=o?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,h=o?`round(down, ${u}, var(--scale-round-y))`:`calc(${u})`;!t||e.rotation%180===0?(a.width=c,a.height=h):(a.width=h,a.height=c)}r&&n.setAttribute("data-main-rotation",e.rotation)}class Ec{constructor(){const{pixelRatio:e}=Ec;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,r,i,s=-1){let a=1/0,o=1/0,l=1/0;r=Ec.capPixels(r,s),r>0&&(a=Math.sqrt(r/(e*t))),i!==-1&&(o=i/e,l=i/t);const u=Math.min(a,o,l);return this.sx>u||this.sy>u?(this.sx=u,this.sy=u,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const r=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,r):r}return e}}const K3=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class e0e{static get isDarkMode(){var e;return Kt(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class t0e{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:r}=window.getComputedStyle(e);return e.remove(),Kt(this,"commentForegroundColor",qS(r))}}function n0e(n,e,t,r){r=Math.min(Math.max(r??1,0),1);const i=255*(1-r);return n=Math.round(n*r+i),e=Math.round(e*r+i),t=Math.round(t*r+i),[n,e,t]}function n8(n,e){const t=n[0]/255,r=n[1]/255,i=n[2]/255,s=Math.max(t,r,i),a=Math.min(t,r,i),o=(s+a)/2;if(s===a)e[0]=e[1]=0;else{const l=s-a;switch(e[1]=o<.5?l/(s+a):l/(2-s-a),s){case t:e[0]=((r-i)/l+(r<i?6:0))*60;break;case r:e[0]=((i-t)/l+2)*60;break;case i:e[0]=((t-r)/l+4)*60;break}}e[2]=o}function Y3(n,e){const t=n[0],r=n[1],i=n[2],s=(1-Math.abs(2*i-1))*r,a=s*(1-Math.abs(t/60%2-1)),o=i-s/2;switch(Math.floor(t/60)){case 0:e[0]=s+o,e[1]=a+o,e[2]=o;break;case 1:e[0]=a+o,e[1]=s+o,e[2]=o;break;case 2:e[0]=o,e[1]=s+o,e[2]=a+o;break;case 3:e[0]=o,e[1]=a+o,e[2]=s+o;break;case 4:e[0]=a+o,e[1]=o,e[2]=s+o;break;case 5:case 6:e[0]=s+o,e[1]=o,e[2]=a+o;break}}function r8(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function i8(n,e,t){Y3(n,t),t.map(r8);const r=.2126*t[0]+.7152*t[1]+.0722*t[2];Y3(e,t),t.map(r8);const i=.2126*t[0]+.7152*t[1]+.0722*t[2];return r>i?(r+.05)/(i+.05):(i+.05)/(r+.05)}const s8=new Map;function r0e(n,e){const t=n[0]+n[1]*256+n[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let r=s8.get(t);if(r)return r;const i=new Float32Array(9),s=i.subarray(0,3),a=i.subarray(3,6);n8(n,a);const o=i.subarray(6,9);n8(e,o);const l=o[2]<.5,u=l?12:4.5;if(a[2]=l?Math.sqrt(a[2]):1-Math.sqrt(1-a[2]),i8(a,o,s)<u){let c,h;l?(c=a[2],h=1):(c=0,h=a[2]);const d=.005;for(;h-c>d;){const f=a[2]=(c+h)/2;l===i8(a,o,s)<u?c=f:h=f}a[2]=l?h:c}return Y3(a,s),r=yt.makeHexColor(Math.round(s[0]*255),Math.round(s[1]*255),Math.round(s[2]*255)),s8.set(t,r),r}function OQ({html:n,dir:e,className:t},r){const i=document.createDocumentFragment();if(typeof n=="string"){const s=document.createElement("p");s.dir=e||"auto";const a=n.split(/(?:\r\n?|\n)/);for(let o=0,l=a.length;o<l;++o){const u=a[o];s.append(document.createTextNode(u)),o<l-1&&s.append(document.createElement("br"))}i.append(s)}else LQ.render({xfaHtml:n,div:i,intent:"richText"});i.firstElementChild.classList.add("richText",t),r.append(i)}function kQ(n){const e=new Path2D;if(!n)return e;for(let t=0,r=n.length;t<r;)switch(n[t++]){case v_.moveTo:e.moveTo(n[t++],n[t++]);break;case v_.lineTo:e.lineTo(n[t++],n[t++]);break;case v_.curveTo:e.bezierCurveTo(n[t++],n[t++],n[t++],n[t++],n[t++],n[t++]);break;case v_.quadraticCurveTo:e.quadraticCurveTo(n[t++],n[t++],n[t++],n[t++]);break;case v_.closePath:e.closePath();break;default:Xt(`Unrecognized drawing path operator: ${n[t-1]}`);break}return e}var sf,af,el,tl,Ow,of,Dy,Ny,kw,s2,BQ,Es,UQ,VQ,R0,q_;const Jc=class Jc{constructor(e){j(this,Es);j(this,sf,null);j(this,af,null);j(this,el);j(this,tl,null);j(this,Ow,null);j(this,of,null);j(this,Dy,null);j(this,Ny,null);U(this,el,e),g(Jc,kw)||U(Jc,kw,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=U(this,sf,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=g(this,el)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",Cl,{signal:t}),e.addEventListener("pointerdown",X(Jc,s2,BQ),{signal:t}));const r=U(this,tl,document.createElement("div"));r.className="buttons",e.append(r);const i=g(this,el).toolbarPosition;if(i){const{style:s}=e,a=g(this,el)._uiManager.direction==="ltr"?1-i[0]:i[0];s.insetInlineEnd=`${100*a}%`,s.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return g(this,sf)}hide(){var e;g(this,sf).classList.add("hidden"),(e=g(this,af))==null||e.hideDropdown()}show(){var e,t;g(this,sf).classList.remove("hidden"),(e=g(this,Ow))==null||e.shown(),(t=g(this,of))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=g(this,el),r=document.createElement("button");r.classList.add("basic","deleteButton"),r.tabIndex=0,r.setAttribute("data-l10n-id",g(Jc,kw)[e]),X(this,Es,R0).call(this,r)&&r.addEventListener("click",i=>{t.delete()},{signal:t._signal}),g(this,tl).append(r)}async addAltText(e){const t=await e.render();X(this,Es,R0).call(this,t),g(this,tl).append(t,g(this,Es,q_)),U(this,Ow,e)}addComment(e,t=null){if(g(this,of))return;const r=e.renderForToolbar();if(!r)return;X(this,Es,R0).call(this,r);const i=U(this,Dy,g(this,Es,q_));t?(g(this,tl).insertBefore(r,t),g(this,tl).insertBefore(i,t)):g(this,tl).append(r,i),U(this,of,e),e.toolbar=this}addColorPicker(e){if(g(this,af))return;U(this,af,e);const t=e.renderButton();X(this,Es,R0).call(this,t),g(this,tl).append(t,g(this,Es,q_))}async addEditSignatureButton(e){const t=U(this,Ny,await e.renderEditButton(g(this,el)));X(this,Es,R0).call(this,t),g(this,tl).append(t,g(this,Es,q_))}removeButton(e){var t,r;switch(e){case"comment":(t=g(this,of))==null||t.removeToolbarCommentButton(),U(this,of,null),(r=g(this,Dy))==null||r.remove(),U(this,Dy,null);break}}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,r){if(!t&&e==="comment")return;const i=g(this,tl).querySelector(r);i&&e==="comment"&&this.addComment(t,i)}updateEditSignatureButton(e){g(this,Ny)&&(g(this,Ny).title=e)}remove(){var e;g(this,sf).remove(),(e=g(this,af))==null||e.destroy(),U(this,af,null)}};sf=new WeakMap,af=new WeakMap,el=new WeakMap,tl=new WeakMap,Ow=new WeakMap,of=new WeakMap,Dy=new WeakMap,Ny=new WeakMap,kw=new WeakMap,s2=new WeakSet,BQ=function(e){e.stopPropagation()},Es=new WeakSet,UQ=function(e){g(this,el)._focusEventsAllowed=!1,Qr(e)},VQ=function(e){g(this,el)._focusEventsAllowed=!0,Qr(e)},R0=function(e){const t=g(this,el)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",X(this,Es,UQ).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",X(this,Es,VQ).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Cl,{signal:t}),!0)},q_=function(){const e=document.createElement("div");return e.className="divider",e},j(Jc,s2),j(Jc,kw,null);let Q3=Jc;var Bw,jm,nh,xd,zQ,$Q,Z3;class i0e{constructor(e){j(this,xd);j(this,Bw,null);j(this,jm,null);j(this,nh);U(this,nh,e)}show(e,t,r){const[i,s]=X(this,xd,$Q).call(this,t,r),{style:a}=g(this,jm)||U(this,jm,X(this,xd,zQ).call(this));e.append(g(this,jm)),a.insetInlineEnd=`${100*i}%`,a.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){g(this,jm).remove()}}Bw=new WeakMap,jm=new WeakMap,nh=new WeakMap,xd=new WeakSet,zQ=function(){const e=U(this,jm,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=g(this,nh)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",Cl,{signal:t});const r=U(this,Bw,document.createElement("div"));return r.className="buttons",e.append(r),g(this,nh).hasCommentManager()&&X(this,xd,Z3).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{g(this,nh).commentSelection("floating_button")}),X(this,xd,Z3).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{g(this,nh).highlightSelection("floating_button")}),e},$Q=function(e,t){let r=0,i=0;for(const s of e){const a=s.y+s.height;if(a<r)continue;const o=s.x+(t?s.width:0);if(a>r){i=o,r=a;continue}t?o>i&&(i=o):o<i&&(i=o)}return[t?1-i:i,r]},Z3=function(e,t,r,i){const s=document.createElement("button");s.classList.add("basic",e),s.tabIndex=0,s.setAttribute("data-l10n-id",t);const a=document.createElement("span");s.append(a),a.className="visuallyHidden",a.setAttribute("data-l10n-id",r);const o=g(this,nh)._signal;o instanceof AbortSignal&&!o.aborted&&(s.addEventListener("contextmenu",Cl,{signal:o}),s.addEventListener("click",i,{signal:o})),g(this,Bw).append(s)};function HQ(n,e,t){for(const r of t)e.addEventListener(r,n[r].bind(n))}var qm,Wm,Ry,Xm;const er=class er{static initializeAndAddPointerId(e){(g(er,Wm)||U(er,Wm,new Set)).add(e)}static setPointer(e,t){g(er,qm)||U(er,qm,t),g(er,Xm)??U(er,Xm,e)}static setTimeStamp(e){U(er,Ry,e)}static isSamePointerId(e){return g(er,qm)===e}static isSamePointerIdOrRemove(e){var t;return g(er,qm)===e?!0:((t=g(er,Wm))==null||t.delete(e),!1)}static isSamePointerType(e){return g(er,Xm)===e}static isInitializedAndDifferentPointerType(e){return g(er,Xm)!==null&&!er.isSamePointerType(e)}static isSameTimeStamp(e){return g(er,Ry)===e}static isUsingMultiplePointers(){var e;return((e=g(er,Wm))==null?void 0:e.size)>=1}static clearPointerType(){U(er,Xm,null)}static clearPointerIds(){U(er,qm,NaN),U(er,Wm,null)}static clearTimeStamp(){U(er,Ry,NaN)}};qm=new WeakMap,Wm=new WeakMap,Ry=new WeakMap,Xm=new WeakMap,j(er,qm,NaN),j(er,Wm,null),j(er,Ry,NaN),j(er,Xm,null);let zs=er;var a2;class s0e{constructor(){j(this,a2,0)}get id(){return`${xw}${Ai(this,a2)._++}`}}a2=new WeakMap;var Iy,Uw,$s,Py,AM;const BU=class BU{constructor(){j(this,Py);j(this,Iy,PQ());j(this,Uw,0);j(this,$s,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',r=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const s=i.decode().then(()=>(r.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(r.getImageData(0,0,1,1).data.buffer)[0]===0));return Kt(this,"_isSVGFittingCanvas",s)}async getFromFile(e){const{lastModified:t,name:r,size:i,type:s}=e;return X(this,Py,AM).call(this,`${t}_${r}_${i}_${s}`,e)}async getFromUrl(e){return X(this,Py,AM).call(this,e,e)}async getFromBlob(e,t){const r=await t;return X(this,Py,AM).call(this,e,r)}async getFromId(e){g(this,$s)||U(this,$s,new Map);const t=g(this,$s).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:r}=t;return delete t.blobPromise,this.getFromBlob(t.id,r)}return this.getFromUrl(t.url)}getFromCanvas(e,t){g(this,$s)||U(this,$s,new Map);let r=g(this,$s).get(e);if(r!=null&&r.bitmap)return r.refCounter+=1,r;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),r={bitmap:i.transferToImageBitmap(),id:`image_${g(this,Iy)}_${Ai(this,Uw)._++}`,refCounter:1,isSvg:!1},g(this,$s).set(e,r),g(this,$s).set(r.id,r),r}getSvgUrl(e){const t=g(this,$s).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;g(this,$s)||U(this,$s,new Map);const t=g(this,$s).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:r}=t;if(!t.url&&!t.file){const s=new OffscreenCanvas(r.width,r.height);s.getContext("bitmaprenderer").transferFromImageBitmap(r),t.blobPromise=s.convertToBlob()}(i=r.close)==null||i.call(r),t.bitmap=null}isValidId(e){return e.startsWith(`image_${g(this,Iy)}_`)}};Iy=new WeakMap,Uw=new WeakMap,$s=new WeakMap,Py=new WeakSet,AM=async function(e,t){g(this,$s)||U(this,$s,new Map);let r=g(this,$s).get(e);if(r===null)return null;if(r!=null&&r.bitmap)return r.refCounter+=1,r;try{r||(r={bitmap:null,id:`image_${g(this,Iy)}_${Ai(this,Uw)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(r.url=t,i=await GS(t,"blob")):t instanceof File?i=r.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const s=BU._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((u,c)=>{o.onload=()=>{r.bitmap=o,r.isSvg=!0,u()},a.onload=async()=>{const h=r.svgUrl=a.result;o.src=await s?`${h}#svgView(preserveAspectRatio(none))`:h},o.onerror=a.onerror=c});a.readAsDataURL(i),await l}else r.bitmap=await createImageBitmap(i);r.refCounter=1}catch(i){Xt(i),r=null}return g(this,$s).set(e,r),r&&g(this,$s).set(r.id,r),r};let J3=BU;var ri,lf,Vw,Fr;class a0e{constructor(e=128){j(this,ri,[]);j(this,lf,!1);j(this,Vw);j(this,Fr,-1);U(this,Vw,e)}add({cmd:e,undo:t,post:r,mustExec:i,type:s=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(i&&e(),g(this,lf))return;const l={cmd:e,undo:t,post:r,type:s};if(g(this,Fr)===-1){g(this,ri).length>0&&(g(this,ri).length=0),U(this,Fr,0),g(this,ri).push(l);return}if(a&&g(this,ri)[g(this,Fr)].type===s){o&&(l.undo=g(this,ri)[g(this,Fr)].undo),g(this,ri)[g(this,Fr)]=l;return}const u=g(this,Fr)+1;u===g(this,Vw)?g(this,ri).splice(0,1):(U(this,Fr,u),u<g(this,ri).length&&g(this,ri).splice(u)),g(this,ri).push(l)}undo(){if(g(this,Fr)===-1)return;U(this,lf,!0);const{undo:e,post:t}=g(this,ri)[g(this,Fr)];e(),t==null||t(),U(this,lf,!1),U(this,Fr,g(this,Fr)-1)}redo(){if(g(this,Fr)<g(this,ri).length-1){U(this,Fr,g(this,Fr)+1),U(this,lf,!0);const{cmd:e,post:t}=g(this,ri)[g(this,Fr)];e(),t==null||t(),U(this,lf,!1)}}hasSomethingToUndo(){return g(this,Fr)!==-1}hasSomethingToRedo(){return g(this,Fr)<g(this,ri).length-1}cleanType(e){if(g(this,Fr)!==-1){for(let t=g(this,Fr);t>=0;t--)if(g(this,ri)[t].type!==e){g(this,ri).splice(t+1,g(this,Fr)-t),U(this,Fr,t);return}g(this,ri).length=0,U(this,Fr,-1)}}destroy(){U(this,ri,null)}}ri=new WeakMap,lf=new WeakMap,Vw=new WeakMap,Fr=new WeakMap;var o2,GQ;class WS{constructor(e){j(this,o2);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Cs.platform;for(const[r,i,s={}]of e)for(const a of r){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:i,options:s}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:i,options:s}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const r=this.callbacks.get(X(this,o2,GQ).call(this,t));if(!r)return;const{callback:i,options:{bubbles:s=!1,args:a=[],checker:o=null}}=r;o&&!o(e,t)||(i.bind(e,...a,t)(),s||Qr(t))}}o2=new WeakSet,GQ=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const l2=class l2{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return Jve(e),Kt(this,"_colors",e)}convert(e){const t=qS(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[r,i]of this._colors)if(i.every((s,a)=>s===t[a]))return l2._colorsMapping.get(r);return t}getHexCode(e){const t=this._colors.get(e);return t?yt.makeHexColor(...t):e}};Qe(l2,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let eF=l2;var Fy,lo,Ly,Gr,Ci,Oy,nl,ky,rl,Hs,uf,cf,By,hf,Lu,il,Km,zw,$w,Uy,Hw,Ou,df,Vy,ff,ku,u2,pf,zy,Gw,mf,Ym,$y,gf,jw,vi,Gn,rh,vf,yf,qw,Hy,Ww,xf,Bu,ih,Xw,Kw,sl,ot,TM,tF,jQ,qQ,W_,WQ,XQ,KQ,nF,YQ,QQ,ZQ,JQ,ca,Kc,eZ,tZ,rF,nZ,X_,iF;const ly=class ly{constructor(e,t,r,i,s,a,o,l,u,c,h,d,f,p,m,y){j(this,ot);j(this,Fy,new AbortController);j(this,lo,null);j(this,Ly,null);j(this,Gr,new Map);j(this,Ci,new Map);j(this,Oy,null);j(this,nl,null);j(this,ky,null);j(this,rl,new a0e);j(this,Hs,null);j(this,uf,null);j(this,cf,null);j(this,By,0);j(this,hf,new Set);j(this,Lu,null);j(this,il,null);j(this,Km,new Set);Qe(this,"_editorUndoBar",null);j(this,zw,!1);j(this,$w,!1);j(this,Uy,!1);j(this,Hw,null);j(this,Ou,null);j(this,df,null);j(this,Vy,null);j(this,ff,!1);j(this,ku,null);j(this,u2,new s0e);j(this,pf,!1);j(this,zy,!1);j(this,Gw,!1);j(this,mf,null);j(this,Ym,null);j(this,$y,null);j(this,gf,null);j(this,jw,null);j(this,vi,Jt.NONE);j(this,Gn,new Set);j(this,rh,null);j(this,vf,null);j(this,yf,null);j(this,qw,null);j(this,Hy,null);j(this,Ww,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});j(this,xf,[0,0]);j(this,Bu,null);j(this,ih,null);j(this,Xw,null);j(this,Kw,null);j(this,sl,null);const v=this._signal=g(this,Fy).signal;U(this,ih,e),U(this,Xw,t),U(this,Kw,r),U(this,Oy,i),U(this,Hs,s),U(this,vf,a),U(this,Hy,l),this._eventBus=o,o._on("editingaction",this.onEditingAction.bind(this),{signal:v}),o._on("pagechanging",this.onPageChanging.bind(this),{signal:v}),o._on("scalechanging",this.onScaleChanging.bind(this),{signal:v}),o._on("rotationchanging",this.onRotationChanging.bind(this),{signal:v}),o._on("setpreference",this.onSetPreference.bind(this),{signal:v}),o._on("switchannotationeditorparams",b=>this.updateParams(b.type,b.value),{signal:v}),window.addEventListener("pointerdown",()=>{U(this,zy,!0)},{capture:!0,signal:v}),window.addEventListener("pointerup",()=>{U(this,zy,!1)},{capture:!0,signal:v}),X(this,ot,WQ).call(this),X(this,ot,JQ).call(this),X(this,ot,nF).call(this),U(this,nl,l.annotationStorage),U(this,Hw,l.filterFactory),U(this,yf,u),U(this,Vy,c||null),U(this,zw,h),U(this,$w,d),U(this,Uy,f),U(this,jw,p||null),this.viewParameters={realScale:Rp.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=m||null,this._supportsPinchToZoom=y!==!1,s==null||s.setSidebarUiManager(this)}static get _keyboardManager(){const e=ly.prototype,t=a=>g(a,ih).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),r=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},i=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Kt(this,"_keyboardManager",new WS([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:r}],[["ctrl+z","mac+meta+z"],e.undo,{checker:r}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:r}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:r}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&g(a,ih).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&g(a,ih).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}]]))}destroy(){var e,t,r,i,s,a,o,l,u;(e=g(this,sl))==null||e.resolve(),U(this,sl,null),(t=g(this,Fy))==null||t.abort(),U(this,Fy,null),this._signal=null;for(const c of g(this,Ci).values())c.destroy();g(this,Ci).clear(),g(this,Gr).clear(),g(this,Km).clear(),(r=g(this,gf))==null||r.clear(),U(this,lo,null),g(this,Gn).clear(),g(this,rl).destroy(),(i=g(this,Oy))==null||i.destroy(),(s=g(this,Hs))==null||s.destroy(),(a=g(this,vf))==null||a.destroy(),(o=g(this,ku))==null||o.hide(),U(this,ku,null),(l=g(this,$y))==null||l.destroy(),U(this,$y,null),U(this,Ly,null),g(this,Ou)&&(clearTimeout(g(this,Ou)),U(this,Ou,null)),g(this,Bu)&&(clearTimeout(g(this,Bu)),U(this,Bu,null)),(u=this._editorUndoBar)==null||u.destroy(),U(this,Hy,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return g(this,jw)}get useNewAltTextFlow(){return g(this,$w)}get useNewAltTextWhenAddingImage(){return g(this,Uy)}get hcmFilter(){return Kt(this,"hcmFilter",g(this,yf)?g(this,Hw).addHCMFilter(g(this,yf).foreground,g(this,yf).background):"none")}get direction(){return Kt(this,"direction",getComputedStyle(g(this,ih)).direction)}get _highlightColors(){return Kt(this,"_highlightColors",g(this,Vy)?new Map(g(this,Vy).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Kt(this,"highlightColors",null);const t=new Map,r=!!g(this,yf);for(const[i,s]of e){const a=i.endsWith("_HCM");if(r&&a){t.set(i.replace("_HCM",""),s);continue}!r&&!a&&t.set(i,s)}return Kt(this,"highlightColors",t)}get highlightColorNames(){return Kt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),U(this,cf,e)}setMainHighlightColorPicker(e){U(this,$y,e)}editAltText(e,t=!1){var r;(r=g(this,Oy))==null||r.editAltText(this,e,t)}hasCommentManager(){return!!g(this,Hs)}editComment(e,t,r,i){var s;(s=g(this,Hs))==null||s.showDialog(this,e,t,r,i)}selectComment(e,t){const r=g(this,Ci).get(e),i=r==null?void 0:r.getEditorByUID(t);i==null||i.toggleComment(!0,!0)}updateComment(e){var t;(t=g(this,Hs))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=g(this,Hs))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=g(this,Hs))==null||t.removeComments([e.uid])}toggleComment(e,t,r=void 0){var i;(i=g(this,Hs))==null||i.toggleCommentPopup(e,t,r)}makeCommentColor(e,t){var r;return e&&((r=g(this,Hs))==null?void 0:r.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=g(this,Hs))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(g(this,Ci).has(e-1))return;const{resolve:t,promise:r}=Promise.withResolvers(),i=s=>{s.pageNumber===e&&(this._eventBus._off("editorsrendered",i),t())};this._eventBus.on("editorsrendered",i),await r}getSignature(e){var t;(t=g(this,vf))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return g(this,vf)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":U(this,Uy,t);break}}onPageChanging({pageNumber:e}){U(this,By,e-1)}focusMainContainer(){g(this,ih).focus()}findParent(e,t){for(const r of g(this,Ci).values()){const{x:i,y:s,width:a,height:o}=r.div.getBoundingClientRect();if(e>=i&&e<=i+a&&t>=s&&t<=s+o)return r}return null}disableUserSelect(e=!1){g(this,Xw).classList.toggle("noUserSelect",e)}addShouldRescale(e){g(this,Km).add(e)}removeShouldRescale(e){g(this,Km).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Rp.PDF_TO_CSS_UNITS;for(const r of g(this,Km))r.onScaleChanging();(t=g(this,cf))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const r=document.getSelection();if(!r||r.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:a,focusOffset:o}=r,l=r.toString(),c=X(this,ot,TM).call(this,r).closest(".textLayer"),h=this.getSelectionBoxes(c);if(!h)return;r.empty();const d=X(this,ot,tF).call(this,c),f=g(this,vi)===Jt.NONE,p=()=>{const m=d==null?void 0:d.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:i,anchorOffset:s,focusNode:a,focusOffset:o,text:l});f&&this.showAllEditors("highlight",!0,!0),t&&(m==null||m.editComment())};if(f){this.switchToMode(Jt.HIGHLIGHT,p);return}p()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!g(this,nl))return null;const t=`${xw}${e}`,r=g(this,nl).getRawValue(t);return r&&g(this,nl).remove(t),r}addToAnnotationStorage(e){!e.isEmpty()&&g(this,nl)&&!g(this,nl).has(e.id)&&g(this,nl).setValue(e.id,e)}a11yAlert(e,t=null){const r=g(this,Kw);r&&(r.setAttribute("data-l10n-id",e),t?r.setAttribute("data-l10n-args",JSON.stringify(t)):r.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,g(this,ff)&&(U(this,ff,!1),X(this,ot,W_).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of g(this,Gn))if(t.div.contains(e)){U(this,Ym,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!g(this,Ym))return;const[e,t]=g(this,Ym);U(this,Ym,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){X(this,ot,nF).call(this),this.setEditingState(!0)}removeEditListeners(){X(this,ot,YQ).call(this),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const r of g(this,il))if(r.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const r of g(this,il))if(r.isHandlingMimeForPasting(t.type)){r.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var r;if(e.preventDefault(),(r=g(this,lo))==null||r.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of g(this,Gn)){const s=i.serialize(!0);s&&t.push(s)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const s of t.items)for(const a of g(this,il))if(a.isHandlingMimeForPasting(s.type)){a.paste(s,this.currentLayer);return}let r=t.getData("application/pdfjs");if(!r)return;try{r=JSON.parse(r)}catch(s){Xt(`paste: "${s.message}".`);return}if(!Array.isArray(r))return;this.unselectAll();const i=this.currentLayer;try{const s=[];for(const l of r){const u=await i.deserialize(l);if(!u)return;s.push(u)}const a=()=>{for(const l of s)X(this,ot,rF).call(this,l);X(this,ot,iF).call(this,s)},o=()=>{for(const l of s)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(s){Xt(`paste: "${s.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),g(this,vi)!==Jt.NONE&&!this.isEditorHandlingKeyboard&&ly._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,g(this,ff)&&(U(this,ff,!1),X(this,ot,W_).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(X(this,ot,XQ).call(this),X(this,ot,QQ).call(this),X(this,ot,ca).call(this,{isEditing:g(this,vi)!==Jt.NONE,isEmpty:X(this,ot,X_).call(this),hasSomethingToUndo:g(this,rl).hasSomethingToUndo(),hasSomethingToRedo:g(this,rl).hasSomethingToRedo(),hasSelectedEditor:!1})):(X(this,ot,KQ).call(this),X(this,ot,ZQ).call(this),X(this,ot,ca).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!g(this,il)){U(this,il,e);for(const t of g(this,il))X(this,ot,Kc).call(this,t.defaultPropertiesToUpdate)}}getId(){return g(this,u2).id}get currentLayer(){return g(this,Ci).get(g(this,By))}getLayer(e){return g(this,Ci).get(e)}get currentPageIndex(){return g(this,By)}addLayer(e){g(this,Ci).set(e.pageIndex,e),g(this,pf)?e.enable():e.disable()}removeLayer(e){g(this,Ci).delete(e.pageIndex)}async updateMode(e,t=null,r=!1,i=!1,s=!1){var a,o,l,u,c,h;if(g(this,vi)!==e&&!(g(this,sl)&&(await g(this,sl).promise,!g(this,sl)))){if(U(this,sl,Promise.withResolvers()),(a=g(this,cf))==null||a.commitOrRemove(),g(this,vi)===Jt.POPUP&&((o=g(this,Hs))==null||o.hideSidebar()),(l=g(this,Hs))==null||l.destroyPopup(),U(this,vi,e),e===Jt.NONE){this.setEditingState(!1),X(this,ot,tZ).call(this);for(const d of g(this,Gr).values())d.hideStandaloneCommentButton();(u=this._editorUndoBar)==null||u.hide(),this.toggleComment(null),g(this,sl).resolve();return}for(const d of g(this,Gr).values())d.addStandaloneCommentButton();e===Jt.SIGNATURE&&await((c=g(this,vf))==null?void 0:c.loadSignatures()),this.setEditingState(!0),await X(this,ot,eZ).call(this),this.unselectAll();for(const d of g(this,Ci).values())d.updateMode(e);if(e===Jt.POPUP){g(this,Ly)||U(this,Ly,await g(this,Hy).getAnnotationsByType(new Set(g(this,il).map(p=>p._editorType))));const d=new Set,f=[];for(const p of g(this,Gr).values()){const{annotationElementId:m,hasComment:y,deleted:v}=p;m&&d.add(m),y&&!v&&f.push(p.getData())}for(const p of g(this,Ly)){const{id:m,popupRef:y,contentsObj:v}=p;y&&(v!=null&&v.str)&&!d.has(m)&&!g(this,hf).has(m)&&f.push(p)}(h=g(this,Hs))==null||h.showSidebar(f)}if(!t){r&&this.addNewEditorFromKeyboard(),g(this,sl).resolve();return}for(const d of g(this,Gr).values())d.uid===t?(this.setSelected(d),s?d.editComment():i?d.enterInEditMode():d.focus()):d.unselect();g(this,sl).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==g(this,vi)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(g(this,il)){switch(e){case En.CREATE:this.currentLayer.addNewEditor(t);return;case En.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(g(this,qw)||U(this,qw,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const r of g(this,Gn))r.updateParams(e,t);else for(const r of g(this,il))r.updateDefaultParams(e,t)}}showAllEditors(e,t,r=!1){var s;for(const a of g(this,Gr).values())a.editorType===e&&a.show(t);(((s=g(this,qw))==null?void 0:s.get(En.HIGHLIGHT_SHOW_ALL))??!0)!==t&&X(this,ot,Kc).call(this,[[En.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(g(this,Gw)!==e){U(this,Gw,e);for(const t of g(this,Ci).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of g(this,Gr).values())t.pageIndex===e&&(yield t)}getEditor(e){return g(this,Gr).get(e)}addEditor(e){g(this,Gr).set(e.id,e)}removeEditor(e){var t,r;e.div.contains(document.activeElement)&&(g(this,Ou)&&clearTimeout(g(this,Ou)),U(this,Ou,setTimeout(()=>{this.focusMainContainer(),U(this,Ou,null)},0))),g(this,Gr).delete(e.id),e.annotationElementId&&((t=g(this,gf))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!g(this,hf).has(e.annotationElementId))&&((r=g(this,nl))==null||r.remove(e.id))}addDeletedAnnotationElement(e){g(this,hf).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return g(this,hf).has(e)}removeDeletedAnnotationElement(e){g(this,hf).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){g(this,lo)!==e&&(U(this,lo,e),e&&X(this,ot,Kc).call(this,e.propertiesToUpdate))}updateUI(e){g(this,ot,nZ)===e&&X(this,ot,Kc).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){X(this,ot,Kc).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(g(this,Gn).has(e)){g(this,Gn).delete(e),e.unselect(),X(this,ot,ca).call(this,{hasSelectedEditor:this.hasSelection});return}g(this,Gn).add(e),e.select(),X(this,ot,Kc).call(this,e.propertiesToUpdate),X(this,ot,ca).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.uid}),(t=g(this,cf))==null||t.commitOrRemove();for(const r of g(this,Gn))r!==e&&r.unselect();g(this,Gn).clear(),g(this,Gn).add(e),e.select(),X(this,ot,Kc).call(this,e.propertiesToUpdate),X(this,ot,ca).call(this,{hasSelectedEditor:!0})}isSelected(e){return g(this,Gn).has(e)}get firstSelectedEditor(){return g(this,Gn).values().next().value}unselect(e){e.unselect(),g(this,Gn).delete(e),X(this,ot,ca).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return g(this,Gn).size!==0}get isEnterHandled(){return g(this,Gn).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;g(this,rl).undo(),X(this,ot,ca).call(this,{hasSomethingToUndo:g(this,rl).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:X(this,ot,X_).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){g(this,rl).redo(),X(this,ot,ca).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:g(this,rl).hasSomethingToRedo(),isEmpty:X(this,ot,X_).call(this)})}addCommands(e){g(this,rl).add(e),X(this,ot,ca).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:X(this,ot,X_).call(this)})}cleanUndoStack(e){g(this,rl).cleanType(e)}delete(){var s;this.commitOrRemove();const e=(s=this.currentLayer)==null?void 0:s.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...g(this,Gn)],r=()=>{var a;(a=this._editorUndoBar)==null||a.show(i,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},i=()=>{for(const a of t)X(this,ot,rF).call(this,a)};this.addCommands({cmd:r,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=g(this,lo))==null||e.commitOrRemove()}hasSomethingToControl(){return g(this,lo)||this.hasSelection}selectAll(){for(const e of g(this,Gn))e.commit();X(this,ot,iF).call(this,g(this,Gr).values())}unselectAll(){var e;if(!(g(this,lo)&&(g(this,lo).commitOrRemove(),g(this,vi)!==Jt.NONE))&&!((e=g(this,cf))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of g(this,Gn))t.unselect();g(this,Gn).clear(),X(this,ot,ca).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,r=!1){if(r||this.commitOrRemove(),!this.hasSelection)return;g(this,xf)[0]+=e,g(this,xf)[1]+=t;const[i,s]=g(this,xf),a=[...g(this,Gn)],o=1e3;g(this,Bu)&&clearTimeout(g(this,Bu)),U(this,Bu,setTimeout(()=>{U(this,Bu,null),g(this,xf)[0]=g(this,xf)[1]=0,this.addCommands({cmd:()=>{for(const l of a)g(this,Gr).has(l.id)&&(l.translateInPage(i,s),l.translationDone())},undo:()=>{for(const l of a)g(this,Gr).has(l.id)&&(l.translateInPage(-i,-s),l.translationDone())},mustExec:!1})},o));for(const l of a)l.translateInPage(e,t),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),U(this,Lu,new Map);for(const e of g(this,Gn))g(this,Lu).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!g(this,Lu))return!1;this.disableUserSelect(!1);const e=g(this,Lu);U(this,Lu,null);let t=!1;for(const[{x:i,y:s,pageIndex:a},o]of e)o.newX=i,o.newY=s,o.newPageIndex=a,t||(t=i!==o.savedX||s!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const r=(i,s,a,o)=>{if(g(this,Gr).has(i.id)){const l=g(this,Ci).get(o);l?i._setParentAndPosition(l,s,a):(i.pageIndex=o,i.x=s,i.y=a)}};return this.addCommands({cmd:()=>{for(const[i,{newX:s,newY:a,newPageIndex:o}]of e)r(i,s,a,o)},undo:()=>{for(const[i,{savedX:s,savedY:a,savedPageIndex:o}]of e)r(i,s,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(g(this,Lu))for(const r of g(this,Lu).keys())r.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||g(this,Gn).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return g(this,lo)===e}getActive(){return g(this,lo)}getMode(){return g(this,vi)}isEditingMode(){return g(this,vi)!==Jt.NONE}get imageManager(){return Kt(this,"imageManager",new J3)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,c=t.rangeCount;u<c;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:r,y:i,width:s,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(u,c,h,d)=>({x:(c-i)/a,y:1-(u+h-r)/s,width:d/a,height:h/s});break;case"180":o=(u,c,h,d)=>({x:1-(u+h-r)/s,y:1-(c+d-i)/a,width:h/s,height:d/a});break;case"270":o=(u,c,h,d)=>({x:1-(c+d-i)/a,y:(u-r)/s,width:d/a,height:h/s});break;default:o=(u,c,h,d)=>({x:(u-r)/s,y:(c-i)/a,width:h/s,height:d/a});break}const l=[];for(let u=0,c=t.rangeCount;u<c;u++){const h=t.getRangeAt(u);if(!h.collapsed)for(const{x:d,y:f,width:p,height:m}of h.getClientRects())p===0||m===0||l.push(o(d,f,p,m))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(g(this,ky)||U(this,ky,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=g(this,ky))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=g(this,ky))==null?void 0:i.get(e.data.id);if(!t)return;const r=g(this,nl).getRawValue(t);r&&(g(this,vi)===Jt.NONE&&!r.hasBeenModified||r.renderAnnotationElement(e))}setMissingCanvas(e,t,r){var s;const i=(s=g(this,gf))==null?void 0:s.get(e);i&&(i.setCanvas(t,r),g(this,gf).delete(e))}addMissingCanvas(e,t){(g(this,gf)||U(this,gf,new Map)).set(e,t)}};Fy=new WeakMap,lo=new WeakMap,Ly=new WeakMap,Gr=new WeakMap,Ci=new WeakMap,Oy=new WeakMap,nl=new WeakMap,ky=new WeakMap,rl=new WeakMap,Hs=new WeakMap,uf=new WeakMap,cf=new WeakMap,By=new WeakMap,hf=new WeakMap,Lu=new WeakMap,il=new WeakMap,Km=new WeakMap,zw=new WeakMap,$w=new WeakMap,Uy=new WeakMap,Hw=new WeakMap,Ou=new WeakMap,df=new WeakMap,Vy=new WeakMap,ff=new WeakMap,ku=new WeakMap,u2=new WeakMap,pf=new WeakMap,zy=new WeakMap,Gw=new WeakMap,mf=new WeakMap,Ym=new WeakMap,$y=new WeakMap,gf=new WeakMap,jw=new WeakMap,vi=new WeakMap,Gn=new WeakMap,rh=new WeakMap,vf=new WeakMap,yf=new WeakMap,qw=new WeakMap,Hy=new WeakMap,Ww=new WeakMap,xf=new WeakMap,Bu=new WeakMap,ih=new WeakMap,Xw=new WeakMap,Kw=new WeakMap,sl=new WeakMap,ot=new WeakSet,TM=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},tF=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const r of g(this,Ci).values())if(r.hasTextLayer(e))return r;return null},jQ=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const r=X(this,ot,TM).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(r);i&&(g(this,ku)||U(this,ku,new i0e(this)),g(this,ku).show(r,i,this.direction==="ltr"))},qQ=function(){var s,a,o;const e=document.getSelection();if(!e||e.isCollapsed){g(this,rh)&&((s=g(this,ku))==null||s.hide(),U(this,rh,null),X(this,ot,ca).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===g(this,rh))return;const i=X(this,ot,TM).call(this,e).closest(".textLayer");if(!i){g(this,rh)&&((a=g(this,ku))==null||a.hide(),U(this,rh,null),X(this,ot,ca).call(this,{hasSelectedText:!1}));return}if((o=g(this,ku))==null||o.hide(),U(this,rh,t),X(this,ot,ca).call(this,{hasSelectedText:!0}),!(g(this,vi)!==Jt.HIGHLIGHT&&g(this,vi)!==Jt.NONE)&&(g(this,vi)===Jt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),U(this,ff,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=g(this,vi)===Jt.HIGHLIGHT?X(this,ot,tF).call(this,i):null;if(l==null||l.toggleDrawing(),g(this,zy)){const u=new AbortController,c=this.combinedSignal(u),h=d=>{d.type==="pointerup"&&d.button!==0||(u.abort(),l==null||l.toggleDrawing(!0),d.type==="pointerup"&&X(this,ot,W_).call(this,"main_toolbar"))};window.addEventListener("pointerup",h,{signal:c}),window.addEventListener("blur",h,{signal:c})}else l==null||l.toggleDrawing(!0),X(this,ot,W_).call(this,"main_toolbar")}},W_=function(e=""){g(this,vi)===Jt.HIGHLIGHT?this.highlightSelection(e):g(this,zw)&&X(this,ot,jQ).call(this)},WQ=function(){document.addEventListener("selectionchange",X(this,ot,qQ).bind(this),{signal:this._signal})},XQ=function(){if(g(this,df))return;U(this,df,new AbortController);const e=this.combinedSignal(g(this,df));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},KQ=function(){var e;(e=g(this,df))==null||e.abort(),U(this,df,null)},nF=function(){if(g(this,mf))return;U(this,mf,new AbortController);const e=this.combinedSignal(g(this,mf));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},YQ=function(){var e;(e=g(this,mf))==null||e.abort(),U(this,mf,null)},QQ=function(){if(g(this,uf))return;U(this,uf,new AbortController);const e=this.combinedSignal(g(this,uf));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},ZQ=function(){var e;(e=g(this,uf))==null||e.abort(),U(this,uf,null)},JQ=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},ca=function(e){Object.entries(e).some(([r,i])=>g(this,Ww)[r]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(g(this,Ww),e)}),g(this,vi)===Jt.HIGHLIGHT&&e.hasSelectedEditor===!1&&X(this,ot,Kc).call(this,[[En.HIGHLIGHT_FREE,!0]]))},Kc=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},eZ=async function(){if(!g(this,pf)){U(this,pf,!0);const e=[];for(const t of g(this,Ci).values())e.push(t.enable());await Promise.all(e);for(const t of g(this,Gr).values())t.enable()}},tZ=function(){if(this.unselectAll(),g(this,pf)){U(this,pf,!1);for(const e of g(this,Ci).values())e.disable();for(const e of g(this,Gr).values())e.disable()}},rF=function(e){const t=g(this,Ci).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},nZ=function(){let e=null;for(e of g(this,Gn));return e},X_=function(){if(g(this,Gr).size===0)return!0;if(g(this,Gr).size===1)for(const e of g(this,Gr).values())return e.isEmpty();return!1},iF=function(e){for(const t of g(this,Gn))t.unselect();g(this,Gn).clear();for(const t of e)t.isEmpty()||(g(this,Gn).add(t),t.select());X(this,ot,ca).call(this,{hasSelectedEditor:this.hasSelection})},Qe(ly,"TRANSLATE_SMALL",1),Qe(ly,"TRANSLATE_BIG",10);let Sv=ly;var Ki,Uu,Gl,Gy,Vu,uo,jy,zu,Oa,sh,Qm,$u,bf,uu,K_,MM;const da=class da{constructor(e){j(this,uu);j(this,Ki,null);j(this,Uu,!1);j(this,Gl,null);j(this,Gy,null);j(this,Vu,null);j(this,uo,null);j(this,jy,!1);j(this,zu,null);j(this,Oa,null);j(this,sh,null);j(this,Qm,null);j(this,$u,!1);U(this,Oa,e),U(this,$u,e._uiManager.useNewAltTextFlow),g(da,bf)||U(da,bf,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){da._l10n??(da._l10n=e)}async render(){const e=U(this,Gl,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=U(this,Gy,document.createElement("span"));e.append(t),g(this,$u)?(e.classList.add("new"),e.setAttribute("data-l10n-id",g(da,bf).missing),t.setAttribute("data-l10n-id",g(da,bf)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const r=g(this,Oa)._uiManager._signal;e.addEventListener("contextmenu",Cl,{signal:r}),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:r});const i=s=>{s.preventDefault(),g(this,Oa)._uiManager.editAltText(g(this,Oa)),g(this,$u)&&g(this,Oa)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:g(this,uu,K_)}})};return e.addEventListener("click",i,{capture:!0,signal:r}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(U(this,jy,!0),i(s))},{signal:r}),await X(this,uu,MM).call(this),e}finish(){g(this,Gl)&&(g(this,Gl).focus({focusVisible:g(this,jy)}),U(this,jy,!1))}isEmpty(){return g(this,$u)?g(this,Ki)===null:!g(this,Ki)&&!g(this,Uu)}hasData(){return g(this,$u)?g(this,Ki)!==null||!!g(this,sh):this.isEmpty()}get guessedText(){return g(this,sh)}async setGuessedText(e){g(this,Ki)===null&&(U(this,sh,e),U(this,Qm,await da._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),X(this,uu,MM).call(this))}toggleAltTextBadge(e=!1){var t;if(!g(this,$u)||g(this,Ki)){(t=g(this,zu))==null||t.remove(),U(this,zu,null);return}if(!g(this,zu)){const r=U(this,zu,document.createElement("div"));r.className="noAltTextBadge",g(this,Oa).div.append(r)}g(this,zu).classList.toggle("hidden",!e)}serialize(e){let t=g(this,Ki);return!e&&g(this,sh)===t&&(t=g(this,Qm)),{altText:t,decorative:g(this,Uu),guessedText:g(this,sh),textWithDisclaimer:g(this,Qm)}}get data(){return{altText:g(this,Ki),decorative:g(this,Uu)}}set data({altText:e,decorative:t,guessedText:r,textWithDisclaimer:i,cancel:s=!1}){r&&(U(this,sh,r),U(this,Qm,i)),!(g(this,Ki)===e&&g(this,Uu)===t)&&(s||(U(this,Ki,e),U(this,Uu,t)),X(this,uu,MM).call(this))}toggle(e=!1){g(this,Gl)&&(!e&&g(this,uo)&&(clearTimeout(g(this,uo)),U(this,uo,null)),g(this,Gl).disabled=!e)}shown(){g(this,Oa)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:g(this,uu,K_)}})}destroy(){var e,t;(e=g(this,Gl))==null||e.remove(),U(this,Gl,null),U(this,Gy,null),U(this,Vu,null),(t=g(this,zu))==null||t.remove(),U(this,zu,null)}};Ki=new WeakMap,Uu=new WeakMap,Gl=new WeakMap,Gy=new WeakMap,Vu=new WeakMap,uo=new WeakMap,jy=new WeakMap,zu=new WeakMap,Oa=new WeakMap,sh=new WeakMap,Qm=new WeakMap,$u=new WeakMap,bf=new WeakMap,uu=new WeakSet,K_=function(){return g(this,Ki)&&"added"||g(this,Ki)===null&&this.guessedText&&"review"||"missing"},MM=async function(){var i,s,a;const e=g(this,Gl);if(!e)return;if(g(this,$u)){if(e.classList.toggle("done",!!g(this,Ki)),e.setAttribute("data-l10n-id",g(da,bf)[g(this,uu,K_)]),(i=g(this,Gy))==null||i.setAttribute("data-l10n-id",g(da,bf)[`${g(this,uu,K_)}-label`]),!g(this,Ki)){(s=g(this,Vu))==null||s.remove();return}}else{if(!g(this,Ki)&&!g(this,Uu)){e.classList.remove("done"),(a=g(this,Vu))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=g(this,Vu);if(!t){U(this,Vu,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${g(this,Oa).id}`;const o=100,l=g(this,Oa)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(g(this,uo)),U(this,uo,null)},{once:!0}),e.addEventListener("mouseenter",()=>{U(this,uo,setTimeout(()=>{U(this,uo,null),g(this,Vu).classList.add("show"),g(this,Oa)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),e.addEventListener("mouseleave",()=>{var u;g(this,uo)&&(clearTimeout(g(this,uo)),U(this,uo,null)),(u=g(this,Vu))==null||u.classList.remove("show")},{signal:l})}g(this,Uu)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=g(this,Ki)),t.parentNode||e.append(t);const r=g(this,Oa).getElementForAltText();r==null||r.setAttribute("aria-describedby",t.id)},j(da,bf,null),Qe(da,"_l10n",null);let aD=da;var hs,al,Zm,vr,Yw,Jm,jl,eg,tg,ng,Qw,sF;class QA{constructor(e){j(this,Qw);j(this,hs,null);j(this,al,null);j(this,Zm,!1);j(this,vr,null);j(this,Yw,null);j(this,Jm,null);j(this,jl,null);j(this,eg,null);j(this,tg,!1);j(this,ng,null);U(this,vr,e)}renderForToolbar(){const e=U(this,al,document.createElement("button"));return e.className="comment",X(this,Qw,sF).call(this,e,!1)}renderForStandalone(){const e=U(this,hs,document.createElement("button"));e.className="annotationCommentButton";const t=g(this,vr).commentButtonPosition;if(t){const{style:r}=e;r.insetInlineEnd=`calc(${100*(g(this,vr)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,r.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const i=g(this,vr).commentButtonColor;i&&(r.backgroundColor=i)}return X(this,Qw,sF).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=g(this,hs)??g(this,al))==null||e.focus()},0)}onUpdatedColor(){if(!g(this,hs))return;const e=g(this,vr).commentButtonColor;e&&(g(this,hs).style.backgroundColor=e),g(this,vr)._uiManager.updatePopupColor(g(this,vr))}get commentButtonWidth(){var e;return(((e=g(this,hs))==null?void 0:e.getBoundingClientRect().width)??0)/g(this,vr).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(g(this,ng))return g(this,ng);if(!g(this,hs))return null;const{x:e,y:t,height:r}=g(this,hs).getBoundingClientRect(),{x:i,y:s,width:a,height:o}=g(this,vr).parent.boundingClientRect;return[(e-i)/a,(t+r-s)/o]}set commentPopupPositionInLayer(e){U(this,ng,e)}hasDefaultPopupPosition(){return g(this,ng)===null}removeStandaloneCommentButton(){var e;(e=g(this,hs))==null||e.remove(),U(this,hs,null)}removeToolbarCommentButton(){var e;(e=g(this,al))==null||e.remove(),U(this,al,null)}setCommentButtonStates({selected:e,hasPopup:t}){g(this,hs)&&(g(this,hs).classList.toggle("selected",e),g(this,hs).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let r,i;if(t)[r,i]=t;else{[r,i]=g(this,vr).commentButtonPosition;const{width:c,height:h,x:d,y:f}=g(this,vr);r=d+r*c,i=f+i*h}const s=g(this,vr).parent.boundingClientRect,{x:a,y:o,width:l,height:u}=s;g(this,vr)._uiManager.editComment(g(this,vr),a+r*l,o+i*u,{...e,parentDimensions:s})}finish(){g(this,al)&&(g(this,al).focus({focusVisible:g(this,Zm)}),U(this,Zm,!1))}isDeleted(){return g(this,tg)||g(this,jl)===""}isEmpty(){return g(this,jl)===null}hasBeenEdited(){return this.isDeleted()||g(this,jl)!==g(this,Yw)}serialize(){return this.data}get data(){return{text:g(this,jl),richText:g(this,Jm),date:g(this,eg),deleted:this.isDeleted()}}set data(e){if(e!==g(this,jl)&&U(this,Jm,null),e===null){U(this,jl,""),U(this,tg,!0);return}U(this,jl,e),U(this,eg,new Date),U(this,tg,!1)}setInitialText(e,t=null){U(this,Yw,e),this.data=e,U(this,eg,null),U(this,Jm,t)}shown(){}destroy(){var e,t;(e=g(this,al))==null||e.remove(),U(this,al,null),(t=g(this,hs))==null||t.remove(),U(this,hs,null),U(this,jl,""),U(this,Jm,null),U(this,eg,null),U(this,vr,null),U(this,Zm,!1),U(this,tg,!1)}}hs=new WeakMap,al=new WeakMap,Zm=new WeakMap,vr=new WeakMap,Yw=new WeakMap,Jm=new WeakMap,jl=new WeakMap,eg=new WeakMap,tg=new WeakMap,ng=new WeakMap,Qw=new WeakSet,sF=function(e,t){if(!g(this,vr)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[g(this,vr)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const r=g(this,vr)._uiManager._signal;if(!(r instanceof AbortSignal)||r.aborted)return e;e.addEventListener("contextmenu",Cl,{signal:r}),t&&(e.addEventListener("focusin",s=>{g(this,vr)._focusEventsAllowed=!1,Qr(s)},{capture:!0,signal:r}),e.addEventListener("focusout",s=>{g(this,vr)._focusEventsAllowed=!0,Qr(s)},{capture:!0,signal:r})),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:r});const i=s=>{s.preventDefault(),e===g(this,al)?this.edit():g(this,vr).toggleComment(!0)};return e.addEventListener("click",i,{capture:!0,signal:r}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(U(this,Zm,!0),i(s))},{signal:r}),e.addEventListener("pointerenter",()=>{g(this,vr).toggleComment(!1,!0)},{signal:r}),e.addEventListener("pointerleave",()=>{g(this,vr).toggleComment(!1,!1)},{signal:r}),e};var qy,rg,Zw,Jw,eE,tE,nE,ah,ig,oh,sg,lh,kp,rZ,iZ,sZ;const UU=class UU{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:r=null,onPinchStart:i=null,onPinching:s=null,onPinchEnd:a=null,signal:o}){j(this,kp);j(this,qy);j(this,rg,!1);j(this,Zw,null);j(this,Jw);j(this,eE);j(this,tE);j(this,nE);j(this,ah,null);j(this,ig);j(this,oh,null);j(this,sg);j(this,lh,null);U(this,qy,e),U(this,Zw,r),U(this,Jw,t),U(this,eE,i),U(this,tE,s),U(this,nE,a),U(this,sg,new AbortController),U(this,ig,AbortSignal.any([o,g(this,sg).signal])),e.addEventListener("touchstart",X(this,kp,rZ).bind(this),{passive:!1,signal:g(this,ig)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ec.pixelRatio}destroy(){var e,t;(e=g(this,sg))==null||e.abort(),U(this,sg,null),(t=g(this,ah))==null||t.abort(),U(this,ah,null)}};qy=new WeakMap,rg=new WeakMap,Zw=new WeakMap,Jw=new WeakMap,eE=new WeakMap,tE=new WeakMap,nE=new WeakMap,ah=new WeakMap,ig=new WeakMap,oh=new WeakMap,sg=new WeakMap,lh=new WeakMap,kp=new WeakSet,rZ=function(e){var i,s,a;if((i=g(this,Jw))!=null&&i.call(this))return;if(e.touches.length===1){if(g(this,ah))return;const o=U(this,ah,new AbortController),l=AbortSignal.any([g(this,ig),o.signal]),u=g(this,qy),c={capture:!0,signal:l,passive:!1},h=d=>{var f;d.pointerType==="touch"&&((f=g(this,ah))==null||f.abort(),U(this,ah,null))};u.addEventListener("pointerdown",d=>{d.pointerType==="touch"&&(Qr(d),h(d))},c),u.addEventListener("pointerup",h,c),u.addEventListener("pointercancel",h,c);return}if(!g(this,lh)){U(this,lh,new AbortController);const o=AbortSignal.any([g(this,ig),g(this,lh).signal]),l=g(this,qy),u={signal:o,capture:!1,passive:!1};l.addEventListener("touchmove",X(this,kp,iZ).bind(this),u);const c=X(this,kp,sZ).bind(this);l.addEventListener("touchend",c,u),l.addEventListener("touchcancel",c,u),u.capture=!0,l.addEventListener("pointerdown",Qr,u),l.addEventListener("pointermove",Qr,u),l.addEventListener("pointercancel",Qr,u),l.addEventListener("pointerup",Qr,u),(s=g(this,eE))==null||s.call(this)}if(Qr(e),e.touches.length!==2||(a=g(this,Zw))!=null&&a.call(this)){U(this,oh,null);return}let[t,r]=e.touches;t.identifier>r.identifier&&([t,r]=[r,t]),U(this,oh,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:r.screenX,touch1Y:r.screenY})},iZ=function(e){var w;if(!g(this,oh)||e.touches.length!==2)return;Qr(e);let[t,r]=e.touches;t.identifier>r.identifier&&([t,r]=[r,t]);const{screenX:i,screenY:s}=t,{screenX:a,screenY:o}=r,l=g(this,oh),{touch0X:u,touch0Y:c,touch1X:h,touch1Y:d}=l,f=h-u,p=d-c,m=a-i,y=o-s,v=Math.hypot(m,y)||1,b=Math.hypot(f,p)||1;if(!g(this,rg)&&Math.abs(b-v)<=UU.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=i,l.touch0Y=s,l.touch1X=a,l.touch1Y=o,!g(this,rg)){U(this,rg,!0);return}const x=[(i+a)/2,(s+o)/2];(w=g(this,tE))==null||w.call(this,x,b,v)},sZ=function(e){var t;e.touches.length>=2||(g(this,lh)&&(g(this,lh).abort(),U(this,lh,null),(t=g(this,nE))==null||t.call(this)),g(this,oh)&&(Qr(e),U(this,oh,null),U(this,rg,!1)))};let oD=UU;var ag,ql,Cr,ur,uh,Wy,_f,rE,ds,og,ch,ol,wf,iE,lg,co,sE,ug,hh,Hu,Xy,Ky,ll,cg,aE,c2,Rt,aF,oE,oF,CM,aZ,oZ,lF,DM,uF,lZ,uZ,cZ,cF,hZ,hF,dZ,fZ,pZ,dF,Y_;const Zt=class Zt{constructor(e){j(this,Rt);j(this,ag,null);j(this,ql,null);j(this,Cr,null);j(this,ur,null);j(this,uh,null);j(this,Wy,!1);j(this,_f,null);j(this,rE,"");j(this,ds,null);j(this,og,null);j(this,ch,null);j(this,ol,null);j(this,wf,null);j(this,iE,"");j(this,lg,!1);j(this,co,null);j(this,sE,!1);j(this,ug,!1);j(this,hh,!1);j(this,Hu,null);j(this,Xy,0);j(this,Ky,0);j(this,ll,null);j(this,cg,null);Qe(this,"isSelected",!1);Qe(this,"_isCopy",!1);Qe(this,"_editToolbar",null);Qe(this,"_initialOptions",Object.create(null));Qe(this,"_initialData",null);Qe(this,"_isVisible",!0);Qe(this,"_uiManager",null);Qe(this,"_focusEventsAllowed",!0);j(this,aE,!1);j(this,c2,Zt._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:r,pageHeight:i,pageX:s,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[r,i],this.pageTranslation=[s,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Zt.prototype._resizeWithKeyboard,t=Sv.TRANSLATE_SMALL,r=Sv.TRANSLATE_BIG;return Kt(this,"_resizerKeyboardManager",new WS([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-r,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[r,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-r]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,r]}],[["Escape","mac+Escape"],Zt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Kt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new o0e({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Zt._l10n??(Zt._l10n=e),Zt._l10nResizer||(Zt._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Zt._borderLineWidth!==-1)return;const r=getComputedStyle(document.documentElement);Zt._borderLineWidth=parseFloat(r.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){fr("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return g(this,aE)}set _isDraggable(e){var t;U(this,aE,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=g(this,c2)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(X(this,Rt,Y_).call(this),(t=g(this,ol))==null||t.remove(),U(this,ol,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(g(this,lg)?U(this,lg,!1):this.parent.setSelected(this))}focusout(e){var r;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(r=this.parent)!=null&&r.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,r,i){const[s,a]=this.parentDimensions;[r,i]=this.screenToPageTranslation(r,i),this.x=(e+r)/s,this.y=(t+i)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[r,i]=this.parentDimensions;this.setAt(e*r,t*i,this.width*r,this.height*i),this._onTranslated()}translate(e,t){X(this,Rt,aF).call(this,this.parentDimensions,e,t)}translateInPage(e,t){g(this,co)||U(this,co,[this.x,this.y,this.width,this.height]),X(this,Rt,aF).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){g(this,co)||U(this,co,[this.x,this.y,this.width,this.height]);const{div:r,parentDimensions:[i,s]}=this;if(this.x+=e/i,this.y+=t/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:h,y:d}=this.div.getBoundingClientRect();this.parent.findNewParent(this,h,d)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,u]=this.getBaseTranslation();a+=l,o+=u;const{style:c}=r;c.left=`${(100*a).toFixed(2)}%`,c.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),r.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!g(this,co)&&(g(this,co)[0]!==this.x||g(this,co)[1]!==this.y)}get _hasBeenResized(){return!!g(this,co)&&(g(this,co)[2]!==this.width||g(this,co)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:r}=Zt,i=r/e,s=r/t;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[r,i]}=this;let{x:s,y:a,width:o,height:l}=this;if(o*=r,l*=i,s*=r,a*=i,this._mustFixPosition)switch(e){case 0:s=va(s,0,r-o),a=va(a,0,i-l);break;case 90:s=va(s,0,r-l),a=va(a,o,i);break;case 180:s=va(s,o,r),a=va(a,l,i);break;case 270:s=va(s,l,r),a=va(a,0,i-o);break}this.x=s/=r,this.y=a/=i;const[u,c]=this.getBaseTranslation();s+=u,a+=c,t.left=`${(100*s).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var r;return X(r=Zt,oE,oF).call(r,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var r;return X(r=Zt,oE,oF).call(r,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,r]}=this;return[t*e,r*e]}setDims(){const{div:{style:e},width:t,height:r}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*r).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=g(this,Cr))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||g(this,ug))return this._editToolbar;this._editToolbar=new Q3(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,r]of e)await this._editToolbar.addButton(t,r);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=g(this,Cr))==null||t.destroy()}addContainer(e){var r;const t=(r=this._editToolbar)==null?void 0:r.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return g(this,Cr)||(aD.initialize(Zt._l10n),U(this,Cr,new aD(this)),g(this,ag)&&(g(this,Cr).data=g(this,ag),U(this,ag,null))),g(this,Cr)}get altTextData(){var e;return(e=g(this,Cr))==null?void 0:e.data}set altTextData(e){g(this,Cr)&&(g(this,Cr).data=e)}get guessedAltText(){var e;return(e=g(this,Cr))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=g(this,Cr))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=g(this,Cr))==null?void 0:t.serialize(e)}hasAltText(){return!!g(this,Cr)&&!g(this,Cr).isEmpty()}hasAltTextData(){var e;return((e=g(this,Cr))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=g(this,ur))==null||e.focusButton()}addCommentButton(){return this.canAddComment?g(this,ur)||U(this,ur,new QA(this)):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(g(this,uh)){this._uiManager.isEditingMode()&&g(this,uh).classList.remove("hidden");return}this.hasComment&&(U(this,uh,g(this,ur).renderForStandalone()),this.div.append(g(this,uh)))}}removeStandaloneCommentButton(){g(this,ur).removeStandaloneCommentButton(),U(this,uh,null)}hideStandaloneCommentButton(){var e;(e=g(this,uh))==null||e.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:r,deleted:i}}=g(this,ur);return{text:t,richText:e,date:r,deleted:i,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){g(this,ur)||U(this,ur,new QA(this)),g(this,ur).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:r}){if(!t||(g(this,ur)||U(this,ur,new QA(this)),g(this,ur).setInitialText(e,r),!this.annotationElementId))return;const i=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);i&&this.updateFromAnnotationLayer(i)}get hasEditedComment(){var e;return(e=g(this,ur))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=g(this,ur))==null?void 0:e.isDeleted()}get hasComment(){return!!g(this,ur)&&!g(this,ur).isEmpty()&&!g(this,ur).isDeleted()}async editComment(e){g(this,ur)||U(this,ur,new QA(this)),g(this,ur).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){g(this,ur).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,i]=e.rect,[s]=this.pageDimensions,[a]=this.pageTranslation,o=a+s+1,l=i-100,u=o+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[o,l,u,i]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){g(this,ur).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var a;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=g(this,Wy)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),X(this,Rt,hF).call(this);const[t,r]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*r/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/r).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),HQ(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(g(this,cg)||U(this,cg,new oD({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:X(this,Rt,lZ).bind(this),onPinching:X(this,Rt,uZ).bind(this),onPinchEnd:X(this,Rt,cZ).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(a=this._uiManager._editorUndoBar)==null||a.hide(),e}pointerdown(e){const{isMac:t}=Cs.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(U(this,lg,!0),this._isDraggable){X(this,Rt,hZ).call(this,e);return}X(this,Rt,cF).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){g(this,Hu)&&clearTimeout(g(this,Hu)),U(this,Hu,setTimeout(()=>{var e;U(this,Hu,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,r){e.changeParent(this),this.x=t,this.y=r,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,r=this.rotation){const i=this.parentScale,[s,a]=this.pageDimensions,[o,l]=this.pageTranslation,u=e/i,c=t/i,h=this.x*s,d=this.y*a,f=this.width*s,p=this.height*a;switch(r){case 0:return[h+u+o,a-d-c-p+l,h+u+f+o,a-d-c+l];case 90:return[h+c+o,a-d+u+l,h+c+p+o,a-d+u+f+l];case 180:return[h-u-f+o,a-d+c+l,h-u+o,a-d+c+p+l];case 270:return[h-c-p+o,a-d-u-f+l,h-c+o,a-d-u+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[r,i,s,a]=e,o=s-r,l=a-i;switch(this.rotation){case 0:return[r,t-a,o,l];case 90:return[r,t-i,l,o];case 180:return[s,t-i,o,l];case 270:return[s,t-a,l,o];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Zt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=g(this,ur))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:r,opacity:i,deleted:s,richText:a},uid:o,pageIndex:l,creationDate:u,modificationDate:c}=this;return{id:o,pageIndex:l,rect:this.getPDFRect(),richText:a,contentsObj:{str:e},creationDate:u,modificationDate:r||c,popupRef:!s,color:t,opacity:i}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),U(this,ug,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),U(this,ug,!1),!0):!1}isInEditMode(){return g(this,ug)}shouldGetKeyboardEvents(){return g(this,hh)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:r,right:i}=this.getClientDimensions(),{innerHeight:s,innerWidth:a}=window;return t<a&&i>0&&e<s&&r>0}rebuild(){X(this,Rt,hF).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var r;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((r=this._initialData)==null?void 0:r.popupRef)||""}}static async deserialize(e,t,r){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:r,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});i.rotation=e.rotation,U(i,ag,e.accessibilityData),i._isCopy=e.isCopy||!1;const[s,a]=i.pageDimensions,[o,l,u,c]=i.getRectInCurrentCoords(e.rect,a);return i.x=o/s,i.y=l/a,i.width=u/s,i.height=c/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t,r;if((e=g(this,wf))==null||e.abort(),U(this,wf,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),g(this,Hu)&&(clearTimeout(g(this,Hu)),U(this,Hu,null)),X(this,Rt,Y_).call(this),this.removeEditToolbar(),g(this,ll)){for(const i of g(this,ll).values())clearTimeout(i);U(this,ll,null)}this.parent=null,(t=g(this,cg))==null||t.destroy(),U(this,cg,null),(r=g(this,ol))==null||r.remove(),U(this,ol,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(X(this,Rt,aZ).call(this),g(this,ds).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[r,i,s,a]=this.getPDFRect();return[Zt._round(r+(s-r)*e),Zt._round(i+(a-i)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return g(this,ur).commentPopupPositionInLayer}set commentPopupPosition(e){g(this,ur).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return g(this,ur).hasDefaultPopupPosition()}get commentButtonWidth(){return g(this,ur).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){var t;(t=g(this,ur))==null||t.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),U(this,ch,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=g(this,ds).children;if(!g(this,ql)){U(this,ql,Array.from(t));const a=X(this,Rt,dZ).bind(this),o=X(this,Rt,fZ).bind(this),l=this._uiManager._signal;for(const u of g(this,ql)){const c=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",a,{signal:l}),u.addEventListener("blur",o,{signal:l}),u.addEventListener("focus",X(this,Rt,pZ).bind(this,c),{signal:l}),u.setAttribute("data-l10n-id",Zt._l10nResizer[c])}}const r=g(this,ql)[0];let i=0;for(const a of t){if(a===r)break;i++}const s=(360-this.rotation+this.parentRotation)%360/90*(g(this,ql).length/4);if(s!==i){if(s<i)for(let o=0;o<i-s;o++)g(this,ds).append(g(this,ds).firstElementChild);else if(s>i)for(let o=0;o<s-i;o++)g(this,ds).firstElementChild.before(g(this,ds).lastElementChild);let a=0;for(const o of t){const u=g(this,ql)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",Zt._l10nResizer[u])}}X(this,Rt,dF).call(this,0),U(this,hh,!0),g(this,ds).firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){g(this,hh)&&X(this,Rt,uF).call(this,g(this,iE),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){X(this,Rt,Y_).call(this),this.div.focus()}select(){var e,t,r;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,s;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((s=this._editToolbar)==null||s.show())});return}(t=this._editToolbar)==null||t.show(),(r=g(this,Cr))==null||r.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,r,i,s;this.isSelected&&(this.isSelected=!1,(e=g(this,ds))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(r=this.div)!=null&&r.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(s=g(this,Cr))==null||s.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return g(this,sE)}set isEditing(e){U(this,sE,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){g(this,ll)||U(this,ll,new Map);const{action:r}=e;let i=g(this,ll).get(r);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),g(this,ll).delete(r),g(this,ll).size===0&&U(this,ll,null)},Zt._telemetryTimeout),g(this,ll).set(r,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),U(this,Wy,!1)}disable(){this.div&&(this.div.tabIndex=-1),U(this,Wy,!0)}updateFakeAnnotationElement(e){if(!g(this,ol)&&!this.deleted){U(this,ol,e.addFakeAnnotation(this));return}if(this.deleted){g(this,ol).remove(),U(this,ol,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&g(this,ol).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const r=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),r.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};ag=new WeakMap,ql=new WeakMap,Cr=new WeakMap,ur=new WeakMap,uh=new WeakMap,Wy=new WeakMap,_f=new WeakMap,rE=new WeakMap,ds=new WeakMap,og=new WeakMap,ch=new WeakMap,ol=new WeakMap,wf=new WeakMap,iE=new WeakMap,lg=new WeakMap,co=new WeakMap,sE=new WeakMap,ug=new WeakMap,hh=new WeakMap,Hu=new WeakMap,Xy=new WeakMap,Ky=new WeakMap,ll=new WeakMap,cg=new WeakMap,aE=new WeakMap,c2=new WeakMap,Rt=new WeakSet,aF=function([e,t],r,i){[r,i]=this.screenToPageTranslation(r,i),this.x+=r/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},oE=new WeakSet,oF=function(e,t,r){switch(r){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},CM=function(e){switch(e){case 90:{const[t,r]=this.pageDimensions;return[0,-t/r,r/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,r]=this.pageDimensions;return[0,t/r,-r/t,0]}default:return[1,0,0,1]}},aZ=function(){if(g(this,ds))return;U(this,ds,document.createElement("div")),g(this,ds).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const r of e){const i=document.createElement("div");g(this,ds).append(i),i.classList.add("resizer",r),i.setAttribute("data-resizer-name",r),i.addEventListener("pointerdown",X(this,Rt,oZ).bind(this,r),{signal:t}),i.addEventListener("contextmenu",Cl,{signal:t}),i.tabIndex=-1}this.div.prepend(g(this,ds))},oZ=function(e,t){var c;t.preventDefault();const{isMac:r}=Cs.platform;if(t.button!==0||t.ctrlKey&&r)return;(c=g(this,Cr))==null||c.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,U(this,og,[t.screenX,t.screenY]);const s=new AbortController,a=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",X(this,Rt,uF).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",Qr,{passive:!1,signal:a}),window.addEventListener("contextmenu",Cl,{signal:a}),U(this,ch,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var h;s.abort(),this.parent.togglePointerEvents(!0),(h=g(this,Cr))==null||h.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=o,this.div.style.cursor=l,X(this,Rt,DM).call(this)};window.addEventListener("pointerup",u,{signal:a}),window.addEventListener("blur",u,{signal:a})},lF=function(e,t,r,i){this.width=r,this.height=i,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},DM=function(){if(!g(this,ch))return;const{savedX:e,savedY:t,savedWidth:r,savedHeight:i}=g(this,ch);U(this,ch,null);const s=this.x,a=this.y,o=this.width,l=this.height;s===e&&a===t&&o===r&&l===i||this.addCommands({cmd:X(this,Rt,lF).bind(this,s,a,o,l),undo:X(this,Rt,lF).bind(this,e,t,r,i),mustExec:!0})},uF=function(e,t){const[r,i]=this.parentDimensions,s=this.x,a=this.y,o=this.width,l=this.height,u=Zt.MIN_SIZE/r,c=Zt.MIN_SIZE/i,h=X(this,Rt,CM).call(this,this.rotation),d=(I,B)=>[h[0]*I+h[2]*B,h[1]*I+h[3]*B],f=X(this,Rt,CM).call(this,360-this.rotation),p=(I,B)=>[f[0]*I+f[2]*B,f[1]*I+f[3]*B];let m,y,v=!1,b=!1;switch(e){case"topLeft":v=!0,m=(I,B)=>[0,0],y=(I,B)=>[I,B];break;case"topMiddle":m=(I,B)=>[I/2,0],y=(I,B)=>[I/2,B];break;case"topRight":v=!0,m=(I,B)=>[I,0],y=(I,B)=>[0,B];break;case"middleRight":b=!0,m=(I,B)=>[I,B/2],y=(I,B)=>[0,B/2];break;case"bottomRight":v=!0,m=(I,B)=>[I,B],y=(I,B)=>[0,0];break;case"bottomMiddle":m=(I,B)=>[I/2,B],y=(I,B)=>[I/2,0];break;case"bottomLeft":v=!0,m=(I,B)=>[0,B],y=(I,B)=>[I,0];break;case"middleLeft":b=!0,m=(I,B)=>[0,B/2],y=(I,B)=>[I,B/2];break}const x=m(o,l),w=y(o,l);let _=d(...w);const E=Zt._round(s+_[0]),A=Zt._round(a+_[1]);let T=1,S=1,M,D;if(t.fromKeyboard)({deltaX:M,deltaY:D}=t);else{const{screenX:I,screenY:B}=t,[$,H]=g(this,og);[M,D]=this.screenToPageTranslation(I-$,B-H),g(this,og)[0]=I,g(this,og)[1]=B}if([M,D]=p(M/r,D/i),v){const I=Math.hypot(o,l);T=S=Math.max(Math.min(Math.hypot(w[0]-x[0]-M,w[1]-x[1]-D)/I,1/o,1/l),u/o,c/l)}else b?T=va(Math.abs(w[0]-x[0]-M),u,1)/o:S=va(Math.abs(w[1]-x[1]-D),c,1)/l;const N=Zt._round(o*T),R=Zt._round(l*S);_=d(...y(N,R));const O=E-_[0],G=A-_[1];g(this,co)||U(this,co,[this.x,this.y,this.width,this.height]),this.width=N,this.height=R,this.x=O,this.y=G,this.setDims(),this.fixAndSetPosition(),this._onResizing()},lZ=function(){var e;U(this,ch,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=g(this,Cr))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},uZ=function(e,t,r){let s=.7*(r/t)+1-.7;if(s===1)return;const a=X(this,Rt,CM).call(this,this.rotation),o=(E,A)=>[a[0]*E+a[2]*A,a[1]*E+a[3]*A],[l,u]=this.parentDimensions,c=this.x,h=this.y,d=this.width,f=this.height,p=Zt.MIN_SIZE/l,m=Zt.MIN_SIZE/u;s=Math.max(Math.min(s,1/d,1/f),p/d,m/f);const y=Zt._round(d*s),v=Zt._round(f*s);if(y===d&&v===f)return;g(this,co)||U(this,co,[c,h,d,f]);const b=o(d/2,f/2),x=Zt._round(c+b[0]),w=Zt._round(h+b[1]),_=o(y/2,v/2);this.x=x-_[0],this.y=w-_[1],this.width=y,this.height=v,this.setDims(),this.fixAndSetPosition(),this._onResizing()},cZ=function(){var e;(e=g(this,Cr))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),X(this,Rt,DM).call(this)},cF=function(e){const{isMac:t}=Cs.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},hZ=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let r=!1;const i=new AbortController,s=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:s},o=u=>{i.abort(),U(this,_f,null),U(this,lg,!1),this._uiManager.endDragSession()||X(this,Rt,cF).call(this,u),r&&this._onStopDragging()};t&&(U(this,Xy,e.clientX),U(this,Ky,e.clientY),U(this,_f,e.pointerId),U(this,rE,e.pointerType),window.addEventListener("pointermove",u=>{r||(r=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:c,clientY:h,pointerId:d}=u;if(d!==g(this,_f)){Qr(u);return}const[f,p]=this.screenToPageTranslation(c-g(this,Xy),h-g(this,Ky));U(this,Xy,c),U(this,Ky,h),this._uiManager.dragSelectedEditors(f,p)},a),window.addEventListener("touchmove",Qr,a),window.addEventListener("pointerdown",u=>{u.pointerType===g(this,rE)&&(g(this,cg)||u.isPrimary)&&o(u),Qr(u)},a));const l=u=>{if(!g(this,_f)||g(this,_f)===u.pointerId){o(u);return}Qr(u)};window.addEventListener("pointerup",l,{signal:s}),window.addEventListener("blur",l,{signal:s})},hF=function(){if(g(this,wf)||!this.div)return;U(this,wf,new AbortController);const e=this._uiManager.combinedSignal(g(this,wf));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},dZ=function(e){Zt._resizerKeyboardManager.exec(this,e)},fZ=function(e){var t;g(this,hh)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==g(this,ds)&&X(this,Rt,Y_).call(this)},pZ=function(e){U(this,iE,g(this,hh)?e:"")},dF=function(e){if(g(this,ql))for(const t of g(this,ql))t.tabIndex=e},Y_=function(){U(this,hh,!1),X(this,Rt,dF).call(this,-1),X(this,Rt,DM).call(this)},j(Zt,oE),Qe(Zt,"_l10n",null),Qe(Zt,"_l10nResizer",null),Qe(Zt,"_borderLineWidth",-1),Qe(Zt,"_colorManager",new eF),Qe(Zt,"_zIndex",1),Qe(Zt,"_telemetryTimeout",1e3);let br=Zt;class o0e extends br{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const a8=3285377520,qo=4294901760,Du=65535;class mZ{constructor(e){this.h1=e?e&4294967295:a8,this.h2=e?e&4294967295:a8}update(e){let t,r;if(typeof e=="string"){t=new Uint8Array(e.length*2),r=0;for(let m=0,y=e.length;m<y;m++){const v=e.charCodeAt(m);v<=255?t[r++]=v:(t[r++]=v>>>8,t[r++]=v&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),r=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=r>>2,s=r-i*4,a=new Uint32Array(t.buffer,0,i);let o=0,l=0,u=this.h1,c=this.h2;const h=3432918353,d=461845907,f=h&Du,p=d&Du;for(let m=0;m<i;m++)m&1?(o=a[m],o=o*h&qo|o*f&Du,o=o<<15|o>>>17,o=o*d&qo|o*p&Du,u^=o,u=u<<13|u>>>19,u=u*5+3864292196):(l=a[m],l=l*h&qo|l*f&Du,l=l<<15|l>>>17,l=l*d&qo|l*p&Du,c^=l,c=c<<13|c>>>19,c=c*5+3864292196);switch(o=0,s){case 3:o^=t[i*4+2]<<16;case 2:o^=t[i*4+1]<<8;case 1:o^=t[i*4],o=o*h&qo|o*f&Du,o=o<<15|o>>>17,o=o*d&qo|o*p&Du,i&1?u^=o:c^=o}this.h1=u,this.h2=c}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&qo|e*36045&Du,t=t*4283543511&qo|((t<<16|e>>>16)*2950163797&qo)>>>16,e^=t>>>1,e=e*444984403&qo|e*60499&Du,t=t*3301882366&qo|((t<<16|e>>>16)*3120437893&qo)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const fF=Object.freeze({map:null,hash:"",transfer:void 0});var hg,dg,dh,fs,h2,gZ;class f4{constructor(){j(this,h2);j(this,hg,!1);j(this,dg,null);j(this,dh,null);j(this,fs,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const r=g(this,fs).get(e);return r===void 0?t:Object.assign(t,r)}getRawValue(e){return g(this,fs).get(e)}remove(e){const t=g(this,fs).get(e);if(t!==void 0&&(t instanceof br&&g(this,dh).delete(t.annotationElementId),g(this,fs).delete(e),g(this,fs).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const r of g(this,fs).values())if(r instanceof br)return;this.onAnnotationEditor(null)}}setValue(e,t){const r=g(this,fs).get(e);let i=!1;if(r!==void 0)for(const[s,a]of Object.entries(t))r[s]!==a&&(i=!0,r[s]=a);else i=!0,g(this,fs).set(e,t);i&&X(this,h2,gZ).call(this),t instanceof br&&((g(this,dh)||U(this,dh,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return g(this,fs).has(e)}get size(){return g(this,fs).size}resetModified(){g(this,hg)&&(U(this,hg,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new vZ(this)}get serializable(){if(g(this,fs).size===0)return fF;const e=new Map,t=new mZ,r=[],i=Object.create(null);let s=!1;for(const[a,o]of g(this,fs)){const l=o instanceof br?o.serialize(!1,i):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),s||(s=!!l.bitmap))}if(s)for(const a of e.values())a.bitmap&&r.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:r}:fF}get editorStats(){let e=null;const t=new Map;let r=0,i=0;for(const s of g(this,fs).values()){if(!(s instanceof br)){s.popup&&(s.popup.deleted?i+=1:r+=1);continue}s.isCommentDeleted?i+=1:s.hasEditedComment&&(r+=1);const a=s.telemetryFinalData;if(!a)continue;const{type:o}=a;t.has(o)||t.set(o,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const l=e[o]||(e[o]=new Map);for(const[u,c]of Object.entries(a)){if(u==="type")continue;let h=l.get(u);h||(h=new Map,l.set(u,h));const d=h.get(c)??0;h.set(c,d+1)}}if((i>0||r>0)&&(e||(e=Object.create(null)),e.comments={deleted:i,edited:r}),!e)return null;for(const[s,a]of t)e[s]=a.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){U(this,dg,null)}updateEditor(e,t){var i;const r=(i=g(this,dh))==null?void 0:i.get(e);return r?(r.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=g(this,dh))==null?void 0:t.get(e))||null}get modifiedIds(){if(g(this,dg))return g(this,dg);const e=[];if(g(this,dh))for(const t of g(this,dh).values())t.serialize()&&e.push(t.annotationElementId);return U(this,dg,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return g(this,fs).entries()}}hg=new WeakMap,dg=new WeakMap,dh=new WeakMap,fs=new WeakMap,h2=new WeakSet,gZ=function(){g(this,hg)||(U(this,hg,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var lE;class vZ extends f4{constructor(t){super();j(this,lE);const{map:r,hash:i,transfer:s}=t.serializable,a=structuredClone(r,s?{transfer:s}:null);U(this,lE,{map:a,hash:i,transfer:s})}get print(){fr("Should not call PrintAnnotationStorage.print")}get serializable(){return g(this,lE)}get modifiedIds(){return Kt(this,"modifiedIds",{ids:new Set,hash:""})}}lE=new WeakMap;var Yy;class l0e{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){j(this,Yy,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),g(this,Yy).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:r}){if(!(!e||g(this,Yy).has(e.loadedName))){if(Sn(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:s,style:a}=e,o=new FontFace(i,s,a);this.addNativeFontFace(o);try{await o.load(),g(this,Yy).add(i),r==null||r(e)}catch{Xt(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}fr("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const r=e.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(i){throw Xt(`Failed to load font '${r.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(r=>{const i=this._queueLoadingCallback(r);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return Kt(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Kt(this,"isSyncFontLoadingSupported",ga||Cs.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(Sn(!i.done,"completeRequest() cannot be called twice."),i.done=!0;r.length>0&&r[0].done;){const s=r.shift();setTimeout(s.callback,0)}}const{loadingRequests:r}=this,i={done:!1,complete:t,callback:e};return r.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Kt(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function r(w,_){return w.charCodeAt(_)<<24|w.charCodeAt(_+1)<<16|w.charCodeAt(_+2)<<8|w.charCodeAt(_+3)&255}function i(w,_,E,A){const T=w.substring(0,_),S=w.substring(_+E);return T+A+S}let s,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let u=0;function c(w,_){if(++u>30){Xt("Load test font never loaded."),_();return}if(l.font="30px "+w,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){_();return}setTimeout(c.bind(null,w,_))}const h=`lt${Date.now()}${this.loadTestFontId++}`;let d=this._loadTestFont;d=i(d,976,h.length,h);const p=16,m=1482184792;let y=r(d,p);for(s=0,a=h.length-3;s<a;s+=4)y=y-m+r(h,s)|0;s<h.length&&(y=y-m+r(h+"XXX",s)|0),d=i(d,p,4,$ve(y));const v=`url(data:font/opentype;base64,${btoa(d)});`,b=`@font-face {font-family:"${h}";src:${v}}`;this.insertRule(b);const x=this._document.createElement("div");x.style.visibility="hidden",x.style.width=x.style.height="10px",x.style.position="absolute",x.style.top=x.style.left="0px";for(const w of[e.loadedName,h]){const _=this._document.createElement("span");_.textContent="Hi",_.style.fontFamily=w,x.append(_)}this._document.body.append(x),c(h,()=>{x.remove(),t.complete()})}}Yy=new WeakMap;var tr;class u0e{constructor(e,t=null,r,i){j(this,tr);this.compiledGlyphs=Object.create(null),U(this,tr,e),this._inspectFont=t,r&&Object.assign(this,r),i&&(this.charProcOperatorList=i)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const r={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(r.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,r)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var r;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${FQ(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(r=this._inspectFont)==null||r.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const r=this.loadedName+"_path_"+t;let i;try{i=e.get(r)}catch(a){Xt(`getPathGenerator - ignoring character: "${a}".`)}const s=kQ(i);return this.fontExtraProperties||e.delete(r),this.compiledGlyphs[t]=s}get black(){return g(this,tr).black}get bold(){return g(this,tr).bold}get disableFontFace(){return g(this,tr).disableFontFace??!1}set disableFontFace(e){Kt(this,"disableFontFace",!!e)}get fontExtraProperties(){return g(this,tr).fontExtraProperties??!1}get isInvalidPDFjsFont(){return g(this,tr).isInvalidPDFjsFont}get isType3Font(){return g(this,tr).isType3Font}get italic(){return g(this,tr).italic}get missingFile(){return g(this,tr).missingFile}get remeasure(){return g(this,tr).remeasure}get vertical(){return g(this,tr).vertical}get ascent(){return g(this,tr).ascent}get defaultWidth(){return g(this,tr).defaultWidth}get descent(){return g(this,tr).descent}get bbox(){return g(this,tr).bbox}set bbox(e){Kt(this,"bbox",e)}get fontMatrix(){return g(this,tr).fontMatrix}get fallbackName(){return g(this,tr).fallbackName}get loadedName(){return g(this,tr).loadedName}get mimetype(){return g(this,tr).mimetype}get name(){return g(this,tr).name}get data(){return g(this,tr).data}clearData(){g(this,tr).clearData()}get cssFontInfo(){return g(this,tr).cssFontInfo}get systemFontInfo(){return g(this,tr).systemFontInfo}get defaultVMetrics(){return g(this,tr).defaultVMetrics}}tr=new WeakMap;var Qy,Zy,uE,Jy,NM;const uy=class uy{constructor(e){j(this,Jy);j(this,Qy);j(this,Zy);j(this,uE);U(this,Qy,e),U(this,Zy,new DataView(g(this,Qy))),U(this,uE,new TextDecoder)}static write(e){const t=new TextEncoder,r={};let i=0;for(const u of uy.strings){const c=t.encode(e[u]);r[u]=c,i+=4+c.length}const s=new ArrayBuffer(i),a=new Uint8Array(s),o=new DataView(s);let l=0;for(const u of uy.strings){const c=r[u],h=c.length;o.setUint32(l,h),a.set(c,l+4),l+=4+h}return Sn(l===s.byteLength,"CssFontInfo.write: Buffer overflow"),s}get fontFamily(){return X(this,Jy,NM).call(this,0)}get fontWeight(){return X(this,Jy,NM).call(this,1)}get italicAngle(){return X(this,Jy,NM).call(this,2)}};Qy=new WeakMap,Zy=new WeakMap,uE=new WeakMap,Jy=new WeakSet,NM=function(e){Sn(e<uy.strings.length,"Invalid string index");let t=0;for(let i=0;i<e;i++)t+=g(this,Zy).getUint32(t)+4;const r=g(this,Zy).getUint32(t);return g(this,uE).decode(new Uint8Array(g(this,Qy),t+4,r))},Qe(uy,"strings",["fontFamily","fontWeight","italicAngle"]);let lD=uy;var Ef,Gu,fg,pg,Q_;const cy=class cy{constructor(e){j(this,pg);j(this,Ef);j(this,Gu);j(this,fg);U(this,Ef,e),U(this,Gu,new DataView(g(this,Ef))),U(this,fg,new TextDecoder)}static write(e){const t=new TextEncoder,r={};let i=0;for(const d of cy.strings){const f=t.encode(e[d]);r[d]=f,i+=4+f.length}i+=4;let s,a,o=1+i;e.style&&(s=t.encode(e.style.style),a=t.encode(e.style.weight),o+=4+s.length+4+a.length);const l=new ArrayBuffer(o),u=new Uint8Array(l),c=new DataView(l);let h=0;c.setUint8(h++,e.guessFallback?1:0),c.setUint32(h,0),h+=4,i=0;for(const d of cy.strings){const f=r[d],p=f.length;i+=4+p,c.setUint32(h,p),u.set(f,h+4),h+=4+p}return c.setUint32(h-i-4,i),e.style&&(c.setUint32(h,s.length),u.set(s,h+4),h+=4+s.length,c.setUint32(h,a.length),u.set(a,h+4),h+=4+a.length),Sn(h<=l.byteLength,"SubstitionInfo.write: Buffer overflow"),l.transferToFixedLength(h)}get guessFallback(){return g(this,Gu).getUint8(0)!==0}get css(){return X(this,pg,Q_).call(this,0)}get loadedName(){return X(this,pg,Q_).call(this,1)}get baseFontName(){return X(this,pg,Q_).call(this,2)}get src(){return X(this,pg,Q_).call(this,3)}get style(){let e=1;e+=4+g(this,Gu).getUint32(e);const t=g(this,Gu).getUint32(e),r=g(this,fg).decode(new Uint8Array(g(this,Ef),e+4,t));e+=4+t;const i=g(this,Gu).getUint32(e),s=g(this,fg).decode(new Uint8Array(g(this,Ef),e+4,i));return{style:r,weight:s}}};Ef=new WeakMap,Gu=new WeakMap,fg=new WeakMap,pg=new WeakSet,Q_=function(e){Sn(e<cy.strings.length,"Invalid string index");let t=5;for(let i=0;i<e;i++)t+=g(this,Gu).getUint32(t)+4;const r=g(this,Gu).getUint32(t);return g(this,fg).decode(new Uint8Array(g(this,Ef),t+4,r))},Qe(cy,"strings",["css","loadedName","baseFontName","src"]);let uD=cy;var ex,tx,nx,rx,ho,ju,cE,nr,Kr,Ul,RM,Z_;const tn=class tn{constructor({data:e,extra:t}){j(this,Kr);j(this,ju);j(this,cE);j(this,nr);U(this,ju,e),U(this,cE,new TextDecoder),U(this,nr,new DataView(g(this,ju))),t&&Object.assign(this,t)}get black(){return X(this,Kr,Ul).call(this,0)}get bold(){return X(this,Kr,Ul).call(this,1)}get disableFontFace(){return X(this,Kr,Ul).call(this,2)}get fontExtraProperties(){return X(this,Kr,Ul).call(this,3)}get isInvalidPDFjsFont(){return X(this,Kr,Ul).call(this,4)}get isType3Font(){return X(this,Kr,Ul).call(this,5)}get italic(){return X(this,Kr,Ul).call(this,6)}get missingFile(){return X(this,Kr,Ul).call(this,7)}get remeasure(){return X(this,Kr,Ul).call(this,8)}get vertical(){return X(this,Kr,Ul).call(this,9)}get ascent(){return X(this,Kr,RM).call(this,0)}get defaultWidth(){return X(this,Kr,RM).call(this,1)}get descent(){return X(this,Kr,RM).call(this,2)}get bbox(){let e=g(tn,tx);if(g(this,nr).getUint8(e)===0)return;e+=1;const r=[];for(let i=0;i<4;i++)r.push(g(this,nr).getInt16(e,!0)),e+=2;return r}get fontMatrix(){let e=g(tn,nx);if(g(this,nr).getUint8(e)===0)return;e+=1;const r=[];for(let i=0;i<6;i++)r.push(g(this,nr).getFloat64(e,!0)),e+=8;return r}get defaultVMetrics(){let e=g(tn,rx);if(g(this,nr).getUint8(e)===0)return;e+=1;const r=[];for(let i=0;i<3;i++)r.push(g(this,nr).getInt16(e,!0)),e+=2;return r}get fallbackName(){return X(this,Kr,Z_).call(this,0)}get loadedName(){return X(this,Kr,Z_).call(this,1)}get mimetype(){return X(this,Kr,Z_).call(this,2)}get name(){return X(this,Kr,Z_).call(this,3)}get data(){let e=g(tn,ho);const t=g(this,nr).getUint32(e);e+=4+t;const r=g(this,nr).getUint32(e);e+=4+r;const i=g(this,nr).getUint32(e);e+=4+i;const s=g(this,nr).getUint32(e);if(s!==0)return new Uint8Array(g(this,ju),e+4,s)}clearData(){let e=g(tn,ho);const t=g(this,nr).getUint32(e);e+=4+t;const r=g(this,nr).getUint32(e);e+=4+r;const i=g(this,nr).getUint32(e);e+=4+i;const s=g(this,nr).getUint32(e);new Uint8Array(g(this,ju),e+4,s).fill(0),g(this,nr).setUint32(e,0)}get cssFontInfo(){let e=g(tn,ho);const t=g(this,nr).getUint32(e);e+=4+t;const r=g(this,nr).getUint32(e);e+=4+r;const i=g(this,nr).getUint32(e);if(i===0)return null;const s=new Uint8Array(i);return s.set(new Uint8Array(g(this,ju),e+4,i)),new lD(s.buffer)}get systemFontInfo(){let e=g(tn,ho);const t=g(this,nr).getUint32(e);e+=4+t;const r=g(this,nr).getUint32(e);if(r===0)return null;const i=new Uint8Array(r);return i.set(new Uint8Array(g(this,ju),e+4,r)),new uD(i.buffer)}static write(e){const t=e.systemFontInfo?uD.write(e.systemFontInfo):null,r=e.cssFontInfo?lD.write(e.cssFontInfo):null,i=new TextEncoder,s={};let a=0;for(const m of tn.strings)s[m]=i.encode(e[m]),a+=4+s[m].length;const o=g(tn,ho)+4+a+4+(t?t.byteLength:0)+4+(r?r.byteLength:0)+4+(e.data?e.data.length:0),l=new ArrayBuffer(o),u=new Uint8Array(l),c=new DataView(l);let h=0;const d=tn.bools.length;let f=0,p=0;for(let m=0;m<d;m++){const y=e[tn.bools[m]];f|=(y===void 0?0:y?2:1)<<p,p+=2,(p===8||m===d-1)&&(c.setUint8(h++,f),f=0,p=0)}Sn(h===g(tn,ex),"FontInfo.write: Boolean properties offset mismatch");for(const m of tn.numbers)c.setFloat64(h,e[m]),h+=8;if(Sn(h===g(tn,tx),"FontInfo.write: Number properties offset mismatch"),e.bbox){c.setUint8(h++,4);for(const m of e.bbox)c.setInt16(h,m,!0),h+=2}else c.setUint8(h++,0),h+=2*4;if(Sn(h===g(tn,nx),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){c.setUint8(h++,6);for(const m of e.fontMatrix)c.setFloat64(h,m,!0),h+=8}else c.setUint8(h++,0),h+=8*6;if(Sn(h===g(tn,rx),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){c.setUint8(h++,1);for(const m of e.defaultVMetrics)c.setInt16(h,m,!0),h+=2}else c.setUint8(h++,0),h+=3*2;Sn(h===g(tn,ho),"FontInfo.write: DefaultVMetrics properties offset mismatch"),c.setUint32(g(tn,ho),0),h+=4;for(const m of tn.strings){const y=s[m],v=y.length;c.setUint32(h,v),u.set(y,h+4),h+=4+v}if(c.setUint32(g(tn,ho),h-g(tn,ho)-4),!t)c.setUint32(h,0),h+=4;else{const m=t.byteLength;c.setUint32(h,m),Sn(h+4+m<=l.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),u.set(new Uint8Array(t),h+4),h+=4+m}if(!r)c.setUint32(h,0),h+=4;else{const m=r.byteLength;c.setUint32(h,m),Sn(h+4+m<=l.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),u.set(new Uint8Array(r),h+4),h+=4+m}return e.data===void 0?(c.setUint32(h,0),h+=4):(c.setUint32(h,e.data.length),u.set(e.data,h+4),h+=4+e.data.length),Sn(h<=l.byteLength,"FontInfo.write: Buffer overflow"),l.transferToFixedLength(h)}};ex=new WeakMap,tx=new WeakMap,nx=new WeakMap,rx=new WeakMap,ho=new WeakMap,ju=new WeakMap,cE=new WeakMap,nr=new WeakMap,Kr=new WeakSet,Ul=function(e){Sn(e<tn.bools.length,"Invalid boolean index");const t=Math.floor(e/4),r=e*2%8,i=g(this,nr).getUint8(t)>>r&3;return i===0?void 0:i===2},RM=function(e){return Sn(e<tn.numbers.length,"Invalid number index"),g(this,nr).getFloat64(g(tn,ex)+e*8)},Z_=function(e){Sn(e<tn.strings.length,"Invalid string index");let t=g(tn,ho)+4;for(let s=0;s<e;s++)t+=g(this,nr).getUint32(t)+4;const r=g(this,nr).getUint32(t),i=new Uint8Array(r);return i.set(new Uint8Array(g(this,ju),t+4,r)),g(this,cE).decode(i)},Qe(tn,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),Qe(tn,"numbers",["ascent","defaultWidth","descent"]),Qe(tn,"strings",["fallbackName","loadedName","mimetype","name"]),j(tn,ex,Math.ceil(tn.bools.length*2/8)),j(tn,tx,g(tn,ex)+tn.numbers.length*8),j(tn,nx,g(tn,tx)+1+2*4),j(tn,rx,g(tn,nx)+1+8*6),j(tn,ho,g(tn,rx)+1+2*3);let pF=tn;var hE,dE,fE,pE,mE,gE,vE,yE;const gr=class gr{constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,r=null,i=[],s=[],a=[],o=[],l=null,u=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,r=e[2],a=e[3],t===1?i.push(...e[4],...e[5]):i.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,l=e[1],i=e[2],s=e[3],o=e[4]||[],r=e[6],u=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const c=Math.floor(i.length/2),h=Math.floor(s.length/3),d=a.length,f=o.length;let p=0;for(const _ of o)p+=1,p=Math.ceil(p/4)*4,p+=4+_.coords.length*4,p+=4+_.colors.length*4,_.verticesPerRow!==void 0&&(p+=4);const m=20+c*8+h*3+d*8+(r?16:0)+(u?3:0)+p,y=new ArrayBuffer(m),v=new DataView(y),b=new Uint8Array(y);v.setUint8(g(gr,hE),t),v.setUint8(g(gr,dE),r?1:0),v.setUint8(g(gr,fE),u?1:0),v.setUint8(g(gr,pE),l),v.setUint32(g(gr,mE),c,!0),v.setUint32(g(gr,gE),h,!0),v.setUint32(g(gr,vE),d,!0),v.setUint32(g(gr,yE),f,!0);let x=20;new Float32Array(y,x,c*2).set(i),x+=c*8,b.set(s,x),x+=h*3;for(const[_,E]of a)v.setFloat32(x,_,!0),x+=4,v.setUint32(x,parseInt(E.slice(1),16),!0),x+=4;if(r)for(const _ of r)v.setFloat32(x,_,!0),x+=4;u&&(b.set(u,x),x+=3);for(let _=0;_<o.length;_++){const E=o[_];v.setUint8(x,E.type),x+=1,x=Math.ceil(x/4)*4,v.setUint32(x,E.coords.length,!0),x+=4,new Int32Array(y,x,E.coords.length).set(E.coords),x+=E.coords.length*4,v.setUint32(x,E.colors.length,!0),x+=4,new Int32Array(y,x,E.colors.length).set(E.colors),x+=E.colors.length*4,E.verticesPerRow!==void 0&&(v.setUint32(x,E.verticesPerRow,!0),x+=4)}return y}getIR(){const e=this.view,t=this.data[g(gr,hE)],r=!!this.data[g(gr,dE)],i=!!this.data[g(gr,fE)],s=e.getUint32(g(gr,mE),!0),a=e.getUint32(g(gr,gE),!0),o=e.getUint32(g(gr,vE),!0),l=e.getUint32(g(gr,yE),!0);let u=20;const c=new Float32Array(this.buffer,u,s*2);u+=s*8;const h=new Uint8Array(this.buffer,u,a*3);u+=a*3;const d=[];for(let y=0;y<o;++y){const v=e.getFloat32(u,!0);u+=4;const b=e.getUint32(u,!0);u+=4,d.push([v,`#${b.toString(16).padStart(6,"0")}`])}let f=null;if(r){f=[];for(let y=0;y<4;++y)f.push(e.getFloat32(u,!0)),u+=4}let p=null;i&&(p=new Uint8Array(this.buffer,u,3),u+=3);const m=[];for(let y=0;y<l;++y){const v=e.getUint8(u);u+=1,u=Math.ceil(u/4)*4;const b=e.getUint32(u,!0);u+=4;const x=new Int32Array(this.buffer,u,b);u+=b*4;const w=e.getUint32(u,!0);u+=4;const _=new Int32Array(this.buffer,u,w);u+=w*4;const E={type:v,coords:x,colors:_};v===q3.LATTICE&&(E.verticesPerRow=e.getUint32(u,!0),u+=4),m.push(E)}if(t===1)return["RadialAxial","axial",f,d,Array.from(c.slice(0,2)),Array.from(c.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",f,d,[c[0],c[1]],[c[3],c[4]],c[2],c[5]];if(t===3){const y=this.data[g(gr,pE)];let v=null;if(c.length>0){let b=c[0],x=c[0],w=c[1],_=c[1];for(let E=0;E<c.length;E+=2){const A=c[E],T=c[E+1];b=b>A?A:b,w=w>T?T:w,x=x<A?A:x,_=_<T?T:_}v=[b,w,x,_]}return["Mesh",y,c,h,m,v,f,p]}throw new Error(`Unsupported pattern kind: ${t}`)}};hE=new WeakMap,dE=new WeakMap,fE=new WeakMap,pE=new WeakMap,mE=new WeakMap,gE=new WeakMap,vE=new WeakMap,yE=new WeakMap,j(gr,hE,0),j(gr,dE,1),j(gr,fE,2),j(gr,pE,3),j(gr,mE,4),j(gr,gE,8),j(gr,vE,12),j(gr,yE,16);let mF=gr;function c0e(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(ga)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function h0e(n){if(ga&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return HS(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function ZA(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const gF=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,d0e=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",f0e=Wve.bind(null,gF,d0e);var fh,d2;class p0e{constructor(){j(this,fh,new Map);j(this,d2,Promise.resolve())}postMessage(e,t){const r={data:structuredClone(e,t?{transfer:t}:null)};g(this,d2).then(()=>{for(const[i]of g(this,fh))i.call(this,r)})}addEventListener(e,t,r=null){let i=null;if((r==null?void 0:r.signal)instanceof AbortSignal){const{signal:s}=r;if(s.aborted){Xt("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);i=()=>s.removeEventListener("abort",a),s.addEventListener("abort",a)}g(this,fh).set(t,i)}removeEventListener(e,t){const r=g(this,fh).get(t);r==null||r(),g(this,fh).delete(t)}terminate(){for(const[,e]of g(this,fh))e==null||e();g(this,fh).clear()}}fh=new WeakMap,d2=new WeakMap;const JA={DATA:1,ERROR:2},fi={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function o8(){}function Fa(n){if(n instanceof Np||n instanceof W3||n instanceof Jz||n instanceof iD||n instanceof iI)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||fr('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Np(n.message);case"InvalidPDFException":return new W3(n.message);case"PasswordException":return new Jz(n.message,n.code);case"ResponseException":return new iD(n.message,n.status,n.missing);case"UnknownErrorException":return new iI(n.message,n.details)}return new iI(n.message,n.toString())}var ix,Al,yZ,xZ,bZ,IM;class J_{constructor(e,t,r){j(this,Al);j(this,ix,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=r,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),r.addEventListener("message",X(this,Al,yZ).bind(this),{signal:g(this,ix).signal})}on(e,t){const r=this.actionHandler;if(r[e])throw new Error(`There is already an actionName called "${e}"`);r[e]=t}send(e,t,r){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},r)}sendWithPromise(e,t,r){const i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},r)}catch(a){s.reject(a)}return s.promise}sendWithStream(e,t,r,i){const s=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:u=>{const c=Promise.withResolvers();return this.streamControllers[s]={controller:u,startCall:c,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:s,data:t,desiredSize:u.desiredSize},i),c.promise},pull:u=>{const c=Promise.withResolvers();return this.streamControllers[s].pullCall=c,l.postMessage({sourceName:a,targetName:o,stream:fi.PULL,streamId:s,desiredSize:u.desiredSize}),c.promise},cancel:u=>{Sn(u instanceof Error,"cancel must have a valid reason");const c=Promise.withResolvers();return this.streamControllers[s].cancelCall=c,this.streamControllers[s].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:fi.CANCEL,streamId:s,reason:Fa(u)}),c.promise}},r)}destroy(){var e;(e=g(this,ix))==null||e.abort(),U(this,ix,null)}}ix=new WeakMap,Al=new WeakSet,yZ=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){X(this,Al,bZ).call(this,e);return}if(e.callback){const r=e.callbackId,i=this.callbackCapabilities[r];if(!i)throw new Error(`Cannot resolve callback ${r}`);if(delete this.callbackCapabilities[r],e.callback===JA.DATA)i.resolve(e.data);else if(e.callback===JA.ERROR)i.reject(Fa(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const r=this.sourceName,i=e.sourceName,s=this.comObj;Promise.try(t,e.data).then(function(a){s.postMessage({sourceName:r,targetName:i,callback:JA.DATA,callbackId:e.callbackId,data:a})},function(a){s.postMessage({sourceName:r,targetName:i,callback:JA.ERROR,callbackId:e.callbackId,reason:Fa(a)})});return}if(e.streamId){X(this,Al,xZ).call(this,e);return}t(e.data)},xZ=function(e){const t=e.streamId,r=this.sourceName,i=e.sourceName,s=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(u,c=1,h){if(this.isCancelled)return;const d=this.desiredSize;this.desiredSize-=c,d>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:r,targetName:i,stream:fi.ENQUEUE,streamId:t,chunk:u},h)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:fi.CLOSE,streamId:t}),delete a.streamSinks[t])},error(u){Sn(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:fi.ERROR,streamId:t,reason:Fa(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){s.postMessage({sourceName:r,targetName:i,stream:fi.START_COMPLETE,streamId:t,success:!0})},function(u){s.postMessage({sourceName:r,targetName:i,stream:fi.START_COMPLETE,streamId:t,reason:Fa(u)})})},bZ=function(e){const t=e.streamId,r=this.sourceName,i=e.sourceName,s=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case fi.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(Fa(e.reason));break;case fi.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(Fa(e.reason));break;case fi.PULL:if(!o){s.postMessage({sourceName:r,targetName:i,stream:fi.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||o8).then(function(){s.postMessage({sourceName:r,targetName:i,stream:fi.PULL_COMPLETE,streamId:t,success:!0})},function(u){s.postMessage({sourceName:r,targetName:i,stream:fi.PULL_COMPLETE,streamId:t,reason:Fa(u)})});break;case fi.ENQUEUE:if(Sn(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case fi.CLOSE:if(Sn(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),X(this,Al,IM).call(this,a,t);break;case fi.ERROR:Sn(a,"error should have stream controller"),a.controller.error(Fa(e.reason)),X(this,Al,IM).call(this,a,t);break;case fi.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(Fa(e.reason)),X(this,Al,IM).call(this,a,t);break;case fi.CANCEL:if(!o)break;const l=Fa(e.reason);Promise.try(o.onCancel||o8,l).then(function(){s.postMessage({sourceName:r,targetName:i,stream:fi.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){s.postMessage({sourceName:r,targetName:i,stream:fi.CANCEL_COMPLETE,streamId:t,reason:Fa(u)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},IM=async function(e,t){var r,i,s;await Promise.allSettled([(r=e.startCall)==null?void 0:r.promise,(i=e.pullCall)==null?void 0:i.promise,(s=e.cancelCall)==null?void 0:s.promise]),delete this.streamControllers[t]};var xE;class _Z{constructor({enableHWA:e=!1}){j(this,xE,!1);U(this,xE,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const r=this._createCanvas(e,t);return{canvas:r,context:r.getContext("2d",{willReadFrequently:!g(this,xE)})}}reset(e,t,r){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||r<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=r}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){fr("Abstract method `_createCanvas` called.")}}xE=new WeakMap;class m0e extends _Z{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const r=this._document.createElement("canvas");return r.width=e,r.height=t,r}}class wZ{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(r=>({cMapData:r,isCompressed:this.isCompressed})).catch(r=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){fr("Abstract method `_fetch` called.")}}class l8 extends wZ{async _fetch(e){const t=await GS(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):HS(t)}}class EZ{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,r,i,s){return"none"}destroy(e=!1){}}var mg,sx,ph,mh,Gs,gg,vg,ft,Vs,e1,I0,PM,P0,SZ,vF,F0,t1,n1,yF,r1;class g0e extends EZ{constructor({docId:t,ownerDocument:r=globalThis.document}){super();j(this,ft);j(this,mg);j(this,sx);j(this,ph);j(this,mh);j(this,Gs);j(this,gg);j(this,vg,0);U(this,mh,t),U(this,Gs,r)}addFilter(t){if(!t)return"none";let r=g(this,ft,Vs).get(t);if(r)return r;const[i,s,a]=X(this,ft,PM).call(this,t),o=t.length===1?i:`${i}${s}${a}`;if(r=g(this,ft,Vs).get(o),r)return g(this,ft,Vs).set(t,r),r;const l=`g_${g(this,mh)}_transfer_map_${Ai(this,vg)._++}`,u=X(this,ft,P0).call(this,l);g(this,ft,Vs).set(t,u),g(this,ft,Vs).set(o,u);const c=X(this,ft,F0).call(this,l);return X(this,ft,n1).call(this,i,s,a,c),u}addHCMFilter(t,r){var p;const i=`${t}-${r}`,s="base";let a=g(this,ft,e1).get(s);if((a==null?void 0:a.key)===i||(a?((p=a.filter)==null||p.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},g(this,ft,e1).set(s,a)),!t||!r))return a.url;const o=X(this,ft,r1).call(this,t);t=yt.makeHexColor(...o);const l=X(this,ft,r1).call(this,r);if(r=yt.makeHexColor(...l),g(this,ft,I0).style.color="",t==="#000000"&&r==="#ffffff"||t===r)return a.url;const u=new Array(256);for(let m=0;m<=255;m++){const y=m/255;u[m]=y<=.03928?y/12.92:((y+.055)/1.055)**2.4}const c=u.join(","),h=`g_${g(this,mh)}_hcm_filter`,d=a.filter=X(this,ft,F0).call(this,h);X(this,ft,n1).call(this,c,c,c,d),X(this,ft,vF).call(this,d);const f=(m,y)=>{const v=o[m]/255,b=l[m]/255,x=new Array(y+1);for(let w=0;w<=y;w++)x[w]=v+w/y*(b-v);return x.join(",")};return X(this,ft,n1).call(this,f(0,5),f(1,5),f(2,5),d),a.url=X(this,ft,P0).call(this,h),a.url}addAlphaFilter(t){let r=g(this,ft,Vs).get(t);if(r)return r;const[i]=X(this,ft,PM).call(this,[t]),s=`alpha_${i}`;if(r=g(this,ft,Vs).get(s),r)return g(this,ft,Vs).set(t,r),r;const a=`g_${g(this,mh)}_alpha_map_${Ai(this,vg)._++}`,o=X(this,ft,P0).call(this,a);g(this,ft,Vs).set(t,o),g(this,ft,Vs).set(s,o);const l=X(this,ft,F0).call(this,a);return X(this,ft,yF).call(this,i,l),o}addLuminosityFilter(t){let r=g(this,ft,Vs).get(t||"luminosity");if(r)return r;let i,s;if(t?([i]=X(this,ft,PM).call(this,[t]),s=`luminosity_${i}`):s="luminosity",r=g(this,ft,Vs).get(s),r)return g(this,ft,Vs).set(t,r),r;const a=`g_${g(this,mh)}_luminosity_map_${Ai(this,vg)._++}`,o=X(this,ft,P0).call(this,a);g(this,ft,Vs).set(t,o),g(this,ft,Vs).set(s,o);const l=X(this,ft,F0).call(this,a);return X(this,ft,SZ).call(this,l),t&&X(this,ft,yF).call(this,i,l),o}addHighlightHCMFilter(t,r,i,s,a){var b;const o=`${r}-${i}-${s}-${a}`;let l=g(this,ft,e1).get(t);if((l==null?void 0:l.key)===o||(l?((b=l.filter)==null||b.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},g(this,ft,e1).set(t,l)),!r||!i))return l.url;const[u,c]=[r,i].map(X(this,ft,r1).bind(this));let h=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),d=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),[f,p]=[s,a].map(X(this,ft,r1).bind(this));d<h&&([h,d,f,p]=[d,h,p,f]),g(this,ft,I0).style.color="";const m=(x,w,_)=>{const E=new Array(256),A=(d-h)/_,T=x/255,S=(w-x)/(255*_);let M=0;for(let D=0;D<=_;D++){const N=Math.round(h+D*A),R=T+D*S;for(let O=M;O<=N;O++)E[O]=R;M=N+1}for(let D=M;D<256;D++)E[D]=E[M-1];return E.join(",")},y=`g_${g(this,mh)}_hcm_${t}_filter`,v=l.filter=X(this,ft,F0).call(this,y);return X(this,ft,vF).call(this,v),X(this,ft,n1).call(this,m(f[0],p[0],5),m(f[1],p[1],5),m(f[2],p[2],5),v),l.url=X(this,ft,P0).call(this,y),l.url}destroy(t=!1){var r,i,s,a;t&&((r=g(this,gg))!=null&&r.size)||((i=g(this,ph))==null||i.parentNode.parentNode.remove(),U(this,ph,null),(s=g(this,sx))==null||s.clear(),U(this,sx,null),(a=g(this,gg))==null||a.clear(),U(this,gg,null),U(this,vg,0))}}mg=new WeakMap,sx=new WeakMap,ph=new WeakMap,mh=new WeakMap,Gs=new WeakMap,gg=new WeakMap,vg=new WeakMap,ft=new WeakSet,Vs=function(){return g(this,sx)||U(this,sx,new Map)},e1=function(){return g(this,gg)||U(this,gg,new Map)},I0=function(){if(!g(this,ph)){const t=g(this,Gs).createElement("div"),{style:r}=t;r.visibility="hidden",r.contain="strict",r.width=r.height=0,r.position="absolute",r.top=r.left=0,r.zIndex=-1;const i=g(this,Gs).createElementNS(Xc,"svg");i.setAttribute("width",0),i.setAttribute("height",0),U(this,ph,g(this,Gs).createElementNS(Xc,"defs")),t.append(i),i.append(g(this,ph)),g(this,Gs).body.append(t)}return g(this,ph)},PM=function(t){if(t.length===1){const u=t[0],c=new Array(256);for(let d=0;d<256;d++)c[d]=u[d]/255;const h=c.join(",");return[h,h,h]}const[r,i,s]=t,a=new Array(256),o=new Array(256),l=new Array(256);for(let u=0;u<256;u++)a[u]=r[u]/255,o[u]=i[u]/255,l[u]=s[u]/255;return[a.join(","),o.join(","),l.join(",")]},P0=function(t){if(g(this,mg)===void 0){U(this,mg,"");const r=g(this,Gs).URL;r!==g(this,Gs).baseURI&&(xN(r)?Xt('#createUrl: ignore "data:"-URL for performance reasons.'):U(this,mg,RQ(r,"")))}return`url(${g(this,mg)}#${t})`},SZ=function(t){const r=g(this,Gs).createElementNS(Xc,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(r)},vF=function(t){const r=g(this,Gs).createElementNS(Xc,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(r)},F0=function(t){const r=g(this,Gs).createElementNS(Xc,"filter");return r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("id",t),g(this,ft,I0).append(r),r},t1=function(t,r,i){const s=g(this,Gs).createElementNS(Xc,r);s.setAttribute("type","discrete"),s.setAttribute("tableValues",i),t.append(s)},n1=function(t,r,i,s){const a=g(this,Gs).createElementNS(Xc,"feComponentTransfer");s.append(a),X(this,ft,t1).call(this,a,"feFuncR",t),X(this,ft,t1).call(this,a,"feFuncG",r),X(this,ft,t1).call(this,a,"feFuncB",i)},yF=function(t,r){const i=g(this,Gs).createElementNS(Xc,"feComponentTransfer");r.append(i),X(this,ft,t1).call(this,i,"feFuncA",t)},r1=function(t){return g(this,ft,I0).style.color=t,qS(getComputedStyle(g(this,ft,I0)).getPropertyValue("color"))};class AZ{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(r=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){fr("Abstract method `_fetch` called.")}}class u8 extends AZ{async _fetch(e){const t=await GS(e,"arraybuffer");return new Uint8Array(t)}}class TZ{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(r=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){fr("Abstract method `_fetch` called.")}}class c8 extends TZ{async _fetch(e){const t=await GS(e,"arraybuffer");return new Uint8Array(t)}}ga&&Xt("Please use the `legacy` build in Node.js environments.");async function p4(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class v0e extends EZ{}class y0e extends _Z{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class x0e extends wZ{async _fetch(e){return p4(e)}}class b0e extends AZ{async _fetch(e){return p4(e)}}class _0e extends TZ{async _fetch(e){return p4(e)}}const i0="__forcedDependency",{floor:h8,ceil:d8}=Math;function eT(n,e,t,r,i,s){n[e*4+0]=Math.min(n[e*4+0],t),n[e*4+1]=Math.min(n[e*4+1],r),n[e*4+2]=Math.max(n[e*4+2],i),n[e*4+3]=Math.max(n[e*4+3],s)}const xF=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var ax,Sf;class w0e{constructor(e,t){j(this,ax);j(this,Sf);U(this,ax,e),U(this,Sf,t)}get length(){return g(this,ax).length}isEmpty(e){return g(this,ax)[e]===xF}minX(e){return g(this,Sf)[e*4+0]/256}minY(e){return g(this,Sf)[e*4+1]/256}maxX(e){return(g(this,Sf)[e*4+2]+1)/256}maxY(e){return(g(this,Sf)[e*4+3]+1)/256}}ax=new WeakMap,Sf=new WeakMap;const tT=(n,e)=>{if(!n)return;let t=n.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},n.set(e,t)),t};var ka,Ba,yg,Wl,xg,gh,jn,rr,vh,Ua,bE,ox,bg,_g,yh,js,qu,_E,bF;class E0e{constructor(e,t,r=!1){j(this,_E);j(this,ka,{__proto__:null});j(this,Ba,{__proto__:null,transform:[],moveText:[],sameLineText:[],[i0]:[]});j(this,yg,new Map);j(this,Wl,[]);j(this,xg,[]);j(this,gh,[[1,0,0,1,0,0]]);j(this,jn,[-1/0,-1/0,1/0,1/0]);j(this,rr,new Float64Array([1/0,1/0,-1/0,-1/0]));j(this,vh,-1);j(this,Ua,new Set);j(this,bE,new Map);j(this,ox,new Map);j(this,bg);j(this,_g);j(this,yh);j(this,js);j(this,qu);U(this,bg,e.width),U(this,_g,e.height),X(this,_E,bF).call(this,t),r&&U(this,qu,new Map)}growOperationsCount(e){e>=g(this,js).length&&X(this,_E,bF).call(this,e,g(this,js))}save(e){return U(this,ka,{__proto__:g(this,ka)}),U(this,Ba,{__proto__:g(this,Ba),transform:{__proto__:g(this,Ba).transform},moveText:{__proto__:g(this,Ba).moveText},sameLineText:{__proto__:g(this,Ba).sameLineText},[i0]:{__proto__:g(this,Ba)[i0]}}),U(this,jn,{__proto__:g(this,jn)}),g(this,Wl).push(e),this}restore(e){var i;const t=Object.getPrototypeOf(g(this,ka));if(t===null)return this;U(this,ka,t),U(this,Ba,Object.getPrototypeOf(g(this,Ba))),U(this,jn,Object.getPrototypeOf(g(this,jn)));const r=g(this,Wl).pop();return r!==void 0&&((i=tT(g(this,qu),e))==null||i.dependencies.add(r),g(this,js)[e]=g(this,js)[r]),this}recordOpenMarker(e){return g(this,Wl).push(e),this}getOpenMarker(){return g(this,Wl).length===0?null:g(this,Wl).at(-1)}recordCloseMarker(e){var r;const t=g(this,Wl).pop();return t!==void 0&&((r=tT(g(this,qu),e))==null||r.dependencies.add(t),g(this,js)[e]=g(this,js)[t]),this}beginMarkedContent(e){return g(this,xg).push(e),this}endMarkedContent(e){var r;const t=g(this,xg).pop();return t!==void 0&&((r=tT(g(this,qu),e))==null||r.dependencies.add(t),g(this,js)[e]=g(this,js)[t]),this}pushBaseTransform(e){return g(this,gh).push(yt.multiplyByDOMMatrix(g(this,gh).at(-1),e.getTransform())),this}popBaseTransform(){return g(this,gh).length>1&&g(this,gh).pop(),this}recordSimpleData(e,t){return g(this,ka)[e]=t,this}recordIncrementalData(e,t){return g(this,Ba)[e].push(t),this}resetIncrementalData(e,t){return g(this,Ba)[e].length=0,this}recordNamedData(e,t){return g(this,yg).set(e,t),this}recordSimpleDataFromNamed(e,t,r){g(this,ka)[e]=g(this,yg).get(t)??r}recordFutureForcedDependency(e,t){return this.recordIncrementalData(i0,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in g(this,ka)&&this.recordFutureForcedDependency(t,g(this,ka)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of g(this,Ua))this.recordFutureForcedDependency(i0,e);return this}resetBBox(e){return g(this,vh)!==e&&(U(this,vh,e),g(this,rr)[0]=1/0,g(this,rr)[1]=1/0,g(this,rr)[2]=-1/0,g(this,rr)[3]=-1/0),this}recordClipBox(e,t,r,i,s,a){const o=yt.multiplyByDOMMatrix(g(this,gh).at(-1),t.getTransform()),l=[1/0,1/0,-1/0,-1/0];yt.axialAlignedBoundingBox([r,s,i,a],o,l);const u=yt.intersect(g(this,jn),l);return u?(g(this,jn)[0]=u[0],g(this,jn)[1]=u[1],g(this,jn)[2]=u[2],g(this,jn)[3]=u[3]):(g(this,jn)[0]=g(this,jn)[1]=1/0,g(this,jn)[2]=g(this,jn)[3]=-1/0),this}recordBBox(e,t,r,i,s,a){const o=g(this,jn);if(o[0]===1/0)return this;const l=yt.multiplyByDOMMatrix(g(this,gh).at(-1),t.getTransform());if(o[0]===-1/0)return yt.axialAlignedBoundingBox([r,s,i,a],l,g(this,rr)),this;const u=[1/0,1/0,-1/0,-1/0];return yt.axialAlignedBoundingBox([r,s,i,a],l,u),g(this,rr)[0]=Math.min(g(this,rr)[0],Math.max(u[0],o[0])),g(this,rr)[1]=Math.min(g(this,rr)[1],Math.max(u[1],o[1])),g(this,rr)[2]=Math.max(g(this,rr)[2],Math.min(u[2],o[2])),g(this,rr)[3]=Math.max(g(this,rr)[3],Math.min(u[3],o[3])),this}recordCharacterBBox(e,t,r,i=1,s=0,a=0,o){const l=r.bbox;let u,c;if(l&&(u=l[2]!==l[0]&&l[3]!==l[1]&&g(this,ox).get(r),u!==!1&&(c=[0,0,0,0],yt.axialAlignedBoundingBox(l,r.fontMatrix,c),(i!==1||s!==0||a!==0)&&yt.scaleMinMax([i,0,0,-i,s,a],c),u)))return this.recordBBox(e,t,c[0],c[2],c[1],c[3]);if(!o)return this.recordFullPageBBox(e);const h=o();return l&&c&&u===void 0&&(u=c[0]<=s-h.actualBoundingBoxLeft&&c[2]>=s+h.actualBoundingBoxRight&&c[1]<=a-h.actualBoundingBoxAscent&&c[3]>=a+h.actualBoundingBoxDescent,g(this,ox).set(r,u),u)?this.recordBBox(e,t,c[0],c[2],c[1],c[3]):this.recordBBox(e,t,s-h.actualBoundingBoxLeft,s+h.actualBoundingBoxRight,a-h.actualBoundingBoxAscent,a+h.actualBoundingBoxDescent)}recordFullPageBBox(e){return g(this,rr)[0]=Math.max(0,g(this,jn)[0]),g(this,rr)[1]=Math.max(0,g(this,jn)[1]),g(this,rr)[2]=Math.min(g(this,bg),g(this,jn)[2]),g(this,rr)[3]=Math.min(g(this,_g),g(this,jn)[3]),this}getSimpleIndex(e){return g(this,ka)[e]}recordDependencies(e,t){const r=g(this,Ua),i=g(this,ka),s=g(this,Ba);for(const a of t)a in g(this,ka)?r.add(i[a]):a in s&&s[a].forEach(r.add,r);return this}recordNamedDependency(e,t){return g(this,yg).has(t)&&g(this,Ua).add(g(this,yg).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[i0]),g(this,qu)){const r=tT(g(this,qu),e),{dependencies:i}=r;g(this,Ua).forEach(i.add,i),g(this,Wl).forEach(i.add,i),g(this,xg).forEach(i.add,i),i.delete(e),r.isRenderingOperation=!0}if(g(this,vh)===e){const r=h8(g(this,rr)[0]*256/g(this,bg)),i=h8(g(this,rr)[1]*256/g(this,_g)),s=d8(g(this,rr)[2]*256/g(this,bg)),a=d8(g(this,rr)[3]*256/g(this,_g));eT(g(this,yh),e,r,i,s,a);for(const o of g(this,Ua))o!==e&&eT(g(this,yh),o,r,i,s,a);for(const o of g(this,Wl))o!==e&&eT(g(this,yh),o,r,i,s,a);for(const o of g(this,xg))o!==e&&eT(g(this,yh),o,r,i,s,a);t||(g(this,Ua).clear(),U(this,vh,-1))}return this}recordShowTextOperation(e,t=!1){const r=Array.from(g(this,Ua));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const i of r)this.recordIncrementalData("sameLineText",i);return this}bboxToClipBoxDropOperation(e,t=!1){return g(this,vh)===e&&(U(this,vh,-1),g(this,jn)[0]=Math.max(g(this,jn)[0],g(this,rr)[0]),g(this,jn)[1]=Math.max(g(this,jn)[1],g(this,rr)[1]),g(this,jn)[2]=Math.min(g(this,jn)[2],g(this,rr)[2]),g(this,jn)[3]=Math.min(g(this,jn)[3],g(this,rr)[3]),t||g(this,Ua).clear()),this}_takePendingDependencies(){const e=g(this,Ua);return U(this,Ua,new Set),e}_extractOperation(e){const t=g(this,bE).get(e);return g(this,bE).delete(e),t}_pushPendingDependencies(e){for(const t of e)g(this,Ua).add(t)}take(){return g(this,ox).clear(),new w0e(g(this,js),g(this,yh))}takeDebugMetadata(){return g(this,qu)}}ka=new WeakMap,Ba=new WeakMap,yg=new WeakMap,Wl=new WeakMap,xg=new WeakMap,gh=new WeakMap,jn=new WeakMap,rr=new WeakMap,vh=new WeakMap,Ua=new WeakMap,bE=new WeakMap,ox=new WeakMap,bg=new WeakMap,_g=new WeakMap,yh=new WeakMap,js=new WeakMap,qu=new WeakMap,_E=new WeakSet,bF=function(e,t){const r=new ArrayBuffer(e*4);U(this,yh,new Uint8ClampedArray(r)),U(this,js,new Uint32Array(r)),t&&t.length>0?(g(this,js).set(t),g(this,js).fill(xF,t.length)):g(this,js).fill(xF)};var cr,jr,Xl,lx,ux;const VU=class VU{constructor(e,t,r){j(this,cr);j(this,jr);j(this,Xl);j(this,lx,0);j(this,ux,0);if(e instanceof VU&&g(e,Xl)===!!r)return e;U(this,cr,e),U(this,jr,t),U(this,Xl,!!r)}growOperationsCount(){throw new Error("Unreachable")}save(e){return Ai(this,ux)._++,g(this,cr).save(g(this,jr)),this}restore(e){return g(this,ux)>0&&(g(this,cr).restore(g(this,jr)),Ai(this,ux)._--),this}recordOpenMarker(e){return Ai(this,lx)._++,this}getOpenMarker(){return g(this,lx)>0?g(this,jr):g(this,cr).getOpenMarker()}recordCloseMarker(e){return Ai(this,lx)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return g(this,cr).pushBaseTransform(e),this}popBaseTransform(){return g(this,cr).popBaseTransform(),this}recordSimpleData(e,t){return g(this,cr).recordSimpleData(e,g(this,jr)),this}recordIncrementalData(e,t){return g(this,cr).recordIncrementalData(e,g(this,jr)),this}resetIncrementalData(e,t){return g(this,cr).resetIncrementalData(e,g(this,jr)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,r){return g(this,cr).recordSimpleDataFromNamed(e,t,g(this,jr)),this}recordFutureForcedDependency(e,t){return g(this,cr).recordFutureForcedDependency(e,g(this,jr)),this}inheritSimpleDataAsFutureForcedDependencies(e){return g(this,cr).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return g(this,cr).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return g(this,Xl)||g(this,cr).resetBBox(g(this,jr)),this}recordClipBox(e,t,r,i,s,a){return g(this,Xl)||g(this,cr).recordClipBox(g(this,jr),t,r,i,s,a),this}recordBBox(e,t,r,i,s,a){return g(this,Xl)||g(this,cr).recordBBox(g(this,jr),t,r,i,s,a),this}recordCharacterBBox(e,t,r,i,s,a,o){return g(this,Xl)||g(this,cr).recordCharacterBBox(g(this,jr),t,r,i,s,a,o),this}recordFullPageBBox(e){return g(this,Xl)||g(this,cr).recordFullPageBBox(g(this,jr)),this}getSimpleIndex(e){return g(this,cr).getSimpleIndex(e)}recordDependencies(e,t){return g(this,cr).recordDependencies(g(this,jr),t),this}recordNamedDependency(e,t){return g(this,cr).recordNamedDependency(g(this,jr),t),this}recordOperation(e){return g(this,cr).recordOperation(g(this,jr),!0),this}recordShowTextOperation(e){return g(this,cr).recordShowTextOperation(g(this,jr),!0),this}bboxToClipBoxDropOperation(e){return g(this,Xl)||g(this,cr).bboxToClipBoxDropOperation(g(this,jr),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};cr=new WeakMap,jr=new WeakMap,Xl=new WeakMap,lx=new WeakMap,ux=new WeakMap;let cD=VU;const Wo={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},xs={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function _F(n,e){if(!e)return;const t=e[2]-e[0],r=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,r),n.clip(i)}class m4{isModifyingCurrentTransform(){return!1}getPattern(){fr("Abstract method `getPattern` called.")}}class S0e extends m4{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const r of this._colorStops)t.addColorStop(r[0],r[1]);return t}getPattern(e,t,r,i){let s;if(i===xs.STROKE||i===xs.FILL){const a=t.current.getClippedPathBoundingBox(i,Lr(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,u=t.cachedCanvases.getCanvas("pattern",o,l),c=u.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-a[0],-a[1]),r=yt.transform(r,[1,0,0,1,a[0],a[1]]),c.transform(...t.baseTransform),this.matrix&&c.transform(...this.matrix),_F(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),s=e.createPattern(u.canvas,"no-repeat");const h=new DOMMatrix(r);s.setTransform(h)}else _F(e,this._bbox),s=this._createGradient(e);return s}}function oI(n,e,t,r,i,s,a,o){const l=e.coords,u=e.colors,c=n.data,h=n.width*4;let d;l[t+1]>l[r+1]&&(d=t,t=r,r=d,d=s,s=a,a=d),l[r+1]>l[i+1]&&(d=r,r=i,i=d,d=a,a=o,o=d),l[t+1]>l[r+1]&&(d=t,t=r,r=d,d=s,s=a,a=d);const f=(l[t]+e.offsetX)*e.scaleX,p=(l[t+1]+e.offsetY)*e.scaleY,m=(l[r]+e.offsetX)*e.scaleX,y=(l[r+1]+e.offsetY)*e.scaleY,v=(l[i]+e.offsetX)*e.scaleX,b=(l[i+1]+e.offsetY)*e.scaleY;if(p>=b)return;const x=u[s],w=u[s+1],_=u[s+2],E=u[a],A=u[a+1],T=u[a+2],S=u[o],M=u[o+1],D=u[o+2],N=Math.round(p),R=Math.round(b);let O,G,I,B,$,H,Q,ee;for(let J=N;J<=R;J++){if(J<y){const ue=J<p?0:(p-J)/(p-y);O=f-(f-m)*ue,G=x-(x-E)*ue,I=w-(w-A)*ue,B=_-(_-T)*ue}else{let ue;J>b?ue=1:y===b?ue=0:ue=(y-J)/(y-b),O=m-(m-v)*ue,G=E-(E-S)*ue,I=A-(A-M)*ue,B=T-(T-D)*ue}let L;J<p?L=0:J>b?L=1:L=(p-J)/(p-b),$=f-(f-v)*L,H=x-(x-S)*L,Q=w-(w-M)*L,ee=_-(_-D)*L;const se=Math.round(Math.min(O,$)),Z=Math.round(Math.max(O,$));let le=h*J+se*4;for(let ue=se;ue<=Z;ue++)L=(O-ue)/(O-$),L<0?L=0:L>1&&(L=1),c[le++]=G-(G-H)*L|0,c[le++]=I-(I-Q)*L|0,c[le++]=B-(B-ee)*L|0,c[le++]=255}}function A0e(n,e,t){const r=e.coords,i=e.colors;let s,a;switch(e.type){case q3.LATTICE:const o=e.verticesPerRow,l=Math.floor(r.length/o)-1,u=o-1;for(s=0;s<l;s++){let c=s*o;for(let h=0;h<u;h++,c++)oI(n,t,r[c],r[c+1],r[c+o],i[c],i[c+1],i[c+o]),oI(n,t,r[c+o+1],r[c+1],r[c+o],i[c+o+1],i[c+1],i[c+o])}break;case q3.TRIANGLES:for(s=0,a=r.length;s<a;s+=3)oI(n,t,r[s],r[s+1],r[s+2],i[s],i[s+1],i[s+2]);break;default:throw new Error("illegal figure")}}class T0e extends m4{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,r){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-o,c=Math.ceil(this._bounds[3])-l,h=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),d=Math.min(Math.ceil(Math.abs(c*e[1]*1.1)),3e3),f=u/h,p=c/d,m={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/f,scaleY:1/p},y=h+2*2,v=d+2*2,b=r.getCanvas("mesh",y,v),x=b.context,w=x.createImageData(h,d);if(t){const E=w.data;for(let A=0,T=E.length;A<T;A+=4)E[A]=t[0],E[A+1]=t[1],E[A+2]=t[2],E[A+3]=255}for(const E of this._figures)A0e(w,E,m);return x.putImageData(w,2,2),{canvas:b.canvas,offsetX:o-2*f,offsetY:l-2*p,scaleX:f,scaleY:p}}isModifyingCurrentTransform(){return!0}getPattern(e,t,r,i){_F(e,this._bbox);const s=new Float32Array(2);if(i===xs.SHADING)yt.singularValueDecompose2dScale(Lr(e),s);else if(this.matrix){yt.singularValueDecompose2dScale(this.matrix,s);const[o,l]=s;yt.singularValueDecompose2dScale(t.baseTransform,s),s[0]*=o,s[1]*=l}else yt.singularValueDecompose2dScale(t.baseTransform,s);const a=this._createMeshCanvas(s,i===xs.SHADING?null:this._background,t.cachedCanvases);return i!==xs.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class M0e extends m4{getPattern(){return"hotpink"}}function C0e(n){switch(n[0]){case"RadialAxial":return new S0e(n);case"Mesh":return new T0e(n);case"Dummy":return new M0e}throw new Error(`Unknown IR type: ${n[0]}`)}const f8={COLORED:1,UNCOLORED:2},f2=class f2{constructor(e,t,r,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=r,this.baseTransform=i}createPatternCanvas(e,t){var H,Q;const{bbox:r,operatorList:i,paintType:s,tilingType:a,color:o,canvasGraphicsFactory:l}=this;let{xstep:u,ystep:c}=this;u=Math.abs(u),c=Math.abs(c),yN("TilingType: "+a);const h=r[0],d=r[1],f=r[2],p=r[3],m=f-h,y=p-d,v=new Float32Array(2);yt.singularValueDecompose2dScale(this.matrix,v);const[b,x]=v;yt.singularValueDecompose2dScale(this.baseTransform,v);const w=b*v[0],_=x*v[1];let E=m,A=y,T=!1,S=!1;const M=Math.ceil(u*w),D=Math.ceil(c*_),N=Math.ceil(m*w),R=Math.ceil(y*_);M>=N?E=u:T=!0,D>=R?A=c:S=!0;const O=this.getSizeAndScale(E,this.ctx.canvas.width,w),G=this.getSizeAndScale(A,this.ctx.canvas.height,_),I=e.cachedCanvases.getCanvas("pattern",O.size,G.size),B=I.context,$=l.createCanvasGraphics(B,t);if($.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext($,s,o),B.translate(-O.scale*h,-G.scale*d),$.transform(0,O.scale,0,0,G.scale,0,0),B.save(),(H=$.dependencyTracker)==null||H.save(),this.clipBbox($,h,d,f,p),$.baseTransform=Lr($.ctx),$.executeOperatorList(i),$.endDrawing(),(Q=$.dependencyTracker)==null||Q.restore(),B.restore(),T||S){const ee=I.canvas;T&&(E=u),S&&(A=c);const J=this.getSizeAndScale(E,this.ctx.canvas.width,w),L=this.getSizeAndScale(A,this.ctx.canvas.height,_),se=J.size,Z=L.size,le=e.cachedCanvases.getCanvas("pattern-workaround",se,Z),ue=le.context,te=T?Math.floor(m/u):0,Y=S?Math.floor(y/c):0;for(let ie=0;ie<=te;ie++)for(let ve=0;ve<=Y;ve++)ue.drawImage(ee,se*ie,Z*ve,se,Z,0,0,se,Z);return{canvas:le.canvas,scaleX:J.scale,scaleY:L.scale,offsetX:h,offsetY:d}}return{canvas:I.canvas,scaleX:O.scale,scaleY:G.scale,offsetX:h,offsetY:d}}getSizeAndScale(e,t,r){const i=Math.max(f2.MAX_PATTERN_SIZE,t);let s=Math.ceil(e*r);return s>=i?s=i:r=s/e,{scale:r,size:s}}clipBbox(e,t,r,i,s){const a=i-t,o=s-r;e.ctx.rect(t,r,a,o),yt.axialAlignedBoundingBox([t,r,i,s],Lr(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,r){const i=e.ctx,s=e.current;switch(t){case f8.COLORED:const{fillStyle:a,strokeStyle:o}=this.ctx;i.fillStyle=s.fillColor=a,i.strokeStyle=s.strokeColor=o;break;case f8.UNCOLORED:i.fillStyle=i.strokeStyle=r,s.fillColor=s.strokeColor=r;break;default:throw new zve(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,r,i,s){let a=r;i!==xs.SHADING&&(a=yt.transform(a,t.baseTransform),this.matrix&&(a=yt.transform(a,this.matrix)));const o=this.createPatternCanvas(t,s);let l=new DOMMatrix(a);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const u=e.createPattern(o.canvas,"repeat");return u.setTransform(l),u}};Qe(f2,"MAX_PATTERN_SIZE",3e3);let wF=f2;function D0e({src:n,srcPos:e=0,dest:t,width:r,height:i,nonBlackColor:s=4294967295,inverseDecode:a=!1}){const o=Cs.isLittleEndian?4278190080:255,[l,u]=a?[s,o]:[o,s],c=r>>3,h=r&7,d=n.length;t=new Uint32Array(t.buffer);let f=0;for(let p=0;p<i;p++){for(const y=e+c;e<y;e++){const v=e<d?n[e]:255;t[f++]=v&128?u:l,t[f++]=v&64?u:l,t[f++]=v&32?u:l,t[f++]=v&16?u:l,t[f++]=v&8?u:l,t[f++]=v&4?u:l,t[f++]=v&2?u:l,t[f++]=v&1?u:l}if(h===0)continue;const m=e<d?n[e++]:255;for(let y=0;y<h;y++)t[f++]=m&1<<7-y?u:l}return{srcPos:e,destPos:f}}const p8=16,m8=100,N0e=15,g8=10,Ha=16,lI=new DOMMatrix,Do=new Float32Array(2),ry=new Float32Array([1/0,1/0,-1/0,-1/0]);function R0e(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,r){e.translate(t,r),this.__originalTranslate(t,r)},n.scale=function(t,r){e.scale(t,r),this.__originalScale(t,r)},n.transform=function(t,r,i,s,a,o){e.transform(t,r,i,s,a,o),this.__originalTransform(t,r,i,s,a,o)},n.setTransform=function(t,r,i,s,a,o){e.setTransform(t,r,i,s,a,o),this.__originalSetTransform(t,r,i,s,a,o)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,r){e.moveTo(t,r),this.__originalMoveTo(t,r)},n.lineTo=function(t,r){e.lineTo(t,r),this.__originalLineTo(t,r)},n.bezierCurveTo=function(t,r,i,s,a,o){e.bezierCurveTo(t,r,i,s,a,o),this.__originalBezierCurveTo(t,r,i,s,a,o)},n.rect=function(t,r,i,s){e.rect(t,r,i,s),this.__originalRect(t,r,i,s)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class I0e{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,r){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,r)):(i=this.canvasFactory.create(t,r),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function nT(n,e,t,r,i,s,a,o,l,u){const[c,h,d,f,p,m]=Lr(n);if(h===0&&d===0){const b=a*c+p,x=Math.round(b),w=o*f+m,_=Math.round(w),E=(a+l)*c+p,A=Math.abs(Math.round(E)-x)||1,T=(o+u)*f+m,S=Math.abs(Math.round(T)-_)||1;return n.setTransform(Math.sign(c),0,0,Math.sign(f),x,_),n.drawImage(e,t,r,i,s,0,0,A,S),n.setTransform(c,h,d,f,p,m),[A,S]}if(c===0&&f===0){const b=o*d+p,x=Math.round(b),w=a*h+m,_=Math.round(w),E=(o+u)*d+p,A=Math.abs(Math.round(E)-x)||1,T=(a+l)*h+m,S=Math.abs(Math.round(T)-_)||1;return n.setTransform(0,Math.sign(h),Math.sign(d),0,x,_),n.drawImage(e,t,r,i,s,0,0,S,A),n.setTransform(c,h,d,f,p,m),[S,A]}n.drawImage(e,t,r,i,s,a,o,l,u);const y=Math.hypot(c,h),v=Math.hypot(d,f);return[y*l,v*u]}class v8{constructor(e,t,r){Qe(this,"alphaIsShape",!1);Qe(this,"fontSize",0);Qe(this,"fontSizeScale",1);Qe(this,"textMatrix",null);Qe(this,"textMatrixScale",1);Qe(this,"fontMatrix",j3);Qe(this,"leading",0);Qe(this,"x",0);Qe(this,"y",0);Qe(this,"lineX",0);Qe(this,"lineY",0);Qe(this,"charSpacing",0);Qe(this,"wordSpacing",0);Qe(this,"textHScale",1);Qe(this,"textRenderingMode",cs.FILL);Qe(this,"textRise",0);Qe(this,"fillColor","#000000");Qe(this,"strokeColor","#000000");Qe(this,"patternFill",!1);Qe(this,"patternStroke",!1);Qe(this,"fillAlpha",1);Qe(this,"strokeAlpha",1);Qe(this,"lineWidth",1);Qe(this,"activeSMask",null);Qe(this,"transferMaps","none");r==null||r(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=ry.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=xs.FILL,t=null){const r=this.minMax.slice();if(e===xs.STROKE){t||fr("Stroke bounding box must include transform."),yt.singularValueDecompose2dScale(t,Do);const i=Do[0]*this.lineWidth/2,s=Do[1]*this.lineWidth/2;r[0]-=i,r[1]-=s,r[2]+=i,r[3]+=s}return r}updateClipFromPath(){const e=yt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(ry,0)}getClippedPathBoundingBox(e=xs.FILL,t=null){return yt.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function y8(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,r=e.width,i=t%Ha,s=(t-i)/Ha,a=i===0?s:s+1,o=n.createImageData(r,Ha);let l=0,u;const c=e.data,h=o.data;let d,f,p,m;if(e.kind===EM.GRAYSCALE_1BPP){const y=c.byteLength,v=new Uint32Array(h.buffer,0,h.byteLength>>2),b=v.length,x=r+7>>3,w=4294967295,_=Cs.isLittleEndian?4278190080:255;for(d=0;d<a;d++){for(p=d<s?Ha:i,u=0,f=0;f<p;f++){const E=y-l;let A=0;const T=E>x?r:E*8-7,S=T&-8;let M=0,D=0;for(;A<S;A+=8)D=c[l++],v[u++]=D&128?w:_,v[u++]=D&64?w:_,v[u++]=D&32?w:_,v[u++]=D&16?w:_,v[u++]=D&8?w:_,v[u++]=D&4?w:_,v[u++]=D&2?w:_,v[u++]=D&1?w:_;for(;A<T;A++)M===0&&(D=c[l++],M=128),v[u++]=D&M?w:_,M>>=1}for(;u<b;)v[u++]=0;n.putImageData(o,0,d*Ha)}}else if(e.kind===EM.RGBA_32BPP){for(f=0,m=r*Ha*4,d=0;d<s;d++)h.set(c.subarray(l,l+m)),l+=m,n.putImageData(o,0,f),f+=Ha;d<a&&(m=r*i*4,h.set(c.subarray(l,l+m)),n.putImageData(o,0,f))}else if(e.kind===EM.RGB_24BPP)for(p=Ha,m=r*p,d=0;d<a;d++){for(d>=s&&(p=i,m=r*p),u=0,f=m;f--;)h[u++]=c[l++],h[u++]=c[l++],h[u++]=c[l++],h[u++]=255;n.putImageData(o,0,d*Ha)}else throw new Error(`bad image kind: ${e.kind}`)}function x8(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,r=e.width,i=t%Ha,s=(t-i)/Ha,a=i===0?s:s+1,o=n.createImageData(r,Ha);let l=0;const u=e.data,c=o.data;for(let h=0;h<a;h++){const d=h<s?Ha:i;({srcPos:l}=D0e({src:u,srcPos:l,dest:c,width:r,height:d,nonBlackColor:0})),n.putImageData(o,0,h*Ha)}}function y_(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const r of t)n[r]!==void 0&&(e[r]=n[r]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function rT(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function b8(n,e){if(e)return!0;yt.singularValueDecompose2dScale(n,Do);const t=Math.fround(Ec.pixelRatio*Rp.PDF_TO_CSS_UNITS);return Do[0]<=t&&Do[1]<=t}const P0e=["butt","round","square"],F0e=["miter","round","bevel"],L0e={},_8={};var gu,EF,SF,AF;const zU=class zU{constructor(e,t,r,i,s,{optionalContentConfig:a,markedContentStack:o=null},l,u,c){j(this,gu);this.ctx=e,this.current=new v8(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=r,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new I0e(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=c??null}getObject(e,t,r=null){var i;return typeof t=="string"?((i=this.dependencyTracker)==null||i.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):r}beginDrawing({transform:e,viewport:t,transparency:r=!1,background:i=null}){const s=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,a),this.ctx.fillStyle=o,r){const l=this.cachedCanvases.getCanvas("transparent",s,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Lr(this.compositeCtx))}this.ctx.save(),rT(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Lr(this.ctx)}executeOperatorList(e,t,r,i,s){var v;const a=e.argsArray,o=e.fnArray;let l=t||0;const u=a.length;if(u===l)return l;const c=u-l>g8&&typeof r=="function",h=c?Date.now()+N0e:0;let d=0;const f=this.commonObjs,p=this.objs;let m,y;for(;;){if(i!==void 0&&l===i.nextBreakPoint)return i.breakIt(l,r),l;if(!s||s(l))if(m=o[l],y=a[l]??null,m!==bw.dependency)y===null?this[m](l):this[m](l,...y);else for(const b of y){(v=this.dependencyTracker)==null||v.recordNamedData(b,l);const x=b.startsWith("g_")?f:p;if(!x.has(b))return x.get(b,r),l}if(l++,l===u)return l;if(c&&++d>g8){if(Date.now()>h)return r(),l;d=0}}}endDrawing(){X(this,gu,EF).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),X(this,gu,SF).call(this)}_scaleImage(e,t){const r=e.width??e.displayWidth,i=e.height??e.displayHeight;let s=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=r,l=i,u="prescale1",c,h;for(;s>2&&o>1||a>2&&l>1;){let d=o,f=l;s>2&&o>1&&(d=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),s/=o/d),a>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/f),c=this.cachedCanvases.getCanvas(u,d,f),h=c.context,h.clearRect(0,0,d,f),h.drawImage(e,0,0,o,l,0,0,d,f),e=c.canvas,o=d,l=f,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e,t){var M,D;const r=this.ctx,{width:i,height:s}=t,a=this.current.fillColor,o=this.current.patternFill,l=Lr(r);let u,c,h,d;if((t.bitmap||t.data)&&t.count>1){const N=t.bitmap||t.data.buffer;c=JSON.stringify(o?l:[l.slice(0,4),a]),u=this._cachedBitmapsMap.get(N),u||(u=new Map,this._cachedBitmapsMap.set(N,u));const R=u.get(c);if(R&&!o){const O=Math.round(Math.min(l[0],l[2])+l[4]),G=Math.round(Math.min(l[1],l[3])+l[5]);return(M=this.dependencyTracker)==null||M.recordDependencies(e,Wo.transformAndFill),{canvas:R,offsetX:O,offsetY:G}}h=R}h||(d=this.cachedCanvases.getCanvas("maskCanvas",i,s),x8(d.context,t));let f=yt.transform(l,[1/i,0,0,-1/s,0,0]);f=yt.transform(f,[1,0,0,1,0,-s]);const p=ry.slice();yt.axialAlignedBoundingBox([0,0,i,s],f,p);const[m,y,v,b]=p,x=Math.round(v-m)||1,w=Math.round(b-y)||1,_=this.cachedCanvases.getCanvas("fillCanvas",x,w),E=_.context,A=m,T=y;E.translate(-A,-T),E.transform(...f),h||(h=this._scaleImage(d.canvas,Cu(E)),h=h.img,u&&o&&u.set(c,h)),E.imageSmoothingEnabled=b8(Lr(E),t.interpolate),nT(E,h,0,0,h.width,h.height,0,0,i,s),E.globalCompositeOperation="source-in";const S=yt.transform(Cu(E),[1,0,0,1,-A,-T]);return E.fillStyle=o?a.getPattern(r,this,S,xs.FILL,e):a,E.fillRect(0,0,i,s),u&&!o&&(this.cachedCanvases.delete("fillCanvas"),u.set(c,_.canvas)),(D=this.dependencyTracker)==null||D.recordDependencies(e,Wo.transformAndFill),{canvas:_.canvas,offsetX:Math.round(A),offsetY:Math.round(T)}}setLineWidth(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("lineCap",e),this.ctx.lineCap=P0e[t]}setLineJoin(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("lineJoin",e),this.ctx.lineJoin=F0e[t]}setMiterLimit(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,r){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("dash",e);const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=r)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var r,i,s,a,o;for(const[l,u]of t)switch(l){case"LW":this.setLineWidth(e,u);break;case"LC":this.setLineCap(e,u);break;case"LJ":this.setLineJoin(e,u);break;case"ML":this.setMiterLimit(e,u);break;case"D":this.setDash(e,u[0],u[1]);break;case"RI":this.setRenderingIntent(e,u);break;case"FL":this.setFlatness(e,u);break;case"Font":this.setFont(e,u[0],u[1]);break;case"CA":(r=this.dependencyTracker)==null||r.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=u;break;case"ca":(i=this.dependencyTracker)==null||i.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=u;break;case"BM":(s=this.dependencyTracker)==null||s.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=u;break;case"SMask":(a=this.dependencyTracker)==null||a.recordSimpleData("SMask",e),this.current.activeSMask=u?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(o=this.dependencyTracker)==null||o.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(u);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,r=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,t,r);this.suspendedCtx=this.ctx;const a=this.ctx=s.context;a.setTransform(this.suspendedCtx.getTransform()),y_(this.suspendedCtx,a),R0e(a,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),y_(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,r=this.suspendedCtx;this.composeSMask(r,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,r,i){const s=i[0],a=i[1],o=i[2]-s,l=i[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,r,o,l,t.subtype,t.backdrop,t.transferMap,s,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(r.canvas,0,0),e.restore())}genericComposeSMask(e,t,r,i,s,a,o,l,u,c,h){let d=e.canvas,f=l-c,p=u-h;if(a)if(f<0||p<0||f+r>d.width||p+i>d.height){const y=this.cachedCanvases.getCanvas("maskExtension",r,i),v=y.context;v.drawImage(d,-f,-p),v.globalCompositeOperation="destination-atop",v.fillStyle=a,v.fillRect(0,0,r,i),v.globalCompositeOperation="source-over",d=y.canvas,f=p=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const y=new Path2D;y.rect(f,p,r,i),e.clip(y),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(f,p,r,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),s==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):s==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const m=new Path2D;m.rect(l,u,r,i),t.clip(m),t.globalCompositeOperation="destination-in",t.drawImage(d,f,p,r,i,l,u,r,i),t.restore()}save(e){var r;this.inSMaskMode&&y_(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(r=this.dependencyTracker)==null||r.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&y_(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,r,i,s,a,o){var l;(l=this.dependencyTracker)==null||l.recordIncrementalData("transform",e),this.ctx.transform(t,r,i,s,a,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,r,i){let[s]=r;if(!i){s||(s=r[0]=new Path2D),this[t](e,s);return}if(this.dependencyTracker!==null){const a=t===bw.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,i[0]-a,i[2]+a,i[1]-a,i[3]+a).recordDependencies(e,["transform"])}s instanceof Path2D||(s=r[0]=kQ(s)),yt.axialAlignedBoundingBox(i,Lr(this.ctx),this.current.minMax),this[t](e,s),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,r=!0){var a;const i=this.ctx,s=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof s=="object"&&(s!=null&&s.getPattern)){const o=s.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=s.getPattern(i,this,Cu(i),xs.STROKE,e),o){const l=new Path2D;l.addPath(t,i.getTransform().invertSelf().multiplySelf(o)),t=l}this.rescaleAndStroke(t,!1),i.restore()}else this.rescaleAndStroke(t,!0);(a=this.dependencyTracker)==null||a.recordDependencies(e,Wo.stroke),r&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(xs.STROKE,Lr(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,r=!0){var u,c,h;const i=this.ctx,s=this.current.fillColor,a=this.current.patternFill;let o=!1;if(a){const d=s.isModifyingCurrentTransform()?i.getTransform():null;if((u=this.dependencyTracker)==null||u.save(e),i.save(),i.fillStyle=s.getPattern(i,this,Cu(i),xs.FILL,e),d){const f=new Path2D;f.addPath(t,i.getTransform().invertSelf().multiplySelf(d)),t=f}o=!0}const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(i.fill(t,"evenodd"),this.pendingEOFill=!1):i.fill(t)),(c=this.dependencyTracker)==null||c.recordDependencies(e,Wo.fill),o&&(i.restore(),(h=this.dependencyTracker)==null||h.restore(e)),r&&this.consumePath(e,t,l)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var r;this.ctx.fill(t),(r=this.dependencyTracker)==null||r.recordDependencies(e,Wo.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=L0e}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=_8}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,r=this.ctx;if(this.dependencyTracker){const{dependencyTracker:i}=this;t!==void 0&&i.recordFutureForcedDependency("textClip",i.getOpenMarker()).recordFutureForcedDependency("textClip",e),i.recordCloseMarker(e)}if(t!==void 0){const i=new Path2D,s=r.getTransform().invertSelf();for(const{transform:a,x:o,y:l,fontSize:u,path:c}of t)c&&i.addPath(c,new DOMMatrix(a).preMultiplySelf(s).translate(o,l).scale(u,-u));r.clip(i)}delete this.pendingTextPaths}setCharSpacing(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,r){var h,d;(h=this.dependencyTracker)==null||h.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const i=this.commonObjs.get(t),s=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(s.fontMatrix=i.fontMatrix||j3,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&Xt("Invalid font matrix for font "+t),r<0?(r=-r,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=r,i.isType3Font)return;const a=i.loadedName||"sans-serif",o=((d=i.systemFontInfo)==null?void 0:d.css)||`"${a}", ${i.fallbackName}`;let l="normal";i.black?l="900":i.bold&&(l="bold");const u=i.italic?"italic":"normal";let c=r;r<p8?c=p8:r>m8&&(c=m8),this.current.fontSizeScale=r/c,this.ctx.font=`${u} ${l} ${c}px ${o}`}setTextRenderingMode(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,r){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=r}setLeadingMoveText(e,t,r){this.setLeading(e,-r),this.moveText(e,t,r)}setTextMatrix(e,t){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:r}=this;r.textMatrix=t,r.textMatrixScale=Math.hypot(t[0],t[1]),r.x=r.lineX=0,r.y=r.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,r,i,s,a){var v,b,x,w;const o=this.ctx,l=this.current,u=l.font,c=l.textRenderingMode,h=l.fontSize/l.fontSizeScale,d=c&cs.FILL_STROKE_MASK,f=!!(c&cs.ADD_TO_PATH_FLAG),p=l.patternFill&&!u.missingFile,m=l.patternStroke&&!u.missingFile;let y;if((u.disableFontFace||f||p||m)&&!u.missingFile&&(y=u.getPathGenerator(this.commonObjs,t)),y&&(u.disableFontFace||p||m)){o.save(),o.translate(r,i),o.scale(h,-h),(v=this.dependencyTracker)==null||v.recordCharacterBBox(e,o,u);let _;if(d===cs.FILL||d===cs.FILL_STROKE)if(s){_=o.getTransform(),o.setTransform(...s);const E=X(this,gu,AF).call(this,y,_,s);o.fill(E)}else o.fill(y);if(d===cs.STROKE||d===cs.FILL_STROKE)if(a){_||(_=o.getTransform()),o.setTransform(...a);const{a:E,b:A,c:T,d:S}=_,M=yt.inverseTransform(a),D=yt.transform([E,A,T,S,0,0],M);yt.singularValueDecompose2dScale(D,Do),o.lineWidth*=Math.max(Do[0],Do[1])/h,o.stroke(X(this,gu,AF).call(this,y,_,a))}else o.lineWidth/=h,o.stroke(y);o.restore()}else(d===cs.FILL||d===cs.FILL_STROKE)&&(o.fillText(t,r,i),(b=this.dependencyTracker)==null||b.recordCharacterBBox(e,o,u,h,r,i,()=>o.measureText(t))),(d===cs.STROKE||d===cs.FILL_STROKE)&&(this.dependencyTracker&&((x=this.dependencyTracker)==null||x.recordCharacterBBox(e,o,u,h,r,i,()=>o.measureText(t)).recordDependencies(e,Wo.stroke)),o.strokeText(t,r,i));f&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Lr(o),x:r,y:i,fontSize:h,path:y}),(w=this.dependencyTracker)==null||w.recordCharacterBBox(e,o,u,h,r,i))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let r=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){r=!0;break}return Kt(this,"isFontSubpixelAAEnabled",r)}showText(e,t){var T,S,M,D;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,Wo.showText).resetBBox(e),this.current.textRenderingMode&cs.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const r=this.current,i=r.font;if(i.isType3Font){this.showType3Text(e,t),(T=this.dependencyTracker)==null||T.recordShowTextOperation(e);return}const s=r.fontSize;if(s===0){(S=this.dependencyTracker)==null||S.recordOperation(e);return}const a=this.ctx,o=r.fontSizeScale,l=r.charSpacing,u=r.wordSpacing,c=r.fontDirection,h=r.textHScale*c,d=t.length,f=i.vertical,p=f?1:-1,m=i.defaultVMetrics,y=s*r.fontMatrix[0],v=r.textRenderingMode===cs.FILL&&!i.disableFontFace&&!r.patternFill;a.save(),r.textMatrix&&a.transform(...r.textMatrix),a.translate(r.x,r.y+r.textRise),c>0?a.scale(h,-1):a.scale(h,1);let b,x;if(r.patternFill){a.save();const N=r.fillColor.getPattern(a,this,Cu(a),xs.FILL,e);b=Lr(a),a.restore(),a.fillStyle=N}if(r.patternStroke){a.save();const N=r.strokeColor.getPattern(a,this,Cu(a),xs.STROKE,e);x=Lr(a),a.restore(),a.strokeStyle=N}let w=r.lineWidth;const _=r.textMatrixScale;if(_===0||w===0){const N=r.textRenderingMode&cs.FILL_STROKE_MASK;(N===cs.STROKE||N===cs.FILL_STROKE)&&(w=this.getSinglePixelWidth())}else w/=_;if(o!==1&&(a.scale(o,o),w/=o),a.lineWidth=w,i.isInvalidPDFjsFont){const N=[];let R=0;for(const G of t)N.push(G.unicode),R+=G.width;const O=N.join("");if(a.fillText(O,0,0),this.dependencyTracker!==null){const G=a.measureText(O);this.dependencyTracker.recordBBox(e,this.ctx,-G.actualBoundingBoxLeft,G.actualBoundingBoxRight,-G.actualBoundingBoxAscent,G.actualBoundingBoxDescent).recordShowTextOperation(e)}r.x+=R*y*h,a.restore(),this.compose();return}let E=0,A;for(A=0;A<d;++A){const N=t[A];if(typeof N=="number"){E+=p*N*s/1e3;continue}let R=!1;const O=(N.isSpace?u:0)+l,G=N.fontChar,I=N.accent;let B,$,H=N.width;if(f){const J=N.vmetric||m,L=-(N.vmetric?J[1]:H*.5)*y,se=J[2]*y;H=J?-J[0]:H,B=L/o,$=(E+se)/o}else B=E/o,$=0;let Q;if(i.remeasure&&H>0){Q=a.measureText(G);const J=Q.width*1e3/s*o;if(H<J&&this.isFontSubpixelAAEnabled){const L=H/J;R=!0,a.save(),a.scale(L,1),B/=L}else H!==J&&(B+=(H-J)/2e3*s/o)}if(this.contentVisible&&(N.isInFont||i.missingFile)){if(v&&!I)a.fillText(G,B,$),(M=this.dependencyTracker)==null||M.recordCharacterBBox(e,a,Q?{bbox:null}:i,s/o,B,$,()=>Q??a.measureText(G));else if(this.paintChar(e,G,B,$,b,x),I){const J=B+s*I.offset.x/o,L=$-s*I.offset.y/o;this.paintChar(e,I.fontChar,J,L,b,x)}}const ee=f?H*y-O*c:H*y+O*c;E+=ee,R&&a.restore()}f?r.y-=E:r.x+=E*h,a.restore(),this.compose(),(D=this.dependencyTracker)==null||D.recordShowTextOperation(e)}showType3Text(e,t){const r=this.ctx,i=this.current,s=i.font,a=i.fontSize,o=i.fontDirection,l=s.vertical?1:-1,u=i.charSpacing,c=i.wordSpacing,h=i.textHScale*o,d=i.fontMatrix||j3,f=t.length,p=i.textRenderingMode===cs.INVISIBLE;let m,y,v,b;if(p||a===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,r.save(),i.textMatrix&&r.transform(...i.textMatrix),r.translate(i.x,i.y+i.textRise),r.scale(h,o);const x=this.dependencyTracker;for(this.dependencyTracker=x?new cD(x,e):null,m=0;m<f;++m){if(y=t[m],typeof y=="number"){b=l*y*a/1e3,this.ctx.translate(b,0),i.x+=b*h;continue}const w=(y.isSpace?c:0)+u,_=s.charProcOperatorList[y.operatorListId];_?this.contentVisible&&(this.save(),r.scale(a,a),r.transform(...d),this.executeOperatorList(_),this.restore()):Xt(`Type3 character "${y.operatorListId}" is not available.`);const E=[y.width,0];yt.applyTransform(E,d),v=E[0]*a+w,r.translate(v,0),i.x+=v*h}r.restore(),x&&(this.dependencyTracker=x)}setCharWidth(e,t,r){}setCharWidthAndBounds(e,t,r,i,s,a,o){var u;const l=new Path2D;l.rect(i,s,a-i,o-s),this.ctx.clip(l),(u=this.dependencyTracker)==null||u.recordBBox(e,this.ctx,i,a,s,o).recordClipBox(e,this.ctx,i,a,s,o),this.endPath(e)}getColorN_Pattern(e,t){let r;if(t[0]==="TilingPattern"){const i=this.baseTransform||Lr(this.ctx),s={createCanvasGraphics:(a,o)=>new zU(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new cD(this.dependencyTracker,o,!0):null)};r=new wF(t,this.ctx,s,i)}else r=this._getPattern(e,t[1],t[2]);return r}setStrokeColorN(e,...t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,r=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=C0e(this.getObject(e,t)),this.cachedPatterns.set(t,i)),r&&(i.matrix=r),i}shadingFill(e,t){var a;if(!this.contentVisible)return;const r=this.ctx;this.save(e);const i=this._getPattern(e,t);r.fillStyle=i.getPattern(r,this,Cu(r),xs.SHADING,e);const s=Cu(r);if(s){const{width:o,height:l}=r.canvas,u=ry.slice();yt.axialAlignedBoundingBox([0,0,o,l],s,u);const[c,h,d,f]=u;this.ctx.fillRect(c,h,d-c,f-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(a=this.dependencyTracker)==null||a.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,Wo.transform).recordDependencies(e,Wo.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){fr("Should not call beginInlineImage")}beginImageData(){fr("Should not call beginImageData")}paintFormXObjectBegin(e,t,r){var i;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Lr(this.ctx),r)){yt.axialAlignedBoundingBox(r,this.baseTransform,this.current.minMax);const[s,a,o,l]=r,u=new Path2D;u.rect(s,a,o-s,l-a),this.ctx.clip(u),(i=this.dependencyTracker)==null||i.recordClipBox(e,this.ctx,s,o,a,l),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var x;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const r=this.ctx;t.isolated||yN("TODO: Support non-isolated groups."),t.knockout&&Xt("Knockout groups not supported.");const i=Lr(r);if(t.matrix&&r.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let s=ry.slice();yt.axialAlignedBoundingBox(t.bbox,Lr(r),s);const a=[0,0,r.canvas.width,r.canvas.height];s=yt.intersect(s,a)||[0,0,0,0];const o=Math.floor(s[0]),l=Math.floor(s[1]),u=Math.max(Math.ceil(s[2])-o,1),c=Math.max(Math.ceil(s[3])-l,1);this.current.startNewPathAndClipBox([0,0,u,c]);let h="groupAt"+this.groupLevel;t.smask&&(h+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(h,u,c),f=d.context;f.translate(-o,-l),f.transform(...i);let p=new Path2D;const[m,y,v,b]=t.bbox;if(p.rect(m,y,v-m,b-y),t.matrix){const w=new Path2D;w.addPath(p,new DOMMatrix(t.matrix)),p=w}f.clip(p),t.smask&&this.smaskStack.push({canvas:d.canvas,context:f,offsetX:o,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(r.setTransform(1,0,0,1,0,0),r.translate(o,l),r.save()),y_(r,f),this.ctx=f,(x=this.dependencyTracker)==null||x.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(r),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(r),this.groupLevel++}endGroup(e,t){var s;if(!this.contentVisible)return;this.groupLevel--;const r=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,(s=this.dependencyTracker)==null||s.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=Lr(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...a);const o=ry.slice();yt.axialAlignedBoundingBox([0,0,r.canvas.width,r.canvas.height],a,o),this.ctx.drawImage(r.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(e,t,r,i,s,a){if(X(this,gu,EF).call(this),rT(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),r){const o=r[2]-r[0],l=r[3]-r[1];if(a&&this.annotationCanvasMap){i=i.slice(),i[4]-=r[0],i[5]-=r[1],r=r.slice(),r[0]=r[1]=0,r[2]=o,r[3]=l,yt.singularValueDecompose2dScale(Lr(this.ctx),Do);const{viewportScale:u}=this,c=Math.ceil(o*this.outputScaleX*u),h=Math.ceil(l*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(c,h);const{canvas:d,context:f}=this.annotationCanvas;this.annotationCanvasMap.set(t,d),this.annotationCanvas.savedCtx=this.ctx,this.ctx=f,this.ctx.save(),this.ctx.setTransform(Do[0],0,0,-Do[1],0,l*Do[1]),rT(this.ctx)}else{rT(this.ctx),this.endPath(e);const u=new Path2D;u.rect(r[0],r[1],o,l),this.ctx.clip(u)}}this.current=new v8(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...i),this.transform(e,...s)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),X(this,gu,SF).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var o;if(!this.contentVisible)return;const r=t.count;t=this.getObject(e,t.data,t),t.count=r;const i=this.ctx,s=this._createMaskCanvas(e,t),a=s.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,s.offsetX,s.offsetY),(o=this.dependencyTracker)==null||o.resetBBox(e).recordBBox(e,this.ctx,s.offsetX,s.offsetX+a.width,s.offsetY,s.offsetY+a.height).recordOperation(e),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,r,i=0,s=0,a,o){var h,d,f;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const l=this.ctx;l.save();const u=Lr(l);l.transform(r,i,s,a,0,0);const c=this._createMaskCanvas(e,t);l.setTransform(1,0,0,1,c.offsetX-u[4],c.offsetY-u[5]),(h=this.dependencyTracker)==null||h.resetBBox(e);for(let p=0,m=o.length;p<m;p+=2){const y=yt.transform(u,[r,i,s,a,o[p],o[p+1]]);l.drawImage(c.canvas,y[4],y[5]),(d=this.dependencyTracker)==null||d.recordBBox(e,this.ctx,y[4],y[4]+c.canvas.width,y[5],y[5]+c.canvas.height)}l.restore(),this.compose(),(f=this.dependencyTracker)==null||f.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var a,o,l;if(!this.contentVisible)return;const r=this.ctx,i=this.current.fillColor,s=this.current.patternFill;(a=this.dependencyTracker)==null||a.resetBBox(e).recordDependencies(e,Wo.transformAndFill);for(const u of t){const{data:c,width:h,height:d,transform:f}=u,p=this.cachedCanvases.getCanvas("maskCanvas",h,d),m=p.context;m.save();const y=this.getObject(e,c,u);x8(m,y),m.globalCompositeOperation="source-in",m.fillStyle=s?i.getPattern(m,this,Cu(r),xs.FILL,e):i,m.fillRect(0,0,h,d),m.restore(),r.save(),r.transform(...f),r.scale(1,-1),nT(r,p.canvas,0,0,h,d,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(e,r,0,h,0,d),r.restore()}this.compose(),(l=this.dependencyTracker)==null||l.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const r=this.getObject(e,t);if(!r){Xt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,r)}paintImageXObjectRepeat(e,t,r,i,s){if(!this.contentVisible)return;const a=this.getObject(e,t);if(!a){Xt("Dependent image isn't ready yet");return}const o=a.width,l=a.height,u=[];for(let c=0,h=s.length;c<h;c+=2)u.push({transform:[r,0,0,i,s[c],s[c+1]],x:0,y:0,w:o,h:l});this.paintInlineImageXObjectGroup(e,a,u)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:r,height:i}=e,s=this.cachedCanvases.getCanvas("inlineImage",r,i),a=s.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",s.canvas}paintInlineImageXObject(e,t){var u;if(!this.contentVisible)return;const r=t.width,i=t.height,s=this.ctx;this.save(e);const{filter:a}=s;a!=="none"&&a!==""&&(s.filter="none"),s.scale(1/r,-1/i);let o;if(t.bitmap)o=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)o=t;else{const h=this.cachedCanvases.getCanvas("inlineImage",r,i).context;y8(h,t),o=this.applyTransferMapsToCanvas(h)}const l=this._scaleImage(o,Cu(s));s.imageSmoothingEnabled=b8(Lr(s),t.interpolate),(u=this.dependencyTracker)==null||u.resetBBox(e).recordBBox(e,s,0,r,-i,0).recordDependencies(e,Wo.imageXObject).recordOperation(e),nT(s,l.img,0,0,l.paintWidth,l.paintHeight,0,-i,r,i),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,r){var a,o,l;if(!this.contentVisible)return;const i=this.ctx;let s;if(t.bitmap)s=t.bitmap;else{const u=t.width,c=t.height,d=this.cachedCanvases.getCanvas("inlineImage",u,c).context;y8(d,t),s=this.applyTransferMapsToCanvas(d)}(a=this.dependencyTracker)==null||a.resetBBox(e);for(const u of r)i.save(),i.transform(...u.transform),i.scale(1,-1),nT(i,s,u.x,u.y,u.w,u.h,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(e,i,0,1,-1,0),i.restore();(l=this.dependencyTracker)==null||l.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,Wo.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,r){}beginMarkedContent(e,t){var r;(r=this.dependencyTracker)==null||r.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,r){var i;(i=this.dependencyTracker)==null||i.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(r)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,r){var a,o;const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(r);const s=this.ctx;this.pendingClip?(i||(this.pendingClip===_8?s.clip(t,"evenodd"):s.clip(t)),this.pendingClip=null,(a=this.dependencyTracker)==null||a.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(o=this.dependencyTracker)==null||o.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Lr(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),r=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(r,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:r,c:i,d:s}=this.ctx.getTransform();let a,o;if(r===0&&i===0){const l=Math.abs(t),u=Math.abs(s);if(l===u)if(e===0)a=o=1/l;else{const c=l*e;a=o=c<1?1/c:1}else if(e===0)a=1/l,o=1/u;else{const c=l*e,h=u*e;a=c<1?1/c:1,o=h<1?1/h:1}}else{const l=Math.abs(t*s-r*i),u=Math.hypot(t,r),c=Math.hypot(i,s);if(e===0)a=c/l,o=u/l;else{const h=e*l;a=c>h?c/h:1,o=u>h?u/h:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:r,current:{lineWidth:i}}=this,[s,a]=this.getScaleForStroking();if(s===a){r.lineWidth=(i||1)*s,r.stroke(e);return}const o=r.getLineDash();t&&r.save(),r.scale(s,a),lI.a=1/s,lI.d=1/a;const l=new Path2D;if(l.addPath(e,lI),o.length>0){const u=Math.max(s,a);r.setLineDash(o.map(c=>c/u)),r.lineDashOffset/=u}r.lineWidth=i||1,r.stroke(l),t&&r.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};gu=new WeakSet,EF=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},SF=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},AF=function(e,t,r){const i=new Path2D;return i.addPath(e,new DOMMatrix(r).invertSelf().multiplySelf(t)),i};let by=zU;for(const n in bw)by.prototype[n]!==void 0&&(by.prototype[bw[n]]=by.prototype[n]);var wE,EE;class sc{static get workerPort(){return g(this,wE)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");U(this,wE,e)}static get workerSrc(){return g(this,EE)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");U(this,EE,e)}}wE=new WeakMap,EE=new WeakMap,j(sc,wE,null),j(sc,EE,"");var cx,SE;class O0e{constructor({parsedData:e,rawData:t}){j(this,cx);j(this,SE);U(this,cx,e),U(this,SE,t)}getRaw(){return g(this,SE)}get(e){return g(this,cx).get(e)??null}[Symbol.iterator](){return g(this,cx).entries()}}cx=new WeakMap,SE=new WeakMap;const L0=Symbol("INTERNAL");var AE,TE,ME,hx;class k0e{constructor(e,{name:t,intent:r,usage:i,rbGroups:s}){j(this,AE,!1);j(this,TE,!1);j(this,ME,!1);j(this,hx,!0);U(this,AE,!!(e&Mo.DISPLAY)),U(this,TE,!!(e&Mo.PRINT)),this.name=t,this.intent=r,this.usage=i,this.rbGroups=s}get visible(){if(g(this,ME))return g(this,hx);if(!g(this,hx))return!1;const{print:e,view:t}=this.usage;return g(this,AE)?(t==null?void 0:t.viewState)!=="OFF":g(this,TE)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,r=!1){e!==L0&&fr("Internal method `_setVisible` called."),U(this,ME,r),U(this,hx,t)}}AE=new WeakMap,TE=new WeakMap,ME=new WeakMap,hx=new WeakMap;var Af,ir,dx,fx,CE,TF;class B0e{constructor(e,t=Mo.DISPLAY){j(this,CE);j(this,Af,null);j(this,ir,new Map);j(this,dx,null);j(this,fx,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,U(this,fx,e.order);for(const r of e.groups)g(this,ir).set(r.id,new k0e(t,r));if(e.baseState==="OFF")for(const r of g(this,ir).values())r._setVisible(L0,!1);for(const r of e.on)g(this,ir).get(r)._setVisible(L0,!0);for(const r of e.off)g(this,ir).get(r)._setVisible(L0,!1);U(this,dx,this.getHash())}}isVisible(e){if(g(this,ir).size===0)return!0;if(!e)return yN("Optional content group not defined."),!0;if(e.type==="OCG")return g(this,ir).has(e.id)?g(this,ir).get(e.id).visible:(Xt(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return X(this,CE,TF).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!g(this,ir).has(t))return Xt(`Optional content group not found: ${t}`),!0;if(g(this,ir).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!g(this,ir).has(t))return Xt(`Optional content group not found: ${t}`),!0;if(!g(this,ir).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!g(this,ir).has(t))return Xt(`Optional content group not found: ${t}`),!0;if(!g(this,ir).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!g(this,ir).has(t))return Xt(`Optional content group not found: ${t}`),!0;if(g(this,ir).get(t).visible)return!1}return!0}return Xt(`Unknown optional content policy ${e.policy}.`),!0}return Xt(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,r=!0){var s;const i=g(this,ir).get(e);if(!i){Xt(`Optional content group not found: ${e}`);return}if(r&&t&&i.rbGroups.length)for(const a of i.rbGroups)for(const o of a)o!==e&&((s=g(this,ir).get(o))==null||s._setVisible(L0,!1,!0));i._setVisible(L0,!!t,!0),U(this,Af,null)}setOCGState({state:e,preserveRB:t}){let r;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":r=i;continue}const s=g(this,ir).get(i);if(s)switch(r){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!s.visible,t);break}}U(this,Af,null)}get hasInitialVisibility(){return g(this,dx)===null||this.getHash()===g(this,dx)}getOrder(){return g(this,ir).size?g(this,fx)?g(this,fx).slice():[...g(this,ir).keys()]:null}getGroup(e){return g(this,ir).get(e)||null}getHash(){if(g(this,Af)!==null)return g(this,Af);const e=new mZ;for(const[t,r]of g(this,ir))e.update(`${t}:${r.visible}`);return U(this,Af,e.hexdigest())}[Symbol.iterator](){return g(this,ir).entries()}}Af=new WeakMap,ir=new WeakMap,dx=new WeakMap,fx=new WeakMap,CE=new WeakSet,TF=function(e){const t=e.length;if(t<2)return!0;const r=e[0];for(let i=1;i<t;i++){const s=e[i];let a;if(Array.isArray(s))a=X(this,CE,TF).call(this,s);else if(g(this,ir).has(s))a=g(this,ir).get(s).visible;else return Xt(`Optional content group not found: ${s}`),!0;switch(r){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return r==="And"};class U0e{constructor(e,{disableRange:t=!1,disableStream:r=!1}){Sn(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:s,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(s==null?void 0:s.length)>0){const l=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!r,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,u)=>{this._onReceiveData({begin:l,chunk:u})}),e.addProgressListener((l,u)=>{this._onProgress({loaded:l,total:u})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const r=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(r):this._queuedChunks.push(r);else{const i=this._rangeReaders.some(function(s){return s._begin!==e?!1:(s._enqueue(r),!0)});Sn(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,r,i,s;e.total===void 0?(r=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||r.call(t,{loaded:e.loaded}):(s=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||s.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Sn(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new V0e(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new z0e(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeReaders.slice(0))r.cancel(e);this._pdfDataRangeTransport.abort()}}class V0e{constructor(e,t,r=!1,i=null){this._stream=e,this._done=r||!1,this._filename=d4(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class z0e{constructor(e,t,r){this._stream=e,this._begin=t,this._end=r,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function $0e(n){let e=!0,t=r("filename\\*","i").exec(n);if(t){t=t[1];let c=o(t);return c=unescape(c),c=l(c),c=u(c),s(c)}if(t=a(n),t){const c=u(t);return s(c)}if(t=r("filename","i").exec(n),t){t=t[1];let c=o(t);return c=u(c),s(c)}function r(c,h){return new RegExp("(?:^|;)\\s*"+c+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',h)}function i(c,h){if(c){if(!/^[\x00-\xFF]+$/.test(h))return h;try{const d=new TextDecoder(c,{fatal:!0}),f=HS(h);h=d.decode(f),e=!1}catch{}}return h}function s(c){return e&&/[\x80-\xff]/.test(c)&&(c=i("utf-8",c),e&&(c=i("iso-8859-1",c))),c}function a(c){const h=[];let d;const f=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(d=f.exec(c))!==null;){let[,m,y,v]=d;if(m=parseInt(m,10),m in h){if(m===0)break;continue}h[m]=[y,v]}const p=[];for(let m=0;m<h.length&&m in h;++m){let[y,v]=h[m];v=o(v),y&&(v=unescape(v),m===0&&(v=l(v))),p.push(v)}return p.join("")}function o(c){if(c.startsWith('"')){const h=c.slice(1).split('\\"');for(let d=0;d<h.length;++d){const f=h[d].indexOf('"');f!==-1&&(h[d]=h[d].slice(0,f),h.length=d+1),h[d]=h[d].replaceAll(/\\(.)/g,"$1")}c=h.join('"')}return c}function l(c){const h=c.indexOf("'");if(h===-1)return c;const d=c.slice(0,h),p=c.slice(h+1).replace(/^[^']*'/,"");return i(d,p)}function u(c){return!c.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(c)?c:c.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(h,d,f,p){if(f==="q"||f==="Q")return p=p.replaceAll("_"," "),p=p.replaceAll(/=([0-9a-fA-F]{2})/g,function(m,y){return String.fromCharCode(parseInt(y,16))}),i(d,p);try{p=atob(p)}catch{}return i(d,p)})}return""}function MZ(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const r in e){const i=e[r];i!==void 0&&t.append(r,i)}return t}function bN(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function CZ({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:r}){const i={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(n.get("Content-Length"),10);return!Number.isInteger(s)||(i.suggestedLength=s,s<=2*t)||r||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function DZ(n){const e=n.get("Content-Disposition");if(e){let t=$0e(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(d4(t))return t}return null}function XS(n,e){return new iD(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function NZ(n){return n===200||n===206}function RZ(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function IZ(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(Xt(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class H0e{constructor(e){Qe(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=MZ(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Sn(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new G0e(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new j0e(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class G0e{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const r=new Headers(e.headers),i=t.url;fetch(i,RZ(r,this._withCredentials,this._abortController)).then(s=>{if(e._responseOrigin=bN(s.url),!NZ(s.status))throw XS(s.status,i);this._reader=s.body.getReader(),this._headersCapability.resolve();const a=s.headers,{allowRangeRequests:o,suggestedLength:l}=CZ({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=DZ(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Np("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:IZ(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class j0e{constructor(e,t,r){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const s=new Headers(e.headers);s.append("Range",`bytes=${t}-${r-1}`);const a=i.url;fetch(a,RZ(s,this._withCredentials,this._abortController)).then(o=>{const l=bN(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!NZ(o.status))throw XS(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:IZ(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const uI=200,cI=206;function q0e(n){const e=n.response;return typeof e!="string"?e:HS(e).buffer}class W0e{constructor({url:e,httpHeaders:t,withCredentials:r}){Qe(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=MZ(this.isHttp,t),this.withCredentials=r||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,r=this.currXhrId++,i=this.pendingRequests[r]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[s,a]of this.headers)t.setRequestHeader(s,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=cI):i.expectedStatus=uI,t.responseType="arraybuffer",Sn(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,r),t.onprogress=this.onProgress.bind(this,r),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),r}onProgress(e,t){var i;const r=this.pendingRequests[e];r&&((i=r.onProgress)==null||i.call(r,t))}onStateChange(e,t){const r=this.pendingRequests[e];if(!r)return;const i=r.xhr;if(i.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){r.onError(i.status);return}const s=i.status||uI;if(!(s===uI&&r.expectedStatus===cI)&&s!==r.expectedStatus){r.onError(i.status);return}const o=q0e(i);if(s===cI){const l=i.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);u?r.onDone({begin:parseInt(u[1],10),chunk:o}):(Xt('Missing or invalid "Content-Range" header.'),r.onError(0))}else o?r.onDone({begin:0,chunk:o}):r.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class X0e{constructor(e){this._source=e,this._manager=new W0e(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Sn(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new K0e(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const r=new Y0e(this._manager,e,t);return r.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class K0e{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=bN(t.responseURL);const r=t.getAllResponseHeaders(),i=new Headers(r?r.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...u]=o.split(": ");return[l,u.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:a}=CZ({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=DZ(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=XS(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Y0e{constructor(e,t,r){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:r,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=bN((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=XS(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Q0e=/^[a-z][a-z0-9\-+.]+:/i;function Z0e(n){if(Q0e.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class J0e{constructor(e){this.source=e,this.url=Z0e(e.url),Sn(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Sn(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new eye(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new tye(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class eye{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const r=process.getBuiltinModule("fs");r.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(r.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=XS(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Np("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class tye{constructor(e,t,r){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:t,end:r-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const x_=Symbol("INITIAL_DATA");var fo,DE,MF;class PZ{constructor(){j(this,DE);j(this,fo,Object.create(null))}get(e,t=null){if(t){const i=X(this,DE,MF).call(this,e);return i.promise.then(()=>t(i.data)),null}const r=g(this,fo)[e];if(!r||r.data===x_)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return r.data}has(e){const t=g(this,fo)[e];return!!t&&t.data!==x_}delete(e){const t=g(this,fo)[e];return!t||t.data===x_?!1:(delete g(this,fo)[e],!0)}resolve(e,t=null){const r=X(this,DE,MF).call(this,e);r.data=t,r.resolve()}clear(){var e;for(const t in g(this,fo)){const{data:r}=g(this,fo)[t];(e=r==null?void 0:r.bitmap)==null||e.close()}U(this,fo,Object.create(null))}*[Symbol.iterator](){for(const e in g(this,fo)){const{data:t}=g(this,fo)[e];t!==x_&&(yield[e,t])}}}fo=new WeakMap,DE=new WeakSet,MF=function(e){var t;return(t=g(this,fo))[e]||(t[e]={...Promise.withResolvers(),data:x_})};const nye=1e5,w8=30;var Ij,Tf,Va,NE,RE,wg,xh,IE,PE,Eg,px,mx,Mf,gx,FE,vx,Sg,LE,OE,yx,Ag,kE,Cf,xx,bd,FZ,LZ,CF,Bo,FM,DF,OZ,kZ;const Ti=class Ti{constructor({textContentSource:e,container:t,viewport:r}){j(this,bd);j(this,Tf,Promise.withResolvers());j(this,Va,null);j(this,NE,!1);j(this,RE,!!((Ij=globalThis.FontInspector)!=null&&Ij.enabled));j(this,wg,null);j(this,xh,null);j(this,IE,0);j(this,PE,0);j(this,Eg,null);j(this,px,null);j(this,mx,0);j(this,Mf,0);j(this,gx,Object.create(null));j(this,FE,[]);j(this,vx,null);j(this,Sg,[]);j(this,LE,new WeakMap);j(this,OE,null);var l;if(e instanceof ReadableStream)U(this,vx,e);else if(typeof e=="object")U(this,vx,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');U(this,Va,U(this,px,t)),U(this,Mf,r.scale*Ec.pixelRatio),U(this,mx,r.rotation),U(this,xh,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:s,pageX:a,pageY:o}=r.rawDims;U(this,OE,[1,0,0,-1,-a,o+s]),U(this,PE,i),U(this,IE,s),X(l=Ti,Bo,OZ).call(l),Ev(t,r),g(this,Tf).promise.finally(()=>{g(Ti,xx).delete(this),U(this,xh,null),U(this,gx,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Cs.platform;return Kt(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{g(this,Eg).read().then(({value:t,done:r})=>{if(r){g(this,Tf).resolve();return}g(this,wg)??U(this,wg,t.lang),Object.assign(g(this,gx),t.styles),X(this,bd,FZ).call(this,t.items),e()},g(this,Tf).reject)};return U(this,Eg,g(this,vx).getReader()),g(Ti,xx).add(this),e(),g(this,Tf).promise}update({viewport:e,onBefore:t=null}){var s;const r=e.scale*Ec.pixelRatio,i=e.rotation;if(i!==g(this,mx)&&(t==null||t(),U(this,mx,i),Ev(g(this,px),{rotation:i})),r!==g(this,Mf)){t==null||t(),U(this,Mf,r);const a={div:null,properties:null,ctx:X(s=Ti,Bo,FM).call(s,g(this,wg))};for(const o of g(this,Sg))a.properties=g(this,LE).get(o),a.div=o,X(this,bd,CF).call(this,a)}}cancel(){var t;const e=new Np("TextLayer task cancelled.");(t=g(this,Eg))==null||t.cancel(e).catch(()=>{}),U(this,Eg,null),g(this,Tf).reject(e)}get textDivs(){return g(this,Sg)}get textContentItemsStr(){return g(this,FE)}static cleanup(){if(!(g(this,xx).size>0)){g(this,yx).clear();for(const{canvas:e}of g(this,Ag).values())e.remove();g(this,Ag).clear()}}};Tf=new WeakMap,Va=new WeakMap,NE=new WeakMap,RE=new WeakMap,wg=new WeakMap,xh=new WeakMap,IE=new WeakMap,PE=new WeakMap,Eg=new WeakMap,px=new WeakMap,mx=new WeakMap,Mf=new WeakMap,gx=new WeakMap,FE=new WeakMap,vx=new WeakMap,Sg=new WeakMap,LE=new WeakMap,OE=new WeakMap,yx=new WeakMap,Ag=new WeakMap,kE=new WeakMap,Cf=new WeakMap,xx=new WeakMap,bd=new WeakSet,FZ=function(e){var i,s;if(g(this,NE))return;(s=g(this,xh)).ctx??(s.ctx=X(i=Ti,Bo,FM).call(i,g(this,wg)));const t=g(this,Sg),r=g(this,FE);for(const a of e){if(t.length>nye){Xt("Ignoring additional textDivs for performance reasons."),U(this,NE,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=g(this,Va);U(this,Va,document.createElement("span")),g(this,Va).classList.add("markedContent"),a.id&&g(this,Va).setAttribute("id",`${a.id}`),o.append(g(this,Va))}else a.type==="endMarkedContent"&&U(this,Va,g(this,Va).parentNode);continue}r.push(a.str),X(this,bd,LZ).call(this,a)}},LZ=function(e){var m;const t=document.createElement("span"),r={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};g(this,Sg).push(t);const i=yt.transform(g(this,OE),e.transform);let s=Math.atan2(i[1],i[0]);const a=g(this,gx)[e.fontName];a.vertical&&(s+=Math.PI/2);let o=g(this,RE)&&a.fontSubstitution||a.fontFamily;o=Ti.fontFamilyMap.get(o)||o;const l=Math.hypot(i[2],i[3]),u=l*X(m=Ti,Bo,kZ).call(m,o,a,g(this,wg));let c,h;s===0?(c=i[4],h=i[5]-u):(c=i[4]+u*Math.sin(s),h=i[5]-u*Math.cos(s));const d="calc(var(--total-scale-factor) *",f=t.style;g(this,Va)===g(this,px)?(f.left=`${(100*c/g(this,PE)).toFixed(2)}%`,f.top=`${(100*h/g(this,IE)).toFixed(2)}%`):(f.left=`${d}${c.toFixed(2)}px)`,f.top=`${d}${h.toFixed(2)}px)`),f.fontSize=`${d}${(g(Ti,Cf)*l).toFixed(2)}px)`,f.fontFamily=o,r.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,g(this,RE)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),s!==0&&(r.angle=s*(180/Math.PI));let p=!1;if(e.str.length>1)p=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const y=Math.abs(e.transform[0]),v=Math.abs(e.transform[3]);y!==v&&Math.max(y,v)/Math.min(y,v)>1.5&&(p=!0)}if(p&&(r.canvasWidth=a.vertical?e.height:e.width),g(this,LE).set(t,r),g(this,xh).div=t,g(this,xh).properties=r,X(this,bd,CF).call(this,g(this,xh)),r.hasText&&g(this,Va).append(t),r.hasEOL){const y=document.createElement("br");y.setAttribute("role","presentation"),g(this,Va).append(y)}},CF=function(e){var o;const{div:t,properties:r,ctx:i}=e,{style:s}=t;let a="";if(g(Ti,Cf)>1&&(a=`scale(${1/g(Ti,Cf)})`),r.canvasWidth!==0&&r.hasText){const{fontFamily:l}=s,{canvasWidth:u,fontSize:c}=r;X(o=Ti,Bo,DF).call(o,i,c*g(this,Mf),l);const{width:h}=i.measureText(t.textContent);h>0&&(a=`scaleX(${u*g(this,Mf)/h}) ${a}`)}r.angle!==0&&(a=`rotate(${r.angle}deg) ${a}`),a.length>0&&(s.transform=a)},Bo=new WeakSet,FM=function(e=null){let t=g(this,Ag).get(e||(e=""));if(!t){const r=document.createElement("canvas");r.className="hiddenCanvasElement",r.lang=e,document.body.append(r),t=r.getContext("2d",{alpha:!1,willReadFrequently:!0}),g(this,Ag).set(e,t),g(this,kE).set(t,{size:0,family:""})}return t},DF=function(e,t,r){const i=g(this,kE).get(e);t===i.size&&r===i.family||(e.font=`${t}px ${r}`,i.size=t,i.family=r)},OZ=function(){if(g(this,Cf)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),U(this,Cf,e.getBoundingClientRect().height),e.remove()},kZ=function(e,t,r){const i=g(this,yx).get(e);if(i)return i;const s=X(this,Bo,FM).call(this,r);s.canvas.width=s.canvas.height=w8,X(this,Bo,DF).call(this,s,w8,e);const a=s.measureText(""),o=a.fontBoundingBoxAscent,l=Math.abs(a.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let u=.8;return o?u=o/(o+l):(Cs.platform.isFirefox&&Xt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?u=t.ascent:t.descent&&(u=1+t.descent)),g(this,yx).set(e,u),u},j(Ti,Bo),j(Ti,yx,new Map),j(Ti,Ag,new Map),j(Ti,kE,new WeakMap),j(Ti,Cf,null),j(Ti,xx,new Set);let ww=Ti;const rye=100;function BZ(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new NF,{docId:t}=e,r=n.url?c0e(n.url):null,i=n.data?h0e(n.data):null,s=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,l=n.range instanceof UZ?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let c=n.worker instanceof Ew?n.worker:null;const h=n.verbosity,d=typeof n.docBaseUrl=="string"&&!xN(n.docBaseUrl)?n.docBaseUrl:null,f=ZA(n.cMapUrl),p=n.cMapPacked!==!1,m=n.CMapReaderFactory||(ga?x0e:l8),y=ZA(n.iccUrl),v=ZA(n.standardFontDataUrl),b=n.StandardFontDataFactory||(ga?b0e:u8),x=ZA(n.wasmUrl),w=n.WasmFactory||(ga?_0e:c8),_=n.stopAtErrors!==!0,E=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,A=n.isEvalSupported!==!1,T=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!ga,S=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!ga&&(Cs.platform.isFirefox||!globalThis.chrome),M=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,D=typeof n.disableFontFace=="boolean"?n.disableFontFace:ga,N=n.fontExtraProperties===!0,R=n.enableXfa===!0,O=n.ownerDocument||globalThis.document,G=n.disableRange===!0,I=n.disableStream===!0,B=n.disableAutoFetch===!0,$=n.pdfBug===!0,H=n.CanvasFactory||(ga?y0e:m0e),Q=n.FilterFactory||(ga?v0e:g0e),ee=n.enableHWA===!0,J=n.useWasm!==!1,L=l?l.length:n.length??NaN,se=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!ga&&!D,Z=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(m===l8&&b===u8&&w===c8&&f&&v&&x&&j_(f,document.baseURI)&&j_(v,document.baseURI)&&j_(x,document.baseURI)),le=null;Bve(h);const ue={canvasFactory:new H({ownerDocument:O,enableHWA:ee}),filterFactory:new Q({docId:t,ownerDocument:O}),cMapReaderFactory:Z?null:new m({baseUrl:f,isCompressed:p}),standardFontDataFactory:Z?null:new b({baseUrl:v}),wasmFactory:Z?null:new w({baseUrl:x})};c||(c=Ew.create({verbosity:h,port:sc.workerPort}),e._worker=c);const te={docId:t,apiVersion:"5.4.449",data:i,password:o,disableAutoFetch:B,rangeChunkSize:u,length:L,docBaseUrl:d,enableXfa:R,evaluatorOptions:{maxImageSize:E,disableFontFace:D,ignoreErrors:_,isEvalSupported:A,isOffscreenCanvasSupported:T,isImageDecoderSupported:S,canvasMaxAreaInBytes:M,fontExtraProperties:N,useSystemFonts:se,useWasm:J,useWorkerFetch:Z,cMapUrl:f,iccUrl:y,standardFontDataUrl:v,wasmUrl:x}},Y={ownerDocument:O,pdfBug:$,styleElement:le,loadingParams:{disableAutoFetch:B,enableXfa:R}};return c.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");const ie=c.messageHandler.sendWithPromise("GetDocRequest",te,i?[i.buffer]:null);let ve;if(l)ve=new U0e(l,{disableRange:G,disableStream:I});else if(!i){if(!r)throw new Error("getDocument - no `url` parameter provided.");const ge=j_(r)?H0e:ga?J0e:X0e;ve=new ge({url:r,length:L,httpHeaders:s,withCredentials:a,rangeChunkSize:u,disableRange:G,disableStream:I})}return ie.then(ge=>{if(e.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");const _e=new J_(t,ge,c.port),we=new aye(_e,e,ve,Y,ue,ee);e._transport=we,_e.send("Ready",null)})}).catch(e._capability.reject),e}var p2;const m2=class m2{constructor(){Qe(this,"_capability",Promise.withResolvers());Qe(this,"_transport",null);Qe(this,"_worker",null);Qe(this,"docId",`d${Ai(m2,p2)._++}`);Qe(this,"destroyed",!1);Qe(this,"onPassword",null);Qe(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,r,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(s){throw(r=this._worker)!=null&&r.port&&delete this._worker._pendingDestroy,s}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}async getData(){return this._transport.getData()}};p2=new WeakMap,j(m2,p2,0);let NF=m2;var Tg,BE,UE,VE,zE;class UZ{constructor(e,t,r=!1,i=null){j(this,Tg,Promise.withResolvers());j(this,BE,[]);j(this,UE,[]);j(this,VE,[]);j(this,zE,[]);this.length=e,this.initialData=t,this.progressiveDone=r,this.contentDispositionFilename=i}addRangeListener(e){g(this,zE).push(e)}addProgressListener(e){g(this,VE).push(e)}addProgressiveReadListener(e){g(this,UE).push(e)}addProgressiveDoneListener(e){g(this,BE).push(e)}onDataRange(e,t){for(const r of g(this,zE))r(e,t)}onDataProgress(e,t){g(this,Tg).promise.then(()=>{for(const r of g(this,VE))r(e,t)})}onDataProgressiveRead(e){g(this,Tg).promise.then(()=>{for(const t of g(this,UE))t(e)})}onDataProgressiveDone(){g(this,Tg).promise.then(()=>{for(const e of g(this,BE))e()})}transportReady(){g(this,Tg).resolve()}requestDataRange(e,t){fr("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}Tg=new WeakMap,BE=new WeakMap,UE=new WeakMap,VE=new WeakMap,zE=new WeakMap;class iye{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Kt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var bh,Mg,i1;class sye{constructor(e,t,r,i=!1){j(this,Mg);j(this,bh,!1);this._pageIndex=e,this._pageInfo=t,this._transport=r,this._stats=i?new t8:null,this._pdfBug=i,this.commonObjs=r.commonObjs,this.objs=new PZ,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:r=0,offsetY:i=0,dontFlip:s=!1}={}){return new jS({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:r,offsetY:i,dontFlip:s})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Kt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:r,intent:i="display",annotationMode:s=Zd.ENABLE,transform:a=null,background:o=null,optionalContentConfigPromise:l=null,annotationCanvasMap:u=null,pageColors:c=null,printAnnotationStorage:h=null,isEditing:d=!1,recordOperations:f=!1,operationsFilter:p=null}){var S,M,D;(S=this._stats)==null||S.time("Overall");const m=this._transport.getRenderingIntent(i,s,h,d),{renderingIntent:y,cacheKey:v}=m;U(this,bh,!1),l||(l=this._transport.getOptionalContentConfig(y));let b=this._intentStates.get(v);b||(b=Object.create(null),this._intentStates.set(v,b)),b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null);const x=!!(y&Mo.PRINT);b.displayReadyCapability||(b.displayReadyCapability=Promise.withResolvers(),b.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(M=this._stats)==null||M.time("Page Request"),this._pumpOperatorList(m));const w=!!(this._pdfBug&&((D=globalThis.StepperManager)!=null&&D.enabled)),_=!this.recordedBBoxes&&(f||w),E=N=>{var R,O;if(b.renderTasks.delete(A),_){const G=(R=A.gfx)==null?void 0:R.dependencyTracker.take();G&&(A.stepper&&A.stepper.setOperatorBBoxes(G,A.gfx.dependencyTracker.takeDebugMetadata()),f&&(this.recordedBBoxes=G))}x&&U(this,bh,!0),X(this,Mg,i1).call(this),N?(A.capability.reject(N),this._abortOperatorList({intentState:b,reason:N instanceof Error?N:new Error(N)})):A.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(O=globalThis.Stats)!=null&&O.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},A=new RF({callback:E,params:{canvas:t,canvasContext:e,dependencyTracker:_?new E0e(t,b.operatorList.length,w):null,viewport:r,transform:a,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:b.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!x,pdfBug:this._pdfBug,pageColors:c,enableHWA:this._transport.enableHWA,operationsFilter:p});(b.renderTasks||(b.renderTasks=new Set)).add(A);const T=A.task;return Promise.all([b.displayReadyCapability.promise,l]).then(([N,R])=>{var O;if(this.destroyed){E();return}if((O=this._stats)==null||O.time("Rendering"),!(R.renderingIntent&y))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");A.initializeGraphics({transparency:N,optionalContentConfig:R}),A.operatorListChanged()}).catch(E),T}getOperatorList({intent:e="display",annotationMode:t=Zd.ENABLE,printAnnotationStorage:r=null,isEditing:i=!1}={}){var u;function s(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,r,i,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=s,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>_w.textContent(r));const t=this.streamTextContent(e);return new Promise(function(r,i){function s(){a.read().then(function({value:l,done:u}){if(u){r(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),s()},i)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const r of t.renderTasks)e.push(r.completed),r.cancel();return this.objs.clear(),U(this,bh,!1),Promise.all(e)}cleanup(e=!1){U(this,bh,!0);const t=X(this,Mg,i1).call(this);return e&&t&&this._stats&&(this._stats=new t8),t}_startRenderPage(e,t){var i,s;const r=this._intentStates.get(t);r&&((i=this._stats)==null||i.timeEnd("Page Request"),(s=r.displayReadyCapability)==null||s.resolve(e))}_renderPageChunk(e,t){for(let r=0,i=e.length;r<i;r++)t.operatorList.fnArray.push(e.fnArray[r]),t.operatorList.argsArray.push(e.argsArray[r]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const r of t.renderTasks)r.operatorListChanged();e.lastChunk&&X(this,Mg,i1).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:r,modifiedIds:i}){const{map:s,transfer:a}=r,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:s,modifiedIds:i},a).getReader(),u=this._intentStates.get(t);u.streamReader=l;const c=()=>{l.read().then(({value:h,done:d})=>{if(d){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,u),c())},h=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const d of u.renderTasks)d.operatorListChanged();X(this,Mg,i1).call(this)}if(u.displayReadyCapability)u.displayReadyCapability.reject(h);else if(u.opListReadCapability)u.opListReadCapability.reject(h);else throw h}})};c()}_abortOperatorList({intentState:e,reason:t,force:r=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!r){if(e.renderTasks.size>0)return;if(t instanceof h4){let i=rye;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Np(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,s]of this._intentStates)if(s===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}bh=new WeakMap,Mg=new WeakSet,i1=function(){if(!g(this,bh)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),U(this,bh,!1),!0};var Df,Kl,_h,Cg,g2,Dg,Ng,ba,LM,VZ,zZ,s1,bx,OM;const Mr=class Mr{constructor({name:e=null,port:t=null,verbosity:r=Uve()}={}){j(this,ba);j(this,Df,Promise.withResolvers());j(this,Kl,null);j(this,_h,null);j(this,Cg,null);if(this.name=e,this.destroyed=!1,this.verbosity=r,t){if(g(Mr,Ng).has(t))throw new Error("Cannot use more than one PDFWorker per port.");g(Mr,Ng).set(t,this),X(this,ba,VZ).call(this,t)}else X(this,ba,zZ).call(this)}get promise(){return g(this,Df).promise}get port(){return g(this,_h)}get messageHandler(){return g(this,Kl)}destroy(){var e,t;this.destroyed=!0,(e=g(this,Cg))==null||e.terminate(),U(this,Cg,null),g(Mr,Ng).delete(g(this,_h)),U(this,_h,null),(t=g(this,Kl))==null||t.destroy(),U(this,Kl,null)}static create(e){const t=g(this,Ng).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Mr(e)}static get workerSrc(){if(sc.workerSrc)return sc.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Kt(this,"_setupFakeWorkerGlobal",(async()=>g(this,bx,OM)?g(this,bx,OM):(await import(this.workerSrc)).WorkerMessageHandler)())}};Df=new WeakMap,Kl=new WeakMap,_h=new WeakMap,Cg=new WeakMap,g2=new WeakMap,Dg=new WeakMap,Ng=new WeakMap,ba=new WeakSet,LM=function(){g(this,Df).resolve(),g(this,Kl).send("configure",{verbosity:this.verbosity})},VZ=function(e){U(this,_h,e),U(this,Kl,new J_("main","worker",e)),g(this,Kl).on("ready",()=>{}),X(this,ba,LM).call(this)},zZ=function(){if(g(Mr,Dg)||g(Mr,bx,OM)){X(this,ba,s1).call(this);return}let{workerSrc:e}=Mr;try{Mr._isSameOrigin(window.location,e)||(e=Mr._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),r=new J_("main","worker",t),i=()=>{s.abort(),r.destroy(),t.terminate(),this.destroyed?g(this,Df).reject(new Error("Worker was destroyed")):X(this,ba,s1).call(this)},s=new AbortController;t.addEventListener("error",()=>{g(this,Cg)||i()},{signal:s.signal}),r.on("test",o=>{if(s.abort(),this.destroyed||!o){i();return}U(this,Kl,r),U(this,_h,t),U(this,Cg,t),X(this,ba,LM).call(this)}),r.on("ready",o=>{if(s.abort(),this.destroyed){i();return}try{a()}catch{X(this,ba,s1).call(this)}});const a=()=>{const o=new Uint8Array;r.send("test",o,[o.buffer])};a();return}catch{yN("The worker has been disabled.")}X(this,ba,s1).call(this)},s1=function(){g(Mr,Dg)||(Xt("Setting up fake worker."),U(Mr,Dg,!0)),Mr._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){g(this,Df).reject(new Error("Worker was destroyed"));return}const t=new p0e;U(this,_h,t);const r=`fake${Ai(Mr,g2)._++}`,i=new J_(r+"_worker",r,t);e.setup(i,t),U(this,Kl,new J_(r,r+"_worker",t)),X(this,ba,LM).call(this)}).catch(e=>{g(this,Df).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},bx=new WeakSet,OM=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},j(Mr,bx),j(Mr,g2,0),j(Mr,Dg,!1),j(Mr,Ng,new WeakMap),ga&&(U(Mr,Dg,!0),sc.workerSrc||(sc.workerSrc="./pdf.worker.mjs")),Mr._isSameOrigin=(e,t)=>{const r=URL.parse(e);if(!(r!=null&&r.origin)||r.origin==="null")return!1;const i=new URL(t,r);return r.origin===i.origin},Mr._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Mr.fromPort=e=>{if(Qve("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Mr.create(e)};let Ew=Mr;var wh,Wu,_x,wx,Eh,Rg,a1;class aye{constructor(e,t,r,i,s,a){j(this,Rg);j(this,wh,new Map);j(this,Wu,new Map);j(this,_x,new Map);j(this,wx,new Map);j(this,Eh,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new PZ,this.fontLoader=new l0e({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=a,this.setupMessageHandler()}get annotationStorage(){return Kt(this,"annotationStorage",new f4)}getRenderingIntent(e,t=Zd.ENABLE,r=null,i=!1,s=!1){let a=Mo.DISPLAY,o=fF;switch(e){case"any":a=Mo.ANY;break;case"display":break;case"print":a=Mo.PRINT;break;default:Xt(`getRenderingIntent - invalid intent: ${e}`)}const l=a&Mo.PRINT&&r instanceof vZ?r:this.annotationStorage;switch(t){case Zd.DISABLE:a+=Mo.ANNOTATIONS_DISABLE;break;case Zd.ENABLE:break;case Zd.ENABLE_FORMS:a+=Mo.ANNOTATIONS_FORMS;break;case Zd.ENABLE_STORAGE:a+=Mo.ANNOTATIONS_STORAGE,o=l.serializable;break;default:Xt(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(a+=Mo.IS_EDITING),s&&(a+=Mo.OPLIST);const{ids:u,hash:c}=l.modifiedIds,h=[a,o.hash,c];return{renderingIntent:a,cacheKey:h.join("_"),annotationStorageSerializable:o,modifiedIds:u}}destroy(){var r;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(r=g(this,Eh))==null||r.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of g(this,Wu).values())e.push(i._destroy());g(this,Wu).clear(),g(this,_x).clear(),g(this,wx).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,s;this.commonObjs.clear(),this.fontLoader.clear(),g(this,wh).clear(),this.filterFactory.destroy(),ww.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Np("Worker was terminated.")),(s=this.messageHandler)==null||s.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(r,i)=>{Sn(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},i.onPull=()=>{this._fullReader.read().then(function({value:s,done:a}){if(a){i.close();return}Sn(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{this._fullReader.cancel(s),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async r=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:s,contentLength:a}=this._fullReader;return(!i||!s)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:i,isRangeSupported:s,contentLength:a}}),e.on("GetRangeReader",(r,i)=>{Sn(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(r.begin,r.end);if(!s){i.close();return}i.onPull=()=>{s.read().then(function({value:a,done:o}){if(o){i.close();return}Sn(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{s.cancel(a),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,t._capability.resolve(new iye(r,this))}),e.on("DocException",r=>{t._capability.reject(Fa(r))}),e.on("PasswordRequest",r=>{U(this,Eh,Promise.withResolvers());try{if(!t.onPassword)throw Fa(r);const i=s=>{s instanceof Error?g(this,Eh).reject(s):g(this,Eh).resolve({password:s})};t.onPassword(i,r.code)}catch(i){g(this,Eh).reject(i)}return g(this,Eh).promise}),e.on("DataLoaded",r=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),e.on("StartRenderPage",r=>{if(this.destroyed)return;g(this,Wu).get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),e.on("commonobj",([r,i,s])=>{var a;if(this.destroyed||this.commonObjs.has(r))return null;switch(i){case"Font":if("error"in s){const d=s.error;Xt(`Error during font loading: ${d}`),this.commonObjs.resolve(r,d);break}const o=new pF(s),l=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(d,f)=>globalThis.FontInspector.fontAdded(d,f):null,u=new u0e(o,l,s.extra,s.charProcOperatorList);this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:r})).finally(()=>{!u.fontExtraProperties&&u.data&&u.clearData(),this.commonObjs.resolve(r,u)});break;case"CopyLocalImage":const{imageRef:c}=s;Sn(c,"The imageRef must be defined.");for(const d of g(this,Wu).values())for(const[,f]of d.objs)if((f==null?void 0:f.ref)===c)return f.dataLen?(this.commonObjs.resolve(r,structuredClone(f)),f.dataLen):null;break;case"FontPath":case"Image":this.commonObjs.resolve(r,s);break;case"Pattern":const h=new mF(s);this.commonObjs.resolve(r,h.getIR());break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([r,i,s,a])=>{var l;if(this.destroyed)return;const o=g(this,Wu).get(i);if(!o.objs.has(r)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(s){case"Image":case"Pattern":o.objs.resolve(r,a);break;default:throw new Error(`Got unknown object type ${s}`)}}}),e.on("DocProgress",r=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:r.loaded,total:r.total})}),e.on("FetchBinaryData",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[r.type];if(!i)throw new Error(`${r.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(r)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var r;this.annotationStorage.size<=0&&Xt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((r=this._fullReader)==null?void 0:r.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,r=g(this,_x).get(t);if(r)return r;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&g(this,wx).set(s.refStr,e);const a=new sye(t,s,this,this._params.pdfBug);return g(this,Wu).set(t,a),a});return g(this,_x).set(t,i),i}getPageIndex(e){return gF(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return X(this,Rg,a1).call(this,"GetFieldObjects")}hasJSActions(){return X(this,Rg,a1).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return X(this,Rg,a1).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return X(this,Rg,a1).call(this,"GetOptionalContentConfig").then(t=>new B0e(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=g(this,wh).get(e);if(t)return t;const r=this.messageHandler.sendWithPromise(e,null).then(i=>{var s,a;return{info:i[0],metadata:i[1]?new O0e(i[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null,hasStructTree:i[2]}});return g(this,wh).set(e,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of g(this,Wu).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),g(this,wh).clear(),this.filterFactory.destroy(!0),ww.cleanup()}}cachedPageNumber(e){if(!gF(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return g(this,wx).get(t)??null}}wh=new WeakMap,Wu=new WeakMap,_x=new WeakMap,wx=new WeakMap,Eh=new WeakMap,Rg=new WeakSet,a1=function(e,t=null){const r=g(this,wh).get(e);if(r)return r;const i=this.messageHandler.sendWithPromise(e,t);return g(this,wh).set(e,i),i};var Nf;class oye{constructor(e){j(this,Nf,null);Qe(this,"onContinue",null);Qe(this,"onError",null);U(this,Nf,e)}get promise(){return g(this,Nf).capability.promise}cancel(e=0){g(this,Nf).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=g(this,Nf).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=g(this,Nf);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}Nf=new WeakMap;var Rf,Ig;const Pm=class Pm{constructor({callback:e,params:t,objs:r,commonObjs:i,annotationCanvasMap:s,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:u,useRequestAnimationFrame:c=!1,pdfBug:h=!1,pageColors:d=null,enableHWA:f=!1,operationsFilter:p=null}){j(this,Rf,null);this.callback=e,this.params=t,this.objs=r,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=u,this._pdfBug=h,this.pageColors=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=c===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new oye(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=f,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=p}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var l,u;if(this.cancelled)return;if(this._canvas){if(g(Pm,Ig).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");g(Pm,Ig).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)!=null&&l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:r,transform:i,background:s,dependencyTracker:a}=this.params,o=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new by(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,a),this.gfx.beginDrawing({transform:i,viewport:r,transparency:e,background:s}),this.operatorListIdx=0,this.graphicsReady=!0,(u=this.graphicsReadyCallback)==null||u.call(this)}cancel(e=null,t=0){var r,i,s;this.running=!1,this.cancelled=!0,(r=this.gfx)==null||r.endDrawing(),g(this,Rf)&&(window.cancelAnimationFrame(g(this,Rf)),U(this,Rf,null)),g(Pm,Ig).delete(this._canvas),e||(e=new h4(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(s=(i=this.task).onError)==null||s.call(i,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?U(this,Rf,window.requestAnimationFrame(()=>{U(this,Rf,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),g(Pm,Ig).delete(this._canvas),this.callback())))}};Rf=new WeakMap,Ig=new WeakMap,j(Pm,Ig,new WeakSet);let RF=Pm;const lye="5.4.449",uye="f44e5f0e6";var po,Pg,Ex,Di,$E,Sx,Sh,HE,If,Yl,GE,ar,IF,PF,FF,Sm,$Z,Gd;const La=class La{constructor({editor:e=null,uiManager:t=null}){j(this,ar);j(this,po,null);j(this,Pg,null);j(this,Ex);j(this,Di,null);j(this,$E,!1);j(this,Sx,!1);j(this,Sh,null);j(this,HE);j(this,If,null);j(this,Yl,null);var r,i;e?(U(this,Sx,!1),U(this,Sh,e)):U(this,Sx,!0),U(this,Yl,(e==null?void 0:e._uiManager)||t),U(this,HE,g(this,Yl)._eventBus),U(this,Ex,((r=e==null?void 0:e.color)==null?void 0:r.toUpperCase())||((i=g(this,Yl))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),g(La,GE)||U(La,GE,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Kt(this,"_keyboardManager",new WS([[["Escape","mac+Escape"],La.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],La.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],La.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],La.prototype._moveToPrevious],[["Home","mac+Home"],La.prototype._moveToBeginning],[["End","mac+End"],La.prototype._moveToEnd]]))}renderButton(){const e=U(this,po,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",g(this,Sh)&&(e.ariaControls=`${g(this,Sh).id}_colorpicker_dropdown`);const t=g(this,Yl)._signal;e.addEventListener("click",X(this,ar,Sm).bind(this),{signal:t}),e.addEventListener("keydown",X(this,ar,FF).bind(this),{signal:t});const r=U(this,Pg,document.createElement("span"));return r.className="swatch",r.ariaHidden="true",r.style.backgroundColor=g(this,Ex),e.append(r),e}renderMainDropdown(){const e=U(this,Di,X(this,ar,IF).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===g(this,po)){X(this,ar,Sm).call(this,e);return}const t=e.target.getAttribute("data-color");t&&X(this,ar,PF).call(this,t,e)}_moveToNext(e){var t,r;if(!g(this,ar,Gd)){X(this,ar,Sm).call(this,e);return}if(e.target===g(this,po)){(t=g(this,Di).firstElementChild)==null||t.focus();return}(r=e.target.nextSibling)==null||r.focus()}_moveToPrevious(e){var t,r;if(e.target===((t=g(this,Di))==null?void 0:t.firstElementChild)||e.target===g(this,po)){g(this,ar,Gd)&&this._hideDropdownFromKeyboard();return}g(this,ar,Gd)||X(this,ar,Sm).call(this,e),(r=e.target.previousSibling)==null||r.focus()}_moveToBeginning(e){var t;if(!g(this,ar,Gd)){X(this,ar,Sm).call(this,e);return}(t=g(this,Di).firstElementChild)==null||t.focus()}_moveToEnd(e){var t;if(!g(this,ar,Gd)){X(this,ar,Sm).call(this,e);return}(t=g(this,Di).lastElementChild)==null||t.focus()}hideDropdown(){var e,t;(e=g(this,Di))==null||e.classList.add("hidden"),g(this,po).ariaExpanded="false",(t=g(this,If))==null||t.abort(),U(this,If,null)}_hideDropdownFromKeyboard(){var e;if(!g(this,Sx)){if(!g(this,ar,Gd)){(e=g(this,Sh))==null||e.unselect();return}this.hideDropdown(),g(this,po).focus({preventScroll:!0,focusVisible:g(this,$E)})}}updateColor(e){if(g(this,Pg)&&(g(this,Pg).style.backgroundColor=e),!g(this,Di))return;const t=g(this,Yl).highlightColors.values();for(const r of g(this,Di).children)r.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=g(this,po))==null||e.remove(),U(this,po,null),U(this,Pg,null),(t=g(this,Di))==null||t.remove(),U(this,Di,null)}};po=new WeakMap,Pg=new WeakMap,Ex=new WeakMap,Di=new WeakMap,$E=new WeakMap,Sx=new WeakMap,Sh=new WeakMap,HE=new WeakMap,If=new WeakMap,Yl=new WeakMap,GE=new WeakMap,ar=new WeakSet,IF=function(){const e=document.createElement("div"),t=g(this,Yl)._signal;e.addEventListener("contextmenu",Cl,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),g(this,Sh)&&(e.id=`${g(this,Sh).id}_colorpicker_dropdown`);for(const[r,i]of g(this,Yl).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=r,s.setAttribute("data-l10n-id",g(La,GE)[r]);const a=document.createElement("span");s.append(a),a.className="swatch",a.style.backgroundColor=i,s.ariaSelected=i===g(this,Ex),s.addEventListener("click",X(this,ar,PF).bind(this,i),{signal:t}),e.append(s)}return e.addEventListener("keydown",X(this,ar,FF).bind(this),{signal:t}),e},PF=function(e,t){t.stopPropagation(),g(this,HE).dispatch("switchannotationeditorparams",{source:this,type:En.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},FF=function(e){La._keyboardManager.exec(this,e)},Sm=function(e){if(g(this,ar,Gd)){this.hideDropdown();return}if(U(this,$E,e.detail===0),g(this,If)||(U(this,If,new AbortController),window.addEventListener("pointerdown",X(this,ar,$Z).bind(this),{signal:g(this,Yl).combinedSignal(g(this,If))})),g(this,po).ariaExpanded="true",g(this,Di)){g(this,Di).classList.remove("hidden");return}const t=U(this,Di,X(this,ar,IF).call(this));g(this,po).append(t)},$Z=function(e){var t;(t=g(this,Di))!=null&&t.contains(e.target)||this.hideDropdown()},Gd=function(){return g(this,Di)&&!g(this,Di).classList.contains("hidden")},j(La,GE,null);let hD=La;var Xu,jE,Ax,qE;const Fm=class Fm{constructor(e){j(this,Xu,null);j(this,jE,null);j(this,Ax,null);U(this,jE,e),U(this,Ax,e._uiManager),g(Fm,qE)||U(Fm,qE,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(g(this,Xu))return g(this,Xu);const{editorType:e,colorType:t,color:r}=g(this,jE),i=U(this,Xu,document.createElement("input"));return i.type="color",i.value=r||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",g(Fm,qE)[e]),i.addEventListener("input",()=>{g(this,Ax).updateParams(t,i.value)},{signal:g(this,Ax)._signal}),i}update(e){g(this,Xu)&&(g(this,Xu).value=e)}destroy(){var e;(e=g(this,Xu))==null||e.remove(),U(this,Xu,null)}hideDropdown(){}};Xu=new WeakMap,jE=new WeakMap,Ax=new WeakMap,qE=new WeakMap,j(Fm,qE,null);let dD=Fm;function E8(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function b_(n){return Math.max(0,Math.min(255,255*n))}class S8{static CMYK_G([e,t,r,i]){return["G",1-Math.min(1,.3*e+.59*r+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=b_(e),[e,e,e]}static G_HTML([e]){const t=E8(e);return`#${t}${t}${t}`}static RGB_G([e,t,r]){return["G",.3*e+.59*t+.11*r]}static RGB_rgb(e){return e.map(b_)}static RGB_HTML(e){return`#${e.map(E8).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,r,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,r+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,r,i]){return[b_(1-Math.min(1,e+i)),b_(1-Math.min(1,r+i)),b_(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,r]){const i=1-e,s=1-t,a=1-r,o=Math.min(i,s,a);return["CMYK",i,s,a,o]}}class cye{create(e,t,r=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),r||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){fr("Abstract method `_createSVG` called.")}}class fD extends cye{_createSVG(e){return document.createElementNS(Xc,e)}}const hye=9,Av=new WeakSet,dye=new Date().getTimezoneOffset()*60*1e3;class hI{static create(e){switch(e.data.annotationType){case mi.LINK:return new g4(e);case mi.TEXT:return new pye(e);case mi.WIDGET:switch(e.data.fieldType){case"Tx":return new mye(e);case"Btn":return e.data.radioButton?new jZ(e):e.data.checkBox?new vye(e):new yye(e);case"Ch":return new xye(e);case"Sig":return new gye(e)}return new Bv(e);case mi.POPUP:return new OF(e);case mi.FREETEXT:return new YZ(e);case mi.LINE:return new _ye(e);case mi.SQUARE:return new wye(e);case mi.CIRCLE:return new Eye(e);case mi.POLYLINE:return new QZ(e);case mi.CARET:return new Aye(e);case mi.INK:return new v4(e);case mi.POLYGON:return new Sye(e);case mi.HIGHLIGHT:return new ZZ(e);case mi.UNDERLINE:return new Tye(e);case mi.SQUIGGLY:return new Mye(e);case mi.STRIKEOUT:return new Cye(e);case mi.STAMP:return new JZ(e);case mi.FILEATTACHMENT:return new Dye(e);default:return new Ur(e)}}}var Fg,Tx,ul,WE,LF;const $U=class $U{constructor(e,{isRenderable:t=!1,ignoreBorder:r=!1,createQuadrilaterals:i=!1}={}){j(this,WE);j(this,Fg,null);j(this,Tx,!1);j(this,ul,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(r)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return $U._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var r;const{data:e}=this,t=(r=this.annotationStorage)==null?void 0:r.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var o;const e=(o=this.annotationStorage)==null?void 0:o.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:r,rect:i}=this.data;let s=-1/0,a=-1/0;if((t==null?void 0:t.length)>=8){for(let l=0;l<t.length;l+=8)t[l+1]>a?(a=t[l+1],s=t[l+2]):t[l+1]===a&&(s=Math.max(s,t[l+2]));return[s,a]}if((r==null?void 0:r.length)>=1){for(const l of r)for(let u=0,c=l.length;u<c;u+=2)l[u+1]>a?(a=l[u+1],s=l[u]):l[u+1]===a&&(s=Math.max(s,l[u]));if(s!==1/0)return[s,a]}return i?[i[2],i[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:r,pageHeight:i,pageX:s,pageY:a}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-s)/r,e[1]=100*(e[1]-a)/i,e}get commentText(){var t,r,i;const{data:e}=this;return((r=(t=this.annotationStorage.getRawValue(`${xw}${e.id}`))==null?void 0:t.popup)==null?void 0:r.contents)||((i=e.contentsObj)==null?void 0:i.str)||""}set commentText(e){const{data:t}=this,r={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:r})||this.annotationStorage.setValue(`${xw}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:r,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=g(this,ul))==null?void 0:e.popup)||this.popup)==null||t.remove(),U(this,ul,this.popup=null)}updateEdited(e){var s;if(!this.container)return;e.rect&&(g(this,Fg)||U(this,Fg,{rect:this.data.rect.slice(0)}));const{rect:t,popup:r}=e;t&&X(this,WE,LF).call(this,t);let i=((s=g(this,ul))==null?void 0:s.popup)||this.popup;!i&&(r!=null&&r.text)&&(this._createPopup(r),i=g(this,ul).popup),i&&(i.updateEdited(e),r!=null&&r.deleted&&(i.remove(),U(this,ul,null),this.popup=null))}resetEdited(){var e;g(this,Fg)&&(X(this,WE,LF).call(this,g(this,Fg).rect),(e=g(this,ul))==null||e.popup.resetEdited(),U(this,Fg,null))}_createContainer(e){const{data:t,parent:{page:r,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),!(this instanceof Bv)&&!(this instanceof g4)&&(s.tabIndex=0);const{style:a}=s;if(a.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(s.title=t.alternativeText),t.noRotate&&s.classList.add("norotate"),!t.rect||this instanceof OF){const{rotation:m}=t;return!t.hasOwnCanvas&&m!==0&&this.setRotation(m,s),s}const{width:o,height:l}=this;if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const m=t.borderStyle.horizontalCornerRadius,y=t.borderStyle.verticalCornerRadius;if(m>0||y>0){const b=`calc(${m}px * var(--total-scale-factor)) / calc(${y}px * var(--total-scale-factor))`;a.borderRadius=b}else if(this instanceof jZ){const b=`calc(${o}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;a.borderRadius=b}switch(t.borderStyle.style){case N0.SOLID:a.borderStyle="solid";break;case N0.DASHED:a.borderStyle="dashed";break;case N0.BEVELED:Xt("Unimplemented border style: beveled");break;case N0.INSET:Xt("Unimplemented border style: inset");break;case N0.UNDERLINE:a.borderBottomStyle="solid";break}const v=t.borderColor||null;v?(U(this,Tx,!0),a.borderColor=yt.makeHexColor(v[0]|0,v[1]|0,v[2]|0)):a.borderWidth=0}const u=yt.normalizeRect([t.rect[0],r.view[3]-t.rect[1]+r.view[1],t.rect[2],r.view[3]-t.rect[3]+r.view[1]]),{pageWidth:c,pageHeight:h,pageX:d,pageY:f}=i.rawDims;a.left=`${100*(u[0]-d)/c}%`,a.top=`${100*(u[1]-f)/h}%`;const{rotation:p}=t;return t.hasOwnCanvas||p===0?(a.width=`${100*o/c}%`,a.height=`${100*l/h}%`):this.setRotation(p,s),s}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:r,pageHeight:i}=this.parent.viewport.rawDims;let{width:s,height:a}=this;e%180!==0&&([s,a]=[a,s]),t.style.width=`${100*s/r}%`,t.style.height=`${100*a/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,r,i)=>{const s=i.detail[t],a=s[0],o=s.slice(1);i.target.style[r]=S8[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[r]:S8[`${a}_rgb`](o)})};return Kt(this,"_commonActions",{display:t=>{const{display:r}=t.detail,i=r%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:r===1||r===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:r}=t.detail;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:r,noView:r})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const r=t.detail.rotation;this.setRotation(r),this.annotationStorage.setValue(this.data.id,{rotation:r})}})}_dispatchEventFromSandbox(e,t){const r=this._commonActions;for(const i of Object.keys(t.detail)){const s=e[i]||r[i];s==null||s(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const r=this._commonActions;for(const[i,s]of Object.entries(t)){const a=r[i];if(a){const o={detail:{[i]:s},target:e};a(o),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,r,i,s]=this.data.rect.map(m=>Math.fround(m));if(e.length===8){const[m,y,v,b]=e.subarray(2,6);if(i===m&&s===y&&t===v&&r===b)return}const{style:a}=this.container;let o;if(g(this,Tx)){const{borderColor:m,borderWidth:y}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${m}" stroke-width="${y}">`],this.container.classList.add("hasBorder")}const l=i-t,u=s-r,{svgFactory:c}=this,h=c.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0),h.role="none";const d=c.createElement("defs");h.append(d);const f=c.createElement("clipPath"),p=`clippath_${this.data.id}`;f.setAttribute("id",p),f.setAttribute("clipPathUnits","objectBoundingBox"),d.append(f);for(let m=2,y=e.length;m<y;m+=8){const v=e[m],b=e[m+1],x=e[m+2],w=e[m+3],_=c.createElement("rect"),E=(x-t)/l,A=(s-b)/u,T=(v-x)/l,S=(b-w)/u;_.setAttribute("x",E),_.setAttribute("y",A),_.setAttribute("width",T),_.setAttribute("height",S),f.append(_),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${E}" y="${A}" width="${T}" height="${S}"/>`)}g(this,Tx)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(h),this.container.style.clipPath=`url(#${p})`}_createPopup(e=null){const{data:t}=this;let r,i;e?(r={str:e.text},i=e.date):(r=t.contentsObj,i=t.modificationDate),U(this,ul,new OF({data:{color:t.color,titleObj:t.titleObj,modificationDate:i,contentsObj:r,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(g(this,ul)||this.popup||this.data.popupRef)}get extraPopupElement(){return g(this,ul)}render(){fr("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const r=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:s,id:a,exportValues:o}of i){if(s===-1||a===t)continue;const l=typeof o=="string"?o:null,u=document.querySelector(`[data-element-id="${a}"]`);if(u&&!Av.has(u)){Xt(`_getElementsByName - element not allowed: ${a}`);continue}r.push({id:a,exportValue:l,domElement:u})}return r}for(const i of document.getElementsByName(e)){const{exportValue:s}=i,a=i.getAttribute("data-element-id");a!==t&&Av.has(i)&&r.push({id:a,exportValue:s,domElement:i})}return r}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var r;(r=this.linkService.eventBus)==null||r.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Fg=new WeakMap,Tx=new WeakMap,ul=new WeakMap,WE=new WeakSet,LF=function(e){const{container:{style:t},data:{rect:r,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}}}=this;r==null||r.splice(0,4,...e),t.left=`${100*(e[0]-o)/s}%`,t.top=`${100*(a-e[3]+l)/a}%`,i===0?(t.width=`${100*(e[2]-e[0])/s}%`,t.height=`${100*(e[3]-e[1])/a}%`):this.setRotation(i)};let Ur=$U;class fye extends Ur{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var Io,Am,HZ,GZ;class g4 extends Ur{constructor(t,r=null){super(t,{isRenderable:!0,ignoreBorder:!!(r!=null&&r.ignoreBorder),createQuadrilaterals:!0});j(this,Io);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:r}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let s=!1;return t.url?(r.addLinkAttributes(i,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),s=!0):t.attachment?(X(this,Io,HZ).call(this,i,t.attachment,t.overlaidText,t.attachmentDest),s=!0):t.setOCGState?(X(this,Io,GZ).call(this,i,t.setOCGState,t.overlaidText),s=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),s=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&(this.contentElement=i,this.container.append(i)),this.container}_bindLink(t,r,i=""){t.href=this.linkService.getDestinationHash(r),t.onclick=()=>(r&&this.linkService.goToDestination(r),!1),(r||r==="")&&X(this,Io,Am).call(this),i&&(t.title=i)}_bindNamedAction(t,r,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(r),!1),i&&(t.title=i),X(this,Io,Am).call(this)}_bindJSAction(t,r){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(r.actions)){const a=i.get(s);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r.id,name:s}}),!1})}r.overlaidText&&(t.title=r.overlaidText),t.onclick||(t.onclick=()=>!1),X(this,Io,Am).call(this)}_bindResetFormAction(t,r){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),X(this,Io,Am).call(this),!this._fieldObjects){Xt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var h;i==null||i();const{fields:s,refs:a,include:o}=r,l=[];if(s.length!==0||a.length!==0){const d=new Set(a);for(const f of s){const p=this._fieldObjects[f]||[];for(const{id:m}of p)d.add(m)}for(const f of Object.values(this._fieldObjects))for(const p of f)d.has(p.id)===o&&l.push(p)}else for(const d of Object.values(this._fieldObjects))l.push(...d);const u=this.annotationStorage,c=[];for(const d of l){const{id:f}=d;switch(c.push(f),d.type){case"text":{const m=d.defaultValue||"";u.setValue(f,{value:m});break}case"checkbox":case"radiobutton":{const m=d.defaultValue===d.exportValues;u.setValue(f,{value:m});break}case"combobox":case"listbox":{const m=d.defaultValue||"";u.setValue(f,{value:m});break}default:continue}const p=document.querySelector(`[data-element-id="${f}"]`);if(p){if(!Av.has(p)){Xt(`_bindResetFormAction - element not allowed: ${f}`);continue}}else continue;p.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((h=this.linkService.eventBus)==null||h.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:c,name:"ResetForm"}})),!1}}}Io=new WeakSet,Am=function(){this.container.setAttribute("data-internal-link","")},HZ=function(t,r,i="",s=null){t.href=this.linkService.getAnchorUrl(""),r.description?t.title=r.description:i&&(t.title=i),t.onclick=()=>{var a;return(a=this.downloadManager)==null||a.openOrDownloadData(r.content,r.filename,s),!1},X(this,Io,Am).call(this)},GZ=function(t,r,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(r),!1),i&&(t.title=i),X(this,Io,Am).call(this)};class pye extends Ur{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class Bv extends Ur{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Cs.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,r,i,s){r.includes("mouse")?e.addEventListener(r,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(r,a=>{var o;if(r==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(r==="focus"){if(t.focused)return;t.focused=!0}s&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(a)}}))})}_setEventListeners(e,t,r,i){var s,a,o;for(const[l,u]of r)(u==="Action"||(s=this.data.actions)!=null&&s[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,u,i),u==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":yt.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:r}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||hye,s=e.style;let a;const o=2,l=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o),c=Math.round(u/(rI*i))||1,h=u/c;a=Math.min(i,l(h/rI))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(i,l(u/rI))}s.fontSize=`calc(${a}px * var(--total-scale-factor))`,s.color=yt.makeHexColor(r[0],r[1],r[2]),this.data.textAlignment!==null&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class mye extends Bv{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,r,i){const s=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=r),s.setValue(a.id,{[i]:r})}render(){var i,s;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let r=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let u=a.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const c={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=u??o,this.data.doNotScroll&&(r.style.overflowY="hidden")):(r=document.createElement("input"),r.type=this.data.password?"password":"text",r.setAttribute("value",u??o),this.data.doNotScroll&&(r.style.overflowX="hidden")),this.data.hasOwnCanvas&&(r.hidden=!0),Av.add(r),this.contentElement=r,r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=0;const{datetimeFormat:h,datetimeType:d,timeStep:f}=this.data,p=!!d&&this.enableScripting;h&&(r.title=h),this._setRequired(r,this.data.required),l&&(r.maxLength=l),r.addEventListener("input",y=>{e.setValue(t,{value:y.target.value}),this.setPropertyOnSiblings(r,"value",y.target.value,"value"),c.formattedValue=null}),r.addEventListener("resetform",y=>{const v=this.data.defaultFieldValue??"";r.value=c.userValue=v,c.formattedValue=null});let m=y=>{const{formattedValue:v}=c;v!=null&&(y.target.value=v),y.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",v=>{var x;if(c.focused)return;const{target:b}=v;if(p&&(b.type=d,f&&(b.step=f)),c.userValue){const w=c.userValue;if(p)if(d==="time"){const _=new Date(w),E=[_.getHours(),_.getMinutes(),_.getSeconds()];b.value=E.map(A=>A.toString().padStart(2,"0")).join(":")}else b.value=new Date(w-dye).toISOString().split(d==="date"?"T":".",1)[0];else b.value=w}c.lastCommittedValue=b.value,c.commitKey=1,(x=this.data.actions)!=null&&x.Focus||(c.focused=!0)}),r.addEventListener("updatefromsandbox",v=>{this.showElementAndHideCanvas(v.target);const b={value(x){c.userValue=x.detail.value??"",p||e.setValue(t,{value:c.userValue.toString()}),x.target.value=c.userValue},formattedValue(x){const{formattedValue:w}=x.detail;c.formattedValue=w,w!=null&&x.target!==document.activeElement&&(x.target.value=w);const _={formattedValue:w};p&&(_.value=w),e.setValue(t,_)},selRange(x){x.target.setSelectionRange(...x.detail.selRange)},charLimit:x=>{var A;const{charLimit:w}=x.detail,{target:_}=x;if(w===0){_.removeAttribute("maxLength");return}_.setAttribute("maxLength",w);let E=c.userValue;!E||E.length<=w||(E=E.slice(0,w),_.value=c.userValue=E,e.setValue(t,{value:E}),(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:1,selStart:_.selectionStart,selEnd:_.selectionEnd}}))}};this._dispatchEventFromSandbox(b,v)}),r.addEventListener("keydown",v=>{var w;c.commitKey=1;let b=-1;if(v.key==="Escape"?b=0:v.key==="Enter"&&!this.data.multiLine?b=2:v.key==="Tab"&&(c.commitKey=3),b===-1)return;const{value:x}=v.target;c.lastCommittedValue!==x&&(c.lastCommittedValue=x,c.userValue=x,(w=this.linkService.eventBus)==null||w.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,willCommit:!0,commitKey:b,selStart:v.target.selectionStart,selEnd:v.target.selectionEnd}}))});const y=m;m=null,r.addEventListener("blur",v=>{var w,_;if(!c.focused||!v.relatedTarget)return;(w=this.data.actions)!=null&&w.Blur||(c.focused=!1);const{target:b}=v;let{value:x}=b;if(p){if(x&&d==="time"){const E=x.split(":").map(A=>parseInt(A,10));x=new Date(2e3,0,1,E[0],E[1],E[2]||0).valueOf(),b.step=""}else x.includes("T")||(x=`${x}T00:00`),x=new Date(x).valueOf();b.type="text"}c.userValue=x,c.lastCommittedValue!==x&&((_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,willCommit:!0,commitKey:c.commitKey,selStart:v.target.selectionStart,selEnd:v.target.selectionEnd}})),y(v)}),(s=this.data.actions)!=null&&s.Keystroke&&r.addEventListener("beforeinput",v=>{var S;c.lastCommittedValue=null;const{data:b,target:x}=v,{value:w,selectionStart:_,selectionEnd:E}=x;let A=_,T=E;switch(v.inputType){case"deleteWordBackward":{const M=w.substring(0,_).match(/\w*[^\w]*$/);M&&(A-=M[0].length);break}case"deleteWordForward":{const M=w.substring(_).match(/^[^\w]*\w*/);M&&(T+=M[0].length);break}case"deleteContentBackward":_===E&&(A-=1);break;case"deleteContentForward":_===E&&(T+=1);break}v.preventDefault(),(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,change:b||"",willCommit:!1,selStart:A,selEnd:T}})}),this._setEventListeners(r,c,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],v=>v.target.value)}if(m&&r.addEventListener("blur",m),this.data.comb){const v=(this.data.rect[2]-this.data.rect[0])/l;r.classList.add("comb"),r.style.letterSpacing=`calc(${v}px * var(--total-scale-factor) - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell",this.data.hasOwnCanvas&&(r.hidden=!0);return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class gye extends Bv{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class vye extends Bv{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,r=t.id;let i=e.getValue(r,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(r,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return Av.add(s),s.setAttribute("data-element-id",r),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",t.exportValue),s.tabIndex=0,s.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const u of this._getElementsByName(o,r)){const c=l&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=c),e.setValue(u.id,{value:c})}e.setValue(r,{value:l})}),s.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(r,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class jZ extends Bv{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,r=t.id;let i=e.getValue(r,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(r,{value:i})),i)for(const a of this._getElementsByName(t.fieldName,r))e.setValue(a.id,{value:!1});const s=document.createElement("input");if(Av.add(s),s.setAttribute("data-element-id",r),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=0,s.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const u of this._getElementsByName(o,r))e.setValue(u.id,{value:!1});e.setValue(r,{value:l})}),s.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;s.addEventListener("updatefromsandbox",o=>{const l={value:u=>{const c=a===u.detail.value;for(const h of this._getElementsByName(u.target.name)){const d=c&&h.id===r;h.domElement&&(h.domElement.checked=d),e.setValue(h.id,{value:d})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class yye extends g4{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",r=>{this._dispatchEventFromSandbox({},r)})),e}}class xye extends Bv{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,r=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");Av.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",c=>{const h=this.data.defaultFieldValue;for(const d of i.options)d.selected=d.value===h});for(const c of this.data.options){const h=document.createElement("option");h.textContent=c.displayValue,h.value=c.exportValue,r.value.includes(c.exportValue)&&(h.setAttribute("selected",!0),s=!1),i.append(h)}let a=null;if(s){const c=document.createElement("option");c.value=" ",c.setAttribute("hidden",!0),c.setAttribute("selected",!0),i.prepend(c),a=()=>{c.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const o=c=>{const h=c?"value":"textContent",{options:d,multiple:f}=i;return f?Array.prototype.filter.call(d,p=>p.selected).map(p=>p[h]):d.selectedIndex===-1?null:d[d.selectedIndex][h]};let l=o(!1);const u=c=>{const h=c.target.options;return Array.prototype.map.call(h,d=>({displayValue:d.textContent,exportValue:d.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",c=>{const h={value(d){a==null||a();const f=d.detail.value,p=new Set(Array.isArray(f)?f:[f]);for(const m of i.options)m.selected=p.has(m.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(d){i.multiple=!0},remove(d){const f=i.options,p=d.detail.remove;f[p].selected=!1,i.remove(p),f.length>0&&Array.prototype.findIndex.call(f,y=>y.selected)===-1&&(f[0].selected=!0),e.setValue(t,{value:o(!0),items:u(d)}),l=o(!1)},clear(d){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(d){const{index:f,displayValue:p,exportValue:m}=d.detail.insert,y=i.children[f],v=document.createElement("option");v.textContent=p,v.value=m,y?y.before(v):i.append(v),e.setValue(t,{value:o(!0),items:u(d)}),l=o(!1)},items(d){const{items:f}=d.detail;for(;i.length!==0;)i.remove(0);for(const p of f){const{displayValue:m,exportValue:y}=p,v=document.createElement("option");v.textContent=m,v.value=y,i.append(v)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:o(!0),items:u(d)}),l=o(!1)},indices(d){const f=new Set(d.detail.indices);for(const p of d.target.options)p.selected=f.has(p.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(d){d.target.disabled=!d.detail.editable}};this._dispatchEventFromSandbox(h,c)}),i.addEventListener("input",c=>{var f;const h=o(!0),d=o(!1);e.setValue(t,{value:h}),c.preventDefault(),(f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:d,changeEx:h,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],c=>c.target.value)):i.addEventListener("input",function(c){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}var XE,kF;class OF extends Ur{constructor(t){const{data:r,elements:i,parent:s}=t,a=!!s._commentManager;super(t,{isRenderable:!a&&Ur._hasPopupData(r)});j(this,XE);if(this.elements=i,a&&Ur._hasPopupData(r)){const o=this.popup=X(this,XE,kF).call(this);for(const l of i)l.popup=o}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const r=this.popup=X(this,XE,kF).call(this),i=[];for(const s of this.elements)s.popup=r,s.container.ariaHasPopup="dialog",i.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(s=>`${ny}${s}`).join(",")),this.container}}XE=new WeakSet,kF=function(){return new bye({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var mo,Pf,v2,y2,Mx,Cx,qr,Ku,Ff,Lg,Dx,Nx,Yu,go,Ah,Th,Wr,Mh,Lf,KE,Ch,Rx,Og,Of,Yi,kf,on,kM,BF,UF,VF,BM,zF,qZ,WZ,XZ,KZ,UM,VM,$F;class bye{constructor({container:e,color:t,elements:r,titleObj:i,modificationDate:s,contentsObj:a,richText:o,parent:l,rect:u,parentRect:c,open:h,commentManager:d=null}){j(this,on);j(this,mo,null);j(this,Pf,X(this,on,XZ).bind(this));j(this,v2,X(this,on,$F).bind(this));j(this,y2,X(this,on,VM).bind(this));j(this,Mx,X(this,on,UM).bind(this));j(this,Cx,null);j(this,qr,null);j(this,Ku,null);j(this,Ff,null);j(this,Lg,null);j(this,Dx,null);j(this,Nx,null);j(this,Yu,!1);j(this,go,null);j(this,Ah,null);j(this,Th,null);j(this,Wr,null);j(this,Mh,null);j(this,Lf,null);j(this,KE,null);j(this,Ch,null);j(this,Rx,null);j(this,Og,null);j(this,Of,!1);j(this,Yi,null);j(this,kf,null);U(this,qr,e),U(this,Rx,i),U(this,Ku,a),U(this,Ch,o),U(this,Dx,l),U(this,Cx,t),U(this,KE,u),U(this,Nx,c),U(this,Lg,r),U(this,mo,d),U(this,Yi,r[0]),U(this,Ff,sD.toDateObject(s)),this.trigger=r.flatMap(f=>f.getElementsToTriggerPopup()),d||(X(this,on,kM).call(this),g(this,qr).hidden=!0,h&&X(this,on,UM).call(this))}renderCommentButton(){if(g(this,Wr)){g(this,Wr).parentNode||g(this,Yi).container.after(g(this,Wr));return}if(g(this,Mh)||X(this,on,BF).call(this),!g(this,Mh))return;const{signal:e}=U(this,Ah,new AbortController),t=g(this,Yi).hasOwnCommentButton,r=()=>{g(this,mo).toggleCommentPopup(this,!0,void 0,!t)},i=()=>{g(this,mo).toggleCommentPopup(this,!1,!0,!t)},s=()=>{g(this,mo).toggleCommentPopup(this,!1,!1)};if(t){U(this,Wr,g(this,Yi).container);for(const a of this.trigger)a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.addEventListener("keydown",g(this,Pf),{signal:e}),a.addEventListener("click",r,{signal:e}),a.addEventListener("pointerenter",i,{signal:e}),a.addEventListener("pointerleave",s,{signal:e}),a.classList.add("popupTriggerArea")}else{const a=U(this,Wr,document.createElement("button"));a.className="annotationCommentButton";const o=g(this,Yi).container;a.style.zIndex=o.style.zIndex+1,a.tabIndex=0,a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.setAttribute("data-l10n-id","pdfjs-show-comment-button"),X(this,on,VF).call(this),X(this,on,UF).call(this),a.addEventListener("keydown",g(this,Pf),{signal:e}),a.addEventListener("click",r,{signal:e}),a.addEventListener("pointerenter",i,{signal:e}),a.addEventListener("pointerleave",s,{signal:e}),o.after(a)}}get commentButtonColor(){const{color:e,opacity:t}=g(this,Yi).commentData;return e?g(this,Dx)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=g(this,Wr))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:r,creationDate:i,modificationDate:s}=g(this,Yi).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:r,creationDate:i,modificationDate:s}}get elementBeforePopup(){return g(this,Wr)}get comment(){return g(this,kf)||U(this,kf,g(this,Yi).commentText),g(this,kf)}set comment(e){e!==this.comment&&(g(this,Yi).commentText=U(this,kf,e))}focus(){var e;(e=g(this,Yi).container)==null||e.focus()}get parentBoundingClientRect(){return g(this,Yi).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){g(this,Wr)&&(g(this,Wr).classList.toggle("selected",e),g(this,Wr).ariaExpanded=t)}setSelectedCommentButton(e){g(this,Wr).classList.toggle("selected",e)}get commentPopupPosition(){if(g(this,Lf))return g(this,Lf);const{x:e,y:t,height:r}=g(this,Wr).getBoundingClientRect(),{x:i,y:s,width:a,height:o}=g(this,Yi).layer.getBoundingClientRect();return[(e-i)/a,(t+r-s)/o]}set commentPopupPosition(e){U(this,Lf,e)}hasDefaultPopupPosition(){return g(this,Lf)===null}get commentButtonPosition(){return g(this,Mh)}get commentButtonWidth(){return g(this,Wr).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,r]=g(this,Lf)||this.commentButtonPosition.map(u=>u/100),i=this.parentBoundingClientRect,{x:s,y:a,width:o,height:l}=i;g(this,mo).showDialog(null,this,s+t*o,a+r*l,{...e,parentDimensions:i})}render(){var r,i;if(g(this,go))return;const e=U(this,go,document.createElement("div"));if(e.className="popup",g(this,Cx)){const s=e.style.outlineColor=yt.makeHexColor(...g(this,Cx));e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const t=document.createElement("span");if(t.className="header",(r=g(this,Rx))!=null&&r.str){const s=document.createElement("span");s.className="title",t.append(s),{dir:s.dir,str:s.textContent}=g(this,Rx)}if(e.append(t),g(this,Ff)){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:g(this,Ff).valueOf()})),s.dateTime=g(this,Ff).toISOString(),t.append(s)}OQ({html:g(this,on,BM)||g(this,Ku).str,dir:(i=g(this,Ku))==null?void 0:i.dir,className:"popupContent"},e),g(this,qr).append(e)}updateEdited({rect:e,popup:t,deleted:r}){var i;if(g(this,mo)){r?(this.remove(),U(this,kf,null)):t&&(t.deleted?this.remove():(X(this,on,VF).call(this),U(this,kf,t.text))),e&&(U(this,Mh,null),X(this,on,BF).call(this),X(this,on,UF).call(this));return}if(r||t!=null&&t.deleted){this.remove();return}X(this,on,kM).call(this),g(this,Og)||U(this,Og,{contentsObj:g(this,Ku),richText:g(this,Ch)}),e&&U(this,Th,null),t&&t.text&&(U(this,Ch,X(this,on,WZ).call(this,t.text)),U(this,Ff,sD.toDateObject(t.date)),U(this,Ku,null)),(i=g(this,go))==null||i.remove(),U(this,go,null)}resetEdited(){var e;g(this,Og)&&({contentsObj:Ai(this,Ku)._,richText:Ai(this,Ch)._}=g(this,Og),U(this,Og,null),(e=g(this,go))==null||e.remove(),U(this,go,null),U(this,Th,null))}remove(){var e,t,r;if((e=g(this,Ah))==null||e.abort(),U(this,Ah,null),(t=g(this,go))==null||t.remove(),U(this,go,null),U(this,Of,!1),U(this,Yu,!1),(r=g(this,Wr))==null||r.remove(),U(this,Wr,null),this.trigger)for(const i of this.trigger)i.classList.remove("popupTriggerArea")}forceHide(){U(this,Of,this.isVisible),g(this,Of)&&(g(this,qr).hidden=!0)}maybeShow(){g(this,mo)||(X(this,on,kM).call(this),g(this,Of)&&(g(this,go)||X(this,on,VM).call(this),U(this,Of,!1),g(this,qr).hidden=!1))}get isVisible(){return g(this,mo)?!1:g(this,qr).hidden===!1}}mo=new WeakMap,Pf=new WeakMap,v2=new WeakMap,y2=new WeakMap,Mx=new WeakMap,Cx=new WeakMap,qr=new WeakMap,Ku=new WeakMap,Ff=new WeakMap,Lg=new WeakMap,Dx=new WeakMap,Nx=new WeakMap,Yu=new WeakMap,go=new WeakMap,Ah=new WeakMap,Th=new WeakMap,Wr=new WeakMap,Mh=new WeakMap,Lf=new WeakMap,KE=new WeakMap,Ch=new WeakMap,Rx=new WeakMap,Og=new WeakMap,Of=new WeakMap,Yi=new WeakMap,kf=new WeakMap,on=new WeakSet,kM=function(){var t;if(g(this,Ah))return;U(this,Ah,new AbortController);const{signal:e}=g(this,Ah);for(const r of this.trigger)r.addEventListener("click",g(this,Mx),{signal:e}),r.addEventListener("pointerenter",g(this,y2),{signal:e}),r.addEventListener("pointerleave",g(this,v2),{signal:e}),r.classList.add("popupTriggerArea");for(const r of g(this,Lg))(t=r.container)==null||t.addEventListener("keydown",g(this,Pf),{signal:e})},BF=function(){const e=g(this,Lg).find(t=>t.hasCommentButton);e&&U(this,Mh,e._normalizePoint(e.commentButtonPosition))},UF=function(){if(g(this,Yi).extraPopupElement&&!g(this,Yi).editor)return;g(this,Wr)||this.renderCommentButton();const[e,t]=g(this,Mh),{style:r}=g(this,Wr);r.left=`calc(${e}%)`,r.top=`calc(${t}% - var(--comment-button-dim))`},VF=function(){g(this,Yi).extraPopupElement||(g(this,Wr)||this.renderCommentButton(),g(this,Wr).style.backgroundColor=this.commentButtonColor||"")},BM=function(){const e=g(this,Ch),t=g(this,Ku);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&g(this,Ch).html||null},zF=function(){var e,t,r;return((r=(t=(e=g(this,on,BM))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:r.fontSize)||0},qZ=function(){var e,t,r;return((r=(t=(e=g(this,on,BM))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:r.color)||null},WZ=function(e){const t=[],r={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:g(this,on,qZ),fontSize:g(this,on,zF)?`calc(${g(this,on,zF)}px * var(--total-scale-factor))`:""}};for(const s of e.split(`
`))t.push({name:"span",value:s,attributes:i});return r},XZ=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&g(this,Yu))&&X(this,on,UM).call(this)},KZ=function(){if(g(this,Th)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:r,pageX:i,pageY:s}}}=g(this,Dx);let a=!!g(this,Nx),o=a?g(this,Nx):g(this,KE);for(const p of g(this,Lg))if(!o||yt.intersect(p.data.rect,o)!==null){o=p.data.rect,a=!0;break}const l=yt.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),c=a?o[2]-o[0]+5:0,h=l[0]+c,d=l[1];U(this,Th,[100*(h-i)/t,100*(d-s)/r]);const{style:f}=g(this,qr);f.left=`${g(this,Th)[0]}%`,f.top=`${g(this,Th)[1]}%`},UM=function(){if(g(this,mo)){g(this,mo).toggleCommentPopup(this,!1);return}U(this,Yu,!g(this,Yu)),g(this,Yu)?(X(this,on,VM).call(this),g(this,qr).addEventListener("click",g(this,Mx)),g(this,qr).addEventListener("keydown",g(this,Pf))):(X(this,on,$F).call(this),g(this,qr).removeEventListener("click",g(this,Mx)),g(this,qr).removeEventListener("keydown",g(this,Pf)))},VM=function(){g(this,go)||this.render(),this.isVisible?g(this,Yu)&&g(this,qr).classList.add("focused"):(X(this,on,KZ).call(this),g(this,qr).hidden=!1,g(this,qr).style.zIndex=parseInt(g(this,qr).style.zIndex)+1e3)},$F=function(){g(this,qr).classList.remove("focused"),!(g(this,Yu)||!this.isVisible)&&(g(this,qr).hidden=!0,g(this,qr).style.zIndex=parseInt(g(this,qr).style.zIndex)-1e3)};class YZ extends Ur{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Jt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const r=document.createElement("span");r.textContent=t,e.append(r)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var YE;class _ye extends Ur{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});j(this,YE,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:r,height:i}=this,s=this.svgFactory.create(r,i,!0),a=U(this,YE,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return g(this,YE)}addHighlightArea(){this.container.classList.add("highlightArea")}}YE=new WeakMap;var QE;class wye extends Ur{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});j(this,QE,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:r,height:i}=this,s=this.svgFactory.create(r,i,!0),a=t.borderStyle.width,o=U(this,QE,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",r-a),o.setAttribute("height",i-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return g(this,QE)}addHighlightArea(){this.container.classList.add("highlightArea")}}QE=new WeakMap;var ZE;class Eye extends Ur{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});j(this,ZE,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:r,height:i}=this,s=this.svgFactory.create(r,i,!0),a=t.borderStyle.width,o=U(this,ZE,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",r/2),o.setAttribute("cy",i/2),o.setAttribute("rx",r/2-a/2),o.setAttribute("ry",i/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return g(this,ZE)}addHighlightArea(){this.container.classList.add("highlightArea")}}ZE=new WeakMap;var JE;class QZ extends Ur{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});j(this,JE,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:r,borderStyle:i,popupRef:s},width:a,height:o}=this;if(!r)return this.container;const l=this.svgFactory.create(a,o,!0);let u=[];for(let h=0,d=r.length;h<d;h+=2){const f=r[h]-t[0],p=t[3]-r[h+1];u.push(`${f},${p}`)}u=u.join(" ");const c=U(this,JE,this.svgFactory.createElement(this.svgElementName));return c.setAttribute("points",u),c.setAttribute("stroke-width",i.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),l.append(c),this.container.append(l),!s&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return g(this,JE)}addHighlightArea(){this.container.classList.add("highlightArea")}}JE=new WeakMap;class Sye extends QZ{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Aye extends Ur{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var eS,kg,tS,HF;class v4 extends Ur{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});j(this,tS);j(this,eS,null);j(this,kg,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Jt.HIGHLIGHT:Jt.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:r,inkLists:i,borderStyle:s,popupRef:a}}=this,{transform:o,width:l,height:u}=X(this,tS,HF).call(this,r,t),c=this.svgFactory.create(l,u,!0),h=U(this,eS,this.svgFactory.createElement("svg:g"));c.append(h),h.setAttribute("stroke-width",s.width||1),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),h.setAttribute("stroke-miterlimit",10),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),h.setAttribute("transform",o);for(let d=0,f=i.length;d<f;d++){const p=this.svgFactory.createElement(this.svgElementName);g(this,kg).push(p),p.setAttribute("points",i[d].join(",")),h.append(p)}return!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(c),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:r,points:i,rect:s}=t,a=g(this,eS);if(r>=0&&a.setAttribute("stroke-width",r||1),i)for(let o=0,l=g(this,kg).length;o<l;o++)g(this,kg)[o].setAttribute("points",i[o].join(","));if(s){const{transform:o,width:l,height:u}=X(this,tS,HF).call(this,this.data.rotation,s);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${u}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return g(this,kg)}addHighlightArea(){this.container.classList.add("highlightArea")}}eS=new WeakMap,kg=new WeakMap,tS=new WeakSet,HF=function(t,r){switch(t){case 90:return{transform:`rotate(90) translate(${-r[0]},${r[1]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};case 180:return{transform:`rotate(180) translate(${-r[2]},${r[1]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]};case 270:return{transform:`rotate(270) translate(${-r[2]},${r[3]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};default:return{transform:`translate(${-r[0]},${r[3]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]}}};class ZZ extends Ur{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Jt.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const r=document.createElement("mark");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class Tye extends Ur{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const r=document.createElement("u");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class Mye extends Ur{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const r=document.createElement("u");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class Cye extends Ur{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const r=document.createElement("s");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class JZ extends Ur{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Jt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var nS,rS,GF;class Dye extends Ur{constructor(t){var i;super(t,{isRenderable:!0});j(this,rS);j(this,nS,null);const{file:r}=this.data;this.filename=r.filename,this.content=r.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...r})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:r}=this;let i;r.hasAppearance||r.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(r.name)?"paperclip":"pushpin"}.svg`,r.fillAlpha&&r.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(r.fillAlpha*100)}%);`)),i.addEventListener("dblclick",X(this,rS,GF).bind(this)),U(this,nS,i);const{isMac:s}=Cs.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(s?a.metaKey:a.ctrlKey)&&X(this,rS,GF).call(this)}),!r.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return g(this,nS)}addHighlightArea(){this.container.classList.add("highlightArea")}}nS=new WeakMap,rS=new WeakSet,GF=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Bg,Ug,Ix,Bf,iS,Vg,vo,sS,ed,zM,qF;const HU=class HU{constructor({div:e,accessibilityManager:t,annotationCanvasMap:r,annotationEditorUIManager:i,page:s,viewport:a,structTreeLayer:o,commentManager:l,linkService:u,annotationStorage:c}){j(this,ed);j(this,Bg,null);j(this,Ug,null);j(this,Ix,null);j(this,Bf,new Map);j(this,iS,null);j(this,Vg,null);j(this,vo,[]);j(this,sS,!1);this.div=e,U(this,Bg,t),U(this,Ug,r),U(this,iS,o||null),U(this,Vg,u||null),U(this,Ix,c||new f4),this.page=s,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i,this._commentManager=l||null}hasEditableAnnotations(){return g(this,Bf).size>0}async render(e){var o;const{annotations:t}=e,r=this.div;Ev(r,this.viewport);const i=new Map,s=[],a={data:null,layer:r,linkService:g(this,Vg),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new fD,annotationStorage:g(this,Ix),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const l of t){if(l.noHTML)continue;const u=l.annotationType===mi.POPUP;if(u){const d=i.get(l.id);if(!d)continue;if(!this._commentManager){s.push(l);continue}a.elements=d}else if(l.rect[2]===l.rect[0]||l.rect[3]===l.rect[1])continue;a.data=l;const c=hI.create(a);if(!c.isRenderable)continue;if(!u&&(g(this,vo).push(c),l.popupRef)){const d=i.get(l.popupRef);d?d.push(c):i.set(l.popupRef,[c])}const h=c.render();l.hidden&&(h.style.visibility="hidden"),c._isEditable&&(g(this,Bf).set(c.data.id,c),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(c))}await X(this,ed,zM).call(this);for(const l of s){const u=a.elements=i.get(l.id);a.data=l;const c=hI.create(a);if(!c.isRenderable)continue;const h=c.render();c.contentElement.id=`${ny}${l.id}`,l.hidden&&(h.style.visibility="hidden"),u.at(-1).container.after(h)}X(this,ed,qF).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:g(this,Vg),svgFactory:new fD,parent:this};for(const r of e){r.borderStyle||(r.borderStyle=HU._defaultBorderStyle),t.data=r;const i=hI.create(t);i.isRenderable&&(i.render(),i.contentElement.id=`${ny}${r.id}`,g(this,vo).push(i))}await X(this,ed,zM).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,Ev(t,{rotation:e.rotation}),X(this,ed,qF).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(g(this,Bf).values())}getEditableAnnotation(e){return g(this,Bf).get(e)}addFakeAnnotation(e){const{div:t}=this,{id:r,rotation:i}=e,s=new fye({data:{id:r,rect:e.getPDFRect(),rotation:i},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:g(this,Vg),annotationStorage:g(this,Ix)});return s.render(),s.contentElement.id=`${ny}${r}`,s.createOrUpdatePopup(),g(this,vo).push(s),s}removeAnnotation(e){var i;const t=g(this,vo).findIndex(s=>s.data.id===e);if(t<0)return;const[r]=g(this,vo).splice(t,1);(i=g(this,Bg))==null||i.removePointerInTextLayer(r.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);X(this,ed,zM).call(this)}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return Kt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:N0.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};Bg=new WeakMap,Ug=new WeakMap,Ix=new WeakMap,Bf=new WeakMap,iS=new WeakMap,Vg=new WeakMap,vo=new WeakMap,sS=new WeakMap,ed=new WeakSet,zM=async function(){var r,i,s;if(g(this,vo).length===0)return;this.div.replaceChildren();const e=[];if(!g(this,sS)){U(this,sS,!0);for(const{contentElement:a,data:{id:o}}of g(this,vo)){const l=a.id=`${ny}${o}`;e.push((r=g(this,iS))==null?void 0:r.getAriaAttributes(l).then(u=>{if(u)for(const[c,h]of u)a.setAttribute(c,h)}))}}g(this,vo).sort(({data:{rect:[a,o,l,u]}},{data:{rect:[c,h,d,f]}})=>{if(a===l&&o===u)return 1;if(c===d&&h===f)return-1;const p=u,m=o,y=(o+u)/2,v=f,b=h,x=(h+f)/2;if(y>=v&&x<=m)return-1;if(x>=p&&y<=b)return 1;const w=(a+l)/2,_=(c+d)/2;return w-_});const t=document.createDocumentFragment();for(const a of g(this,vo))t.append(a.container),this._commentManager?(s=((i=a.extraPopupElement)==null?void 0:i.popup)||a.popup)==null||s.renderCommentButton():a.extraPopupElement&&t.append(a.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),g(this,Bg))for(const a of g(this,vo))g(this,Bg).addPointerInTextLayer(a.contentElement,!1)},qF=function(){var t;if(!g(this,Ug))return;const e=this.div;for(const[r,i]of g(this,Ug)){const s=e.querySelector(`[data-annotation-id="${r}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:a}=s;a?a.nodeName==="CANVAS"?a.replaceWith(i):a.classList.contains("annotationContent")?a.after(i):a.before(i):s.append(i);const o=g(this,Bf).get(r);o&&(o._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(r,s.id,i),o._hasNoCanvas=!1):o.canvas=i)}g(this,Ug).clear()};let jF=HU;const iT=/\r\n?|\n/g;var yo,aS,zg,xo,Ei,eJ,tJ,nJ,$M,td,HM,GM,rJ,XF,iJ;const wr=class wr extends br{constructor(t){super({...t,name:"freeTextEditor"});j(this,Ei);j(this,yo,"");j(this,aS,`${this.id}-editor`);j(this,zg,null);j(this,xo);Qe(this,"_colorPicker",null);this.color=t.color||wr._defaultColor||br._defaultLineColor,U(this,xo,t.fontSize||wr._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static get _keyboardManager(){const t=wr.prototype,r=a=>a.isEmpty(),i=Sv.TRANSLATE_SMALL,s=Sv.TRANSLATE_BIG;return Kt(this,"_keyboardManager",new WS([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:r}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:r}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:r}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:r}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:r}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:r}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:r}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:r}]]))}static initialize(t,r){br.initialize(t,r);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,r){switch(t){case En.FREETEXT_SIZE:wr._defaultFontSize=r;break;case En.FREETEXT_COLOR:wr._defaultColor=r;break}}updateParams(t,r){switch(t){case En.FREETEXT_SIZE:X(this,Ei,eJ).call(this,r);break;case En.FREETEXT_COLOR:X(this,Ei,tJ).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[En.FREETEXT_SIZE,wr._defaultFontSize],[En.FREETEXT_COLOR,wr._defaultColor||br._defaultLineColor]]}get propertiesToUpdate(){return[[En.FREETEXT_SIZE,g(this,xo)],[En.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new dD(this)),[["colorPicker",this._colorPicker]]}get colorType(){return En.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,r){this._uiManager.translateSelectedEditors(t,r,!0)}getInitialTranslation(){const t=this.parentScale;return[-wr._internalPadding*t,-(wr._internalPadding+g(this,xo))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),U(this,zg,new AbortController);const t=this._uiManager.combinedSignal(g(this,zg));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",g(this,aS)),this._isDraggable=!0,(t=g(this,zg))==null||t.abort(),U(this,zg,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var r;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(r=this._initialOptions)!=null&&r.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=g(this,yo),r=U(this,yo,X(this,Ei,nJ).call(this).trimEnd());if(t===r)return;const i=s=>{if(U(this,yo,s),!s){this.remove();return}X(this,Ei,GM).call(this),this._uiManager.rebuild(this),X(this,Ei,$M).call(this)};this.addCommands({cmd:()=>{i(r)},undo:()=>{i(t)},mustExec:!1}),X(this,Ei,$M).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){wr._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,r;(this._isCopy||this.annotationElementId)&&(t=this.x,r=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",g(this,aS)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${g(this,xo)}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,u]=this.getInitialTranslation();[l,u]=this.pageTranslationToScreen(l,u);const[c,h]=this.pageDimensions,[d,f]=this.pageTranslation;let p,m;switch(this.rotation){case 0:p=t+(o[0]-d)/c,m=r+this.height-(o[1]-f)/h;break;case 90:p=t+(o[0]-d)/c,m=r-(o[1]-f)/h,[l,u]=[u,-l];break;case 180:p=t-this.width+(o[0]-d)/c,m=r-(o[1]-f)/h,[l,u]=[-l,-u];break;case 270:p=t+(o[0]-d-this.height*h)/c,m=r+(o[1]-f-this.width*c)/h,[l,u]=[-u,l];break}this.setAt(p*s,m*a,l,u)}else this._moveAfterPaste(t,r);X(this,Ei,GM).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var p,m,y;const r=t.clipboardData||window.clipboardData,{types:i}=r;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const s=X(p=wr,td,XF).call(p,r.getData("text")||"").replaceAll(iT,`
`);if(!s)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!s.includes(`
`)){o.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:u}=o,c=[],h=[];if(l.nodeType===Node.TEXT_NODE){const v=l.parentElement;if(h.push(l.nodeValue.slice(u).replaceAll(iT,"")),v!==this.editorDiv){let b=c;for(const x of this.editorDiv.childNodes){if(x===v){b=h;continue}b.push(X(m=wr,td,HM).call(m,x))}}c.push(l.nodeValue.slice(0,u).replaceAll(iT,""))}else if(l===this.editorDiv){let v=c,b=0;for(const x of this.editorDiv.childNodes)b++===u&&(v=h),v.push(X(y=wr,td,HM).call(y,x))}U(this,yo,`${c.join(`
`)}${s}${h.join(`
`)}`),X(this,Ei,GM).call(this);const d=new Range;let f=Math.sumPrecise(c.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const b=v.nodeValue.length;if(f<=b){d.setStart(v,f),d.setEnd(v,f);break}f-=b}a.removeAllRanges(),a.addRange(d)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=wr._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,r,i){var o;let s=null;if(t instanceof YZ){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:c,rotation:h,id:d,popupRef:f,richText:p,contentsObj:m,creationDate:y,modificationDate:v},textContent:b,textPosition:x,parent:{page:{pageNumber:w}}}=t;if(!b||b.length===0)return null;s=t={annotationType:Jt.FREETEXT,color:Array.from(u),fontSize:l,value:b.join(`
`),position:x,pageIndex:w-1,rect:c.slice(0),rotation:h,annotationElementId:d,id:d,deleted:!1,popupRef:f,comment:(m==null?void 0:m.str)||null,richText:p,creationDate:y,modificationDate:v}}const a=await super.deserialize(t,r,i);return U(a,xo,t.fontSize),a.color=yt.makeHexColor(...t.color),U(a,yo,X(o=wr,td,XF).call(o,t.value)),a._initialData=s,t.comment&&a.setCommentData(t),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r=br._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:r,fontSize:g(this,xo),value:X(this,Ei,rJ).call(this)});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!X(this,Ei,iJ).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){const r=super.renderAnnotationElement(t);if(!r)return null;const{style:i}=r;i.fontSize=`calc(${g(this,xo)}px * var(--total-scale-factor))`,i.color=this.color,r.replaceChildren();for(const s of g(this,yo).split(`
`)){const a=document.createElement("div");a.append(s?document.createTextNode(s):document.createElement("br")),r.append(a)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:g(this,yo)}}),r}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};yo=new WeakMap,aS=new WeakMap,zg=new WeakMap,xo=new WeakMap,Ei=new WeakSet,eJ=function(t){const r=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-g(this,xo))*this.parentScale),U(this,xo,s),X(this,Ei,$M).call(this)},i=g(this,xo);this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:En.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},tJ=function(t){const r=s=>{this.color=s,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:En.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},nJ=function(){var i;const t=[];this.editorDiv.normalize();let r=null;for(const s of this.editorDiv.childNodes)(r==null?void 0:r.nodeType)===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(X(i=wr,td,HM).call(i,s)),r=s);return t.join(`
`)},$M=function(){const[t,r]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:s,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",s.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/r):(this.width=i.height/t,this.height=i.width/r),this.fixAndSetPosition()},td=new WeakSet,HM=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(iT,"")},GM=function(){if(this.editorDiv.replaceChildren(),!!g(this,yo))for(const t of g(this,yo).split(`
`)){const r=document.createElement("div");r.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(r)}},rJ=function(){return g(this,yo).replaceAll(""," ")},XF=function(t){return t.replaceAll(" ","")},iJ=function(t){const{value:r,fontSize:i,color:s,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==r||t.fontSize!==i||t.color.some((o,l)=>o!==s[l])||t.pageIndex!==a},j(wr,td),Qe(wr,"_freeTextDefaultContent",""),Qe(wr,"_internalPadding",0),Qe(wr,"_defaultColor",null),Qe(wr,"_defaultFontSize",10),Qe(wr,"_type","freetext"),Qe(wr,"_editorType",Jt.FREETEXT);let WF=wr;class pt{toSVGPath(){fr("Abstract method `toSVGPath` must be implemented.")}get box(){fr("Abstract getter `box` must be implemented.")}serialize(e,t){fr("Abstract method `serialize` must be implemented.")}static _rescale(e,t,r,i,s,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*i,a[o+1]=r+e[o+1]*s;return a}static _rescaleAndSwap(e,t,r,i,s,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*i,a[o+1]=r+e[o]*s;return a}static _translate(e,t,r,i){i||(i=new Float32Array(e.length));for(let s=0,a=e.length;s<a;s+=2)i[s]=t+e[s],i[s+1]=r+e[s+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,r,i,s){switch(s){case 90:return[1-t/r,e/i];case 180:return[1-e/r,1-t/i];case 270:return[t/r,1-e/i];default:return[e/r,t/i]}}static _normalizePagePoint(e,t,r){switch(r){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,r,i,s,a){return[(e+5*r)/6,(t+5*i)/6,(5*r+s)/6,(5*i+a)/6,(r+s)/2,(i+a)/2]}}Qe(pt,"PRECISION",1e-4);var bo,Ql,Px,Fx,Qu,fn,$g,Hg,oS,lS,Lx,Ox,Uf,uS,x2,b2,Pi,o1,sJ,aJ,oJ,lJ,uJ,cJ;const eh=class eh{constructor({x:e,y:t},r,i,s,a,o=0){j(this,Pi);j(this,bo);j(this,Ql,[]);j(this,Px);j(this,Fx);j(this,Qu,[]);j(this,fn,new Float32Array(18));j(this,$g);j(this,Hg);j(this,oS);j(this,lS);j(this,Lx);j(this,Ox);j(this,Uf,[]);U(this,bo,r),U(this,Ox,s*i),U(this,Fx,a),g(this,fn).set([NaN,NaN,NaN,NaN,e,t],6),U(this,Px,o),U(this,lS,g(eh,uS)*i),U(this,oS,g(eh,b2)*i),U(this,Lx,i),g(this,Uf).push(e,t)}isEmpty(){return isNaN(g(this,fn)[8])}add({x:e,y:t}){var S;U(this,$g,e),U(this,Hg,t);const[r,i,s,a]=g(this,bo);let[o,l,u,c]=g(this,fn).subarray(8,12);const h=e-u,d=t-c,f=Math.hypot(h,d);if(f<g(this,oS))return!1;const p=f-g(this,lS),m=p/f,y=m*h,v=m*d;let b=o,x=l;o=u,l=c,u+=y,c+=v,(S=g(this,Uf))==null||S.push(e,t);const w=-v/p,_=y/p,E=w*g(this,Ox),A=_*g(this,Ox);return g(this,fn).set(g(this,fn).subarray(2,8),0),g(this,fn).set([u+E,c+A],4),g(this,fn).set(g(this,fn).subarray(14,18),12),g(this,fn).set([u-E,c-A],16),isNaN(g(this,fn)[6])?(g(this,Qu).length===0&&(g(this,fn).set([o+E,l+A],2),g(this,Qu).push(NaN,NaN,NaN,NaN,(o+E-r)/s,(l+A-i)/a),g(this,fn).set([o-E,l-A],14),g(this,Ql).push(NaN,NaN,NaN,NaN,(o-E-r)/s,(l-A-i)/a)),g(this,fn).set([b,x,o,l,u,c],6),!this.isEmpty()):(g(this,fn).set([b,x,o,l,u,c],6),Math.abs(Math.atan2(x-l,b-o)-Math.atan2(v,y))<Math.PI/2?([o,l,u,c]=g(this,fn).subarray(2,6),g(this,Qu).push(NaN,NaN,NaN,NaN,((o+u)/2-r)/s,((l+c)/2-i)/a),[o,l,b,x]=g(this,fn).subarray(14,18),g(this,Ql).push(NaN,NaN,NaN,NaN,((b+o)/2-r)/s,((x+l)/2-i)/a),!0):([b,x,o,l,u,c]=g(this,fn).subarray(0,6),g(this,Qu).push(((b+5*o)/6-r)/s,((x+5*l)/6-i)/a,((5*o+u)/6-r)/s,((5*l+c)/6-i)/a,((o+u)/2-r)/s,((l+c)/2-i)/a),[u,c,o,l,b,x]=g(this,fn).subarray(12,18),g(this,Ql).push(((b+5*o)/6-r)/s,((x+5*l)/6-i)/a,((5*o+u)/6-r)/s,((5*l+c)/6-i)/a,((o+u)/2-r)/s,((l+c)/2-i)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=g(this,Qu),t=g(this,Ql);if(isNaN(g(this,fn)[6])&&!this.isEmpty())return X(this,Pi,sJ).call(this);const r=[];r.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?r.push(`L${e[i+4]} ${e[i+5]}`):r.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);X(this,Pi,oJ).call(this,r);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?r.push(`L${t[i+4]} ${t[i+5]}`):r.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return X(this,Pi,aJ).call(this,r),r.join(" ")}newFreeDrawOutline(e,t,r,i,s,a){return new hJ(e,t,r,i,s,a)}getOutlines(){var h;const e=g(this,Qu),t=g(this,Ql),r=g(this,fn),[i,s,a,o]=g(this,bo),l=new Float32Array((((h=g(this,Uf))==null?void 0:h.length)??0)+2);for(let d=0,f=l.length-2;d<f;d+=2)l[d]=(g(this,Uf)[d]-i)/a,l[d+1]=(g(this,Uf)[d+1]-s)/o;if(l[l.length-2]=(g(this,$g)-i)/a,l[l.length-1]=(g(this,Hg)-s)/o,isNaN(r[6])&&!this.isEmpty())return X(this,Pi,lJ).call(this,l);const u=new Float32Array(g(this,Qu).length+24+g(this,Ql).length);let c=e.length;for(let d=0;d<c;d+=2){if(isNaN(e[d])){u[d]=u[d+1]=NaN;continue}u[d]=e[d],u[d+1]=e[d+1]}c=X(this,Pi,cJ).call(this,u,c);for(let d=t.length-6;d>=6;d-=6)for(let f=0;f<6;f+=2){if(isNaN(t[d+f])){u[c]=u[c+1]=NaN,c+=2;continue}u[c]=t[d+f],u[c+1]=t[d+f+1],c+=2}return X(this,Pi,uJ).call(this,u,c),this.newFreeDrawOutline(u,l,g(this,bo),g(this,Lx),g(this,Px),g(this,Fx))}};bo=new WeakMap,Ql=new WeakMap,Px=new WeakMap,Fx=new WeakMap,Qu=new WeakMap,fn=new WeakMap,$g=new WeakMap,Hg=new WeakMap,oS=new WeakMap,lS=new WeakMap,Lx=new WeakMap,Ox=new WeakMap,Uf=new WeakMap,uS=new WeakMap,x2=new WeakMap,b2=new WeakMap,Pi=new WeakSet,o1=function(){const e=g(this,fn).subarray(4,6),t=g(this,fn).subarray(16,18),[r,i,s,a]=g(this,bo);return[(g(this,$g)+(e[0]-t[0])/2-r)/s,(g(this,Hg)+(e[1]-t[1])/2-i)/a,(g(this,$g)+(t[0]-e[0])/2-r)/s,(g(this,Hg)+(t[1]-e[1])/2-i)/a]},sJ=function(){const[e,t,r,i]=g(this,bo),[s,a,o,l]=X(this,Pi,o1).call(this);return`M${(g(this,fn)[2]-e)/r} ${(g(this,fn)[3]-t)/i} L${(g(this,fn)[4]-e)/r} ${(g(this,fn)[5]-t)/i} L${s} ${a} L${o} ${l} L${(g(this,fn)[16]-e)/r} ${(g(this,fn)[17]-t)/i} L${(g(this,fn)[14]-e)/r} ${(g(this,fn)[15]-t)/i} Z`},aJ=function(e){const t=g(this,Ql);e.push(`L${t[4]} ${t[5]} Z`)},oJ=function(e){const[t,r,i,s]=g(this,bo),a=g(this,fn).subarray(4,6),o=g(this,fn).subarray(16,18),[l,u,c,h]=X(this,Pi,o1).call(this);e.push(`L${(a[0]-t)/i} ${(a[1]-r)/s} L${l} ${u} L${c} ${h} L${(o[0]-t)/i} ${(o[1]-r)/s}`)},lJ=function(e){const t=g(this,fn),[r,i,s,a]=g(this,bo),[o,l,u,c]=X(this,Pi,o1).call(this),h=new Float32Array(36);return h.set([NaN,NaN,NaN,NaN,(t[2]-r)/s,(t[3]-i)/a,NaN,NaN,NaN,NaN,(t[4]-r)/s,(t[5]-i)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,u,c,NaN,NaN,NaN,NaN,(t[16]-r)/s,(t[17]-i)/a,NaN,NaN,NaN,NaN,(t[14]-r)/s,(t[15]-i)/a],0),this.newFreeDrawOutline(h,e,g(this,bo),g(this,Lx),g(this,Px),g(this,Fx))},uJ=function(e,t){const r=g(this,Ql);return e.set([NaN,NaN,NaN,NaN,r[4],r[5]],t),t+=6},cJ=function(e,t){const r=g(this,fn).subarray(4,6),i=g(this,fn).subarray(16,18),[s,a,o,l]=g(this,bo),[u,c,h,d]=X(this,Pi,o1).call(this);return e.set([NaN,NaN,NaN,NaN,(r[0]-s)/o,(r[1]-a)/l,NaN,NaN,NaN,NaN,u,c,NaN,NaN,NaN,NaN,h,d,NaN,NaN,NaN,NaN,(i[0]-s)/o,(i[1]-a)/l],t),t+=24},j(eh,uS,8),j(eh,x2,2),j(eh,b2,g(eh,uS)+g(eh,x2));let pD=eh;var kx,Gg,Dh,cS,_o,hS,ii,_2,dJ;class hJ extends pt{constructor(t,r,i,s,a,o){super();j(this,_2);j(this,kx);j(this,Gg,new Float32Array(4));j(this,Dh);j(this,cS);j(this,_o);j(this,hS);j(this,ii);U(this,ii,t),U(this,_o,r),U(this,kx,i),U(this,hS,s),U(this,Dh,a),U(this,cS,o),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],X(this,_2,dJ).call(this,o);const[l,u,c,h]=g(this,Gg);for(let d=0,f=t.length;d<f;d+=2)t[d]=(t[d]-l)/c,t[d+1]=(t[d+1]-u)/h;for(let d=0,f=r.length;d<f;d+=2)r[d]=(r[d]-l)/c,r[d+1]=(r[d+1]-u)/h}toSVGPath(){const t=[`M${g(this,ii)[4]} ${g(this,ii)[5]}`];for(let r=6,i=g(this,ii).length;r<i;r+=6){if(isNaN(g(this,ii)[r])){t.push(`L${g(this,ii)[r+4]} ${g(this,ii)[r+5]}`);continue}t.push(`C${g(this,ii)[r]} ${g(this,ii)[r+1]} ${g(this,ii)[r+2]} ${g(this,ii)[r+3]} ${g(this,ii)[r+4]} ${g(this,ii)[r+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,r,i,s],a){const o=i-t,l=s-r;let u,c;switch(a){case 0:u=pt._rescale(g(this,ii),t,s,o,-l),c=pt._rescale(g(this,_o),t,s,o,-l);break;case 90:u=pt._rescaleAndSwap(g(this,ii),t,r,o,l),c=pt._rescaleAndSwap(g(this,_o),t,r,o,l);break;case 180:u=pt._rescale(g(this,ii),i,r,-o,l),c=pt._rescale(g(this,_o),i,r,-o,l);break;case 270:u=pt._rescaleAndSwap(g(this,ii),i,s,-o,-l),c=pt._rescaleAndSwap(g(this,_o),i,s,-o,-l);break}return{outline:Array.from(u),points:[Array.from(c)]}}get box(){return g(this,Gg)}newOutliner(t,r,i,s,a,o=0){return new pD(t,r,i,s,a,o)}getNewOutline(t,r){const[i,s,a,o]=g(this,Gg),[l,u,c,h]=g(this,kx),d=a*c,f=o*h,p=i*c+l,m=s*h+u,y=this.newOutliner({x:g(this,_o)[0]*d+p,y:g(this,_o)[1]*f+m},g(this,kx),g(this,hS),t,g(this,cS),r??g(this,Dh));for(let v=2;v<g(this,_o).length;v+=2)y.add({x:g(this,_o)[v]*d+p,y:g(this,_o)[v+1]*f+m});return y.getOutlines()}}kx=new WeakMap,Gg=new WeakMap,Dh=new WeakMap,cS=new WeakMap,_o=new WeakMap,hS=new WeakMap,ii=new WeakMap,_2=new WeakSet,dJ=function(t){const r=g(this,ii);let i=r[4],s=r[5];const a=[i,s,i,s];let o=i,l=s,u=i,c=s;const h=t?Math.max:Math.min,d=new Float32Array(4);for(let p=6,m=r.length;p<m;p+=6){const y=r[p+4],v=r[p+5];isNaN(r[p])?(yt.pointBoundingBox(y,v,a),l>v?(o=y,l=v):l===v&&(o=h(o,y)),c<v?(u=y,c=v):c===v&&(u=h(u,y))):(d[0]=d[1]=1/0,d[2]=d[3]=-1/0,yt.bezierBoundingBox(i,s,...r.slice(p,p+6),d),yt.rectBoundingBox(d[0],d[1],d[2],d[3],a),l>d[1]?(o=d[0],l=d[1]):l===d[1]&&(o=h(o,d[0])),c<d[3]?(u=d[2],c=d[3]):c===d[3]&&(u=h(u,d[2]))),i=y,s=v}const f=g(this,Gg);f[0]=a[0]-g(this,Dh),f[1]=a[1]-g(this,Dh),f[2]=a[2]-a[0]+2*g(this,Dh),f[3]=a[3]-a[1]+2*g(this,Dh),this.firstPoint=[o,l],this.lastPoint=[u,c]};var dS,fS,pS,Vf,Zl,Ma,fJ,jM,pJ,mJ,YF;class KF{constructor(e,t=0,r=0,i=!0){j(this,Ma);j(this,dS);j(this,fS);j(this,pS);j(this,Vf,[]);j(this,Zl,[]);const s=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:m,y,width:v,height:b}of e){const x=Math.floor((m-t)/a)*a,w=Math.ceil((m+v+t)/a)*a,_=Math.floor((y-t)/a)*a,E=Math.ceil((y+b+t)/a)*a,A=[x,_,E,!0],T=[w,_,E,!1];g(this,Vf).push(A,T),yt.rectBoundingBox(x,_,w,E,s)}const o=s[2]-s[0]+2*r,l=s[3]-s[1]+2*r,u=s[0]-r,c=s[1]-r;let h=i?-1/0:1/0,d=1/0;const f=g(this,Vf).at(i?-1:-2),p=[f[0],f[2]];for(const m of g(this,Vf)){const[y,v,b,x]=m;!x&&i?v<d?(d=v,h=y):v===d&&(h=Math.max(h,y)):x&&!i&&(v<d?(d=v,h=y):v===d&&(h=Math.min(h,y))),m[0]=(y-u)/o,m[1]=(v-c)/l,m[2]=(b-c)/l}U(this,dS,new Float32Array([u,c,o,l])),U(this,fS,[h,d]),U(this,pS,p)}getOutlines(){g(this,Vf).sort((t,r)=>t[0]-r[0]||t[1]-r[1]||t[2]-r[2]);const e=[];for(const t of g(this,Vf))t[3]?(e.push(...X(this,Ma,YF).call(this,t)),X(this,Ma,pJ).call(this,t)):(X(this,Ma,mJ).call(this,t),e.push(...X(this,Ma,YF).call(this,t)));return X(this,Ma,fJ).call(this,e)}}dS=new WeakMap,fS=new WeakMap,pS=new WeakMap,Vf=new WeakMap,Zl=new WeakMap,Ma=new WeakSet,fJ=function(e){const t=[],r=new Set;for(const a of e){const[o,l,u]=a;t.push([o,l,a],[o,u,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],u=t[a+1][2];l.push(u),u.push(l),r.add(l),r.add(u)}const i=[];let s;for(;r.size>0;){const a=r.values().next().value;let[o,l,u,c,h]=a;r.delete(a);let d=o,f=l;for(s=[o,u],i.push(s);;){let p;if(r.has(c))p=c;else if(r.has(h))p=h;else break;r.delete(p),[o,l,u,c,h]=p,d!==o&&(s.push(d,f,o,f===l?l:u),d=o),f=f===l?u:l}s.push(d,f)}return new Nye(i,g(this,dS),g(this,fS),g(this,pS))},jM=function(e){const t=g(this,Zl);let r=0,i=t.length-1;for(;r<=i;){const s=r+i>>1,a=t[s][0];if(a===e)return s;a<e?r=s+1:i=s-1}return i+1},pJ=function([,e,t]){const r=X(this,Ma,jM).call(this,e);g(this,Zl).splice(r,0,[e,t])},mJ=function([,e,t]){const r=X(this,Ma,jM).call(this,e);for(let i=r;i<g(this,Zl).length;i++){const[s,a]=g(this,Zl)[i];if(s!==e)break;if(s===e&&a===t){g(this,Zl).splice(i,1);return}}for(let i=r-1;i>=0;i--){const[s,a]=g(this,Zl)[i];if(s!==e)break;if(s===e&&a===t){g(this,Zl).splice(i,1);return}}},YF=function(e){const[t,r,i]=e,s=[[t,r,i]],a=X(this,Ma,jM).call(this,i);for(let o=0;o<a;o++){const[l,u]=g(this,Zl)[o];for(let c=0,h=s.length;c<h;c++){const[,d,f]=s[c];if(!(u<=d||f<=l)){if(d>=l){if(f>u)s[c][1]=u;else{if(h===1)return[];s.splice(c,1),c--,h--}continue}s[c][2]=l,f>u&&s.push([t,u,f])}}}return s};var mS,Bx;class Nye extends pt{constructor(t,r,i,s){super();j(this,mS);j(this,Bx);U(this,Bx,t),U(this,mS,r),this.firstPoint=i,this.lastPoint=s}toSVGPath(){const t=[];for(const r of g(this,Bx)){let[i,s]=r;t.push(`M${i} ${s}`);for(let a=2;a<r.length;a+=2){const o=r[a],l=r[a+1];o===i?(t.push(`V${l}`),s=l):l===s&&(t.push(`H${o}`),i=o)}t.push("Z")}return t.join(" ")}serialize([t,r,i,s],a){const o=[],l=i-t,u=s-r;for(const c of g(this,Bx)){const h=new Array(c.length);for(let d=0;d<c.length;d+=2)h[d]=t+c[d]*l,h[d+1]=s-c[d+1]*u;o.push(h)}return o}get box(){return g(this,mS)}get classNamesForOutlining(){return["highlightOutline"]}}mS=new WeakMap,Bx=new WeakMap;class QF extends pD{newFreeDrawOutline(e,t,r,i,s,a){return new Rye(e,t,r,i,s,a)}}class Rye extends hJ{newOutliner(e,t,r,i,s,a=0){return new QF(e,t,r,i,s,a)}}var Ux,gS,Nh,jg,vS,za,yS,xS,qg,wo,Eo,ps,Vx,zx,qs,$x,cl,bS,an,ZF,qM,gJ,vJ,yJ,JF,Tm,yl,O0,xJ,WM,XM,bJ,_J,wJ,EJ,SJ;const Un=class Un extends br{constructor(t){super({...t,name:"highlightEditor"});j(this,an);j(this,Ux,null);j(this,gS,0);j(this,Nh);j(this,jg,null);j(this,vS,null);j(this,za,null);j(this,yS,null);j(this,xS,0);j(this,qg,null);j(this,wo,null);j(this,Eo,null);j(this,ps,!1);j(this,Vx,null);j(this,zx,null);j(this,qs,null);j(this,$x,"");j(this,cl);j(this,bS,"");this.color=t.color||Un._defaultColor,U(this,cl,t.thickness||Un._defaultThickness),this.opacity=t.opacity||Un._defaultOpacity,U(this,Nh,t.boxes||null),U(this,bS,t.methodOfCreation||""),U(this,$x,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(U(this,ps,!0),X(this,an,qM).call(this,t),X(this,an,Tm).call(this)):g(this,Nh)&&(U(this,Ux,t.anchorNode),U(this,gS,t.anchorOffset),U(this,yS,t.focusNode),U(this,xS,t.focusOffset),X(this,an,ZF).call(this),X(this,an,Tm).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=Un.prototype;return Kt(this,"_keyboardManager",new WS([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:g(this,ps)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:g(this,cl),methodOfCreation:g(this,bS)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,r){var i;br.initialize(t,r),Un._defaultColor||(Un._defaultColor=((i=r.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,r){switch(t){case En.HIGHLIGHT_COLOR:Un._defaultColor=r;break;case En.HIGHLIGHT_THICKNESS:Un._defaultThickness=r;break}}translateInPage(t,r){}get toolbarPosition(){return g(this,zx)}get commentButtonPosition(){return g(this,Vx)}updateParams(t,r){switch(t){case En.HIGHLIGHT_COLOR:X(this,an,gJ).call(this,r);break;case En.HIGHLIGHT_THICKNESS:X(this,an,vJ).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[En.HIGHLIGHT_COLOR,Un._defaultColor],[En.HIGHLIGHT_THICKNESS,Un._defaultThickness]]}get propertiesToUpdate(){return[[En.HIGHLIGHT_COLOR,this.color||Un._defaultColor],[En.HIGHLIGHT_THICKNESS,g(this,cl)||Un._defaultThickness],[En.HIGHLIGHT_FREE,g(this,ps)]]}onUpdatedColor(){var t,r;(t=this.parent)==null||t.drawLayer.updateProperties(g(this,Eo),{root:{fill:this.color,"fill-opacity":this.opacity}}),(r=g(this,vS))==null||r.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",U(this,vS,new hD({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(X(this,an,XM).call(this))}getBaseTranslation(){return[0,0]}getRect(t,r){return super.getRect(t,r,X(this,an,XM).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){X(this,an,JF).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(X(this,an,Tm).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let r=!1;this.parent&&!t?X(this,an,JF).call(this):t&&(X(this,an,Tm).call(this,t),r=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),r&&this.select()}rotate(t){var s,a,o;const{drawLayer:r}=this.parent;let i;g(this,ps)?(t=(t-this.rotation+360)%360,i=X(s=Un,yl,O0).call(s,g(this,wo).box,t)):i=X(a=Un,yl,O0).call(a,[this.x,this.y,this.width,this.height],t),r.updateProperties(g(this,Eo),{bbox:i,root:{"data-main-rotation":t}}),r.updateProperties(g(this,qs),{bbox:X(o=Un,yl,O0).call(o,g(this,za).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();g(this,$x)&&(t.setAttribute("aria-label",g(this,$x)),t.setAttribute("role","mark")),g(this,ps)?t.classList.add("free"):this.div.addEventListener("keydown",X(this,an,xJ).bind(this),{signal:this._uiManager._signal});const r=U(this,qg,document.createElement("div"));return t.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",r.style.clipPath=g(this,jg),this.setDims(),HQ(this,g(this,qg),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(g(this,qs),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(g(this,qs),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:X(this,an,WM).call(this,!0);break;case 1:case 3:X(this,an,WM).call(this,!1);break}}select(){var t;super.select(),g(this,qs)&&((t=this.parent)==null||t.drawLayer.updateProperties(g(this,qs),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),g(this,qs)&&((t=this.parent)==null||t.drawLayer.updateProperties(g(this,qs),{rootClass:{selected:!1}}),g(this,ps)||X(this,an,WM).call(this,!1))}get _mustFixPosition(){return!g(this,ps)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(g(this,Eo),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(g(this,qs),{rootClass:{hidden:!t}}))}static startHighlighting(t,r,{target:i,x:s,y:a}){const{x:o,y:l,width:u,height:c}=i.getBoundingClientRect(),h=new AbortController,d=t.combinedSignal(h),f=p=>{h.abort(),X(this,yl,EJ).call(this,t,p)};window.addEventListener("blur",f,{signal:d}),window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("pointerdown",Qr,{capture:!0,passive:!1,signal:d}),window.addEventListener("contextmenu",Cl,{signal:d}),i.addEventListener("pointermove",X(this,yl,wJ).bind(this,t),{signal:d}),this._freeHighlight=new QF({x:s,y:a},[o,l,u,c],t.scale,this._defaultThickness/2,r,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,r,i){var m,y,v,b;let s=null;if(t instanceof ZZ){const{data:{quadPoints:x,rect:w,rotation:_,id:E,color:A,opacity:T,popupRef:S,richText:M,contentsObj:D,creationDate:N,modificationDate:R},parent:{page:{pageNumber:O}}}=t;s=t={annotationType:Jt.HIGHLIGHT,color:Array.from(A),opacity:T,quadPoints:x,boxes:null,pageIndex:O-1,rect:w.slice(0),rotation:_,annotationElementId:E,id:E,deleted:!1,popupRef:S,richText:M,comment:(D==null?void 0:D.str)||null,creationDate:N,modificationDate:R}}else if(t instanceof v4){const{data:{inkLists:x,rect:w,rotation:_,id:E,color:A,borderStyle:{rawWidth:T},popupRef:S,richText:M,contentsObj:D,creationDate:N,modificationDate:R},parent:{page:{pageNumber:O}}}=t;s=t={annotationType:Jt.HIGHLIGHT,color:Array.from(A),thickness:T,inkLists:x,boxes:null,pageIndex:O-1,rect:w.slice(0),rotation:_,annotationElementId:E,id:E,deleted:!1,popupRef:S,richText:M,comment:(D==null?void 0:D.str)||null,creationDate:N,modificationDate:R}}const{color:a,quadPoints:o,inkLists:l,opacity:u}=t,c=await super.deserialize(t,r,i);c.color=yt.makeHexColor(...a),c.opacity=u||1,l&&U(c,cl,t.thickness),c._initialData=s,t.comment&&c.setCommentData(t);const[h,d]=c.pageDimensions,[f,p]=c.pageTranslation;if(o){const x=U(c,Nh,[]);for(let w=0;w<o.length;w+=8)x.push({x:(o[w]-f)/h,y:1-(o[w+1]-p)/d,width:(o[w+2]-o[w])/h,height:(o[w+1]-o[w+5])/d});X(m=c,an,ZF).call(m),X(y=c,an,Tm).call(y),c.rotate(c.rotation)}else if(l){U(c,ps,!0);const x=l[0],w={x:x[0]-f,y:d-(x[1]-p)},_=new QF(w,[0,0,h,d],1,g(c,cl)/2,!0,.001);for(let T=0,S=x.length;T<S;T+=2)w.x=x[T]-f,w.y=d-(x[T+1]-p),_.add(w);const{id:E,clipPathId:A}=r.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:c.color,"fill-opacity":c._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:_.toSVGPath()}},!0,!0);X(v=c,an,qM).call(v,{highlightOutlines:_.getOutlines(),highlightId:E,clipPathId:A}),X(b=c,an,Tm).call(b),c.rotate(c.parentRotation)}return c}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const r=br._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:r,opacity:this.opacity,thickness:g(this,cl),quadPoints:X(this,an,bJ).call(this),outlines:X(this,an,_J).call(this,i.rect)}),this.addComment(i),this.annotationElementId&&!X(this,an,SJ).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};Ux=new WeakMap,gS=new WeakMap,Nh=new WeakMap,jg=new WeakMap,vS=new WeakMap,za=new WeakMap,yS=new WeakMap,xS=new WeakMap,qg=new WeakMap,wo=new WeakMap,Eo=new WeakMap,ps=new WeakMap,Vx=new WeakMap,zx=new WeakMap,qs=new WeakMap,$x=new WeakMap,cl=new WeakMap,bS=new WeakMap,an=new WeakSet,ZF=function(){const t=new KF(g(this,Nh),.001);U(this,wo,t.getOutlines()),[this.x,this.y,this.width,this.height]=g(this,wo).box;const r=new KF(g(this,Nh),.0025,.001,this._uiManager.direction==="ltr");U(this,za,r.getOutlines());const{firstPoint:i}=g(this,wo);U(this,Vx,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]);const{lastPoint:s}=g(this,za);U(this,zx,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},qM=function({highlightOutlines:t,highlightId:r,clipPathId:i}){var d,f;if(U(this,wo,t),U(this,za,t.getNewOutline(g(this,cl)/2+1.5,.0025)),r>=0)U(this,Eo,r),U(this,jg,i),this.parent.drawLayer.finalizeDraw(r,{bbox:t.box,path:{d:t.toSVGPath()}}),U(this,qs,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:g(this,za).box,path:{d:g(this,za).toSVGPath()}},!0));else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(g(this,Eo),{bbox:X(d=Un,yl,O0).call(d,g(this,wo).box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(g(this,qs),{bbox:X(f=Un,yl,O0).call(f,g(this,za).box,p),path:{d:g(this,za).toSVGPath()}})}const[a,o,l,u]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=u;break;case 90:{const[p,m]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*m/p,this.height=u*p/m;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=u;break;case 270:{const[p,m]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*m/p,this.height=u*p/m;break}}const{firstPoint:c}=t;U(this,Vx,[(c[0]-a)/l,(c[1]-o)/u]);const{lastPoint:h}=g(this,za);U(this,zx,[(h[0]-a)/l,(h[1]-o)/u])},gJ=function(t){const r=(a,o)=>{this.color=a,this.opacity=o,this.onUpdatedColor()},i=this.color,s=this.opacity;this.addCommands({cmd:r.bind(this,t,Un._defaultOpacity),undo:r.bind(this,i,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:En.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},vJ=function(t){const r=g(this,cl),i=s=>{U(this,cl,s),X(this,an,yJ).call(this,s)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:En.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},yJ=function(t){g(this,ps)&&(X(this,an,qM).call(this,{highlightOutlines:g(this,wo).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())},JF=function(){g(this,Eo)===null||!this.parent||(this.parent.drawLayer.remove(g(this,Eo)),U(this,Eo,null),this.parent.drawLayer.remove(g(this,qs)),U(this,qs,null))},Tm=function(t=this.parent){g(this,Eo)===null&&({id:Ai(this,Eo)._,clipPathId:Ai(this,jg)._}=t.drawLayer.draw({bbox:g(this,wo).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:g(this,ps)},path:{d:g(this,wo).toSVGPath()}},!1,!0),U(this,qs,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:g(this,ps)},bbox:g(this,za).box,path:{d:g(this,za).toSVGPath()}},g(this,ps))),g(this,qg)&&(g(this,qg).style.clipPath=g(this,jg)))},yl=new WeakSet,O0=function([t,r,i,s],a){switch(a){case 90:return[1-r-s,t,s,i];case 180:return[1-t-i,1-r-s,i,s];case 270:return[r,1-t-i,s,i]}return[t,r,i,s]},xJ=function(t){Un._keyboardManager.exec(this,t)},WM=function(t){if(!g(this,Ux))return;const r=window.getSelection();t?r.setPosition(g(this,Ux),g(this,gS)):r.setPosition(g(this,yS),g(this,xS))},XM=function(){return g(this,ps)?this.rotation:0},bJ=function(){if(g(this,ps))return null;const[t,r]=this.pageDimensions,[i,s]=this.pageTranslation,a=g(this,Nh),o=new Float32Array(a.length*8);let l=0;for(const{x:u,y:c,width:h,height:d}of a){const f=u*t+i,p=(1-c)*r+s;o[l]=o[l+4]=f,o[l+1]=o[l+3]=p,o[l+2]=o[l+6]=f+h*t,o[l+5]=o[l+7]=p-d*r,l+=8}return o},_J=function(t){return g(this,wo).serialize(t,X(this,an,XM).call(this))},wJ=function(t,r){this._freeHighlight.add(r)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},EJ=function(t,r){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(r,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},SJ=function(t){const{color:r}=this._initialData;return this.hasEditedComment||t.color.some((i,s)=>i!==r[s])},j(Un,yl),Qe(Un,"_defaultColor",null),Qe(Un,"_defaultOpacity",1),Qe(Un,"_defaultThickness",12),Qe(Un,"_type","highlight"),Qe(Un,"_editorType",Jt.HIGHLIGHT),Qe(Un,"_freeHighlightId",-1),Qe(Un,"_freeHighlight",null),Qe(Un,"_freeHighlightClipId","");let mD=Un;var Wg;class AJ{constructor(){j(this,Wg,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,r]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,r)}updateSVGProperty(e,t){g(this,Wg)[e]=t}toSVGProperties(){const e=g(this,Wg);return U(this,Wg,Object.create(null)),{root:e}}reset(){U(this,Wg,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){fr("Not implemented")}}Wg=new WeakMap;var So,Hx,Qi,Xg,Kg,Fn,eL,tL,nL,l1,TJ,KM,u1,k0;const gn=class gn extends br{constructor(t){super(t);j(this,Fn);j(this,So,null);j(this,Hx);Qe(this,"_colorPicker",null);Qe(this,"_drawId",null);U(this,Hx,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(X(this,Fn,eL).call(this,t),X(this,Fn,l1).call(this))}static _mergeSVGProperties(t,r){const i=new Set(Object.keys(t));for(const[s,a]of Object.entries(r))i.has(s)?Object.assign(t[s],a):t[s]=a;return t}static getDefaultDrawingOptions(t){fr("Not implemented")}static get typesMap(){fr("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,r){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,r),this._currentParent&&(g(gn,Qi).updateProperty(i,r),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,r){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,r)}static get defaultPropertiesToUpdate(){const t=[],r=this._defaultDrawingOptions;for(const[i,s]of this.typesMap)t.push([i,r[s]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:r}=this;for(const[i,s]of this.constructor.typesMap)t.push([i,r[s]]);return t}_updateProperty(t,r,i){const s=this._drawingOptions,a=s[r],o=l=>{var c;s.updateProperty(r,l);const u=g(this,So).updateProperty(r,l);u&&X(this,Fn,u1).call(this,u),(c=this.parent)==null||c.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,gn._mergeSVGProperties(g(this,So).getPathResizingSVGProperties(X(this,Fn,KM).call(this)),{bbox:X(this,Fn,k0).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,gn._mergeSVGProperties(g(this,So).getPathResizedSVGProperties(X(this,Fn,KM).call(this)),{bbox:X(this,Fn,k0).call(this)}))}_onTranslating(t,r){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:X(this,Fn,k0).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,gn._mergeSVGProperties(g(this,So).getPathTranslatedSVGProperties(X(this,Fn,KM).call(this),this.parentDimensions),{bbox:X(this,Fn,k0).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,g(this,Hx)&&(U(this,Hx,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){X(this,Fn,nL).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(X(this,Fn,l1).call(this),X(this,Fn,u1).call(this,g(this,So).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let r=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),X(this,Fn,nL).call(this)):t&&(this._uiManager.addShouldRescale(this),X(this,Fn,l1).call(this,t),r=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),r&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,gn._mergeSVGProperties({bbox:X(this,Fn,k0).call(this)},g(this,So).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&X(this,Fn,u1).call(this,g(this,So).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,r;this._isCopy&&(t=this.x,r=this.y);const i=super.render();i.classList.add("draw");const s=document.createElement("div");return i.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,r),i}static createDrawerInstance(t,r,i,s,a){fr("Not implemented")}static startDrawing(t,r,i,s){var y;const{target:a,offsetX:o,offsetY:l,pointerId:u,pointerType:c}=s;if(zs.isInitializedAndDifferentPointerType(c))return;const{viewport:{rotation:h}}=t,{width:d,height:f}=a.getBoundingClientRect(),p=U(gn,Xg,new AbortController),m=t.combinedSignal(p);if(zs.setPointer(c,u),window.addEventListener("pointerup",v=>{zs.isSamePointerIdOrRemove(v.pointerId)&&this._endDraw(v)},{signal:m}),window.addEventListener("pointercancel",v=>{zs.isSamePointerIdOrRemove(v.pointerId)&&this._currentParent.endDrawingSession()},{signal:m}),window.addEventListener("pointerdown",v=>{zs.isSamePointerType(v.pointerType)&&(zs.initializeAndAddPointerId(v.pointerId),g(gn,Qi).isCancellable()&&(g(gn,Qi).removeLastElement(),g(gn,Qi).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",Cl,{signal:m}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:m}),a.addEventListener("touchmove",v=>{zs.isSameTimeStamp(v.timeStamp)&&Qr(v)},{signal:m}),t.toggleDrawing(),(y=r._editorUndoBar)==null||y.hide(),g(gn,Qi)){t.drawLayer.updateProperties(this._currentDrawId,g(gn,Qi).startNew(o,l,d,f,h));return}r.updateUIForDefaultProperties(this),U(gn,Qi,this.createDrawerInstance(o,l,d,f,h)),U(gn,Kg,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(g(gn,Kg).toSVGProperties(),g(gn,Qi).defaultSVGProperties),!0,!1)}static _drawMove(t){if(zs.isSameTimeStamp(t.timeStamp),!g(gn,Qi))return;const{offsetX:r,offsetY:i,pointerId:s}=t;if(zs.isSamePointerId(s)){if(zs.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,g(gn,Qi).add(r,i)),zs.setTimeStamp(t.timeStamp),Qr(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,U(gn,Qi,null),U(gn,Kg,null),zs.clearPointerType(),zs.clearTimeStamp()),g(gn,Xg)&&(g(gn,Xg).abort(),U(gn,Xg,null),zs.clearPointerIds())}static _endDraw(t){const r=this._currentParent;if(r){if(r.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===r.div&&r.drawLayer.updateProperties(this._currentDrawId,g(gn,Qi).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=g(gn,Qi),s=this._currentDrawId,a=i.getLastElement();r.addCommands({cmd:()=>{r.drawLayer.updateProperties(s,i.setLastElement(a))},undo:()=>{r.drawLayer.updateProperties(s,i.removeLastElement())},mustExec:!1,type:En.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const r=this._currentParent;if(!r)return null;if(r.toggleDrawing(!0),r.cleanUndoStack(En.DRAW_STEP),!g(gn,Qi).isEmpty()){const{pageDimensions:[i,s],scale:a}=r,o=r.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:g(gn,Qi).getOutlines(i*a,s*a,a,this._INNER_MARGIN),drawingOptions:g(gn,Kg),mustBeCommitted:!t});return this._cleanup(!0),o}return r.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,r,i,s,a,o){fr("Not implemented")}static async deserialize(t,r,i){var h,d;const{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}=r.viewport,u=this.deserializeDraw(o,l,s,a,this._INNER_MARGIN,t),c=await super.deserialize(t,r,i);return c.createDrawingOptions(t),X(h=c,Fn,eL).call(h,{drawOutlines:u}),X(d=c,Fn,l1).call(d),c.onScaleChanging(),c.rotate(),c}serializeDraw(t){const[r,i]=this.pageTranslation,[s,a]=this.pageDimensions;return g(this,So).serialize([r,i,s,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};So=new WeakMap,Hx=new WeakMap,Qi=new WeakMap,Xg=new WeakMap,Kg=new WeakMap,Fn=new WeakSet,eL=function({drawOutlines:t,drawId:r,drawingOptions:i}){U(this,So,t),this._drawingOptions||(this._drawingOptions=i),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),r>=0?(this._drawId=r,this.parent.drawLayer.finalizeDraw(r,t.defaultProperties)):this._drawId=X(this,Fn,tL).call(this,t,this.parent),X(this,Fn,u1).call(this,t.box)},tL=function(t,r){const{id:i}=r.drawLayer.draw(gn._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},nL=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},l1=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=X(this,Fn,tL).call(this,g(this,So),t)}},TJ=function([t,r,i,s]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[r,1-t,i*(o/a),s*(a/o)];case 180:return[1-t,1-r,i,s];case 270:return[1-r,t,i*(o/a),s*(a/o)];default:return[t,r,i,s]}},KM=function(){const{x:t,y:r,width:i,height:s,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-r,t,i*(a/o),s*(o/a)];case 180:return[1-t,1-r,i,s];case 270:return[r,1-t,i*(a/o),s*(o/a)];default:return[t,r,i,s]}},u1=function(t){[this.x,this.y,this.width,this.height]=X(this,Fn,TJ).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},k0=function(){const{x:t,y:r,width:i,height:s,rotation:a,parentRotation:o,parentDimensions:[l,u]}=this;switch((a*4+o)/90){case 1:return[1-r-s,t,s,i];case 2:return[1-t-i,1-r-s,i,s];case 3:return[r,1-t-i,s,i];case 4:return[t,r-i*(l/u),s*(u/l),i*(l/u)];case 5:return[1-r,t,i*(l/u),s*(u/l)];case 6:return[1-t-s*(u/l),1-r,s*(u/l),i*(l/u)];case 7:return[r-i*(l/u),1-t-s*(u/l),i*(l/u),s*(u/l)];case 8:return[t-i,r-s,i,s];case 9:return[1-r,t-i,s,i];case 10:return[1-t,1-r,i,s];case 11:return[r-s,1-t,s,i];case 12:return[t-s*(u/l),r,s*(u/l),i*(l/u)];case 13:return[1-r-i*(l/u),t-s*(u/l),i*(l/u),s*(u/l)];case 14:return[1-t,1-r-i*(l/u),s*(u/l),i*(l/u)];case 15:return[r,1-t,i*(l/u),s*(u/l)];default:return[t,r,i,s]}},Qe(gn,"_currentDrawId",-1),Qe(gn,"_currentParent",null),j(gn,Qi,null),j(gn,Xg,null),j(gn,Kg,null),Qe(gn,"_INNER_MARGIN",3);let gD=gn;var Zu,Zi,Ji,Yg,Gx,fa,ms,hl,Qg,Zg,Jg,jx,YM;class Iye{constructor(e,t,r,i,s,a){j(this,jx);j(this,Zu,new Float64Array(6));j(this,Zi);j(this,Ji);j(this,Yg);j(this,Gx);j(this,fa);j(this,ms,"");j(this,hl,0);j(this,Qg,new KS);j(this,Zg);j(this,Jg);U(this,Zg,r),U(this,Jg,i),U(this,Yg,s),U(this,Gx,a),[e,t]=X(this,jx,YM).call(this,e,t);const o=U(this,Zi,[NaN,NaN,NaN,NaN,e,t]);U(this,fa,[e,t]),U(this,Ji,[{line:o,points:g(this,fa)}]),g(this,Zu).set(o,0)}updateProperty(e,t){e==="stroke-width"&&U(this,Gx,t)}isEmpty(){return!g(this,Ji)||g(this,Ji).length===0}isCancellable(){return g(this,fa).length<=10}add(e,t){[e,t]=X(this,jx,YM).call(this,e,t);const[r,i,s,a]=g(this,Zu).subarray(2,6),o=e-s,l=t-a;return Math.hypot(g(this,Zg)*o,g(this,Jg)*l)<=2?null:(g(this,fa).push(e,t),isNaN(r)?(g(this,Zu).set([s,a,e,t],2),g(this,Zi).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(g(this,Zu)[0])&&g(this,Zi).splice(6,6),g(this,Zu).set([r,i,s,a,e,t],0),g(this,Zi).push(...pt.createBezierPoints(r,i,s,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const r=this.add(e,t);return r||(g(this,fa).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,r,i,s){U(this,Zg,r),U(this,Jg,i),U(this,Yg,s),[e,t]=X(this,jx,YM).call(this,e,t);const a=U(this,Zi,[NaN,NaN,NaN,NaN,e,t]);U(this,fa,[e,t]);const o=g(this,Ji).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),g(this,Ji).push({line:a,points:g(this,fa)}),g(this,Zu).set(a,0),U(this,hl,0),this.toSVGPath(),null}getLastElement(){return g(this,Ji).at(-1)}setLastElement(e){return g(this,Ji)?(g(this,Ji).push(e),U(this,Zi,e.line),U(this,fa,e.points),U(this,hl,0),{path:{d:this.toSVGPath()}}):g(this,Qg).setLastElement(e)}removeLastElement(){if(!g(this,Ji))return g(this,Qg).removeLastElement();g(this,Ji).pop(),U(this,ms,"");for(let e=0,t=g(this,Ji).length;e<t;e++){const{line:r,points:i}=g(this,Ji)[e];U(this,Zi,r),U(this,fa,i),U(this,hl,0),this.toSVGPath()}return{path:{d:g(this,ms)}}}toSVGPath(){const e=pt.svgRound(g(this,Zi)[4]),t=pt.svgRound(g(this,Zi)[5]);if(g(this,fa).length===2)return U(this,ms,`${g(this,ms)} M ${e} ${t} Z`),g(this,ms);if(g(this,fa).length<=6){const i=g(this,ms).lastIndexOf("M");U(this,ms,`${g(this,ms).slice(0,i)} M ${e} ${t}`),U(this,hl,6)}if(g(this,fa).length===4){const i=pt.svgRound(g(this,Zi)[10]),s=pt.svgRound(g(this,Zi)[11]);return U(this,ms,`${g(this,ms)} L ${i} ${s}`),U(this,hl,12),g(this,ms)}const r=[];g(this,hl)===0&&(r.push(`M ${e} ${t}`),U(this,hl,6));for(let i=g(this,hl),s=g(this,Zi).length;i<s;i+=6){const[a,o,l,u,c,h]=g(this,Zi).slice(i,i+6).map(pt.svgRound);r.push(`C${a} ${o} ${l} ${u} ${c} ${h}`)}return U(this,ms,g(this,ms)+r.join(" ")),U(this,hl,g(this,Zi).length),g(this,ms)}getOutlines(e,t,r,i){const s=g(this,Ji).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),g(this,Qg).build(g(this,Ji),e,t,r,g(this,Yg),g(this,Gx),i),U(this,Zu,null),U(this,Zi,null),U(this,Ji,null),U(this,ms,null),g(this,Qg)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Zu=new WeakMap,Zi=new WeakMap,Ji=new WeakMap,Yg=new WeakMap,Gx=new WeakMap,fa=new WeakMap,ms=new WeakMap,hl=new WeakMap,Qg=new WeakMap,Zg=new WeakMap,Jg=new WeakMap,jx=new WeakSet,YM=function(e,t){return pt._normalizePoint(e,t,g(this,Zg),g(this,Jg),g(this,Yg))};var pa,_S,wS,Ao,Ju,ec,qx,Wx,ev,bs,Yc,MJ,CJ,DJ;class KS extends pt{constructor(){super(...arguments);j(this,bs);j(this,pa);j(this,_S,0);j(this,wS);j(this,Ao);j(this,Ju);j(this,ec);j(this,qx);j(this,Wx);j(this,ev)}build(t,r,i,s,a,o,l){U(this,Ju,r),U(this,ec,i),U(this,qx,s),U(this,Wx,a),U(this,ev,o),U(this,wS,l??0),U(this,Ao,t),X(this,bs,CJ).call(this)}get thickness(){return g(this,ev)}setLastElement(t){return g(this,Ao).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return g(this,Ao).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:r}of g(this,Ao)){if(t.push(`M${pt.svgRound(r[4])} ${pt.svgRound(r[5])}`),r.length===6){t.push("Z");continue}if(r.length===12&&isNaN(r[6])){t.push(`L${pt.svgRound(r[10])} ${pt.svgRound(r[11])}`);continue}for(let i=6,s=r.length;i<s;i+=6){const[a,o,l,u,c,h]=r.subarray(i,i+6).map(pt.svgRound);t.push(`C${a} ${o} ${l} ${u} ${c} ${h}`)}}return t.join("")}serialize([t,r,i,s],a){const o=[],l=[],[u,c,h,d]=X(this,bs,MJ).call(this);let f,p,m,y,v,b,x,w,_;switch(g(this,Wx)){case 0:_=pt._rescale,f=t,p=r+s,m=i,y=-s,v=t+u*i,b=r+(1-c-d)*s,x=t+(u+h)*i,w=r+(1-c)*s;break;case 90:_=pt._rescaleAndSwap,f=t,p=r,m=i,y=s,v=t+c*i,b=r+u*s,x=t+(c+d)*i,w=r+(u+h)*s;break;case 180:_=pt._rescale,f=t+i,p=r,m=-i,y=s,v=t+(1-u-h)*i,b=r+c*s,x=t+(1-u)*i,w=r+(c+d)*s;break;case 270:_=pt._rescaleAndSwap,f=t+i,p=r+s,m=-i,y=-s,v=t+(1-c-d)*i,b=r+(1-u-h)*s,x=t+(1-c)*i,w=r+(1-u)*s;break}for(const{line:E,points:A}of g(this,Ao))o.push(_(E,f,p,m,y,a?new Array(E.length):null)),l.push(_(A,f,p,m,y,a?new Array(A.length):null));return{lines:o,points:l,rect:[v,b,x,w]}}static deserialize(t,r,i,s,a,{paths:{lines:o,points:l},rotation:u,thickness:c}){const h=[];let d,f,p,m,y;switch(u){case 0:y=pt._rescale,d=-t/i,f=r/s+1,p=1/i,m=-1/s;break;case 90:y=pt._rescaleAndSwap,d=-r/s,f=-t/i,p=1/s,m=1/i;break;case 180:y=pt._rescale,d=t/i+1,f=-r/s,p=-1/i,m=1/s;break;case 270:y=pt._rescaleAndSwap,d=r/s+1,f=t/i+1,p=-1/s,m=-1/i;break}if(!o){o=[];for(const b of l){const x=b.length;if(x===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1]]));continue}if(x===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1],NaN,NaN,NaN,NaN,b[2],b[3]]));continue}const w=new Float32Array(3*(x-2));o.push(w);let[_,E,A,T]=b.subarray(0,4);w.set([NaN,NaN,NaN,NaN,_,E],0);for(let S=4;S<x;S+=2){const M=b[S],D=b[S+1];w.set(pt.createBezierPoints(_,E,A,T,M,D),(S-2)*3),[_,E,A,T]=[A,T,M,D]}}}for(let b=0,x=o.length;b<x;b++)h.push({line:y(o[b].map(w=>w??NaN),d,f,p,m),points:y(l[b].map(w=>w??NaN),d,f,p,m)});const v=new this.prototype.constructor;return v.build(h,i,s,1,u,c,a),v}get box(){return g(this,pa)}updateProperty(t,r){return t==="stroke-width"?X(this,bs,DJ).call(this,r):null}updateParentDimensions([t,r],i){const[s,a]=X(this,bs,Yc).call(this);U(this,Ju,t),U(this,ec,r),U(this,qx,i);const[o,l]=X(this,bs,Yc).call(this),u=o-s,c=l-a,h=g(this,pa);return h[0]-=u,h[1]-=c,h[2]+=2*u,h[3]+=2*c,h}updateRotation(t){return U(this,_S,t),{path:{transform:this.rotationTransform}}}get viewBox(){return g(this,pa).map(pt.svgRound).join(" ")}get defaultProperties(){const[t,r]=g(this,pa);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${pt.svgRound(t)} ${pt.svgRound(r)}`}}}get rotationTransform(){const[,,t,r]=g(this,pa);let i=0,s=0,a=0,o=0,l=0,u=0;switch(g(this,_S)){case 90:s=r/t,a=-t/r,l=t;break;case 180:i=-1,o=-1,l=t,u=r;break;case 270:s=-r/t,a=t/r,u=r;break;default:return""}return`matrix(${i} ${s} ${a} ${o} ${pt.svgRound(l)} ${pt.svgRound(u)})`}getPathResizingSVGProperties([t,r,i,s]){const[a,o]=X(this,bs,Yc).call(this),[l,u,c,h]=g(this,pa);if(Math.abs(c-a)<=pt.PRECISION||Math.abs(h-o)<=pt.PRECISION){const y=t+i/2-(l+c/2),v=r+s/2-(u+h/2);return{path:{"transform-origin":`${pt.svgRound(t)} ${pt.svgRound(r)}`,transform:`${this.rotationTransform} translate(${y} ${v})`}}}const d=(i-2*a)/(c-2*a),f=(s-2*o)/(h-2*o),p=c/i,m=h/s;return{path:{"transform-origin":`${pt.svgRound(l)} ${pt.svgRound(u)}`,transform:`${this.rotationTransform} scale(${p} ${m}) translate(${pt.svgRound(a)} ${pt.svgRound(o)}) scale(${d} ${f}) translate(${pt.svgRound(-a)} ${pt.svgRound(-o)})`}}}getPathResizedSVGProperties([t,r,i,s]){const[a,o]=X(this,bs,Yc).call(this),l=g(this,pa),[u,c,h,d]=l;if(l[0]=t,l[1]=r,l[2]=i,l[3]=s,Math.abs(h-a)<=pt.PRECISION||Math.abs(d-o)<=pt.PRECISION){const v=t+i/2-(u+h/2),b=r+s/2-(c+d/2);for(const{line:x,points:w}of g(this,Ao))pt._translate(x,v,b,x),pt._translate(w,v,b,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${pt.svgRound(t)} ${pt.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const f=(i-2*a)/(h-2*a),p=(s-2*o)/(d-2*o),m=-f*(u+a)+t+a,y=-p*(c+o)+r+o;if(f!==1||p!==1||m!==0||y!==0)for(const{line:v,points:b}of g(this,Ao))pt._rescale(v,m,y,f,p,v),pt._rescale(b,m,y,f,p,b);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${pt.svgRound(t)} ${pt.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,r],i){const[s,a]=i,o=g(this,pa),l=t-o[0],u=r-o[1];if(g(this,Ju)===s&&g(this,ec)===a)for(const{line:c,points:h}of g(this,Ao))pt._translate(c,l,u,c),pt._translate(h,l,u,h);else{const c=g(this,Ju)/s,h=g(this,ec)/a;U(this,Ju,s),U(this,ec,a);for(const{line:d,points:f}of g(this,Ao))pt._rescale(d,l,u,c,h,d),pt._rescale(f,l,u,c,h,f);o[2]*=c,o[3]*=h}return o[0]=t,o[1]=r,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${pt.svgRound(t)} ${pt.svgRound(r)}`}}}get defaultSVGProperties(){const t=g(this,pa);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${pt.svgRound(t[0])} ${pt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}pa=new WeakMap,_S=new WeakMap,wS=new WeakMap,Ao=new WeakMap,Ju=new WeakMap,ec=new WeakMap,qx=new WeakMap,Wx=new WeakMap,ev=new WeakMap,bs=new WeakSet,Yc=function(t=g(this,ev)){const r=g(this,wS)+t/2*g(this,qx);return g(this,Wx)%180===0?[r/g(this,Ju),r/g(this,ec)]:[r/g(this,ec),r/g(this,Ju)]},MJ=function(){const[t,r,i,s]=g(this,pa),[a,o]=X(this,bs,Yc).call(this,0);return[t+a,r+o,i-2*a,s-2*o]},CJ=function(){const t=U(this,pa,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:s}of g(this,Ao)){if(s.length<=12){for(let l=4,u=s.length;l<u;l+=6)yt.pointBoundingBox(s[l],s[l+1],t);continue}let a=s[4],o=s[5];for(let l=6,u=s.length;l<u;l+=6){const[c,h,d,f,p,m]=s.subarray(l,l+6);yt.bezierBoundingBox(a,o,c,h,d,f,p,m,t),a=p,o=m}}const[r,i]=X(this,bs,Yc).call(this);t[0]=va(t[0]-r,0,1),t[1]=va(t[1]-i,0,1),t[2]=va(t[2]+r,0,1),t[3]=va(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]},DJ=function(t){const[r,i]=X(this,bs,Yc).call(this);U(this,ev,t);const[s,a]=X(this,bs,Yc).call(this),[o,l]=[s-r,a-i],u=g(this,pa);return u[0]-=o,u[1]-=l,u[2]+=2*o,u[3]+=2*l,u};class _N extends AJ{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:br._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new _N(this._viewParameters);return e.updateAll(this),e}}var w2,NJ;const hy=class hy extends gD{constructor(t){super({...t,name:"inkEditor"});j(this,w2);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,r){br.initialize(t,r),this._defaultDrawingOptions=new _N(r.viewParameters)}static getDefaultDrawingOptions(t){const r=this._defaultDrawingOptions.clone();return r.updateProperties(t),r}static get supportMultipleDrawings(){return!0}static get typesMap(){return Kt(this,"typesMap",new Map([[En.INK_THICKNESS,"stroke-width"],[En.INK_COLOR,"stroke"],[En.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,r,i,s,a){return new Iye(t,r,i,s,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,r,i,s,a,o){return KS.deserialize(t,r,i,s,a,o)}static async deserialize(t,r,i){let s=null;if(t instanceof v4){const{data:{inkLists:o,rect:l,rotation:u,id:c,color:h,opacity:d,borderStyle:{rawWidth:f},popupRef:p,richText:m,contentsObj:y,creationDate:v,modificationDate:b},parent:{page:{pageNumber:x}}}=t;s=t={annotationType:Jt.INK,color:Array.from(h),thickness:f,opacity:d,paths:{points:o},boxes:null,pageIndex:x-1,rect:l.slice(0),rotation:u,annotationElementId:c,id:c,deleted:!1,popupRef:p,richText:m,comment:(y==null?void 0:y.str)||null,creationDate:v,modificationDate:b}}const a=await super.deserialize(t,r,i);return a._initialData=s,t.comment&&a.setCommentData(t),a}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new dD(this)),[["colorPicker",this._colorPicker]]}get colorType(){return En.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:r,parent:i}=this;r.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,r.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:r,opacity:i}){this._drawingOptions=hy.getDefaultDrawingOptions({stroke:yt.makeHexColor(...t),"stroke-width":r,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:r,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:s,"stroke-opacity":a,"stroke-width":o}}=this,l=Object.assign(super.serialize(t),{color:br._colorManager.convert(s),opacity:a,thickness:o,paths:{lines:r,points:i}});return this.addComment(l),t?(l.isCopy=!0,l):this.annotationElementId&&!X(this,w2,NJ).call(this,l)?null:(l.id=this.annotationElementId,l)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:r,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:r,popup:this.comment}),null}};w2=new WeakSet,NJ=function(t){const{color:r,thickness:i,opacity:s,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==r[l])||t.thickness!==i||t.opacity!==s||t.pageIndex!==a},Qe(hy,"_type","ink"),Qe(hy,"_editorType",Jt.INK),Qe(hy,"_defaultDrawingOptions",null);let rL=hy;class iL extends KS{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const sT=8,__=3;var tv,Hn,sL,Jl,RJ,IJ,aL,QM,PJ,FJ,LJ,oL,lL,OJ;class Oh{static extractContoursFromText(e,{fontFamily:t,fontStyle:r,fontWeight:i},s,a,o,l){let u=new OffscreenCanvas(1,1),c=u.getContext("2d",{alpha:!1});const h=200,d=c.font=`${r} ${i} ${h}px ${t}`,{actualBoundingBoxLeft:f,actualBoundingBoxRight:p,actualBoundingBoxAscent:m,actualBoundingBoxDescent:y,fontBoundingBoxAscent:v,fontBoundingBoxDescent:b,width:x}=c.measureText(e),w=1.5,_=Math.ceil(Math.max(Math.abs(f)+Math.abs(p)||0,x)*w),E=Math.ceil(Math.max(Math.abs(m)+Math.abs(y)||h,Math.abs(v)+Math.abs(b)||h)*w);u=new OffscreenCanvas(_,E),c=u.getContext("2d",{alpha:!0,willReadFrequently:!0}),c.font=d,c.filter="grayscale(1)",c.fillStyle="white",c.fillRect(0,0,_,E),c.fillStyle="black",c.fillText(e,_*(w-1)/2,E*(3-w)/2);const A=X(this,Hn,oL).call(this,c.getImageData(0,0,_,E).data),T=X(this,Hn,LJ).call(this,A),S=X(this,Hn,lL).call(this,T),M=X(this,Hn,aL).call(this,A,_,E,S);return this.processDrawnLines({lines:{curves:M,width:_,height:E},pageWidth:s,pageHeight:a,rotation:o,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(e,t,r,i,s){const[a,o,l]=X(this,Hn,OJ).call(this,e),[u,c]=X(this,Hn,FJ).call(this,a,o,l,Math.hypot(o,l)*g(this,tv).sigmaSFactor,g(this,tv).sigmaR,g(this,tv).kernelSize),h=X(this,Hn,lL).call(this,c),d=X(this,Hn,aL).call(this,u,o,l,h);return this.processDrawnLines({lines:{curves:d,width:o,height:l},pageWidth:t,pageHeight:r,rotation:i,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:r,rotation:i,innerMargin:s,mustSmooth:a,areContours:o}){i%180!==0&&([t,r]=[r,t]);const{curves:l,width:u,height:c}=e,h=e.thickness??0,d=[],f=Math.min(t/u,r/c),p=f/t,m=f/r,y=[];for(const{points:b}of l){const x=a?X(this,Hn,PJ).call(this,b):b;if(!x)continue;y.push(x);const w=x.length,_=new Float32Array(w),E=new Float32Array(3*(w===2?2:w-2));if(d.push({line:E,points:_}),w===2){_[0]=x[0]*p,_[1]=x[1]*m,E.set([NaN,NaN,NaN,NaN,_[0],_[1]],0);continue}let[A,T,S,M]=x;A*=p,T*=m,S*=p,M*=m,_.set([A,T,S,M],0),E.set([NaN,NaN,NaN,NaN,A,T],0);for(let D=4;D<w;D+=2){const N=_[D]=x[D]*p,R=_[D+1]=x[D+1]*m;E.set(pt.createBezierPoints(A,T,S,M,N,R),(D-2)*3),[A,T,S,M]=[S,M,N,R]}}if(d.length===0)return null;const v=o?new iL:new KS;return v.build(d,t,r,1,i,o?0:h,s),{outline:v,newCurves:y,areContours:o,thickness:h,width:u,height:c}}static async compressSignature({outlines:e,areContours:t,thickness:r,width:i,height:s}){let a=1/0,o=-1/0,l=0;for(const x of e){l+=x.length;for(let w=2,_=x.length;w<_;w++){const E=x[w]-x[w-2];a=Math.min(a,E),o=Math.max(o,E)}}let u;a>=-128&&o<=127?u=Int8Array:a>=-32768&&o<=32767?u=Int16Array:u=Int32Array;const c=e.length,h=sT+__*c,d=new Uint32Array(h);let f=0;d[f++]=h*Uint32Array.BYTES_PER_ELEMENT+(l-2*c)*u.BYTES_PER_ELEMENT,d[f++]=0,d[f++]=i,d[f++]=s,d[f++]=t?0:1,d[f++]=Math.max(0,Math.floor(r??0)),d[f++]=c,d[f++]=u.BYTES_PER_ELEMENT;for(const x of e)d[f++]=x.length-2,d[f++]=x[0],d[f++]=x[1];const p=new CompressionStream("deflate-raw"),m=p.writable.getWriter();await m.ready,m.write(d);const y=u.prototype.constructor;for(const x of e){const w=new y(x.length-2);for(let _=2,E=x.length;_<E;_++)w[_-2]=x[_]-x[_-2];m.write(w)}m.close();const v=await new Response(p.readable).arrayBuffer(),b=new Uint8Array(v);return FQ(b)}static async decompressSignature(e){try{const t=Xve(e),{readable:r,writable:i}=new DecompressionStream("deflate-raw"),s=i.getWriter();await s.ready,s.write(t).then(async()=>{await s.ready,await s.close()}).catch(()=>{});let a=null,o=0;for await(const x of r)a||(a=new Uint8Array(new Uint32Array(x.buffer,0,4)[0])),a.set(x,o),o+=x.length;const l=new Uint32Array(a.buffer,0,a.length>>2),u=l[1];if(u!==0)throw new Error(`Invalid version: ${u}`);const c=l[2],h=l[3],d=l[4]===0,f=l[5],p=l[6],m=l[7],y=[],v=(sT+__*p)*Uint32Array.BYTES_PER_ELEMENT;let b;switch(m){case Int8Array.BYTES_PER_ELEMENT:b=new Int8Array(a.buffer,v);break;case Int16Array.BYTES_PER_ELEMENT:b=new Int16Array(a.buffer,v);break;case Int32Array.BYTES_PER_ELEMENT:b=new Int32Array(a.buffer,v);break}o=0;for(let x=0;x<p;x++){const w=l[__*x+sT],_=new Float32Array(w+2);y.push(_);for(let E=0;E<__-1;E++)_[E]=l[__*x+sT+E+1];for(let E=0;E<w;E++)_[E+2]=_[E]+b[o++]}return{areContours:d,thickness:f,outlines:y,width:c,height:h}}catch(t){return Xt(`decompressSignature: ${t}`),null}}}tv=new WeakMap,Hn=new WeakSet,sL=function(e,t,r,i){return r-=e,i-=t,r===0?i>0?0:4:r===1?i+6:2-i},Jl=new WeakMap,RJ=function(e,t,r,i,s,a,o){const l=X(this,Hn,sL).call(this,r,i,s,a);for(let u=0;u<8;u++){const c=(-u+l-o+16)%8,h=g(this,Jl)[2*c],d=g(this,Jl)[2*c+1];if(e[(r+h)*t+(i+d)]!==0)return c}return-1},IJ=function(e,t,r,i,s,a,o){const l=X(this,Hn,sL).call(this,r,i,s,a);for(let u=0;u<8;u++){const c=(u+l+o+16)%8,h=g(this,Jl)[2*c],d=g(this,Jl)[2*c+1];if(e[(r+h)*t+(i+d)]!==0)return c}return-1},aL=function(e,t,r,i){const s=e.length,a=new Int32Array(s);for(let c=0;c<s;c++)a[c]=e[c]<=i?1:0;for(let c=1;c<r-1;c++)a[c*t]=a[c*t+t-1]=0;for(let c=0;c<t;c++)a[c]=a[t*r-1-c]=0;let o=1,l;const u=[];for(let c=1;c<r-1;c++){l=1;for(let h=1;h<t-1;h++){const d=c*t+h,f=a[d];if(f===0)continue;let p=c,m=h;if(f===1&&a[d-1]===0)o+=1,m-=1;else if(f>=1&&a[d+1]===0)o+=1,m+=1,f>1&&(l=f);else{f!==1&&(l=Math.abs(f));continue}const y=[h,c],v=m===h+1,b={isHole:v,points:y,id:o,parent:0};u.push(b);let x;for(const D of u)if(D.id===l){x=D;break}x?x.isHole?b.parent=v?x.parent:l:b.parent=v?l:x.parent:b.parent=v?l:0;const w=X(this,Hn,RJ).call(this,a,t,c,h,p,m,0);if(w===-1){a[d]=-o,a[d]!==1&&(l=Math.abs(a[d]));continue}let _=g(this,Jl)[2*w],E=g(this,Jl)[2*w+1];const A=c+_,T=h+E;p=A,m=T;let S=c,M=h;for(;;){const D=X(this,Hn,IJ).call(this,a,t,S,M,p,m,1);_=g(this,Jl)[2*D],E=g(this,Jl)[2*D+1];const N=S+_,R=M+E;y.push(R,N);const O=S*t+M;if(a[O+1]===0?a[O]=-o:a[O]===1&&(a[O]=o),N===c&&R===h&&S===A&&M===T){a[d]!==1&&(l=Math.abs(a[d]));break}else p=S,m=M,S=N,M=R}}}return u},QM=function(e,t,r,i){if(r-t<=4){for(let A=t;A<r-2;A+=2)i.push(e[A],e[A+1]);return}const s=e[t],a=e[t+1],o=e[r-4]-s,l=e[r-3]-a,u=Math.hypot(o,l),c=o/u,h=l/u,d=c*a-h*s,f=l/o,p=1/u,m=Math.atan(f),y=Math.cos(m),v=Math.sin(m),b=p*(Math.abs(y)+Math.abs(v)),x=p*(1-b+b**2),w=Math.max(Math.atan(Math.abs(v+y)*x),Math.atan(Math.abs(v-y)*x));let _=0,E=t;for(let A=t+2;A<r-2;A+=2){const T=Math.abs(d-c*e[A+1]+h*e[A]);T>_&&(E=A,_=T)}_>(u*w)**2?(X(this,Hn,QM).call(this,e,t,E+2,i),X(this,Hn,QM).call(this,e,E,r,i)):i.push(s,a)},PJ=function(e){const t=[],r=e.length;return X(this,Hn,QM).call(this,e,0,r,t),t.push(e[r-2],e[r-1]),t.length<=4?null:t},FJ=function(e,t,r,i,s,a){const o=new Float32Array(a**2),l=-2*i**2,u=a>>1;for(let m=0;m<a;m++){const y=(m-u)**2;for(let v=0;v<a;v++)o[m*a+v]=Math.exp((y+(v-u)**2)/l)}const c=new Float32Array(256),h=-2*s**2;for(let m=0;m<256;m++)c[m]=Math.exp(m**2/h);const d=e.length,f=new Uint8Array(d),p=new Uint32Array(256);for(let m=0;m<r;m++)for(let y=0;y<t;y++){const v=m*t+y,b=e[v];let x=0,w=0;for(let E=0;E<a;E++){const A=m+E-u;if(!(A<0||A>=r))for(let T=0;T<a;T++){const S=y+T-u;if(S<0||S>=t)continue;const M=e[A*t+S],D=o[E*a+T]*c[Math.abs(M-b)];x+=M*D,w+=D}}const _=f[v]=Math.round(x/w);p[_]++}return[f,p]},LJ=function(e){const t=new Uint32Array(256);for(const r of e)t[r]++;return t},oL=function(e){const t=e.length,r=new Uint8ClampedArray(t>>2);let i=-1/0,s=1/0;for(let o=0,l=r.length;o<l;o++){const u=r[o]=e[o<<2];i=Math.max(i,u),s=Math.min(s,u)}const a=255/(i-s);for(let o=0,l=r.length;o<l;o++)r[o]=(r[o]-s)*a;return r},lL=function(e){let t,r=-1/0,i=-1/0;const s=e.findIndex(l=>l!==0);let a=s,o=s;for(t=s;t<256;t++){const l=e[t];l>r&&(t-a>i&&(i=t-a,o=t-1),r=l,a=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t},OJ=function(e){const t=e,{width:r,height:i}=e,{maxDim:s}=g(this,tv);let a=r,o=i;if(r>s||i>s){let d=r,f=i,p=Math.log2(Math.max(r,i)/s);const m=Math.floor(p);p=p===m?m-1:m;for(let v=0;v<p;v++){a=Math.ceil(d/2),o=Math.ceil(f/2);const b=new OffscreenCanvas(a,o);b.getContext("2d").drawImage(e,0,0,d,f,0,0,a,o),d=a,f=o,e!==t&&e.close(),e=b.transferToImageBitmap()}const y=Math.min(s/a,s/o);a=Math.round(a*y),o=Math.round(o*y)}const u=new OffscreenCanvas(a,o).getContext("2d",{willReadFrequently:!0});u.fillStyle="white",u.fillRect(0,0,a,o),u.filter="grayscale(1)",u.drawImage(e,0,0,e.width,e.height,0,0,a,o);const c=u.getImageData(0,0,a,o).data;return[X(this,Hn,oL).call(this,c),a,o]},j(Oh,Hn),j(Oh,tv,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),j(Oh,Jl,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class y4 extends AJ{constructor(){super(),super.updateProperties({fill:br._defaultLineColor,"stroke-width":0})}clone(){const e=new y4;return e.updateAll(this),e}}class x4 extends _N{constructor(e){super(e),super.updateProperties({stroke:br._defaultLineColor,"stroke-width":1})}clone(){const e=new x4(this._viewParameters);return e.updateAll(this),e}}var zf,tc,$f,nv;const oo=class oo extends gD{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});j(this,zf,!1);j(this,tc,null);j(this,$f,null);j(this,nv,null);this._willKeepAspectRatio=!0,U(this,$f,t.signatureData||null),U(this,tc,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,r){br.initialize(t,r),this._defaultDrawingOptions=new y4,this._defaultDrawnSignatureOptions=new x4(r.viewParameters)}static getDefaultDrawingOptions(t){const r=this._defaultDrawingOptions.clone();return r.updateProperties(t),r}static get supportMultipleDrawings(){return!1}static get typesMap(){return Kt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!g(this,tc)}}static computeTelemetryFinalData(t){const r=t.get("hasDescription");return{hasAltText:r.get(!0)??0,hasNoAltText:r.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,r;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,r=this.y),super.render(),this._drawId===null)if(g(this,$f)){const{lines:s,mustSmooth:a,areContours:o,description:l,uuid:u,heightInPage:c}=g(this,$f),{rawDims:{pageWidth:h,pageHeight:d},rotation:f}=this.parent.viewport,p=Oh.processDrawnLines({lines:s,pageWidth:h,pageHeight:d,rotation:f,innerMargin:oo._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(p,c,l,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:g(this,tc)||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,r)),this.div}setUuid(t){U(this,nv,t),this.addEditToolbar()}getUuid(){return g(this,nv)}get description(){return g(this,tc)}set description(t){U(this,tc,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(r=>{r==null||r.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:r,thickness:i,width:s,height:a}=g(this,$f),o=Math.max(s,a),l=Oh.processDrawnLines({lines:{curves:t.map(u=>({points:u})),thickness:i,width:s,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:r});return{areContours:r,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,r,i,s){const{x:a,y:o}=this,{outline:l}=U(this,$f,t);U(this,zf,l instanceof iL),this.description=i;let u;g(this,zf)?u=oo.getDefaultDrawingOptions():(u=oo._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:u});const[,c]=this.pageDimensions;let h=r/c;h=h>=1?.5:h,this.width*=h/this.height,this.width>=1&&(h*=.9/this.width,this.width=.9),this.height=h,this.setDims(),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:r,pageHeight:i},rotation:s}=this.parent.viewport;return Oh.process(t,r,i,s,oo._INNER_MARGIN)}getFromText(t,r){const{rawDims:{pageWidth:i,pageHeight:s},rotation:a}=this.parent.viewport;return Oh.extractContoursFromText(t,r,i,s,a,oo._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:r,pageHeight:i},rotation:s}=this.parent.viewport;return Oh.processDrawnLines({lines:t,pageWidth:r,pageHeight:i,rotation:s,innerMargin:oo._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:r}){t?this._drawingOptions=oo.getDefaultDrawingOptions():(this._drawingOptions=oo._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":r}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:r,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":s}}=this,a=Object.assign(super.serialize(t),{isSignature:!0,areContours:g(this,zf),color:[0,0,0],thickness:g(this,zf)?0:s});return this.addComment(a),t?(a.paths={lines:r,points:i},a.uuid=g(this,nv),a.isCopy=!0):a.lines=r,g(this,tc)&&(a.accessibilityData={type:"Figure",alt:g(this,tc)}),a}static deserializeDraw(t,r,i,s,a,o){return o.areContours?iL.deserialize(t,r,i,s,a,o):KS.deserialize(t,r,i,s,a,o)}static async deserialize(t,r,i){var a;const s=await super.deserialize(t,r,i);return U(s,zf,t.areContours),s.description=((a=t.accessibilityData)==null?void 0:a.alt)||"",U(s,nv,t.uuid),s}};zf=new WeakMap,tc=new WeakMap,$f=new WeakMap,nv=new WeakMap,Qe(oo,"_type","signature"),Qe(oo,"_editorType",Jt.SIGNATURE),Qe(oo,"_defaultDrawingOptions",null);let uL=oo;var Dr,es,Hf,Rh,Gf,Xx,Ih,rv,nc,To,Kx,Ln,c1,h1,ZM,JM,eC,hL,tC,kJ;class cL extends br{constructor(t){super({...t,name:"stampEditor"});j(this,Ln);j(this,Dr,null);j(this,es,null);j(this,Hf,null);j(this,Rh,null);j(this,Gf,null);j(this,Xx,"");j(this,Ih,null);j(this,rv,!1);j(this,nc,null);j(this,To,!1);j(this,Kx,!1);U(this,Rh,t.bitmapUrl),U(this,Gf,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,r){br.initialize(t,r)}static isHandlingMimeForPasting(t){return K3.includes(t)}static paste(t,r){r.pasteEditor({mode:Jt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const r=t.get("hasAltText");return{hasAltText:r.get(!0)??0,hasNoAltText:r.get(!1)??0}}async mlGuessAltText(t=null,r=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await i.guess({name:"altText",request:{data:s,width:a,height:o,channels:s.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const u=l.output;return await this.setGuessedAltText(u),r&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;g(this,es)&&(U(this,Dr,null),this._uiManager.imageManager.deleteId(g(this,es)),(t=g(this,Ih))==null||t.remove(),U(this,Ih,null),g(this,nc)&&(clearTimeout(g(this,nc)),U(this,nc,null))),super.remove()}rebuild(){if(!this.parent){g(this,es)&&X(this,Ln,ZM).call(this);return}super.rebuild(),this.div!==null&&(g(this,es)&&g(this,Ih)===null&&X(this,Ln,ZM).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(g(this,Hf)||g(this,Dr)||g(this,Rh)||g(this,Gf)||g(this,es)||g(this,rv))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,r;return this._isCopy&&(t=this.x,r=this.y),super.render(),this.div.hidden=!0,this.createAltText(),g(this,rv)||(g(this,Dr)?X(this,Ln,JM).call(this):X(this,Ln,ZM).call(this)),this._isCopy&&this._moveAfterPaste(t,r),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,r){const{id:i,bitmap:s}=this._uiManager.imageManager.getFromCanvas(t,r);r.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(U(this,es,i),s&&U(this,Dr,s),U(this,rv,!1),X(this,Ln,JM).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;g(this,nc)!==null&&clearTimeout(g(this,nc)),U(this,nc,setTimeout(()=>{U(this,nc,null),X(this,Ln,hL).call(this)},200))}copyCanvas(t,r,i=!1){t||(t=224);const{width:s,height:a}=g(this,Dr),o=new Ec;let l=g(this,Dr),u=s,c=a,h=null;if(r){if(s>r||a>r){const A=Math.min(r/s,r/a);u=Math.floor(s*A),c=Math.floor(a*A)}h=document.createElement("canvas");const f=h.width=Math.ceil(u*o.sx),p=h.height=Math.ceil(c*o.sy);g(this,To)||(l=X(this,Ln,eC).call(this,f,p));const m=h.getContext("2d");m.filter=this._uiManager.hcmFilter;let y="white",v="#cfcfd8";this._uiManager.hcmFilter!=="none"?v="black":e0e.isDarkMode&&(y="#8f8f9d",v="#42414d");const b=15,x=b*o.sx,w=b*o.sy,_=new OffscreenCanvas(x*2,w*2),E=_.getContext("2d");E.fillStyle=y,E.fillRect(0,0,x*2,w*2),E.fillStyle=v,E.fillRect(0,0,x,w),E.fillRect(x,w,x,w),m.fillStyle=m.createPattern(_,"repeat"),m.fillRect(0,0,f,p),m.drawImage(l,0,0,l.width,l.height,0,0,f,p)}let d=null;if(i){let f,p;if(o.symmetric&&l.width<t&&l.height<t)f=l.width,p=l.height;else if(l=g(this,Dr),s>t||a>t){const v=Math.min(t/s,t/a);f=Math.floor(s*v),p=Math.floor(a*v),g(this,To)||(l=X(this,Ln,eC).call(this,f,p))}const y=new OffscreenCanvas(f,p).getContext("2d",{willReadFrequently:!0});y.drawImage(l,0,0,l.width,l.height,0,0,f,p),d={width:f,height:p,data:y.getImageData(0,0,f,p).data}}return{canvas:h,width:u,height:c,imageData:d}}static async deserialize(t,r,i){var y;let s=null,a=!1;if(t instanceof JZ){const{data:{rect:v,rotation:b,id:x,structParent:w,popupRef:_,richText:E,contentsObj:A,creationDate:T,modificationDate:S},container:M,parent:{page:{pageNumber:D}},canvas:N}=t;let R,O;N?(delete t.canvas,{id:R,bitmap:O}=i.imageManager.getFromCanvas(M.id,N),N.remove()):(a=!0,t._hasNoCanvas=!0);const G=((y=await r._structTree.getAriaAttributes(`${ny}${x}`))==null?void 0:y.get("aria-label"))||"";s=t={annotationType:Jt.STAMP,bitmapId:R,bitmap:O,pageIndex:D-1,rect:v.slice(0),rotation:b,annotationElementId:x,id:x,deleted:!1,accessibilityData:{decorative:!1,altText:G},isSvg:!1,structParent:w,popupRef:_,richText:E,comment:(A==null?void 0:A.str)||null,creationDate:T,modificationDate:S}}const o=await super.deserialize(t,r,i),{rect:l,bitmap:u,bitmapUrl:c,bitmapId:h,isSvg:d,accessibilityData:f}=t;a?(i.addMissingCanvas(t.id,o),U(o,rv,!0)):h&&i.imageManager.isValidId(h)?(U(o,es,h),u&&U(o,Dr,u)):U(o,Rh,c),U(o,To,d);const[p,m]=o.pageDimensions;return o.width=(l[2]-l[0])/p,o.height=(l[3]-l[1])/m,f&&(o.altTextData=f),o._initialData=s,t.comment&&o.setCommentData(t),U(o,Kx,!!s),o}serialize(t=!1,r=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:g(this,es),isSvg:g(this,To)});if(this.addComment(i),t)return i.bitmapUrl=X(this,Ln,tC).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:s,altText:a}=this.serializeAltText(!1);if(!s&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=X(this,Ln,kJ).call(this,i);return l.isSame?null:(l.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(r===null)return i;r.stamps||(r.stamps=new Map);const o=g(this,To)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!r.stamps.has(g(this,es)))r.stamps.set(g(this,es),{area:o,serialized:i}),i.bitmap=X(this,Ln,tC).call(this,!1);else if(g(this,To)){const l=r.stamps.get(g(this,es));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=X(this,Ln,tC).call(this,!1))}return i}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}Dr=new WeakMap,es=new WeakMap,Hf=new WeakMap,Rh=new WeakMap,Gf=new WeakMap,Xx=new WeakMap,Ih=new WeakMap,rv=new WeakMap,nc=new WeakMap,To=new WeakMap,Kx=new WeakMap,Ln=new WeakSet,c1=function(t,r=!1){if(!t){this.remove();return}U(this,Dr,t.bitmap),r||(U(this,es,t.id),U(this,To,t.isSvg)),t.file&&U(this,Xx,t.file.name),X(this,Ln,JM).call(this)},h1=function(){if(U(this,Hf,null),this._uiManager.enableWaiting(!1),!!g(this,Ih)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&g(this,Dr)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&g(this,Dr)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},ZM=function(){if(g(this,es)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(g(this,es)).then(i=>X(this,Ln,c1).call(this,i,!0)).finally(()=>X(this,Ln,h1).call(this));return}if(g(this,Rh)){const i=g(this,Rh);U(this,Rh,null),this._uiManager.enableWaiting(!0),U(this,Hf,this._uiManager.imageManager.getFromUrl(i).then(s=>X(this,Ln,c1).call(this,s)).finally(()=>X(this,Ln,h1).call(this)));return}if(g(this,Gf)){const i=g(this,Gf);U(this,Gf,null),this._uiManager.enableWaiting(!0),U(this,Hf,this._uiManager.imageManager.getFromFile(i).then(s=>X(this,Ln,c1).call(this,s)).finally(()=>X(this,Ln,h1).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=K3.join(",");const r=this._uiManager._signal;U(this,Hf,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),X(this,Ln,c1).call(this,s)}i()},{signal:r}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:r})}).finally(()=>X(this,Ln,h1).call(this))),t.click()},JM=function(){var u;const{div:t}=this;let{width:r,height:i}=g(this,Dr);const[s,a]=this.pageDimensions,o=.75;if(this.width)r=this.width*s,i=this.height*a;else if(r>o*s||i>o*a){const c=Math.min(o*s/r,o*a/i);r*=c,i*=c}this._uiManager.enableWaiting(!1);const l=U(this,Ih,document.createElement("canvas"));l.setAttribute("role","img"),this.addContainer(l),this.width=r/s,this.height=i/a,this.setDims(),(u=this._initialOptions)!=null&&u.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),X(this,Ln,hL).call(this),g(this,Kx)||(this.parent.addUndoableEditor(this),U(this,Kx,!0)),this._reportTelemetry({action:"inserted_image"}),g(this,Xx)&&this.div.setAttribute("aria-description",g(this,Xx)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},eC=function(t,r){const{width:i,height:s}=g(this,Dr);let a=i,o=s,l=g(this,Dr);for(;a>2*t||o>2*r;){const u=a,c=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*r&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const h=new OffscreenCanvas(a,o);h.getContext("2d").drawImage(l,0,0,u,c,0,0,a,o),l=h.transferToImageBitmap()}return l},hL=function(){const[t,r]=this.parentDimensions,{width:i,height:s}=this,a=new Ec,o=Math.ceil(i*t*a.sx),l=Math.ceil(s*r*a.sy),u=g(this,Ih);if(!u||u.width===o&&u.height===l)return;u.width=o,u.height=l;const c=g(this,To)?g(this,Dr):X(this,Ln,eC).call(this,o,l),h=u.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(c,0,0,c.width,c.height,0,0,o,l)},tC=function(t){if(t){if(g(this,To)){const s=this._uiManager.imageManager.getSvgUrl(g(this,es));if(s)return s}const r=document.createElement("canvas");return{width:r.width,height:r.height}=g(this,Dr),r.getContext("2d").drawImage(g(this,Dr),0,0),r.toDataURL()}if(g(this,To)){const[r,i]=this.pageDimensions,s=Math.round(this.width*r*Rp.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*Rp.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(s,a);return o.getContext("2d").drawImage(g(this,Dr),0,0,g(this,Dr).width,g(this,Dr).height,0,0,s,a),o.transferToImageBitmap()}return structuredClone(g(this,Dr))},kJ=function(t){var o;const{pageIndex:r,accessibilityData:{altText:i}}=this._initialData,s=t.pageIndex===r,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&a,isSameAltText:a}},Qe(cL,"_type","stamp"),Qe(cL,"_editorType",Jt.STAMP);var iv,Yx,jf,qf,Ph,$a,Wf,Qx,Zx,eu,Fh,ts,Lh,Xf,Jx,_t,Kf,dr,fL,BJ,Iu,pL,mL,nC;const $l=class $l{constructor({uiManager:e,pageIndex:t,div:r,structTreeLayer:i,accessibilityManager:s,annotationLayer:a,drawLayer:o,textLayer:l,viewport:u,l10n:c}){j(this,dr);j(this,iv);j(this,Yx,!1);j(this,jf,null);j(this,qf,null);j(this,Ph,null);j(this,$a,new Map);j(this,Wf,!1);j(this,Qx,!1);j(this,Zx,!1);j(this,eu,null);j(this,Fh,null);j(this,ts,null);j(this,Lh,null);j(this,Xf,null);j(this,Jx,-1);j(this,_t);const h=[...g($l,Kf).values()];if(!$l._initialized){$l._initialized=!0;for(const d of h)d.initialize(c,e)}e.registerEditorTypes(h),U(this,_t,e),this.pageIndex=t,this.div=r,U(this,iv,s),U(this,jf,a),this.viewport=u,U(this,ts,l),this.drawLayer=o,this._structTree=i,g(this,_t).addLayer(this)}get isEmpty(){return g(this,$a).size===0}get isInvisible(){return this.isEmpty&&g(this,_t).getMode()===Jt.NONE}updateToolbar(e){g(this,_t).updateToolbar(e)}updateMode(e=g(this,_t).getMode()){switch(X(this,dr,nC).call(this),e){case Jt.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Jt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Jt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===Jt.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const r of g($l,Kf).values())t.toggle(`${r._type}Editing`,e===r._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=g(this,ts))==null?void 0:t.div)}setEditingState(e){g(this,_t).setEditingState(e)}addCommands(e){g(this,_t).addCommands(e)}cleanUndoStack(e){g(this,_t).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=g(this,jf))==null||t.togglePointerEvents(e)}async enable(){var r;U(this,Zx,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(r=g(this,Xf))==null||r.abort(),U(this,Xf,null);const e=new Set;for(const i of g(this,dr,fL))i.enableEditing(),i.show(!0),i.annotationElementId&&(g(this,_t).removeChangedExistingAnnotation(i),e.add(i.annotationElementId));const t=g(this,jf);if(t)for(const i of t.getEditableAnnotations()){if(i.hide(),g(this,_t).isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}U(this,Zx,!1),g(this,_t)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var i;if(U(this,Qx,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),g(this,ts)&&!g(this,Xf)){U(this,Xf,new AbortController);const s=g(this,_t).combinedSignal(g(this,Xf));g(this,ts).div.addEventListener("pointerdown",a=>{const{clientX:l,clientY:u,timeStamp:c}=a,h=g(this,Jx);if(c-h>500){U(this,Jx,c);return}U(this,Jx,-1);const{classList:d}=this.div;d.toggle("getElements",!0);const f=document.elementsFromPoint(l,u);if(d.toggle("getElements",!1),!this.div.contains(f[0]))return;let p;const m=new RegExp(`^${xw}[0-9]+$`);for(const v of f)if(m.test(v.id)){p=v.id;break}if(!p)return;const y=g(this,$a).get(p);(y==null?void 0:y.annotationElementId)===null&&(a.stopPropagation(),a.preventDefault(),y.dblclick(a))},{signal:s,capture:!0})}const e=g(this,jf),t=[];if(e){const s=new Map,a=new Map;for(const l of g(this,dr,fL)){if(l.disableEditing(),!l.annotationElementId){t.push(l);continue}if(l.serialize()!==null){s.set(l.annotationElementId,l);continue}else a.set(l.annotationElementId,l);(i=this.getEditableAnnotation(l.annotationElementId))==null||i.show(),l.remove()}const o=e.getEditableAnnotations();for(const l of o){const{id:u}=l.data;if(g(this,_t).isDeletedAnnotationElement(u)){l.updateEdited({deleted:!0});continue}let c=a.get(u);if(c){c.resetAnnotationElement(l),c.show(!1),l.show();continue}c=s.get(u),c&&(g(this,_t).addChangedExistingAnnotation(c),c.renderAnnotationElement(l)&&c.show(!1)),l.show()}}X(this,dr,nC).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:r}=this.div;for(const s of g($l,Kf).values())r.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e==null||e.updateFakeAnnotations(t),U(this,Qx,!1)}getEditableAnnotation(e){var t;return((t=g(this,jf))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){g(this,_t).getActive()!==e&&g(this,_t).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=g(this,ts))!=null&&e.div&&!g(this,Lh)){U(this,Lh,new AbortController);const t=g(this,_t).combinedSignal(g(this,Lh));g(this,ts).div.addEventListener("pointerdown",X(this,dr,BJ).bind(this),{signal:t}),g(this,ts).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=g(this,ts))!=null&&e.div&&g(this,Lh)&&(g(this,Lh).abort(),U(this,Lh,null),g(this,ts).div.classList.remove("highlighting"))}enableClick(){if(g(this,qf))return;U(this,qf,new AbortController);const e=g(this,_t).combinedSignal(g(this,qf));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=g(this,qf))==null||e.abort(),U(this,qf,null)}attach(e){g(this,$a).set(e.id,e);const{annotationElementId:t}=e;t&&g(this,_t).isDeletedAnnotationElement(t)&&g(this,_t).removeDeletedAnnotationElement(e)}detach(e){var t;g(this,$a).delete(e.id),(t=g(this,iv))==null||t.removePointerInTextLayer(e.contentDiv),!g(this,Qx)&&e.annotationElementId&&g(this,_t).addDeletedAnnotationElement(e)}remove(e){this.detach(e),g(this,_t).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(g(this,_t).addDeletedAnnotationElement(e),br.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),g(this,_t).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!g(this,Zx)),g(this,_t).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var r;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!g(this,Ph)&&(e._focusEventsAllowed=!1,U(this,Ph,setTimeout(()=>{U(this,Ph,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:g(this,_t)._signal}),t.focus())},0))),e._structTreeParentId=(r=g(this,iv))==null?void 0:r.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),r=()=>{e.remove()};this.addCommands({cmd:t,undo:r,mustExec:!1})}getEditorByUID(e){for(const t of g(this,$a).values())if(t.uid===e)return t;return null}getNextId(){return g(this,_t).getId()}combinedSignal(e){return g(this,_t).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=g(this,dr,Iu))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await g(this,_t).updateMode(e.mode);const{offsetX:r,offsetY:i}=X(this,dr,mL).call(this),s=this.getNextId(),a=X(this,dr,pL).call(this,{parent:this,id:s,x:r,y:i,uiManager:g(this,_t),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=g($l,Kf).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,g(this,_t)))||null}createAndAddNewEditor(e,t,r={}){const i=this.getNextId(),s=X(this,dr,pL).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:g(this,_t),isCentered:t,...r});return s&&this.add(s),s}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(X(this,dr,mL).call(this),!0,e)}setSelected(e){g(this,_t).setSelected(e)}toggleSelected(e){g(this,_t).toggleSelected(e)}unselect(e){g(this,_t).unselect(e)}pointerup(e){var i;const{isMac:t}=Cs.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!g(this,Wf)||(U(this,Wf,!1),(i=g(this,dr,Iu))!=null&&i.isDrawer&&g(this,dr,Iu).supportMultipleDrawings))return;if(!g(this,Yx)){U(this,Yx,!0);return}const r=g(this,_t).getMode();if(r===Jt.STAMP||r===Jt.SIGNATURE){g(this,_t).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var i;if(g(this,_t).getMode()===Jt.HIGHLIGHT&&this.enableTextSelection(),g(this,Wf)){U(this,Wf,!1);return}const{isMac:t}=Cs.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(U(this,Wf,!0),(i=g(this,dr,Iu))!=null&&i.isDrawer){this.startDrawingSession(e);return}const r=g(this,_t).getActive();U(this,Yx,!r||r.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),g(this,eu)){g(this,dr,Iu).startDrawing(this,g(this,_t),!1,e);return}g(this,_t).setCurrentDrawingSession(this),U(this,eu,new AbortController);const t=g(this,_t).combinedSignal(g(this,eu));this.div.addEventListener("blur",({relatedTarget:r})=>{r&&!this.div.contains(r)&&(U(this,Fh,null),this.commitOrRemove())},{signal:t}),g(this,dr,Iu).startDrawing(this,g(this,_t),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&U(this,Fh,t);return}g(this,Fh)&&setTimeout(()=>{var t;(t=g(this,Fh))==null||t.focus(),U(this,Fh,null)},0)}endDrawingSession(e=!1){return g(this,eu)?(g(this,_t).setCurrentDrawingSession(null),g(this,eu).abort(),U(this,eu,null),U(this,Fh,null),g(this,dr,Iu).endDrawing(e)):null}findNewParent(e,t,r){const i=g(this,_t).findParent(t,r);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return g(this,eu)?(this.endDrawingSession(),!0):!1}onScaleChanging(){g(this,eu)&&g(this,dr,Iu).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=g(this,_t).getActive())==null?void 0:e.parent)===this&&(g(this,_t).commitOrRemove(),g(this,_t).setActiveEditor(null)),g(this,Ph)&&(clearTimeout(g(this,Ph)),U(this,Ph,null));for(const r of g(this,$a).values())(t=g(this,iv))==null||t.removePointerInTextLayer(r.contentDiv),r.setParent(null),r.isAttachedToDOM=!1,r.div.remove();this.div=null,g(this,$a).clear(),g(this,_t).removeLayer(this)}render({viewport:e}){this.viewport=e,Ev(this.div,e);for(const t of g(this,_t).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){g(this,_t).commitOrRemove(),X(this,dr,nC).call(this);const t=this.viewport.rotation,r=e.rotation;if(this.viewport=e,Ev(this.div,{rotation:r}),t!==r)for(const i of g(this,$a).values())i.rotate(r)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return g(this,_t).viewParameters.realScale}};iv=new WeakMap,Yx=new WeakMap,jf=new WeakMap,qf=new WeakMap,Ph=new WeakMap,$a=new WeakMap,Wf=new WeakMap,Qx=new WeakMap,Zx=new WeakMap,eu=new WeakMap,Fh=new WeakMap,ts=new WeakMap,Lh=new WeakMap,Xf=new WeakMap,Jx=new WeakMap,_t=new WeakMap,Kf=new WeakMap,dr=new WeakSet,fL=function(){return g(this,$a).size!==0?g(this,$a).values():g(this,_t).getEditors(this.pageIndex)},BJ=function(e){g(this,_t).unselectAll();const{target:t}=e;if(t===g(this,ts).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&g(this,ts).div.contains(t)){const{isMac:r}=Cs.platform;if(e.button!==0||e.ctrlKey&&r)return;g(this,_t).showAllEditors("highlight",!0,!0),g(this,ts).div.classList.add("free"),this.toggleDrawing(),mD.startHighlighting(this,g(this,_t).direction==="ltr",{target:g(this,ts).div,x:e.x,y:e.y}),g(this,ts).div.addEventListener("pointerup",()=>{g(this,ts).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:g(this,_t)._signal}),e.preventDefault()}},Iu=function(){return g($l,Kf).get(g(this,_t).getMode())},pL=function(e){const t=g(this,dr,Iu);return t?new t.prototype.constructor(e):null},mL=function(){const{x:e,y:t,width:r,height:i}=this.boundingClientRect,s=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+r),l=Math.min(window.innerHeight,t+i),u=(s+o)/2-e,c=(a+l)/2-t,[h,d]=this.viewport.rotation%180===0?[u,c]:[c,u];return{offsetX:h,offsetY:d}},nC=function(){for(const e of g(this,$a).values())e.isEmpty()&&e.remove()},Qe($l,"_initialized",!1),j($l,Kf,new Map([WF,rL,cL,mD,uL].map(e=>[e._editorType,e])));let dL=$l;var tu,ma,sv,ES,E2,UJ,Dc,vL,VJ,yL;const Mi=class Mi{constructor({pageIndex:e}){j(this,Dc);j(this,tu,null);j(this,ma,new Map);j(this,sv,new Map);this.pageIndex=e}setParent(e){if(!g(this,tu)){U(this,tu,e);return}if(g(this,tu)!==e){if(g(this,ma).size>0)for(const t of g(this,ma).values())t.remove(),e.append(t);U(this,tu,e)}}static get _svgFactory(){return Kt(this,"_svgFactory",new fD)}draw(e,t=!1,r=!1){const i=Ai(Mi,ES)._++,s=X(this,Dc,vL).call(this),a=Mi._svgFactory.createElement("defs");s.append(a);const o=Mi._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&g(this,sv).set(i,o);const u=r?X(this,Dc,VJ).call(this,a,l):null,c=Mi._svgFactory.createElement("use");return s.append(c),c.setAttribute("href",`#${l}`),this.updateProperties(s,e),g(this,ma).set(i,s),{id:i,clipPathId:`url(#${u})`}}drawOutline(e,t){const r=Ai(Mi,ES)._++,i=X(this,Dc,vL).call(this),s=Mi._svgFactory.createElement("defs");i.append(s);const a=Mi._svgFactory.createElement("path");s.append(a);const o=`path_p${this.pageIndex}_${r}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const h=Mi._svgFactory.createElement("mask");s.append(h),l=`mask_p${this.pageIndex}_${r}`,h.setAttribute("id",l),h.setAttribute("maskUnits","objectBoundingBox");const d=Mi._svgFactory.createElement("rect");h.append(d),d.setAttribute("width","1"),d.setAttribute("height","1"),d.setAttribute("fill","white");const f=Mi._svgFactory.createElement("use");h.append(f),f.setAttribute("href",`#${o}`),f.setAttribute("stroke","none"),f.setAttribute("fill","black"),f.setAttribute("fill-rule","nonzero"),f.classList.add("mask")}const u=Mi._svgFactory.createElement("use");i.append(u),u.setAttribute("href",`#${o}`),l&&u.setAttribute("mask",`url(#${l})`);const c=u.cloneNode();return i.append(c),u.classList.add("mainOutline"),c.classList.add("secondaryOutline"),this.updateProperties(i,e),g(this,ma).set(r,i),r}finalizeDraw(e,t){g(this,sv).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:r,bbox:i,rootClass:s,path:a}=t,o=typeof e=="number"?g(this,ma).get(e):e;if(o){if(r&&X(this,Dc,yL).call(this,o,r),i&&X(l=Mi,E2,UJ).call(l,o,i),s){const{classList:u}=o;for(const[c,h]of Object.entries(s))u.toggle(c,h)}if(a){const c=o.firstElementChild.firstElementChild;X(this,Dc,yL).call(this,c,a)}}}updateParent(e,t){if(t===this)return;const r=g(this,ma).get(e);r&&(g(t,tu).append(r),g(this,ma).delete(e),g(t,ma).set(e,r))}remove(e){g(this,sv).delete(e),g(this,tu)!==null&&(g(this,ma).get(e).remove(),g(this,ma).delete(e))}destroy(){U(this,tu,null);for(const e of g(this,ma).values())e.remove();g(this,ma).clear(),g(this,sv).clear()}};tu=new WeakMap,ma=new WeakMap,sv=new WeakMap,ES=new WeakMap,E2=new WeakSet,UJ=function(e,[t,r,i,s]){const{style:a}=e;a.top=`${100*r}%`,a.left=`${100*t}%`,a.width=`${100*i}%`,a.height=`${100*s}%`},Dc=new WeakSet,vL=function(){const e=Mi._svgFactory.create(1,1,!0);return g(this,tu).append(e),e.setAttribute("aria-hidden",!0),e},VJ=function(e,t){const r=Mi._svgFactory.createElement("clipPath");e.append(r);const i=`clip_${t}`;r.setAttribute("id",i),r.setAttribute("clipPathUnits","objectBoundingBox");const s=Mi._svgFactory.createElement("use");return r.append(s),s.setAttribute("href",`#${t}`),s.classList.add("clip"),i},yL=function(e,t){for(const[r,i]of Object.entries(t))i===null?e.removeAttribute(r):e.setAttribute(r,i)},j(Mi,E2),j(Mi,ES,0);let gL=Mi;globalThis._pdfjsTestingUtils={HighlightOutliner:KF};globalThis.pdfjsLib={AbortException:Np,AnnotationEditorLayer:dL,AnnotationEditorParamsType:En,AnnotationEditorType:Jt,AnnotationEditorUIManager:Sv,AnnotationLayer:jF,AnnotationMode:Zd,AnnotationType:mi,applyOpacity:n0e,build:uye,ColorPicker:hD,createValidAbsoluteUrl:NQ,CSSConstants:t0e,DOMSVGFactory:fD,DrawLayer:gL,FeatureTest:Cs,fetchData:GS,findContrastColor:r0e,getDocument:BZ,getFilenameFromUrl:Kve,getPdfFilenameFromUrl:Yve,getRGB:qS,getUuid:PQ,getXfaPageViewport:Zve,GlobalWorkerOptions:sc,ImageKind:EM,InvalidPDFException:W3,isDataScheme:xN,isPdfFile:d4,isValidExplicitDest:f0e,MathClamp:va,noContextMenu:Cl,normalizeUnicode:qve,OPS:bw,OutputScale:Ec,PasswordResponses:kve,PDFDataRangeTransport:UZ,PDFDateString:sD,PDFWorker:Ew,PermissionFlag:Ove,PixelsPerInch:Rp,RenderingCancelledException:h4,renderRichText:OQ,ResponseException:iD,setLayerDimensions:Ev,shadow:Kt,SignatureExtractor:Oh,stopEvent:Qr,SupportedImageMimeTypes:K3,TextLayer:ww,TouchManager:oD,updateUrlHash:RQ,Util:yt,VerbosityLevel:gN,version:lye,XfaLayer:LQ};sc.workerSrc="/1201-project/pdf.worker.min.js";const Pye="",Fye="https://api-inference.huggingface.co/models/facebook/bart-large-cnn";async function Lye(n){try{const e=await n.arrayBuffer(),t=await BZ({data:e}).promise;let r="";const i=Math.min(t.numPages,15);console.log(`PDF  : ${t.numPages},  : ${i}`);for(let s=1;s<=i;s++)try{const o=await(await t.getPage(s)).getTextContent();let l="";for(const u of o.items)u.str&&u.str.trim()&&(l+=u.str+" ");l.trim()&&(r+=l+`
`,console.log(` ${s}   (${l.length})`))}catch(a){console.warn(` ${s}  :`,a);continue}if(!r.trim())throw new Error("PDF    .   PDF  .");return console.log(`  : ${r.length}`),r}catch(e){throw console.error("PDF   :",e),new Error("PDF   : "+e.message)}}async function Oye(n){var e;try{const r=n.substring(0,1024),i=await fetch(Fye,{headers:{Authorization:`Bearer ${Pye}`},method:"POST",body:JSON.stringify({inputs:r})});if(!i.ok)throw new Error(`API : ${i.status}`);const s=await i.json();if(Array.isArray(s)&&((e=s[0])!=null&&e.summary_text))return s[0].summary_text;throw new Error("  ")}catch(t){throw console.error("AI  :",t),t}}function kye(n){const e=n.match(/[^.!?]+[.!?]+/g)||[],t=["","","","","","",""];return e.map((s,a)=>{let o=t.reduce((l,u)=>l+(s.toLowerCase().includes(u)?1:0),0);return o+=1/(a+1),{sentence:s.trim(),score:o}}).sort((s,a)=>a.score-s.score).slice(0,3).map(s=>s.sentence).join(" ")||"  "}async function Bye(n){try{return{summary:await Oye(n),method:"AI"}}catch(e){return console.warn("AI  ,    :",e),{summary:kye(n),method:"Rule-based"}}}var Uye="firebase",Vye="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fc(Uye,Vye,"app");function zJ(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const zye=zJ,$J=new PS("auth","Firebase",zJ());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD=new _B("@firebase/auth");function $ye(n,...e){vD.logLevel<=vn.WARN&&vD.warn(`Auth (${Fv}): ${n}`,...e)}function rC(n,...e){vD.logLevel<=vn.ERROR&&vD.error(`Auth (${Fv}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mu(n,...e){throw b4(n,...e)}function yc(n,...e){return b4(n,...e)}function HJ(n,e,t){const r={...zye(),[e]:t};return new PS("auth","Firebase",r).create(e,{appName:n.name})}function Xh(n){return HJ(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function b4(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return $J.create(n,...e)}function Lt(n,e,...t){if(!n)throw b4(e,...t)}function Vh(n){const e="INTERNAL ASSERTION FAILED: "+n;throw rC(e),new Error(e)}function fd(n,e){n||Vh(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xL(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function Hye(){return A8()==="http:"||A8()==="https:"}function A8(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gye(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Hye()||ife()||"connection"in navigator)?navigator.onLine:!0}function jye(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(e,t){this.shortDelay=e,this.longDelay=t,fd(t>e,"Short delay should be less than long delay!"),this.isMobile=tfe()||sfe()}get(){return Gye()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _4(n,e){fd(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GJ{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vh("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vh("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vh("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qye={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wye=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Xye=new YS(3e4,6e4);function jp(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function qp(n,e,t,r,i={}){return jJ(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const o=FS({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const u={method:e,headers:l,...s};return rfe()||(u.referrerPolicy="no-referrer"),n.emulatorConfig&&Pv(n.emulatorConfig.host)&&(u.credentials="include"),GJ.fetch()(await qJ(n,n.config.apiHost,t,o),u)})}async function jJ(n,e,t){n._canInitEmulator=!1;const r={...qye,...e};try{const i=new Yye(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw aT(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw aT(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw aT(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw aT(n,"user-disabled",a);const c=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw HJ(n,c,u);mu(n,c)}}catch(i){if(i instanceof Rc)throw i;mu(n,"network-request-failed",{message:String(i)})}}async function QS(n,e,t,r,i={}){const s=await qp(n,e,t,r,i);return"mfaPendingCredential"in s&&mu(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function qJ(n,e,t,r){const i=`${e}${t}?${r}`,s=n,a=s.config.emulator?_4(n.config,i):`${n.config.apiScheme}://${i}`;return Wye.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}function Kye(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Yye{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(yc(this.auth,"network-request-failed")),Xye.get())})}}function aT(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=yc(n,e,r);return i.customData._tokenResponse=t,i}function T8(n){return n!==void 0&&n.enterprise!==void 0}class Qye{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Kye(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Zye(n,e){return qp(n,"GET","/v2/recaptchaConfig",jp(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jye(n,e){return qp(n,"POST","/v1/accounts:delete",e)}async function yD(n,e){return qp(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L1(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function exe(n,e=!1){const t=Oi(n),r=await t.getIdToken(e),i=w4(r);Lt(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:L1(dI(i.auth_time)),issuedAtTime:L1(dI(i.iat)),expirationTime:L1(dI(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function dI(n){return Number(n)*1e3}function w4(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return rC("JWT malformed, contained fewer than 3 sections"),null;try{const i=BK(t);return i?JSON.parse(i):(rC("Failed to decode base64 JWT payload"),null)}catch(i){return rC("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function M8(n){const e=w4(n);return Lt(e,"internal-error"),Lt(typeof e.exp<"u","internal-error"),Lt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sw(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Rc&&txe(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function txe({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nxe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=L1(this.lastLoginAt),this.creationTime=L1(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xD(n){var h;const e=n.auth,t=await n.getIdToken(),r=await Sw(n,yD(e,{idToken:t}));Lt(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=(h=i.providerUserInfo)!=null&&h.length?WJ(i.providerUserInfo):[],a=ixe(n.providerData,s),o=n.isAnonymous,l=!(n.email&&i.passwordHash)&&!(a!=null&&a.length),u=o?l:!1,c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new bL(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(n,c)}async function rxe(n){const e=Oi(n);await xD(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function ixe(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function WJ(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sxe(n,e){const t=await jJ(n,{},async()=>{const r=FS({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=await qJ(n,i,"/v1/token",`key=${s}`),o=await n._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:r};return n.emulatorConfig&&Pv(n.emulatorConfig.host)&&(l.credentials="include"),GJ.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function axe(n,e){return qp(n,"POST","/v2/accounts:revokeToken",jp(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Lt(e.idToken,"internal-error"),Lt(typeof e.idToken<"u","internal-error"),Lt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):M8(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Lt(e.length!==0,"internal-error");const t=M8(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Lt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await sxe(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new _y;return r&&(Lt(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Lt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Lt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new _y,this.toJSON())}_performRefresh(){return Vh("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Od(n,e){Lt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class au{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new nxe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new bL(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Sw(this,this.stsTokenManager.getToken(this.auth,e));return Lt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return exe(this,e)}reload(){return rxe(this)}_assign(e){this!==e&&(Lt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new au({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Lt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await xD(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Po(this.auth.app))return Promise.reject(Xh(this.auth));const e=await this.getIdToken();return await Sw(this,Jye(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,a=t.photoURL??void 0,o=t.tenantId??void 0,l=t._redirectEventId??void 0,u=t.createdAt??void 0,c=t.lastLoginAt??void 0,{uid:h,emailVerified:d,isAnonymous:f,providerData:p,stsTokenManager:m}=t;Lt(h&&m,e,"internal-error");const y=_y.fromJSON(this.name,m);Lt(typeof h=="string",e,"internal-error"),Od(r,e.name),Od(i,e.name),Lt(typeof d=="boolean",e,"internal-error"),Lt(typeof f=="boolean",e,"internal-error"),Od(s,e.name),Od(a,e.name),Od(o,e.name),Od(l,e.name),Od(u,e.name),Od(c,e.name);const v=new au({uid:h,auth:e,email:i,emailVerified:d,displayName:r,isAnonymous:f,photoURL:a,phoneNumber:s,tenantId:o,stsTokenManager:y,createdAt:u,lastLoginAt:c});return p&&Array.isArray(p)&&(v.providerData=p.map(b=>({...b}))),l&&(v._redirectEventId=l),v}static async _fromIdTokenResponse(e,t,r=!1){const i=new _y;i.updateFromServerResponse(t);const s=new au({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await xD(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Lt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?WJ(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new _y;o.updateFromIdToken(r);const l=new au({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new bL(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C8=new Map;function zh(n){fd(n instanceof Function,"Expected a class definition");let e=C8.get(n);return e?(fd(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,C8.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XJ{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}XJ.type="NONE";const D8=XJ;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iC(n,e,t){return`firebase:${n}:${e}:${t}`}class wy{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=iC(this.userKey,i.apiKey,s),this.fullPersistenceKey=iC("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await yD(this.auth,{idToken:e}).catch(()=>{});return t?au._fromGetAccountInfoResponse(this.auth,t,e):null}return au._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new wy(zh(D8),e,r);const i=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||zh(D8);const a=iC(r,e.config.apiKey,e.name);let o=null;for(const u of t)try{const c=await u._get(a);if(c){let h;if(typeof c=="string"){const d=await yD(e,{idToken:c}).catch(()=>{});if(!d)break;h=await au._fromGetAccountInfoResponse(e,d,c)}else h=au._fromJSON(e,c);u!==s&&(o=h),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new wy(s,e,r):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(t.map(async u=>{if(u!==s)try{await u._remove(a)}catch{}})),new wy(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N8(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ZJ(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(KJ(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(eee(e))return"Blackberry";if(tee(e))return"Webos";if(YJ(e))return"Safari";if((e.includes("chrome/")||QJ(e))&&!e.includes("edge/"))return"Chrome";if(JJ(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function KJ(n=na()){return/firefox\//i.test(n)}function YJ(n=na()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function QJ(n=na()){return/crios\//i.test(n)}function ZJ(n=na()){return/iemobile/i.test(n)}function JJ(n=na()){return/android/i.test(n)}function eee(n=na()){return/blackberry/i.test(n)}function tee(n=na()){return/webos/i.test(n)}function E4(n=na()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function oxe(n=na()){var e;return E4(n)&&!!((e=window.navigator)!=null&&e.standalone)}function lxe(){return afe()&&document.documentMode===10}function nee(n=na()){return E4(n)||JJ(n)||tee(n)||eee(n)||/windows phone/i.test(n)||ZJ(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ree(n,e=[]){let t;switch(n){case"Browser":t=N8(na());break;case"Worker":t=`${N8(na())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Fv}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uxe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cxe(n,e={}){return qp(n,"GET","/v2/passwordPolicy",jp(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hxe=6;class dxe{constructor(e){var r;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??hxe,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fxe{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new R8(this),this.idTokenSubscription=new R8(this),this.beforeStateQueue=new uxe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$J,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=zh(t)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await wy.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await yD(this,{idToken:e}),r=await au._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(Po(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(s=this.redirectUser)==null?void 0:s._redirectEventId,o=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Lt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await xD(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=jye()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Po(this.app))return Promise.reject(Xh(this));const t=e?Oi(e):null;return t&&Lt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Lt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Po(this.app)?Promise.reject(Xh(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Po(this.app)?Promise.reject(Xh(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zh(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await cxe(this),t=new dxe(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new PS("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await axe(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&zh(e)||this._popupRedirectResolver;Lt(t,this,"argument-error"),this.redirectPersistenceManager=await wy.create(this,[zh(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Lt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Lt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ree(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(Po(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&$ye(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Uv(n){return Oi(n)}class R8{constructor(e){this.auth=e,this.observer=null,this.addObserver=pfe(t=>this.observer=t)}get next(){return Lt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wN={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pxe(n){wN=n}function iee(n){return wN.loadJS(n)}function mxe(){return wN.recaptchaEnterpriseScript}function gxe(){return wN.gapiScript}function vxe(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class yxe{constructor(){this.enterprise=new xxe}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class xxe{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const bxe="recaptcha-enterprise",see="NO_RECAPTCHA";class _xe{constructor(e){this.type=bxe,this.auth=Uv(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,o)=>{Zye(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const u=new Qye(l);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,a(u.siteKey)}}).catch(l=>{o(l)})})}function i(s,a,o){const l=window.grecaptcha;T8(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(u=>{a(u)}).catch(()=>{a(see)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new yxe().execute("siteKey",{action:"verify"}):new Promise((s,a)=>{r(this.auth).then(o=>{if(!t&&T8(window.grecaptcha))i(o,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=mxe();l.length!==0&&(l+=o),iee(l).then(()=>{i(o,s,a)}).catch(u=>{a(u)})}}).catch(o=>{a(o)})})}}async function I8(n,e,t,r=!1,i=!1){const s=new _xe(n);let a;if(i)a=see;else try{a=await s.verify(t)}catch{a=await s.verify(t,!0)}const o={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const l=o.phoneEnrollmentInfo.phoneNumber,u=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:u,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const l=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return r?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function _L(n,e,t,r,i){var s;if((s=n._getRecaptchaConfig())!=null&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await I8(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await I8(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wxe(n,e){const t=q2(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(xv(s,e??{}))return i;mu(i,"already-initialized")}return t.initialize({options:e})}function Exe(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(zh);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Sxe(n,e,t){const r=Uv(n);Lt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=aee(e),{host:a,port:o}=Axe(e),l=o===null?"":`:${o}`,u={url:`${s}//${a}${l}/`},c=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Lt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Lt(xv(u,r.config.emulator)&&xv(c,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=c,r.settings.appVerificationDisabledForTesting=!0,Pv(a)?(xB(`${s}//${a}${l}`),bB("Auth",!0)):Txe()}function aee(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Axe(n){const e=aee(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:P8(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:P8(a)}}}function P8(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function Txe(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Vh("not implemented")}_getIdTokenResponse(e){return Vh("not implemented")}_linkToIdToken(e,t){return Vh("not implemented")}_getReauthenticationResolver(e){return Vh("not implemented")}}async function Mxe(n,e){return qp(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cxe(n,e){return QS(n,"POST","/v1/accounts:signInWithPassword",jp(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dxe(n,e){return QS(n,"POST","/v1/accounts:signInWithEmailLink",jp(n,e))}async function Nxe(n,e){return QS(n,"POST","/v1/accounts:signInWithEmailLink",jp(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw extends S4{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Aw(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Aw(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return _L(e,t,"signInWithPassword",Cxe);case"emailLink":return Dxe(e,{email:this._email,oobCode:this._password});default:mu(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return _L(e,r,"signUpPassword",Mxe);case"emailLink":return Nxe(e,{idToken:t,email:this._email,oobCode:this._password});default:mu(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ey(n,e){return QS(n,"POST","/v1/accounts:signInWithIdp",jp(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rxe="http://localhost";class Tv extends S4{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Tv(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):mu("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;const a=new Tv(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return Ey(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Ey(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ey(e,t)}buildRequest(){const e={requestUri:Rxe,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=FS(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ixe(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Pxe(n){const e=U_(V_(n)).link,t=e?U_(V_(e)).deep_link_id:null,r=U_(V_(n)).deep_link_id;return(r?U_(V_(r)).link:null)||r||t||e||n}class A4{constructor(e){const t=U_(V_(e)),r=t.apiKey??null,i=t.oobCode??null,s=Ixe(t.mode??null);Lt(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=Pxe(e);try{return new A4(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hb{constructor(){this.providerId=Hb.PROVIDER_ID}static credential(e,t){return Aw._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=A4.parseLink(t);return Lt(r,"argument-error"),Aw._fromEmailAndCode(e,r.code,r.tenantId)}}Hb.PROVIDER_ID="password";Hb.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Hb.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oee{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS extends oee{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd extends ZS{constructor(){super("facebook.com")}static credential(e){return Tv._fromParams({providerId:Jd.PROVIDER_ID,signInMethod:Jd.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Jd.credentialFromTaggedObject(e)}static credentialFromError(e){return Jd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Jd.credential(e.oauthAccessToken)}catch{return null}}}Jd.FACEBOOK_SIGN_IN_METHOD="facebook.com";Jd.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef extends ZS{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Tv._fromParams({providerId:ef.PROVIDER_ID,signInMethod:ef.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ef.credentialFromTaggedObject(e)}static credentialFromError(e){return ef.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return ef.credential(t,r)}catch{return null}}}ef.GOOGLE_SIGN_IN_METHOD="google.com";ef.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf extends ZS{constructor(){super("github.com")}static credential(e){return Tv._fromParams({providerId:tf.PROVIDER_ID,signInMethod:tf.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return tf.credentialFromTaggedObject(e)}static credentialFromError(e){return tf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return tf.credential(e.oauthAccessToken)}catch{return null}}}tf.GITHUB_SIGN_IN_METHOD="github.com";tf.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf extends ZS{constructor(){super("twitter.com")}static credential(e,t){return Tv._fromParams({providerId:nf.PROVIDER_ID,signInMethod:nf.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return nf.credentialFromTaggedObject(e)}static credentialFromError(e){return nf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return nf.credential(t,r)}catch{return null}}}nf.TWITTER_SIGN_IN_METHOD="twitter.com";nf.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fxe(n,e){return QS(n,"POST","/v1/accounts:signUp",jp(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await au._fromIdTokenResponse(e,r,i),a=F8(r);return new Mv({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=F8(r);return new Mv({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function F8(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD extends Rc{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,bD.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new bD(e,t,r,i)}}function lee(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?bD._fromErrorAndOperation(n,s,e,r):s})}async function Lxe(n,e,t=!1){const r=await Sw(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Mv._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oxe(n,e,t=!1){const{auth:r}=n;if(Po(r.app))return Promise.reject(Xh(r));const i="reauthenticate";try{const s=await Sw(n,lee(r,i,e,n),t);Lt(s.idToken,r,"internal-error");const a=w4(s.idToken);Lt(a,r,"internal-error");const{sub:o}=a;return Lt(n.uid===o,r,"user-mismatch"),Mv._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&mu(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uee(n,e,t=!1){if(Po(n.app))return Promise.reject(Xh(n));const r="signIn",i=await lee(n,r,e),s=await Mv._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function kxe(n,e){return uee(Uv(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cee(n){const e=Uv(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Bxe(n,e,t){if(Po(n.app))return Promise.reject(Xh(n));const r=Uv(n),a=await _L(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Fxe).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&cee(n),l}),o=await Mv._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(o.user),o}function Uxe(n,e,t){return Po(n.app)?Promise.reject(Xh(n)):kxe(Oi(n),Hb.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&cee(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hee(n,e){return Oi(n).setPersistence(e)}function Vxe(n,e,t,r){return Oi(n).onIdTokenChanged(e,t,r)}function zxe(n,e,t){return Oi(n).beforeAuthStateChanged(e,t)}const _D="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dee{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(_D,"1"),this.storage.removeItem(_D),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $xe=1e3,Hxe=10;class fee extends dee{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=nee(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);lxe()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Hxe):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},$xe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}fee.type="LOCAL";const T4=fee;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pee extends dee{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}pee.type="SESSION";const mee=pee;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gxe(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EN{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new EN(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const o=Array.from(a).map(async u=>u(t.origin,s)),l=await Gxe(o);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}EN.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M4(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jxe{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const u=M4("",20);i.port1.start();const c=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(h){const d=h;if(d.data.eventId===u)switch(d.data.status){case"ack":clearTimeout(c),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(d.data.response);break;default:clearTimeout(c),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xc(){return window}function qxe(n){xc().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gee(){return typeof xc().WorkerGlobalScope<"u"&&typeof xc().importScripts=="function"}async function Wxe(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Xxe(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function Kxe(){return gee()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vee="firebaseLocalStorageDb",Yxe=1,wD="firebaseLocalStorage",yee="fbase_key";class JS{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function SN(n,e){return n.transaction([wD],e?"readwrite":"readonly").objectStore(wD)}function Qxe(){const n=indexedDB.deleteDatabase(vee);return new JS(n).toPromise()}function wL(){const n=indexedDB.open(vee,Yxe);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(wD,{keyPath:yee})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(wD)?e(r):(r.close(),await Qxe(),e(await wL()))})})}async function L8(n,e,t){const r=SN(n,!0).put({[yee]:e,value:t});return new JS(r).toPromise()}async function Zxe(n,e){const t=SN(n,!1).get(e),r=await new JS(t).toPromise();return r===void 0?null:r.value}function O8(n,e){const t=SN(n,!0).delete(e);return new JS(t).toPromise()}const Jxe=800,ebe=3;class xee{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await wL(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>ebe)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return gee()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=EN._getInstance(Kxe()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await Wxe(),!this.activeServiceWorker)return;this.sender=new jxe(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Xxe()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await wL();return await L8(e,_D,"1"),await O8(e,_D),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>L8(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>Zxe(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>O8(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=SN(i,!1).getAll();return new JS(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Jxe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}xee.type="LOCAL";const tbe=xee;new YS(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nbe(n,e){return e?zh(e):(Lt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C4 extends S4{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ey(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ey(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ey(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function rbe(n){return uee(n.auth,new C4(n),n.bypassAuthState)}function ibe(n){const{auth:e,user:t}=n;return Lt(t,e,"internal-error"),Oxe(t,new C4(n),n.bypassAuthState)}async function sbe(n){const{auth:e,user:t}=n;return Lt(t,e,"internal-error"),Lxe(t,new C4(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bee{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return rbe;case"linkViaPopup":case"linkViaRedirect":return sbe;case"reauthViaPopup":case"reauthViaRedirect":return ibe;default:mu(this.auth,"internal-error")}}resolve(e){fd(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){fd(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const abe=new YS(2e3,1e4);class iy extends bee{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,iy.currentPopupAction&&iy.currentPopupAction.cancel(),iy.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Lt(e,this.auth,"internal-error"),e}async onExecution(){fd(this.filter.length===1,"Popup operations only handle one event");const e=M4();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(yc(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(yc(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,iy.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if((r=(t=this.authWindow)==null?void 0:t.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(yc(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,abe.get())};e()}}iy.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const obe="pendingRedirect",sC=new Map;class lbe extends bee{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=sC.get(this.auth._key());if(!e){try{const r=await ube(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}sC.set(this.auth._key(),e)}return this.bypassAuthState||sC.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function ube(n,e){const t=dbe(e),r=hbe(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function cbe(n,e){sC.set(n._key(),e)}function hbe(n){return zh(n._redirectPersistence)}function dbe(n){return iC(obe,n.config.apiKey,n.name)}async function fbe(n,e,t=!1){if(Po(n.app))return Promise.reject(Xh(n));const r=Uv(n),i=nbe(r,e),a=await new lbe(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pbe=10*60*1e3;class mbe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!gbe(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!_ee(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";t.onError(yc(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=pbe&&this.cachedEventUids.clear(),this.cachedEventUids.has(k8(e))}saveEventToCache(e){this.cachedEventUids.add(k8(e)),this.lastProcessedEventTime=Date.now()}}function k8(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function _ee({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function gbe(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return _ee(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vbe(n,e={}){return qp(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ybe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,xbe=/^https?/;async function bbe(n){if(n.config.emulator)return;const{authorizedDomains:e}=await vbe(n);for(const t of e)try{if(_be(t))return}catch{}mu(n,"unauthorized-domain")}function _be(n){const e=xL(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!xbe.test(t))return!1;if(ybe.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wbe=new YS(3e4,6e4);function B8(){const n=xc().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Ebe(n){return new Promise((e,t)=>{var i,s,a;function r(){B8(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{B8(),t(yc(n,"network-request-failed"))},timeout:wbe.get()})}if((s=(i=xc().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((a=xc().gapi)!=null&&a.load)r();else{const o=vxe("iframefcb");return xc()[o]=()=>{gapi.load?r():t(yc(n,"network-request-failed"))},iee(`${gxe()}?onload=${o}`).catch(l=>t(l))}}).catch(e=>{throw aC=null,e})}let aC=null;function Sbe(n){return aC=aC||Ebe(n),aC}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Abe=new YS(5e3,15e3),Tbe="__/auth/iframe",Mbe="emulator/auth/iframe",Cbe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Dbe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Nbe(n){const e=n.config;Lt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?_4(e,Mbe):`https://${n.config.authDomain}/${Tbe}`,r={apiKey:e.apiKey,appName:n.name,v:Fv},i=Dbe.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${FS(r).slice(1)}`}async function Rbe(n){const e=await Sbe(n),t=xc().gapi;return Lt(t,n,"internal-error"),e.open({where:document.body,url:Nbe(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Cbe,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=yc(n,"network-request-failed"),o=xc().setTimeout(()=>{s(a)},Abe.get());function l(){xc().clearTimeout(o),i(r)}r.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ibe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Pbe=500,Fbe=600,Lbe="_blank",Obe="http://localhost";class U8{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function kbe(n,e,t,r=Pbe,i=Fbe){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l={...Ibe,width:r.toString(),height:i.toString(),top:s,left:a},u=na().toLowerCase();t&&(o=QJ(u)?Lbe:t),KJ(u)&&(e=e||Obe,l.scrollbars="yes");const c=Object.entries(l).reduce((d,[f,p])=>`${d}${f}=${p},`,"");if(oxe(u)&&o!=="_self")return Bbe(e||"",o),new U8(null);const h=window.open(e||"",o,c);Lt(h,n,"popup-blocked");try{h.focus()}catch{}return new U8(h)}function Bbe(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ube="__/auth/handler",Vbe="emulator/auth/handler",zbe=encodeURIComponent("fac");async function V8(n,e,t,r,i,s){Lt(n.config.authDomain,n,"auth-domain-config-required"),Lt(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Fv,eventId:i};if(e instanceof oee){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",ffe(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,h]of Object.entries({}))a[c]=h}if(e instanceof ZS){const c=e.getScopes().filter(h=>h!=="");c.length>0&&(a.scopes=c.join(","))}n.tenantId&&(a.tid=n.tenantId);const o=a;for(const c of Object.keys(o))o[c]===void 0&&delete o[c];const l=await n._getAppCheckToken(),u=l?`#${zbe}=${encodeURIComponent(l)}`:"";return`${$be(n)}?${FS(o).slice(1)}${u}`}function $be({config:n}){return n.emulator?_4(n,Vbe):`https://${n.authDomain}/${Ube}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fI="webStorageSupport";class Hbe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=mee,this._completeRedirectFn=fbe,this._overrideRedirectResult=cbe}async _openPopup(e,t,r,i){var a;fd((a=this.eventManagers[e._key()])==null?void 0:a.manager,"_initialize() not called before _openPopup()");const s=await V8(e,t,r,xL(),i);return kbe(e,s,M4())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await V8(e,t,r,xL(),i);return qxe(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(fd(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await Rbe(e),r=new mbe(e);return t.register("authEvent",i=>(Lt(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(fI,{type:fI},i=>{var a;const s=(a=i==null?void 0:i[0])==null?void 0:a[fI];s!==void 0&&t(!!s),mu(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=bbe(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return nee()||YJ()||E4()}}const Gbe=Hbe;var z8="@firebase/auth",$8="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jbe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Lt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qbe(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Wbe(n){bv(new wp("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;Lt(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ree(n)},u=new fxe(r,i,s,l);return Exe(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),bv(new wp("auth-internal",e=>{const t=Uv(e.getProvider("auth").getImmediate());return(r=>new jbe(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),fc(z8,$8,qbe(n)),fc(z8,$8,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xbe=5*60,Kbe=$K("authIdTokenMaxAge")||Xbe;let H8=null;const Ybe=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>Kbe)return;const i=t==null?void 0:t.token;H8!==i&&(H8=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Qbe(n=EB()){const e=q2(n,"auth");if(e.isInitialized())return e.getImmediate();const t=wxe(n,{popupRedirectResolver:Gbe,persistence:[tbe,T4,mee]}),r=$K("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const a=Ybe(s.toString());zxe(t,a,()=>a(t.currentUser)),Vxe(t,o=>a(o))}}const i=UK("auth");return i&&Sxe(t,`http://${i}`),t}function Zbe(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}pxe({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=yc("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",Zbe().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Wbe("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wee="firebasestorage.googleapis.com",Jbe="storageBucket",e_e=2*60*1e3,t_e=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ic extends Rc{constructor(e,t,r=0){super(pI(e),`Firebase Storage: ${t} (${pI(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ic.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return pI(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Sc;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Sc||(Sc={}));function pI(n){return"storage/"+n}function n_e(){const n="An unknown error occurred, please check the error payload for server response.";return new Ic(Sc.UNKNOWN,n)}function r_e(){return new Ic(Sc.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function i_e(){return new Ic(Sc.CANCELED,"User canceled the upload/download.")}function s_e(n){return new Ic(Sc.INVALID_URL,"Invalid URL '"+n+"'.")}function a_e(n){return new Ic(Sc.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function G8(n){return new Ic(Sc.INVALID_ARGUMENT,n)}function Eee(){return new Ic(Sc.APP_DELETED,"The Firebase app was deleted.")}function o_e(n){return new Ic(Sc.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=ou.makeFromUrl(e,t)}catch{return new ou(e,"")}if(r.path==="")return r;throw a_e(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(w){w.path.charAt(w.path.length-1)==="/"&&(w.path_=w.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function u(w){w.path_=decodeURIComponent(w.path)}const c="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",f=new RegExp(`^https?://${h}/${c}/b/${i}/o${d}`,"i"),p={bucket:1,path:3},m=t===wee?"(?:storage.googleapis.com|storage.cloud.google.com)":t,y="([^?#]*)",v=new RegExp(`^https?://${m}/${i}/${y}`,"i"),x=[{regex:o,indices:l,postModify:s},{regex:f,indices:p,postModify:u},{regex:v,indices:{bucket:1,path:2},postModify:u}];for(let w=0;w<x.length;w++){const _=x[w],E=_.regex.exec(e);if(E){const A=E[_.indices.bucket];let T=E[_.indices.path];T||(T=""),r=new ou(A,T),_.postModify(r);break}}if(r==null)throw s_e(e);return r}}class l_e{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u_e(n,e,t){let r=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let u=!1;function c(...y){u||(u=!0,e.apply(null,y))}function h(y){i=setTimeout(()=>{i=null,n(f,l())},y)}function d(){s&&clearTimeout(s)}function f(y,...v){if(u){d();return}if(y){d(),c.call(null,y,...v);return}if(l()||a){d(),c.call(null,y,...v);return}r<64&&(r*=2);let x;o===1?(o=2,x=0):x=(r+Math.random())*1e3,h(x)}let p=!1;function m(y){p||(p=!0,d(),!u&&(i!==null?(y||(o=2),clearTimeout(i),h(0)):y||(o=1)))}return h(0),s=setTimeout(()=>{a=!0,m(!0)},t),m}function c_e(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h_e(n){return n!==void 0}function j8(n,e,t,r){if(r<e)throw G8(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw G8(`Invalid value for '${n}'. Expected ${t} or less.`)}function d_e(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var ED;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(ED||(ED={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f_e(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_e{constructor(e,t,r,i,s,a,o,l,u,c,h,d=!0,f=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=c,this.connectionFactory_=h,this.retry=d,this.isUsingEmulator=f,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,m)=>{this.resolve_=p,this.reject_=m,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new oT(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,u=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===ED.NO_ERROR,l=s.getStatus();if(!o||f_e(l,this.additionalRetryCodes_)&&this.retry){const c=s.getErrorCode()===ED.ABORT;r(!1,new oT(!1,null,c));return}const u=this.successCodes_.indexOf(l)!==-1;r(!0,new oT(u,s))})},t=(r,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());h_e(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=n_e();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?Eee():i_e();a(l)}else{const l=r_e();a(l)}};this.canceled_?t(!1,new oT(!1,null,!0)):this.backoffId_=u_e(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&c_e(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class oT{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function m_e(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function g_e(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function v_e(n,e){e&&(n["X-Firebase-GMPID"]=e)}function y_e(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function x_e(n,e,t,r,i,s,a=!0,o=!1){const l=d_e(n.urlParams),u=n.url+l,c=Object.assign({},n.headers);return v_e(c,e),m_e(c,t),g_e(c,s),y_e(c,r),new p_e(u,n.method,c,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,a,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b_e(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function __e(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{constructor(e,t){this._service=e,t instanceof ou?this._location=t:this._location=ou.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new SD(e,t)}get root(){const e=new ou(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return __e(this._location.path)}get storage(){return this._service}get parent(){const e=b_e(this._location.path);if(e===null)return null;const t=new ou(this._location.bucket,e);return new SD(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw o_e(e)}}function q8(n,e){const t=e==null?void 0:e[Jbe];return t==null?null:ou.makeFromBucketSpec(t,n)}function w_e(n,e,t,r={}){n.host=`${e}:${t}`;const i=Pv(e);i&&(xB(`https://${n.host}/b`),bB("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:HK(s,n.app.options.projectId))}class E_e{constructor(e,t,r,i,s,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=a,this._bucket=null,this._host=wee,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=e_e,this._maxUploadRetryTime=t_e,this._requests=new Set,i!=null?this._bucket=ou.makeFromBucketSpec(i,this._host):this._bucket=q8(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ou.makeFromBucketSpec(this._url,e):this._bucket=q8(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){j8("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){j8("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Po(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new SD(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new l_e(Eee());{const a=x_e(e,this._appId,r,i,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const W8="@firebase/storage",X8="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const See="storage";function S_e(n=EB(),e){n=Oi(n);const r=q2(n,See).getImmediate({identifier:e}),i=VK("storage");return i&&A_e(r,...i),r}function A_e(n,e,t,r={}){w_e(n,e,t,r)}function T_e(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new E_e(t,r,i,e,Fv)}function M_e(){bv(new wp(See,T_e,"PUBLIC").setMultipleInstances(!0)),fc(W8,X8,""),fc(W8,X8,"esm2020")}M_e();const C_e={apiKey:"AIzaSyCuCYH38ZqKbtPYPR2ED1nMdD6yBuo1ReA",authDomain:"shop-d542c.firebaseapp.com",projectId:"shop-d542c",storageBucket:"shop-d542c.firebasestorage.app",messagingSenderId:"592347281413",appId:"1:592347281413:web:ed7c8752b195dcbb02846c",measurementId:"G-DFV2PBV8X2"},D4=qK(C_e),AD=Qbe(D4),Qs=bve(D4);S_e(D4);const D_e={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},N_e=15;function R_e(){const[n,e]=xe.useState(null),[t,r]=xe.useState(!1),[i,s]=xe.useState(null),[a,o]=xe.useState(null),[l,u]=xe.useState(""),[c,h]=xe.useState(""),[d,f]=xe.useState("idle"),[p,m]=xe.useState([]),[y,v]=xe.useState(!0),b=xp();xe.useEffect(()=>{const A=hd(Qs,"paperSummaries"),T=$S(A,l4("createdAt","desc"),Nve(15)),S=Fve(T,M=>{const D=M.docs.map(N=>({id:N.id,...N.data()}));m(D),v(!1)},M=>{console.error("   :",M),v(!1)});return()=>S()},[]);const x=A=>A?A.toDate?A.toDate().toLocaleString("ko-KR",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):new Date(A).toLocaleString("ko-KR",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):" ",w=A=>{var S;const T=(S=A.target.files)==null?void 0:S[0];T&&(T.type==="application/pdf"?(e(T),u(T.name.replace(".pdf","")),o(null)):(o("PDF   ."),e(null)))},_=async()=>{if(!n){o("PDF  .");return}r(!0),o(null),s(null);try{const A=await Lye(n);if(!A||A.trim().length<100)throw new Error("   .  PDF .");const T=await Bye(A);s(T.summary),h(T.method)}catch(A){o(A.message||"    ."),console.error(" :",A)}finally{r(!1)}},E=async()=>{if(!i){o("  .");return}if(!(b!=null&&b.email)){o("  .");return}try{f("loading"),await pN(hd(Qs,"paperSummaries"),{title:l||"  ",summary:i,method:c,authorEmail:b.email,authorName:b.username||b.email.split("@")[0],createdAt:Wh(),publishedAt:new Date().toISOString()}),f("success"),setTimeout(()=>f("idle"),2500)}catch(A){console.error("  :",A),o("    ."),f("error"),setTimeout(()=>f("idle"),3e3)}};return k.jsx("div",{className:"min-h-screen bg-white dark:bg-dark-50 pt-24 pb-12",children:k.jsxs(ct.div,{className:"max-w-4xl mx-auto px-4",variants:D_e,initial:"hidden",animate:"visible",children:[k.jsx("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-2",children:"   AI"}),k.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"PDF   AI   ."}),k.jsxs(ct.div,{className:"bg-gray-50 dark:bg-dark-100 rounded-lg p-8 mb-8 border-2 border-dashed border-blue-400",whileHover:{scale:1.02},children:[k.jsxs("div",{className:"text-center",children:[k.jsx("input",{type:"file",accept:".pdf",onChange:w,className:"hidden",id:"pdf-upload"}),k.jsxs("label",{htmlFor:"pdf-upload",className:"cursor-pointer block",children:[k.jsx("div",{className:"text-6xl mb-4",children:""}),k.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"PDF    "}),k.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["( ",N_e," )"]})]})]}),n&&k.jsx("div",{className:"mt-6 p-4 bg-blue-100 dark:bg-blue-900/30 rounded-lg border border-blue-400",children:k.jsxs("p",{className:"text-blue-900 dark:text-blue-100",children:[" : ",k.jsx("strong",{children:n.name})]})})]}),k.jsxs("div",{className:"flex gap-4 mb-8",children:[k.jsx(ct.button,{onClick:_,disabled:!n||t,whileHover:{scale:1.05},whileTap:{scale:.95},className:"flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-bold py-3 px-6 rounded-lg transition",children:t?"   ...":" AI "}),k.jsx(ct.button,{onClick:()=>{e(null),u(""),s(null),o(null)},whileHover:{scale:1.05},className:"bg-gray-400 hover:bg-gray-500 text-white font-bold py-3 px-6 rounded-lg transition",children:" "})]}),a&&k.jsxs(ct.div,{className:"bg-red-100 dark:bg-red-900/30 border border-red-400 text-red-700 dark:text-red-200 px-6 py-4 rounded-lg mb-8",initial:{opacity:0},animate:{opacity:1},children:[k.jsx("strong",{children:":"})," ",a]}),i&&k.jsxs(ct.div,{className:"bg-green-50 dark:bg-green-900/20 border-l-4 border-green-500 p-6 rounded-lg",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[k.jsxs("div",{className:"flex items-center mb-4",children:[k.jsx("span",{className:"text-2xl mr-3",children:""}),k.jsxs("div",{children:[k.jsx("h3",{className:"font-bold text-gray-900 dark:text-white",children:l}),k.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[": ",c==="AI"?" AI  (Hugging Face)":"   "]})]})]}),k.jsx("div",{className:"bg-white dark:bg-dark-100 p-4 rounded-lg",children:k.jsx("p",{className:"text-gray-800 dark:text-gray-200 leading-relaxed",children:i})}),k.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[k.jsx(ct.button,{onClick:()=>{const A=document.createElement("a");A.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(i)),A.setAttribute("download",`${l}_summary.txt`),A.style.display="none",document.body.appendChild(A),A.click(),document.body.removeChild(A)},whileHover:{scale:1.05},className:"bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded transition text-sm",children:"  "}),k.jsx(ct.button,{onClick:()=>{navigator.clipboard.writeText(i),alert(" !")},whileHover:{scale:1.05},className:"bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded transition text-sm",children:" "}),k.jsx(ct.button,{onClick:E,disabled:d==="loading"||!i,whileHover:{scale:i?1.05:1},className:`py-2 px-4 rounded transition text-sm font-semibold ${d==="success"?"bg-emerald-600 text-white":d==="loading"?"bg-gray-400 text-gray-100":"bg-purple-600 hover:bg-purple-700 text-white"}`,children:d==="success"?"  ":d==="loading"?" ...":"  "})]}),!b&&k.jsx("p",{className:"text-xs text-yellow-600 mt-2",children:"     ."})]}),k.jsxs(ct.div,{className:"mt-12 bg-gray-50 dark:bg-dark-100 rounded-lg p-6 border border-gray-200 dark:border-gray-800",initial:{opacity:0},animate:{opacity:1},children:[k.jsxs("div",{className:"flex items-center justify-between mb-4",children:[k.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"   "}),k.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:" 15 "})]}),y?k.jsx("p",{className:"text-sm text-gray-500",children:"  ..."}):p.length===0?k.jsx("p",{className:"text-sm text-gray-500",children:"   .   !"}):k.jsx("div",{className:"space-y-4",children:p.map(A=>k.jsxs("div",{className:"p-4 rounded-2xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-dark-200",children:[k.jsxs("div",{className:"flex items-start justify-between gap-4",children:[k.jsxs("div",{children:[k.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:A.title}),k.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[A.authorName||" ","  ",x(A.createdAt||A.publishedAt)]})]}),k.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-200",children:A.method==="AI"?"AI ":"Rule "})]}),k.jsx("p",{className:"mt-3 text-sm text-gray-700 dark:text-gray-200 leading-relaxed whitespace-pre-wrap",children:A.summary})]},A.id))})]}),k.jsxs(ct.div,{className:"mt-12 bg-blue-50 dark:bg-blue-900/20 p-6 rounded-lg border border-blue-200 dark:border-blue-800",initial:{opacity:0},whileInView:{opacity:1},children:[k.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"  "}),k.jsxs("ol",{className:"space-y-2 text-gray-700 dark:text-gray-300",children:[k.jsxs("li",{children:[k.jsx("strong",{children:"1."}),"   PDF  "]}),k.jsxs("li",{children:[k.jsx("strong",{children:"2."}),' "AI "  ']}),k.jsxs("li",{children:[k.jsx("strong",{children:"3."})," AI    "]}),k.jsxs("li",{children:[k.jsx("strong",{children:"4."}),"      "]})]}),k.jsx("div",{className:"mt-4 p-4 bg-yellow-50 dark:bg-yellow-900/30 rounded border border-yellow-200 dark:border-yellow-800",children:k.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[" ",k.jsx("strong",{children:":"})," PDF   5 .       ."]})})]})]})})}function I_e(){var x;const[n,e]=xe.useState([]),[t,r]=xe.useState(!0),[i,s]=xe.useState(""),[a,o]=xe.useState(null),[l,u]=xe.useState({title:"",category:((x=A0[0])==null?void 0:x.id)??1,content:""}),[c,h]=xe.useState(!1),[d,f]=xe.useState(!1),p=xp(),m=w=>w?typeof w=="string"?w:w.toDate?w.toDate().toLocaleDateString("ko-KR"):w instanceof Date?w.toLocaleDateString("ko-KR"):new Date(w).toLocaleDateString("ko-KR"):"",y=xe.useCallback(async()=>{r(!0),s("");try{const w=$S(hd(Qs,"forumPosts"),l4("createdAt","desc")),E=(await fN(w)).docs.map(A=>{var S;const T=A.data();return{id:A.id,...T,createdAt:(S=T.createdAt)!=null&&S.toDate?T.createdAt.toDate():T.createdAt||new Date,replies:T.replies??0}});e(E)}catch(w){console.error("  :",w),s("  .    .")}finally{r(!1)}},[]);xe.useEffect(()=>{y()},[y]);const v=async w=>{var _;if(w.preventDefault(),!l.title.trim()||!l.content.trim()){alert("  .");return}f(!0);try{const E=(p==null?void 0:p.username)||(p==null?void 0:p.email)||" ",A={title:l.title.trim(),content:l.content.trim(),category:Number(l.category),author:E,authorEmail:(p==null?void 0:p.email)||null,replies:0,createdAt:Wh(),updatedAt:Wh()},T=await pN(hd(Qs,"forumPosts"),A);console.log("   :",T.id);const S={id:T.id,...A,createdAt:new Date};e(M=>[S,...M]),u({title:"",category:((_=A0[0])==null?void 0:_.id)??1,content:""}),h(!1),alert(" .")}catch(E){console.error("   :",E),console.error(" :",E.code),console.error(" :",E.message),alert("  : "+E.message)}finally{f(!1)}},b=a?n.filter(w=>w.category===a):n;return k.jsxs("div",{className:"space-y-8 sm:space-y-12",children:[k.jsxs("div",{children:[k.jsx("h1",{className:"text-3xl sm:text-4xl font-bold mb-4 text-gray-900 dark:text-white",children:" "}),k.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm sm:text-base",children:" ,  ,  ,        ."})]}),k.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[k.jsx("button",{onClick:()=>h(!c),className:"w-full sm:w-auto px-6 py-3 bg-blue-600 dark:bg-blue-600 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-700 transition font-medium text-sm sm:text-base",children:c?"":"  "}),k.jsx("button",{onClick:y,className:"w-full sm:w-auto px-6 py-3 border border-gray-300 dark:border-gray-600 rounded-lg text-sm sm:text-base font-medium hover:bg-gray-100 dark:hover:bg-gray-800",children:""})]}),c&&k.jsxs("form",{onSubmit:v,className:"bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 sm:p-6 rounded-lg space-y-4",children:[k.jsxs("div",{children:[k.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium",children:""}),k.jsx("input",{type:"text",value:l.title,onChange:w=>u({...l,title:w.target.value}),className:"w-full bg-gray-50 dark:bg-dark-200 border border-gray-300 dark:border-dark-300 px-4 py-2 rounded text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400",placeholder:" "})]}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium",children:""}),k.jsx("select",{value:l.category,onChange:w=>u({...l,category:parseInt(w.target.value)}),className:"w-full bg-gray-50 dark:bg-dark-200 border border-gray-300 dark:border-dark-300 px-4 py-2 rounded text-gray-900 dark:text-white",children:A0.map(w=>k.jsx("option",{value:w.id,children:w.name},w.id))})]}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium",children:""}),k.jsx("textarea",{rows:"6",value:l.content,onChange:w=>u({...l,content:w.target.value}),className:"w-full bg-gray-50 dark:bg-dark-200 border border-gray-300 dark:border-dark-300 px-4 py-2 rounded text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 resize-none",placeholder:" "})]}),k.jsx("button",{type:"submit",disabled:d,className:"w-full bg-green-600 dark:bg-green-600 hover:bg-green-700 dark:hover:bg-green-700 disabled:bg-gray-500 text-white px-6 py-2 rounded font-bold transition text-sm sm:text-base",children:d?" ...":""})]}),k.jsxs("div",{className:"flex flex-wrap gap-2",children:[k.jsx("button",{onClick:()=>o(null),className:`px-3 sm:px-4 py-2 rounded transition text-sm sm:text-base ${a===null?"bg-blue-600 text-white":"bg-gray-200 dark:bg-dark-300 text-gray-900 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-dark-200"}`,children:""}),A0.map(w=>k.jsx("button",{onClick:()=>o(w.id),className:`px-3 sm:px-4 py-2 rounded transition text-sm sm:text-base ${a===w.id?"bg-blue-600 text-white":"bg-gray-200 dark:bg-dark-300 text-gray-900 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-dark-200"}`,children:w.name},w.id))]}),k.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[t&&k.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"  ..."}),!t&&b.length===0&&k.jsx("div",{className:"text-center py-10 text-gray-500 dark:text-gray-400 border border-dashed rounded-lg",children:"   ."}),!t&&b.map(w=>{var _;return k.jsx(hr,{to:`/forum/${w.id}`,state:{post:w},children:k.jsx("div",{className:"bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 sm:p-6 rounded-lg hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-md transition cursor-pointer",children:k.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-2",children:[k.jsxs("div",{className:"flex-1 min-w-0",children:[k.jsx("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:k.jsx("span",{className:"text-xs bg-gray-200 dark:bg-dark-300 text-gray-700 dark:text-gray-300 px-2 py-1 rounded",children:((_=A0.find(E=>E.id===w.category))==null?void 0:_.name)||""})}),k.jsx("h3",{className:"text-base sm:text-lg font-bold text-blue-600 dark:text-blue-400 break-words",children:w.title}),k.jsx("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400 mt-2 line-clamp-2",children:w.content}),k.jsxs("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 mt-2",children:[w.author,"  ",m(w.createdAt)]})]}),k.jsxs("span",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 whitespace-nowrap",children:[" ",w.replies??0]})]})})},w.id)})]}),i&&k.jsx("p",{className:"text-sm text-red-500",children:i})]})}function P_e(){var x,w,_;const{postId:n}=QW();Fb();const e=Pb(),{isDark:t}=Nl(),r=xp(),[i,s]=xe.useState(((x=e.state)==null?void 0:x.post)||null),[a,o]=xe.useState(!((w=e.state)!=null&&w.post)),[l,u]=xe.useState([]),[c,h]=xe.useState(""),[d,f]=xe.useState(""),p=E=>E?typeof E=="string"?E:E.toDate?E.toDate().toLocaleDateString("ko-KR"):E instanceof Date?E.toLocaleDateString("ko-KR"):new Date(E).toLocaleDateString("ko-KR"):"",m=xe.useCallback(async()=>{var E;o(!0);try{const A=Dp(Qs,"forumPosts",n),T=await TQ(A);if(T.exists()){const S=T.data();s({id:T.id,...S,createdAt:(E=S.createdAt)!=null&&E.toDate?S.createdAt.toDate():S.createdAt||new Date})}else s(null)}catch(A){console.error("  :",A),s(null)}finally{o(!1)}},[n]),y=xe.useCallback(async()=>{try{const E=hd(Qs,"forumPosts",n,"replies"),A=$S(E,l4("createdAt","asc")),S=(await fN(A)).docs.map(M=>{var N;const D=M.data();return{id:M.id,...D,createdAt:(N=D.createdAt)!=null&&N.toDate?D.createdAt.toDate():D.createdAt||new Date}});u(S)}catch(E){console.error("  :",E)}},[n]);xe.useEffect(()=>{var E;(E=e.state)!=null&&E.post||m()},[m,(_=e.state)==null?void 0:_.post]),xe.useEffect(()=>{y()},[y]);const v=async E=>{if(E.preventDefault(),f(""),!c.trim()){f(" .");return}try{const A=hd(Qs,"forumPosts",n,"replies"),S={author:(r==null?void 0:r.username)||(r==null?void 0:r.email)||" ",authorEmail:(r==null?void 0:r.email)||null,content:c.trim(),likes:0,createdAt:Wh()},D={id:(await pN(A,S)).id,...S,createdAt:new Date};u(R=>[...R,D]),h("");const N=Dp(Qs,"forumPosts",n);await MQ(N,{replies:Lve(1),updatedAt:Wh()}),s(R=>R&&{...R,replies:(R.replies||0)+1})}catch(A){console.error("  :",A),f("  .    .")}};if(a)return k.jsx("div",{className:`text-center py-12 ${t?"text-gray-300":"text-gray-700"}`,children:"  ..."});if(!i)return k.jsxs("div",{className:"text-center py-12",children:[k.jsx("h1",{className:`text-2xl font-bold mb-4 ${t?"text-white":"text-gray-900"}`,children:"   ."}),k.jsx(hr,{to:"/forum",className:"text-blue-600 hover:text-blue-700 font-medium",children:" "})]});const b=A0.find(E=>E.id===(i==null?void 0:i.category));return k.jsxs("div",{className:"space-y-8",children:[k.jsxs(ct.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[k.jsx(hr,{to:"/forum",className:`inline-flex items-center gap-2 mb-4 transition ${t?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"}`,children:"  "}),k.jsxs("div",{className:`p-6 rounded-lg border ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[k.jsx("div",{className:"mb-3",children:k.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-medium ${t?"bg-blue-900 text-blue-300":"bg-blue-100 text-blue-700"}`,children:b==null?void 0:b.name})}),k.jsx("h1",{className:`text-3xl sm:text-4xl font-bold mb-4 ${t?"text-white":"text-gray-900"}`,children:i.title}),k.jsxs("div",{className:`flex flex-wrap gap-4 mb-6 pb-6 border-b ${t?"border-gray-700 text-gray-300":"border-gray-200 text-gray-600"} text-sm`,children:[k.jsxs("div",{children:[k.jsx("span",{className:"font-medium",children:":"})," ",i.author]}),k.jsxs("div",{children:[k.jsx("span",{className:"font-medium",children:":"})," ",p(i.createdAt)]}),k.jsxs("div",{children:[k.jsx("span",{className:"font-medium",children:":"})," ",i.replies||l.length,""]}),k.jsxs("div",{children:[k.jsx("span",{className:"font-medium",children:":"})," ",i.views||0,""]})]}),k.jsx("div",{className:`prose prose-sm ${t?"prose-invert":""} max-w-none mb-8`,children:k.jsx("div",{className:`${t?"text-gray-200":"text-gray-700"} leading-7 whitespace-pre-wrap`,children:i.content})})]})]}),k.jsxs(ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:`p-6 rounded-lg border ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[k.jsx("h2",{className:`text-xl font-bold mb-4 ${t?"text-white":"text-gray-900"}`,children:" "}),k.jsxs("form",{onSubmit:v,className:"space-y-4",children:[k.jsx("textarea",{value:c,onChange:E=>h(E.target.value),placeholder:" ...",rows:"4",className:`w-full px-4 py-3 rounded-lg border focus:outline-none focus:ring-2 focus:ring-blue-500 ${t?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`}),d&&k.jsx("p",{className:"text-sm text-red-400",children:d}),k.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium",children:" "})]})]}),k.jsxs(ct.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},className:"space-y-4",children:[k.jsxs("h2",{className:`text-2xl font-bold ${t?"text-white":"text-gray-900"}`,children:[" ",l.length,""]}),l.map(E=>k.jsxs(ct.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:`p-4 rounded-lg border ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[k.jsxs("div",{className:`flex justify-between items-start mb-2 ${t?"text-gray-300":"text-gray-600"} text-sm`,children:[k.jsxs("div",{children:[k.jsx("span",{className:"font-medium",children:E.author}),k.jsx("span",{className:"ml-4",children:p(E.createdAt)})]}),k.jsxs("button",{className:`transition ${t?"text-gray-400 hover:text-gray-200":"text-gray-400 hover:text-gray-600"}`,children:[" ",E.likes]})]}),k.jsx("p",{className:`${t?"text-gray-200":"text-gray-700"} leading-6`,children:E.content})]},E.id))]})]})}function F_e(){const[n,e]=xe.useState(""),t=z6.filter(r=>r.term.toLowerCase().includes(n.toLowerCase())||r.definition.toLowerCase().includes(n.toLowerCase()));return k.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[k.jsxs("div",{children:[k.jsx("h1",{className:"text-3xl sm:text-4xl font-bold mb-4 text-gray-900 dark:text-white",children:" "}),k.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm sm:text-base mb-6",children:"      ."}),k.jsx("input",{type:"search",placeholder:"   ...",value:n,onChange:r=>e(r.target.value),className:"w-full max-w-md bg-gray-50 dark:bg-dark-200 border border-gray-300 dark:border-dark-300 px-4 py-2 rounded text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 text-sm sm:text-base"})]}),k.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[t.map((r,i)=>k.jsxs("div",{className:"bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 sm:p-6 rounded-lg hover:shadow-md transition",children:[k.jsx("h3",{className:"text-base sm:text-lg font-bold text-blue-600 dark:text-blue-400 mb-2",children:r.term}),k.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm sm:text-base",children:r.definition})]},i)),t.length===0&&k.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400 py-8 text-sm sm:text-base",children:"  ."})]}),k.jsxs("div",{className:"bg-gray-100 dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 rounded-lg text-center text-gray-600 dark:text-gray-400 text-sm sm:text-base",children:[" ",z6.length,"   ",t.length,"  "]})]})}function L_e(){return k.jsxs("div",{className:"space-y-8 sm:space-y-12",children:[k.jsxs("div",{children:[k.jsx("h1",{className:"text-3xl sm:text-4xl font-bold mb-4 text-gray-900 dark:text-white",children:" "}),k.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm sm:text-base",children:"    , ,  ."})]}),k.jsxs("section",{children:[k.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-6 text-gray-900 dark:text-white",children:" "}),k.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:qR.textbooks.map((n,e)=>k.jsxs("div",{className:"bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 sm:p-6 rounded-lg hover:shadow-md transition",children:[k.jsx("h3",{className:"text-base sm:text-lg font-bold text-blue-600 dark:text-blue-400 mb-1",children:n.title}),k.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400",children:[n.authors," (",n.year,")"]})]},e))})]}),k.jsxs("section",{children:[k.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-6 text-gray-900 dark:text-white",children:"  "}),k.jsx("div",{className:"space-y-3 sm:space-y-4",children:qR.databases.map((n,e)=>k.jsxs("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",className:"block bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 sm:p-6 rounded-lg hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-md transition",children:[k.jsx("h3",{className:"text-base sm:text-lg font-bold text-blue-600 dark:text-blue-400",children:n.name}),k.jsx("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400",children:n.desc}),k.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-2 break-all",children:n.url})]},e))})]}),k.jsxs("section",{children:[k.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-6 text-gray-900 dark:text-white",children:"   "}),k.jsx("div",{className:"space-y-3 sm:space-y-4",children:qR.tools.map((n,e)=>k.jsxs("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",className:"block bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 sm:p-6 rounded-lg hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-md transition",children:[k.jsx("h3",{className:"text-base sm:text-lg font-bold text-blue-600 dark:text-blue-400",children:n.name}),k.jsx("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400",children:n.desc}),k.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-2 break-all",children:n.url})]},e))})]})]})}function O_e(){const{isDark:n}=Nl(),e=xp(),[t,r]=xe.useState({username:"",email:"",affiliation:"",bio:""}),[i,s]=xe.useState(!1),[a,o]=xe.useState(!0),[l,u]=xe.useState(!1),[c,h]=xe.useState("");xe.useEffect(()=>{if(!(e!=null&&e.email)){o(!1);return}(async()=>{try{const m=Dp(Qs,"profiles",e.email),y=await TQ(m),v={username:e.username||"",email:e.email,affiliation:"",bio:""};y.exists()?(r({...v,...y.data()}),console.log(" Firestore  :",e.email)):(r(v),console.log("   (Firestore )"))}catch(m){console.error(" Firestore  :",m),r({username:e.username,email:e.email||"",affiliation:"",bio:""})}finally{o(!1)}})()},[e==null?void 0:e.email,e==null?void 0:e.username]);const d=p=>{const{name:m,value:y}=p.target;r(v=>({...v,[m]:y}))},f=async p=>{p.preventDefault(),u(!0);try{await Pve(Dp(Qs,"profiles",e.email),{username:t.username,email:t.email,affiliation:t.affiliation,bio:t.bio,updatedAt:Wh()}),console.log(" Firestore :",e.email),h("  ."),s(!1),setTimeout(()=>h(""),3e3)}catch(m){console.error("  :",m.code,m.message),h("  : "+m.message)}finally{u(!1)}};return e?a?k.jsx("div",{className:`text-center py-12 ${n?"text-gray-400":"text-gray-600"}`,children:"   ..."}):k.jsxs("div",{className:"max-w-2xl mx-auto",children:[k.jsx("h1",{className:`text-3xl font-bold mb-8 ${n?"text-white":"text-gray-900"}`,children:""}),c&&k.jsx("div",{className:`mb-4 p-4 rounded-lg ${c.includes("")?"bg-red-50 text-red-700 dark:bg-red-900 dark:text-red-200":"bg-green-50 text-green-700 dark:bg-green-900 dark:text-green-200"}`,children:c}),k.jsxs("div",{className:`rounded-lg p-8 ${n?"bg-gray-800":"bg-white"} border ${n?"border-gray-700":"border-gray-200"}`,children:[k.jsxs("div",{className:"flex justify-between items-center mb-6",children:[k.jsx("h2",{className:`text-xl font-bold ${n?"text-white":"text-gray-900"}`,children:" "}),k.jsx("button",{onClick:()=>s(!i),className:`px-4 py-2 rounded-lg transition ${n?"bg-blue-600 hover:bg-blue-700":"bg-blue-500 hover:bg-blue-600"} text-white`,children:i?"":""})]}),i?k.jsxs("form",{onSubmit:f,className:"space-y-4",children:[k.jsxs("div",{children:[k.jsx("label",{className:`block text-sm font-medium mb-2 ${n?"text-gray-300":"text-gray-700"}`,children:""}),k.jsx("input",{type:"text",name:"username",value:t.username,onChange:d,className:`w-full px-4 py-2 border rounded-lg ${n?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),k.jsxs("div",{children:[k.jsx("label",{className:`block text-sm font-medium mb-2 ${n?"text-gray-300":"text-gray-700"}`,children:""}),k.jsx("input",{type:"email",name:"email",value:t.email,onChange:d,disabled:!0,className:`w-full px-4 py-2 border rounded-lg opacity-50 cursor-not-allowed ${n?"bg-gray-700 border-gray-600 text-gray-400":"bg-gray-100 border-gray-300 text-gray-600"}`})]}),k.jsxs("div",{children:[k.jsx("label",{className:`block text-sm font-medium mb-2 ${n?"text-gray-300":"text-gray-700"}`,children:" "}),k.jsx("input",{type:"text",name:"affiliation",value:t.affiliation,onChange:d,placeholder:",  ",className:`w-full px-4 py-2 border rounded-lg ${n?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),k.jsxs("div",{children:[k.jsx("label",{className:`block text-sm font-medium mb-2 ${n?"text-gray-300":"text-gray-700"}`,children:""}),k.jsx("textarea",{name:"bio",value:t.bio,onChange:d,placeholder:" ...",rows:"4",className:`w-full px-4 py-2 border rounded-lg ${n?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),k.jsx("button",{type:"submit",disabled:l,className:`w-full py-2 px-4 rounded-lg font-medium text-white transition ${l?"bg-blue-400 cursor-not-allowed opacity-50":"bg-blue-600 hover:bg-blue-700"}`,children:l?" ...":""})]}):k.jsxs("div",{className:"space-y-4",children:[k.jsxs("div",{children:[k.jsx("p",{className:`text-sm ${n?"text-gray-400":"text-gray-500"}`,children:""}),k.jsx("p",{className:`text-lg font-medium ${n?"text-white":"text-gray-900"}`,children:t.username})]}),k.jsxs("div",{children:[k.jsx("p",{className:`text-sm ${n?"text-gray-400":"text-gray-500"}`,children:""}),k.jsx("p",{className:`text-lg font-medium ${n?"text-white":"text-gray-900"}`,children:t.email})]}),k.jsxs("div",{children:[k.jsx("p",{className:`text-sm ${n?"text-gray-400":"text-gray-500"}`,children:" "}),k.jsx("p",{className:`text-lg font-medium ${n?"text-white":"text-gray-900"}`,children:t.affiliation||""})]}),k.jsxs("div",{children:[k.jsx("p",{className:`text-sm ${n?"text-gray-400":"text-gray-500"}`,children:""}),k.jsx("p",{className:`text-lg font-medium ${n?"text-white":"text-gray-900"}`,children:t.bio||""})]}),k.jsx("hr",{className:n?"border-gray-700":"border-gray-200"}),k.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4",children:[k.jsxs(hr,{to:"/bookmarks",className:`p-4 rounded-lg border text-center transition hover:shadow-md ${n?"bg-gray-700 border-gray-600 text-gray-200 hover:bg-gray-600":"bg-gray-50 border-gray-200 text-gray-700 hover:bg-gray-100"}`,children:[k.jsx("p",{className:"text-2xl mb-1",children:""}),k.jsx("p",{className:"font-semibold",children:""})]}),k.jsxs(hr,{to:"/notes",className:`p-4 rounded-lg border text-center transition hover:shadow-md ${n?"bg-gray-700 border-gray-600 text-gray-200 hover:bg-gray-600":"bg-gray-50 border-gray-200 text-gray-700 hover:bg-gray-100"}`,children:[k.jsx("p",{className:"text-2xl mb-1",children:""}),k.jsx("p",{className:"font-semibold",children:""})]})]})]})]})]}):k.jsx("div",{className:`text-center py-12 ${n?"text-gray-400":"text-gray-600"}`,children:"   ."})}function k_e(){const{isDark:n}=Nl(),e=xp(),[t,r]=xe.useState([]),[i,s]=xe.useState(!0),[a,o]=xe.useState("");xe.useEffect(()=>{if(!(e!=null&&e.email)){s(!1);return}l()},[e==null?void 0:e.email]);const l=async()=>{try{const c=$S(hd(Qs,"bookmarks"),EQ("userEmail","==",e.email)),d=(await fN(c)).docs.map(f=>({id:f.id,...f.data()}));r(d),console.log("  :",e.email,":",d.length)}catch(c){console.error("   :",c),o("   .")}finally{s(!1)}},u=async c=>{try{const h=Dp(Qs,"bookmarks",c);await CQ(h),r(d=>d.filter(f=>f.id!==c)),console.log("  :",c)}catch(h){o(h.message)}};return k.jsxs("div",{className:"max-w-4xl mx-auto",children:[k.jsx("h1",{className:`text-3xl font-bold mb-8 ${n?"text-white":"text-gray-900"}`,children:""}),a&&k.jsx("div",{className:`mb-4 p-4 rounded-lg ${n?"bg-red-900 text-red-200 border border-red-700":"bg-red-50 text-red-700 border border-red-200"}`,children:a}),i?k.jsx("div",{className:`text-center py-12 ${n?"text-gray-400":"text-gray-600"}`,children:" ..."}):t.length===0?k.jsxs("div",{className:`text-center py-12 ${n?"text-gray-400":"text-gray-600"}`,children:[k.jsx("p",{className:"mb-4",children:"  ."}),k.jsx(hr,{to:"/concepts",className:`px-4 py-2 rounded-lg inline-block transition ${n?"bg-blue-600 hover:bg-blue-700":"bg-blue-500 hover:bg-blue-600"} text-white`,children:" "})]}):k.jsx("div",{className:"space-y-4",children:t.map(c=>k.jsxs("div",{className:`p-6 rounded-lg border transition ${n?"bg-gray-800 border-gray-700 hover:border-gray-600":"bg-white border-gray-200 hover:border-gray-300"}`,children:[k.jsxs("div",{className:"flex justify-between items-start gap-4",children:[k.jsxs("div",{className:"flex-1 min-w-0",children:[k.jsx("h2",{className:`text-xl font-bold mb-2 ${n?"text-white":"text-gray-900"}`,children:c.title}),k.jsxs("p",{className:`text-sm mb-3 ${n?"text-gray-400":"text-gray-600"}`,children:[": ",k.jsx("span",{className:"font-medium",children:c.type==="paper"?"":""})]}),k.jsx("p",{className:`line-clamp-2 ${n?"text-gray-300":"text-gray-700"}`,children:c.description})]}),k.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[k.jsx(hr,{to:c.type==="paper"?`/papers/${c.slug}`:`/concepts/${c.slug}`,className:`px-4 py-2 rounded-lg transition ${n?"bg-blue-600 hover:bg-blue-700":"bg-blue-500 hover:bg-blue-600"} text-white text-sm`,children:""}),k.jsx("button",{onClick:()=>u(c.id),className:`px-4 py-2 rounded-lg transition ${n?"bg-red-600 hover:bg-red-700":"bg-red-500 hover:bg-red-600"} text-white text-sm`,children:""})]})]}),k.jsxs("p",{className:`text-xs mt-4 ${n?"text-gray-500":"text-gray-400"}`,children:[" : ",new Date(c.created_at).toLocaleDateString("ko-KR")]})]},c.id))})]})}function B_e(){const{isDark:n}=Nl(),e=xp(),[t,r]=xe.useState([]),[i,s]=xe.useState(null),[a,o]=xe.useState(!1),[l,u]=xe.useState(""),[c,h]=xe.useState(""),[d,f]=xe.useState(""),[p,m]=xe.useState(!0),[y,v]=xe.useState("");xe.useEffect(()=>{if(!(e!=null&&e.email)){m(!1);return}(async()=>{try{const D=$S(hd(Qs,"notes"),EQ("userEmail","==",e.email)),R=(await fN(D)).docs.map(O=>({id:O.id,...O.data()}));r(R),console.log("   :",e.email,":",R.length)}catch(D){console.log(" Firestore  :",D)}finally{m(!1)}})()},[e==null?void 0:e.email]);const b=()=>{o(!0),s(null),u(""),h(""),f("")},x=M=>{s(M.id),o(!1),u(M.title),h(M.content),f(M.tags.join(", "))},w=async()=>{if(!l.trim()){alert(" .");return}try{if(a){const D={id:(await pN(hd(Qs,"notes"),{title:l,content:c,tags:d.split(",").map(R=>R.trim()).filter(R=>R),userEmail:e.email,createdAt:Wh(),updatedAt:Wh()})).id,title:l,content:c,tags:d.split(",").map(R=>R.trim()).filter(R=>R),userEmail:e.email,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},N=[D,...t];r(N),o(!1),s(D.id),v("  !"),setTimeout(()=>v(""),2e3),console.log("  :",e.email,l)}else if(i){const M=Dp(Qs,"notes",i);await MQ(M,{title:l,content:c,tags:d.split(",").map(N=>N.trim()).filter(N=>N),userEmail:e.email,updatedAt:Wh()});const D=t.map(N=>N.id===i?{...N,title:l,content:c,tags:d.split(",").map(R=>R.trim()).filter(R=>R),updatedAt:new Date().toISOString()}:N);r(D),v("  !"),setTimeout(()=>v(""),2e3)}}catch(M){console.error("  :",M),v("  ."),setTimeout(()=>v(""),2e3)}},_=async M=>{if(confirm("  ?"))try{await CQ(Dp(Qs,"notes",M));const D=t.filter(N=>N.id!==M);r(D),i===M&&(s(null),o(!1))}catch(D){console.error("  :",D),alert("  .")}},E=M=>new Date(M).toLocaleDateString("ko-KR",{year:"numeric",month:"short",day:"numeric"}),A=n?"bg-gray-800 border-gray-700":"bg-white border-gray-200",T=n?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300",S=n?"text-gray-300":"text-gray-700";return k.jsxs("div",{className:"min-h-screen space-y-8",children:[y&&k.jsx(ct.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`fixed top-20 right-4 px-6 py-3 rounded-lg shadow-lg font-semibold text-white z-50 ${y.includes("")?"bg-red-600":"bg-green-600"}`,children:y}),k.jsxs(ct.div,{initial:{opacity:0,y:-30},animate:{opacity:1,y:0},transition:{duration:.6},children:[k.jsx("h1",{className:"text-4xl sm:text-5xl font-bold mb-4 bg-gradient-to-r from-indigo-600 to-blue-600 dark:from-indigo-400 dark:to-blue-400 bg-clip-text text-transparent",children:" "}),k.jsx("p",{className:`text-sm sm:text-base ${n?"text-gray-300":"text-gray-600"}`,children:", ,    "})]}),k.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[k.jsxs(ct.div,{initial:{opacity:0,x:-30},animate:{opacity:1,x:0},transition:{duration:.6},className:`p-6 rounded-lg border ${A}`,children:[k.jsxs("div",{className:"flex justify-between items-center mb-4",children:[k.jsx("h2",{className:"text-xl font-bold",children:" "}),k.jsx("button",{onClick:b,className:"px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium",children:"+  "})]}),k.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:t.length===0?k.jsx("p",{className:`text-sm ${n?"text-gray-400":"text-gray-500"}`,children:" ."}):t.map(M=>k.jsxs("div",{onClick:()=>x(M),className:`p-3 rounded-lg cursor-pointer transition-all ${i===M.id?n?"bg-blue-900 border-blue-500":"bg-blue-100 border-blue-400":n?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} border`,children:[k.jsx("p",{className:"font-semibold text-sm truncate",children:M.title}),k.jsx("p",{className:`text-xs ${n?"text-gray-400":"text-gray-500"}`,children:E(M.updatedAt)})]},M.id))})]}),k.jsx(ct.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:`p-6 rounded-lg border lg:col-span-2 ${A}`,children:a||i?k.jsxs("div",{className:"space-y-4",children:[k.jsxs("div",{children:[k.jsx("label",{className:`block text-sm font-semibold mb-2 ${S}`,children:""}),k.jsx("input",{type:"text",value:l,onChange:M=>u(M.target.value),placeholder:"  ",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${T}`})]}),k.jsxs("div",{children:[k.jsx("label",{className:`block text-sm font-semibold mb-2 ${S}`,children:" ( )"}),k.jsx("input",{type:"text",value:d,onChange:M=>f(M.target.value),placeholder:": , Kerr metric, ",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${T}`})]}),k.jsxs("div",{children:[k.jsx("label",{className:`block text-sm font-semibold mb-2 ${S}`,children:""}),k.jsx("textarea",{value:c,onChange:M=>h(M.target.value),placeholder:"  ",rows:"12",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none ${T}`})]}),k.jsxs("div",{className:"flex gap-2 justify-end",children:[k.jsx("button",{onClick:()=>{o(!1),s(null)},className:`px-4 py-2 rounded-lg font-medium ${n?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-900"}`,children:""}),i&&k.jsx("button",{onClick:()=>_(i),className:"px-4 py-2 rounded-lg font-medium bg-red-600 hover:bg-red-700 text-white",children:""}),k.jsx("button",{onClick:w,className:"px-4 py-2 rounded-lg font-medium bg-blue-600 hover:bg-blue-700 text-white",children:""})]})]}):k.jsxs("div",{className:`text-center py-12 ${n?"text-gray-400":"text-gray-500"}`,children:[k.jsx("p",{className:"text-lg",children:"     "}),k.jsx("p",{className:"text-sm mt-2",children:" : ,  ,      !"})]})})]}),t.length>0&&k.jsxs(ct.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.2},className:`p-6 rounded-lg border ${A}`,children:[k.jsx("h3",{className:"text-lg font-bold mb-3",children:""}),k.jsx("div",{className:"flex flex-wrap gap-2",children:[...new Set(t.flatMap(M=>M.tags).sort())].map(M=>k.jsxs("button",{onClick:()=>{const D=t.filter(N=>N.tags.includes(M));D.length>0&&x(D[0])},className:`px-3 py-1 rounded-full text-sm font-medium transition-all ${n?"bg-gray-700 text-gray-200 hover:bg-blue-600":"bg-gray-200 text-gray-800 hover:bg-blue-500 hover:text-white"}`,children:["#",M]},M))})]})]})}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const N4="182",U_e=0,K8=1,V_e=2,oC=1,z_e=2,d1=3,Ip=0,eo=1,kh=2,Kh=0,Sy=1,Y8=2,Q8=3,Z8=4,$_e=5,Dm=100,H_e=101,G_e=102,j_e=103,q_e=104,W_e=200,X_e=201,K_e=202,Y_e=203,EL=204,SL=205,Q_e=206,Z_e=207,J_e=208,e1e=209,t1e=210,n1e=211,r1e=212,i1e=213,s1e=214,AL=0,TL=1,ML=2,mb=3,CL=4,DL=5,NL=6,RL=7,R4=0,a1e=1,o1e=2,bc=0,Aee=1,Tee=2,Mee=3,Cee=4,Dee=5,Nee=6,Ree=7,Iee=300,Cv=301,gb=302,IL=303,PL=304,AN=306,FL=1e3,$h=1001,LL=1002,Ss=1003,l1e=1004,lT=1005,Zs=1006,mI=1007,zm=1008,Fo=1009,Pee=1010,Fee=1011,Tw=1012,I4=1013,Ac=1014,ac=1015,pd=1016,P4=1017,F4=1018,Mw=1020,Lee=35902,Oee=35899,kee=1021,Bee=1022,lu=1023,md=1026,$m=1027,Uee=1028,L4=1029,vb=1030,O4=1031,k4=1033,lC=33776,uC=33777,cC=33778,hC=33779,OL=35840,kL=35841,BL=35842,UL=35843,VL=36196,zL=37492,$L=37496,HL=37488,GL=37489,jL=37490,qL=37491,WL=37808,XL=37809,KL=37810,YL=37811,QL=37812,ZL=37813,JL=37814,eO=37815,tO=37816,nO=37817,rO=37818,iO=37819,sO=37820,aO=37821,oO=36492,lO=36494,uO=36495,cO=36283,hO=36284,dO=36285,fO=36286,u1e=3200,Vee=0,c1e=1,rf="",dl="srgb",yb="srgb-linear",TD="linear",Wn="srgb",s0=7680,J8=519,h1e=512,d1e=513,f1e=514,B4=515,p1e=516,m1e=517,U4=518,g1e=519,e9=35044,t9="300 es",oc=2e3,MD=2001;function zee(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function CD(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function v1e(){const n=CD("canvas");return n.style.display="block",n}const n9={};function r9(...n){const e="THREE."+n.shift();console.log(e,...n)}function $t(...n){const e="THREE."+n.shift();console.warn(e,...n)}function Bn(...n){const e="THREE."+n.shift();console.error(e,...n)}function Cw(...n){const e=n.join(" ");e in n9||(n9[e]=!0,$t(...n))}function y1e(n,e,t){return new Promise(function(r,i){function s(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:i();break;case n.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:r()}}setTimeout(s,t)})}class Gb{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){const r=this._listeners;return r===void 0?!1:r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){const r=this._listeners;if(r===void 0)return;const i=r[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const r=t[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,a=i.length;s<a;s++)i[s].call(this,e);e.target=null}}}const ks=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],gI=Math.PI/180,pO=180/Math.PI;function eA(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(ks[n&255]+ks[n>>8&255]+ks[n>>16&255]+ks[n>>24&255]+"-"+ks[e&255]+ks[e>>8&255]+"-"+ks[e>>16&15|64]+ks[e>>24&255]+"-"+ks[t&63|128]+ks[t>>8&255]+"-"+ks[t>>16&255]+ks[t>>24&255]+ks[r&255]+ks[r>>8&255]+ks[r>>16&255]+ks[r>>24&255]).toLowerCase()}function An(n,e,t){return Math.max(e,Math.min(t,n))}function x1e(n,e){return(n%e+e)%e}function vI(n,e,t){return(1-t)*n+t*e}function w_(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Pa(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}class Cn{constructor(e=0,t=0){Cn.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=An(this.x,e.x,t.x),this.y=An(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=An(this.x,e,t),this.y=An(this.y,e,t),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(An(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(An(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*r-a*i+e.x,this.y=s*i+a*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class tA{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,s,a,o){let l=r[i+0],u=r[i+1],c=r[i+2],h=r[i+3],d=s[a+0],f=s[a+1],p=s[a+2],m=s[a+3];if(o<=0){e[t+0]=l,e[t+1]=u,e[t+2]=c,e[t+3]=h;return}if(o>=1){e[t+0]=d,e[t+1]=f,e[t+2]=p,e[t+3]=m;return}if(h!==m||l!==d||u!==f||c!==p){let y=l*d+u*f+c*p+h*m;y<0&&(d=-d,f=-f,p=-p,m=-m,y=-y);let v=1-o;if(y<.9995){const b=Math.acos(y),x=Math.sin(b);v=Math.sin(v*b)/x,o=Math.sin(o*b)/x,l=l*v+d*o,u=u*v+f*o,c=c*v+p*o,h=h*v+m*o}else{l=l*v+d*o,u=u*v+f*o,c=c*v+p*o,h=h*v+m*o;const b=1/Math.sqrt(l*l+u*u+c*c+h*h);l*=b,u*=b,c*=b,h*=b}}e[t]=l,e[t+1]=u,e[t+2]=c,e[t+3]=h}static multiplyQuaternionsFlat(e,t,r,i,s,a){const o=r[i],l=r[i+1],u=r[i+2],c=r[i+3],h=s[a],d=s[a+1],f=s[a+2],p=s[a+3];return e[t]=o*p+c*h+l*f-u*d,e[t+1]=l*p+c*d+u*h-o*f,e[t+2]=u*p+c*f+o*d-l*h,e[t+3]=c*p-o*h-l*d-u*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,i=e._y,s=e._z,a=e._order,o=Math.cos,l=Math.sin,u=o(r/2),c=o(i/2),h=o(s/2),d=l(r/2),f=l(i/2),p=l(s/2);switch(a){case"XYZ":this._x=d*c*h+u*f*p,this._y=u*f*h-d*c*p,this._z=u*c*p+d*f*h,this._w=u*c*h-d*f*p;break;case"YXZ":this._x=d*c*h+u*f*p,this._y=u*f*h-d*c*p,this._z=u*c*p-d*f*h,this._w=u*c*h+d*f*p;break;case"ZXY":this._x=d*c*h-u*f*p,this._y=u*f*h+d*c*p,this._z=u*c*p+d*f*h,this._w=u*c*h-d*f*p;break;case"ZYX":this._x=d*c*h-u*f*p,this._y=u*f*h+d*c*p,this._z=u*c*p-d*f*h,this._w=u*c*h+d*f*p;break;case"YZX":this._x=d*c*h+u*f*p,this._y=u*f*h+d*c*p,this._z=u*c*p-d*f*h,this._w=u*c*h-d*f*p;break;case"XZY":this._x=d*c*h-u*f*p,this._y=u*f*h-d*c*p,this._z=u*c*p+d*f*h,this._w=u*c*h+d*f*p;break;default:$t("Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],s=t[8],a=t[1],o=t[5],l=t[9],u=t[2],c=t[6],h=t[10],d=r+o+h;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(c-l)*f,this._y=(s-u)*f,this._z=(a-i)*f}else if(r>o&&r>h){const f=2*Math.sqrt(1+r-o-h);this._w=(c-l)/f,this._x=.25*f,this._y=(i+a)/f,this._z=(s+u)/f}else if(o>h){const f=2*Math.sqrt(1+o-r-h);this._w=(s-u)/f,this._x=(i+a)/f,this._y=.25*f,this._z=(l+c)/f}else{const f=2*Math.sqrt(1+h-r-o);this._w=(a-i)/f,this._x=(s+u)/f,this._y=(l+c)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<1e-8?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(An(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,s=e._z,a=e._w,o=t._x,l=t._y,u=t._z,c=t._w;return this._x=r*c+a*o+i*u-s*l,this._y=i*c+a*l+s*o-r*u,this._z=s*c+a*u+r*l-i*o,this._w=a*c-r*o-i*l-s*u,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let r=e._x,i=e._y,s=e._z,a=e._w,o=this.dot(e);o<0&&(r=-r,i=-i,s=-s,a=-a,o=-o);let l=1-t;if(o<.9995){const u=Math.acos(o),c=Math.sin(u);l=Math.sin(l*u)/c,t=Math.sin(t*u)/c,this._x=this._x*l+r*t,this._y=this._y*l+i*t,this._z=this._z*l+s*t,this._w=this._w*l+a*t,this._onChangeCallback()}else this._x=this._x*l+r*t,this._y=this._y*l+i*t,this._z=this._z*l+s*t,this._w=this._w*l+a*t,this.normalize();return this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),i=Math.sqrt(1-r),s=Math.sqrt(r);return this.set(i*Math.sin(e),i*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Ae{constructor(e=0,t=0,r=0){Ae.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(i9.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(i9.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*i,this.y=s[1]*t+s[4]*r+s[7]*i,this.z=s[2]*t+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=e.elements,a=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*i+s[12])*a,this.y=(s[1]*t+s[5]*r+s[9]*i+s[13])*a,this.z=(s[2]*t+s[6]*r+s[10]*i+s[14])*a,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,s=e.x,a=e.y,o=e.z,l=e.w,u=2*(a*i-o*r),c=2*(o*t-s*i),h=2*(s*r-a*t);return this.x=t+l*u+a*h-o*c,this.y=r+l*c+o*u-s*h,this.z=i+l*h+s*c-a*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i,this.y=s[1]*t+s[5]*r+s[9]*i,this.z=s[2]*t+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=An(this.x,e.x,t.x),this.y=An(this.y,e.y,t.y),this.z=An(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=An(this.x,e,t),this.y=An(this.y,e,t),this.z=An(this.z,e,t),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(An(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,s=e.z,a=t.x,o=t.y,l=t.z;return this.x=i*l-s*o,this.y=s*a-r*l,this.z=r*o-i*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return yI.copy(this).projectOnVector(e),this.sub(yI)}reflect(e){return this.sub(yI.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(An(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const yI=new Ae,i9=new tA;class sn{constructor(e,t,r,i,s,a,o,l,u){sn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,a,o,l,u)}set(e,t,r,i,s,a,o,l,u){const c=this.elements;return c[0]=e,c[1]=i,c[2]=o,c[3]=t,c[4]=s,c[5]=l,c[6]=r,c[7]=a,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,a=r[0],o=r[3],l=r[6],u=r[1],c=r[4],h=r[7],d=r[2],f=r[5],p=r[8],m=i[0],y=i[3],v=i[6],b=i[1],x=i[4],w=i[7],_=i[2],E=i[5],A=i[8];return s[0]=a*m+o*b+l*_,s[3]=a*y+o*x+l*E,s[6]=a*v+o*w+l*A,s[1]=u*m+c*b+h*_,s[4]=u*y+c*x+h*E,s[7]=u*v+c*w+h*A,s[2]=d*m+f*b+p*_,s[5]=d*y+f*x+p*E,s[8]=d*v+f*w+p*A,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7],c=e[8];return t*a*c-t*o*u-r*s*c+r*o*l+i*s*u-i*a*l}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7],c=e[8],h=c*a-o*u,d=o*l-c*s,f=u*s-a*l,p=t*h+r*d+i*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=h*m,e[1]=(i*u-c*r)*m,e[2]=(o*r-i*a)*m,e[3]=d*m,e[4]=(c*t-i*l)*m,e[5]=(i*s-o*t)*m,e[6]=f*m,e[7]=(r*l-u*t)*m,e[8]=(a*t-r*s)*m,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,a,o){const l=Math.cos(s),u=Math.sin(s);return this.set(r*l,r*u,-r*(l*a+u*o)+a+e,-i*u,i*l,-i*(-u*a+l*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(xI.makeScale(e,t)),this}rotate(e){return this.premultiply(xI.makeRotation(-e)),this}translate(e,t){return this.premultiply(xI.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const xI=new sn,s9=new sn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),a9=new sn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function b1e(){const n={enabled:!0,workingColorSpace:yb,spaces:{},convert:function(i,s,a){return this.enabled===!1||s===a||!s||!a||(this.spaces[s].transfer===Wn&&(i.r=Yh(i.r),i.g=Yh(i.g),i.b=Yh(i.b)),this.spaces[s].primaries!==this.spaces[a].primaries&&(i.applyMatrix3(this.spaces[s].toXYZ),i.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===Wn&&(i.r=Ay(i.r),i.g=Ay(i.g),i.b=Ay(i.b))),i},workingToColorSpace:function(i,s){return this.convert(i,this.workingColorSpace,s)},colorSpaceToWorking:function(i,s){return this.convert(i,s,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===rf?TD:this.spaces[i].transfer},getToneMappingMode:function(i){return this.spaces[i].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(i,s=this.workingColorSpace){return i.fromArray(this.spaces[s].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,s,a){return i.copy(this.spaces[s].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(i,s){return Cw("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),n.workingToColorSpace(i,s)},toWorkingColorSpace:function(i,s){return Cw("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),n.colorSpaceToWorking(i,s)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],r=[.3127,.329];return n.define({[yb]:{primaries:e,whitePoint:r,transfer:TD,toXYZ:s9,fromXYZ:a9,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:dl},outputColorSpaceConfig:{drawingBufferColorSpace:dl}},[dl]:{primaries:e,whitePoint:r,transfer:Wn,toXYZ:s9,fromXYZ:a9,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:dl}}}),n}const In=b1e();function Yh(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function Ay(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let a0;class _1e{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let r;if(e instanceof HTMLCanvasElement)r=e;else{a0===void 0&&(a0=CD("canvas")),a0.width=e.width,a0.height=e.height;const i=a0.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),r=a0}return r.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=CD("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let a=0;a<s.length;a++)s[a]=Yh(s[a]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(Yh(t[r]/255)*255):t[r]=Yh(t[r]);return{data:t,width:e.width,height:e.height}}else return $t("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let w1e=0;class V4{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:w1e++}),this.uuid=eA(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):typeof VideoFrame<"u"&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let a=0,o=i.length;a<o;a++)i[a].isDataTexture?s.push(bI(i[a].image)):s.push(bI(i[a]))}else s=bI(i);r.url=s}return t||(e.images[this.uuid]=r),r}}function bI(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?_1e.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:($t("Texture: Unable to serialize Texture."),{})}let E1e=0;const _I=new Ae;class wa extends Gb{constructor(e=wa.DEFAULT_IMAGE,t=wa.DEFAULT_MAPPING,r=$h,i=$h,s=Zs,a=zm,o=lu,l=Fo,u=wa.DEFAULT_ANISOTROPY,c=rf){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:E1e++}),this.uuid=eA(),this.name="",this.source=new V4(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=a,this.anisotropy=u,this.format=o,this.internalFormat=null,this.type=l,this.offset=new Cn(0,0),this.repeat=new Cn(1,1),this.center=new Cn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new sn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(_I).x}get height(){return this.source.getSize(_I).y}get depth(){return this.source.getSize(_I).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const r=e[t];if(r===void 0){$t(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){$t(`Texture.setValues(): property '${t}' does not exist.`);continue}i&&r&&i.isVector2&&r.isVector2||i&&r&&i.isVector3&&r.isVector3||i&&r&&i.isMatrix3&&r.isMatrix3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Iee)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case FL:e.x=e.x-Math.floor(e.x);break;case $h:e.x=e.x<0?0:1;break;case LL:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case FL:e.y=e.y-Math.floor(e.y);break;case $h:e.y=e.y<0?0:1;break;case LL:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}wa.DEFAULT_IMAGE=null;wa.DEFAULT_MAPPING=Iee;wa.DEFAULT_ANISOTROPY=1;class ei{constructor(e=0,t=0,r=0,i=1){ei.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*i+a[12]*s,this.y=a[1]*t+a[5]*r+a[9]*i+a[13]*s,this.z=a[2]*t+a[6]*r+a[10]*i+a[14]*s,this.w=a[3]*t+a[7]*r+a[11]*i+a[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,s;const l=e.elements,u=l[0],c=l[4],h=l[8],d=l[1],f=l[5],p=l[9],m=l[2],y=l[6],v=l[10];if(Math.abs(c-d)<.01&&Math.abs(h-m)<.01&&Math.abs(p-y)<.01){if(Math.abs(c+d)<.1&&Math.abs(h+m)<.1&&Math.abs(p+y)<.1&&Math.abs(u+f+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const x=(u+1)/2,w=(f+1)/2,_=(v+1)/2,E=(c+d)/4,A=(h+m)/4,T=(p+y)/4;return x>w&&x>_?x<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(x),i=E/r,s=A/r):w>_?w<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(w),r=E/i,s=T/i):_<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(_),r=A/s,i=T/s),this.set(r,i,s,t),this}let b=Math.sqrt((y-p)*(y-p)+(h-m)*(h-m)+(d-c)*(d-c));return Math.abs(b)<.001&&(b=1),this.x=(y-p)/b,this.y=(h-m)/b,this.z=(d-c)/b,this.w=Math.acos((u+f+v-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=An(this.x,e.x,t.x),this.y=An(this.y,e.y,t.y),this.z=An(this.z,e.z,t.z),this.w=An(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=An(this.x,e,t),this.y=An(this.y,e,t),this.z=An(this.z,e,t),this.w=An(this.w,e,t),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(An(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class S1e extends Gb{constructor(e=1,t=1,r={}){super(),r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Zs,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},r),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=r.depth,this.scissor=new ei(0,0,e,t),this.scissorTest=!1,this.viewport=new ei(0,0,e,t);const i={width:e,height:t,depth:r.depth},s=new wa(i);this.textures=[];const a=r.count;for(let o=0;o<a;o++)this.textures[o]=s.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this._setTextureOptions(r),this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=r.depthTexture,this.samples=r.samples,this.multiview=r.multiview}_setTextureOptions(e={}){const t={minFilter:Zs,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let r=0;r<this.textures.length;r++)this.textures[r].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,s=this.textures.length;i<s;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=r,this.textures[i].isData3DTexture!==!0&&(this.textures[i].isArrayTexture=this.textures[i].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,r=e.textures.length;t<r;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const i=Object.assign({},e.textures[t].image);this.textures[t].source=new V4(i)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class _c extends S1e{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class $ee extends wa{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Ss,this.minFilter=Ss,this.wrapR=$h,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class A1e extends wa{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Ss,this.minFilter=Ss,this.wrapR=$h,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class nA{constructor(e=new Ae(1/0,1/0,1/0),t=new Ae(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(Ll.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(Ll.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=Ll.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const s=r.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,o=s.count;a<o;a++)e.isMesh===!0?e.getVertexPosition(a,Ll):Ll.fromBufferAttribute(s,a),Ll.applyMatrix4(e.matrixWorld),this.expandByPoint(Ll);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),uT.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),uT.copy(r.boundingBox)),uT.applyMatrix4(e.matrixWorld),this.union(uT)}const i=e.children;for(let s=0,a=i.length;s<a;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Ll),Ll.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(E_),cT.subVectors(this.max,E_),o0.subVectors(e.a,E_),l0.subVectors(e.b,E_),u0.subVectors(e.c,E_),kd.subVectors(l0,o0),Bd.subVectors(u0,l0),pm.subVectors(o0,u0);let t=[0,-kd.z,kd.y,0,-Bd.z,Bd.y,0,-pm.z,pm.y,kd.z,0,-kd.x,Bd.z,0,-Bd.x,pm.z,0,-pm.x,-kd.y,kd.x,0,-Bd.y,Bd.x,0,-pm.y,pm.x,0];return!wI(t,o0,l0,u0,cT)||(t=[1,0,0,0,1,0,0,0,1],!wI(t,o0,l0,u0,cT))?!1:(hT.crossVectors(kd,Bd),t=[hT.x,hT.y,hT.z],wI(t,o0,l0,u0,cT))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ll).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Ll).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Bc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Bc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Bc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Bc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Bc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Bc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Bc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Bc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Bc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const Bc=[new Ae,new Ae,new Ae,new Ae,new Ae,new Ae,new Ae,new Ae],Ll=new Ae,uT=new nA,o0=new Ae,l0=new Ae,u0=new Ae,kd=new Ae,Bd=new Ae,pm=new Ae,E_=new Ae,cT=new Ae,hT=new Ae,mm=new Ae;function wI(n,e,t,r,i){for(let s=0,a=n.length-3;s<=a;s+=3){mm.fromArray(n,s);const o=i.x*Math.abs(mm.x)+i.y*Math.abs(mm.y)+i.z*Math.abs(mm.z),l=e.dot(mm),u=t.dot(mm),c=r.dot(mm);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>o)return!1}return!0}const T1e=new nA,S_=new Ae,EI=new Ae;class rA{constructor(e=new Ae,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):T1e.setFromPoints(e).getCenter(r);let i=0;for(let s=0,a=e.length;s<a;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;S_.subVectors(e,this.center);const t=S_.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(S_,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(EI.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(S_.copy(e.center).add(EI)),this.expandByPoint(S_.copy(e.center).sub(EI))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const Uc=new Ae,SI=new Ae,dT=new Ae,Ud=new Ae,AI=new Ae,fT=new Ae,TI=new Ae;class z4{constructor(e=new Ae,t=new Ae(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Uc)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Uc.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Uc.copy(this.origin).addScaledVector(this.direction,t),Uc.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){SI.copy(e).add(t).multiplyScalar(.5),dT.copy(t).sub(e).normalize(),Ud.copy(this.origin).sub(SI);const s=e.distanceTo(t)*.5,a=-this.direction.dot(dT),o=Ud.dot(this.direction),l=-Ud.dot(dT),u=Ud.lengthSq(),c=Math.abs(1-a*a);let h,d,f,p;if(c>0)if(h=a*l-o,d=a*o-l,p=s*c,h>=0)if(d>=-p)if(d<=p){const m=1/c;h*=m,d*=m,f=h*(h+a*d+2*o)+d*(a*h+d+2*l)+u}else d=s,h=Math.max(0,-(a*d+o)),f=-h*h+d*(d+2*l)+u;else d=-s,h=Math.max(0,-(a*d+o)),f=-h*h+d*(d+2*l)+u;else d<=-p?(h=Math.max(0,-(-a*s+o)),d=h>0?-s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+u):d<=p?(h=0,d=Math.min(Math.max(-s,-l),s),f=d*(d+2*l)+u):(h=Math.max(0,-(a*s+o)),d=h>0?s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+u);else d=a>0?-s:s,h=Math.max(0,-(a*d+o)),f=-h*h+d*(d+2*l)+u;return r&&r.copy(this.origin).addScaledVector(this.direction,h),i&&i.copy(SI).addScaledVector(dT,d),f}intersectSphere(e,t){Uc.subVectors(e.center,this.origin);const r=Uc.dot(this.direction),i=Uc.dot(Uc)-r*r,s=e.radius*e.radius;if(i>s)return null;const a=Math.sqrt(s-i),o=r-a,l=r+a;return l<0?null:o<0?this.at(l,t):this.at(o,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,s,a,o,l;const u=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,d=this.origin;return u>=0?(r=(e.min.x-d.x)*u,i=(e.max.x-d.x)*u):(r=(e.max.x-d.x)*u,i=(e.min.x-d.x)*u),c>=0?(s=(e.min.y-d.y)*c,a=(e.max.y-d.y)*c):(s=(e.max.y-d.y)*c,a=(e.min.y-d.y)*c),r>a||s>i||((s>r||isNaN(r))&&(r=s),(a<i||isNaN(i))&&(i=a),h>=0?(o=(e.min.z-d.z)*h,l=(e.max.z-d.z)*h):(o=(e.max.z-d.z)*h,l=(e.min.z-d.z)*h),r>l||o>i)||((o>r||r!==r)&&(r=o),(l<i||i!==i)&&(i=l),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,Uc)!==null}intersectTriangle(e,t,r,i,s){AI.subVectors(t,e),fT.subVectors(r,e),TI.crossVectors(AI,fT);let a=this.direction.dot(TI),o;if(a>0){if(i)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Ud.subVectors(this.origin,e);const l=o*this.direction.dot(fT.crossVectors(Ud,fT));if(l<0)return null;const u=o*this.direction.dot(AI.cross(Ud));if(u<0||l+u>a)return null;const c=-o*Ud.dot(TI);return c<0?null:this.at(c/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ir{constructor(e,t,r,i,s,a,o,l,u,c,h,d,f,p,m,y){Ir.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,a,o,l,u,c,h,d,f,p,m,y)}set(e,t,r,i,s,a,o,l,u,c,h,d,f,p,m,y){const v=this.elements;return v[0]=e,v[4]=t,v[8]=r,v[12]=i,v[1]=s,v[5]=a,v[9]=o,v[13]=l,v[2]=u,v[6]=c,v[10]=h,v[14]=d,v[3]=f,v[7]=p,v[11]=m,v[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ir().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return this.determinant()===0?(e.set(1,0,0),t.set(0,1,0),r.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this)}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();const t=this.elements,r=e.elements,i=1/c0.setFromMatrixColumn(e,0).length(),s=1/c0.setFromMatrixColumn(e,1).length(),a=1/c0.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,s=e.z,a=Math.cos(r),o=Math.sin(r),l=Math.cos(i),u=Math.sin(i),c=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){const d=a*c,f=a*h,p=o*c,m=o*h;t[0]=l*c,t[4]=-l*h,t[8]=u,t[1]=f+p*u,t[5]=d-m*u,t[9]=-o*l,t[2]=m-d*u,t[6]=p+f*u,t[10]=a*l}else if(e.order==="YXZ"){const d=l*c,f=l*h,p=u*c,m=u*h;t[0]=d+m*o,t[4]=p*o-f,t[8]=a*u,t[1]=a*h,t[5]=a*c,t[9]=-o,t[2]=f*o-p,t[6]=m+d*o,t[10]=a*l}else if(e.order==="ZXY"){const d=l*c,f=l*h,p=u*c,m=u*h;t[0]=d-m*o,t[4]=-a*h,t[8]=p+f*o,t[1]=f+p*o,t[5]=a*c,t[9]=m-d*o,t[2]=-a*u,t[6]=o,t[10]=a*l}else if(e.order==="ZYX"){const d=a*c,f=a*h,p=o*c,m=o*h;t[0]=l*c,t[4]=p*u-f,t[8]=d*u+m,t[1]=l*h,t[5]=m*u+d,t[9]=f*u-p,t[2]=-u,t[6]=o*l,t[10]=a*l}else if(e.order==="YZX"){const d=a*l,f=a*u,p=o*l,m=o*u;t[0]=l*c,t[4]=m-d*h,t[8]=p*h+f,t[1]=h,t[5]=a*c,t[9]=-o*c,t[2]=-u*c,t[6]=f*h+p,t[10]=d-m*h}else if(e.order==="XZY"){const d=a*l,f=a*u,p=o*l,m=o*u;t[0]=l*c,t[4]=-h,t[8]=u*c,t[1]=d*h+m,t[5]=a*c,t[9]=f*h-p,t[2]=p*h-f,t[6]=o*c,t[10]=m*h+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(M1e,e,C1e)}lookAt(e,t,r){const i=this.elements;return so.subVectors(e,t),so.lengthSq()===0&&(so.z=1),so.normalize(),Vd.crossVectors(r,so),Vd.lengthSq()===0&&(Math.abs(r.z)===1?so.x+=1e-4:so.z+=1e-4,so.normalize(),Vd.crossVectors(r,so)),Vd.normalize(),pT.crossVectors(so,Vd),i[0]=Vd.x,i[4]=pT.x,i[8]=so.x,i[1]=Vd.y,i[5]=pT.y,i[9]=so.y,i[2]=Vd.z,i[6]=pT.z,i[10]=so.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,a=r[0],o=r[4],l=r[8],u=r[12],c=r[1],h=r[5],d=r[9],f=r[13],p=r[2],m=r[6],y=r[10],v=r[14],b=r[3],x=r[7],w=r[11],_=r[15],E=i[0],A=i[4],T=i[8],S=i[12],M=i[1],D=i[5],N=i[9],R=i[13],O=i[2],G=i[6],I=i[10],B=i[14],$=i[3],H=i[7],Q=i[11],ee=i[15];return s[0]=a*E+o*M+l*O+u*$,s[4]=a*A+o*D+l*G+u*H,s[8]=a*T+o*N+l*I+u*Q,s[12]=a*S+o*R+l*B+u*ee,s[1]=c*E+h*M+d*O+f*$,s[5]=c*A+h*D+d*G+f*H,s[9]=c*T+h*N+d*I+f*Q,s[13]=c*S+h*R+d*B+f*ee,s[2]=p*E+m*M+y*O+v*$,s[6]=p*A+m*D+y*G+v*H,s[10]=p*T+m*N+y*I+v*Q,s[14]=p*S+m*R+y*B+v*ee,s[3]=b*E+x*M+w*O+_*$,s[7]=b*A+x*D+w*G+_*H,s[11]=b*T+x*N+w*I+_*Q,s[15]=b*S+x*R+w*B+_*ee,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],s=e[12],a=e[1],o=e[5],l=e[9],u=e[13],c=e[2],h=e[6],d=e[10],f=e[14],p=e[3],m=e[7],y=e[11],v=e[15],b=l*f-u*d,x=o*f-u*h,w=o*d-l*h,_=a*f-u*c,E=a*d-l*c,A=a*h-o*c;return t*(m*b-y*x+v*w)-r*(p*b-y*_+v*E)+i*(p*x-m*_+v*A)-s*(p*w-m*E+y*A)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],y=e[14],v=e[15],b=h*y*u-m*d*u+m*l*f-o*y*f-h*l*v+o*d*v,x=p*d*u-c*y*u-p*l*f+a*y*f+c*l*v-a*d*v,w=c*m*u-p*h*u+p*o*f-a*m*f-c*o*v+a*h*v,_=p*h*l-c*m*l-p*o*d+a*m*d+c*o*y-a*h*y,E=t*b+r*x+i*w+s*_;if(E===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const A=1/E;return e[0]=b*A,e[1]=(m*d*s-h*y*s-m*i*f+r*y*f+h*i*v-r*d*v)*A,e[2]=(o*y*s-m*l*s+m*i*u-r*y*u-o*i*v+r*l*v)*A,e[3]=(h*l*s-o*d*s-h*i*u+r*d*u+o*i*f-r*l*f)*A,e[4]=x*A,e[5]=(c*y*s-p*d*s+p*i*f-t*y*f-c*i*v+t*d*v)*A,e[6]=(p*l*s-a*y*s-p*i*u+t*y*u+a*i*v-t*l*v)*A,e[7]=(a*d*s-c*l*s+c*i*u-t*d*u-a*i*f+t*l*f)*A,e[8]=w*A,e[9]=(p*h*s-c*m*s-p*r*f+t*m*f+c*r*v-t*h*v)*A,e[10]=(a*m*s-p*o*s+p*r*u-t*m*u-a*r*v+t*o*v)*A,e[11]=(c*o*s-a*h*s-c*r*u+t*h*u+a*r*f-t*o*f)*A,e[12]=_*A,e[13]=(c*m*i-p*h*i+p*r*d-t*m*d-c*r*y+t*h*y)*A,e[14]=(p*o*i-a*m*i-p*r*l+t*m*l+a*r*y-t*o*y)*A,e[15]=(a*h*i-c*o*i+c*r*l-t*h*l-a*r*d+t*o*d)*A,this}scale(e){const t=this.elements,r=e.x,i=e.y,s=e.z;return t[0]*=r,t[4]*=i,t[8]*=s,t[1]*=r,t[5]*=i,t[9]*=s,t[2]*=r,t[6]*=i,t[10]*=s,t[3]*=r,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),s=1-r,a=e.x,o=e.y,l=e.z,u=s*a,c=s*o;return this.set(u*a+r,u*o-i*l,u*l+i*o,0,u*o+i*l,c*o+r,c*l-i*a,0,u*l-i*o,c*l+i*a,s*l*l+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,s,a){return this.set(1,r,s,0,e,1,a,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,s=t._x,a=t._y,o=t._z,l=t._w,u=s+s,c=a+a,h=o+o,d=s*u,f=s*c,p=s*h,m=a*c,y=a*h,v=o*h,b=l*u,x=l*c,w=l*h,_=r.x,E=r.y,A=r.z;return i[0]=(1-(m+v))*_,i[1]=(f+w)*_,i[2]=(p-x)*_,i[3]=0,i[4]=(f-w)*E,i[5]=(1-(d+v))*E,i[6]=(y+b)*E,i[7]=0,i[8]=(p+x)*A,i[9]=(y-b)*A,i[10]=(1-(d+m))*A,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;if(e.x=i[12],e.y=i[13],e.z=i[14],this.determinant()===0)return r.set(1,1,1),t.identity(),this;let s=c0.set(i[0],i[1],i[2]).length();const a=c0.set(i[4],i[5],i[6]).length(),o=c0.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),Ol.copy(this);const u=1/s,c=1/a,h=1/o;return Ol.elements[0]*=u,Ol.elements[1]*=u,Ol.elements[2]*=u,Ol.elements[4]*=c,Ol.elements[5]*=c,Ol.elements[6]*=c,Ol.elements[8]*=h,Ol.elements[9]*=h,Ol.elements[10]*=h,t.setFromRotationMatrix(Ol),r.x=s,r.y=a,r.z=o,this}makePerspective(e,t,r,i,s,a,o=oc,l=!1){const u=this.elements,c=2*s/(t-e),h=2*s/(r-i),d=(t+e)/(t-e),f=(r+i)/(r-i);let p,m;if(l)p=s/(a-s),m=a*s/(a-s);else if(o===oc)p=-(a+s)/(a-s),m=-2*a*s/(a-s);else if(o===MD)p=-a/(a-s),m=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return u[0]=c,u[4]=0,u[8]=d,u[12]=0,u[1]=0,u[5]=h,u[9]=f,u[13]=0,u[2]=0,u[6]=0,u[10]=p,u[14]=m,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(e,t,r,i,s,a,o=oc,l=!1){const u=this.elements,c=2/(t-e),h=2/(r-i),d=-(t+e)/(t-e),f=-(r+i)/(r-i);let p,m;if(l)p=1/(a-s),m=a/(a-s);else if(o===oc)p=-2/(a-s),m=-(a+s)/(a-s);else if(o===MD)p=-1/(a-s),m=-s/(a-s);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return u[0]=c,u[4]=0,u[8]=0,u[12]=d,u[1]=0,u[5]=h,u[9]=0,u[13]=f,u[2]=0,u[6]=0,u[10]=p,u[14]=m,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const c0=new Ae,Ol=new Ir,M1e=new Ae(0,0,0),C1e=new Ae(1,1,1),Vd=new Ae,pT=new Ae,so=new Ae,o9=new Ir,l9=new tA;class Tc{constructor(e=0,t=0,r=0,i=Tc.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,s=i[0],a=i[4],o=i[8],l=i[1],u=i[5],c=i[9],h=i[2],d=i[6],f=i[10];switch(t){case"XYZ":this._y=Math.asin(An(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-An(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,f),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(An(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-An(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(An(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(o,f));break;case"XZY":this._z=Math.asin(-An(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-c,f),this._y=0);break;default:$t("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return o9.makeRotationFromQuaternion(e),this.setFromRotationMatrix(o9,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return l9.setFromEuler(this),this.setFromQuaternion(l9,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Tc.DEFAULT_ORDER="XYZ";class Hee{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let D1e=0;const u9=new Ae,h0=new tA,Vc=new Ir,mT=new Ae,A_=new Ae,N1e=new Ae,R1e=new tA,c9=new Ae(1,0,0),h9=new Ae(0,1,0),d9=new Ae(0,0,1),f9={type:"added"},I1e={type:"removed"},d0={type:"childadded",child:null},MI={type:"childremoved",child:null};class Js extends Gb{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:D1e++}),this.uuid=eA(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Js.DEFAULT_UP.clone();const e=new Ae,t=new Tc,r=new tA,i=new Ae(1,1,1);function s(){r.setFromEuler(t,!1)}function a(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Ir},normalMatrix:{value:new sn}}),this.matrix=new Ir,this.matrixWorld=new Ir,this.matrixAutoUpdate=Js.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Js.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Hee,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return h0.setFromAxisAngle(e,t),this.quaternion.multiply(h0),this}rotateOnWorldAxis(e,t){return h0.setFromAxisAngle(e,t),this.quaternion.premultiply(h0),this}rotateX(e){return this.rotateOnAxis(c9,e)}rotateY(e){return this.rotateOnAxis(h9,e)}rotateZ(e){return this.rotateOnAxis(d9,e)}translateOnAxis(e,t){return u9.copy(e).applyQuaternion(this.quaternion),this.position.add(u9.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(c9,e)}translateY(e){return this.translateOnAxis(h9,e)}translateZ(e){return this.translateOnAxis(d9,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Vc.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?mT.copy(e):mT.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),A_.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Vc.lookAt(A_,mT,this.up):Vc.lookAt(mT,A_,this.up),this.quaternion.setFromRotationMatrix(Vc),i&&(Vc.extractRotation(i.matrixWorld),h0.setFromRotationMatrix(Vc),this.quaternion.premultiply(h0.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(Bn("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(f9),d0.child=e,this.dispatchEvent(d0),d0.child=null):Bn("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(I1e),MI.child=e,this.dispatchEvent(MI),MI.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Vc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Vc.multiply(e.parent.matrixWorld)),e.applyMatrix4(Vc),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(f9),d0.child=e,this.dispatchEvent(d0),d0.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const a=this.children[r].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(A_,e,N1e),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(A_,R1e,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.geometryInfo=this._geometryInfo.map(o=>({...o,boundingBox:o.boundingBox?o.boundingBox.toJSON():void 0,boundingSphere:o.boundingSphere?o.boundingSphere.toJSON():void 0})),i.instanceInfo=this._instanceInfo.map(o=>({...o})),i.availableInstanceIds=this._availableInstanceIds.slice(),i.availableGeometryIds=this._availableGeometryIds.slice(),i.nextIndexStart=this._nextIndexStart,i.nextVertexStart=this._nextVertexStart,i.geometryCount=this._geometryCount,i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.matricesTexture=this._matricesTexture.toJSON(e),i.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(i.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(i.boundingBox=this.boundingBox.toJSON()));function s(o,l){return o[l.uuid]===void 0&&(o[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const l=o.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){const h=l[u];s(e.shapes,h)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let l=0,u=this.material.length;l<u;l++)o.push(s(e.materials,this.material[l]));i.material=o}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let o=0;o<this.animations.length;o++){const l=this.animations[o];i.animations.push(s(e.animations,l))}}if(t){const o=a(e.geometries),l=a(e.materials),u=a(e.textures),c=a(e.images),h=a(e.shapes),d=a(e.skeletons),f=a(e.animations),p=a(e.nodes);o.length>0&&(r.geometries=o),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),c.length>0&&(r.images=c),h.length>0&&(r.shapes=h),d.length>0&&(r.skeletons=d),f.length>0&&(r.animations=f),p.length>0&&(r.nodes=p)}return r.object=i,r;function a(o){const l=[];for(const u in o){const c=o[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}Js.DEFAULT_UP=new Ae(0,1,0);Js.DEFAULT_MATRIX_AUTO_UPDATE=!0;Js.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const kl=new Ae,zc=new Ae,CI=new Ae,$c=new Ae,f0=new Ae,p0=new Ae,p9=new Ae,DI=new Ae,NI=new Ae,RI=new Ae,II=new ei,PI=new ei,FI=new ei;class su{constructor(e=new Ae,t=new Ae,r=new Ae){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),kl.subVectors(e,t),i.cross(kl);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,r,i,s){kl.subVectors(i,t),zc.subVectors(r,t),CI.subVectors(e,t);const a=kl.dot(kl),o=kl.dot(zc),l=kl.dot(CI),u=zc.dot(zc),c=zc.dot(CI),h=a*u-o*o;if(h===0)return s.set(0,0,0),null;const d=1/h,f=(u*l-o*c)*d,p=(a*c-o*l)*d;return s.set(1-f-p,p,f)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,$c)===null?!1:$c.x>=0&&$c.y>=0&&$c.x+$c.y<=1}static getInterpolation(e,t,r,i,s,a,o,l){return this.getBarycoord(e,t,r,i,$c)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,$c.x),l.addScaledVector(a,$c.y),l.addScaledVector(o,$c.z),l)}static getInterpolatedAttribute(e,t,r,i,s,a){return II.setScalar(0),PI.setScalar(0),FI.setScalar(0),II.fromBufferAttribute(e,t),PI.fromBufferAttribute(e,r),FI.fromBufferAttribute(e,i),a.setScalar(0),a.addScaledVector(II,s.x),a.addScaledVector(PI,s.y),a.addScaledVector(FI,s.z),a}static isFrontFacing(e,t,r,i){return kl.subVectors(r,t),zc.subVectors(e,t),kl.cross(zc).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return kl.subVectors(this.c,this.b),zc.subVectors(this.a,this.b),kl.cross(zc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return su.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return su.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,r,i,s){return su.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}containsPoint(e){return su.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return su.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,i=this.b,s=this.c;let a,o;f0.subVectors(i,r),p0.subVectors(s,r),DI.subVectors(e,r);const l=f0.dot(DI),u=p0.dot(DI);if(l<=0&&u<=0)return t.copy(r);NI.subVectors(e,i);const c=f0.dot(NI),h=p0.dot(NI);if(c>=0&&h<=c)return t.copy(i);const d=l*h-c*u;if(d<=0&&l>=0&&c<=0)return a=l/(l-c),t.copy(r).addScaledVector(f0,a);RI.subVectors(e,s);const f=f0.dot(RI),p=p0.dot(RI);if(p>=0&&f<=p)return t.copy(s);const m=f*u-l*p;if(m<=0&&u>=0&&p<=0)return o=u/(u-p),t.copy(r).addScaledVector(p0,o);const y=c*p-f*h;if(y<=0&&h-c>=0&&f-p>=0)return p9.subVectors(s,i),o=(h-c)/(h-c+(f-p)),t.copy(i).addScaledVector(p9,o);const v=1/(y+m+d);return a=m*v,o=d*v,t.copy(r).addScaledVector(f0,a).addScaledVector(p0,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Gee={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},zd={h:0,s:0,l:0},gT={h:0,s:0,l:0};function LI(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class Ft{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=dl){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,In.colorSpaceToWorking(this,t),this}setRGB(e,t,r,i=In.workingColorSpace){return this.r=e,this.g=t,this.b=r,In.colorSpaceToWorking(this,i),this}setHSL(e,t,r,i=In.workingColorSpace){if(e=x1e(e,1),t=An(t,0,1),r=An(r,0,1),t===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+t):r+t-r*t,a=2*r-s;this.r=LI(a,s,e+1/3),this.g=LI(a,s,e),this.b=LI(a,s,e-1/3)}return In.colorSpaceToWorking(this,i),this}setStyle(e,t=dl){function r(s){s!==void 0&&parseFloat(s)<1&&$t("Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=i[1],o=i[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:$t("Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(s,16),t);$t("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=dl){const r=Gee[e.toLowerCase()];return r!==void 0?this.setHex(r,t):$t("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Yh(e.r),this.g=Yh(e.g),this.b=Yh(e.b),this}copyLinearToSRGB(e){return this.r=Ay(e.r),this.g=Ay(e.g),this.b=Ay(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=dl){return In.workingToColorSpace(Bs.copy(this),e),Math.round(An(Bs.r*255,0,255))*65536+Math.round(An(Bs.g*255,0,255))*256+Math.round(An(Bs.b*255,0,255))}getHexString(e=dl){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=In.workingColorSpace){In.workingToColorSpace(Bs.copy(this),t);const r=Bs.r,i=Bs.g,s=Bs.b,a=Math.max(r,i,s),o=Math.min(r,i,s);let l,u;const c=(o+a)/2;if(o===a)l=0,u=0;else{const h=a-o;switch(u=c<=.5?h/(a+o):h/(2-a-o),a){case r:l=(i-s)/h+(i<s?6:0);break;case i:l=(s-r)/h+2;break;case s:l=(r-i)/h+4;break}l/=6}return e.h=l,e.s=u,e.l=c,e}getRGB(e,t=In.workingColorSpace){return In.workingToColorSpace(Bs.copy(this),t),e.r=Bs.r,e.g=Bs.g,e.b=Bs.b,e}getStyle(e=dl){In.workingToColorSpace(Bs.copy(this),e);const t=Bs.r,r=Bs.g,i=Bs.b;return e!==dl?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,t,r){return this.getHSL(zd),this.setHSL(zd.h+e,zd.s+t,zd.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(zd),e.getHSL(gT);const r=vI(zd.h,gT.h,t),i=vI(zd.s,gT.s,t),s=vI(zd.l,gT.l,t);return this.setHSL(r,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,i=this.b,s=e.elements;return this.r=s[0]*t+s[3]*r+s[6]*i,this.g=s[1]*t+s[4]*r+s[7]*i,this.b=s[2]*t+s[5]*r+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Bs=new Ft;Ft.NAMES=Gee;let P1e=0;class Vv extends Gb{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:P1e++}),this.uuid=eA(),this.name="",this.type="Material",this.blending=Sy,this.side=Ip,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=EL,this.blendDst=SL,this.blendEquation=Dm,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Ft(0,0,0),this.blendAlpha=0,this.depthFunc=mb,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=J8,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=s0,this.stencilZFail=s0,this.stencilZPass=s0,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){$t(`Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){$t(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(r.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(r.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Sy&&(r.blending=this.blending),this.side!==Ip&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==EL&&(r.blendSrc=this.blendSrc),this.blendDst!==SL&&(r.blendDst=this.blendDst),this.blendEquation!==Dm&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==mb&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==J8&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==s0&&(r.stencilFail=this.stencilFail),this.stencilZFail!==s0&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==s0&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.allowOverride===!1&&(r.allowOverride=!1),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const a=[];for(const o in s){const l=s[o];delete l.metadata,a.push(l)}return a}if(t){const s=i(e.textures),a=i(e.images);s.length>0&&(r.textures=s),a.length>0&&(r.images=a)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const i=t.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=t[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Zo extends Vv{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ft(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Tc,this.combine=R4,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const pi=new Ae,vT=new Cn;let F1e=0;class _s{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:F1e++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=e9,this.updateRanges=[],this.gpuType=ac,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)vT.fromBufferAttribute(this,t),vT.applyMatrix3(e),this.setXY(t,vT.x,vT.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)pi.fromBufferAttribute(this,t),pi.applyMatrix3(e),this.setXYZ(t,pi.x,pi.y,pi.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)pi.fromBufferAttribute(this,t),pi.applyMatrix4(e),this.setXYZ(t,pi.x,pi.y,pi.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)pi.fromBufferAttribute(this,t),pi.applyNormalMatrix(e),this.setXYZ(t,pi.x,pi.y,pi.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)pi.fromBufferAttribute(this,t),pi.transformDirection(e),this.setXYZ(t,pi.x,pi.y,pi.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=w_(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=Pa(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=w_(t,this.array)),t}setX(e,t){return this.normalized&&(t=Pa(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=w_(t,this.array)),t}setY(e,t){return this.normalized&&(t=Pa(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=w_(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Pa(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=w_(t,this.array)),t}setW(e,t){return this.normalized&&(t=Pa(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Pa(t,this.array),r=Pa(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=Pa(t,this.array),r=Pa(r,this.array),i=Pa(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=Pa(t,this.array),r=Pa(r,this.array),i=Pa(i,this.array),s=Pa(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==e9&&(e.usage=this.usage),e}}class jee extends _s{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class qee extends _s{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class Ar extends _s{constructor(e,t,r){super(new Float32Array(e),t,r)}}let L1e=0;const Xo=new Ir,OI=new Js,m0=new Ae,ao=new nA,T_=new nA,qi=new Ae;class Zr extends Gb{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:L1e++}),this.uuid=eA(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(zee(e)?qee:jee)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new sn().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Xo.makeRotationFromQuaternion(e),this.applyMatrix4(Xo),this}rotateX(e){return Xo.makeRotationX(e),this.applyMatrix4(Xo),this}rotateY(e){return Xo.makeRotationY(e),this.applyMatrix4(Xo),this}rotateZ(e){return Xo.makeRotationZ(e),this.applyMatrix4(Xo),this}translate(e,t,r){return Xo.makeTranslation(e,t,r),this.applyMatrix4(Xo),this}scale(e,t,r){return Xo.makeScale(e,t,r),this.applyMatrix4(Xo),this}lookAt(e){return OI.lookAt(e),OI.updateMatrix(),this.applyMatrix4(OI.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(m0).negate(),this.translate(m0.x,m0.y,m0.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const r=[];for(let i=0,s=e.length;i<s;i++){const a=e[i];r.push(a.x,a.y,a.z||0)}this.setAttribute("position",new Ar(r,3))}else{const r=Math.min(e.length,t.count);for(let i=0;i<r;i++){const s=e[i];t.setXYZ(i,s.x,s.y,s.z||0)}e.length>t.count&&$t("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new nA);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Bn("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Ae(-1/0,-1/0,-1/0),new Ae(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){const s=t[r];ao.setFromBufferAttribute(s),this.morphTargetsRelative?(qi.addVectors(this.boundingBox.min,ao.min),this.boundingBox.expandByPoint(qi),qi.addVectors(this.boundingBox.max,ao.max),this.boundingBox.expandByPoint(qi)):(this.boundingBox.expandByPoint(ao.min),this.boundingBox.expandByPoint(ao.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&Bn('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new rA);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Bn("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Ae,1/0);return}if(e){const r=this.boundingSphere.center;if(ao.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const o=t[s];T_.setFromBufferAttribute(o),this.morphTargetsRelative?(qi.addVectors(ao.min,T_.min),ao.expandByPoint(qi),qi.addVectors(ao.max,T_.max),ao.expandByPoint(qi)):(ao.expandByPoint(T_.min),ao.expandByPoint(T_.max))}ao.getCenter(r);let i=0;for(let s=0,a=e.count;s<a;s++)qi.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(qi));if(t)for(let s=0,a=t.length;s<a;s++){const o=t[s],l=this.morphTargetsRelative;for(let u=0,c=o.count;u<c;u++)qi.fromBufferAttribute(o,u),l&&(m0.fromBufferAttribute(e,u),qi.add(m0)),i=Math.max(i,r.distanceToSquared(qi))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&Bn('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){Bn("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=t.position,i=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new _s(new Float32Array(4*r.count),4));const a=this.getAttribute("tangent"),o=[],l=[];for(let T=0;T<r.count;T++)o[T]=new Ae,l[T]=new Ae;const u=new Ae,c=new Ae,h=new Ae,d=new Cn,f=new Cn,p=new Cn,m=new Ae,y=new Ae;function v(T,S,M){u.fromBufferAttribute(r,T),c.fromBufferAttribute(r,S),h.fromBufferAttribute(r,M),d.fromBufferAttribute(s,T),f.fromBufferAttribute(s,S),p.fromBufferAttribute(s,M),c.sub(u),h.sub(u),f.sub(d),p.sub(d);const D=1/(f.x*p.y-p.x*f.y);isFinite(D)&&(m.copy(c).multiplyScalar(p.y).addScaledVector(h,-f.y).multiplyScalar(D),y.copy(h).multiplyScalar(f.x).addScaledVector(c,-p.x).multiplyScalar(D),o[T].add(m),o[S].add(m),o[M].add(m),l[T].add(y),l[S].add(y),l[M].add(y))}let b=this.groups;b.length===0&&(b=[{start:0,count:e.count}]);for(let T=0,S=b.length;T<S;++T){const M=b[T],D=M.start,N=M.count;for(let R=D,O=D+N;R<O;R+=3)v(e.getX(R+0),e.getX(R+1),e.getX(R+2))}const x=new Ae,w=new Ae,_=new Ae,E=new Ae;function A(T){_.fromBufferAttribute(i,T),E.copy(_);const S=o[T];x.copy(S),x.sub(_.multiplyScalar(_.dot(S))).normalize(),w.crossVectors(E,S);const D=w.dot(l[T])<0?-1:1;a.setXYZW(T,x.x,x.y,x.z,D)}for(let T=0,S=b.length;T<S;++T){const M=b[T],D=M.start,N=M.count;for(let R=D,O=D+N;R<O;R+=3)A(e.getX(R+0)),A(e.getX(R+1)),A(e.getX(R+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new _s(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let d=0,f=r.count;d<f;d++)r.setXYZ(d,0,0,0);const i=new Ae,s=new Ae,a=new Ae,o=new Ae,l=new Ae,u=new Ae,c=new Ae,h=new Ae;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),m=e.getX(d+1),y=e.getX(d+2);i.fromBufferAttribute(t,p),s.fromBufferAttribute(t,m),a.fromBufferAttribute(t,y),c.subVectors(a,s),h.subVectors(i,s),c.cross(h),o.fromBufferAttribute(r,p),l.fromBufferAttribute(r,m),u.fromBufferAttribute(r,y),o.add(c),l.add(c),u.add(c),r.setXYZ(p,o.x,o.y,o.z),r.setXYZ(m,l.x,l.y,l.z),r.setXYZ(y,u.x,u.y,u.z)}else for(let d=0,f=t.count;d<f;d+=3)i.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),a.fromBufferAttribute(t,d+2),c.subVectors(a,s),h.subVectors(i,s),c.cross(h),r.setXYZ(d+0,c.x,c.y,c.z),r.setXYZ(d+1,c.x,c.y,c.z),r.setXYZ(d+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)qi.fromBufferAttribute(e,t),qi.normalize(),e.setXYZ(t,qi.x,qi.y,qi.z)}toNonIndexed(){function e(o,l){const u=o.array,c=o.itemSize,h=o.normalized,d=new u.constructor(l.length*c);let f=0,p=0;for(let m=0,y=l.length;m<y;m++){o.isInterleavedBufferAttribute?f=l[m]*o.data.stride+o.offset:f=l[m]*c;for(let v=0;v<c;v++)d[p++]=u[f++]}return new _s(d,c,h)}if(this.index===null)return $t("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Zr,r=this.index.array,i=this.attributes;for(const o in i){const l=i[o],u=e(l,r);t.setAttribute(o,u)}const s=this.morphAttributes;for(const o in s){const l=[],u=s[o];for(let c=0,h=u.length;c<h;c++){const d=u[c],f=e(d,r);l.push(f)}t.morphAttributes[o]=l}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,l=a.length;o<l;o++){const u=a[o];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const l in r){const u=r[l];e.data.attributes[l]=u.toJSON(e.data)}const i={};let s=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],c=[];for(let h=0,d=u.length;h<d;h++){const f=u[h];c.push(f.toJSON(e.data))}c.length>0&&(i[l]=c,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere=o.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone());const i=e.attributes;for(const u in i){const c=i[u];this.setAttribute(u,c.clone(t))}const s=e.morphAttributes;for(const u in s){const c=[],h=s[u];for(let d=0,f=h.length;d<f;d++)c.push(h[d].clone(t));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let u=0,c=a.length;u<c;u++){const h=a[u];this.addGroup(h.start,h.count,h.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const m9=new Ir,gm=new z4,yT=new rA,g9=new Ae,xT=new Ae,bT=new Ae,_T=new Ae,kI=new Ae,wT=new Ae,v9=new Ae,ET=new Ae;class qn extends Js{constructor(e=new Zr,t=new Zo){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(e,t){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,a=r.morphTargetsRelative;t.fromBufferAttribute(i,e);const o=this.morphTargetInfluences;if(s&&o){wT.set(0,0,0);for(let l=0,u=s.length;l<u;l++){const c=o[l],h=s[l];c!==0&&(kI.fromBufferAttribute(h,e),a?wT.addScaledVector(kI,c):wT.addScaledVector(kI.sub(t),c))}t.add(wT)}return t}raycast(e,t){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),yT.copy(r.boundingSphere),yT.applyMatrix4(s),gm.copy(e.ray).recast(e.near),!(yT.containsPoint(gm.origin)===!1&&(gm.intersectSphere(yT,g9)===null||gm.origin.distanceToSquared(g9)>(e.far-e.near)**2))&&(m9.copy(s).invert(),gm.copy(e.ray).applyMatrix4(m9),!(r.boundingBox!==null&&gm.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,t,gm)))}_computeIntersections(e,t,r){let i;const s=this.geometry,a=this.material,o=s.index,l=s.attributes.position,u=s.attributes.uv,c=s.attributes.uv1,h=s.attributes.normal,d=s.groups,f=s.drawRange;if(o!==null)if(Array.isArray(a))for(let p=0,m=d.length;p<m;p++){const y=d[p],v=a[y.materialIndex],b=Math.max(y.start,f.start),x=Math.min(o.count,Math.min(y.start+y.count,f.start+f.count));for(let w=b,_=x;w<_;w+=3){const E=o.getX(w),A=o.getX(w+1),T=o.getX(w+2);i=ST(this,v,e,r,u,c,h,E,A,T),i&&(i.faceIndex=Math.floor(w/3),i.face.materialIndex=y.materialIndex,t.push(i))}}else{const p=Math.max(0,f.start),m=Math.min(o.count,f.start+f.count);for(let y=p,v=m;y<v;y+=3){const b=o.getX(y),x=o.getX(y+1),w=o.getX(y+2);i=ST(this,a,e,r,u,c,h,b,x,w),i&&(i.faceIndex=Math.floor(y/3),t.push(i))}}else if(l!==void 0)if(Array.isArray(a))for(let p=0,m=d.length;p<m;p++){const y=d[p],v=a[y.materialIndex],b=Math.max(y.start,f.start),x=Math.min(l.count,Math.min(y.start+y.count,f.start+f.count));for(let w=b,_=x;w<_;w+=3){const E=w,A=w+1,T=w+2;i=ST(this,v,e,r,u,c,h,E,A,T),i&&(i.faceIndex=Math.floor(w/3),i.face.materialIndex=y.materialIndex,t.push(i))}}else{const p=Math.max(0,f.start),m=Math.min(l.count,f.start+f.count);for(let y=p,v=m;y<v;y+=3){const b=y,x=y+1,w=y+2;i=ST(this,a,e,r,u,c,h,b,x,w),i&&(i.faceIndex=Math.floor(y/3),t.push(i))}}}}function O1e(n,e,t,r,i,s,a,o){let l;if(e.side===eo?l=r.intersectTriangle(a,s,i,!0,o):l=r.intersectTriangle(i,s,a,e.side===Ip,o),l===null)return null;ET.copy(o),ET.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(ET);return u<t.near||u>t.far?null:{distance:u,point:ET.clone(),object:n}}function ST(n,e,t,r,i,s,a,o,l,u){n.getVertexPosition(o,xT),n.getVertexPosition(l,bT),n.getVertexPosition(u,_T);const c=O1e(n,e,t,r,xT,bT,_T,v9);if(c){const h=new Ae;su.getBarycoord(v9,xT,bT,_T,h),i&&(c.uv=su.getInterpolatedAttribute(i,o,l,u,h,new Cn)),s&&(c.uv1=su.getInterpolatedAttribute(s,o,l,u,h,new Cn)),a&&(c.normal=su.getInterpolatedAttribute(a,o,l,u,h,new Ae),c.normal.dot(r.direction)>0&&c.normal.multiplyScalar(-1));const d={a:o,b:l,c:u,normal:new Ae,materialIndex:0};su.getNormal(xT,bT,_T,d.normal),c.face=d,c.barycoord=h}return c}class iA extends Zr{constructor(e=1,t=1,r=1,i=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:s,depthSegments:a};const o=this;i=Math.floor(i),s=Math.floor(s),a=Math.floor(a);const l=[],u=[],c=[],h=[];let d=0,f=0;p("z","y","x",-1,-1,r,t,e,a,s,0),p("z","y","x",1,-1,r,t,-e,a,s,1),p("x","z","y",1,1,e,r,t,i,a,2),p("x","z","y",1,-1,e,r,-t,i,a,3),p("x","y","z",1,-1,e,t,r,i,s,4),p("x","y","z",-1,-1,e,t,-r,i,s,5),this.setIndex(l),this.setAttribute("position",new Ar(u,3)),this.setAttribute("normal",new Ar(c,3)),this.setAttribute("uv",new Ar(h,2));function p(m,y,v,b,x,w,_,E,A,T,S){const M=w/A,D=_/T,N=w/2,R=_/2,O=E/2,G=A+1,I=T+1;let B=0,$=0;const H=new Ae;for(let Q=0;Q<I;Q++){const ee=Q*D-R;for(let J=0;J<G;J++){const L=J*M-N;H[m]=L*b,H[y]=ee*x,H[v]=O,u.push(H.x,H.y,H.z),H[m]=0,H[y]=0,H[v]=E>0?1:-1,c.push(H.x,H.y,H.z),h.push(J/A),h.push(1-Q/T),B+=1}}for(let Q=0;Q<T;Q++)for(let ee=0;ee<A;ee++){const J=d+ee+G*Q,L=d+ee+G*(Q+1),se=d+(ee+1)+G*(Q+1),Z=d+(ee+1)+G*Q;l.push(J,L,Z),l.push(L,se,Z),$+=6}o.addGroup(f,$,S),f+=$,d+=B}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new iA(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function xb(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const i=n[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?($t("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=i.clone():Array.isArray(i)?e[t][r]=i.slice():e[t][r]=i}}return e}function ha(n){const e={};for(let t=0;t<n.length;t++){const r=xb(n[t]);for(const i in r)e[i]=r[i]}return e}function k1e(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function Wee(n){const e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:In.workingColorSpace}const B1e={clone:xb,merge:ha};var U1e=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,V1e=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Mc extends Vv{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=U1e,this.fragmentShader=V1e,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=xb(e.uniforms),this.uniformsGroups=k1e(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const a=this.uniforms[i].value;a&&a.isTexture?t.uniforms[i]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[i]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[i]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[i]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[i]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[i]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[i]={type:"m4",value:a.toArray()}:t.uniforms[i]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class Xee extends Js{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ir,this.projectionMatrix=new Ir,this.projectionMatrixInverse=new Ir,this.coordinateSystem=oc,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const $d=new Ae,y9=new Cn,x9=new Cn;class Ro extends Xee{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=pO*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(gI*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return pO*2*Math.atan(Math.tan(gI*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,r){$d.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set($d.x,$d.y).multiplyScalar(-e/$d.z),$d.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set($d.x,$d.y).multiplyScalar(-e/$d.z)}getViewSize(e,t){return this.getViewBounds(e,y9,x9),t.subVectors(x9,y9)}setViewOffset(e,t,r,i,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(gI*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,s=-.5*i;const a=this.view;if(this.view!==null&&this.view.enabled){const l=a.fullWidth,u=a.fullHeight;s+=a.offsetX*i/l,t-=a.offsetY*r/u,i*=a.width/l,r*=a.height/u}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-r,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const g0=-90,v0=1;class z1e extends Js{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new Ro(g0,v0,e,t);i.layers=this.layers,this.add(i);const s=new Ro(g0,v0,e,t);s.layers=this.layers,this.add(s);const a=new Ro(g0,v0,e,t);a.layers=this.layers,this.add(a);const o=new Ro(g0,v0,e,t);o.layers=this.layers,this.add(o);const l=new Ro(g0,v0,e,t);l.layers=this.layers,this.add(l);const u=new Ro(g0,v0,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,i,s,a,o,l]=t;for(const u of t)this.remove(u);if(e===oc)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===MD)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of t)this.add(u),u.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,o,l,u,c]=this.children,h=e.getRenderTarget(),d=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const m=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(t,s),e.setRenderTarget(r,1,i),e.render(t,a),e.setRenderTarget(r,2,i),e.render(t,o),e.setRenderTarget(r,3,i),e.render(t,l),e.setRenderTarget(r,4,i),e.render(t,u),r.texture.generateMipmaps=m,e.setRenderTarget(r,5,i),e.render(t,c),e.setRenderTarget(h,d,f),e.xr.enabled=p,r.texture.needsPMREMUpdate=!0}}class Kee extends wa{constructor(e=[],t=Cv,r,i,s,a,o,l,u,c){super(e,t,r,i,s,a,o,l,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Yee extends _c{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new Kee(i),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new iA(5,5,5),s=new Mc({name:"CubemapFromEquirect",uniforms:xb(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:eo,blending:Kh});s.uniforms.tEquirect.value=t;const a=new qn(i,s),o=t.minFilter;return t.minFilter===zm&&(t.minFilter=Zs),new z1e(1,10,this).update(e,a),t.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,t=!0,r=!0,i=!0){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,r,i);e.setRenderTarget(s)}}class AT extends Js{constructor(){super(),this.isGroup=!0,this.type="Group"}}const $1e={type:"move"};class BI{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new AT,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new AT,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ae,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ae),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new AT,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ae,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ae),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,s=null,a=null;const o=this._targetRay,l=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){a=!0;for(const m of e.hand.values()){const y=t.getJointPose(m,r),v=this._getHandJoint(u,m);y!==null&&(v.matrix.fromArray(y.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.matrixWorldNeedsUpdate=!0,v.jointRadius=y.radius),v.visible=y!==null}const c=u.joints["index-finger-tip"],h=u.joints["thumb-tip"],d=c.position.distanceTo(h.position),f=.02,p=.005;u.inputState.pinching&&d>f+p?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&d<=f-p&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,r),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));o!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent($1e)))}return o!==null&&(o.visible=i!==null),l!==null&&(l.visible=s!==null),u!==null&&(u.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const r=new AT;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}class Hc extends Js{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Tc,this.environmentIntensity=1,this.environmentRotation=new Tc,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class H1e extends wa{constructor(e=null,t=1,r=1,i,s,a,o,l,u=Ss,c=Ss,h,d){super(null,a,o,l,u,c,i,s,h,d),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const UI=new Ae,G1e=new Ae,j1e=new sn;class Mm{constructor(e=new Ae(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const i=UI.subVectors(r,t).cross(G1e.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(UI),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(e.start).addScaledVector(r,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||j1e.getNormalMatrix(e),i=this.coplanarPoint(UI).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const vm=new rA,q1e=new Cn(.5,.5),TT=new Ae;class $4{constructor(e=new Mm,t=new Mm,r=new Mm,i=new Mm,s=new Mm,a=new Mm){this.planes=[e,t,r,i,s,a]}set(e,t,r,i,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(r),o[3].copy(i),o[4].copy(s),o[5].copy(a),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=oc,r=!1){const i=this.planes,s=e.elements,a=s[0],o=s[1],l=s[2],u=s[3],c=s[4],h=s[5],d=s[6],f=s[7],p=s[8],m=s[9],y=s[10],v=s[11],b=s[12],x=s[13],w=s[14],_=s[15];if(i[0].setComponents(u-a,f-c,v-p,_-b).normalize(),i[1].setComponents(u+a,f+c,v+p,_+b).normalize(),i[2].setComponents(u+o,f+h,v+m,_+x).normalize(),i[3].setComponents(u-o,f-h,v-m,_-x).normalize(),r)i[4].setComponents(l,d,y,w).normalize(),i[5].setComponents(u-l,f-d,v-y,_-w).normalize();else if(i[4].setComponents(u-l,f-d,v-y,_-w).normalize(),t===oc)i[5].setComponents(u+l,f+d,v+y,_+w).normalize();else if(t===MD)i[5].setComponents(l,d,y,w).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),vm.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),vm.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(vm)}intersectsSprite(e){vm.center.set(0,0,0);const t=q1e.distanceTo(e.center);return vm.radius=.7071067811865476+t,vm.applyMatrix4(e.matrixWorld),this.intersectsSphere(vm)}intersectsSphere(e){const t=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const i=t[r];if(TT.x=i.normal.x>0?e.max.x:e.min.x,TT.y=i.normal.y>0?e.max.y:e.min.y,TT.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(TT)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class H4 extends Vv{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ft(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const DD=new Ae,ND=new Ae,b9=new Ir,M_=new z4,MT=new rA,VI=new Ae,_9=new Ae;class Qee extends Js{constructor(e=new Zr,t=new H4){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[0];for(let i=1,s=t.count;i<s;i++)DD.fromBufferAttribute(t,i-1),ND.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=DD.distanceTo(ND);e.setAttribute("lineDistance",new Ar(r,1))}else $t("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),MT.copy(r.boundingSphere),MT.applyMatrix4(i),MT.radius+=s,e.ray.intersectsSphere(MT)===!1)return;b9.copy(i).invert(),M_.copy(e.ray).applyMatrix4(b9);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,u=this.isLineSegments?2:1,c=r.index,d=r.attributes.position;if(c!==null){const f=Math.max(0,a.start),p=Math.min(c.count,a.start+a.count);for(let m=f,y=p-1;m<y;m+=u){const v=c.getX(m),b=c.getX(m+1),x=CT(this,e,M_,l,v,b,m);x&&t.push(x)}if(this.isLineLoop){const m=c.getX(p-1),y=c.getX(f),v=CT(this,e,M_,l,m,y,p-1);v&&t.push(v)}}else{const f=Math.max(0,a.start),p=Math.min(d.count,a.start+a.count);for(let m=f,y=p-1;m<y;m+=u){const v=CT(this,e,M_,l,m,m+1,m);v&&t.push(v)}if(this.isLineLoop){const m=CT(this,e,M_,l,p-1,f,p-1);m&&t.push(m)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function CT(n,e,t,r,i,s,a){const o=n.geometry.attributes.position;if(DD.fromBufferAttribute(o,i),ND.fromBufferAttribute(o,s),t.distanceSqToSegment(DD,ND,VI,_9)>r)return;VI.applyMatrix4(n.matrixWorld);const u=e.ray.origin.distanceTo(VI);if(!(u<e.near||u>e.far))return{distance:u,point:_9.clone().applyMatrix4(n.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:n}}const w9=new Ae,E9=new Ae;class W1e extends Qee{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[];for(let i=0,s=t.count;i<s;i+=2)w9.fromBufferAttribute(t,i),E9.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+w9.distanceTo(E9);e.setAttribute("lineDistance",new Ar(r,1))}else $t("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class B0 extends Vv{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ft(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const S9=new Ir,mO=new z4,DT=new rA,NT=new Ae;class C_ extends Js{constructor(e=new Zr,t=new B0){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),DT.copy(r.boundingSphere),DT.applyMatrix4(i),DT.radius+=s,e.ray.intersectsSphere(DT)===!1)return;S9.copy(i).invert(),mO.copy(e.ray).applyMatrix4(S9);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,u=r.index,h=r.attributes.position;if(u!==null){const d=Math.max(0,a.start),f=Math.min(u.count,a.start+a.count);for(let p=d,m=f;p<m;p++){const y=u.getX(p);NT.fromBufferAttribute(h,y),A9(NT,y,l,i,e,t,this)}}else{const d=Math.max(0,a.start),f=Math.min(h.count,a.start+a.count);for(let p=d,m=f;p<m;p++)NT.fromBufferAttribute(h,p),A9(NT,p,l,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function A9(n,e,t,r,i,s,a){const o=mO.distanceSqToPoint(n);if(o<t){const l=new Ae;mO.closestPointToPoint(n,l),l.applyMatrix4(r);const u=i.ray.origin.distanceTo(l);if(u<i.near||u>i.far)return;s.push({distance:u,distanceToRay:Math.sqrt(o),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}class Dw extends wa{constructor(e,t,r=Ac,i,s,a,o=Ss,l=Ss,u,c=md,h=1){if(c!==md&&c!==$m)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const d={width:e,height:t,depth:h};super(d,i,s,a,o,l,c,r,u),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new V4(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class X1e extends Dw{constructor(e,t=Ac,r=Cv,i,s,a=Ss,o=Ss,l,u=md){const c={width:e,height:e,depth:1},h=[c,c,c,c,c,c];super(e,e,t,r,i,s,a,o,l,u),this.image=h,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class Zee extends wa{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class G4 extends Zr{constructor(e=1,t=1,r=1,i=32,s=1,a=!1,o=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l};const u=this;i=Math.floor(i),s=Math.floor(s);const c=[],h=[],d=[],f=[];let p=0;const m=[],y=r/2;let v=0;b(),a===!1&&(e>0&&x(!0),t>0&&x(!1)),this.setIndex(c),this.setAttribute("position",new Ar(h,3)),this.setAttribute("normal",new Ar(d,3)),this.setAttribute("uv",new Ar(f,2));function b(){const w=new Ae,_=new Ae;let E=0;const A=(t-e)/r;for(let T=0;T<=s;T++){const S=[],M=T/s,D=M*(t-e)+e;for(let N=0;N<=i;N++){const R=N/i,O=R*l+o,G=Math.sin(O),I=Math.cos(O);_.x=D*G,_.y=-M*r+y,_.z=D*I,h.push(_.x,_.y,_.z),w.set(G,A,I).normalize(),d.push(w.x,w.y,w.z),f.push(R,1-M),S.push(p++)}m.push(S)}for(let T=0;T<i;T++)for(let S=0;S<s;S++){const M=m[S][T],D=m[S+1][T],N=m[S+1][T+1],R=m[S][T+1];(e>0||S!==0)&&(c.push(M,D,R),E+=3),(t>0||S!==s-1)&&(c.push(D,N,R),E+=3)}u.addGroup(v,E,0),v+=E}function x(w){const _=p,E=new Cn,A=new Ae;let T=0;const S=w===!0?e:t,M=w===!0?1:-1;for(let N=1;N<=i;N++)h.push(0,y*M,0),d.push(0,M,0),f.push(.5,.5),p++;const D=p;for(let N=0;N<=i;N++){const O=N/i*l+o,G=Math.cos(O),I=Math.sin(O);A.x=S*I,A.y=y*M,A.z=S*G,h.push(A.x,A.y,A.z),d.push(0,M,0),E.x=G*.5+.5,E.y=I*.5*M+.5,f.push(E.x,E.y),p++}for(let N=0;N<i;N++){const R=_+N,O=D+N;w===!0?c.push(O,O+1,R):c.push(O+1,O,R),T+=3}u.addGroup(v,T,w===!0?1:2),v+=T}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new G4(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class j4 extends G4{constructor(e=1,t=1,r=32,i=1,s=!1,a=0,o=Math.PI*2){super(0,e,t,r,i,s,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:s,thetaStart:a,thetaLength:o}}static fromJSON(e){return new j4(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class q4 extends Zr{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};const s=[],a=[];o(i),u(r),c(),this.setAttribute("position",new Ar(s,3)),this.setAttribute("normal",new Ar(s.slice(),3)),this.setAttribute("uv",new Ar(a,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function o(b){const x=new Ae,w=new Ae,_=new Ae;for(let E=0;E<t.length;E+=3)f(t[E+0],x),f(t[E+1],w),f(t[E+2],_),l(x,w,_,b)}function l(b,x,w,_){const E=_+1,A=[];for(let T=0;T<=E;T++){A[T]=[];const S=b.clone().lerp(w,T/E),M=x.clone().lerp(w,T/E),D=E-T;for(let N=0;N<=D;N++)N===0&&T===E?A[T][N]=S:A[T][N]=S.clone().lerp(M,N/D)}for(let T=0;T<E;T++)for(let S=0;S<2*(E-T)-1;S++){const M=Math.floor(S/2);S%2===0?(d(A[T][M+1]),d(A[T+1][M]),d(A[T][M])):(d(A[T][M+1]),d(A[T+1][M+1]),d(A[T+1][M]))}}function u(b){const x=new Ae;for(let w=0;w<s.length;w+=3)x.x=s[w+0],x.y=s[w+1],x.z=s[w+2],x.normalize().multiplyScalar(b),s[w+0]=x.x,s[w+1]=x.y,s[w+2]=x.z}function c(){const b=new Ae;for(let x=0;x<s.length;x+=3){b.x=s[x+0],b.y=s[x+1],b.z=s[x+2];const w=y(b)/2/Math.PI+.5,_=v(b)/Math.PI+.5;a.push(w,1-_)}p(),h()}function h(){for(let b=0;b<a.length;b+=6){const x=a[b+0],w=a[b+2],_=a[b+4],E=Math.max(x,w,_),A=Math.min(x,w,_);E>.9&&A<.1&&(x<.2&&(a[b+0]+=1),w<.2&&(a[b+2]+=1),_<.2&&(a[b+4]+=1))}}function d(b){s.push(b.x,b.y,b.z)}function f(b,x){const w=b*3;x.x=e[w+0],x.y=e[w+1],x.z=e[w+2]}function p(){const b=new Ae,x=new Ae,w=new Ae,_=new Ae,E=new Cn,A=new Cn,T=new Cn;for(let S=0,M=0;S<s.length;S+=9,M+=6){b.set(s[S+0],s[S+1],s[S+2]),x.set(s[S+3],s[S+4],s[S+5]),w.set(s[S+6],s[S+7],s[S+8]),E.set(a[M+0],a[M+1]),A.set(a[M+2],a[M+3]),T.set(a[M+4],a[M+5]),_.copy(b).add(x).add(w).divideScalar(3);const D=y(_);m(E,M+0,b,D),m(A,M+2,x,D),m(T,M+4,w,D)}}function m(b,x,w,_){_<0&&b.x===1&&(a[x]=b.x-1),w.x===0&&w.z===0&&(a[x]=_/2/Math.PI+.5)}function y(b){return Math.atan2(b.z,-b.x)}function v(b){return Math.atan2(-b.y,Math.sqrt(b.x*b.x+b.z*b.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new q4(e.vertices,e.indices,e.radius,e.detail)}}class RD extends q4{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new RD(e.radius,e.detail)}}class TN extends Zr{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};const s=e/2,a=t/2,o=Math.floor(r),l=Math.floor(i),u=o+1,c=l+1,h=e/o,d=t/l,f=[],p=[],m=[],y=[];for(let v=0;v<c;v++){const b=v*d-a;for(let x=0;x<u;x++){const w=x*h-s;p.push(w,-b,0),m.push(0,0,1),y.push(x/o),y.push(1-v/l)}}for(let v=0;v<l;v++)for(let b=0;b<o;b++){const x=b+u*v,w=b+u*(v+1),_=b+1+u*(v+1),E=b+1+u*v;f.push(x,w,E),f.push(w,_,E)}this.setIndex(f),this.setAttribute("position",new Ar(p,3)),this.setAttribute("normal",new Ar(m,3)),this.setAttribute("uv",new Ar(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new TN(e.width,e.height,e.widthSegments,e.heightSegments)}}class zl extends Zr{constructor(e=1,t=32,r=16,i=0,s=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:s,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const l=Math.min(a+o,Math.PI);let u=0;const c=[],h=new Ae,d=new Ae,f=[],p=[],m=[],y=[];for(let v=0;v<=r;v++){const b=[],x=v/r;let w=0;v===0&&a===0?w=.5/t:v===r&&l===Math.PI&&(w=-.5/t);for(let _=0;_<=t;_++){const E=_/t;h.x=-e*Math.cos(i+E*s)*Math.sin(a+x*o),h.y=e*Math.cos(a+x*o),h.z=e*Math.sin(i+E*s)*Math.sin(a+x*o),p.push(h.x,h.y,h.z),d.copy(h).normalize(),m.push(d.x,d.y,d.z),y.push(E+w,1-x),b.push(u++)}c.push(b)}for(let v=0;v<r;v++)for(let b=0;b<t;b++){const x=c[v][b+1],w=c[v][b],_=c[v+1][b],E=c[v+1][b+1];(v!==0||a>0)&&f.push(x,w,E),(v!==r-1||l<Math.PI)&&f.push(w,_,E)}this.setIndex(f),this.setAttribute("position",new Ar(p,3)),this.setAttribute("normal",new Ar(m,3)),this.setAttribute("uv",new Ar(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new zl(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Zc extends Zr{constructor(e=1,t=.4,r=12,i=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:s},r=Math.floor(r),i=Math.floor(i);const a=[],o=[],l=[],u=[],c=new Ae,h=new Ae,d=new Ae;for(let f=0;f<=r;f++)for(let p=0;p<=i;p++){const m=p/i*s,y=f/r*Math.PI*2;h.x=(e+t*Math.cos(y))*Math.cos(m),h.y=(e+t*Math.cos(y))*Math.sin(m),h.z=t*Math.sin(y),o.push(h.x,h.y,h.z),c.x=e*Math.cos(m),c.y=e*Math.sin(m),d.subVectors(h,c).normalize(),l.push(d.x,d.y,d.z),u.push(p/i),u.push(f/r)}for(let f=1;f<=r;f++)for(let p=1;p<=i;p++){const m=(i+1)*f+p-1,y=(i+1)*(f-1)+p-1,v=(i+1)*(f-1)+p,b=(i+1)*f+p;a.push(m,y,b),a.push(y,v,b)}this.setIndex(a),this.setAttribute("position",new Ar(o,3)),this.setAttribute("normal",new Ar(l,3)),this.setAttribute("uv",new Ar(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Zc(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class K1e extends Mc{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Gc extends Vv{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ft(16777215),this.specular=new Ft(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ft(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Vee,this.normalScale=new Cn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Tc,this.combine=R4,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Y1e extends Vv{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=u1e,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Q1e extends Vv{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class Jee extends Js{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ft(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}const zI=new Ir,T9=new Ae,M9=new Ae;class Z1e{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Cn(512,512),this.mapType=Fo,this.map=null,this.mapPass=null,this.matrix=new Ir,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new $4,this._frameExtents=new Cn(1,1),this._viewportCount=1,this._viewports=[new ei(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;T9.setFromMatrixPosition(e.matrixWorld),t.position.copy(T9),M9.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(M9),t.updateMatrixWorld(),zI.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(zI,t.coordinateSystem,t.reversedDepth),t.reversedDepth?r.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(zI)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class J1e extends Z1e{constructor(){super(new Ro(90,1,.5,500)),this.isPointLightShadow=!0}}class Nu extends Jee{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new J1e}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class ete extends Xee{constructor(e=-1,t=1,r=1,i=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,a=r+e,o=i+t,l=i-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,a=s+u*this.view.width,o-=c*this.view.offsetY,l=o-c*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,l,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class jc extends Jee{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class ewe extends Ro{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class twe extends W1e{constructor(e=10,t=10,r=4473924,i=8947848){r=new Ft(r),i=new Ft(i);const s=t/2,a=e/t,o=e/2,l=[],u=[];for(let d=0,f=0,p=-o;d<=t;d++,p+=a){l.push(-o,0,p,o,0,p),l.push(p,0,-o,p,0,o);const m=d===s?r:i;m.toArray(u,f),f+=3,m.toArray(u,f),f+=3,m.toArray(u,f),f+=3,m.toArray(u,f),f+=3}const c=new Zr;c.setAttribute("position",new Ar(l,3)),c.setAttribute("color",new Ar(u,3));const h=new H4({vertexColors:!0,toneMapped:!1});super(c,h),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}function C9(n,e,t,r){const i=nwe(r);switch(t){case kee:return n*e;case Uee:return n*e/i.components*i.byteLength;case L4:return n*e/i.components*i.byteLength;case vb:return n*e*2/i.components*i.byteLength;case O4:return n*e*2/i.components*i.byteLength;case Bee:return n*e*3/i.components*i.byteLength;case lu:return n*e*4/i.components*i.byteLength;case k4:return n*e*4/i.components*i.byteLength;case lC:case uC:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case cC:case hC:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case kL:case UL:return Math.max(n,16)*Math.max(e,8)/4;case OL:case BL:return Math.max(n,8)*Math.max(e,8)/2;case VL:case zL:case HL:case GL:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case $L:case jL:case qL:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case WL:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case XL:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case KL:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case YL:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case QL:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case ZL:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case JL:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case eO:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case tO:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case nO:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case rO:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case iO:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case sO:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case aO:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case oO:case lO:case uO:return Math.ceil(n/4)*Math.ceil(e/4)*16;case cO:case hO:return Math.ceil(n/4)*Math.ceil(e/4)*8;case dO:case fO:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function nwe(n){switch(n){case Fo:case Pee:return{byteLength:1,components:1};case Tw:case Fee:case pd:return{byteLength:2,components:1};case P4:case F4:return{byteLength:2,components:4};case Ac:case I4:case ac:return{byteLength:4,components:1};case Lee:case Oee:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:N4}}));typeof window<"u"&&(window.__THREE__?$t("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=N4);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function tte(){let n=null,e=!1,t=null,r=null;function i(s,a){t(s,a),r=n.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(i),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function rwe(n){const e=new WeakMap;function t(o,l){const u=o.array,c=o.usage,h=u.byteLength,d=n.createBuffer();n.bindBuffer(l,d),n.bufferData(l,u,c),o.onUploadCallback();let f;if(u instanceof Float32Array)f=n.FLOAT;else if(typeof Float16Array<"u"&&u instanceof Float16Array)f=n.HALF_FLOAT;else if(u instanceof Uint16Array)o.isFloat16BufferAttribute?f=n.HALF_FLOAT:f=n.UNSIGNED_SHORT;else if(u instanceof Int16Array)f=n.SHORT;else if(u instanceof Uint32Array)f=n.UNSIGNED_INT;else if(u instanceof Int32Array)f=n.INT;else if(u instanceof Int8Array)f=n.BYTE;else if(u instanceof Uint8Array)f=n.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)f=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:d,type:f,bytesPerElement:u.BYTES_PER_ELEMENT,version:o.version,size:h}}function r(o,l,u){const c=l.array,h=l.updateRanges;if(n.bindBuffer(u,o),h.length===0)n.bufferSubData(u,0,c);else{h.sort((f,p)=>f.start-p.start);let d=0;for(let f=1;f<h.length;f++){const p=h[d],m=h[f];m.start<=p.start+p.count+1?p.count=Math.max(p.count,m.start+m.count-p.start):(++d,h[d]=m)}h.length=d+1;for(let f=0,p=h.length;f<p;f++){const m=h[f];n.bufferSubData(u,m.start*c.BYTES_PER_ELEMENT,c,m.start,m.count)}l.clearUpdateRanges()}l.onUploadCallback()}function i(o){return o.isInterleavedBufferAttribute&&(o=o.data),e.get(o)}function s(o){o.isInterleavedBufferAttribute&&(o=o.data);const l=e.get(o);l&&(n.deleteBuffer(l.buffer),e.delete(o))}function a(o,l){if(o.isInterleavedBufferAttribute&&(o=o.data),o.isGLBufferAttribute){const c=e.get(o);(!c||c.version<o.version)&&e.set(o,{buffer:o.buffer,type:o.type,bytesPerElement:o.elementSize,version:o.version});return}const u=e.get(o);if(u===void 0)e.set(o,t(o,l));else if(u.version<o.version){if(u.size!==o.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");r(u.buffer,o,l),u.version=o.version}}return{get:i,remove:s,update:a}}var iwe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,swe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,awe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,owe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,lwe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,uwe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,cwe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,hwe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,dwe=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,fwe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,pwe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,mwe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,gwe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,vwe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,ywe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,xwe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,bwe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,_we=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,wwe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Ewe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Swe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Awe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,Twe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Mwe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Cwe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Dwe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Nwe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Rwe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Iwe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Pwe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Fwe="gl_FragColor = linearToOutputTexel( gl_FragColor );",Lwe=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Owe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,kwe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,Bwe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Uwe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Vwe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,zwe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,$we=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Hwe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Gwe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,jwe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,qwe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Wwe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Xwe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Kwe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Ywe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Qwe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Zwe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Jwe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,eEe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,tEe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,nEe=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,rEe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,iEe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,sEe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,aEe=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,oEe=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,lEe=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,uEe=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,cEe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,hEe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,dEe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,fEe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,pEe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,mEe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,gEe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,vEe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,yEe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,xEe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,bEe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,_Ee=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,wEe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,EEe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,SEe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,AEe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,TEe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,MEe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,CEe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,DEe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,NEe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,REe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,IEe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,PEe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,FEe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,LEe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,OEe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,kEe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,BEe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,UEe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadow = step( depth, dp );
			#else
				shadow = step( dp, depth );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,VEe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,zEe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,$Ee=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,HEe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,GEe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,jEe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,qEe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,WEe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,XEe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,KEe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,YEe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,QEe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,ZEe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,JEe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,eSe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,tSe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,nSe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const rSe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,iSe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,sSe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,aSe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,oSe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,lSe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,uSe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,cSe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,hSe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,dSe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,fSe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,pSe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,mSe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,gSe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vSe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,ySe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,xSe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,bSe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_Se=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,wSe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ESe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,SSe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,ASe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,TSe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,MSe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,CSe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,DSe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,NSe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,RSe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,ISe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,PSe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,FSe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,LSe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,OSe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,un={alphahash_fragment:iwe,alphahash_pars_fragment:swe,alphamap_fragment:awe,alphamap_pars_fragment:owe,alphatest_fragment:lwe,alphatest_pars_fragment:uwe,aomap_fragment:cwe,aomap_pars_fragment:hwe,batching_pars_vertex:dwe,batching_vertex:fwe,begin_vertex:pwe,beginnormal_vertex:mwe,bsdfs:gwe,iridescence_fragment:vwe,bumpmap_pars_fragment:ywe,clipping_planes_fragment:xwe,clipping_planes_pars_fragment:bwe,clipping_planes_pars_vertex:_we,clipping_planes_vertex:wwe,color_fragment:Ewe,color_pars_fragment:Swe,color_pars_vertex:Awe,color_vertex:Twe,common:Mwe,cube_uv_reflection_fragment:Cwe,defaultnormal_vertex:Dwe,displacementmap_pars_vertex:Nwe,displacementmap_vertex:Rwe,emissivemap_fragment:Iwe,emissivemap_pars_fragment:Pwe,colorspace_fragment:Fwe,colorspace_pars_fragment:Lwe,envmap_fragment:Owe,envmap_common_pars_fragment:kwe,envmap_pars_fragment:Bwe,envmap_pars_vertex:Uwe,envmap_physical_pars_fragment:Ywe,envmap_vertex:Vwe,fog_vertex:zwe,fog_pars_vertex:$we,fog_fragment:Hwe,fog_pars_fragment:Gwe,gradientmap_pars_fragment:jwe,lightmap_pars_fragment:qwe,lights_lambert_fragment:Wwe,lights_lambert_pars_fragment:Xwe,lights_pars_begin:Kwe,lights_toon_fragment:Qwe,lights_toon_pars_fragment:Zwe,lights_phong_fragment:Jwe,lights_phong_pars_fragment:eEe,lights_physical_fragment:tEe,lights_physical_pars_fragment:nEe,lights_fragment_begin:rEe,lights_fragment_maps:iEe,lights_fragment_end:sEe,logdepthbuf_fragment:aEe,logdepthbuf_pars_fragment:oEe,logdepthbuf_pars_vertex:lEe,logdepthbuf_vertex:uEe,map_fragment:cEe,map_pars_fragment:hEe,map_particle_fragment:dEe,map_particle_pars_fragment:fEe,metalnessmap_fragment:pEe,metalnessmap_pars_fragment:mEe,morphinstance_vertex:gEe,morphcolor_vertex:vEe,morphnormal_vertex:yEe,morphtarget_pars_vertex:xEe,morphtarget_vertex:bEe,normal_fragment_begin:_Ee,normal_fragment_maps:wEe,normal_pars_fragment:EEe,normal_pars_vertex:SEe,normal_vertex:AEe,normalmap_pars_fragment:TEe,clearcoat_normal_fragment_begin:MEe,clearcoat_normal_fragment_maps:CEe,clearcoat_pars_fragment:DEe,iridescence_pars_fragment:NEe,opaque_fragment:REe,packing:IEe,premultiplied_alpha_fragment:PEe,project_vertex:FEe,dithering_fragment:LEe,dithering_pars_fragment:OEe,roughnessmap_fragment:kEe,roughnessmap_pars_fragment:BEe,shadowmap_pars_fragment:UEe,shadowmap_pars_vertex:VEe,shadowmap_vertex:zEe,shadowmask_pars_fragment:$Ee,skinbase_vertex:HEe,skinning_pars_vertex:GEe,skinning_vertex:jEe,skinnormal_vertex:qEe,specularmap_fragment:WEe,specularmap_pars_fragment:XEe,tonemapping_fragment:KEe,tonemapping_pars_fragment:YEe,transmission_fragment:QEe,transmission_pars_fragment:ZEe,uv_pars_fragment:JEe,uv_pars_vertex:eSe,uv_vertex:tSe,worldpos_vertex:nSe,background_vert:rSe,background_frag:iSe,backgroundCube_vert:sSe,backgroundCube_frag:aSe,cube_vert:oSe,cube_frag:lSe,depth_vert:uSe,depth_frag:cSe,distance_vert:hSe,distance_frag:dSe,equirect_vert:fSe,equirect_frag:pSe,linedashed_vert:mSe,linedashed_frag:gSe,meshbasic_vert:vSe,meshbasic_frag:ySe,meshlambert_vert:xSe,meshlambert_frag:bSe,meshmatcap_vert:_Se,meshmatcap_frag:wSe,meshnormal_vert:ESe,meshnormal_frag:SSe,meshphong_vert:ASe,meshphong_frag:TSe,meshphysical_vert:MSe,meshphysical_frag:CSe,meshtoon_vert:DSe,meshtoon_frag:NSe,points_vert:RSe,points_frag:ISe,shadow_vert:PSe,shadow_frag:FSe,sprite_vert:LSe,sprite_frag:OSe},lt={common:{diffuse:{value:new Ft(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new sn},alphaMap:{value:null},alphaMapTransform:{value:new sn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new sn}},envmap:{envMap:{value:null},envMapRotation:{value:new sn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new sn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new sn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new sn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new sn},normalScale:{value:new Cn(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new sn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new sn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new sn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new sn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ft(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ft(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new sn},alphaTest:{value:0},uvTransform:{value:new sn}},sprite:{diffuse:{value:new Ft(16777215)},opacity:{value:1},center:{value:new Cn(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new sn},alphaMap:{value:null},alphaMapTransform:{value:new sn},alphaTest:{value:0}}},rc={basic:{uniforms:ha([lt.common,lt.specularmap,lt.envmap,lt.aomap,lt.lightmap,lt.fog]),vertexShader:un.meshbasic_vert,fragmentShader:un.meshbasic_frag},lambert:{uniforms:ha([lt.common,lt.specularmap,lt.envmap,lt.aomap,lt.lightmap,lt.emissivemap,lt.bumpmap,lt.normalmap,lt.displacementmap,lt.fog,lt.lights,{emissive:{value:new Ft(0)}}]),vertexShader:un.meshlambert_vert,fragmentShader:un.meshlambert_frag},phong:{uniforms:ha([lt.common,lt.specularmap,lt.envmap,lt.aomap,lt.lightmap,lt.emissivemap,lt.bumpmap,lt.normalmap,lt.displacementmap,lt.fog,lt.lights,{emissive:{value:new Ft(0)},specular:{value:new Ft(1118481)},shininess:{value:30}}]),vertexShader:un.meshphong_vert,fragmentShader:un.meshphong_frag},standard:{uniforms:ha([lt.common,lt.envmap,lt.aomap,lt.lightmap,lt.emissivemap,lt.bumpmap,lt.normalmap,lt.displacementmap,lt.roughnessmap,lt.metalnessmap,lt.fog,lt.lights,{emissive:{value:new Ft(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:un.meshphysical_vert,fragmentShader:un.meshphysical_frag},toon:{uniforms:ha([lt.common,lt.aomap,lt.lightmap,lt.emissivemap,lt.bumpmap,lt.normalmap,lt.displacementmap,lt.gradientmap,lt.fog,lt.lights,{emissive:{value:new Ft(0)}}]),vertexShader:un.meshtoon_vert,fragmentShader:un.meshtoon_frag},matcap:{uniforms:ha([lt.common,lt.bumpmap,lt.normalmap,lt.displacementmap,lt.fog,{matcap:{value:null}}]),vertexShader:un.meshmatcap_vert,fragmentShader:un.meshmatcap_frag},points:{uniforms:ha([lt.points,lt.fog]),vertexShader:un.points_vert,fragmentShader:un.points_frag},dashed:{uniforms:ha([lt.common,lt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:un.linedashed_vert,fragmentShader:un.linedashed_frag},depth:{uniforms:ha([lt.common,lt.displacementmap]),vertexShader:un.depth_vert,fragmentShader:un.depth_frag},normal:{uniforms:ha([lt.common,lt.bumpmap,lt.normalmap,lt.displacementmap,{opacity:{value:1}}]),vertexShader:un.meshnormal_vert,fragmentShader:un.meshnormal_frag},sprite:{uniforms:ha([lt.sprite,lt.fog]),vertexShader:un.sprite_vert,fragmentShader:un.sprite_frag},background:{uniforms:{uvTransform:{value:new sn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:un.background_vert,fragmentShader:un.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new sn}},vertexShader:un.backgroundCube_vert,fragmentShader:un.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:un.cube_vert,fragmentShader:un.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:un.equirect_vert,fragmentShader:un.equirect_frag},distance:{uniforms:ha([lt.common,lt.displacementmap,{referencePosition:{value:new Ae},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:un.distance_vert,fragmentShader:un.distance_frag},shadow:{uniforms:ha([lt.lights,lt.fog,{color:{value:new Ft(0)},opacity:{value:1}}]),vertexShader:un.shadow_vert,fragmentShader:un.shadow_frag}};rc.physical={uniforms:ha([rc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new sn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new sn},clearcoatNormalScale:{value:new Cn(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new sn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new sn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new sn},sheen:{value:0},sheenColor:{value:new Ft(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new sn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new sn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new sn},transmissionSamplerSize:{value:new Cn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new sn},attenuationDistance:{value:0},attenuationColor:{value:new Ft(0)},specularColor:{value:new Ft(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new sn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new sn},anisotropyVector:{value:new Cn},anisotropyMap:{value:null},anisotropyMapTransform:{value:new sn}}]),vertexShader:un.meshphysical_vert,fragmentShader:un.meshphysical_frag};const RT={r:0,b:0,g:0},ym=new Tc,kSe=new Ir;function BSe(n,e,t,r,i,s,a){const o=new Ft(0);let l=s===!0?0:1,u,c,h=null,d=0,f=null;function p(x){let w=x.isScene===!0?x.background:null;return w&&w.isTexture&&(w=(x.backgroundBlurriness>0?t:e).get(w)),w}function m(x){let w=!1;const _=p(x);_===null?v(o,l):_&&_.isColor&&(v(_,1),w=!0);const E=n.xr.getEnvironmentBlendMode();E==="additive"?r.buffers.color.setClear(0,0,0,1,a):E==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,a),(n.autoClear||w)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function y(x,w){const _=p(w);_&&(_.isCubeTexture||_.mapping===AN)?(c===void 0&&(c=new qn(new iA(1,1,1),new Mc({name:"BackgroundCubeMaterial",uniforms:xb(rc.backgroundCube.uniforms),vertexShader:rc.backgroundCube.vertexShader,fragmentShader:rc.backgroundCube.fragmentShader,side:eo,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(E,A,T){this.matrixWorld.copyPosition(T.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),ym.copy(w.backgroundRotation),ym.x*=-1,ym.y*=-1,ym.z*=-1,_.isCubeTexture&&_.isRenderTargetTexture===!1&&(ym.y*=-1,ym.z*=-1),c.material.uniforms.envMap.value=_,c.material.uniforms.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,c.material.uniforms.backgroundBlurriness.value=w.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(kSe.makeRotationFromEuler(ym)),c.material.toneMapped=In.getTransfer(_.colorSpace)!==Wn,(h!==_||d!==_.version||f!==n.toneMapping)&&(c.material.needsUpdate=!0,h=_,d=_.version,f=n.toneMapping),c.layers.enableAll(),x.unshift(c,c.geometry,c.material,0,0,null)):_&&_.isTexture&&(u===void 0&&(u=new qn(new TN(2,2),new Mc({name:"BackgroundMaterial",uniforms:xb(rc.background.uniforms),vertexShader:rc.background.vertexShader,fragmentShader:rc.background.fragmentShader,side:Ip,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(u)),u.material.uniforms.t2D.value=_,u.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,u.material.toneMapped=In.getTransfer(_.colorSpace)!==Wn,_.matrixAutoUpdate===!0&&_.updateMatrix(),u.material.uniforms.uvTransform.value.copy(_.matrix),(h!==_||d!==_.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,h=_,d=_.version,f=n.toneMapping),u.layers.enableAll(),x.unshift(u,u.geometry,u.material,0,0,null))}function v(x,w){x.getRGB(RT,Wee(n)),r.buffers.color.setClear(RT.r,RT.g,RT.b,w,a)}function b(){c!==void 0&&(c.geometry.dispose(),c.material.dispose(),c=void 0),u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0)}return{getClearColor:function(){return o},setClearColor:function(x,w=1){o.set(x),l=w,v(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(x){l=x,v(o,l)},render:m,addToRenderList:y,dispose:b}}function USe(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),r={},i=d(null);let s=i,a=!1;function o(M,D,N,R,O){let G=!1;const I=h(R,N,D);s!==I&&(s=I,u(s.object)),G=f(M,R,N,O),G&&p(M,R,N,O),O!==null&&e.update(O,n.ELEMENT_ARRAY_BUFFER),(G||a)&&(a=!1,w(M,D,N,R),O!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(O).buffer))}function l(){return n.createVertexArray()}function u(M){return n.bindVertexArray(M)}function c(M){return n.deleteVertexArray(M)}function h(M,D,N){const R=N.wireframe===!0;let O=r[M.id];O===void 0&&(O={},r[M.id]=O);let G=O[D.id];G===void 0&&(G={},O[D.id]=G);let I=G[R];return I===void 0&&(I=d(l()),G[R]=I),I}function d(M){const D=[],N=[],R=[];for(let O=0;O<t;O++)D[O]=0,N[O]=0,R[O]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:D,enabledAttributes:N,attributeDivisors:R,object:M,attributes:{},index:null}}function f(M,D,N,R){const O=s.attributes,G=D.attributes;let I=0;const B=N.getAttributes();for(const $ in B)if(B[$].location>=0){const Q=O[$];let ee=G[$];if(ee===void 0&&($==="instanceMatrix"&&M.instanceMatrix&&(ee=M.instanceMatrix),$==="instanceColor"&&M.instanceColor&&(ee=M.instanceColor)),Q===void 0||Q.attribute!==ee||ee&&Q.data!==ee.data)return!0;I++}return s.attributesNum!==I||s.index!==R}function p(M,D,N,R){const O={},G=D.attributes;let I=0;const B=N.getAttributes();for(const $ in B)if(B[$].location>=0){let Q=G[$];Q===void 0&&($==="instanceMatrix"&&M.instanceMatrix&&(Q=M.instanceMatrix),$==="instanceColor"&&M.instanceColor&&(Q=M.instanceColor));const ee={};ee.attribute=Q,Q&&Q.data&&(ee.data=Q.data),O[$]=ee,I++}s.attributes=O,s.attributesNum=I,s.index=R}function m(){const M=s.newAttributes;for(let D=0,N=M.length;D<N;D++)M[D]=0}function y(M){v(M,0)}function v(M,D){const N=s.newAttributes,R=s.enabledAttributes,O=s.attributeDivisors;N[M]=1,R[M]===0&&(n.enableVertexAttribArray(M),R[M]=1),O[M]!==D&&(n.vertexAttribDivisor(M,D),O[M]=D)}function b(){const M=s.newAttributes,D=s.enabledAttributes;for(let N=0,R=D.length;N<R;N++)D[N]!==M[N]&&(n.disableVertexAttribArray(N),D[N]=0)}function x(M,D,N,R,O,G,I){I===!0?n.vertexAttribIPointer(M,D,N,O,G):n.vertexAttribPointer(M,D,N,R,O,G)}function w(M,D,N,R){m();const O=R.attributes,G=N.getAttributes(),I=D.defaultAttributeValues;for(const B in G){const $=G[B];if($.location>=0){let H=O[B];if(H===void 0&&(B==="instanceMatrix"&&M.instanceMatrix&&(H=M.instanceMatrix),B==="instanceColor"&&M.instanceColor&&(H=M.instanceColor)),H!==void 0){const Q=H.normalized,ee=H.itemSize,J=e.get(H);if(J===void 0)continue;const L=J.buffer,se=J.type,Z=J.bytesPerElement,le=se===n.INT||se===n.UNSIGNED_INT||H.gpuType===I4;if(H.isInterleavedBufferAttribute){const ue=H.data,te=ue.stride,Y=H.offset;if(ue.isInstancedInterleavedBuffer){for(let ie=0;ie<$.locationSize;ie++)v($.location+ie,ue.meshPerAttribute);M.isInstancedMesh!==!0&&R._maxInstanceCount===void 0&&(R._maxInstanceCount=ue.meshPerAttribute*ue.count)}else for(let ie=0;ie<$.locationSize;ie++)y($.location+ie);n.bindBuffer(n.ARRAY_BUFFER,L);for(let ie=0;ie<$.locationSize;ie++)x($.location+ie,ee/$.locationSize,se,Q,te*Z,(Y+ee/$.locationSize*ie)*Z,le)}else{if(H.isInstancedBufferAttribute){for(let ue=0;ue<$.locationSize;ue++)v($.location+ue,H.meshPerAttribute);M.isInstancedMesh!==!0&&R._maxInstanceCount===void 0&&(R._maxInstanceCount=H.meshPerAttribute*H.count)}else for(let ue=0;ue<$.locationSize;ue++)y($.location+ue);n.bindBuffer(n.ARRAY_BUFFER,L);for(let ue=0;ue<$.locationSize;ue++)x($.location+ue,ee/$.locationSize,se,Q,ee*Z,ee/$.locationSize*ue*Z,le)}}else if(I!==void 0){const Q=I[B];if(Q!==void 0)switch(Q.length){case 2:n.vertexAttrib2fv($.location,Q);break;case 3:n.vertexAttrib3fv($.location,Q);break;case 4:n.vertexAttrib4fv($.location,Q);break;default:n.vertexAttrib1fv($.location,Q)}}}}b()}function _(){T();for(const M in r){const D=r[M];for(const N in D){const R=D[N];for(const O in R)c(R[O].object),delete R[O];delete D[N]}delete r[M]}}function E(M){if(r[M.id]===void 0)return;const D=r[M.id];for(const N in D){const R=D[N];for(const O in R)c(R[O].object),delete R[O];delete D[N]}delete r[M.id]}function A(M){for(const D in r){const N=r[D];if(N[M.id]===void 0)continue;const R=N[M.id];for(const O in R)c(R[O].object),delete R[O];delete N[M.id]}}function T(){S(),a=!0,s!==i&&(s=i,u(s.object))}function S(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:o,reset:T,resetDefaultState:S,dispose:_,releaseStatesOfGeometry:E,releaseStatesOfProgram:A,initAttributes:m,enableAttribute:y,disableUnusedAttributes:b}}function VSe(n,e,t){let r;function i(u){r=u}function s(u,c){n.drawArrays(r,u,c),t.update(c,r,1)}function a(u,c,h){h!==0&&(n.drawArraysInstanced(r,u,c,h),t.update(c,r,h))}function o(u,c,h){if(h===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,u,0,c,0,h);let f=0;for(let p=0;p<h;p++)f+=c[p];t.update(f,r,1)}function l(u,c,h,d){if(h===0)return;const f=e.get("WEBGL_multi_draw");if(f===null)for(let p=0;p<u.length;p++)a(u[p],c[p],d[p]);else{f.multiDrawArraysInstancedWEBGL(r,u,0,c,0,d,0,h);let p=0;for(let m=0;m<h;m++)p+=c[m]*d[m];t.update(p,r,1)}}this.setMode=i,this.render=s,this.renderInstances=a,this.renderMultiDraw=o,this.renderMultiDrawInstances=l}function zSe(n,e,t,r){let i;function s(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const A=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(A.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function a(A){return!(A!==lu&&r.convert(A)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function o(A){const T=A===pd&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(A!==Fo&&r.convert(A)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&A!==ac&&!T)}function l(A){if(A==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";A="mediump"}return A==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u=t.precision!==void 0?t.precision:"highp";const c=l(u);c!==u&&($t("WebGLRenderer:",u,"not supported, using",c,"instead."),u=c);const h=t.logarithmicDepthBuffer===!0,d=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),f=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),p=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m=n.getParameter(n.MAX_TEXTURE_SIZE),y=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),v=n.getParameter(n.MAX_VERTEX_ATTRIBS),b=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),x=n.getParameter(n.MAX_VARYING_VECTORS),w=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),_=n.getParameter(n.MAX_SAMPLES),E=n.getParameter(n.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:a,textureTypeReadable:o,precision:u,logarithmicDepthBuffer:h,reversedDepthBuffer:d,maxTextures:f,maxVertexTextures:p,maxTextureSize:m,maxCubemapSize:y,maxAttributes:v,maxVertexUniforms:b,maxVaryings:x,maxFragmentUniforms:w,maxSamples:_,samples:E}}function $Se(n){const e=this;let t=null,r=0,i=!1,s=!1;const a=new Mm,o=new sn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){const f=h.length!==0||d||r!==0||i;return i=d,r=h.length,f},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){t=c(h,d,0)},this.setState=function(h,d,f){const p=h.clippingPlanes,m=h.clipIntersection,y=h.clipShadows,v=n.get(h);if(!i||p===null||p.length===0||s&&!y)s?c(null):u();else{const b=s?0:r,x=b*4;let w=v.clippingState||null;l.value=w,w=c(p,d,x,f);for(let _=0;_!==x;++_)w[_]=t[_];v.clippingState=w,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=b}};function u(){l.value!==t&&(l.value=t,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function c(h,d,f,p){const m=h!==null?h.length:0;let y=null;if(m!==0){if(y=l.value,p!==!0||y===null){const v=f+m*4,b=d.matrixWorldInverse;o.getNormalMatrix(b),(y===null||y.length<v)&&(y=new Float32Array(v));for(let x=0,w=f;x!==m;++x,w+=4)a.copy(h[x]).applyMatrix4(b,o),a.normal.toArray(y,w),y[w+3]=a.constant}l.value=y,l.needsUpdate=!0}return e.numPlanes=m,e.numIntersection=0,y}}function HSe(n){let e=new WeakMap;function t(a,o){return o===IL?a.mapping=Cv:o===PL&&(a.mapping=gb),a}function r(a){if(a&&a.isTexture){const o=a.mapping;if(o===IL||o===PL)if(e.has(a)){const l=e.get(a).texture;return t(l,a.mapping)}else{const l=a.image;if(l&&l.height>0){const u=new Yee(l.height);return u.fromEquirectangularTexture(n,a),e.set(a,u),a.addEventListener("dispose",i),t(u.texture,a.mapping)}else return null}}return a}function i(a){const o=a.target;o.removeEventListener("dispose",i);const l=e.get(o);l!==void 0&&(e.delete(o),l.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}const ep=4,D9=[.125,.215,.35,.446,.526,.582],Nm=20,GSe=256,D_=new ete,N9=new Ft;let $I=null,HI=0,GI=0,jI=!1;const jSe=new Ae;class R9{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,r=.1,i=100,s={}){const{size:a=256,position:o=jSe}=s;$I=this._renderer.getRenderTarget(),HI=this._renderer.getActiveCubeFace(),GI=this._renderer.getActiveMipmapLevel(),jI=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,r,i,l,o),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=F9(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=P9(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget($I,HI,GI),this._renderer.xr.enabled=jI,e.scissorTest=!1,y0(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Cv||e.mapping===gb?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),$I=this._renderer.getRenderTarget(),HI=this._renderer.getActiveCubeFace(),GI=this._renderer.getActiveMipmapLevel(),jI=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:Zs,minFilter:Zs,generateMipmaps:!1,type:pd,format:lu,colorSpace:yb,depthBuffer:!1},i=I9(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=I9(e,t,r);const{_lodMax:s}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=qSe(s)),this._blurMaterial=XSe(s,e,t),this._ggxMaterial=WSe(s,e,t)}return i}_compileMaterial(e){const t=new qn(new Zr,e);this._renderer.compile(t,D_)}_sceneToCubeUV(e,t,r,i,s){const l=new Ro(90,1,t,r),u=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],h=this._renderer,d=h.autoClear,f=h.toneMapping;h.getClearColor(N9),h.toneMapping=bc,h.autoClear=!1,h.state.buffers.depth.getReversed()&&(h.setRenderTarget(i),h.clearDepth(),h.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new qn(new iA,new Zo({name:"PMREM.Background",side:eo,depthWrite:!1,depthTest:!1})));const m=this._backgroundBox,y=m.material;let v=!1;const b=e.background;b?b.isColor&&(y.color.copy(b),e.background=null,v=!0):(y.color.copy(N9),v=!0);for(let x=0;x<6;x++){const w=x%3;w===0?(l.up.set(0,u[x],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x+c[x],s.y,s.z)):w===1?(l.up.set(0,0,u[x]),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y+c[x],s.z)):(l.up.set(0,u[x],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y,s.z+c[x]));const _=this._cubeSize;y0(i,w*_,x>2?_:0,_,_),h.setRenderTarget(i),v&&h.render(m,l),h.render(e,l)}h.toneMapping=f,h.autoClear=d,e.background=b}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===Cv||e.mapping===gb;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=F9()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=P9());const s=i?this._cubemapMaterial:this._equirectMaterial,a=this._lodMeshes[0];a.material=s;const o=s.uniforms;o.envMap.value=e;const l=this._cubeSize;y0(t,0,0,3*l,2*l),r.setRenderTarget(t),r.render(a,D_)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;const i=this._lodMeshes.length;for(let s=1;s<i;s++)this._applyGGXFilter(e,s-1,s);t.autoClear=r}_applyGGXFilter(e,t,r){const i=this._renderer,s=this._pingPongRenderTarget,a=this._ggxMaterial,o=this._lodMeshes[r];o.material=a;const l=a.uniforms,u=r/(this._lodMeshes.length-1),c=t/(this._lodMeshes.length-1),h=Math.sqrt(u*u-c*c),d=0+u*1.25,f=h*d,{_lodMax:p}=this,m=this._sizeLods[r],y=3*m*(r>p-ep?r-p+ep:0),v=4*(this._cubeSize-m);l.envMap.value=e.texture,l.roughness.value=f,l.mipInt.value=p-t,y0(s,y,v,3*m,2*m),i.setRenderTarget(s),i.render(o,D_),l.envMap.value=s.texture,l.roughness.value=0,l.mipInt.value=p-r,y0(e,y,v,3*m,2*m),i.setRenderTarget(e),i.render(o,D_)}_blur(e,t,r,i,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,r,i,"latitudinal",s),this._halfBlur(a,e,r,r,i,"longitudinal",s)}_halfBlur(e,t,r,i,s,a,o){const l=this._renderer,u=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&Bn("blur direction must be either latitudinal or longitudinal!");const c=3,h=this._lodMeshes[i];h.material=u;const d=u.uniforms,f=this._sizeLods[r]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*Nm-1),m=s/p,y=isFinite(s)?1+Math.floor(c*m):Nm;y>Nm&&$t(`sigmaRadians, ${s}, is too large and will clip, as it requested ${y} samples when the maximum is set to ${Nm}`);const v=[];let b=0;for(let A=0;A<Nm;++A){const T=A/m,S=Math.exp(-T*T/2);v.push(S),A===0?b+=S:A<y&&(b+=2*S)}for(let A=0;A<v.length;A++)v[A]=v[A]/b;d.envMap.value=e.texture,d.samples.value=y,d.weights.value=v,d.latitudinal.value=a==="latitudinal",o&&(d.poleAxis.value=o);const{_lodMax:x}=this;d.dTheta.value=p,d.mipInt.value=x-r;const w=this._sizeLods[i],_=3*w*(i>x-ep?i-x+ep:0),E=4*(this._cubeSize-w);y0(t,_,E,3*w,2*w),l.setRenderTarget(t),l.render(h,D_)}}function qSe(n){const e=[],t=[],r=[];let i=n;const s=n-ep+1+D9.length;for(let a=0;a<s;a++){const o=Math.pow(2,i);e.push(o);let l=1/o;a>n-ep?l=D9[a-n+ep-1]:a===0&&(l=0),t.push(l);const u=1/(o-2),c=-u,h=1+u,d=[c,c,h,c,h,h,c,c,h,h,c,h],f=6,p=6,m=3,y=2,v=1,b=new Float32Array(m*p*f),x=new Float32Array(y*p*f),w=new Float32Array(v*p*f);for(let E=0;E<f;E++){const A=E%3*2/3-1,T=E>2?0:-1,S=[A,T,0,A+2/3,T,0,A+2/3,T+1,0,A,T,0,A+2/3,T+1,0,A,T+1,0];b.set(S,m*p*E),x.set(d,y*p*E);const M=[E,E,E,E,E,E];w.set(M,v*p*E)}const _=new Zr;_.setAttribute("position",new _s(b,m)),_.setAttribute("uv",new _s(x,y)),_.setAttribute("faceIndex",new _s(w,v)),r.push(new qn(_,null)),i>ep&&i--}return{lodMeshes:r,sizeLods:e,sigmas:t}}function I9(n,e,t){const r=new _c(n,e,t);return r.texture.mapping=AN,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function y0(n,e,t,r,i){n.viewport.set(e,t,r,i),n.scissor.set(e,t,r,i)}function WSe(n,e,t){return new Mc({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:GSe,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:MN(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:Kh,depthTest:!1,depthWrite:!1})}function XSe(n,e,t){const r=new Float32Array(Nm),i=new Ae(0,1,0);return new Mc({name:"SphericalGaussianBlur",defines:{n:Nm,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:MN(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Kh,depthTest:!1,depthWrite:!1})}function P9(){return new Mc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:MN(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Kh,depthTest:!1,depthWrite:!1})}function F9(){return new Mc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:MN(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Kh,depthTest:!1,depthWrite:!1})}function MN(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function KSe(n){let e=new WeakMap,t=null;function r(o){if(o&&o.isTexture){const l=o.mapping,u=l===IL||l===PL,c=l===Cv||l===gb;if(u||c){let h=e.get(o);const d=h!==void 0?h.texture.pmremVersion:0;if(o.isRenderTargetTexture&&o.pmremVersion!==d)return t===null&&(t=new R9(n)),h=u?t.fromEquirectangular(o,h):t.fromCubemap(o,h),h.texture.pmremVersion=o.pmremVersion,e.set(o,h),h.texture;if(h!==void 0)return h.texture;{const f=o.image;return u&&f&&f.height>0||c&&f&&i(f)?(t===null&&(t=new R9(n)),h=u?t.fromEquirectangular(o):t.fromCubemap(o),h.texture.pmremVersion=o.pmremVersion,e.set(o,h),o.addEventListener("dispose",s),h.texture):null}}}return o}function i(o){let l=0;const u=6;for(let c=0;c<u;c++)o[c]!==void 0&&l++;return l===u}function s(o){const l=o.target;l.removeEventListener("dispose",s);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:a}}function YSe(n){const e={};function t(r){if(e[r]!==void 0)return e[r];const i=n.getExtension(r);return e[r]=i,i}return{has:function(r){return t(r)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(r){const i=t(r);return i===null&&Cw("WebGLRenderer: "+r+" extension not supported."),i}}}function QSe(n,e,t,r){const i={},s=new WeakMap;function a(h){const d=h.target;d.index!==null&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);d.removeEventListener("dispose",a),delete i[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),r.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,t.memory.geometries--}function o(h,d){return i[d.id]===!0||(d.addEventListener("dispose",a),i[d.id]=!0,t.memory.geometries++),d}function l(h){const d=h.attributes;for(const f in d)e.update(d[f],n.ARRAY_BUFFER)}function u(h){const d=[],f=h.index,p=h.attributes.position;let m=0;if(f!==null){const b=f.array;m=f.version;for(let x=0,w=b.length;x<w;x+=3){const _=b[x+0],E=b[x+1],A=b[x+2];d.push(_,E,E,A,A,_)}}else if(p!==void 0){const b=p.array;m=p.version;for(let x=0,w=b.length/3-1;x<w;x+=3){const _=x+0,E=x+1,A=x+2;d.push(_,E,E,A,A,_)}}else return;const y=new(zee(d)?qee:jee)(d,1);y.version=m;const v=s.get(h);v&&e.remove(v),s.set(h,y)}function c(h){const d=s.get(h);if(d){const f=h.index;f!==null&&d.version<f.version&&u(h)}else u(h);return s.get(h)}return{get:o,update:l,getWireframeAttribute:c}}function ZSe(n,e,t){let r;function i(d){r=d}let s,a;function o(d){s=d.type,a=d.bytesPerElement}function l(d,f){n.drawElements(r,f,s,d*a),t.update(f,r,1)}function u(d,f,p){p!==0&&(n.drawElementsInstanced(r,f,s,d*a,p),t.update(f,r,p))}function c(d,f,p){if(p===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,f,0,s,d,0,p);let y=0;for(let v=0;v<p;v++)y+=f[v];t.update(y,r,1)}function h(d,f,p,m){if(p===0)return;const y=e.get("WEBGL_multi_draw");if(y===null)for(let v=0;v<d.length;v++)u(d[v]/a,f[v],m[v]);else{y.multiDrawElementsInstancedWEBGL(r,f,0,s,d,0,m,0,p);let v=0;for(let b=0;b<p;b++)v+=f[b]*m[b];t.update(v,r,1)}}this.setMode=i,this.setIndex=o,this.render=l,this.renderInstances=u,this.renderMultiDraw=c,this.renderMultiDrawInstances=h}function JSe(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,a,o){switch(t.calls++,a){case n.TRIANGLES:t.triangles+=o*(s/3);break;case n.LINES:t.lines+=o*(s/2);break;case n.LINE_STRIP:t.lines+=o*(s-1);break;case n.LINE_LOOP:t.lines+=o*s;break;case n.POINTS:t.points+=o*s;break;default:Bn("WebGLInfo: Unknown draw mode:",a);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:r}}function eAe(n,e,t){const r=new WeakMap,i=new ei;function s(a,o,l){const u=a.morphTargetInfluences,c=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,h=c!==void 0?c.length:0;let d=r.get(o);if(d===void 0||d.count!==h){let S=function(){A.dispose(),r.delete(o),o.removeEventListener("dispose",S)};d!==void 0&&d.texture.dispose();const f=o.morphAttributes.position!==void 0,p=o.morphAttributes.normal!==void 0,m=o.morphAttributes.color!==void 0,y=o.morphAttributes.position||[],v=o.morphAttributes.normal||[],b=o.morphAttributes.color||[];let x=0;f===!0&&(x=1),p===!0&&(x=2),m===!0&&(x=3);let w=o.attributes.position.count*x,_=1;w>e.maxTextureSize&&(_=Math.ceil(w/e.maxTextureSize),w=e.maxTextureSize);const E=new Float32Array(w*_*4*h),A=new $ee(E,w,_,h);A.type=ac,A.needsUpdate=!0;const T=x*4;for(let M=0;M<h;M++){const D=y[M],N=v[M],R=b[M],O=w*_*4*M;for(let G=0;G<D.count;G++){const I=G*T;f===!0&&(i.fromBufferAttribute(D,G),E[O+I+0]=i.x,E[O+I+1]=i.y,E[O+I+2]=i.z,E[O+I+3]=0),p===!0&&(i.fromBufferAttribute(N,G),E[O+I+4]=i.x,E[O+I+5]=i.y,E[O+I+6]=i.z,E[O+I+7]=0),m===!0&&(i.fromBufferAttribute(R,G),E[O+I+8]=i.x,E[O+I+9]=i.y,E[O+I+10]=i.z,E[O+I+11]=R.itemSize===4?i.w:1)}}d={count:h,texture:A,size:new Cn(w,_)},r.set(o,d),o.addEventListener("dispose",S)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)l.getUniforms().setValue(n,"morphTexture",a.morphTexture,t);else{let f=0;for(let m=0;m<u.length;m++)f+=u[m];const p=o.morphTargetsRelative?1:1-f;l.getUniforms().setValue(n,"morphTargetBaseInfluence",p),l.getUniforms().setValue(n,"morphTargetInfluences",u)}l.getUniforms().setValue(n,"morphTargetsTexture",d.texture,t),l.getUniforms().setValue(n,"morphTargetsTextureSize",d.size)}return{update:s}}function tAe(n,e,t,r){let i=new WeakMap;function s(l){const u=r.render.frame,c=l.geometry,h=e.get(l,c);if(i.get(h)!==u&&(e.update(h),i.set(h,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),i.get(l)!==u&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),i.set(l,u))),l.isSkinnedMesh){const d=l.skeleton;i.get(d)!==u&&(d.update(),i.set(d,u))}return h}function a(){i=new WeakMap}function o(l){const u=l.target;u.removeEventListener("dispose",o),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return{update:s,dispose:a}}const nAe={[Aee]:"LINEAR_TONE_MAPPING",[Tee]:"REINHARD_TONE_MAPPING",[Mee]:"CINEON_TONE_MAPPING",[Cee]:"ACES_FILMIC_TONE_MAPPING",[Nee]:"AGX_TONE_MAPPING",[Ree]:"NEUTRAL_TONE_MAPPING",[Dee]:"CUSTOM_TONE_MAPPING"};function rAe(n,e,t,r,i){const s=new _c(e,t,{type:n,depthBuffer:r,stencilBuffer:i}),a=new _c(e,t,{type:pd,depthBuffer:!1,stencilBuffer:!1}),o=new Zr;o.setAttribute("position",new Ar([-1,3,0,-1,-1,0,3,-1,0],3)),o.setAttribute("uv",new Ar([0,2,0,0,2,0],2));const l=new K1e({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),u=new qn(o,l),c=new ete(-1,1,1,-1,0,1);let h=null,d=null,f=!1,p,m=null,y=[],v=!1;this.setSize=function(b,x){s.setSize(b,x),a.setSize(b,x);for(let w=0;w<y.length;w++){const _=y[w];_.setSize&&_.setSize(b,x)}},this.setEffects=function(b){y=b,v=y.length>0&&y[0].isRenderPass===!0;const x=s.width,w=s.height;for(let _=0;_<y.length;_++){const E=y[_];E.setSize&&E.setSize(x,w)}},this.begin=function(b,x){if(f||b.toneMapping===bc&&y.length===0)return!1;if(m=x,x!==null){const w=x.width,_=x.height;(s.width!==w||s.height!==_)&&this.setSize(w,_)}return v===!1&&b.setRenderTarget(s),p=b.toneMapping,b.toneMapping=bc,!0},this.hasRenderPass=function(){return v},this.end=function(b,x){b.toneMapping=p,f=!0;let w=s,_=a;for(let E=0;E<y.length;E++){const A=y[E];if(A.enabled!==!1&&(A.render(b,_,w,x),A.needsSwap!==!1)){const T=w;w=_,_=T}}if(h!==b.outputColorSpace||d!==b.toneMapping){h=b.outputColorSpace,d=b.toneMapping,l.defines={},In.getTransfer(h)===Wn&&(l.defines.SRGB_TRANSFER="");const E=nAe[d];E&&(l.defines[E]=""),l.needsUpdate=!0}l.uniforms.tDiffuse.value=w.texture,b.setRenderTarget(m),b.render(u,c),m=null,f=!1},this.isCompositing=function(){return f},this.dispose=function(){s.dispose(),a.dispose(),o.dispose(),l.dispose()}}const nte=new wa,gO=new Dw(1,1),rte=new $ee,ite=new A1e,ste=new Kee,L9=[],O9=[],k9=new Float32Array(16),B9=new Float32Array(9),U9=new Float32Array(4);function jb(n,e,t){const r=n[0];if(r<=0||r>0)return n;const i=e*t;let s=L9[i];if(s===void 0&&(s=new Float32Array(i),L9[i]=s),e!==0){r.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=t,n[a].toArray(s,o)}return s}function ki(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function Bi(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function CN(n,e){let t=O9[e];t===void 0&&(t=new Int32Array(e),O9[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function iAe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function sAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ki(t,e))return;n.uniform2fv(this.addr,e),Bi(t,e)}}function aAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(ki(t,e))return;n.uniform3fv(this.addr,e),Bi(t,e)}}function oAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ki(t,e))return;n.uniform4fv(this.addr,e),Bi(t,e)}}function lAe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(ki(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Bi(t,e)}else{if(ki(t,r))return;U9.set(r),n.uniformMatrix2fv(this.addr,!1,U9),Bi(t,r)}}function uAe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(ki(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Bi(t,e)}else{if(ki(t,r))return;B9.set(r),n.uniformMatrix3fv(this.addr,!1,B9),Bi(t,r)}}function cAe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(ki(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Bi(t,e)}else{if(ki(t,r))return;k9.set(r),n.uniformMatrix4fv(this.addr,!1,k9),Bi(t,r)}}function hAe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function dAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ki(t,e))return;n.uniform2iv(this.addr,e),Bi(t,e)}}function fAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ki(t,e))return;n.uniform3iv(this.addr,e),Bi(t,e)}}function pAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ki(t,e))return;n.uniform4iv(this.addr,e),Bi(t,e)}}function mAe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function gAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ki(t,e))return;n.uniform2uiv(this.addr,e),Bi(t,e)}}function vAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ki(t,e))return;n.uniform3uiv(this.addr,e),Bi(t,e)}}function yAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ki(t,e))return;n.uniform4uiv(this.addr,e),Bi(t,e)}}function xAe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i);let s;this.type===n.SAMPLER_2D_SHADOW?(gO.compareFunction=t.isReversedDepthBuffer()?U4:B4,s=gO):s=nte,t.setTexture2D(e||s,i)}function bAe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture3D(e||ite,i)}function _Ae(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTextureCube(e||ste,i)}function wAe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2DArray(e||rte,i)}function EAe(n){switch(n){case 5126:return iAe;case 35664:return sAe;case 35665:return aAe;case 35666:return oAe;case 35674:return lAe;case 35675:return uAe;case 35676:return cAe;case 5124:case 35670:return hAe;case 35667:case 35671:return dAe;case 35668:case 35672:return fAe;case 35669:case 35673:return pAe;case 5125:return mAe;case 36294:return gAe;case 36295:return vAe;case 36296:return yAe;case 35678:case 36198:case 36298:case 36306:case 35682:return xAe;case 35679:case 36299:case 36307:return bAe;case 35680:case 36300:case 36308:case 36293:return _Ae;case 36289:case 36303:case 36311:case 36292:return wAe}}function SAe(n,e){n.uniform1fv(this.addr,e)}function AAe(n,e){const t=jb(e,this.size,2);n.uniform2fv(this.addr,t)}function TAe(n,e){const t=jb(e,this.size,3);n.uniform3fv(this.addr,t)}function MAe(n,e){const t=jb(e,this.size,4);n.uniform4fv(this.addr,t)}function CAe(n,e){const t=jb(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function DAe(n,e){const t=jb(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function NAe(n,e){const t=jb(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function RAe(n,e){n.uniform1iv(this.addr,e)}function IAe(n,e){n.uniform2iv(this.addr,e)}function PAe(n,e){n.uniform3iv(this.addr,e)}function FAe(n,e){n.uniform4iv(this.addr,e)}function LAe(n,e){n.uniform1uiv(this.addr,e)}function OAe(n,e){n.uniform2uiv(this.addr,e)}function kAe(n,e){n.uniform3uiv(this.addr,e)}function BAe(n,e){n.uniform4uiv(this.addr,e)}function UAe(n,e,t){const r=this.cache,i=e.length,s=CN(t,i);ki(r,s)||(n.uniform1iv(this.addr,s),Bi(r,s));let a;this.type===n.SAMPLER_2D_SHADOW?a=gO:a=nte;for(let o=0;o!==i;++o)t.setTexture2D(e[o]||a,s[o])}function VAe(n,e,t){const r=this.cache,i=e.length,s=CN(t,i);ki(r,s)||(n.uniform1iv(this.addr,s),Bi(r,s));for(let a=0;a!==i;++a)t.setTexture3D(e[a]||ite,s[a])}function zAe(n,e,t){const r=this.cache,i=e.length,s=CN(t,i);ki(r,s)||(n.uniform1iv(this.addr,s),Bi(r,s));for(let a=0;a!==i;++a)t.setTextureCube(e[a]||ste,s[a])}function $Ae(n,e,t){const r=this.cache,i=e.length,s=CN(t,i);ki(r,s)||(n.uniform1iv(this.addr,s),Bi(r,s));for(let a=0;a!==i;++a)t.setTexture2DArray(e[a]||rte,s[a])}function HAe(n){switch(n){case 5126:return SAe;case 35664:return AAe;case 35665:return TAe;case 35666:return MAe;case 35674:return CAe;case 35675:return DAe;case 35676:return NAe;case 5124:case 35670:return RAe;case 35667:case 35671:return IAe;case 35668:case 35672:return PAe;case 35669:case 35673:return FAe;case 5125:return LAe;case 36294:return OAe;case 36295:return kAe;case 36296:return BAe;case 35678:case 36198:case 36298:case 36306:case 35682:return UAe;case 35679:case 36299:case 36307:return VAe;case 35680:case 36300:case 36308:case 36293:return zAe;case 36289:case 36303:case 36311:case 36292:return $Ae}}class GAe{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=EAe(t.type)}}class jAe{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=HAe(t.type)}}class qAe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const i=this.seq;for(let s=0,a=i.length;s!==a;++s){const o=i[s];o.setValue(e,t[o.id],r)}}}const qI=/(\w+)(\])?(\[|\.)?/g;function V9(n,e){n.seq.push(e),n.map[e.id]=e}function WAe(n,e,t){const r=n.name,i=r.length;for(qI.lastIndex=0;;){const s=qI.exec(r),a=qI.lastIndex;let o=s[1];const l=s[2]==="]",u=s[3];if(l&&(o=o|0),u===void 0||u==="["&&a+2===i){V9(t,u===void 0?new GAe(o,n,e):new jAe(o,n,e));break}else{let h=t.map[o];h===void 0&&(h=new qAe(o),V9(t,h)),t=h}}}class dC{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let a=0;a<r;++a){const o=e.getActiveUniform(t,a),l=e.getUniformLocation(t,o.name);WAe(o,l,this)}const i=[],s=[];for(const a of this.seq)a.type===e.SAMPLER_2D_SHADOW||a.type===e.SAMPLER_CUBE_SHADOW||a.type===e.SAMPLER_2D_ARRAY_SHADOW?i.push(a):s.push(a);i.length>0&&(this.seq=i.concat(s))}setValue(e,t,r,i){const s=this.map[t];s!==void 0&&s.setValue(e,r,i)}setOptional(e,t,r){const i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let s=0,a=t.length;s!==a;++s){const o=t[s],l=r[o.id];l.needsUpdate!==!1&&o.setValue(e,l.value,i)}}static seqWithValue(e,t){const r=[];for(let i=0,s=e.length;i!==s;++i){const a=e[i];a.id in t&&r.push(a)}return r}}function z9(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}const XAe=37297;let KAe=0;function YAe(n,e){const t=n.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=i;a<s;a++){const o=a+1;r.push(`${o===e?">":" "} ${o}: ${t[a]}`)}return r.join(`
`)}const $9=new sn;function QAe(n){In._getMatrix($9,In.workingColorSpace,n);const e=`mat3( ${$9.elements.map(t=>t.toFixed(4))} )`;switch(In.getTransfer(n)){case TD:return[e,"LinearTransferOETF"];case Wn:return[e,"sRGBTransferOETF"];default:return $t("WebGLProgram: Unsupported color space: ",n),[e,"LinearTransferOETF"]}}function H9(n,e,t){const r=n.getShaderParameter(e,n.COMPILE_STATUS),s=(n.getShaderInfoLog(e)||"").trim();if(r&&s==="")return"";const a=/ERROR: 0:(\d+)/.exec(s);if(a){const o=parseInt(a[1]);return t.toUpperCase()+`

`+s+`

`+YAe(n.getShaderSource(e),o)}else return s}function ZAe(n,e){const t=QAe(e);return[`vec4 ${n}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}const JAe={[Aee]:"Linear",[Tee]:"Reinhard",[Mee]:"Cineon",[Cee]:"ACESFilmic",[Nee]:"AgX",[Ree]:"Neutral",[Dee]:"Custom"};function eTe(n,e){const t=JAe[e];return t===void 0?($t("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+n+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const IT=new Ae;function tTe(){In.getLuminanceCoefficients(IT);const n=IT.x.toFixed(4),e=IT.y.toFixed(4),t=IT.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${n}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function nTe(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(f1).join(`
`)}function rTe(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function iTe(n,e){const t={},r=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=n.getActiveAttrib(e,i),a=s.name;let o=1;s.type===n.FLOAT_MAT2&&(o=2),s.type===n.FLOAT_MAT3&&(o=3),s.type===n.FLOAT_MAT4&&(o=4),t[a]={type:s.type,location:n.getAttribLocation(e,a),locationSize:o}}return t}function f1(n){return n!==""}function G9(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function j9(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const sTe=/^[ \t]*#include +<([\w\d./]+)>/gm;function vO(n){return n.replace(sTe,oTe)}const aTe=new Map;function oTe(n,e){let t=un[e];if(t===void 0){const r=aTe.get(e);if(r!==void 0)t=un[r],$t('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return vO(t)}const lTe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function q9(n){return n.replace(lTe,uTe)}function uTe(n,e,t,r){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function W9(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}const cTe={[oC]:"SHADOWMAP_TYPE_PCF",[d1]:"SHADOWMAP_TYPE_VSM"};function hTe(n){return cTe[n.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}const dTe={[Cv]:"ENVMAP_TYPE_CUBE",[gb]:"ENVMAP_TYPE_CUBE",[AN]:"ENVMAP_TYPE_CUBE_UV"};function fTe(n){return n.envMap===!1?"ENVMAP_TYPE_CUBE":dTe[n.envMapMode]||"ENVMAP_TYPE_CUBE"}const pTe={[gb]:"ENVMAP_MODE_REFRACTION"};function mTe(n){return n.envMap===!1?"ENVMAP_MODE_REFLECTION":pTe[n.envMapMode]||"ENVMAP_MODE_REFLECTION"}const gTe={[R4]:"ENVMAP_BLENDING_MULTIPLY",[a1e]:"ENVMAP_BLENDING_MIX",[o1e]:"ENVMAP_BLENDING_ADD"};function vTe(n){return n.envMap===!1?"ENVMAP_BLENDING_NONE":gTe[n.combine]||"ENVMAP_BLENDING_NONE"}function yTe(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}function xTe(n,e,t,r){const i=n.getContext(),s=t.defines;let a=t.vertexShader,o=t.fragmentShader;const l=hTe(t),u=fTe(t),c=mTe(t),h=vTe(t),d=yTe(t),f=nTe(t),p=rTe(s),m=i.createProgram();let y,v,b=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(y=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(f1).join(`
`),y.length>0&&(y+=`
`),v=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(f1).join(`
`),v.length>0&&(v+=`
`)):(y=[W9(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(f1).join(`
`),v=[W9(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+c:"",t.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==bc?"#define TONE_MAPPING":"",t.toneMapping!==bc?un.tonemapping_pars_fragment:"",t.toneMapping!==bc?eTe("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",un.colorspace_pars_fragment,ZAe("linearToOutputTexel",t.outputColorSpace),tTe(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(f1).join(`
`)),a=vO(a),a=G9(a,t),a=j9(a,t),o=vO(o),o=G9(o,t),o=j9(o,t),a=q9(a),o=q9(o),t.isRawShaderMaterial!==!0&&(b=`#version 300 es
`,y=[f,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+y,v=["#define varying in",t.glslVersion===t9?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===t9?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);const x=b+y+a,w=b+v+o,_=z9(i,i.VERTEX_SHADER,x),E=z9(i,i.FRAGMENT_SHADER,w);i.attachShader(m,_),i.attachShader(m,E),t.index0AttributeName!==void 0?i.bindAttribLocation(m,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(m,0,"position"),i.linkProgram(m);function A(D){if(n.debug.checkShaderErrors){const N=i.getProgramInfoLog(m)||"",R=i.getShaderInfoLog(_)||"",O=i.getShaderInfoLog(E)||"",G=N.trim(),I=R.trim(),B=O.trim();let $=!0,H=!0;if(i.getProgramParameter(m,i.LINK_STATUS)===!1)if($=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(i,m,_,E);else{const Q=H9(i,_,"vertex"),ee=H9(i,E,"fragment");Bn("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(m,i.VALIDATE_STATUS)+`

Material Name: `+D.name+`
Material Type: `+D.type+`

Program Info Log: `+G+`
`+Q+`
`+ee)}else G!==""?$t("WebGLProgram: Program Info Log:",G):(I===""||B==="")&&(H=!1);H&&(D.diagnostics={runnable:$,programLog:G,vertexShader:{log:I,prefix:y},fragmentShader:{log:B,prefix:v}})}i.deleteShader(_),i.deleteShader(E),T=new dC(i,m),S=iTe(i,m)}let T;this.getUniforms=function(){return T===void 0&&A(this),T};let S;this.getAttributes=function(){return S===void 0&&A(this),S};let M=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return M===!1&&(M=i.getProgramParameter(m,XAe)),M},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(m),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=KAe++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=_,this.fragmentShader=E,this}let bTe=0;class _Te{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(r),a=this._getShaderCacheForMaterial(e);return a.has(i)===!1&&(a.add(i),i.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new wTe(e),t.set(e,r)),r}}class wTe{constructor(e){this.id=bTe++,this.code=e,this.usedTimes=0}}function ETe(n,e,t,r,i,s,a){const o=new Hee,l=new _Te,u=new Set,c=[],h=new Map,d=i.logarithmicDepthBuffer;let f=i.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(S){return u.add(S),S===0?"uv":`uv${S}`}function y(S,M,D,N,R){const O=N.fog,G=R.geometry,I=S.isMeshStandardMaterial?N.environment:null,B=(S.isMeshStandardMaterial?t:e).get(S.envMap||I),$=B&&B.mapping===AN?B.image.height:null,H=p[S.type];S.precision!==null&&(f=i.getMaxPrecision(S.precision),f!==S.precision&&$t("WebGLProgram.getParameters:",S.precision,"not supported, using",f,"instead."));const Q=G.morphAttributes.position||G.morphAttributes.normal||G.morphAttributes.color,ee=Q!==void 0?Q.length:0;let J=0;G.morphAttributes.position!==void 0&&(J=1),G.morphAttributes.normal!==void 0&&(J=2),G.morphAttributes.color!==void 0&&(J=3);let L,se,Z,le;if(H){const dn=rc[H];L=dn.vertexShader,se=dn.fragmentShader}else L=S.vertexShader,se=S.fragmentShader,l.update(S),Z=l.getVertexShaderID(S),le=l.getFragmentShaderID(S);const ue=n.getRenderTarget(),te=n.state.buffers.depth.getReversed(),Y=R.isInstancedMesh===!0,ie=R.isBatchedMesh===!0,ve=!!S.map,ge=!!S.matcap,_e=!!B,we=!!S.aoMap,Be=!!S.lightMap,$e=!!S.bumpMap,nt=!!S.normalMap,de=!!S.displacementMap,Ye=!!S.emissiveMap,Xe=!!S.metalnessMap,ae=!!S.roughnessMap,fe=S.anisotropy>0,F=S.clearcoat>0,P=S.dispersion>0,K=S.iridescence>0,oe=S.sheen>0,pe=S.transmission>0,ce=fe&&!!S.anisotropyMap,Te=F&&!!S.clearcoatMap,be=F&&!!S.clearcoatNormalMap,Pe=F&&!!S.clearcoatRoughnessMap,Me=K&&!!S.iridescenceMap,Ne=K&&!!S.iridescenceThicknessMap,ze=oe&&!!S.sheenColorMap,Ke=oe&&!!S.sheenRoughnessMap,Ge=!!S.specularMap,qe=!!S.specularColorMap,z=!!S.specularIntensityMap,W=pe&&!!S.transmissionMap,ye=pe&&!!S.thicknessMap,Ee=!!S.gradientMap,Fe=!!S.alphaMap,Le=S.alphaTest>0,Ue=!!S.alphaHash,tt=!!S.extensions;let Pt=bc;S.toneMapped&&(ue===null||ue.isXRRenderTarget===!0)&&(Pt=n.toneMapping);const Vn={shaderID:H,shaderType:S.type,shaderName:S.name,vertexShader:L,fragmentShader:se,defines:S.defines,customVertexShaderID:Z,customFragmentShaderID:le,isRawShaderMaterial:S.isRawShaderMaterial===!0,glslVersion:S.glslVersion,precision:f,batching:ie,batchingColor:ie&&R._colorsTexture!==null,instancing:Y,instancingColor:Y&&R.instanceColor!==null,instancingMorph:Y&&R.morphTexture!==null,outputColorSpace:ue===null?n.outputColorSpace:ue.isXRRenderTarget===!0?ue.texture.colorSpace:yb,alphaToCoverage:!!S.alphaToCoverage,map:ve,matcap:ge,envMap:_e,envMapMode:_e&&B.mapping,envMapCubeUVHeight:$,aoMap:we,lightMap:Be,bumpMap:$e,normalMap:nt,displacementMap:de,emissiveMap:Ye,normalMapObjectSpace:nt&&S.normalMapType===c1e,normalMapTangentSpace:nt&&S.normalMapType===Vee,metalnessMap:Xe,roughnessMap:ae,anisotropy:fe,anisotropyMap:ce,clearcoat:F,clearcoatMap:Te,clearcoatNormalMap:be,clearcoatRoughnessMap:Pe,dispersion:P,iridescence:K,iridescenceMap:Me,iridescenceThicknessMap:Ne,sheen:oe,sheenColorMap:ze,sheenRoughnessMap:Ke,specularMap:Ge,specularColorMap:qe,specularIntensityMap:z,transmission:pe,transmissionMap:W,thicknessMap:ye,gradientMap:Ee,opaque:S.transparent===!1&&S.blending===Sy&&S.alphaToCoverage===!1,alphaMap:Fe,alphaTest:Le,alphaHash:Ue,combine:S.combine,mapUv:ve&&m(S.map.channel),aoMapUv:we&&m(S.aoMap.channel),lightMapUv:Be&&m(S.lightMap.channel),bumpMapUv:$e&&m(S.bumpMap.channel),normalMapUv:nt&&m(S.normalMap.channel),displacementMapUv:de&&m(S.displacementMap.channel),emissiveMapUv:Ye&&m(S.emissiveMap.channel),metalnessMapUv:Xe&&m(S.metalnessMap.channel),roughnessMapUv:ae&&m(S.roughnessMap.channel),anisotropyMapUv:ce&&m(S.anisotropyMap.channel),clearcoatMapUv:Te&&m(S.clearcoatMap.channel),clearcoatNormalMapUv:be&&m(S.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Pe&&m(S.clearcoatRoughnessMap.channel),iridescenceMapUv:Me&&m(S.iridescenceMap.channel),iridescenceThicknessMapUv:Ne&&m(S.iridescenceThicknessMap.channel),sheenColorMapUv:ze&&m(S.sheenColorMap.channel),sheenRoughnessMapUv:Ke&&m(S.sheenRoughnessMap.channel),specularMapUv:Ge&&m(S.specularMap.channel),specularColorMapUv:qe&&m(S.specularColorMap.channel),specularIntensityMapUv:z&&m(S.specularIntensityMap.channel),transmissionMapUv:W&&m(S.transmissionMap.channel),thicknessMapUv:ye&&m(S.thicknessMap.channel),alphaMapUv:Fe&&m(S.alphaMap.channel),vertexTangents:!!G.attributes.tangent&&(nt||fe),vertexColors:S.vertexColors,vertexAlphas:S.vertexColors===!0&&!!G.attributes.color&&G.attributes.color.itemSize===4,pointsUvs:R.isPoints===!0&&!!G.attributes.uv&&(ve||Fe),fog:!!O,useFog:S.fog===!0,fogExp2:!!O&&O.isFogExp2,flatShading:S.flatShading===!0&&S.wireframe===!1,sizeAttenuation:S.sizeAttenuation===!0,logarithmicDepthBuffer:d,reversedDepthBuffer:te,skinning:R.isSkinnedMesh===!0,morphTargets:G.morphAttributes.position!==void 0,morphNormals:G.morphAttributes.normal!==void 0,morphColors:G.morphAttributes.color!==void 0,morphTargetsCount:ee,morphTextureStride:J,numDirLights:M.directional.length,numPointLights:M.point.length,numSpotLights:M.spot.length,numSpotLightMaps:M.spotLightMap.length,numRectAreaLights:M.rectArea.length,numHemiLights:M.hemi.length,numDirLightShadows:M.directionalShadowMap.length,numPointLightShadows:M.pointShadowMap.length,numSpotLightShadows:M.spotShadowMap.length,numSpotLightShadowsWithMaps:M.numSpotLightShadowsWithMaps,numLightProbes:M.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:S.dithering,shadowMapEnabled:n.shadowMap.enabled&&D.length>0,shadowMapType:n.shadowMap.type,toneMapping:Pt,decodeVideoTexture:ve&&S.map.isVideoTexture===!0&&In.getTransfer(S.map.colorSpace)===Wn,decodeVideoTextureEmissive:Ye&&S.emissiveMap.isVideoTexture===!0&&In.getTransfer(S.emissiveMap.colorSpace)===Wn,premultipliedAlpha:S.premultipliedAlpha,doubleSided:S.side===kh,flipSided:S.side===eo,useDepthPacking:S.depthPacking>=0,depthPacking:S.depthPacking||0,index0AttributeName:S.index0AttributeName,extensionClipCullDistance:tt&&S.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(tt&&S.extensions.multiDraw===!0||ie)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:S.customProgramCacheKey()};return Vn.vertexUv1s=u.has(1),Vn.vertexUv2s=u.has(2),Vn.vertexUv3s=u.has(3),u.clear(),Vn}function v(S){const M=[];if(S.shaderID?M.push(S.shaderID):(M.push(S.customVertexShaderID),M.push(S.customFragmentShaderID)),S.defines!==void 0)for(const D in S.defines)M.push(D),M.push(S.defines[D]);return S.isRawShaderMaterial===!1&&(b(M,S),x(M,S),M.push(n.outputColorSpace)),M.push(S.customProgramCacheKey),M.join()}function b(S,M){S.push(M.precision),S.push(M.outputColorSpace),S.push(M.envMapMode),S.push(M.envMapCubeUVHeight),S.push(M.mapUv),S.push(M.alphaMapUv),S.push(M.lightMapUv),S.push(M.aoMapUv),S.push(M.bumpMapUv),S.push(M.normalMapUv),S.push(M.displacementMapUv),S.push(M.emissiveMapUv),S.push(M.metalnessMapUv),S.push(M.roughnessMapUv),S.push(M.anisotropyMapUv),S.push(M.clearcoatMapUv),S.push(M.clearcoatNormalMapUv),S.push(M.clearcoatRoughnessMapUv),S.push(M.iridescenceMapUv),S.push(M.iridescenceThicknessMapUv),S.push(M.sheenColorMapUv),S.push(M.sheenRoughnessMapUv),S.push(M.specularMapUv),S.push(M.specularColorMapUv),S.push(M.specularIntensityMapUv),S.push(M.transmissionMapUv),S.push(M.thicknessMapUv),S.push(M.combine),S.push(M.fogExp2),S.push(M.sizeAttenuation),S.push(M.morphTargetsCount),S.push(M.morphAttributeCount),S.push(M.numDirLights),S.push(M.numPointLights),S.push(M.numSpotLights),S.push(M.numSpotLightMaps),S.push(M.numHemiLights),S.push(M.numRectAreaLights),S.push(M.numDirLightShadows),S.push(M.numPointLightShadows),S.push(M.numSpotLightShadows),S.push(M.numSpotLightShadowsWithMaps),S.push(M.numLightProbes),S.push(M.shadowMapType),S.push(M.toneMapping),S.push(M.numClippingPlanes),S.push(M.numClipIntersection),S.push(M.depthPacking)}function x(S,M){o.disableAll(),M.instancing&&o.enable(0),M.instancingColor&&o.enable(1),M.instancingMorph&&o.enable(2),M.matcap&&o.enable(3),M.envMap&&o.enable(4),M.normalMapObjectSpace&&o.enable(5),M.normalMapTangentSpace&&o.enable(6),M.clearcoat&&o.enable(7),M.iridescence&&o.enable(8),M.alphaTest&&o.enable(9),M.vertexColors&&o.enable(10),M.vertexAlphas&&o.enable(11),M.vertexUv1s&&o.enable(12),M.vertexUv2s&&o.enable(13),M.vertexUv3s&&o.enable(14),M.vertexTangents&&o.enable(15),M.anisotropy&&o.enable(16),M.alphaHash&&o.enable(17),M.batching&&o.enable(18),M.dispersion&&o.enable(19),M.batchingColor&&o.enable(20),M.gradientMap&&o.enable(21),S.push(o.mask),o.disableAll(),M.fog&&o.enable(0),M.useFog&&o.enable(1),M.flatShading&&o.enable(2),M.logarithmicDepthBuffer&&o.enable(3),M.reversedDepthBuffer&&o.enable(4),M.skinning&&o.enable(5),M.morphTargets&&o.enable(6),M.morphNormals&&o.enable(7),M.morphColors&&o.enable(8),M.premultipliedAlpha&&o.enable(9),M.shadowMapEnabled&&o.enable(10),M.doubleSided&&o.enable(11),M.flipSided&&o.enable(12),M.useDepthPacking&&o.enable(13),M.dithering&&o.enable(14),M.transmission&&o.enable(15),M.sheen&&o.enable(16),M.opaque&&o.enable(17),M.pointsUvs&&o.enable(18),M.decodeVideoTexture&&o.enable(19),M.decodeVideoTextureEmissive&&o.enable(20),M.alphaToCoverage&&o.enable(21),S.push(o.mask)}function w(S){const M=p[S.type];let D;if(M){const N=rc[M];D=B1e.clone(N.uniforms)}else D=S.uniforms;return D}function _(S,M){let D=h.get(M);return D!==void 0?++D.usedTimes:(D=new xTe(n,M,S,s),c.push(D),h.set(M,D)),D}function E(S){if(--S.usedTimes===0){const M=c.indexOf(S);c[M]=c[c.length-1],c.pop(),h.delete(S.cacheKey),S.destroy()}}function A(S){l.remove(S)}function T(){l.dispose()}return{getParameters:y,getProgramCacheKey:v,getUniforms:w,acquireProgram:_,releaseProgram:E,releaseShaderCache:A,programs:c,dispose:T}}function STe(){let n=new WeakMap;function e(a){return n.has(a)}function t(a){let o=n.get(a);return o===void 0&&(o={},n.set(a,o)),o}function r(a){n.delete(a)}function i(a,o,l){n.get(a)[o]=l}function s(){n=new WeakMap}return{has:e,get:t,remove:r,update:i,dispose:s}}function ATe(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function X9(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function K9(){const n=[];let e=0;const t=[],r=[],i=[];function s(){e=0,t.length=0,r.length=0,i.length=0}function a(h,d,f,p,m,y){let v=n[e];return v===void 0?(v={id:h.id,object:h,geometry:d,material:f,groupOrder:p,renderOrder:h.renderOrder,z:m,group:y},n[e]=v):(v.id=h.id,v.object=h,v.geometry=d,v.material=f,v.groupOrder=p,v.renderOrder=h.renderOrder,v.z=m,v.group=y),e++,v}function o(h,d,f,p,m,y){const v=a(h,d,f,p,m,y);f.transmission>0?r.push(v):f.transparent===!0?i.push(v):t.push(v)}function l(h,d,f,p,m,y){const v=a(h,d,f,p,m,y);f.transmission>0?r.unshift(v):f.transparent===!0?i.unshift(v):t.unshift(v)}function u(h,d){t.length>1&&t.sort(h||ATe),r.length>1&&r.sort(d||X9),i.length>1&&i.sort(d||X9)}function c(){for(let h=e,d=n.length;h<d;h++){const f=n[h];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:t,transmissive:r,transparent:i,init:s,push:o,unshift:l,finish:c,sort:u}}function TTe(){let n=new WeakMap;function e(r,i){const s=n.get(r);let a;return s===void 0?(a=new K9,n.set(r,[a])):i>=s.length?(a=new K9,s.push(a)):a=s[i],a}function t(){n=new WeakMap}return{get:e,dispose:t}}function MTe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Ae,color:new Ft};break;case"SpotLight":t={position:new Ae,direction:new Ae,color:new Ft,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Ae,color:new Ft,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Ae,skyColor:new Ft,groundColor:new Ft};break;case"RectAreaLight":t={color:new Ft,position:new Ae,halfWidth:new Ae,halfHeight:new Ae};break}return n[e.id]=t,t}}}function CTe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Cn};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Cn};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Cn,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let DTe=0;function NTe(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function RTe(n){const e=new MTe,t=CTe(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)r.probe.push(new Ae);const i=new Ae,s=new Ir,a=new Ir;function o(u){let c=0,h=0,d=0;for(let S=0;S<9;S++)r.probe[S].set(0,0,0);let f=0,p=0,m=0,y=0,v=0,b=0,x=0,w=0,_=0,E=0,A=0;u.sort(NTe);for(let S=0,M=u.length;S<M;S++){const D=u[S],N=D.color,R=D.intensity,O=D.distance;let G=null;if(D.shadow&&D.shadow.map&&(D.shadow.map.texture.format===vb?G=D.shadow.map.texture:G=D.shadow.map.depthTexture||D.shadow.map.texture),D.isAmbientLight)c+=N.r*R,h+=N.g*R,d+=N.b*R;else if(D.isLightProbe){for(let I=0;I<9;I++)r.probe[I].addScaledVector(D.sh.coefficients[I],R);A++}else if(D.isDirectionalLight){const I=e.get(D);if(I.color.copy(D.color).multiplyScalar(D.intensity),D.castShadow){const B=D.shadow,$=t.get(D);$.shadowIntensity=B.intensity,$.shadowBias=B.bias,$.shadowNormalBias=B.normalBias,$.shadowRadius=B.radius,$.shadowMapSize=B.mapSize,r.directionalShadow[f]=$,r.directionalShadowMap[f]=G,r.directionalShadowMatrix[f]=D.shadow.matrix,b++}r.directional[f]=I,f++}else if(D.isSpotLight){const I=e.get(D);I.position.setFromMatrixPosition(D.matrixWorld),I.color.copy(N).multiplyScalar(R),I.distance=O,I.coneCos=Math.cos(D.angle),I.penumbraCos=Math.cos(D.angle*(1-D.penumbra)),I.decay=D.decay,r.spot[m]=I;const B=D.shadow;if(D.map&&(r.spotLightMap[_]=D.map,_++,B.updateMatrices(D),D.castShadow&&E++),r.spotLightMatrix[m]=B.matrix,D.castShadow){const $=t.get(D);$.shadowIntensity=B.intensity,$.shadowBias=B.bias,$.shadowNormalBias=B.normalBias,$.shadowRadius=B.radius,$.shadowMapSize=B.mapSize,r.spotShadow[m]=$,r.spotShadowMap[m]=G,w++}m++}else if(D.isRectAreaLight){const I=e.get(D);I.color.copy(N).multiplyScalar(R),I.halfWidth.set(D.width*.5,0,0),I.halfHeight.set(0,D.height*.5,0),r.rectArea[y]=I,y++}else if(D.isPointLight){const I=e.get(D);if(I.color.copy(D.color).multiplyScalar(D.intensity),I.distance=D.distance,I.decay=D.decay,D.castShadow){const B=D.shadow,$=t.get(D);$.shadowIntensity=B.intensity,$.shadowBias=B.bias,$.shadowNormalBias=B.normalBias,$.shadowRadius=B.radius,$.shadowMapSize=B.mapSize,$.shadowCameraNear=B.camera.near,$.shadowCameraFar=B.camera.far,r.pointShadow[p]=$,r.pointShadowMap[p]=G,r.pointShadowMatrix[p]=D.shadow.matrix,x++}r.point[p]=I,p++}else if(D.isHemisphereLight){const I=e.get(D);I.skyColor.copy(D.color).multiplyScalar(R),I.groundColor.copy(D.groundColor).multiplyScalar(R),r.hemi[v]=I,v++}}y>0&&(n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=lt.LTC_FLOAT_1,r.rectAreaLTC2=lt.LTC_FLOAT_2):(r.rectAreaLTC1=lt.LTC_HALF_1,r.rectAreaLTC2=lt.LTC_HALF_2)),r.ambient[0]=c,r.ambient[1]=h,r.ambient[2]=d;const T=r.hash;(T.directionalLength!==f||T.pointLength!==p||T.spotLength!==m||T.rectAreaLength!==y||T.hemiLength!==v||T.numDirectionalShadows!==b||T.numPointShadows!==x||T.numSpotShadows!==w||T.numSpotMaps!==_||T.numLightProbes!==A)&&(r.directional.length=f,r.spot.length=m,r.rectArea.length=y,r.point.length=p,r.hemi.length=v,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=x,r.pointShadowMap.length=x,r.spotShadow.length=w,r.spotShadowMap.length=w,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=x,r.spotLightMatrix.length=w+_-E,r.spotLightMap.length=_,r.numSpotLightShadowsWithMaps=E,r.numLightProbes=A,T.directionalLength=f,T.pointLength=p,T.spotLength=m,T.rectAreaLength=y,T.hemiLength=v,T.numDirectionalShadows=b,T.numPointShadows=x,T.numSpotShadows=w,T.numSpotMaps=_,T.numLightProbes=A,r.version=DTe++)}function l(u,c){let h=0,d=0,f=0,p=0,m=0;const y=c.matrixWorldInverse;for(let v=0,b=u.length;v<b;v++){const x=u[v];if(x.isDirectionalLight){const w=r.directional[h];w.direction.setFromMatrixPosition(x.matrixWorld),i.setFromMatrixPosition(x.target.matrixWorld),w.direction.sub(i),w.direction.transformDirection(y),h++}else if(x.isSpotLight){const w=r.spot[f];w.position.setFromMatrixPosition(x.matrixWorld),w.position.applyMatrix4(y),w.direction.setFromMatrixPosition(x.matrixWorld),i.setFromMatrixPosition(x.target.matrixWorld),w.direction.sub(i),w.direction.transformDirection(y),f++}else if(x.isRectAreaLight){const w=r.rectArea[p];w.position.setFromMatrixPosition(x.matrixWorld),w.position.applyMatrix4(y),a.identity(),s.copy(x.matrixWorld),s.premultiply(y),a.extractRotation(s),w.halfWidth.set(x.width*.5,0,0),w.halfHeight.set(0,x.height*.5,0),w.halfWidth.applyMatrix4(a),w.halfHeight.applyMatrix4(a),p++}else if(x.isPointLight){const w=r.point[d];w.position.setFromMatrixPosition(x.matrixWorld),w.position.applyMatrix4(y),d++}else if(x.isHemisphereLight){const w=r.hemi[m];w.direction.setFromMatrixPosition(x.matrixWorld),w.direction.transformDirection(y),m++}}}return{setup:o,setupView:l,state:r}}function Y9(n){const e=new RTe(n),t=[],r=[];function i(c){u.camera=c,t.length=0,r.length=0}function s(c){t.push(c)}function a(c){r.push(c)}function o(){e.setup(t)}function l(c){e.setupView(t,c)}const u={lightsArray:t,shadowsArray:r,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:u,setupLights:o,setupLightsView:l,pushLight:s,pushShadow:a}}function ITe(n){let e=new WeakMap;function t(i,s=0){const a=e.get(i);let o;return a===void 0?(o=new Y9(n),e.set(i,[o])):s>=a.length?(o=new Y9(n),a.push(o)):o=a[s],o}function r(){e=new WeakMap}return{get:t,dispose:r}}const PTe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,FTe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,LTe=[new Ae(1,0,0),new Ae(-1,0,0),new Ae(0,1,0),new Ae(0,-1,0),new Ae(0,0,1),new Ae(0,0,-1)],OTe=[new Ae(0,-1,0),new Ae(0,-1,0),new Ae(0,0,1),new Ae(0,0,-1),new Ae(0,-1,0),new Ae(0,-1,0)],Q9=new Ir,N_=new Ae,WI=new Ae;function kTe(n,e,t){let r=new $4;const i=new Cn,s=new Cn,a=new ei,o=new Y1e,l=new Q1e,u={},c=t.maxTextureSize,h={[Ip]:eo,[eo]:Ip,[kh]:kh},d=new Mc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Cn},radius:{value:4}},vertexShader:PTe,fragmentShader:FTe}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new Zr;p.setAttribute("position",new _s(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new qn(p,d),y=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=oC;let v=this.type;this.render=function(E,A,T){if(y.enabled===!1||y.autoUpdate===!1&&y.needsUpdate===!1||E.length===0)return;E.type===z_e&&($t("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),E.type=oC);const S=n.getRenderTarget(),M=n.getActiveCubeFace(),D=n.getActiveMipmapLevel(),N=n.state;N.setBlending(Kh),N.buffers.depth.getReversed()===!0?N.buffers.color.setClear(0,0,0,0):N.buffers.color.setClear(1,1,1,1),N.buffers.depth.setTest(!0),N.setScissorTest(!1);const R=v!==this.type;R&&A.traverse(function(O){O.material&&(Array.isArray(O.material)?O.material.forEach(G=>G.needsUpdate=!0):O.material.needsUpdate=!0)});for(let O=0,G=E.length;O<G;O++){const I=E[O],B=I.shadow;if(B===void 0){$t("WebGLShadowMap:",I,"has no shadow.");continue}if(B.autoUpdate===!1&&B.needsUpdate===!1)continue;i.copy(B.mapSize);const $=B.getFrameExtents();if(i.multiply($),s.copy(B.mapSize),(i.x>c||i.y>c)&&(i.x>c&&(s.x=Math.floor(c/$.x),i.x=s.x*$.x,B.mapSize.x=s.x),i.y>c&&(s.y=Math.floor(c/$.y),i.y=s.y*$.y,B.mapSize.y=s.y)),B.map===null||R===!0){if(B.map!==null&&(B.map.depthTexture!==null&&(B.map.depthTexture.dispose(),B.map.depthTexture=null),B.map.dispose()),this.type===d1){if(I.isPointLight){$t("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}B.map=new _c(i.x,i.y,{format:vb,type:pd,minFilter:Zs,magFilter:Zs,generateMipmaps:!1}),B.map.texture.name=I.name+".shadowMap",B.map.depthTexture=new Dw(i.x,i.y,ac),B.map.depthTexture.name=I.name+".shadowMapDepth",B.map.depthTexture.format=md,B.map.depthTexture.compareFunction=null,B.map.depthTexture.minFilter=Ss,B.map.depthTexture.magFilter=Ss}else{I.isPointLight?(B.map=new Yee(i.x),B.map.depthTexture=new X1e(i.x,Ac)):(B.map=new _c(i.x,i.y),B.map.depthTexture=new Dw(i.x,i.y,Ac)),B.map.depthTexture.name=I.name+".shadowMap",B.map.depthTexture.format=md;const Q=n.state.buffers.depth.getReversed();this.type===oC?(B.map.depthTexture.compareFunction=Q?U4:B4,B.map.depthTexture.minFilter=Zs,B.map.depthTexture.magFilter=Zs):(B.map.depthTexture.compareFunction=null,B.map.depthTexture.minFilter=Ss,B.map.depthTexture.magFilter=Ss)}B.camera.updateProjectionMatrix()}const H=B.map.isWebGLCubeRenderTarget?6:1;for(let Q=0;Q<H;Q++){if(B.map.isWebGLCubeRenderTarget)n.setRenderTarget(B.map,Q),n.clear();else{Q===0&&(n.setRenderTarget(B.map),n.clear());const ee=B.getViewport(Q);a.set(s.x*ee.x,s.y*ee.y,s.x*ee.z,s.y*ee.w),N.viewport(a)}if(I.isPointLight){const ee=B.camera,J=B.matrix,L=I.distance||ee.far;L!==ee.far&&(ee.far=L,ee.updateProjectionMatrix()),N_.setFromMatrixPosition(I.matrixWorld),ee.position.copy(N_),WI.copy(ee.position),WI.add(LTe[Q]),ee.up.copy(OTe[Q]),ee.lookAt(WI),ee.updateMatrixWorld(),J.makeTranslation(-N_.x,-N_.y,-N_.z),Q9.multiplyMatrices(ee.projectionMatrix,ee.matrixWorldInverse),B._frustum.setFromProjectionMatrix(Q9,ee.coordinateSystem,ee.reversedDepth)}else B.updateMatrices(I);r=B.getFrustum(),w(A,T,B.camera,I,this.type)}B.isPointLightShadow!==!0&&this.type===d1&&b(B,T),B.needsUpdate=!1}v=this.type,y.needsUpdate=!1,n.setRenderTarget(S,M,D)};function b(E,A){const T=e.update(m);d.defines.VSM_SAMPLES!==E.blurSamples&&(d.defines.VSM_SAMPLES=E.blurSamples,f.defines.VSM_SAMPLES=E.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),E.mapPass===null&&(E.mapPass=new _c(i.x,i.y,{format:vb,type:pd})),d.uniforms.shadow_pass.value=E.map.depthTexture,d.uniforms.resolution.value=E.mapSize,d.uniforms.radius.value=E.radius,n.setRenderTarget(E.mapPass),n.clear(),n.renderBufferDirect(A,null,T,d,m,null),f.uniforms.shadow_pass.value=E.mapPass.texture,f.uniforms.resolution.value=E.mapSize,f.uniforms.radius.value=E.radius,n.setRenderTarget(E.map),n.clear(),n.renderBufferDirect(A,null,T,f,m,null)}function x(E,A,T,S){let M=null;const D=T.isPointLight===!0?E.customDistanceMaterial:E.customDepthMaterial;if(D!==void 0)M=D;else if(M=T.isPointLight===!0?l:o,n.localClippingEnabled&&A.clipShadows===!0&&Array.isArray(A.clippingPlanes)&&A.clippingPlanes.length!==0||A.displacementMap&&A.displacementScale!==0||A.alphaMap&&A.alphaTest>0||A.map&&A.alphaTest>0||A.alphaToCoverage===!0){const N=M.uuid,R=A.uuid;let O=u[N];O===void 0&&(O={},u[N]=O);let G=O[R];G===void 0&&(G=M.clone(),O[R]=G,A.addEventListener("dispose",_)),M=G}if(M.visible=A.visible,M.wireframe=A.wireframe,S===d1?M.side=A.shadowSide!==null?A.shadowSide:A.side:M.side=A.shadowSide!==null?A.shadowSide:h[A.side],M.alphaMap=A.alphaMap,M.alphaTest=A.alphaToCoverage===!0?.5:A.alphaTest,M.map=A.map,M.clipShadows=A.clipShadows,M.clippingPlanes=A.clippingPlanes,M.clipIntersection=A.clipIntersection,M.displacementMap=A.displacementMap,M.displacementScale=A.displacementScale,M.displacementBias=A.displacementBias,M.wireframeLinewidth=A.wireframeLinewidth,M.linewidth=A.linewidth,T.isPointLight===!0&&M.isMeshDistanceMaterial===!0){const N=n.properties.get(M);N.light=T}return M}function w(E,A,T,S,M){if(E.visible===!1)return;if(E.layers.test(A.layers)&&(E.isMesh||E.isLine||E.isPoints)&&(E.castShadow||E.receiveShadow&&M===d1)&&(!E.frustumCulled||r.intersectsObject(E))){E.modelViewMatrix.multiplyMatrices(T.matrixWorldInverse,E.matrixWorld);const R=e.update(E),O=E.material;if(Array.isArray(O)){const G=R.groups;for(let I=0,B=G.length;I<B;I++){const $=G[I],H=O[$.materialIndex];if(H&&H.visible){const Q=x(E,H,S,M);E.onBeforeShadow(n,E,A,T,R,Q,$),n.renderBufferDirect(T,null,R,Q,E,$),E.onAfterShadow(n,E,A,T,R,Q,$)}}}else if(O.visible){const G=x(E,O,S,M);E.onBeforeShadow(n,E,A,T,R,G,null),n.renderBufferDirect(T,null,R,G,E,null),E.onAfterShadow(n,E,A,T,R,G,null)}}const N=E.children;for(let R=0,O=N.length;R<O;R++)w(N[R],A,T,S,M)}function _(E){E.target.removeEventListener("dispose",_);for(const T in u){const S=u[T],M=E.target.uuid;M in S&&(S[M].dispose(),delete S[M])}}}const BTe={[AL]:TL,[ML]:NL,[CL]:RL,[mb]:DL,[TL]:AL,[NL]:ML,[RL]:CL,[DL]:mb};function UTe(n,e){function t(){let W=!1;const ye=new ei;let Ee=null;const Fe=new ei(0,0,0,0);return{setMask:function(Le){Ee!==Le&&!W&&(n.colorMask(Le,Le,Le,Le),Ee=Le)},setLocked:function(Le){W=Le},setClear:function(Le,Ue,tt,Pt,Vn){Vn===!0&&(Le*=Pt,Ue*=Pt,tt*=Pt),ye.set(Le,Ue,tt,Pt),Fe.equals(ye)===!1&&(n.clearColor(Le,Ue,tt,Pt),Fe.copy(ye))},reset:function(){W=!1,Ee=null,Fe.set(-1,0,0,0)}}}function r(){let W=!1,ye=!1,Ee=null,Fe=null,Le=null;return{setReversed:function(Ue){if(ye!==Ue){const tt=e.get("EXT_clip_control");Ue?tt.clipControlEXT(tt.LOWER_LEFT_EXT,tt.ZERO_TO_ONE_EXT):tt.clipControlEXT(tt.LOWER_LEFT_EXT,tt.NEGATIVE_ONE_TO_ONE_EXT),ye=Ue;const Pt=Le;Le=null,this.setClear(Pt)}},getReversed:function(){return ye},setTest:function(Ue){Ue?ue(n.DEPTH_TEST):te(n.DEPTH_TEST)},setMask:function(Ue){Ee!==Ue&&!W&&(n.depthMask(Ue),Ee=Ue)},setFunc:function(Ue){if(ye&&(Ue=BTe[Ue]),Fe!==Ue){switch(Ue){case AL:n.depthFunc(n.NEVER);break;case TL:n.depthFunc(n.ALWAYS);break;case ML:n.depthFunc(n.LESS);break;case mb:n.depthFunc(n.LEQUAL);break;case CL:n.depthFunc(n.EQUAL);break;case DL:n.depthFunc(n.GEQUAL);break;case NL:n.depthFunc(n.GREATER);break;case RL:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Fe=Ue}},setLocked:function(Ue){W=Ue},setClear:function(Ue){Le!==Ue&&(ye&&(Ue=1-Ue),n.clearDepth(Ue),Le=Ue)},reset:function(){W=!1,Ee=null,Fe=null,Le=null,ye=!1}}}function i(){let W=!1,ye=null,Ee=null,Fe=null,Le=null,Ue=null,tt=null,Pt=null,Vn=null;return{setTest:function(dn){W||(dn?ue(n.STENCIL_TEST):te(n.STENCIL_TEST))},setMask:function(dn){ye!==dn&&!W&&(n.stencilMask(dn),ye=dn)},setFunc:function(dn,Ia,ro){(Ee!==dn||Fe!==Ia||Le!==ro)&&(n.stencilFunc(dn,Ia,ro),Ee=dn,Fe=Ia,Le=ro)},setOp:function(dn,Ia,ro){(Ue!==dn||tt!==Ia||Pt!==ro)&&(n.stencilOp(dn,Ia,ro),Ue=dn,tt=Ia,Pt=ro)},setLocked:function(dn){W=dn},setClear:function(dn){Vn!==dn&&(n.clearStencil(dn),Vn=dn)},reset:function(){W=!1,ye=null,Ee=null,Fe=null,Le=null,Ue=null,tt=null,Pt=null,Vn=null}}}const s=new t,a=new r,o=new i,l=new WeakMap,u=new WeakMap;let c={},h={},d=new WeakMap,f=[],p=null,m=!1,y=null,v=null,b=null,x=null,w=null,_=null,E=null,A=new Ft(0,0,0),T=0,S=!1,M=null,D=null,N=null,R=null,O=null;const G=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let I=!1,B=0;const $=n.getParameter(n.VERSION);$.indexOf("WebGL")!==-1?(B=parseFloat(/^WebGL (\d)/.exec($)[1]),I=B>=1):$.indexOf("OpenGL ES")!==-1&&(B=parseFloat(/^OpenGL ES (\d)/.exec($)[1]),I=B>=2);let H=null,Q={};const ee=n.getParameter(n.SCISSOR_BOX),J=n.getParameter(n.VIEWPORT),L=new ei().fromArray(ee),se=new ei().fromArray(J);function Z(W,ye,Ee,Fe){const Le=new Uint8Array(4),Ue=n.createTexture();n.bindTexture(W,Ue),n.texParameteri(W,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(W,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let tt=0;tt<Ee;tt++)W===n.TEXTURE_3D||W===n.TEXTURE_2D_ARRAY?n.texImage3D(ye,0,n.RGBA,1,1,Fe,0,n.RGBA,n.UNSIGNED_BYTE,Le):n.texImage2D(ye+tt,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Le);return Ue}const le={};le[n.TEXTURE_2D]=Z(n.TEXTURE_2D,n.TEXTURE_2D,1),le[n.TEXTURE_CUBE_MAP]=Z(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),le[n.TEXTURE_2D_ARRAY]=Z(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),le[n.TEXTURE_3D]=Z(n.TEXTURE_3D,n.TEXTURE_3D,1,1),s.setClear(0,0,0,1),a.setClear(1),o.setClear(0),ue(n.DEPTH_TEST),a.setFunc(mb),$e(!1),nt(K8),ue(n.CULL_FACE),we(Kh);function ue(W){c[W]!==!0&&(n.enable(W),c[W]=!0)}function te(W){c[W]!==!1&&(n.disable(W),c[W]=!1)}function Y(W,ye){return h[W]!==ye?(n.bindFramebuffer(W,ye),h[W]=ye,W===n.DRAW_FRAMEBUFFER&&(h[n.FRAMEBUFFER]=ye),W===n.FRAMEBUFFER&&(h[n.DRAW_FRAMEBUFFER]=ye),!0):!1}function ie(W,ye){let Ee=f,Fe=!1;if(W){Ee=d.get(ye),Ee===void 0&&(Ee=[],d.set(ye,Ee));const Le=W.textures;if(Ee.length!==Le.length||Ee[0]!==n.COLOR_ATTACHMENT0){for(let Ue=0,tt=Le.length;Ue<tt;Ue++)Ee[Ue]=n.COLOR_ATTACHMENT0+Ue;Ee.length=Le.length,Fe=!0}}else Ee[0]!==n.BACK&&(Ee[0]=n.BACK,Fe=!0);Fe&&n.drawBuffers(Ee)}function ve(W){return p!==W?(n.useProgram(W),p=W,!0):!1}const ge={[Dm]:n.FUNC_ADD,[H_e]:n.FUNC_SUBTRACT,[G_e]:n.FUNC_REVERSE_SUBTRACT};ge[j_e]=n.MIN,ge[q_e]=n.MAX;const _e={[W_e]:n.ZERO,[X_e]:n.ONE,[K_e]:n.SRC_COLOR,[EL]:n.SRC_ALPHA,[t1e]:n.SRC_ALPHA_SATURATE,[J_e]:n.DST_COLOR,[Q_e]:n.DST_ALPHA,[Y_e]:n.ONE_MINUS_SRC_COLOR,[SL]:n.ONE_MINUS_SRC_ALPHA,[e1e]:n.ONE_MINUS_DST_COLOR,[Z_e]:n.ONE_MINUS_DST_ALPHA,[n1e]:n.CONSTANT_COLOR,[r1e]:n.ONE_MINUS_CONSTANT_COLOR,[i1e]:n.CONSTANT_ALPHA,[s1e]:n.ONE_MINUS_CONSTANT_ALPHA};function we(W,ye,Ee,Fe,Le,Ue,tt,Pt,Vn,dn){if(W===Kh){m===!0&&(te(n.BLEND),m=!1);return}if(m===!1&&(ue(n.BLEND),m=!0),W!==$_e){if(W!==y||dn!==S){if((v!==Dm||w!==Dm)&&(n.blendEquation(n.FUNC_ADD),v=Dm,w=Dm),dn)switch(W){case Sy:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Y8:n.blendFunc(n.ONE,n.ONE);break;case Q8:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case Z8:n.blendFuncSeparate(n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ZERO,n.ONE);break;default:Bn("WebGLState: Invalid blending: ",W);break}else switch(W){case Sy:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Y8:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE,n.ONE,n.ONE);break;case Q8:Bn("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case Z8:Bn("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Bn("WebGLState: Invalid blending: ",W);break}b=null,x=null,_=null,E=null,A.set(0,0,0),T=0,y=W,S=dn}return}Le=Le||ye,Ue=Ue||Ee,tt=tt||Fe,(ye!==v||Le!==w)&&(n.blendEquationSeparate(ge[ye],ge[Le]),v=ye,w=Le),(Ee!==b||Fe!==x||Ue!==_||tt!==E)&&(n.blendFuncSeparate(_e[Ee],_e[Fe],_e[Ue],_e[tt]),b=Ee,x=Fe,_=Ue,E=tt),(Pt.equals(A)===!1||Vn!==T)&&(n.blendColor(Pt.r,Pt.g,Pt.b,Vn),A.copy(Pt),T=Vn),y=W,S=!1}function Be(W,ye){W.side===kh?te(n.CULL_FACE):ue(n.CULL_FACE);let Ee=W.side===eo;ye&&(Ee=!Ee),$e(Ee),W.blending===Sy&&W.transparent===!1?we(Kh):we(W.blending,W.blendEquation,W.blendSrc,W.blendDst,W.blendEquationAlpha,W.blendSrcAlpha,W.blendDstAlpha,W.blendColor,W.blendAlpha,W.premultipliedAlpha),a.setFunc(W.depthFunc),a.setTest(W.depthTest),a.setMask(W.depthWrite),s.setMask(W.colorWrite);const Fe=W.stencilWrite;o.setTest(Fe),Fe&&(o.setMask(W.stencilWriteMask),o.setFunc(W.stencilFunc,W.stencilRef,W.stencilFuncMask),o.setOp(W.stencilFail,W.stencilZFail,W.stencilZPass)),Ye(W.polygonOffset,W.polygonOffsetFactor,W.polygonOffsetUnits),W.alphaToCoverage===!0?ue(n.SAMPLE_ALPHA_TO_COVERAGE):te(n.SAMPLE_ALPHA_TO_COVERAGE)}function $e(W){M!==W&&(W?n.frontFace(n.CW):n.frontFace(n.CCW),M=W)}function nt(W){W!==U_e?(ue(n.CULL_FACE),W!==D&&(W===K8?n.cullFace(n.BACK):W===V_e?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):te(n.CULL_FACE),D=W}function de(W){W!==N&&(I&&n.lineWidth(W),N=W)}function Ye(W,ye,Ee){W?(ue(n.POLYGON_OFFSET_FILL),(R!==ye||O!==Ee)&&(n.polygonOffset(ye,Ee),R=ye,O=Ee)):te(n.POLYGON_OFFSET_FILL)}function Xe(W){W?ue(n.SCISSOR_TEST):te(n.SCISSOR_TEST)}function ae(W){W===void 0&&(W=n.TEXTURE0+G-1),H!==W&&(n.activeTexture(W),H=W)}function fe(W,ye,Ee){Ee===void 0&&(H===null?Ee=n.TEXTURE0+G-1:Ee=H);let Fe=Q[Ee];Fe===void 0&&(Fe={type:void 0,texture:void 0},Q[Ee]=Fe),(Fe.type!==W||Fe.texture!==ye)&&(H!==Ee&&(n.activeTexture(Ee),H=Ee),n.bindTexture(W,ye||le[W]),Fe.type=W,Fe.texture=ye)}function F(){const W=Q[H];W!==void 0&&W.type!==void 0&&(n.bindTexture(W.type,null),W.type=void 0,W.texture=void 0)}function P(){try{n.compressedTexImage2D(...arguments)}catch(W){Bn("WebGLState:",W)}}function K(){try{n.compressedTexImage3D(...arguments)}catch(W){Bn("WebGLState:",W)}}function oe(){try{n.texSubImage2D(...arguments)}catch(W){Bn("WebGLState:",W)}}function pe(){try{n.texSubImage3D(...arguments)}catch(W){Bn("WebGLState:",W)}}function ce(){try{n.compressedTexSubImage2D(...arguments)}catch(W){Bn("WebGLState:",W)}}function Te(){try{n.compressedTexSubImage3D(...arguments)}catch(W){Bn("WebGLState:",W)}}function be(){try{n.texStorage2D(...arguments)}catch(W){Bn("WebGLState:",W)}}function Pe(){try{n.texStorage3D(...arguments)}catch(W){Bn("WebGLState:",W)}}function Me(){try{n.texImage2D(...arguments)}catch(W){Bn("WebGLState:",W)}}function Ne(){try{n.texImage3D(...arguments)}catch(W){Bn("WebGLState:",W)}}function ze(W){L.equals(W)===!1&&(n.scissor(W.x,W.y,W.z,W.w),L.copy(W))}function Ke(W){se.equals(W)===!1&&(n.viewport(W.x,W.y,W.z,W.w),se.copy(W))}function Ge(W,ye){let Ee=u.get(ye);Ee===void 0&&(Ee=new WeakMap,u.set(ye,Ee));let Fe=Ee.get(W);Fe===void 0&&(Fe=n.getUniformBlockIndex(ye,W.name),Ee.set(W,Fe))}function qe(W,ye){const Fe=u.get(ye).get(W);l.get(ye)!==Fe&&(n.uniformBlockBinding(ye,Fe,W.__bindingPointIndex),l.set(ye,Fe))}function z(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),a.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),c={},H=null,Q={},h={},d=new WeakMap,f=[],p=null,m=!1,y=null,v=null,b=null,x=null,w=null,_=null,E=null,A=new Ft(0,0,0),T=0,S=!1,M=null,D=null,N=null,R=null,O=null,L.set(0,0,n.canvas.width,n.canvas.height),se.set(0,0,n.canvas.width,n.canvas.height),s.reset(),a.reset(),o.reset()}return{buffers:{color:s,depth:a,stencil:o},enable:ue,disable:te,bindFramebuffer:Y,drawBuffers:ie,useProgram:ve,setBlending:we,setMaterial:Be,setFlipSided:$e,setCullFace:nt,setLineWidth:de,setPolygonOffset:Ye,setScissorTest:Xe,activeTexture:ae,bindTexture:fe,unbindTexture:F,compressedTexImage2D:P,compressedTexImage3D:K,texImage2D:Me,texImage3D:Ne,updateUBOMapping:Ge,uniformBlockBinding:qe,texStorage2D:be,texStorage3D:Pe,texSubImage2D:oe,texSubImage3D:pe,compressedTexSubImage2D:ce,compressedTexSubImage3D:Te,scissor:ze,viewport:Ke,reset:z}}function VTe(n,e,t,r,i,s,a){const o=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new Cn,c=new WeakMap;let h;const d=new WeakMap;let f=!1;try{f=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function p(F,P){return f?new OffscreenCanvas(F,P):CD("canvas")}function m(F,P,K){let oe=1;const pe=fe(F);if((pe.width>K||pe.height>K)&&(oe=K/Math.max(pe.width,pe.height)),oe<1)if(typeof HTMLImageElement<"u"&&F instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&F instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&F instanceof ImageBitmap||typeof VideoFrame<"u"&&F instanceof VideoFrame){const ce=Math.floor(oe*pe.width),Te=Math.floor(oe*pe.height);h===void 0&&(h=p(ce,Te));const be=P?p(ce,Te):h;return be.width=ce,be.height=Te,be.getContext("2d").drawImage(F,0,0,ce,Te),$t("WebGLRenderer: Texture has been resized from ("+pe.width+"x"+pe.height+") to ("+ce+"x"+Te+")."),be}else return"data"in F&&$t("WebGLRenderer: Image in DataTexture is too big ("+pe.width+"x"+pe.height+")."),F;return F}function y(F){return F.generateMipmaps}function v(F){n.generateMipmap(F)}function b(F){return F.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:F.isWebGL3DRenderTarget?n.TEXTURE_3D:F.isWebGLArrayRenderTarget||F.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function x(F,P,K,oe,pe=!1){if(F!==null){if(n[F]!==void 0)return n[F];$t("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+F+"'")}let ce=P;if(P===n.RED&&(K===n.FLOAT&&(ce=n.R32F),K===n.HALF_FLOAT&&(ce=n.R16F),K===n.UNSIGNED_BYTE&&(ce=n.R8)),P===n.RED_INTEGER&&(K===n.UNSIGNED_BYTE&&(ce=n.R8UI),K===n.UNSIGNED_SHORT&&(ce=n.R16UI),K===n.UNSIGNED_INT&&(ce=n.R32UI),K===n.BYTE&&(ce=n.R8I),K===n.SHORT&&(ce=n.R16I),K===n.INT&&(ce=n.R32I)),P===n.RG&&(K===n.FLOAT&&(ce=n.RG32F),K===n.HALF_FLOAT&&(ce=n.RG16F),K===n.UNSIGNED_BYTE&&(ce=n.RG8)),P===n.RG_INTEGER&&(K===n.UNSIGNED_BYTE&&(ce=n.RG8UI),K===n.UNSIGNED_SHORT&&(ce=n.RG16UI),K===n.UNSIGNED_INT&&(ce=n.RG32UI),K===n.BYTE&&(ce=n.RG8I),K===n.SHORT&&(ce=n.RG16I),K===n.INT&&(ce=n.RG32I)),P===n.RGB_INTEGER&&(K===n.UNSIGNED_BYTE&&(ce=n.RGB8UI),K===n.UNSIGNED_SHORT&&(ce=n.RGB16UI),K===n.UNSIGNED_INT&&(ce=n.RGB32UI),K===n.BYTE&&(ce=n.RGB8I),K===n.SHORT&&(ce=n.RGB16I),K===n.INT&&(ce=n.RGB32I)),P===n.RGBA_INTEGER&&(K===n.UNSIGNED_BYTE&&(ce=n.RGBA8UI),K===n.UNSIGNED_SHORT&&(ce=n.RGBA16UI),K===n.UNSIGNED_INT&&(ce=n.RGBA32UI),K===n.BYTE&&(ce=n.RGBA8I),K===n.SHORT&&(ce=n.RGBA16I),K===n.INT&&(ce=n.RGBA32I)),P===n.RGB&&(K===n.UNSIGNED_INT_5_9_9_9_REV&&(ce=n.RGB9_E5),K===n.UNSIGNED_INT_10F_11F_11F_REV&&(ce=n.R11F_G11F_B10F)),P===n.RGBA){const Te=pe?TD:In.getTransfer(oe);K===n.FLOAT&&(ce=n.RGBA32F),K===n.HALF_FLOAT&&(ce=n.RGBA16F),K===n.UNSIGNED_BYTE&&(ce=Te===Wn?n.SRGB8_ALPHA8:n.RGBA8),K===n.UNSIGNED_SHORT_4_4_4_4&&(ce=n.RGBA4),K===n.UNSIGNED_SHORT_5_5_5_1&&(ce=n.RGB5_A1)}return(ce===n.R16F||ce===n.R32F||ce===n.RG16F||ce===n.RG32F||ce===n.RGBA16F||ce===n.RGBA32F)&&e.get("EXT_color_buffer_float"),ce}function w(F,P){let K;return F?P===null||P===Ac||P===Mw?K=n.DEPTH24_STENCIL8:P===ac?K=n.DEPTH32F_STENCIL8:P===Tw&&(K=n.DEPTH24_STENCIL8,$t("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):P===null||P===Ac||P===Mw?K=n.DEPTH_COMPONENT24:P===ac?K=n.DEPTH_COMPONENT32F:P===Tw&&(K=n.DEPTH_COMPONENT16),K}function _(F,P){return y(F)===!0||F.isFramebufferTexture&&F.minFilter!==Ss&&F.minFilter!==Zs?Math.log2(Math.max(P.width,P.height))+1:F.mipmaps!==void 0&&F.mipmaps.length>0?F.mipmaps.length:F.isCompressedTexture&&Array.isArray(F.image)?P.mipmaps.length:1}function E(F){const P=F.target;P.removeEventListener("dispose",E),T(P),P.isVideoTexture&&c.delete(P)}function A(F){const P=F.target;P.removeEventListener("dispose",A),M(P)}function T(F){const P=r.get(F);if(P.__webglInit===void 0)return;const K=F.source,oe=d.get(K);if(oe){const pe=oe[P.__cacheKey];pe.usedTimes--,pe.usedTimes===0&&S(F),Object.keys(oe).length===0&&d.delete(K)}r.remove(F)}function S(F){const P=r.get(F);n.deleteTexture(P.__webglTexture);const K=F.source,oe=d.get(K);delete oe[P.__cacheKey],a.memory.textures--}function M(F){const P=r.get(F);if(F.depthTexture&&(F.depthTexture.dispose(),r.remove(F.depthTexture)),F.isWebGLCubeRenderTarget)for(let oe=0;oe<6;oe++){if(Array.isArray(P.__webglFramebuffer[oe]))for(let pe=0;pe<P.__webglFramebuffer[oe].length;pe++)n.deleteFramebuffer(P.__webglFramebuffer[oe][pe]);else n.deleteFramebuffer(P.__webglFramebuffer[oe]);P.__webglDepthbuffer&&n.deleteRenderbuffer(P.__webglDepthbuffer[oe])}else{if(Array.isArray(P.__webglFramebuffer))for(let oe=0;oe<P.__webglFramebuffer.length;oe++)n.deleteFramebuffer(P.__webglFramebuffer[oe]);else n.deleteFramebuffer(P.__webglFramebuffer);if(P.__webglDepthbuffer&&n.deleteRenderbuffer(P.__webglDepthbuffer),P.__webglMultisampledFramebuffer&&n.deleteFramebuffer(P.__webglMultisampledFramebuffer),P.__webglColorRenderbuffer)for(let oe=0;oe<P.__webglColorRenderbuffer.length;oe++)P.__webglColorRenderbuffer[oe]&&n.deleteRenderbuffer(P.__webglColorRenderbuffer[oe]);P.__webglDepthRenderbuffer&&n.deleteRenderbuffer(P.__webglDepthRenderbuffer)}const K=F.textures;for(let oe=0,pe=K.length;oe<pe;oe++){const ce=r.get(K[oe]);ce.__webglTexture&&(n.deleteTexture(ce.__webglTexture),a.memory.textures--),r.remove(K[oe])}r.remove(F)}let D=0;function N(){D=0}function R(){const F=D;return F>=i.maxTextures&&$t("WebGLTextures: Trying to use "+F+" texture units while this GPU supports only "+i.maxTextures),D+=1,F}function O(F){const P=[];return P.push(F.wrapS),P.push(F.wrapT),P.push(F.wrapR||0),P.push(F.magFilter),P.push(F.minFilter),P.push(F.anisotropy),P.push(F.internalFormat),P.push(F.format),P.push(F.type),P.push(F.generateMipmaps),P.push(F.premultiplyAlpha),P.push(F.flipY),P.push(F.unpackAlignment),P.push(F.colorSpace),P.join()}function G(F,P){const K=r.get(F);if(F.isVideoTexture&&Xe(F),F.isRenderTargetTexture===!1&&F.isExternalTexture!==!0&&F.version>0&&K.__version!==F.version){const oe=F.image;if(oe===null)$t("WebGLRenderer: Texture marked for update but no image data found.");else if(oe.complete===!1)$t("WebGLRenderer: Texture marked for update but image is incomplete");else{le(K,F,P);return}}else F.isExternalTexture&&(K.__webglTexture=F.sourceTexture?F.sourceTexture:null);t.bindTexture(n.TEXTURE_2D,K.__webglTexture,n.TEXTURE0+P)}function I(F,P){const K=r.get(F);if(F.isRenderTargetTexture===!1&&F.version>0&&K.__version!==F.version){le(K,F,P);return}else F.isExternalTexture&&(K.__webglTexture=F.sourceTexture?F.sourceTexture:null);t.bindTexture(n.TEXTURE_2D_ARRAY,K.__webglTexture,n.TEXTURE0+P)}function B(F,P){const K=r.get(F);if(F.isRenderTargetTexture===!1&&F.version>0&&K.__version!==F.version){le(K,F,P);return}t.bindTexture(n.TEXTURE_3D,K.__webglTexture,n.TEXTURE0+P)}function $(F,P){const K=r.get(F);if(F.isCubeDepthTexture!==!0&&F.version>0&&K.__version!==F.version){ue(K,F,P);return}t.bindTexture(n.TEXTURE_CUBE_MAP,K.__webglTexture,n.TEXTURE0+P)}const H={[FL]:n.REPEAT,[$h]:n.CLAMP_TO_EDGE,[LL]:n.MIRRORED_REPEAT},Q={[Ss]:n.NEAREST,[l1e]:n.NEAREST_MIPMAP_NEAREST,[lT]:n.NEAREST_MIPMAP_LINEAR,[Zs]:n.LINEAR,[mI]:n.LINEAR_MIPMAP_NEAREST,[zm]:n.LINEAR_MIPMAP_LINEAR},ee={[h1e]:n.NEVER,[g1e]:n.ALWAYS,[d1e]:n.LESS,[B4]:n.LEQUAL,[f1e]:n.EQUAL,[U4]:n.GEQUAL,[p1e]:n.GREATER,[m1e]:n.NOTEQUAL};function J(F,P){if(P.type===ac&&e.has("OES_texture_float_linear")===!1&&(P.magFilter===Zs||P.magFilter===mI||P.magFilter===lT||P.magFilter===zm||P.minFilter===Zs||P.minFilter===mI||P.minFilter===lT||P.minFilter===zm)&&$t("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(F,n.TEXTURE_WRAP_S,H[P.wrapS]),n.texParameteri(F,n.TEXTURE_WRAP_T,H[P.wrapT]),(F===n.TEXTURE_3D||F===n.TEXTURE_2D_ARRAY)&&n.texParameteri(F,n.TEXTURE_WRAP_R,H[P.wrapR]),n.texParameteri(F,n.TEXTURE_MAG_FILTER,Q[P.magFilter]),n.texParameteri(F,n.TEXTURE_MIN_FILTER,Q[P.minFilter]),P.compareFunction&&(n.texParameteri(F,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(F,n.TEXTURE_COMPARE_FUNC,ee[P.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(P.magFilter===Ss||P.minFilter!==lT&&P.minFilter!==zm||P.type===ac&&e.has("OES_texture_float_linear")===!1)return;if(P.anisotropy>1||r.get(P).__currentAnisotropy){const K=e.get("EXT_texture_filter_anisotropic");n.texParameterf(F,K.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(P.anisotropy,i.getMaxAnisotropy())),r.get(P).__currentAnisotropy=P.anisotropy}}}function L(F,P){let K=!1;F.__webglInit===void 0&&(F.__webglInit=!0,P.addEventListener("dispose",E));const oe=P.source;let pe=d.get(oe);pe===void 0&&(pe={},d.set(oe,pe));const ce=O(P);if(ce!==F.__cacheKey){pe[ce]===void 0&&(pe[ce]={texture:n.createTexture(),usedTimes:0},a.memory.textures++,K=!0),pe[ce].usedTimes++;const Te=pe[F.__cacheKey];Te!==void 0&&(pe[F.__cacheKey].usedTimes--,Te.usedTimes===0&&S(P)),F.__cacheKey=ce,F.__webglTexture=pe[ce].texture}return K}function se(F,P,K){return Math.floor(Math.floor(F/K)/P)}function Z(F,P,K,oe){const ce=F.updateRanges;if(ce.length===0)t.texSubImage2D(n.TEXTURE_2D,0,0,0,P.width,P.height,K,oe,P.data);else{ce.sort((Ne,ze)=>Ne.start-ze.start);let Te=0;for(let Ne=1;Ne<ce.length;Ne++){const ze=ce[Te],Ke=ce[Ne],Ge=ze.start+ze.count,qe=se(Ke.start,P.width,4),z=se(ze.start,P.width,4);Ke.start<=Ge+1&&qe===z&&se(Ke.start+Ke.count-1,P.width,4)===qe?ze.count=Math.max(ze.count,Ke.start+Ke.count-ze.start):(++Te,ce[Te]=Ke)}ce.length=Te+1;const be=n.getParameter(n.UNPACK_ROW_LENGTH),Pe=n.getParameter(n.UNPACK_SKIP_PIXELS),Me=n.getParameter(n.UNPACK_SKIP_ROWS);n.pixelStorei(n.UNPACK_ROW_LENGTH,P.width);for(let Ne=0,ze=ce.length;Ne<ze;Ne++){const Ke=ce[Ne],Ge=Math.floor(Ke.start/4),qe=Math.ceil(Ke.count/4),z=Ge%P.width,W=Math.floor(Ge/P.width),ye=qe,Ee=1;n.pixelStorei(n.UNPACK_SKIP_PIXELS,z),n.pixelStorei(n.UNPACK_SKIP_ROWS,W),t.texSubImage2D(n.TEXTURE_2D,0,z,W,ye,Ee,K,oe,P.data)}F.clearUpdateRanges(),n.pixelStorei(n.UNPACK_ROW_LENGTH,be),n.pixelStorei(n.UNPACK_SKIP_PIXELS,Pe),n.pixelStorei(n.UNPACK_SKIP_ROWS,Me)}}function le(F,P,K){let oe=n.TEXTURE_2D;(P.isDataArrayTexture||P.isCompressedArrayTexture)&&(oe=n.TEXTURE_2D_ARRAY),P.isData3DTexture&&(oe=n.TEXTURE_3D);const pe=L(F,P),ce=P.source;t.bindTexture(oe,F.__webglTexture,n.TEXTURE0+K);const Te=r.get(ce);if(ce.version!==Te.__version||pe===!0){t.activeTexture(n.TEXTURE0+K);const be=In.getPrimaries(In.workingColorSpace),Pe=P.colorSpace===rf?null:In.getPrimaries(P.colorSpace),Me=P.colorSpace===rf||be===Pe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,P.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,P.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,P.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Me);let Ne=m(P.image,!1,i.maxTextureSize);Ne=ae(P,Ne);const ze=s.convert(P.format,P.colorSpace),Ke=s.convert(P.type);let Ge=x(P.internalFormat,ze,Ke,P.colorSpace,P.isVideoTexture);J(oe,P);let qe;const z=P.mipmaps,W=P.isVideoTexture!==!0,ye=Te.__version===void 0||pe===!0,Ee=ce.dataReady,Fe=_(P,Ne);if(P.isDepthTexture)Ge=w(P.format===$m,P.type),ye&&(W?t.texStorage2D(n.TEXTURE_2D,1,Ge,Ne.width,Ne.height):t.texImage2D(n.TEXTURE_2D,0,Ge,Ne.width,Ne.height,0,ze,Ke,null));else if(P.isDataTexture)if(z.length>0){W&&ye&&t.texStorage2D(n.TEXTURE_2D,Fe,Ge,z[0].width,z[0].height);for(let Le=0,Ue=z.length;Le<Ue;Le++)qe=z[Le],W?Ee&&t.texSubImage2D(n.TEXTURE_2D,Le,0,0,qe.width,qe.height,ze,Ke,qe.data):t.texImage2D(n.TEXTURE_2D,Le,Ge,qe.width,qe.height,0,ze,Ke,qe.data);P.generateMipmaps=!1}else W?(ye&&t.texStorage2D(n.TEXTURE_2D,Fe,Ge,Ne.width,Ne.height),Ee&&Z(P,Ne,ze,Ke)):t.texImage2D(n.TEXTURE_2D,0,Ge,Ne.width,Ne.height,0,ze,Ke,Ne.data);else if(P.isCompressedTexture)if(P.isCompressedArrayTexture){W&&ye&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Fe,Ge,z[0].width,z[0].height,Ne.depth);for(let Le=0,Ue=z.length;Le<Ue;Le++)if(qe=z[Le],P.format!==lu)if(ze!==null)if(W){if(Ee)if(P.layerUpdates.size>0){const tt=C9(qe.width,qe.height,P.format,P.type);for(const Pt of P.layerUpdates){const Vn=qe.data.subarray(Pt*tt/qe.data.BYTES_PER_ELEMENT,(Pt+1)*tt/qe.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Le,0,0,Pt,qe.width,qe.height,1,ze,Vn)}P.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Le,0,0,0,qe.width,qe.height,Ne.depth,ze,qe.data)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Le,Ge,qe.width,qe.height,Ne.depth,0,qe.data,0,0);else $t("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else W?Ee&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,Le,0,0,0,qe.width,qe.height,Ne.depth,ze,Ke,qe.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Le,Ge,qe.width,qe.height,Ne.depth,0,ze,Ke,qe.data)}else{W&&ye&&t.texStorage2D(n.TEXTURE_2D,Fe,Ge,z[0].width,z[0].height);for(let Le=0,Ue=z.length;Le<Ue;Le++)qe=z[Le],P.format!==lu?ze!==null?W?Ee&&t.compressedTexSubImage2D(n.TEXTURE_2D,Le,0,0,qe.width,qe.height,ze,qe.data):t.compressedTexImage2D(n.TEXTURE_2D,Le,Ge,qe.width,qe.height,0,qe.data):$t("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):W?Ee&&t.texSubImage2D(n.TEXTURE_2D,Le,0,0,qe.width,qe.height,ze,Ke,qe.data):t.texImage2D(n.TEXTURE_2D,Le,Ge,qe.width,qe.height,0,ze,Ke,qe.data)}else if(P.isDataArrayTexture)if(W){if(ye&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Fe,Ge,Ne.width,Ne.height,Ne.depth),Ee)if(P.layerUpdates.size>0){const Le=C9(Ne.width,Ne.height,P.format,P.type);for(const Ue of P.layerUpdates){const tt=Ne.data.subarray(Ue*Le/Ne.data.BYTES_PER_ELEMENT,(Ue+1)*Le/Ne.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,Ue,Ne.width,Ne.height,1,ze,Ke,tt)}P.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Ne.width,Ne.height,Ne.depth,ze,Ke,Ne.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,Ge,Ne.width,Ne.height,Ne.depth,0,ze,Ke,Ne.data);else if(P.isData3DTexture)W?(ye&&t.texStorage3D(n.TEXTURE_3D,Fe,Ge,Ne.width,Ne.height,Ne.depth),Ee&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Ne.width,Ne.height,Ne.depth,ze,Ke,Ne.data)):t.texImage3D(n.TEXTURE_3D,0,Ge,Ne.width,Ne.height,Ne.depth,0,ze,Ke,Ne.data);else if(P.isFramebufferTexture){if(ye)if(W)t.texStorage2D(n.TEXTURE_2D,Fe,Ge,Ne.width,Ne.height);else{let Le=Ne.width,Ue=Ne.height;for(let tt=0;tt<Fe;tt++)t.texImage2D(n.TEXTURE_2D,tt,Ge,Le,Ue,0,ze,Ke,null),Le>>=1,Ue>>=1}}else if(z.length>0){if(W&&ye){const Le=fe(z[0]);t.texStorage2D(n.TEXTURE_2D,Fe,Ge,Le.width,Le.height)}for(let Le=0,Ue=z.length;Le<Ue;Le++)qe=z[Le],W?Ee&&t.texSubImage2D(n.TEXTURE_2D,Le,0,0,ze,Ke,qe):t.texImage2D(n.TEXTURE_2D,Le,Ge,ze,Ke,qe);P.generateMipmaps=!1}else if(W){if(ye){const Le=fe(Ne);t.texStorage2D(n.TEXTURE_2D,Fe,Ge,Le.width,Le.height)}Ee&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,ze,Ke,Ne)}else t.texImage2D(n.TEXTURE_2D,0,Ge,ze,Ke,Ne);y(P)&&v(oe),Te.__version=ce.version,P.onUpdate&&P.onUpdate(P)}F.__version=P.version}function ue(F,P,K){if(P.image.length!==6)return;const oe=L(F,P),pe=P.source;t.bindTexture(n.TEXTURE_CUBE_MAP,F.__webglTexture,n.TEXTURE0+K);const ce=r.get(pe);if(pe.version!==ce.__version||oe===!0){t.activeTexture(n.TEXTURE0+K);const Te=In.getPrimaries(In.workingColorSpace),be=P.colorSpace===rf?null:In.getPrimaries(P.colorSpace),Pe=P.colorSpace===rf||Te===be?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,P.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,P.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,P.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Pe);const Me=P.isCompressedTexture||P.image[0].isCompressedTexture,Ne=P.image[0]&&P.image[0].isDataTexture,ze=[];for(let Ue=0;Ue<6;Ue++)!Me&&!Ne?ze[Ue]=m(P.image[Ue],!0,i.maxCubemapSize):ze[Ue]=Ne?P.image[Ue].image:P.image[Ue],ze[Ue]=ae(P,ze[Ue]);const Ke=ze[0],Ge=s.convert(P.format,P.colorSpace),qe=s.convert(P.type),z=x(P.internalFormat,Ge,qe,P.colorSpace),W=P.isVideoTexture!==!0,ye=ce.__version===void 0||oe===!0,Ee=pe.dataReady;let Fe=_(P,Ke);J(n.TEXTURE_CUBE_MAP,P);let Le;if(Me){W&&ye&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Fe,z,Ke.width,Ke.height);for(let Ue=0;Ue<6;Ue++){Le=ze[Ue].mipmaps;for(let tt=0;tt<Le.length;tt++){const Pt=Le[tt];P.format!==lu?Ge!==null?W?Ee&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,tt,0,0,Pt.width,Pt.height,Ge,Pt.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,tt,z,Pt.width,Pt.height,0,Pt.data):$t("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):W?Ee&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,tt,0,0,Pt.width,Pt.height,Ge,qe,Pt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,tt,z,Pt.width,Pt.height,0,Ge,qe,Pt.data)}}}else{if(Le=P.mipmaps,W&&ye){Le.length>0&&Fe++;const Ue=fe(ze[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,Fe,z,Ue.width,Ue.height)}for(let Ue=0;Ue<6;Ue++)if(Ne){W?Ee&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,0,0,ze[Ue].width,ze[Ue].height,Ge,qe,ze[Ue].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,z,ze[Ue].width,ze[Ue].height,0,Ge,qe,ze[Ue].data);for(let tt=0;tt<Le.length;tt++){const Vn=Le[tt].image[Ue].image;W?Ee&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,tt+1,0,0,Vn.width,Vn.height,Ge,qe,Vn.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,tt+1,z,Vn.width,Vn.height,0,Ge,qe,Vn.data)}}else{W?Ee&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,0,0,Ge,qe,ze[Ue]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,z,Ge,qe,ze[Ue]);for(let tt=0;tt<Le.length;tt++){const Pt=Le[tt];W?Ee&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,tt+1,0,0,Ge,qe,Pt.image[Ue]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,tt+1,z,Ge,qe,Pt.image[Ue])}}}y(P)&&v(n.TEXTURE_CUBE_MAP),ce.__version=pe.version,P.onUpdate&&P.onUpdate(P)}F.__version=P.version}function te(F,P,K,oe,pe,ce){const Te=s.convert(K.format,K.colorSpace),be=s.convert(K.type),Pe=x(K.internalFormat,Te,be,K.colorSpace),Me=r.get(P),Ne=r.get(K);if(Ne.__renderTarget=P,!Me.__hasExternalTextures){const ze=Math.max(1,P.width>>ce),Ke=Math.max(1,P.height>>ce);pe===n.TEXTURE_3D||pe===n.TEXTURE_2D_ARRAY?t.texImage3D(pe,ce,Pe,ze,Ke,P.depth,0,Te,be,null):t.texImage2D(pe,ce,Pe,ze,Ke,0,Te,be,null)}t.bindFramebuffer(n.FRAMEBUFFER,F),Ye(P)?o.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,oe,pe,Ne.__webglTexture,0,de(P)):(pe===n.TEXTURE_2D||pe>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&pe<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,oe,pe,Ne.__webglTexture,ce),t.bindFramebuffer(n.FRAMEBUFFER,null)}function Y(F,P,K){if(n.bindRenderbuffer(n.RENDERBUFFER,F),P.depthBuffer){const oe=P.depthTexture,pe=oe&&oe.isDepthTexture?oe.type:null,ce=w(P.stencilBuffer,pe),Te=P.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;Ye(P)?o.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,de(P),ce,P.width,P.height):K?n.renderbufferStorageMultisample(n.RENDERBUFFER,de(P),ce,P.width,P.height):n.renderbufferStorage(n.RENDERBUFFER,ce,P.width,P.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,Te,n.RENDERBUFFER,F)}else{const oe=P.textures;for(let pe=0;pe<oe.length;pe++){const ce=oe[pe],Te=s.convert(ce.format,ce.colorSpace),be=s.convert(ce.type),Pe=x(ce.internalFormat,Te,be,ce.colorSpace);Ye(P)?o.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,de(P),Pe,P.width,P.height):K?n.renderbufferStorageMultisample(n.RENDERBUFFER,de(P),Pe,P.width,P.height):n.renderbufferStorage(n.RENDERBUFFER,Pe,P.width,P.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function ie(F,P,K){const oe=P.isWebGLCubeRenderTarget===!0;if(t.bindFramebuffer(n.FRAMEBUFFER,F),!(P.depthTexture&&P.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const pe=r.get(P.depthTexture);if(pe.__renderTarget=P,(!pe.__webglTexture||P.depthTexture.image.width!==P.width||P.depthTexture.image.height!==P.height)&&(P.depthTexture.image.width=P.width,P.depthTexture.image.height=P.height,P.depthTexture.needsUpdate=!0),oe){if(pe.__webglInit===void 0&&(pe.__webglInit=!0,P.depthTexture.addEventListener("dispose",E)),pe.__webglTexture===void 0){pe.__webglTexture=n.createTexture(),t.bindTexture(n.TEXTURE_CUBE_MAP,pe.__webglTexture),J(n.TEXTURE_CUBE_MAP,P.depthTexture);const Me=s.convert(P.depthTexture.format),Ne=s.convert(P.depthTexture.type);let ze;P.depthTexture.format===md?ze=n.DEPTH_COMPONENT24:P.depthTexture.format===$m&&(ze=n.DEPTH24_STENCIL8);for(let Ke=0;Ke<6;Ke++)n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,0,ze,P.width,P.height,0,Me,Ne,null)}}else G(P.depthTexture,0);const ce=pe.__webglTexture,Te=de(P),be=oe?n.TEXTURE_CUBE_MAP_POSITIVE_X+K:n.TEXTURE_2D,Pe=P.depthTexture.format===$m?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;if(P.depthTexture.format===md)Ye(P)?o.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Pe,be,ce,0,Te):n.framebufferTexture2D(n.FRAMEBUFFER,Pe,be,ce,0);else if(P.depthTexture.format===$m)Ye(P)?o.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Pe,be,ce,0,Te):n.framebufferTexture2D(n.FRAMEBUFFER,Pe,be,ce,0);else throw new Error("Unknown depthTexture format")}function ve(F){const P=r.get(F),K=F.isWebGLCubeRenderTarget===!0;if(P.__boundDepthTexture!==F.depthTexture){const oe=F.depthTexture;if(P.__depthDisposeCallback&&P.__depthDisposeCallback(),oe){const pe=()=>{delete P.__boundDepthTexture,delete P.__depthDisposeCallback,oe.removeEventListener("dispose",pe)};oe.addEventListener("dispose",pe),P.__depthDisposeCallback=pe}P.__boundDepthTexture=oe}if(F.depthTexture&&!P.__autoAllocateDepthBuffer)if(K)for(let oe=0;oe<6;oe++)ie(P.__webglFramebuffer[oe],F,oe);else{const oe=F.texture.mipmaps;oe&&oe.length>0?ie(P.__webglFramebuffer[0],F,0):ie(P.__webglFramebuffer,F,0)}else if(K){P.__webglDepthbuffer=[];for(let oe=0;oe<6;oe++)if(t.bindFramebuffer(n.FRAMEBUFFER,P.__webglFramebuffer[oe]),P.__webglDepthbuffer[oe]===void 0)P.__webglDepthbuffer[oe]=n.createRenderbuffer(),Y(P.__webglDepthbuffer[oe],F,!1);else{const pe=F.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ce=P.__webglDepthbuffer[oe];n.bindRenderbuffer(n.RENDERBUFFER,ce),n.framebufferRenderbuffer(n.FRAMEBUFFER,pe,n.RENDERBUFFER,ce)}}else{const oe=F.texture.mipmaps;if(oe&&oe.length>0?t.bindFramebuffer(n.FRAMEBUFFER,P.__webglFramebuffer[0]):t.bindFramebuffer(n.FRAMEBUFFER,P.__webglFramebuffer),P.__webglDepthbuffer===void 0)P.__webglDepthbuffer=n.createRenderbuffer(),Y(P.__webglDepthbuffer,F,!1);else{const pe=F.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ce=P.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,ce),n.framebufferRenderbuffer(n.FRAMEBUFFER,pe,n.RENDERBUFFER,ce)}}t.bindFramebuffer(n.FRAMEBUFFER,null)}function ge(F,P,K){const oe=r.get(F);P!==void 0&&te(oe.__webglFramebuffer,F,F.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),K!==void 0&&ve(F)}function _e(F){const P=F.texture,K=r.get(F),oe=r.get(P);F.addEventListener("dispose",A);const pe=F.textures,ce=F.isWebGLCubeRenderTarget===!0,Te=pe.length>1;if(Te||(oe.__webglTexture===void 0&&(oe.__webglTexture=n.createTexture()),oe.__version=P.version,a.memory.textures++),ce){K.__webglFramebuffer=[];for(let be=0;be<6;be++)if(P.mipmaps&&P.mipmaps.length>0){K.__webglFramebuffer[be]=[];for(let Pe=0;Pe<P.mipmaps.length;Pe++)K.__webglFramebuffer[be][Pe]=n.createFramebuffer()}else K.__webglFramebuffer[be]=n.createFramebuffer()}else{if(P.mipmaps&&P.mipmaps.length>0){K.__webglFramebuffer=[];for(let be=0;be<P.mipmaps.length;be++)K.__webglFramebuffer[be]=n.createFramebuffer()}else K.__webglFramebuffer=n.createFramebuffer();if(Te)for(let be=0,Pe=pe.length;be<Pe;be++){const Me=r.get(pe[be]);Me.__webglTexture===void 0&&(Me.__webglTexture=n.createTexture(),a.memory.textures++)}if(F.samples>0&&Ye(F)===!1){K.__webglMultisampledFramebuffer=n.createFramebuffer(),K.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,K.__webglMultisampledFramebuffer);for(let be=0;be<pe.length;be++){const Pe=pe[be];K.__webglColorRenderbuffer[be]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,K.__webglColorRenderbuffer[be]);const Me=s.convert(Pe.format,Pe.colorSpace),Ne=s.convert(Pe.type),ze=x(Pe.internalFormat,Me,Ne,Pe.colorSpace,F.isXRRenderTarget===!0),Ke=de(F);n.renderbufferStorageMultisample(n.RENDERBUFFER,Ke,ze,F.width,F.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+be,n.RENDERBUFFER,K.__webglColorRenderbuffer[be])}n.bindRenderbuffer(n.RENDERBUFFER,null),F.depthBuffer&&(K.__webglDepthRenderbuffer=n.createRenderbuffer(),Y(K.__webglDepthRenderbuffer,F,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(ce){t.bindTexture(n.TEXTURE_CUBE_MAP,oe.__webglTexture),J(n.TEXTURE_CUBE_MAP,P);for(let be=0;be<6;be++)if(P.mipmaps&&P.mipmaps.length>0)for(let Pe=0;Pe<P.mipmaps.length;Pe++)te(K.__webglFramebuffer[be][Pe],F,P,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+be,Pe);else te(K.__webglFramebuffer[be],F,P,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+be,0);y(P)&&v(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Te){for(let be=0,Pe=pe.length;be<Pe;be++){const Me=pe[be],Ne=r.get(Me);let ze=n.TEXTURE_2D;(F.isWebGL3DRenderTarget||F.isWebGLArrayRenderTarget)&&(ze=F.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(ze,Ne.__webglTexture),J(ze,Me),te(K.__webglFramebuffer,F,Me,n.COLOR_ATTACHMENT0+be,ze,0),y(Me)&&v(ze)}t.unbindTexture()}else{let be=n.TEXTURE_2D;if((F.isWebGL3DRenderTarget||F.isWebGLArrayRenderTarget)&&(be=F.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(be,oe.__webglTexture),J(be,P),P.mipmaps&&P.mipmaps.length>0)for(let Pe=0;Pe<P.mipmaps.length;Pe++)te(K.__webglFramebuffer[Pe],F,P,n.COLOR_ATTACHMENT0,be,Pe);else te(K.__webglFramebuffer,F,P,n.COLOR_ATTACHMENT0,be,0);y(P)&&v(be),t.unbindTexture()}F.depthBuffer&&ve(F)}function we(F){const P=F.textures;for(let K=0,oe=P.length;K<oe;K++){const pe=P[K];if(y(pe)){const ce=b(F),Te=r.get(pe).__webglTexture;t.bindTexture(ce,Te),v(ce),t.unbindTexture()}}}const Be=[],$e=[];function nt(F){if(F.samples>0){if(Ye(F)===!1){const P=F.textures,K=F.width,oe=F.height;let pe=n.COLOR_BUFFER_BIT;const ce=F.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Te=r.get(F),be=P.length>1;if(be)for(let Me=0;Me<P.length;Me++)t.bindFramebuffer(n.FRAMEBUFFER,Te.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Me,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Te.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Me,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Te.__webglMultisampledFramebuffer);const Pe=F.texture.mipmaps;Pe&&Pe.length>0?t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Te.__webglFramebuffer[0]):t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Te.__webglFramebuffer);for(let Me=0;Me<P.length;Me++){if(F.resolveDepthBuffer&&(F.depthBuffer&&(pe|=n.DEPTH_BUFFER_BIT),F.stencilBuffer&&F.resolveStencilBuffer&&(pe|=n.STENCIL_BUFFER_BIT)),be){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Te.__webglColorRenderbuffer[Me]);const Ne=r.get(P[Me]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Ne,0)}n.blitFramebuffer(0,0,K,oe,0,0,K,oe,pe,n.NEAREST),l===!0&&(Be.length=0,$e.length=0,Be.push(n.COLOR_ATTACHMENT0+Me),F.depthBuffer&&F.resolveDepthBuffer===!1&&(Be.push(ce),$e.push(ce),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,$e)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,Be))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),be)for(let Me=0;Me<P.length;Me++){t.bindFramebuffer(n.FRAMEBUFFER,Te.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Me,n.RENDERBUFFER,Te.__webglColorRenderbuffer[Me]);const Ne=r.get(P[Me]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Te.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Me,n.TEXTURE_2D,Ne,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Te.__webglMultisampledFramebuffer)}else if(F.depthBuffer&&F.resolveDepthBuffer===!1&&l){const P=F.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[P])}}}function de(F){return Math.min(i.maxSamples,F.samples)}function Ye(F){const P=r.get(F);return F.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&P.__useRenderToTexture!==!1}function Xe(F){const P=a.render.frame;c.get(F)!==P&&(c.set(F,P),F.update())}function ae(F,P){const K=F.colorSpace,oe=F.format,pe=F.type;return F.isCompressedTexture===!0||F.isVideoTexture===!0||K!==yb&&K!==rf&&(In.getTransfer(K)===Wn?(oe!==lu||pe!==Fo)&&$t("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):Bn("WebGLTextures: Unsupported texture color space:",K)),P}function fe(F){return typeof HTMLImageElement<"u"&&F instanceof HTMLImageElement?(u.width=F.naturalWidth||F.width,u.height=F.naturalHeight||F.height):typeof VideoFrame<"u"&&F instanceof VideoFrame?(u.width=F.displayWidth,u.height=F.displayHeight):(u.width=F.width,u.height=F.height),u}this.allocateTextureUnit=R,this.resetTextureUnits=N,this.setTexture2D=G,this.setTexture2DArray=I,this.setTexture3D=B,this.setTextureCube=$,this.rebindTextures=ge,this.setupRenderTarget=_e,this.updateRenderTargetMipmap=we,this.updateMultisampleRenderTarget=nt,this.setupDepthRenderbuffer=ve,this.setupFrameBufferTexture=te,this.useMultisampledRTT=Ye,this.isReversedDepthBuffer=function(){return t.buffers.depth.getReversed()}}function zTe(n,e){function t(r,i=rf){let s;const a=In.getTransfer(i);if(r===Fo)return n.UNSIGNED_BYTE;if(r===P4)return n.UNSIGNED_SHORT_4_4_4_4;if(r===F4)return n.UNSIGNED_SHORT_5_5_5_1;if(r===Lee)return n.UNSIGNED_INT_5_9_9_9_REV;if(r===Oee)return n.UNSIGNED_INT_10F_11F_11F_REV;if(r===Pee)return n.BYTE;if(r===Fee)return n.SHORT;if(r===Tw)return n.UNSIGNED_SHORT;if(r===I4)return n.INT;if(r===Ac)return n.UNSIGNED_INT;if(r===ac)return n.FLOAT;if(r===pd)return n.HALF_FLOAT;if(r===kee)return n.ALPHA;if(r===Bee)return n.RGB;if(r===lu)return n.RGBA;if(r===md)return n.DEPTH_COMPONENT;if(r===$m)return n.DEPTH_STENCIL;if(r===Uee)return n.RED;if(r===L4)return n.RED_INTEGER;if(r===vb)return n.RG;if(r===O4)return n.RG_INTEGER;if(r===k4)return n.RGBA_INTEGER;if(r===lC||r===uC||r===cC||r===hC)if(a===Wn)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(r===lC)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===uC)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===cC)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===hC)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(r===lC)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===uC)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===cC)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===hC)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(r===OL||r===kL||r===BL||r===UL)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(r===OL)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===kL)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===BL)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===UL)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(r===VL||r===zL||r===$L||r===HL||r===GL||r===jL||r===qL)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(r===VL||r===zL)return a===Wn?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(r===$L)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC;if(r===HL)return s.COMPRESSED_R11_EAC;if(r===GL)return s.COMPRESSED_SIGNED_R11_EAC;if(r===jL)return s.COMPRESSED_RG11_EAC;if(r===qL)return s.COMPRESSED_SIGNED_RG11_EAC}else return null;if(r===WL||r===XL||r===KL||r===YL||r===QL||r===ZL||r===JL||r===eO||r===tO||r===nO||r===rO||r===iO||r===sO||r===aO)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(r===WL)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===XL)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===KL)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===YL)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===QL)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===ZL)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===JL)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===eO)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===tO)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===nO)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===rO)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===iO)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===sO)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===aO)return a===Wn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(r===oO||r===lO||r===uO)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(r===oO)return a===Wn?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===lO)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===uO)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(r===cO||r===hO||r===dO||r===fO)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(r===cO)return s.COMPRESSED_RED_RGTC1_EXT;if(r===hO)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===dO)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===fO)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return r===Mw?n.UNSIGNED_INT_24_8:n[r]!==void 0?n[r]:null}return{convert:t}}const $Te=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,HTe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class GTe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const r=new Zee(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,r=new Mc({vertexShader:$Te,fragmentShader:HTe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new qn(new TN(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class jTe extends Gb{constructor(e,t){super();const r=this;let i=null,s=1,a=null,o="local-floor",l=1,u=null,c=null,h=null,d=null,f=null,p=null;const m=typeof XRWebGLBinding<"u",y=new GTe,v={},b=t.getContextAttributes();let x=null,w=null;const _=[],E=[],A=new Cn;let T=null;const S=new Ro;S.viewport=new ei;const M=new Ro;M.viewport=new ei;const D=[S,M],N=new ewe;let R=null,O=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(le){let ue=_[le];return ue===void 0&&(ue=new BI,_[le]=ue),ue.getTargetRaySpace()},this.getControllerGrip=function(le){let ue=_[le];return ue===void 0&&(ue=new BI,_[le]=ue),ue.getGripSpace()},this.getHand=function(le){let ue=_[le];return ue===void 0&&(ue=new BI,_[le]=ue),ue.getHandSpace()};function G(le){const ue=E.indexOf(le.inputSource);if(ue===-1)return;const te=_[ue];te!==void 0&&(te.update(le.inputSource,le.frame,u||a),te.dispatchEvent({type:le.type,data:le.inputSource}))}function I(){i.removeEventListener("select",G),i.removeEventListener("selectstart",G),i.removeEventListener("selectend",G),i.removeEventListener("squeeze",G),i.removeEventListener("squeezestart",G),i.removeEventListener("squeezeend",G),i.removeEventListener("end",I),i.removeEventListener("inputsourceschange",B);for(let le=0;le<_.length;le++){const ue=E[le];ue!==null&&(E[le]=null,_[le].disconnect(ue))}R=null,O=null,y.reset();for(const le in v)delete v[le];e.setRenderTarget(x),f=null,d=null,h=null,i=null,w=null,Z.stop(),r.isPresenting=!1,e.setPixelRatio(T),e.setSize(A.width,A.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(le){s=le,r.isPresenting===!0&&$t("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(le){o=le,r.isPresenting===!0&&$t("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||a},this.setReferenceSpace=function(le){u=le},this.getBaseLayer=function(){return d!==null?d:f},this.getBinding=function(){return h===null&&m&&(h=new XRWebGLBinding(i,t)),h},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(le){if(i=le,i!==null){if(x=e.getRenderTarget(),i.addEventListener("select",G),i.addEventListener("selectstart",G),i.addEventListener("selectend",G),i.addEventListener("squeeze",G),i.addEventListener("squeezestart",G),i.addEventListener("squeezeend",G),i.addEventListener("end",I),i.addEventListener("inputsourceschange",B),b.xrCompatible!==!0&&await t.makeXRCompatible(),T=e.getPixelRatio(),e.getSize(A),m&&"createProjectionLayer"in XRWebGLBinding.prototype){let te=null,Y=null,ie=null;b.depth&&(ie=b.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,te=b.stencil?$m:md,Y=b.stencil?Mw:Ac);const ve={colorFormat:t.RGBA8,depthFormat:ie,scaleFactor:s};h=this.getBinding(),d=h.createProjectionLayer(ve),i.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),w=new _c(d.textureWidth,d.textureHeight,{format:lu,type:Fo,depthTexture:new Dw(d.textureWidth,d.textureHeight,Y,void 0,void 0,void 0,void 0,void 0,void 0,te),stencilBuffer:b.stencil,colorSpace:e.outputColorSpace,samples:b.antialias?4:0,resolveDepthBuffer:d.ignoreDepthValues===!1,resolveStencilBuffer:d.ignoreDepthValues===!1})}else{const te={antialias:b.antialias,alpha:!0,depth:b.depth,stencil:b.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(i,t,te),i.updateRenderState({baseLayer:f}),e.setPixelRatio(1),e.setSize(f.framebufferWidth,f.framebufferHeight,!1),w=new _c(f.framebufferWidth,f.framebufferHeight,{format:lu,type:Fo,colorSpace:e.outputColorSpace,stencilBuffer:b.stencil,resolveDepthBuffer:f.ignoreDepthValues===!1,resolveStencilBuffer:f.ignoreDepthValues===!1})}w.isXRRenderTarget=!0,this.setFoveation(l),u=null,a=await i.requestReferenceSpace(o),Z.setContext(i),Z.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return y.getDepthTexture()};function B(le){for(let ue=0;ue<le.removed.length;ue++){const te=le.removed[ue],Y=E.indexOf(te);Y>=0&&(E[Y]=null,_[Y].disconnect(te))}for(let ue=0;ue<le.added.length;ue++){const te=le.added[ue];let Y=E.indexOf(te);if(Y===-1){for(let ve=0;ve<_.length;ve++)if(ve>=E.length){E.push(te),Y=ve;break}else if(E[ve]===null){E[ve]=te,Y=ve;break}if(Y===-1)break}const ie=_[Y];ie&&ie.connect(te)}}const $=new Ae,H=new Ae;function Q(le,ue,te){$.setFromMatrixPosition(ue.matrixWorld),H.setFromMatrixPosition(te.matrixWorld);const Y=$.distanceTo(H),ie=ue.projectionMatrix.elements,ve=te.projectionMatrix.elements,ge=ie[14]/(ie[10]-1),_e=ie[14]/(ie[10]+1),we=(ie[9]+1)/ie[5],Be=(ie[9]-1)/ie[5],$e=(ie[8]-1)/ie[0],nt=(ve[8]+1)/ve[0],de=ge*$e,Ye=ge*nt,Xe=Y/(-$e+nt),ae=Xe*-$e;if(ue.matrixWorld.decompose(le.position,le.quaternion,le.scale),le.translateX(ae),le.translateZ(Xe),le.matrixWorld.compose(le.position,le.quaternion,le.scale),le.matrixWorldInverse.copy(le.matrixWorld).invert(),ie[10]===-1)le.projectionMatrix.copy(ue.projectionMatrix),le.projectionMatrixInverse.copy(ue.projectionMatrixInverse);else{const fe=ge+Xe,F=_e+Xe,P=de-ae,K=Ye+(Y-ae),oe=we*_e/F*fe,pe=Be*_e/F*fe;le.projectionMatrix.makePerspective(P,K,oe,pe,fe,F),le.projectionMatrixInverse.copy(le.projectionMatrix).invert()}}function ee(le,ue){ue===null?le.matrixWorld.copy(le.matrix):le.matrixWorld.multiplyMatrices(ue.matrixWorld,le.matrix),le.matrixWorldInverse.copy(le.matrixWorld).invert()}this.updateCamera=function(le){if(i===null)return;let ue=le.near,te=le.far;y.texture!==null&&(y.depthNear>0&&(ue=y.depthNear),y.depthFar>0&&(te=y.depthFar)),N.near=M.near=S.near=ue,N.far=M.far=S.far=te,(R!==N.near||O!==N.far)&&(i.updateRenderState({depthNear:N.near,depthFar:N.far}),R=N.near,O=N.far),N.layers.mask=le.layers.mask|6,S.layers.mask=N.layers.mask&3,M.layers.mask=N.layers.mask&5;const Y=le.parent,ie=N.cameras;ee(N,Y);for(let ve=0;ve<ie.length;ve++)ee(ie[ve],Y);ie.length===2?Q(N,S,M):N.projectionMatrix.copy(S.projectionMatrix),J(le,N,Y)};function J(le,ue,te){te===null?le.matrix.copy(ue.matrixWorld):(le.matrix.copy(te.matrixWorld),le.matrix.invert(),le.matrix.multiply(ue.matrixWorld)),le.matrix.decompose(le.position,le.quaternion,le.scale),le.updateMatrixWorld(!0),le.projectionMatrix.copy(ue.projectionMatrix),le.projectionMatrixInverse.copy(ue.projectionMatrixInverse),le.isPerspectiveCamera&&(le.fov=pO*2*Math.atan(1/le.projectionMatrix.elements[5]),le.zoom=1)}this.getCamera=function(){return N},this.getFoveation=function(){if(!(d===null&&f===null))return l},this.setFoveation=function(le){l=le,d!==null&&(d.fixedFoveation=le),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=le)},this.hasDepthSensing=function(){return y.texture!==null},this.getDepthSensingMesh=function(){return y.getMesh(N)},this.getCameraTexture=function(le){return v[le]};let L=null;function se(le,ue){if(c=ue.getViewerPose(u||a),p=ue,c!==null){const te=c.views;f!==null&&(e.setRenderTargetFramebuffer(w,f.framebuffer),e.setRenderTarget(w));let Y=!1;te.length!==N.cameras.length&&(N.cameras.length=0,Y=!0);for(let _e=0;_e<te.length;_e++){const we=te[_e];let Be=null;if(f!==null)Be=f.getViewport(we);else{const nt=h.getViewSubImage(d,we);Be=nt.viewport,_e===0&&(e.setRenderTargetTextures(w,nt.colorTexture,nt.depthStencilTexture),e.setRenderTarget(w))}let $e=D[_e];$e===void 0&&($e=new Ro,$e.layers.enable(_e),$e.viewport=new ei,D[_e]=$e),$e.matrix.fromArray(we.transform.matrix),$e.matrix.decompose($e.position,$e.quaternion,$e.scale),$e.projectionMatrix.fromArray(we.projectionMatrix),$e.projectionMatrixInverse.copy($e.projectionMatrix).invert(),$e.viewport.set(Be.x,Be.y,Be.width,Be.height),_e===0&&(N.matrix.copy($e.matrix),N.matrix.decompose(N.position,N.quaternion,N.scale)),Y===!0&&N.cameras.push($e)}const ie=i.enabledFeatures;if(ie&&ie.includes("depth-sensing")&&i.depthUsage=="gpu-optimized"&&m){h=r.getBinding();const _e=h.getDepthInformation(te[0]);_e&&_e.isValid&&_e.texture&&y.init(_e,i.renderState)}if(ie&&ie.includes("camera-access")&&m){e.state.unbindTexture(),h=r.getBinding();for(let _e=0;_e<te.length;_e++){const we=te[_e].camera;if(we){let Be=v[we];Be||(Be=new Zee,v[we]=Be);const $e=h.getCameraImage(we);Be.sourceTexture=$e}}}}for(let te=0;te<_.length;te++){const Y=E[te],ie=_[te];Y!==null&&ie!==void 0&&ie.update(Y,ue,u||a)}L&&L(le,ue),ue.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:ue}),p=null}const Z=new tte;Z.setAnimationLoop(se),this.setAnimationLoop=function(le){L=le},this.dispose=function(){}}}const xm=new Tc,qTe=new Ir;function WTe(n,e){function t(y,v){y.matrixAutoUpdate===!0&&y.updateMatrix(),v.value.copy(y.matrix)}function r(y,v){v.color.getRGB(y.fogColor.value,Wee(n)),v.isFog?(y.fogNear.value=v.near,y.fogFar.value=v.far):v.isFogExp2&&(y.fogDensity.value=v.density)}function i(y,v,b,x,w){v.isMeshBasicMaterial||v.isMeshLambertMaterial?s(y,v):v.isMeshToonMaterial?(s(y,v),h(y,v)):v.isMeshPhongMaterial?(s(y,v),c(y,v)):v.isMeshStandardMaterial?(s(y,v),d(y,v),v.isMeshPhysicalMaterial&&f(y,v,w)):v.isMeshMatcapMaterial?(s(y,v),p(y,v)):v.isMeshDepthMaterial?s(y,v):v.isMeshDistanceMaterial?(s(y,v),m(y,v)):v.isMeshNormalMaterial?s(y,v):v.isLineBasicMaterial?(a(y,v),v.isLineDashedMaterial&&o(y,v)):v.isPointsMaterial?l(y,v,b,x):v.isSpriteMaterial?u(y,v):v.isShadowMaterial?(y.color.value.copy(v.color),y.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function s(y,v){y.opacity.value=v.opacity,v.color&&y.diffuse.value.copy(v.color),v.emissive&&y.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(y.map.value=v.map,t(v.map,y.mapTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,t(v.alphaMap,y.alphaMapTransform)),v.bumpMap&&(y.bumpMap.value=v.bumpMap,t(v.bumpMap,y.bumpMapTransform),y.bumpScale.value=v.bumpScale,v.side===eo&&(y.bumpScale.value*=-1)),v.normalMap&&(y.normalMap.value=v.normalMap,t(v.normalMap,y.normalMapTransform),y.normalScale.value.copy(v.normalScale),v.side===eo&&y.normalScale.value.negate()),v.displacementMap&&(y.displacementMap.value=v.displacementMap,t(v.displacementMap,y.displacementMapTransform),y.displacementScale.value=v.displacementScale,y.displacementBias.value=v.displacementBias),v.emissiveMap&&(y.emissiveMap.value=v.emissiveMap,t(v.emissiveMap,y.emissiveMapTransform)),v.specularMap&&(y.specularMap.value=v.specularMap,t(v.specularMap,y.specularMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest);const b=e.get(v),x=b.envMap,w=b.envMapRotation;x&&(y.envMap.value=x,xm.copy(w),xm.x*=-1,xm.y*=-1,xm.z*=-1,x.isCubeTexture&&x.isRenderTargetTexture===!1&&(xm.y*=-1,xm.z*=-1),y.envMapRotation.value.setFromMatrix4(qTe.makeRotationFromEuler(xm)),y.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=v.reflectivity,y.ior.value=v.ior,y.refractionRatio.value=v.refractionRatio),v.lightMap&&(y.lightMap.value=v.lightMap,y.lightMapIntensity.value=v.lightMapIntensity,t(v.lightMap,y.lightMapTransform)),v.aoMap&&(y.aoMap.value=v.aoMap,y.aoMapIntensity.value=v.aoMapIntensity,t(v.aoMap,y.aoMapTransform))}function a(y,v){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,v.map&&(y.map.value=v.map,t(v.map,y.mapTransform))}function o(y,v){y.dashSize.value=v.dashSize,y.totalSize.value=v.dashSize+v.gapSize,y.scale.value=v.scale}function l(y,v,b,x){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,y.size.value=v.size*b,y.scale.value=x*.5,v.map&&(y.map.value=v.map,t(v.map,y.uvTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,t(v.alphaMap,y.alphaMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest)}function u(y,v){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,y.rotation.value=v.rotation,v.map&&(y.map.value=v.map,t(v.map,y.mapTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,t(v.alphaMap,y.alphaMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest)}function c(y,v){y.specular.value.copy(v.specular),y.shininess.value=Math.max(v.shininess,1e-4)}function h(y,v){v.gradientMap&&(y.gradientMap.value=v.gradientMap)}function d(y,v){y.metalness.value=v.metalness,v.metalnessMap&&(y.metalnessMap.value=v.metalnessMap,t(v.metalnessMap,y.metalnessMapTransform)),y.roughness.value=v.roughness,v.roughnessMap&&(y.roughnessMap.value=v.roughnessMap,t(v.roughnessMap,y.roughnessMapTransform)),v.envMap&&(y.envMapIntensity.value=v.envMapIntensity)}function f(y,v,b){y.ior.value=v.ior,v.sheen>0&&(y.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),y.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(y.sheenColorMap.value=v.sheenColorMap,t(v.sheenColorMap,y.sheenColorMapTransform)),v.sheenRoughnessMap&&(y.sheenRoughnessMap.value=v.sheenRoughnessMap,t(v.sheenRoughnessMap,y.sheenRoughnessMapTransform))),v.clearcoat>0&&(y.clearcoat.value=v.clearcoat,y.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(y.clearcoatMap.value=v.clearcoatMap,t(v.clearcoatMap,y.clearcoatMapTransform)),v.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap,t(v.clearcoatRoughnessMap,y.clearcoatRoughnessMapTransform)),v.clearcoatNormalMap&&(y.clearcoatNormalMap.value=v.clearcoatNormalMap,t(v.clearcoatNormalMap,y.clearcoatNormalMapTransform),y.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),v.side===eo&&y.clearcoatNormalScale.value.negate())),v.dispersion>0&&(y.dispersion.value=v.dispersion),v.iridescence>0&&(y.iridescence.value=v.iridescence,y.iridescenceIOR.value=v.iridescenceIOR,y.iridescenceThicknessMinimum.value=v.iridescenceThicknessRange[0],y.iridescenceThicknessMaximum.value=v.iridescenceThicknessRange[1],v.iridescenceMap&&(y.iridescenceMap.value=v.iridescenceMap,t(v.iridescenceMap,y.iridescenceMapTransform)),v.iridescenceThicknessMap&&(y.iridescenceThicknessMap.value=v.iridescenceThicknessMap,t(v.iridescenceThicknessMap,y.iridescenceThicknessMapTransform))),v.transmission>0&&(y.transmission.value=v.transmission,y.transmissionSamplerMap.value=b.texture,y.transmissionSamplerSize.value.set(b.width,b.height),v.transmissionMap&&(y.transmissionMap.value=v.transmissionMap,t(v.transmissionMap,y.transmissionMapTransform)),y.thickness.value=v.thickness,v.thicknessMap&&(y.thicknessMap.value=v.thicknessMap,t(v.thicknessMap,y.thicknessMapTransform)),y.attenuationDistance.value=v.attenuationDistance,y.attenuationColor.value.copy(v.attenuationColor)),v.anisotropy>0&&(y.anisotropyVector.value.set(v.anisotropy*Math.cos(v.anisotropyRotation),v.anisotropy*Math.sin(v.anisotropyRotation)),v.anisotropyMap&&(y.anisotropyMap.value=v.anisotropyMap,t(v.anisotropyMap,y.anisotropyMapTransform))),y.specularIntensity.value=v.specularIntensity,y.specularColor.value.copy(v.specularColor),v.specularColorMap&&(y.specularColorMap.value=v.specularColorMap,t(v.specularColorMap,y.specularColorMapTransform)),v.specularIntensityMap&&(y.specularIntensityMap.value=v.specularIntensityMap,t(v.specularIntensityMap,y.specularIntensityMapTransform))}function p(y,v){v.matcap&&(y.matcap.value=v.matcap)}function m(y,v){const b=e.get(v).light;y.referencePosition.value.setFromMatrixPosition(b.matrixWorld),y.nearDistance.value=b.shadow.camera.near,y.farDistance.value=b.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function XTe(n,e,t,r){let i={},s={},a=[];const o=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function l(b,x){const w=x.program;r.uniformBlockBinding(b,w)}function u(b,x){let w=i[b.id];w===void 0&&(p(b),w=c(b),i[b.id]=w,b.addEventListener("dispose",y));const _=x.program;r.updateUBOMapping(b,_);const E=e.render.frame;s[b.id]!==E&&(d(b),s[b.id]=E)}function c(b){const x=h();b.__bindingPointIndex=x;const w=n.createBuffer(),_=b.__size,E=b.usage;return n.bindBuffer(n.UNIFORM_BUFFER,w),n.bufferData(n.UNIFORM_BUFFER,_,E),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,x,w),w}function h(){for(let b=0;b<o;b++)if(a.indexOf(b)===-1)return a.push(b),b;return Bn("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(b){const x=i[b.id],w=b.uniforms,_=b.__cache;n.bindBuffer(n.UNIFORM_BUFFER,x);for(let E=0,A=w.length;E<A;E++){const T=Array.isArray(w[E])?w[E]:[w[E]];for(let S=0,M=T.length;S<M;S++){const D=T[S];if(f(D,E,S,_)===!0){const N=D.__offset,R=Array.isArray(D.value)?D.value:[D.value];let O=0;for(let G=0;G<R.length;G++){const I=R[G],B=m(I);typeof I=="number"||typeof I=="boolean"?(D.__data[0]=I,n.bufferSubData(n.UNIFORM_BUFFER,N+O,D.__data)):I.isMatrix3?(D.__data[0]=I.elements[0],D.__data[1]=I.elements[1],D.__data[2]=I.elements[2],D.__data[3]=0,D.__data[4]=I.elements[3],D.__data[5]=I.elements[4],D.__data[6]=I.elements[5],D.__data[7]=0,D.__data[8]=I.elements[6],D.__data[9]=I.elements[7],D.__data[10]=I.elements[8],D.__data[11]=0):(I.toArray(D.__data,O),O+=B.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,N,D.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function f(b,x,w,_){const E=b.value,A=x+"_"+w;if(_[A]===void 0)return typeof E=="number"||typeof E=="boolean"?_[A]=E:_[A]=E.clone(),!0;{const T=_[A];if(typeof E=="number"||typeof E=="boolean"){if(T!==E)return _[A]=E,!0}else if(T.equals(E)===!1)return T.copy(E),!0}return!1}function p(b){const x=b.uniforms;let w=0;const _=16;for(let A=0,T=x.length;A<T;A++){const S=Array.isArray(x[A])?x[A]:[x[A]];for(let M=0,D=S.length;M<D;M++){const N=S[M],R=Array.isArray(N.value)?N.value:[N.value];for(let O=0,G=R.length;O<G;O++){const I=R[O],B=m(I),$=w%_,H=$%B.boundary,Q=$+H;w+=H,Q!==0&&_-Q<B.storage&&(w+=_-Q),N.__data=new Float32Array(B.storage/Float32Array.BYTES_PER_ELEMENT),N.__offset=w,w+=B.storage}}}const E=w%_;return E>0&&(w+=_-E),b.__size=w,b.__cache={},this}function m(b){const x={boundary:0,storage:0};return typeof b=="number"||typeof b=="boolean"?(x.boundary=4,x.storage=4):b.isVector2?(x.boundary=8,x.storage=8):b.isVector3||b.isColor?(x.boundary=16,x.storage=12):b.isVector4?(x.boundary=16,x.storage=16):b.isMatrix3?(x.boundary=48,x.storage=48):b.isMatrix4?(x.boundary=64,x.storage=64):b.isTexture?$t("WebGLRenderer: Texture samplers can not be part of an uniforms group."):$t("WebGLRenderer: Unsupported uniform value type.",b),x}function y(b){const x=b.target;x.removeEventListener("dispose",y);const w=a.indexOf(x.__bindingPointIndex);a.splice(w,1),n.deleteBuffer(i[x.id]),delete i[x.id],delete s[x.id]}function v(){for(const b in i)n.deleteBuffer(i[b]);a=[],i={},s={}}return{bind:l,update:u,dispose:v}}const KTe=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let Ru=null;function YTe(){return Ru===null&&(Ru=new H1e(KTe,16,16,vb,pd),Ru.name="DFG_LUT",Ru.minFilter=Zs,Ru.magFilter=Zs,Ru.wrapS=$h,Ru.wrapT=$h,Ru.generateMipmaps=!1,Ru.needsUpdate=!0),Ru}class QTe{constructor(e={}){const{canvas:t=v1e(),context:r=null,depth:i=!0,stencil:s=!1,alpha:a=!1,antialias:o=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:h=!1,reversedDepthBuffer:d=!1,outputBufferType:f=Fo}=e;this.isWebGLRenderer=!0;let p;if(r!==null){if(typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");p=r.getContextAttributes().alpha}else p=a;const m=f,y=new Set([k4,O4,L4]),v=new Set([Fo,Ac,Tw,Mw,P4,F4]),b=new Uint32Array(4),x=new Int32Array(4);let w=null,_=null;const E=[],A=[];let T=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=bc,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const S=this;let M=!1;this._outputColorSpace=dl;let D=0,N=0,R=null,O=-1,G=null;const I=new ei,B=new ei;let $=null;const H=new Ft(0);let Q=0,ee=t.width,J=t.height,L=1,se=null,Z=null;const le=new ei(0,0,ee,J),ue=new ei(0,0,ee,J);let te=!1;const Y=new $4;let ie=!1,ve=!1;const ge=new Ir,_e=new Ae,we=new ei,Be={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let $e=!1;function nt(){return R===null?L:1}let de=r;function Ye(ne,Se){return t.getContext(ne,Se)}try{const ne={alpha:!0,depth:i,stencil:s,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${N4}`),t.addEventListener("webglcontextlost",Pt,!1),t.addEventListener("webglcontextrestored",Vn,!1),t.addEventListener("webglcontextcreationerror",dn,!1),de===null){const Se="webgl2";if(de=Ye(Se,ne),de===null)throw Ye(Se)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(ne){throw Bn("WebGLRenderer: "+ne.message),ne}let Xe,ae,fe,F,P,K,oe,pe,ce,Te,be,Pe,Me,Ne,ze,Ke,Ge,qe,z,W,ye,Ee,Fe,Le;function Ue(){Xe=new YSe(de),Xe.init(),Ee=new zTe(de,Xe),ae=new zSe(de,Xe,e,Ee),fe=new UTe(de,Xe),ae.reversedDepthBuffer&&d&&fe.buffers.depth.setReversed(!0),F=new JSe(de),P=new STe,K=new VTe(de,Xe,fe,P,ae,Ee,F),oe=new HSe(S),pe=new KSe(S),ce=new rwe(de),Fe=new USe(de,ce),Te=new QSe(de,ce,F,Fe),be=new tAe(de,Te,ce,F),z=new eAe(de,ae,K),Ke=new $Se(P),Pe=new ETe(S,oe,pe,Xe,ae,Fe,Ke),Me=new WTe(S,P),Ne=new TTe,ze=new ITe(Xe),qe=new BSe(S,oe,pe,fe,be,p,l),Ge=new kTe(S,be,ae),Le=new XTe(de,F,ae,fe),W=new VSe(de,Xe,F),ye=new ZSe(de,Xe,F),F.programs=Pe.programs,S.capabilities=ae,S.extensions=Xe,S.properties=P,S.renderLists=Ne,S.shadowMap=Ge,S.state=fe,S.info=F}Ue(),m!==Fo&&(T=new rAe(m,t.width,t.height,i,s));const tt=new jTe(S,de);this.xr=tt,this.getContext=function(){return de},this.getContextAttributes=function(){return de.getContextAttributes()},this.forceContextLoss=function(){const ne=Xe.get("WEBGL_lose_context");ne&&ne.loseContext()},this.forceContextRestore=function(){const ne=Xe.get("WEBGL_lose_context");ne&&ne.restoreContext()},this.getPixelRatio=function(){return L},this.setPixelRatio=function(ne){ne!==void 0&&(L=ne,this.setSize(ee,J,!1))},this.getSize=function(ne){return ne.set(ee,J)},this.setSize=function(ne,Se,Ie=!0){if(tt.isPresenting){$t("WebGLRenderer: Can't change size while VR device is presenting.");return}ee=ne,J=Se,t.width=Math.floor(ne*L),t.height=Math.floor(Se*L),Ie===!0&&(t.style.width=ne+"px",t.style.height=Se+"px"),T!==null&&T.setSize(t.width,t.height),this.setViewport(0,0,ne,Se)},this.getDrawingBufferSize=function(ne){return ne.set(ee*L,J*L).floor()},this.setDrawingBufferSize=function(ne,Se,Ie){ee=ne,J=Se,L=Ie,t.width=Math.floor(ne*Ie),t.height=Math.floor(Se*Ie),this.setViewport(0,0,ne,Se)},this.setEffects=function(ne){if(m===Fo){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(ne){for(let Se=0;Se<ne.length;Se++)if(ne[Se].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}T.setEffects(ne||[])},this.getCurrentViewport=function(ne){return ne.copy(I)},this.getViewport=function(ne){return ne.copy(le)},this.setViewport=function(ne,Se,Ie,Re){ne.isVector4?le.set(ne.x,ne.y,ne.z,ne.w):le.set(ne,Se,Ie,Re),fe.viewport(I.copy(le).multiplyScalar(L).round())},this.getScissor=function(ne){return ne.copy(ue)},this.setScissor=function(ne,Se,Ie,Re){ne.isVector4?ue.set(ne.x,ne.y,ne.z,ne.w):ue.set(ne,Se,Ie,Re),fe.scissor(B.copy(ue).multiplyScalar(L).round())},this.getScissorTest=function(){return te},this.setScissorTest=function(ne){fe.setScissorTest(te=ne)},this.setOpaqueSort=function(ne){se=ne},this.setTransparentSort=function(ne){Z=ne},this.getClearColor=function(ne){return ne.copy(qe.getClearColor())},this.setClearColor=function(){qe.setClearColor(...arguments)},this.getClearAlpha=function(){return qe.getClearAlpha()},this.setClearAlpha=function(){qe.setClearAlpha(...arguments)},this.clear=function(ne=!0,Se=!0,Ie=!0){let Re=0;if(ne){let Ce=!1;if(R!==null){const it=R.texture.format;Ce=y.has(it)}if(Ce){const it=R.texture.type,ht=v.has(it),at=qe.getClearColor(),mt=qe.getClearAlpha(),wt=at.r,At=at.g,xt=at.b;ht?(b[0]=wt,b[1]=At,b[2]=xt,b[3]=mt,de.clearBufferuiv(de.COLOR,0,b)):(x[0]=wt,x[1]=At,x[2]=xt,x[3]=mt,de.clearBufferiv(de.COLOR,0,x))}else Re|=de.COLOR_BUFFER_BIT}Se&&(Re|=de.DEPTH_BUFFER_BIT),Ie&&(Re|=de.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),de.clear(Re)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Pt,!1),t.removeEventListener("webglcontextrestored",Vn,!1),t.removeEventListener("webglcontextcreationerror",dn,!1),qe.dispose(),Ne.dispose(),ze.dispose(),P.dispose(),oe.dispose(),pe.dispose(),be.dispose(),Fe.dispose(),Le.dispose(),Pe.dispose(),tt.dispose(),tt.removeEventListener("sessionstart",Eu),tt.removeEventListener("sessionend",Qv),Hi.stop()};function Pt(ne){ne.preventDefault(),r9("WebGLRenderer: Context Lost."),M=!0}function Vn(){r9("WebGLRenderer: Context Restored."),M=!1;const ne=F.autoReset,Se=Ge.enabled,Ie=Ge.autoUpdate,Re=Ge.needsUpdate,Ce=Ge.type;Ue(),F.autoReset=ne,Ge.enabled=Se,Ge.autoUpdate=Ie,Ge.needsUpdate=Re,Ge.type=Ce}function dn(ne){Bn("WebGLRenderer: A WebGL context could not be created. Reason: ",ne.statusMessage)}function Ia(ne){const Se=ne.target;Se.removeEventListener("dispose",Ia),ro(Se)}function ro(ne){Sd(ne),P.remove(ne)}function Sd(ne){const Se=P.get(ne).programs;Se!==void 0&&(Se.forEach(function(Ie){Pe.releaseProgram(Ie)}),ne.isShaderMaterial&&Pe.releaseShaderCache(ne))}this.renderBufferDirect=function(ne,Se,Ie,Re,Ce,it){Se===null&&(Se=Be);const ht=Ce.isMesh&&Ce.matrixWorld.determinant()<0,at=Dd(ne,Se,Ie,Re,Ce);fe.setMaterial(Re,ht);let mt=Ie.index,wt=1;if(Re.wireframe===!0){if(mt=Te.getWireframeAttribute(Ie),mt===void 0)return;wt=2}const At=Ie.drawRange,xt=Ie.attributes.position;let Wt=At.start*wt,Dn=(At.start+At.count)*wt;it!==null&&(Wt=Math.max(Wt,it.start*wt),Dn=Math.min(Dn,(it.start+it.count)*wt)),mt!==null?(Wt=Math.max(Wt,0),Dn=Math.min(Dn,mt.count)):xt!=null&&(Wt=Math.max(Wt,0),Dn=Math.min(Dn,xt.count));const mr=Dn-Wt;if(mr<0||mr===1/0)return;Fe.setup(Ce,Re,at,Ie,mt);let kt,kn=W;if(mt!==null&&(kt=ce.get(mt),kn=ye,kn.setIndex(kt)),Ce.isMesh)Re.wireframe===!0?(fe.setLineWidth(Re.wireframeLinewidth*nt()),kn.setMode(de.LINES)):kn.setMode(de.TRIANGLES);else if(Ce.isLine){let St=Re.linewidth;St===void 0&&(St=1),fe.setLineWidth(St*nt()),Ce.isLineSegments?kn.setMode(de.LINES):Ce.isLineLoop?kn.setMode(de.LINE_LOOP):kn.setMode(de.LINE_STRIP)}else Ce.isPoints?kn.setMode(de.POINTS):Ce.isSprite&&kn.setMode(de.TRIANGLES);if(Ce.isBatchedMesh)if(Ce._multiDrawInstances!==null)Cw("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),kn.renderMultiDrawInstances(Ce._multiDrawStarts,Ce._multiDrawCounts,Ce._multiDrawCount,Ce._multiDrawInstances);else if(Xe.get("WEBGL_multi_draw"))kn.renderMultiDraw(Ce._multiDrawStarts,Ce._multiDrawCounts,Ce._multiDrawCount);else{const St=Ce._multiDrawStarts,_n=Ce._multiDrawCounts,Nn=Ce._multiDrawCount,Ps=mt?ce.get(mt).bytesPerElement:1,Nd=P.get(Re).currentProgram.getUniforms();for(let ua=0;ua<Nn;ua++)Nd.setValue(de,"_gl_DrawID",ua),kn.render(St[ua]/Ps,_n[ua])}else if(Ce.isInstancedMesh)kn.renderInstances(Wt,mr,Ce.count);else if(Ie.isInstancedBufferGeometry){const St=Ie._maxInstanceCount!==void 0?Ie._maxInstanceCount:1/0,_n=Math.min(Ie.instanceCount,St);kn.renderInstances(Wt,mr,_n)}else kn.render(Wt,mr)};function im(ne,Se,Ie){ne.transparent===!0&&ne.side===kh&&ne.forceSinglePass===!1?(ne.side=eo,ne.needsUpdate=!0,Cd(ne,Se,Ie),ne.side=Ip,ne.needsUpdate=!0,Cd(ne,Se,Ie),ne.side=kh):Cd(ne,Se,Ie)}this.compile=function(ne,Se,Ie=null){Ie===null&&(Ie=ne),_=ze.get(Ie),_.init(Se),A.push(_),Ie.traverseVisible(function(Ce){Ce.isLight&&Ce.layers.test(Se.layers)&&(_.pushLight(Ce),Ce.castShadow&&_.pushShadow(Ce))}),ne!==Ie&&ne.traverseVisible(function(Ce){Ce.isLight&&Ce.layers.test(Se.layers)&&(_.pushLight(Ce),Ce.castShadow&&_.pushShadow(Ce))}),_.setupLights();const Re=new Set;return ne.traverse(function(Ce){if(!(Ce.isMesh||Ce.isPoints||Ce.isLine||Ce.isSprite))return;const it=Ce.material;if(it)if(Array.isArray(it))for(let ht=0;ht<it.length;ht++){const at=it[ht];im(at,Ie,Ce),Re.add(at)}else im(it,Ie,Ce),Re.add(it)}),_=A.pop(),Re},this.compileAsync=function(ne,Se,Ie=null){const Re=this.compile(ne,Se,Ie);return new Promise(Ce=>{function it(){if(Re.forEach(function(ht){P.get(ht).currentProgram.isReady()&&Re.delete(ht)}),Re.size===0){Ce(ne);return}setTimeout(it,10)}Xe.get("KHR_parallel_shader_compile")!==null?it():setTimeout(it,10)})};let Ad=null;function sm(ne){Ad&&Ad(ne)}function Eu(){Hi.stop()}function Qv(){Hi.start()}const Hi=new tte;Hi.setAnimationLoop(sm),typeof self<"u"&&Hi.setContext(self),this.setAnimationLoop=function(ne){Ad=ne,tt.setAnimationLoop(ne),ne===null?Hi.stop():Hi.start()},tt.addEventListener("sessionstart",Eu),tt.addEventListener("sessionend",Qv),this.render=function(ne,Se){if(Se!==void 0&&Se.isCamera!==!0){Bn("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(M===!0)return;const Ie=tt.enabled===!0&&tt.isPresenting===!0,Re=T!==null&&(R===null||Ie)&&T.begin(S,R);if(ne.matrixWorldAutoUpdate===!0&&ne.updateMatrixWorld(),Se.parent===null&&Se.matrixWorldAutoUpdate===!0&&Se.updateMatrixWorld(),tt.enabled===!0&&tt.isPresenting===!0&&(T===null||T.isCompositing()===!1)&&(tt.cameraAutoUpdate===!0&&tt.updateCamera(Se),Se=tt.getCamera()),ne.isScene===!0&&ne.onBeforeRender(S,ne,Se,R),_=ze.get(ne,A.length),_.init(Se),A.push(_),ge.multiplyMatrices(Se.projectionMatrix,Se.matrixWorldInverse),Y.setFromProjectionMatrix(ge,oc,Se.reversedDepth),ve=this.localClippingEnabled,ie=Ke.init(this.clippingPlanes,ve),w=Ne.get(ne,E.length),w.init(),E.push(w),tt.enabled===!0&&tt.isPresenting===!0){const ht=S.xr.getDepthSensingMesh();ht!==null&&Td(ht,Se,-1/0,S.sortObjects)}Td(ne,Se,0,S.sortObjects),w.finish(),S.sortObjects===!0&&w.sort(se,Z),$e=tt.enabled===!1||tt.isPresenting===!1||tt.hasDepthSensing()===!1,$e&&qe.addToRenderList(w,ne),this.info.render.frame++,ie===!0&&Ke.beginShadows();const Ce=_.state.shadowsArray;if(Ge.render(Ce,ne,Se),ie===!0&&Ke.endShadows(),this.info.autoReset===!0&&this.info.reset(),(Re&&T.hasRenderPass())===!1){const ht=w.opaque,at=w.transmissive;if(_.setupLights(),Se.isArrayCamera){const mt=Se.cameras;if(at.length>0)for(let wt=0,At=mt.length;wt<At;wt++){const xt=mt[wt];Md(ht,at,ne,xt)}$e&&qe.render(ne);for(let wt=0,At=mt.length;wt<At;wt++){const xt=mt[wt];am(w,ne,xt,xt.viewport)}}else at.length>0&&Md(ht,at,ne,Se),$e&&qe.render(ne),am(w,ne,Se)}R!==null&&N===0&&(K.updateMultisampleRenderTarget(R),K.updateRenderTargetMipmap(R)),Re&&T.end(S),ne.isScene===!0&&ne.onAfterRender(S,ne,Se),Fe.resetDefaultState(),O=-1,G=null,A.pop(),A.length>0?(_=A[A.length-1],ie===!0&&Ke.setGlobalState(S.clippingPlanes,_.state.camera)):_=null,E.pop(),E.length>0?w=E[E.length-1]:w=null};function Td(ne,Se,Ie,Re){if(ne.visible===!1)return;if(ne.layers.test(Se.layers)){if(ne.isGroup)Ie=ne.renderOrder;else if(ne.isLOD)ne.autoUpdate===!0&&ne.update(Se);else if(ne.isLight)_.pushLight(ne),ne.castShadow&&_.pushShadow(ne);else if(ne.isSprite){if(!ne.frustumCulled||Y.intersectsSprite(ne)){Re&&we.setFromMatrixPosition(ne.matrixWorld).applyMatrix4(ge);const ht=be.update(ne),at=ne.material;at.visible&&w.push(ne,ht,at,Ie,we.z,null)}}else if((ne.isMesh||ne.isLine||ne.isPoints)&&(!ne.frustumCulled||Y.intersectsObject(ne))){const ht=be.update(ne),at=ne.material;if(Re&&(ne.boundingSphere!==void 0?(ne.boundingSphere===null&&ne.computeBoundingSphere(),we.copy(ne.boundingSphere.center)):(ht.boundingSphere===null&&ht.computeBoundingSphere(),we.copy(ht.boundingSphere.center)),we.applyMatrix4(ne.matrixWorld).applyMatrix4(ge)),Array.isArray(at)){const mt=ht.groups;for(let wt=0,At=mt.length;wt<At;wt++){const xt=mt[wt],Wt=at[xt.materialIndex];Wt&&Wt.visible&&w.push(ne,ht,Wt,Ie,we.z,xt)}}else at.visible&&w.push(ne,ht,at,Ie,we.z,null)}}const it=ne.children;for(let ht=0,at=it.length;ht<at;ht++)Td(it[ht],Se,Ie,Re)}function am(ne,Se,Ie,Re){const{opaque:Ce,transmissive:it,transparent:ht}=ne;_.setupLightsView(Ie),ie===!0&&Ke.setGlobalState(S.clippingPlanes,Ie),Re&&fe.viewport(I.copy(Re)),Ce.length>0&&Su(Ce,Se,Ie),it.length>0&&Su(it,Se,Ie),ht.length>0&&Su(ht,Se,Ie),fe.buffers.depth.setTest(!0),fe.buffers.depth.setMask(!0),fe.buffers.color.setMask(!0),fe.setPolygonOffset(!1)}function Md(ne,Se,Ie,Re){if((Ie.isScene===!0?Ie.overrideMaterial:null)!==null)return;if(_.state.transmissionRenderTarget[Re.id]===void 0){const Wt=Xe.has("EXT_color_buffer_half_float")||Xe.has("EXT_color_buffer_float");_.state.transmissionRenderTarget[Re.id]=new _c(1,1,{generateMipmaps:!0,type:Wt?pd:Fo,minFilter:zm,samples:ae.samples,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:In.workingColorSpace})}const it=_.state.transmissionRenderTarget[Re.id],ht=Re.viewport||I;it.setSize(ht.z*S.transmissionResolutionScale,ht.w*S.transmissionResolutionScale);const at=S.getRenderTarget(),mt=S.getActiveCubeFace(),wt=S.getActiveMipmapLevel();S.setRenderTarget(it),S.getClearColor(H),Q=S.getClearAlpha(),Q<1&&S.setClearColor(16777215,.5),S.clear(),$e&&qe.render(Ie);const At=S.toneMapping;S.toneMapping=bc;const xt=Re.viewport;if(Re.viewport!==void 0&&(Re.viewport=void 0),_.setupLightsView(Re),ie===!0&&Ke.setGlobalState(S.clippingPlanes,Re),Su(ne,Ie,Re),K.updateMultisampleRenderTarget(it),K.updateRenderTargetMipmap(it),Xe.has("WEBGL_multisampled_render_to_texture")===!1){let Wt=!1;for(let Dn=0,mr=Se.length;Dn<mr;Dn++){const kt=Se[Dn],{object:kn,geometry:St,material:_n,group:Nn}=kt;if(_n.side===kh&&kn.layers.test(Re.layers)){const Ps=_n.side;_n.side=eo,_n.needsUpdate=!0,om(kn,Ie,Re,St,_n,Nn),_n.side=Ps,_n.needsUpdate=!0,Wt=!0}}Wt===!0&&(K.updateMultisampleRenderTarget(it),K.updateRenderTargetMipmap(it))}S.setRenderTarget(at,mt,wt),S.setClearColor(H,Q),xt!==void 0&&(Re.viewport=xt),S.toneMapping=At}function Su(ne,Se,Ie){const Re=Se.isScene===!0?Se.overrideMaterial:null;for(let Ce=0,it=ne.length;Ce<it;Ce++){const ht=ne[Ce],{object:at,geometry:mt,group:wt}=ht;let At=ht.material;At.allowOverride===!0&&Re!==null&&(At=Re),at.layers.test(Ie.layers)&&om(at,Se,Ie,mt,At,wt)}}function om(ne,Se,Ie,Re,Ce,it){ne.onBeforeRender(S,Se,Ie,Re,Ce,it),ne.modelViewMatrix.multiplyMatrices(Ie.matrixWorldInverse,ne.matrixWorld),ne.normalMatrix.getNormalMatrix(ne.modelViewMatrix),Ce.onBeforeRender(S,Se,Ie,Re,ne,it),Ce.transparent===!0&&Ce.side===kh&&Ce.forceSinglePass===!1?(Ce.side=eo,Ce.needsUpdate=!0,S.renderBufferDirect(Ie,Se,Re,Ce,ne,it),Ce.side=Ip,Ce.needsUpdate=!0,S.renderBufferDirect(Ie,Se,Re,Ce,ne,it),Ce.side=kh):S.renderBufferDirect(Ie,Se,Re,Ce,ne,it),ne.onAfterRender(S,Se,Ie,Re,Ce,it)}function Cd(ne,Se,Ie){Se.isScene!==!0&&(Se=Be);const Re=P.get(ne),Ce=_.state.lights,it=_.state.shadowsArray,ht=Ce.state.version,at=Pe.getParameters(ne,Ce.state,it,Se,Ie),mt=Pe.getProgramCacheKey(at);let wt=Re.programs;Re.environment=ne.isMeshStandardMaterial?Se.environment:null,Re.fog=Se.fog,Re.envMap=(ne.isMeshStandardMaterial?pe:oe).get(ne.envMap||Re.environment),Re.envMapRotation=Re.environment!==null&&ne.envMap===null?Se.environmentRotation:ne.envMapRotation,wt===void 0&&(ne.addEventListener("dispose",Ia),wt=new Map,Re.programs=wt);let At=wt.get(mt);if(At!==void 0){if(Re.currentProgram===At&&Re.lightsStateVersion===ht)return Zv(ne,at),At}else at.uniforms=Pe.getUniforms(ne),ne.onBeforeCompile(at,S),At=Pe.acquireProgram(at,mt),wt.set(mt,At),Re.uniforms=at.uniforms;const xt=Re.uniforms;return(!ne.isShaderMaterial&&!ne.isRawShaderMaterial||ne.clipping===!0)&&(xt.clippingPlanes=Ke.uniform),Zv(ne,at),Re.needsLights=um(ne),Re.lightsStateVersion=ht,Re.needsLights&&(xt.ambientLightColor.value=Ce.state.ambient,xt.lightProbe.value=Ce.state.probe,xt.directionalLights.value=Ce.state.directional,xt.directionalLightShadows.value=Ce.state.directionalShadow,xt.spotLights.value=Ce.state.spot,xt.spotLightShadows.value=Ce.state.spotShadow,xt.rectAreaLights.value=Ce.state.rectArea,xt.ltc_1.value=Ce.state.rectAreaLTC1,xt.ltc_2.value=Ce.state.rectAreaLTC2,xt.pointLights.value=Ce.state.point,xt.pointLightShadows.value=Ce.state.pointShadow,xt.hemisphereLights.value=Ce.state.hemi,xt.directionalShadowMap.value=Ce.state.directionalShadowMap,xt.directionalShadowMatrix.value=Ce.state.directionalShadowMatrix,xt.spotShadowMap.value=Ce.state.spotShadowMap,xt.spotLightMatrix.value=Ce.state.spotLightMatrix,xt.spotLightMap.value=Ce.state.spotLightMap,xt.pointShadowMap.value=Ce.state.pointShadowMap,xt.pointShadowMatrix.value=Ce.state.pointShadowMatrix),Re.currentProgram=At,Re.uniformsList=null,At}function lm(ne){if(ne.uniformsList===null){const Se=ne.currentProgram.getUniforms();ne.uniformsList=dC.seqWithValue(Se.seq,ne.uniforms)}return ne.uniformsList}function Zv(ne,Se){const Ie=P.get(ne);Ie.outputColorSpace=Se.outputColorSpace,Ie.batching=Se.batching,Ie.batchingColor=Se.batchingColor,Ie.instancing=Se.instancing,Ie.instancingColor=Se.instancingColor,Ie.instancingMorph=Se.instancingMorph,Ie.skinning=Se.skinning,Ie.morphTargets=Se.morphTargets,Ie.morphNormals=Se.morphNormals,Ie.morphColors=Se.morphColors,Ie.morphTargetsCount=Se.morphTargetsCount,Ie.numClippingPlanes=Se.numClippingPlanes,Ie.numIntersection=Se.numClipIntersection,Ie.vertexAlphas=Se.vertexAlphas,Ie.vertexTangents=Se.vertexTangents,Ie.toneMapping=Se.toneMapping}function Dd(ne,Se,Ie,Re,Ce){Se.isScene!==!0&&(Se=Be),K.resetTextureUnits();const it=Se.fog,ht=Re.isMeshStandardMaterial?Se.environment:null,at=R===null?S.outputColorSpace:R.isXRRenderTarget===!0?R.texture.colorSpace:yb,mt=(Re.isMeshStandardMaterial?pe:oe).get(Re.envMap||ht),wt=Re.vertexColors===!0&&!!Ie.attributes.color&&Ie.attributes.color.itemSize===4,At=!!Ie.attributes.tangent&&(!!Re.normalMap||Re.anisotropy>0),xt=!!Ie.morphAttributes.position,Wt=!!Ie.morphAttributes.normal,Dn=!!Ie.morphAttributes.color;let mr=bc;Re.toneMapped&&(R===null||R.isXRRenderTarget===!0)&&(mr=S.toneMapping);const kt=Ie.morphAttributes.position||Ie.morphAttributes.normal||Ie.morphAttributes.color,kn=kt!==void 0?kt.length:0,St=P.get(Re),_n=_.state.lights;if(ie===!0&&(ve===!0||ne!==G)){const Gi=ne===G&&Re.id===O;Ke.setState(Re,ne,Gi)}let Nn=!1;Re.version===St.__version?(St.needsLights&&St.lightsStateVersion!==_n.state.version||St.outputColorSpace!==at||Ce.isBatchedMesh&&St.batching===!1||!Ce.isBatchedMesh&&St.batching===!0||Ce.isBatchedMesh&&St.batchingColor===!0&&Ce.colorTexture===null||Ce.isBatchedMesh&&St.batchingColor===!1&&Ce.colorTexture!==null||Ce.isInstancedMesh&&St.instancing===!1||!Ce.isInstancedMesh&&St.instancing===!0||Ce.isSkinnedMesh&&St.skinning===!1||!Ce.isSkinnedMesh&&St.skinning===!0||Ce.isInstancedMesh&&St.instancingColor===!0&&Ce.instanceColor===null||Ce.isInstancedMesh&&St.instancingColor===!1&&Ce.instanceColor!==null||Ce.isInstancedMesh&&St.instancingMorph===!0&&Ce.morphTexture===null||Ce.isInstancedMesh&&St.instancingMorph===!1&&Ce.morphTexture!==null||St.envMap!==mt||Re.fog===!0&&St.fog!==it||St.numClippingPlanes!==void 0&&(St.numClippingPlanes!==Ke.numPlanes||St.numIntersection!==Ke.numIntersection)||St.vertexAlphas!==wt||St.vertexTangents!==At||St.morphTargets!==xt||St.morphNormals!==Wt||St.morphColors!==Dn||St.toneMapping!==mr||St.morphTargetsCount!==kn)&&(Nn=!0):(Nn=!0,St.__version=Re.version);let Ps=St.currentProgram;Nn===!0&&(Ps=Cd(Re,Se,Ce));let Nd=!1,ua=!1,cm=!1;const Jn=Ps.getUniforms(),hi=St.uniforms;if(fe.useProgram(Ps.program)&&(Nd=!0,ua=!0,cm=!0),Re.id!==O&&(O=Re.id,ua=!0),Nd||G!==ne){fe.buffers.depth.getReversed()&&ne.reversedDepth!==!0&&(ne._reversedDepth=!0,ne.updateProjectionMatrix()),Jn.setValue(de,"projectionMatrix",ne.projectionMatrix),Jn.setValue(de,"viewMatrix",ne.matrixWorldInverse);const ls=Jn.map.cameraPosition;ls!==void 0&&ls.setValue(de,_e.setFromMatrixPosition(ne.matrixWorld)),ae.logarithmicDepthBuffer&&Jn.setValue(de,"logDepthBufFC",2/(Math.log(ne.far+1)/Math.LN2)),(Re.isMeshPhongMaterial||Re.isMeshToonMaterial||Re.isMeshLambertMaterial||Re.isMeshBasicMaterial||Re.isMeshStandardMaterial||Re.isShaderMaterial)&&Jn.setValue(de,"isOrthographic",ne.isOrthographicCamera===!0),G!==ne&&(G=ne,ua=!0,cm=!0)}if(St.needsLights&&(_n.state.directionalShadowMap.length>0&&Jn.setValue(de,"directionalShadowMap",_n.state.directionalShadowMap,K),_n.state.spotShadowMap.length>0&&Jn.setValue(de,"spotShadowMap",_n.state.spotShadowMap,K),_n.state.pointShadowMap.length>0&&Jn.setValue(de,"pointShadowMap",_n.state.pointShadowMap,K)),Ce.isSkinnedMesh){Jn.setOptional(de,Ce,"bindMatrix"),Jn.setOptional(de,Ce,"bindMatrixInverse");const Gi=Ce.skeleton;Gi&&(Gi.boneTexture===null&&Gi.computeBoneTexture(),Jn.setValue(de,"boneTexture",Gi.boneTexture,K))}Ce.isBatchedMesh&&(Jn.setOptional(de,Ce,"batchingTexture"),Jn.setValue(de,"batchingTexture",Ce._matricesTexture,K),Jn.setOptional(de,Ce,"batchingIdTexture"),Jn.setValue(de,"batchingIdTexture",Ce._indirectTexture,K),Jn.setOptional(de,Ce,"batchingColorTexture"),Ce._colorsTexture!==null&&Jn.setValue(de,"batchingColorTexture",Ce._colorsTexture,K));const di=Ie.morphAttributes;if((di.position!==void 0||di.normal!==void 0||di.color!==void 0)&&z.update(Ce,Ie,Ps),(ua||St.receiveShadow!==Ce.receiveShadow)&&(St.receiveShadow=Ce.receiveShadow,Jn.setValue(de,"receiveShadow",Ce.receiveShadow)),Re.isMeshGouraudMaterial&&Re.envMap!==null&&(hi.envMap.value=mt,hi.flipEnvMap.value=mt.isCubeTexture&&mt.isRenderTargetTexture===!1?-1:1),Re.isMeshStandardMaterial&&Re.envMap===null&&Se.environment!==null&&(hi.envMapIntensity.value=Se.environmentIntensity),hi.dfgLUT!==void 0&&(hi.dfgLUT.value=YTe()),ua&&(Jn.setValue(de,"toneMappingExposure",S.toneMappingExposure),St.needsLights&&Jv(hi,cm),it&&Re.fog===!0&&Me.refreshFogUniforms(hi,it),Me.refreshMaterialUniforms(hi,Re,L,J,_.state.transmissionRenderTarget[ne.id]),dC.upload(de,lm(St),hi,K)),Re.isShaderMaterial&&Re.uniformsNeedUpdate===!0&&(dC.upload(de,lm(St),hi,K),Re.uniformsNeedUpdate=!1),Re.isSpriteMaterial&&Jn.setValue(de,"center",Ce.center),Jn.setValue(de,"modelViewMatrix",Ce.modelViewMatrix),Jn.setValue(de,"normalMatrix",Ce.normalMatrix),Jn.setValue(de,"modelMatrix",Ce.matrixWorld),Re.isShaderMaterial||Re.isRawShaderMaterial){const Gi=Re.uniformsGroups;for(let ls=0,e0=Gi.length;ls<e0;ls++){const Au=Gi[ls];Le.update(Au,Ps),Le.bind(Au,Ps)}}return Ps}function Jv(ne,Se){ne.ambientLightColor.needsUpdate=Se,ne.lightProbe.needsUpdate=Se,ne.directionalLights.needsUpdate=Se,ne.directionalLightShadows.needsUpdate=Se,ne.pointLights.needsUpdate=Se,ne.pointLightShadows.needsUpdate=Se,ne.spotLights.needsUpdate=Se,ne.spotLightShadows.needsUpdate=Se,ne.rectAreaLights.needsUpdate=Se,ne.hemisphereLights.needsUpdate=Se}function um(ne){return ne.isMeshLambertMaterial||ne.isMeshToonMaterial||ne.isMeshPhongMaterial||ne.isMeshStandardMaterial||ne.isShadowMaterial||ne.isShaderMaterial&&ne.lights===!0}this.getActiveCubeFace=function(){return D},this.getActiveMipmapLevel=function(){return N},this.getRenderTarget=function(){return R},this.setRenderTargetTextures=function(ne,Se,Ie){const Re=P.get(ne);Re.__autoAllocateDepthBuffer=ne.resolveDepthBuffer===!1,Re.__autoAllocateDepthBuffer===!1&&(Re.__useRenderToTexture=!1),P.get(ne.texture).__webglTexture=Se,P.get(ne.depthTexture).__webglTexture=Re.__autoAllocateDepthBuffer?void 0:Ie,Re.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(ne,Se){const Ie=P.get(ne);Ie.__webglFramebuffer=Se,Ie.__useDefaultFramebuffer=Se===void 0};const kc=de.createFramebuffer();this.setRenderTarget=function(ne,Se=0,Ie=0){R=ne,D=Se,N=Ie;let Re=null,Ce=!1,it=!1;if(ne){const at=P.get(ne);if(at.__useDefaultFramebuffer!==void 0){fe.bindFramebuffer(de.FRAMEBUFFER,at.__webglFramebuffer),I.copy(ne.viewport),B.copy(ne.scissor),$=ne.scissorTest,fe.viewport(I),fe.scissor(B),fe.setScissorTest($),O=-1;return}else if(at.__webglFramebuffer===void 0)K.setupRenderTarget(ne);else if(at.__hasExternalTextures)K.rebindTextures(ne,P.get(ne.texture).__webglTexture,P.get(ne.depthTexture).__webglTexture);else if(ne.depthBuffer){const At=ne.depthTexture;if(at.__boundDepthTexture!==At){if(At!==null&&P.has(At)&&(ne.width!==At.image.width||ne.height!==At.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");K.setupDepthRenderbuffer(ne)}}const mt=ne.texture;(mt.isData3DTexture||mt.isDataArrayTexture||mt.isCompressedArrayTexture)&&(it=!0);const wt=P.get(ne).__webglFramebuffer;ne.isWebGLCubeRenderTarget?(Array.isArray(wt[Se])?Re=wt[Se][Ie]:Re=wt[Se],Ce=!0):ne.samples>0&&K.useMultisampledRTT(ne)===!1?Re=P.get(ne).__webglMultisampledFramebuffer:Array.isArray(wt)?Re=wt[Ie]:Re=wt,I.copy(ne.viewport),B.copy(ne.scissor),$=ne.scissorTest}else I.copy(le).multiplyScalar(L).floor(),B.copy(ue).multiplyScalar(L).floor(),$=te;if(Ie!==0&&(Re=kc),fe.bindFramebuffer(de.FRAMEBUFFER,Re)&&fe.drawBuffers(ne,Re),fe.viewport(I),fe.scissor(B),fe.setScissorTest($),Ce){const at=P.get(ne.texture);de.framebufferTexture2D(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_CUBE_MAP_POSITIVE_X+Se,at.__webglTexture,Ie)}else if(it){const at=Se;for(let mt=0;mt<ne.textures.length;mt++){const wt=P.get(ne.textures[mt]);de.framebufferTextureLayer(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0+mt,wt.__webglTexture,Ie,at)}}else if(ne!==null&&Ie!==0){const at=P.get(ne.texture);de.framebufferTexture2D(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_2D,at.__webglTexture,Ie)}O=-1},this.readRenderTargetPixels=function(ne,Se,Ie,Re,Ce,it,ht,at=0){if(!(ne&&ne.isWebGLRenderTarget)){Bn("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let mt=P.get(ne).__webglFramebuffer;if(ne.isWebGLCubeRenderTarget&&ht!==void 0&&(mt=mt[ht]),mt){fe.bindFramebuffer(de.FRAMEBUFFER,mt);try{const wt=ne.textures[at],At=wt.format,xt=wt.type;if(!ae.textureFormatReadable(At)){Bn("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!ae.textureTypeReadable(xt)){Bn("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Se>=0&&Se<=ne.width-Re&&Ie>=0&&Ie<=ne.height-Ce&&(ne.textures.length>1&&de.readBuffer(de.COLOR_ATTACHMENT0+at),de.readPixels(Se,Ie,Re,Ce,Ee.convert(At),Ee.convert(xt),it))}finally{const wt=R!==null?P.get(R).__webglFramebuffer:null;fe.bindFramebuffer(de.FRAMEBUFFER,wt)}}},this.readRenderTargetPixelsAsync=async function(ne,Se,Ie,Re,Ce,it,ht,at=0){if(!(ne&&ne.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let mt=P.get(ne).__webglFramebuffer;if(ne.isWebGLCubeRenderTarget&&ht!==void 0&&(mt=mt[ht]),mt)if(Se>=0&&Se<=ne.width-Re&&Ie>=0&&Ie<=ne.height-Ce){fe.bindFramebuffer(de.FRAMEBUFFER,mt);const wt=ne.textures[at],At=wt.format,xt=wt.type;if(!ae.textureFormatReadable(At))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!ae.textureTypeReadable(xt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Wt=de.createBuffer();de.bindBuffer(de.PIXEL_PACK_BUFFER,Wt),de.bufferData(de.PIXEL_PACK_BUFFER,it.byteLength,de.STREAM_READ),ne.textures.length>1&&de.readBuffer(de.COLOR_ATTACHMENT0+at),de.readPixels(Se,Ie,Re,Ce,Ee.convert(At),Ee.convert(xt),0);const Dn=R!==null?P.get(R).__webglFramebuffer:null;fe.bindFramebuffer(de.FRAMEBUFFER,Dn);const mr=de.fenceSync(de.SYNC_GPU_COMMANDS_COMPLETE,0);return de.flush(),await y1e(de,mr,4),de.bindBuffer(de.PIXEL_PACK_BUFFER,Wt),de.getBufferSubData(de.PIXEL_PACK_BUFFER,0,it),de.deleteBuffer(Wt),de.deleteSync(mr),it}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(ne,Se=null,Ie=0){const Re=Math.pow(2,-Ie),Ce=Math.floor(ne.image.width*Re),it=Math.floor(ne.image.height*Re),ht=Se!==null?Se.x:0,at=Se!==null?Se.y:0;K.setTexture2D(ne,0),de.copyTexSubImage2D(de.TEXTURE_2D,Ie,0,0,ht,at,Ce,it),fe.unbindTexture()};const la=de.createFramebuffer(),bn=de.createFramebuffer();this.copyTextureToTexture=function(ne,Se,Ie=null,Re=null,Ce=0,it=null){it===null&&(Ce!==0?(Cw("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),it=Ce,Ce=0):it=0);let ht,at,mt,wt,At,xt,Wt,Dn,mr;const kt=ne.isCompressedTexture?ne.mipmaps[it]:ne.image;if(Ie!==null)ht=Ie.max.x-Ie.min.x,at=Ie.max.y-Ie.min.y,mt=Ie.isBox3?Ie.max.z-Ie.min.z:1,wt=Ie.min.x,At=Ie.min.y,xt=Ie.isBox3?Ie.min.z:0;else{const di=Math.pow(2,-Ce);ht=Math.floor(kt.width*di),at=Math.floor(kt.height*di),ne.isDataArrayTexture?mt=kt.depth:ne.isData3DTexture?mt=Math.floor(kt.depth*di):mt=1,wt=0,At=0,xt=0}Re!==null?(Wt=Re.x,Dn=Re.y,mr=Re.z):(Wt=0,Dn=0,mr=0);const kn=Ee.convert(Se.format),St=Ee.convert(Se.type);let _n;Se.isData3DTexture?(K.setTexture3D(Se,0),_n=de.TEXTURE_3D):Se.isDataArrayTexture||Se.isCompressedArrayTexture?(K.setTexture2DArray(Se,0),_n=de.TEXTURE_2D_ARRAY):(K.setTexture2D(Se,0),_n=de.TEXTURE_2D),de.pixelStorei(de.UNPACK_FLIP_Y_WEBGL,Se.flipY),de.pixelStorei(de.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Se.premultiplyAlpha),de.pixelStorei(de.UNPACK_ALIGNMENT,Se.unpackAlignment);const Nn=de.getParameter(de.UNPACK_ROW_LENGTH),Ps=de.getParameter(de.UNPACK_IMAGE_HEIGHT),Nd=de.getParameter(de.UNPACK_SKIP_PIXELS),ua=de.getParameter(de.UNPACK_SKIP_ROWS),cm=de.getParameter(de.UNPACK_SKIP_IMAGES);de.pixelStorei(de.UNPACK_ROW_LENGTH,kt.width),de.pixelStorei(de.UNPACK_IMAGE_HEIGHT,kt.height),de.pixelStorei(de.UNPACK_SKIP_PIXELS,wt),de.pixelStorei(de.UNPACK_SKIP_ROWS,At),de.pixelStorei(de.UNPACK_SKIP_IMAGES,xt);const Jn=ne.isDataArrayTexture||ne.isData3DTexture,hi=Se.isDataArrayTexture||Se.isData3DTexture;if(ne.isDepthTexture){const di=P.get(ne),Gi=P.get(Se),ls=P.get(di.__renderTarget),e0=P.get(Gi.__renderTarget);fe.bindFramebuffer(de.READ_FRAMEBUFFER,ls.__webglFramebuffer),fe.bindFramebuffer(de.DRAW_FRAMEBUFFER,e0.__webglFramebuffer);for(let Au=0;Au<mt;Au++)Jn&&(de.framebufferTextureLayer(de.READ_FRAMEBUFFER,de.COLOR_ATTACHMENT0,P.get(ne).__webglTexture,Ce,xt+Au),de.framebufferTextureLayer(de.DRAW_FRAMEBUFFER,de.COLOR_ATTACHMENT0,P.get(Se).__webglTexture,it,mr+Au)),de.blitFramebuffer(wt,At,ht,at,Wt,Dn,ht,at,de.DEPTH_BUFFER_BIT,de.NEAREST);fe.bindFramebuffer(de.READ_FRAMEBUFFER,null),fe.bindFramebuffer(de.DRAW_FRAMEBUFFER,null)}else if(Ce!==0||ne.isRenderTargetTexture||P.has(ne)){const di=P.get(ne),Gi=P.get(Se);fe.bindFramebuffer(de.READ_FRAMEBUFFER,la),fe.bindFramebuffer(de.DRAW_FRAMEBUFFER,bn);for(let ls=0;ls<mt;ls++)Jn?de.framebufferTextureLayer(de.READ_FRAMEBUFFER,de.COLOR_ATTACHMENT0,di.__webglTexture,Ce,xt+ls):de.framebufferTexture2D(de.READ_FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_2D,di.__webglTexture,Ce),hi?de.framebufferTextureLayer(de.DRAW_FRAMEBUFFER,de.COLOR_ATTACHMENT0,Gi.__webglTexture,it,mr+ls):de.framebufferTexture2D(de.DRAW_FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_2D,Gi.__webglTexture,it),Ce!==0?de.blitFramebuffer(wt,At,ht,at,Wt,Dn,ht,at,de.COLOR_BUFFER_BIT,de.NEAREST):hi?de.copyTexSubImage3D(_n,it,Wt,Dn,mr+ls,wt,At,ht,at):de.copyTexSubImage2D(_n,it,Wt,Dn,wt,At,ht,at);fe.bindFramebuffer(de.READ_FRAMEBUFFER,null),fe.bindFramebuffer(de.DRAW_FRAMEBUFFER,null)}else hi?ne.isDataTexture||ne.isData3DTexture?de.texSubImage3D(_n,it,Wt,Dn,mr,ht,at,mt,kn,St,kt.data):Se.isCompressedArrayTexture?de.compressedTexSubImage3D(_n,it,Wt,Dn,mr,ht,at,mt,kn,kt.data):de.texSubImage3D(_n,it,Wt,Dn,mr,ht,at,mt,kn,St,kt):ne.isDataTexture?de.texSubImage2D(de.TEXTURE_2D,it,Wt,Dn,ht,at,kn,St,kt.data):ne.isCompressedTexture?de.compressedTexSubImage2D(de.TEXTURE_2D,it,Wt,Dn,kt.width,kt.height,kn,kt.data):de.texSubImage2D(de.TEXTURE_2D,it,Wt,Dn,ht,at,kn,St,kt);de.pixelStorei(de.UNPACK_ROW_LENGTH,Nn),de.pixelStorei(de.UNPACK_IMAGE_HEIGHT,Ps),de.pixelStorei(de.UNPACK_SKIP_PIXELS,Nd),de.pixelStorei(de.UNPACK_SKIP_ROWS,ua),de.pixelStorei(de.UNPACK_SKIP_IMAGES,cm),it===0&&Se.generateMipmaps&&de.generateMipmap(_n),fe.unbindTexture()},this.initRenderTarget=function(ne){P.get(ne).__webglFramebuffer===void 0&&K.setupRenderTarget(ne)},this.initTexture=function(ne){ne.isCubeTexture?K.setTextureCube(ne,0):ne.isData3DTexture?K.setTexture3D(ne,0):ne.isDataArrayTexture||ne.isCompressedArrayTexture?K.setTexture2DArray(ne,0):K.setTexture2D(ne,0),fe.unbindTexture()},this.resetState=function(){D=0,N=0,R=null,fe.reset(),Fe.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return oc}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=In._getDrawingBufferColorSpace(e),t.unpackColorSpace=In._getUnpackColorSpace()}}function ZTe(){const{isDark:n}=Nl(),[e,t]=xe.useState("neutron-collision"),[r,i]=xe.useState(0),[s,a]=xe.useState(1),[o,l]=xe.useState(!0),[u,c]=xe.useState(!0),h=xe.useRef(null),d=xe.useRef(null),f=xe.useRef(null),p=xe.useRef(null),m=xe.useRef(0);class y{constructor(R){const O=new Zr,G=new Float32Array(R*3),I=new Float32Array(R*3),B=new Float32Array(R*3);for(let H=0;H<R;H++)G[H*3]=(Math.random()-.5)*2,G[H*3+1]=(Math.random()-.5)*2,G[H*3+2]=(Math.random()-.5)*2,I[H*3]=(Math.random()-.5)*.02,I[H*3+1]=(Math.random()-.5)*.02,I[H*3+2]=(Math.random()-.5)*.02,B[H*3]=Math.random(),B[H*3+1]=Math.random(),B[H*3+2]=Math.random();O.setAttribute("position",new _s(G,3)),O.setAttribute("color",new _s(B,3));const $=new B0({size:.02,vertexColors:!0,sizeAttenuation:!0,transparent:!0,opacity:.8});this.mesh=new C_(O,$),this.velocities=I,this.positionAttribute=O.getAttribute("position"),this.colorAttribute=O.getAttribute("color")}update(R){const O=this.positionAttribute.array;for(let G=0;G<O.length;G+=3)R(G,O);this.positionAttribute.needsUpdate=!0}}const M=[{id:"neutron-collision",name:"  ",fn:()=>{const N=new Hc;N.background=new Ft(n?658983:16119285);const R=new Zr,O=new Float32Array(500*3);for(let ie=0;ie<500;ie++)O[ie*3]=(Math.random()-.5)*100,O[ie*3+1]=(Math.random()-.5)*100,O[ie*3+2]=(Math.random()-.5)*100;R.setAttribute("position",new _s(O,3));const G=new B0({color:16777215,size:.3});N.add(new C_(R,G));const I=new zl(.3,32,32),B=new Gc({color:4491519,emissive:2245887,shininess:100,wireframe:!1}),$=new qn(I,B);$.position.x=-.8,N.add($);const H=new zl(.3,32,32),Q=new Gc({color:16737860,emissive:16729122,shininess:100}),ee=new qn(H,Q);ee.position.x=.8,N.add(ee);const J=new Zc(.5,.2,16,100),L=new Zo({color:16746496,transparent:!0,opacity:0}),se=new qn(J,L);se.rotation.x=Math.PI*.3,N.add(se);const Z=new y(1e3);N.add(Z.mesh);const le=[];for(let ie=0;ie<5;ie++){const ve=new Zc(.2+ie*.3,.05,16,64),ge=new Zo({color:52479,transparent:!0,opacity:0}),_e=new qn(ve,ge);le.push(_e),N.add(_e)}const ue=new Nu(4491519,1.5);ue.position.set(-2,2,2),N.add(ue);const te=new Nu(16737860,1.5);te.position.set(2,2,2),N.add(te);const Y=new jc(16777215,.3);return N.add(Y),{scene:N,objects:{ns1:$,ns2:ee,disk:se,kilonovaSystem:Z,gravitationalWaves:le},animate:ie=>{if(ie<.5)$.position.x=-.8+ie*1.6,ee.position.x=.8-ie*1.6,$.rotation.y+=.005,ee.rotation.y-=.005;else{const ve=(ie-.5)*2;se.material.opacity=Math.min(ve,.7),Z.update((ge,_e)=>{if(ve>.2){const we=Math.random()*Math.PI*2,Be=Math.random()*ve*2;_e[ge]=Math.cos(we)*Be*.1,_e[ge+1]=Math.sin(we)*Be*.1,_e[ge+2]=(Math.random()-.5)*Be*.1}}),le.forEach((ge,_e)=>{ge.material.opacity=Math.max(0,.6-ve*.5),ge.scale.set(1+ve*.5,1+ve*.5,1)})}}}}},{id:"bh-accretion",name:"  ",fn:()=>{const N=new Hc;N.background=new Ft(n?0:16777215);const R=new Zr,O=new Float32Array(300*3);for(let Y=0;Y<300;Y++)O[Y*3]=(Math.random()-.5)*80,O[Y*3+1]=(Math.random()-.5)*80,O[Y*3+2]=(Math.random()-.5)*80;R.setAttribute("position",new _s(O,3));const G=new B0({color:11184810,size:.2});N.add(new C_(R,G));const I=new zl(.3,64,64),B=new Zo({color:0}),$=new qn(I,B);N.add($);const H=new Zc(.45,.08,32,256),Q=new Zo({color:16755268,transparent:!0,opacity:.8}),ee=new qn(H,Q);ee.rotation.x=.3,N.add(ee);const J=[];for(let Y=0;Y<8;Y++){const ie=.5+Y*.25,ve=.15,ge=new Zc(ie,ve,16,256),_e=30+Y*8,we=100,Be=40+Y*5,$e=new Ft;$e.setHSL(_e/360,we/100,Be/100);const nt=new Gc({color:$e,emissive:$e,emissiveIntensity:.5,transparent:!0,opacity:.7-Y*.05}),de=new qn(ge,nt);de.rotation.x=.2,de.userData.rotationSpeed=.02-Y*.002,J.push(de),N.add(de)}const L=new j4(.15,2,16),se=new Gc({color:43775,emissive:30719,emissiveIntensity:.8}),Z=new qn(L,se);Z.position.z=1.5;const le=new qn(L,se);le.position.z=-1.5,le.rotation.z=Math.PI,N.add(Z),N.add(le);const ue=new Nu(16746564,2);ue.position.set(3,3,3),N.add(ue);const te=new jc(16777215,.2);return N.add(te),{scene:N,objects:{bh:$,photonRing:ee,accretionDisks:J,jetUp:Z,jetDown:le},animate:Y=>{J.forEach(ie=>{ie.rotation.z+=ie.userData.rotationSpeed,ie.material.opacity=.7-Math.sin(Y*3)*.2-ie.userData.rotationSpeed*50*.05}),ee.rotation.z+=.01}}}},{id:"supernova",name:"  ",fn:()=>{const N=new Hc;N.background=new Ft(n?658983:16119285);const R=new Zr,O=new Float32Array(400*3);for(let ue=0;ue<400;ue++)O[ue*3]=(Math.random()-.5)*100,O[ue*3+1]=(Math.random()-.5)*100,O[ue*3+2]=(Math.random()-.5)*100;R.setAttribute("position",new _s(O,3));const G=new B0({color:16777215,size:.3});N.add(new C_(R,G));const I=new zl(.2,16,16),B=new Zo({color:16776960}),$=new qn(I,B);N.add($);const H=new zl(.25,32,32),Q=new Gc({color:16737792,emissive:16724736,emissiveIntensity:.7,wireframe:!1,transparent:!0,opacity:.6}),ee=new qn(H,Q);N.add(ee);const J=new y(2e3);J.mesh.userData.initialPositions=new Float32Array(J.positionAttribute.array.length),J.mesh.userData.initialPositions.set(J.positionAttribute.array),N.add(J.mesh);const L=[];for(let ue=0;ue<8;ue++){const te=new Zc(.3+ue*.2,.05,16,128),Y=new Zo({color:65535,transparent:!0,opacity:0}),ie=new qn(te,Y);L.push(ie),N.add(ie)}const se=new Nu(16776960,1.5);se.position.set(0,0,0),N.add(se);const Z=new Nu(16737792,1);Z.position.set(.5,.5,.5),N.add(Z);const le=new jc(16777215,.2);return N.add(le),{scene:N,objects:{core:$,shell:ee,ejectaSystem:J,shockWaves:L},animate:ue=>{ee.scale.set(1+ue*2,1+ue*2,1+ue*2),ee.material.opacity=Math.max(0,.6-ue*.5),$.scale.set(Math.max(.2,.2-ue*.1),Math.max(.2,.2-ue*.1),Math.max(.2,.2-ue*.1)),J.update((te,Y)=>{const ie=J.mesh.userData.initialPositions,ve=1+ue*3;Y[te]=ie[te]*ve,Y[te+1]=ie[te+1]*ve,Y[te+2]=ie[te+2]*ve}),L.forEach((te,Y)=>{te.scale.set(1+ue*2+Y*.3,1+ue*2+Y*.3,1),te.material.opacity=Math.max(0,.7-ue*.8-Y*.1)})}}}},{id:"galaxy-merger",name:"  ",fn:()=>{const N=new Hc;N.background=new Ft(n?658983:16119285);const R=(ee,J)=>{const L=new y(800),se=L.positionAttribute.array;for(let Z=0;Z<se.length;Z+=3){const le=Math.random()**.5*2,ue=Math.random()*Math.PI*2,te=(Math.random()-.5)*.5;se[Z]=Math.cos(ue)*le+ee,se[Z+1]=Math.sin(ue)*le,se[Z+2]=te}return L.positionAttribute.needsUpdate=!0,L.mesh.userData.rotationDir=J,L.mesh.userData.galaxyX=ee,L},O=R(-1.5,1),G=R(1.5,-1);N.add(O.mesh),N.add(G.mesh);const I=new Zr,B=new Float32Array(300*3);for(let ee=0;ee<300;ee++)B[ee*3]=(Math.random()-.5)*50,B[ee*3+1]=(Math.random()-.5)*50,B[ee*3+2]=(Math.random()-.5)*50;I.setAttribute("position",new _s(B,3));const $=new B0({color:8947848,size:.2});N.add(new C_(I,$));const H=new Nu(16777215,.5);H.position.set(3,3,3),N.add(H);const Q=new jc(16777215,.5);return N.add(Q),{scene:N,objects:{galaxy1:O,galaxy2:G},animate:ee=>{const J=Math.min(ee,1);O.mesh.userData.galaxyX=-1.5+J*1.3,O.update((L,se)=>{se[L]+=J*.01}),G.mesh.userData.galaxyX=1.5-J*1.3,G.update((L,se)=>{se[L]-=J*.01}),O.mesh.rotation.z+=.002,G.mesh.rotation.z-=.002}}}},{id:"cosmic-web",name:"  ",fn:()=>{const N=new Hc;N.background=new Ft(n?658983:16119285);const R=new RD(.1,4),O=[],G=[];for(let H=0;H<60;H++){const Q=(Math.sin(H*12.9898)*.5+.5)*6-3,ee=(Math.sin(H*78.233)*.5+.5)*6-3,J=(Math.sin(H*45.164)*.5+.5)*6-3,L=new Gc({color:new Ft().setHSL(Math.random(),.7,.6),emissive:new Ft().setHSL(Math.random(),.7,.4),emissiveIntensity:.5}),se=new qn(R,L);se.position.set(Q,ee,J),N.add(se),O.push(se),G.push(new Ae(Q,ee,J))}const I=new H4({color:35071,transparent:!0,opacity:.3});for(let H=0;H<O.length;H++)for(let Q=H+1;Q<Math.min(H+4,O.length);Q++){const ee=new Zr,J=new Float32Array([G[H].x,G[H].y,G[H].z,G[Q].x,G[Q].y,G[Q].z]);ee.setAttribute("position",new _s(J,3));const L=new Qee(ee,I);N.add(L)}const B=new jc(16777215,.6);N.add(B);const $=new Nu(16777215,.4);return $.position.set(5,5,5),N.add($),{scene:N,objects:{nodes:O},animate:H=>{O.forEach((Q,ee)=>{Q.rotation.x+=.001,Q.rotation.y+=.0015,Q.position.y+=Math.sin(H*2+ee)*.001})}}}},{id:"cme",name:"  ",fn:()=>{const N=new Hc;N.background=new Ft(n?658983:16119285);const R=new zl(.4,64,64),O=new Gc({color:16759552,emissive:16755200,emissiveIntensity:.8,shininess:10}),G=new qn(R,O);N.add(G);const I=[];for(let Q=0;Q<4;Q++){const ee=new Zc(.6+Q*.1,.05,16,100),J=new Zo({color:16746496,transparent:!0,opacity:.4-Q*.1}),L=new qn(ee,J);L.rotation.x=.2+Q*.1,I.push(L),N.add(L)}const B=new y(1500);B.mesh.userData.initialized=!1,N.add(B.mesh);const $=new Nu(16759552,2);$.position.set(0,0,0),N.add($);const H=new jc(16777215,.3);return N.add(H),{scene:N,objects:{sun:G,magneticLoops:I,cmeParticles:B},animate:Q=>{if(G.rotation.y+=.002,I.forEach(ee=>{ee.rotation.z+=.005,ee.material.opacity=.4-Math.sin(Q*3)*.2}),Q>.3){const ee=Math.min((Q-.3)*1.5,1);B.update((J,L)=>{if(!B.mesh.userData.initialized){const se=Math.random()*Math.PI*2,Z=Math.random()*Math.PI,le=.5;L[J]=Math.sin(Z)*Math.cos(se)*le,L[J+1]=Math.sin(Z)*Math.sin(se)*le,L[J+2]=Math.cos(Z)*le}L[J]*=1+ee*1.5,L[J+1]*=1+ee*1.5,L[J+2]*=1+ee*1.5}),B.mesh.userData.initialized=!0}}}}},{id:"inflation",name:"  ",fn:()=>{const N=new Hc;N.background=new Ft(n?658983:16119285);const R=new y(3e3);N.add(R.mesh);const O=new twe(10,20);O.material.opacity=.1,O.material.transparent=!0,N.add(O);const G=new Nu(16777215,.5);G.position.set(3,3,3),N.add(G);const I=new jc(16777215,.7);return N.add(I),{scene:N,objects:{quantumFluctuations:R},animate:B=>{const $=1+B*100;R.mesh.scale.set($,$,$),R.update((H,Q)=>{Q[H]*=1+B*.5,Q[H+1]*=1+B*.5,Q[H+2]*=1+B*.5})}}}},{id:"planet-form",name:"  ",fn:()=>{const N=new Hc;N.background=new Ft(n?658983:16119285);const R=new zl(.2,32,32),O=new Gc({color:16768256,emissive:16759552,emissiveIntensity:.8}),G=new qn(R,O);N.add(G);const I=new y(2e3);I.mesh.userData.initialPositions=[];const B=I.positionAttribute.array;for(let ee=0;ee<B.length;ee+=3){const J=Math.random()**.6*2,L=Math.random()*Math.PI*2,se=(Math.random()-.5)*.1*J;B[ee]=Math.cos(L)*J,B[ee+1]=Math.sin(L)*J,B[ee+2]=se,I.mesh.userData.initialPositions.push(Math.cos(L)*J,Math.sin(L)*J,se)}I.positionAttribute.needsUpdate=!0,N.add(I.mesh);const $=[];for(let ee=0;ee<10;ee++){const J=new zl(.05+Math.random()*.1,16,16),L=new Gc({color:new Ft().setHSL(.1,.5,.5+Math.random()*.2)}),se=new qn(J,L),Z=.5+Math.random()*1.5,le=Math.random()*Math.PI*2;se.position.set(Math.cos(le)*Z,Math.sin(le)*Z,0),se.userData.angle=le,se.userData.radius=Z,$.push(se),N.add(se)}const H=new Nu(16768256,1.5);N.add(H);const Q=new jc(16777215,.4);return N.add(Q),{scene:N,objects:{star:G,diskSystem:I,planetesimals:$},animate:ee=>{G.rotation.y+=.001,I.mesh.rotation.z+=.003,I.update((J,L)=>{if(I.mesh.userData.initialPositions[J]){const se=1+ee*.3;L[J]=I.mesh.userData.initialPositions[J*3]*se,L[J+1]=I.mesh.userData.initialPositions[J*3+1]*se}}),$.forEach(J=>{J.userData.angle+=.005/J.userData.radius,J.position.x=Math.cos(J.userData.angle)*J.userData.radius,J.position.y=Math.sin(J.userData.angle)*J.userData.radius,J.scale.set(1+ee*.2,1+ee*.2,1+ee*.2)})}}}},{id:"lensing",name:" ",fn:()=>{const N=new Hc;N.background=new Ft(n?658983:16119285);const R=new RD(.1,2),O=new Zo({color:35071});for(let Q=0;Q<30;Q++){const ee=new qn(R,O);ee.position.set((Math.random()-.5)*8,(Math.random()-.5)*8,(Math.random()-.5)*.5),N.add(ee)}const G=new zl(.3,32,32),I=new Zo({color:0,transparent:!0,opacity:.5}),B=new qn(G,I);N.add(B);const $=[];for(let Q=1;Q<4;Q++){const ee=new Zc(.4*Q,.08,16,100),J=new Zo({color:65535,transparent:!0,opacity:.5-Q*.1}),L=new qn(ee,J);$.push(L),N.add(L)}const H=new jc(16777215,.8);return N.add(H),{scene:N,objects:{lens:B,lensRings:$},animate:Q=>{B.rotation.y+=.002,$.forEach((ee,J)=>{ee.rotation.z+=.01-J*.002,ee.material.opacity=Math.max(.1,.5-J*.1-Math.sin(Q*2)*.1)})}}}}];xe.useEffect(()=>{if(!h.current)return;const N=h.current,R=N.clientWidth,O=N.clientHeight||500,G=M.find(Z=>Z.id===e);if(!G)return;const{scene:I,animate:B,objects:$}=G.fn();d.current=I;const H=new QTe({antialias:!0,alpha:!1});H.setSize(R,O),H.setPixelRatio(window.devicePixelRatio),f.current=H,N.firstChild&&N.removeChild(N.firstChild),N.appendChild(H.domElement);const Q=new Ro(75,R/O,.1,1e3);Q.position.z=3;let ee=0,J=0;const L=Z=>{u&&(ee=Z.clientX/R*2-1,J=-(Z.clientY/O)*2+1)};N.addEventListener("mousemove",L);const se=()=>{o&&(m.current+=.01*s,m.current>1&&(m.current=0),i(m.current)),B(m.current),u&&(I.rotation.x=J*.5,I.rotation.y=ee*.5),H.render(I,Q),p.current=requestAnimationFrame(se)};return se(),()=>{cancelAnimationFrame(p.current),N.removeEventListener("mousemove",L),H.dispose(),N.firstChild===H.domElement&&N.removeChild(H.domElement)}},[e,o,s,u,n]),xe.useEffect(()=>{m.current=r},[r]);const D=n?"bg-gray-900 border-gray-800 text-white":"bg-white border-gray-200 text-gray-900";return k.jsxs("div",{className:"space-y-6",children:[k.jsxs(ct.div,{initial:{opacity:0,y:-30},animate:{opacity:1,y:0},transition:{duration:.5},children:[k.jsx("h1",{className:"text-4xl sm:text-5xl font-bold mb-4 bg-gradient-to-r from-cyan-500 to-purple-500 dark:from-cyan-300 dark:to-purple-300 bg-clip-text text-transparent",children:"   "}),k.jsx("p",{className:`text-sm sm:text-base ${n?"text-gray-300":"text-gray-600"}`,children:" 3D    -   "})]}),k.jsx(ct.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5},className:`p-4 rounded-3xl border shadow-lg ${D} overflow-hidden`,children:k.jsx("div",{ref:h,style:{width:"100%",height:"600px",cursor:u?"grab":"default"},className:`rounded-2xl border ${n?"border-gray-700":"border-gray-300"}`})}),k.jsxs(ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:`p-6 rounded-3xl border shadow-sm ${D}`,children:[k.jsx("h2",{className:"text-2xl font-bold mb-6",children:"  "}),k.jsxs("div",{className:"mb-6",children:[k.jsx("p",{className:"font-semibold mb-3",children:" :"}),k.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:M.map(N=>k.jsx("button",{onClick:()=>{t(N.id),m.current=0,i(0)},className:`py-2 px-3 rounded-lg text-sm font-medium transition-all ${e===N.id?"bg-gradient-to-r from-cyan-500 to-purple-500 text-white":n?"bg-gray-700 hover:bg-gray-600":"bg-gray-200 hover:bg-gray-300"}`,children:N.name},N.id))})]}),k.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[k.jsxs("div",{children:[k.jsxs("label",{className:"block text-sm font-semibold mb-3",children:["  (",(r*100).toFixed(0),"%)"]}),k.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:r,onChange:N=>{const R=parseFloat(N.target.value);i(R),m.current=R,l(!1)},className:"w-full"})]}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-sm font-semibold mb-3",children:" "}),k.jsxs("select",{value:s,onChange:N=>a(parseFloat(N.target.value)),className:`w-full px-3 py-2 rounded-lg border ${n?"bg-gray-800 border-gray-700":"bg-white border-gray-300"}`,children:[k.jsx("option",{value:.25,children:"0.25x"}),k.jsx("option",{value:.5,children:"0.5x"}),k.jsx("option",{value:1,children:"1x"}),k.jsx("option",{value:2,children:"2x"}),k.jsx("option",{value:3,children:"3x"})]})]})]}),k.jsxs("div",{className:"flex gap-3",children:[k.jsx("button",{onClick:()=>l(!o),className:`flex-1 py-3 px-4 rounded-xl font-bold transition-all ${o?"bg-gradient-to-r from-red-500 to-pink-500 text-white":"bg-gradient-to-r from-green-500 to-blue-500 text-white"}`,children:o?"  ":" "}),k.jsx("button",{onClick:()=>c(!u),className:`flex-1 py-3 px-4 rounded-xl font-bold transition-all ${u?"bg-gradient-to-r from-purple-500 to-pink-500 text-white":"bg-gradient-to-r from-gray-500 to-gray-600 text-white"}`,children:u?"  ":"  "})]})]}),k.jsxs(ct.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},className:`p-6 rounded-3xl border shadow-sm ${D}`,children:[k.jsx("h2",{className:"text-2xl font-bold mb-4",children:" "}),k.jsxs("div",{className:`space-y-2 text-sm ${n?"text-gray-300":"text-gray-600"}`,children:[k.jsxs("p",{children:[k.jsx("strong",{children:"9  3D :"}),"      "]}),k.jsxs("p",{children:[k.jsx("strong",{children:" :"}),"   3D     "]}),k.jsxs("p",{children:[k.jsx("strong",{children:" :"}),"       "]}),k.jsxs("p",{children:[k.jsx("strong",{children:" :"})," ,  ,     "]})]})]})]})}function li(){return li=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},li.apply(null,arguments)}var ate={relTol:1e-12,absTol:1e-15,matrix:"Matrix",number:"number",numberFallback:"number",precision:64,predictable:!1,randomSeed:null,legacySubset:!1};function Ea(n,e){if(ID(n,e))return n[e];throw typeof n[e]=="function"&&W4(n,e)?new Error('Cannot access method "'+e+'" as a property'):new Error('No access to property "'+e+'"')}function bb(n,e,t){if(ID(n,e))return n[e]=t,t;throw new Error('No access to property "'+e+'"')}function ID(n,e){return!eMe(n)&&!Array.isArray(n)?!1:vt(tMe,e)?!0:!(e in Object.prototype||e in Function.prototype)}function JTe(n,e){if(!W4(n,e))throw new Error('No access to method "'+e+'"');return n[e]}function W4(n,e){return n==null||typeof n[e]!="function"||vt(n,e)&&Object.getPrototypeOf&&e in Object.getPrototypeOf(n)?!1:vt(nMe,e)?!0:!(e in Object.prototype||e in Function.prototype)}function eMe(n){return typeof n=="object"&&n&&n.constructor===Object}var tMe={length:!0,name:!0},nMe={toString:!0,valueOf:!0,toLocaleString:!0};class DN{constructor(e){this.wrappedObject=e,this[Symbol.iterator]=this.entries}keys(){return Object.keys(this.wrappedObject).filter(e=>this.has(e)).values()}get(e){return Ea(this.wrappedObject,e)}set(e,t){return bb(this.wrappedObject,e,t),this}has(e){return ID(this.wrappedObject,e)&&e in this.wrappedObject}entries(){return lte(this.keys(),e=>[e,this.get(e)])}forEach(e){for(var t of this.keys())e(this.get(t),t,this)}delete(e){ID(this.wrappedObject,e)&&delete this.wrappedObject[e]}clear(){for(var e of this.keys())this.delete(e)}get size(){return Object.keys(this.wrappedObject).length}}class ote{constructor(e,t,r){this.a=e,this.b=t,this.bKeys=r,this[Symbol.iterator]=this.entries}get(e){return this.bKeys.has(e)?this.b.get(e):this.a.get(e)}set(e,t){return this.bKeys.has(e)?this.b.set(e,t):this.a.set(e,t),this}has(e){return this.b.has(e)||this.a.has(e)}keys(){return new Set([...this.a.keys(),...this.b.keys()])[Symbol.iterator]()}entries(){return lte(this.keys(),e=>[e,this.get(e)])}forEach(e){for(var t of this.keys())e(this.get(t),t,this)}delete(e){return this.bKeys.has(e)?this.b.delete(e):this.a.delete(e)}clear(){this.a.clear(),this.b.clear()}get size(){return[...this.keys()].length}}function lte(n,e){return{next:()=>{var t=n.next();return t.done?t:{value:e(t.value),done:!1}}}}function Nw(){return new Map}function Ty(n){if(!n)return Nw();if(hte(n))return n;if(RN(n))return new DN(n);throw new Error("createMap can create maps from objects or Maps")}function rMe(n){if(n instanceof DN)return n.wrappedObject;var e={};for(var t of n.keys()){var r=n.get(t);bb(e,t,r)}return e}function Tt(n){return typeof n=="number"}function jt(n){return!n||typeof n!="object"||typeof n.constructor!="function"?!1:n.isBigNumber===!0&&typeof n.constructor.prototype=="object"&&n.constructor.prototype.isBigNumber===!0||typeof n.constructor.isDecimal=="function"&&n.constructor.isDecimal(n)===!0}function O1(n){return typeof n=="bigint"}function Qh(n){return n&&typeof n=="object"&&Object.getPrototypeOf(n).isComplex===!0||!1}function sA(n){return n&&typeof n=="object"&&Object.getPrototypeOf(n).isFraction===!0||!1}function No(n){return n&&n.constructor.prototype.isUnit===!0||!1}function Jr(n){return typeof n=="string"}var Xn=Array.isArray;function Dt(n){return n&&n.constructor.prototype.isMatrix===!0||!1}function Vo(n){return Array.isArray(n)||Dt(n)}function PD(n){return n&&n.isDenseMatrix&&n.constructor.prototype.isMatrix===!0||!1}function Hm(n){return n&&n.isSparseMatrix&&n.constructor.prototype.isMatrix===!0||!1}function X4(n){return n&&n.constructor.prototype.isRange===!0||!1}function NN(n){return n&&n.constructor.prototype.isIndex===!0||!1}function iMe(n){return typeof n=="boolean"}function sMe(n){return n&&n.constructor.prototype.isResultSet===!0||!1}function ute(n){return n&&n.constructor.prototype.isHelp===!0||!1}function cte(n){return typeof n=="function"}function aMe(n){return n instanceof Date}function oMe(n){return n instanceof RegExp}function RN(n){return!!(n&&typeof n=="object"&&n.constructor===Object&&!Qh(n)&&!sA(n))}function hte(n){return n?n instanceof Map||n instanceof DN||typeof n.set=="function"&&typeof n.get=="function"&&typeof n.keys=="function"&&typeof n.has=="function":!1}function lMe(n){return n===null}function uMe(n){return n===void 0}function gd(n){return n&&n.isAccessorNode===!0&&n.constructor.prototype.isNode===!0||!1}function fl(n){return n&&n.isArrayNode===!0&&n.constructor.prototype.isNode===!0||!1}function cMe(n){return n&&n.isAssignmentNode===!0&&n.constructor.prototype.isNode===!0||!1}function hMe(n){return n&&n.isBlockNode===!0&&n.constructor.prototype.isNode===!0||!1}function dMe(n){return n&&n.isConditionalNode===!0&&n.constructor.prototype.isNode===!0||!1}function pn(n){return n&&n.isConstantNode===!0&&n.constructor.prototype.isNode===!0||!1}function yO(n){return pn(n)||ai(n)&&n.args.length===1&&pn(n.args[0])&&"-+~".includes(n.op)}function aA(n){return n&&n.isFunctionAssignmentNode===!0&&n.constructor.prototype.isNode===!0||!1}function Pp(n){return n&&n.isFunctionNode===!0&&n.constructor.prototype.isNode===!0||!1}function qb(n){return n&&n.isIndexNode===!0&&n.constructor.prototype.isNode===!0||!1}function zn(n){return n&&n.isNode===!0&&n.constructor.prototype.isNode===!0||!1}function IN(n){return n&&n.isObjectNode===!0&&n.constructor.prototype.isNode===!0||!1}function ai(n){return n&&n.isOperatorNode===!0&&n.constructor.prototype.isNode===!0||!1}function vd(n){return n&&n.isParenthesisNode===!0&&n.constructor.prototype.isNode===!0||!1}function fMe(n){return n&&n.isRangeNode===!0&&n.constructor.prototype.isNode===!0||!1}function pMe(n){return n&&n.isRelationalNode===!0&&n.constructor.prototype.isNode===!0||!1}function ss(n){return n&&n.isSymbolNode===!0&&n.constructor.prototype.isNode===!0||!1}function dte(n){return n&&n.constructor.prototype.isChain===!0||!1}function Yn(n){var e=typeof n;return e==="object"?n===null?"null":jt(n)?"BigNumber":n.constructor&&n.constructor.name?n.constructor.name:"Object":e}function Ut(n){var e=typeof n;if(e==="number"||e==="bigint"||e==="string"||e==="boolean"||n===null||n===void 0)return n;if(typeof n.clone=="function")return n.clone();if(Array.isArray(n))return n.map(function(t){return Ut(t)});if(n instanceof Date)return new Date(n.valueOf());if(jt(n))return n;if(RN(n))return mMe(n,Ut);if(e==="function")return n;throw new TypeError("Cannot clone: unknown type of value (value: ".concat(n,")"))}function mMe(n,e){var t={};for(var r in n)vt(n,r)&&(t[r]=e(n[r]));return t}function fte(n,e){for(var t in e)vt(e,t)&&(n[t]=e[t]);return n}function yd(n,e){var t,r,i;if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(r=0,i=n.length;r<i;r++)if(!yd(n[r],e[r]))return!1;return!0}else{if(typeof n=="function")return n===e;if(n instanceof Object){if(Array.isArray(e)||!(e instanceof Object))return!1;for(t in n)if(!(t in e)||!yd(n[t],e[t]))return!1;for(t in e)if(!(t in n))return!1;return!0}else return n===e}}function gMe(n,e,t){var r=!0,i;Object.defineProperty(n,e,{get:function(){return r&&(i=t(),r=!1),i},set:function(a){i=a,r=!1},configurable:!0,enumerable:!0})}function vt(n,e){return n&&Object.hasOwnProperty.call(n,e)}function vMe(n,e){for(var t={},r=0;r<e.length;r++){var i=e[r],s=n[i];s!==void 0&&(t[i]=s)}return t}var yMe=["Matrix","Array"],xMe=["number","BigNumber","bigint","Fraction"],Ve=function(e){if(e)throw new Error(`The global config is readonly. 
Please create a mathjs instance if you want to change the default configuration. 
Example:

  import { create, all } from 'mathjs';
  const mathjs = create(all);
  mathjs.config({ number: 'BigNumber' });
`);return Object.freeze(ate)};li(Ve,ate,{MATRIX_OPTIONS:yMe,NUMBER_OPTIONS:xMe});function Z9(){return!0}function Ko(){return!1}function x0(){}const J9="Argument is not a typed-function.";function pte(){function n(F){return typeof F=="object"&&F!==null&&F.constructor===Object}const e=[{name:"number",test:function(F){return typeof F=="number"}},{name:"string",test:function(F){return typeof F=="string"}},{name:"boolean",test:function(F){return typeof F=="boolean"}},{name:"Function",test:function(F){return typeof F=="function"}},{name:"Array",test:Array.isArray},{name:"Date",test:function(F){return F instanceof Date}},{name:"RegExp",test:function(F){return F instanceof RegExp}},{name:"Object",test:n},{name:"null",test:function(F){return F===null}},{name:"undefined",test:function(F){return F===void 0}}],t={name:"any",test:Z9,isAny:!0};let r,i,s=0,a={createCount:0};function o(F){const P=r.get(F);if(P)return P;let K='Unknown type "'+F+'"';const oe=F.toLowerCase();let pe;for(pe of i)if(pe.toLowerCase()===oe){K+='. Did you mean "'+pe+'" ?';break}throw new TypeError(K)}function l(F){let P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"any";const K=P?o(P).index:i.length,oe=[];for(let ce=0;ce<F.length;++ce){if(!F[ce]||typeof F[ce].name!="string"||typeof F[ce].test!="function")throw new TypeError("Object with properties {name: string, test: function} expected");const Te=F[ce].name;if(r.has(Te))throw new TypeError('Duplicate type name "'+Te+'"');oe.push(Te),r.set(Te,{name:Te,test:F[ce].test,isAny:F[ce].isAny,index:K+ce,conversionsTo:[]})}const pe=i.slice(K);i=i.slice(0,K).concat(oe).concat(pe);for(let ce=K+oe.length;ce<i.length;++ce)r.get(i[ce]).index=ce}function u(){r=new Map,i=[],s=0,l([t],!1)}u(),l(e);function c(){let F;for(F of i)r.get(F).conversionsTo=[];s=0}function h(F){const P=i.filter(K=>{const oe=r.get(K);return!oe.isAny&&oe.test(F)});return P.length?P:["any"]}function d(F){return F&&typeof F=="function"&&"_typedFunctionData"in F}function f(F,P,K){if(!d(F))throw new TypeError(J9);const oe=K&&K.exact,pe=Array.isArray(P)?P.join(","):P,ce=w(pe),Te=y(ce);if(!oe||Te in F.signatures){const Ne=F._typedFunctionData.signatureMap.get(Te);if(Ne)return Ne}const be=ce.length;let Pe;if(oe){Pe=[];let Ne;for(Ne in F.signatures)Pe.push(F._typedFunctionData.signatureMap.get(Ne))}else Pe=F._typedFunctionData.signatures;for(let Ne=0;Ne<be;++Ne){const ze=ce[Ne],Ke=[];let Ge;for(Ge of Pe){const qe=T(Ge.params,Ne);if(!(!qe||ze.restParam&&!qe.restParam)){if(!qe.hasAny){const z=x(qe);if(ze.types.some(W=>!z.has(W.name)))continue}Ke.push(Ge)}}if(Pe=Ke,Pe.length===0)break}let Me;for(Me of Pe)if(Me.params.length<=be)return Me;throw new TypeError("Signature not found (signature: "+(F.name||"unnamed")+"("+y(ce,", ")+"))")}function p(F,P,K){return f(F,P,K).implementation}function m(F,P){const K=o(P);if(K.test(F))return F;const oe=K.conversionsTo;if(oe.length===0)throw new Error("There are no conversions to "+P+" defined.");for(let pe=0;pe<oe.length;pe++)if(o(oe[pe].from).test(F))return oe[pe].convert(F);throw new Error("Cannot convert "+F+" to "+P)}function y(F){let P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:",";return F.map(K=>K.name).join(P)}function v(F){const P=F.indexOf("...")===0,oe=(P?F.length>3?F.slice(3):"any":F).split("|").map(be=>o(be.trim()));let pe=!1,ce=P?"...":"";return{types:oe.map(function(be){return pe=be.isAny||pe,ce+=be.name+"|",{name:be.name,typeIndex:be.index,test:be.test,isAny:be.isAny,conversion:null,conversionIndex:-1}}),name:ce.slice(0,-1),hasAny:pe,hasConversion:!1,restParam:P}}function b(F){const P=F.types.map(Te=>Te.name),K=B(P);let oe=F.hasAny,pe=F.name;const ce=K.map(function(Te){const be=o(Te.from);return oe=be.isAny||oe,pe+="|"+Te.from,{name:Te.from,typeIndex:be.index,test:be.test,isAny:be.isAny,conversion:Te,conversionIndex:Te.index}});return{types:F.types.concat(ce),name:pe,hasAny:oe,hasConversion:ce.length>0,restParam:F.restParam}}function x(F){return F.typeSet||(F.typeSet=new Set,F.types.forEach(P=>F.typeSet.add(P.name))),F.typeSet}function w(F){const P=[];if(typeof F!="string")throw new TypeError("Signatures must be strings");const K=F.trim();if(K==="")return P;const oe=K.split(",");for(let pe=0;pe<oe.length;++pe){const ce=v(oe[pe].trim());if(ce.restParam&&pe!==oe.length-1)throw new SyntaxError('Unexpected rest parameter "'+oe[pe]+'": only allowed for the last parameter');if(ce.types.length===0)return null;P.push(ce)}return P}function _(F){const P=Y(F);return P?P.restParam:!1}function E(F){if(!F||F.types.length===0)return Z9;if(F.types.length===1)return o(F.types[0].name).test;if(F.types.length===2){const P=o(F.types[0].name).test,K=o(F.types[1].name).test;return function(pe){return P(pe)||K(pe)}}else{const P=F.types.map(function(K){return o(K.name).test});return function(oe){for(let pe=0;pe<P.length;pe++)if(P[pe](oe))return!0;return!1}}}function A(F){let P,K,oe;if(_(F)){P=te(F).map(E);const pe=P.length,ce=E(Y(F)),Te=function(be){for(let Pe=pe;Pe<be.length;Pe++)if(!ce(be[Pe]))return!1;return!0};return function(Pe){for(let Me=0;Me<P.length;Me++)if(!P[Me](Pe[Me]))return!1;return Te(Pe)&&Pe.length>=pe+1}}else return F.length===0?function(ce){return ce.length===0}:F.length===1?(K=E(F[0]),function(ce){return K(ce[0])&&ce.length===1}):F.length===2?(K=E(F[0]),oe=E(F[1]),function(ce){return K(ce[0])&&oe(ce[1])&&ce.length===2}):(P=F.map(E),function(ce){for(let Te=0;Te<P.length;Te++)if(!P[Te](ce[Te]))return!1;return ce.length===P.length})}function T(F,P){return P<F.length?F[P]:_(F)?Y(F):null}function S(F,P){const K=T(F,P);return K?x(K):new Set}function M(F){return F.conversion===null||F.conversion===void 0}function D(F,P){const K=new Set;return F.forEach(oe=>{const pe=S(oe.params,P);let ce;for(ce of pe)K.add(ce)}),K.has("any")?["any"]:Array.from(K)}function N(F,P,K){let oe,pe;const ce=F||"unnamed";let Te=K,be;for(be=0;be<P.length;be++){const ze=[];if(Te.forEach(Ke=>{const Ge=T(Ke.params,be),qe=E(Ge);(be<Ke.params.length||_(Ke.params))&&qe(P[be])&&ze.push(Ke)}),ze.length===0){if(pe=D(Te,be),pe.length>0){const Ke=h(P[be]);return oe=new TypeError("Unexpected type of argument in function "+ce+" (expected: "+pe.join(" or ")+", actual: "+Ke.join(" | ")+", index: "+be+")"),oe.data={category:"wrongType",fn:ce,index:be,actual:Ke,expected:pe},oe}}else Te=ze}const Pe=Te.map(function(ze){return _(ze.params)?1/0:ze.params.length});if(P.length<Math.min.apply(null,Pe))return pe=D(Te,be),oe=new TypeError("Too few arguments in function "+ce+" (expected: "+pe.join(" or ")+", index: "+P.length+")"),oe.data={category:"tooFewArgs",fn:ce,index:P.length,expected:pe},oe;const Me=Math.max.apply(null,Pe);if(P.length>Me)return oe=new TypeError("Too many arguments in function "+ce+" (expected: "+Me+", actual: "+P.length+")"),oe.data={category:"tooManyArgs",fn:ce,index:P.length,expectedLength:Me},oe;const Ne=[];for(let ze=0;ze<P.length;++ze)Ne.push(h(P[ze]).join("|"));return oe=new TypeError('Arguments of type "'+Ne.join(", ")+'" do not match any of the defined signatures of function '+ce+"."),oe.data={category:"mismatch",actual:Ne},oe}function R(F){let P=i.length+1;for(let K=0;K<F.types.length;K++)P=Math.min(P,F.types[K].typeIndex);return P}function O(F){let P=s+1;for(let K=0;K<F.types.length;K++)M(F.types[K])||(P=Math.min(P,F.types[K].conversionIndex));return P}function G(F,P){if(F.hasAny){if(!P.hasAny)return .1}else if(P.hasAny)return-.1;if(F.restParam){if(!P.restParam)return .01}else if(P.restParam)return-.01;const K=R(F)-R(P);if(K<0)return-.001;if(K>0)return .001;const oe=O(F),pe=O(P);if(F.hasConversion){if(!P.hasConversion)return(1+oe)*1e-6}else if(P.hasConversion)return-(1+pe)*1e-6;const ce=oe-pe;return ce<0?-1e-7:ce>0?1e-7:0}function I(F,P){const K=F.params,oe=P.params,pe=Y(K),ce=Y(oe),Te=_(K),be=_(oe);if(Te&&pe.hasAny){if(!be||!ce.hasAny)return 1e7}else if(be&&ce.hasAny)return-1e7;let Pe=0,Me=0,Ne;for(Ne of K)Ne.hasAny&&++Pe,Ne.hasConversion&&++Me;let ze=0,Ke=0;for(Ne of oe)Ne.hasAny&&++ze,Ne.hasConversion&&++Ke;if(Pe!==ze)return(Pe-ze)*1e6;if(Te&&pe.hasConversion){if(!be||!ce.hasConversion)return 1e5}else if(be&&ce.hasConversion)return-1e5;if(Me!==Ke)return(Me-Ke)*1e4;if(Te){if(!be)return 1e3}else if(be)return-1e3;const Ge=(K.length-oe.length)*(Te?-100:100);if(Ge!==0)return Ge;const qe=[];let z=0;for(let Fe=0;Fe<K.length;++Fe){const Le=G(K[Fe],oe[Fe]);qe.push(Le),z+=Le}if(z!==0)return(z<0?-10:10)+z;let W,ye=9;const Ee=ye/(qe.length+1);for(W of qe){if(W!==0)return(W<0?-ye:ye)+W;ye-=Ee}return 0}function B(F){if(F.length===0)return[];const P=F.map(o);if(F.length===1)return P[0].conversionsTo;const K=new Set(F),oe=new Set;for(let ce=0;ce<P.length;++ce)for(const Te of P[ce].conversionsTo)K.has(Te.from)||oe.add(Te.from);const pe=[];for(const ce of oe){let Te=s+1,be=null;for(let Pe=0;Pe<P.length;++Pe)for(const Me of P[Pe].conversionsTo)Me.from===ce&&Me.index<Te&&(Te=Me.index,be=Me);pe.push(be)}return pe}function $(F,P){let K=P,oe="";if(F.some(ce=>ce.hasConversion)){const ce=_(F),Te=F.map(H);oe=Te.map(be=>be.name).join(";"),K=function(){const Pe=[],Me=ce?arguments.length-1:arguments.length;for(let Ne=0;Ne<Me;Ne++)Pe[Ne]=Te[Ne](arguments[Ne]);return ce&&(Pe[Me]=arguments[Me].map(Te[Me])),P.apply(this,Pe)}}let pe=K;if(_(F)){const ce=F.length-1;pe=function(){return K.apply(this,ie(arguments,0,ce).concat([ie(arguments,ce)]))}}return oe&&Object.defineProperty(pe,"name",{value:oe}),pe}function H(F){let P,K,oe,pe;const ce=[],Te=[];let be="";F.types.forEach(function(Me){Me.conversion&&(be+=Me.conversion.from+"~>"+Me.conversion.to+",",ce.push(o(Me.conversion.from).test),Te.push(Me.conversion.convert))}),be?be=be.slice(0,-1):be="pass";let Pe=Me=>Me;switch(Te.length){case 0:break;case 1:P=ce[0],oe=Te[0],Pe=function(Ne){return P(Ne)?oe(Ne):Ne};break;case 2:P=ce[0],K=ce[1],oe=Te[0],pe=Te[1],Pe=function(Ne){return P(Ne)?oe(Ne):K(Ne)?pe(Ne):Ne};break;default:Pe=function(Ne){for(let ze=0;ze<Te.length;ze++)if(ce[ze](Ne))return Te[ze](Ne);return Ne}}return Object.defineProperty(Pe,"name",{value:be}),Pe}function Q(F){function P(K,oe,pe){if(oe<K.length){const ce=K[oe];let Te=[];if(ce.restParam){const be=ce.types.filter(M);be.length<ce.types.length&&Te.push({types:be,name:"..."+be.map(Pe=>Pe.name).join("|"),hasAny:be.some(Pe=>Pe.isAny),hasConversion:!1,restParam:!0}),Te.push(ce)}else Te=ce.types.map(function(be){return{types:[be],name:be.name,hasAny:be.isAny,hasConversion:be.conversion,restParam:!1}});return ge(Te,function(be){return P(K,oe+1,pe.concat([be]))})}else return[pe]}return P(F,0,[])}function ee(F,P){const K=Math.max(F.length,P.length);for(let be=0;be<K;be++){const Pe=S(F,be),Me=S(P,be);let Ne=!1,ze;for(ze of Me)if(Pe.has(ze)){Ne=!0;break}if(!Ne)return!1}const oe=F.length,pe=P.length,ce=_(F),Te=_(P);return ce?Te?oe===pe:pe>=oe:Te?oe>=pe:oe===pe}function J(F){return F.map(P=>nt(P)?Be(P.referToSelf.callback):$e(P)?we(P.referTo.references,P.referTo.callback):P)}function L(F,P,K){const oe=[];let pe;for(pe of F){let ce=K[pe];if(typeof ce!="number")throw new TypeError('No definition for referenced signature "'+pe+'"');if(ce=P[ce],typeof ce!="function")return!1;oe.push(ce)}return oe}function se(F,P,K){const oe=J(F),pe=new Array(oe.length).fill(!1);let ce=!0;for(;ce;){ce=!1;let Te=!0;for(let be=0;be<oe.length;++be){if(pe[be])continue;const Pe=oe[be];if(nt(Pe))oe[be]=Pe.referToSelf.callback(K),oe[be].referToSelf=Pe.referToSelf,pe[be]=!0,Te=!1;else if($e(Pe)){const Me=L(Pe.referTo.references,oe,P);Me?(oe[be]=Pe.referTo.callback.apply(this,Me),oe[be].referTo=Pe.referTo,pe[be]=!0,Te=!1):ce=!0}}if(Te&&ce)throw new SyntaxError("Circular reference detected in resolving typed.referTo")}return oe}function Z(F){const P=/\bthis(\(|\.signatures\b)/;Object.keys(F).forEach(K=>{const oe=F[K];if(P.test(oe.toString()))throw new SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")})}function le(F,P){if(a.createCount++,Object.keys(P).length===0)throw new SyntaxError("No signatures provided");a.warnAgainstDeprecatedThis&&Z(P);const K=[],oe=[],pe={},ce=[];let Te;for(Te in P){if(!Object.prototype.hasOwnProperty.call(P,Te))continue;const bn=w(Te);if(!bn)continue;K.forEach(function(Re){if(ee(Re,bn))throw new TypeError('Conflicting signatures "'+y(Re)+'" and "'+y(bn)+'".')}),K.push(bn);const ne=oe.length;oe.push(P[Te]);const Se=bn.map(b);let Ie;for(Ie of Q(Se)){const Re=y(Ie);ce.push({params:Ie,name:Re,fn:ne}),Ie.every(Ce=>!Ce.hasConversion)&&(pe[Re]=ne)}}ce.sort(I);const be=se(oe,pe,la);let Pe;for(Pe in pe)Object.prototype.hasOwnProperty.call(pe,Pe)&&(pe[Pe]=be[pe[Pe]]);const Me=[],Ne=new Map;for(Pe of ce)Ne.has(Pe.name)||(Pe.fn=be[Pe.fn],Me.push(Pe),Ne.set(Pe.name,Pe));const ze=Me[0]&&Me[0].params.length<=2&&!_(Me[0].params),Ke=Me[1]&&Me[1].params.length<=2&&!_(Me[1].params),Ge=Me[2]&&Me[2].params.length<=2&&!_(Me[2].params),qe=Me[3]&&Me[3].params.length<=2&&!_(Me[3].params),z=Me[4]&&Me[4].params.length<=2&&!_(Me[4].params),W=Me[5]&&Me[5].params.length<=2&&!_(Me[5].params),ye=ze&&Ke&&Ge&&qe&&z&&W;for(let bn=0;bn<Me.length;++bn)Me[bn].test=A(Me[bn].params);const Ee=ze?E(Me[0].params[0]):Ko,Fe=Ke?E(Me[1].params[0]):Ko,Le=Ge?E(Me[2].params[0]):Ko,Ue=qe?E(Me[3].params[0]):Ko,tt=z?E(Me[4].params[0]):Ko,Pt=W?E(Me[5].params[0]):Ko,Vn=ze?E(Me[0].params[1]):Ko,dn=Ke?E(Me[1].params[1]):Ko,Ia=Ge?E(Me[2].params[1]):Ko,ro=qe?E(Me[3].params[1]):Ko,Sd=z?E(Me[4].params[1]):Ko,im=W?E(Me[5].params[1]):Ko;for(let bn=0;bn<Me.length;++bn)Me[bn].implementation=$(Me[bn].params,Me[bn].fn);const Ad=ze?Me[0].implementation:x0,sm=Ke?Me[1].implementation:x0,Eu=Ge?Me[2].implementation:x0,Qv=qe?Me[3].implementation:x0,Hi=z?Me[4].implementation:x0,Td=W?Me[5].implementation:x0,am=ze?Me[0].params.length:-1,Md=Ke?Me[1].params.length:-1,Su=Ge?Me[2].params.length:-1,om=qe?Me[3].params.length:-1,Cd=z?Me[4].params.length:-1,lm=W?Me[5].params.length:-1,Zv=ye?6:0,Dd=Me.length,Jv=Me.map(bn=>bn.test),um=Me.map(bn=>bn.implementation),kc=function(){for(let ne=Zv;ne<Dd;ne++)if(Jv[ne](arguments))return um[ne].apply(this,arguments);return a.onMismatch(F,arguments,Me)};function la(bn,ne){return arguments.length===am&&Ee(bn)&&Vn(ne)?Ad.apply(this,arguments):arguments.length===Md&&Fe(bn)&&dn(ne)?sm.apply(this,arguments):arguments.length===Su&&Le(bn)&&Ia(ne)?Eu.apply(this,arguments):arguments.length===om&&Ue(bn)&&ro(ne)?Qv.apply(this,arguments):arguments.length===Cd&&tt(bn)&&Sd(ne)?Hi.apply(this,arguments):arguments.length===lm&&Pt(bn)&&im(ne)?Td.apply(this,arguments):kc.apply(this,arguments)}try{Object.defineProperty(la,"name",{value:F})}catch{}return la.signatures=pe,la._typedFunctionData={signatures:Me,signatureMap:Ne},la}function ue(F,P,K){throw N(F,P,K)}function te(F){return ie(F,0,F.length-1)}function Y(F){return F[F.length-1]}function ie(F,P,K){return Array.prototype.slice.call(F,P,K)}function ve(F,P){for(let K=0;K<F.length;K++)if(P(F[K]))return F[K]}function ge(F,P){return Array.prototype.concat.apply([],F.map(P))}function _e(){const F=te(arguments).map(K=>y(w(K))),P=Y(arguments);if(typeof P!="function")throw new TypeError("Callback function expected as last argument");return we(F,P)}function we(F,P){return{referTo:{references:F,callback:P}}}function Be(F){if(typeof F!="function")throw new TypeError("Callback function expected as first argument");return{referToSelf:{callback:F}}}function $e(F){return F&&typeof F.referTo=="object"&&Array.isArray(F.referTo.references)&&typeof F.referTo.callback=="function"}function nt(F){return F&&typeof F.referToSelf=="object"&&typeof F.referToSelf.callback=="function"}function de(F,P){if(!F)return P;if(P&&P!==F){const K=new Error("Function names do not match (expected: "+F+", actual: "+P+")");throw K.data={actual:P,expected:F},K}return F}function Ye(F){let P;for(const K in F)Object.prototype.hasOwnProperty.call(F,K)&&(d(F[K])||typeof F[K].signature=="string")&&(P=de(P,F[K].name));return P}function Xe(F,P){let K;for(K in P)if(Object.prototype.hasOwnProperty.call(P,K)){if(K in F&&P[K]!==F[K]){const oe=new Error('Signature "'+K+'" is defined twice');throw oe.data={signature:K,sourceFunction:P[K],destFunction:F[K]},oe}F[K]=P[K]}}const ae=a;a=function(F){const P=typeof F=="string",K=P?1:0;let oe=P?F:"";const pe={};for(let ce=K;ce<arguments.length;++ce){const Te=arguments[ce];let be={},Pe;if(typeof Te=="function"?(Pe=Te.name,typeof Te.signature=="string"?be[Te.signature]=Te:d(Te)&&(be=Te.signatures)):n(Te)&&(be=Te,P||(Pe=Ye(Te))),Object.keys(be).length===0){const Me=new TypeError("Argument to 'typed' at index "+ce+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw Me.data={index:ce,argument:Te},Me}P||(oe=de(oe,Pe)),Xe(pe,be)}return le(oe||"",pe)},a.create=pte,a.createCount=ae.createCount,a.onMismatch=ue,a.throwMismatchError=ue,a.createError=N,a.clear=u,a.clearConversions=c,a.addTypes=l,a._findType=o,a.referTo=_e,a.referToSelf=Be,a.convert=m,a.findSignature=f,a.find=p,a.isTypedFunction=d,a.warnAgainstDeprecatedThis=!0,a.addType=function(F,P){let K="any";P!==!1&&r.has("Object")&&(K="Object"),a.addTypes([F],K)};function fe(F){if(!F||typeof F.from!="string"||typeof F.to!="string"||typeof F.convert!="function")throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");if(F.to===F.from)throw new SyntaxError('Illegal to define conversion from "'+F.from+'" to itself.')}return a.addConversion=function(F){let P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{override:!1};fe(F);const K=o(F.to),oe=K.conversionsTo.find(pe=>pe.from===F.from);if(oe)if(P&&P.override)a.removeConversion({from:oe.from,to:F.to,convert:oe.convert});else throw new Error('There is already a conversion from "'+F.from+'" to "'+K.name+'"');K.conversionsTo.push({from:F.from,to:K.name,convert:F.convert,index:s++})},a.addConversions=function(F,P){F.forEach(K=>a.addConversion(K,P))},a.removeConversion=function(F){fe(F);const P=o(F.to),K=ve(P.conversionsTo,pe=>pe.from===F.from);if(!K)throw new Error("Attempt to remove nonexistent conversion from "+F.from+" to "+F.to);if(K.convert!==F.convert)throw new Error("Conversion to remove does not match existing conversion");const oe=P.conversionsTo.indexOf(K);P.conversionsTo.splice(oe,1)},a.resolve=function(F,P){if(!d(F))throw new TypeError(J9);const K=F._typedFunctionData.signatures;for(let oe=0;oe<K.length;++oe)if(K[oe].test(P))return K[oe];return null},a}const FD=pte();function re(n,e,t,r){function i(s){var a=vMe(s,e.map(wMe));return bMe(n,e,s),t(a)}return i.isFactory=!0,i.fn=n,i.dependencies=e.slice().sort(),r&&(i.meta=r),i}function bMe(n,e,t){var r=e.filter(s=>!_Me(s)).every(s=>t[s]!==void 0);if(!r){var i=e.filter(s=>t[s]===void 0);throw new Error('Cannot create function "'.concat(n,'", ')+"some dependencies are missing: ".concat(i.map(s=>'"'.concat(s,'"')).join(", "),"."))}}function _Me(n){return n&&n[0]==="?"}function wMe(n){return n&&n[0]==="?"?n.slice(1):n}function bt(n){return typeof n=="boolean"?!0:Number.isFinite(n)?n===Math.round(n):!1}function Wp(n,e){if(e.number==="bigint")try{BigInt(n)}catch{return e.numberFallback}return e.number}var tp=Math.sign||function(n){return n>0?1:n<0?-1:0},EMe=Math.log2||function(e){return Math.log(e)/Math.LN2},SMe=Math.log10||function(e){return Math.log(e)/Math.LN10},AMe=Math.log1p||function(n){return Math.log(n+1)},TMe=Math.cbrt||function(e){if(e===0)return e;var t=e<0,r;return t&&(e=-e),Number.isFinite(e)?(r=Math.exp(Math.log(e)/3),r=(e/(r*r)+2*r)/3):r=e,t?-r:r},MMe=Math.expm1||function(e){return e>=2e-4||e<=-2e-4?Math.exp(e)-1:e+e*e/2+e*e*e/6};function XI(n,e,t){var r={2:"0b",8:"0o",16:"0x"},i=r[e],s="";if(t){if(t<1)throw new Error("size must be in greater than 0");if(!bt(t))throw new Error("size must be an integer");if(n>2**(t-1)-1||n<-(2**(t-1)))throw new Error("Value must be in range [-2^".concat(t-1,", 2^").concat(t-1,"-1]"));if(!bt(n))throw new Error("Value must be an integer");n<0&&(n=n+2**t),s="i".concat(t)}var a="";return n<0&&(n=-n,a="-"),"".concat(a).concat(i).concat(n.toString(e)).concat(s)}function dv(n,e){if(typeof e=="function")return e(n);if(n===1/0)return"Infinity";if(n===-1/0)return"-Infinity";if(isNaN(n))return"NaN";var{notation:t,precision:r,wordSize:i}=mte(e);switch(t){case"fixed":return gte(n,r);case"exponential":return vte(n,r);case"engineering":return CMe(n,r);case"bin":return XI(n,2,i);case"oct":return XI(n,8,i);case"hex":return XI(n,16,i);case"auto":return DMe(n,r,e).replace(/((\.\d*?)(0+))($|e)/,function(){var s=arguments[2],a=arguments[4];return s!=="."?s+a:a});default:throw new Error('Unknown notation "'+t+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function mte(n){var e="auto",t,r;if(n!==void 0)if(Tt(n))t=n;else if(jt(n))t=n.toNumber();else if(RN(n))n.precision!==void 0&&(t=e$(n.precision,()=>{throw new Error('Option "precision" must be a number or BigNumber')})),n.wordSize!==void 0&&(r=e$(n.wordSize,()=>{throw new Error('Option "wordSize" must be a number or BigNumber')})),n.notation&&(e=n.notation);else throw new Error("Unsupported type of options, number, BigNumber, or object expected");return{notation:e,precision:t,wordSize:r}}function oA(n){var e=String(n).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw new SyntaxError("Invalid number "+n);var t=e[1],r=e[2],i=parseFloat(e[4]||"0"),s=r.indexOf(".");i+=s!==-1?s-1:r.length-1;var a=r.replace(".","").replace(/^0*/,function(o){return i-=o.length,""}).replace(/0*$/,"").split("").map(function(o){return parseInt(o)});return a.length===0&&(a.push(0),i++),{sign:t,coefficients:a,exponent:i}}function CMe(n,e){if(isNaN(n)||!Number.isFinite(n))return String(n);var t=oA(n),r=PN(t,e),i=r.exponent,s=r.coefficients,a=i%3===0?i:i<0?i-3-i%3:i-i%3;if(Tt(e))for(;e>s.length||i-a+1>s.length;)s.push(0);else for(var o=Math.abs(i-a)-(s.length-1),l=0;l<o;l++)s.push(0);for(var u=Math.abs(i-a),c=1;u>0;)c++,u--;var h=s.slice(c).join(""),d=Tt(e)&&h.length||h.match(/[1-9]/)?"."+h:"",f=s.slice(0,c).join("")+d+"e"+(i>=0?"+":"")+a.toString();return r.sign+f}function gte(n,e){if(isNaN(n)||!Number.isFinite(n))return String(n);var t=oA(n),r=typeof e=="number"?PN(t,t.exponent+1+e):t,i=r.coefficients,s=r.exponent+1,a=s+(e||0);return i.length<a&&(i=i.concat(My(a-i.length))),s<0&&(i=My(-s+1).concat(i),s=1),s<i.length&&i.splice(s,0,s===0?"0.":"."),r.sign+i.join("")}function vte(n,e){if(isNaN(n)||!Number.isFinite(Number(n)))return String(n);var t=oA(n),r=e?PN(t,e):t,i=r.coefficients,s=r.exponent;i.length<e&&(i=i.concat(My(e-i.length)));var a=i.shift();return r.sign+a+(i.length>0?"."+i.join(""):"")+"e"+(s>=0?"+":"")+s}function DMe(n,e,t){if(isNaN(n)||!Number.isFinite(n))return String(n);var r=t$(t==null?void 0:t.lowerExp,-3),i=t$(t==null?void 0:t.upperExp,5),s=oA(n),a=e?PN(s,e):s;if(a.exponent<r||a.exponent>=i)return vte(n,e);var o=a.coefficients,l=a.exponent;o.length<e&&(o=o.concat(My(e-o.length))),o=o.concat(My(l-o.length+1+(o.length<e?e-o.length:0))),o=My(-l).concat(o);var u=l>0?l:0;return u<o.length-1&&o.splice(u+1,0,"."),a.sign+o.join("")}function PN(n,e){for(var t={sign:n.sign,coefficients:n.coefficients,exponent:n.exponent},r=t.coefficients;e<=0;)r.unshift(0),t.exponent++,e++;if(r.length>e){var i=r.splice(e,r.length-e);if(i[0]>=5){var s=e-1;for(r[s]++;r[s]===10;)r.pop(),s===0&&(r.unshift(0),t.exponent++,s++),s--,r[s]++}}return t}function My(n){for(var e=[],t=0;t<n;t++)e.push(0);return e}function NMe(n){return n.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length}function os(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e-8,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(t<=0)throw new Error("Relative tolerance must be greater than 0");if(r<0)throw new Error("Absolute tolerance must be at least 0");return isNaN(n)||isNaN(e)?!1:!Number.isFinite(n)||!Number.isFinite(e)?n===e:n===e?!0:Math.abs(n-e)<=Math.max(t*Math.max(Math.abs(n),Math.abs(e)),r)}var RMe=Math.acosh||function(n){return Math.log(Math.sqrt(n*n-1)+n)},IMe=Math.asinh||function(n){return Math.log(Math.sqrt(n*n+1)+n)},PMe=Math.atanh||function(n){return Math.log((1+n)/(1-n))/2},FMe=Math.cosh||function(n){return(Math.exp(n)+Math.exp(-n))/2},LMe=Math.sinh||function(n){return(Math.exp(n)-Math.exp(-n))/2},OMe=Math.tanh||function(n){var e=Math.exp(2*n);return(e-1)/(e+1)};function kMe(n,e){var t=!0,r=e>0?!0:e<0?!1:1/e===1/0;return t^r?-n:n}function e$(n,e){if(Tt(n))return n;if(jt(n))return n.toNumber();e()}function t$(n,e){return Tt(n)?n:jt(n)?n.toNumber():e}var yte=function(){return yte=FD.create,FD},BMe=["?BigNumber","?Complex","?DenseMatrix","?Fraction"],UMe=re("typed",BMe,function(e){var{BigNumber:t,Complex:r,DenseMatrix:i,Fraction:s}=e,a=yte();return a.clear(),a.addTypes([{name:"number",test:Tt},{name:"Complex",test:Qh},{name:"BigNumber",test:jt},{name:"bigint",test:O1},{name:"Fraction",test:sA},{name:"Unit",test:No},{name:"identifier",test:o=>Jr&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(o)},{name:"string",test:Jr},{name:"Chain",test:dte},{name:"Array",test:Xn},{name:"Matrix",test:Dt},{name:"DenseMatrix",test:PD},{name:"SparseMatrix",test:Hm},{name:"Range",test:X4},{name:"Index",test:NN},{name:"boolean",test:iMe},{name:"ResultSet",test:sMe},{name:"Help",test:ute},{name:"function",test:cte},{name:"Date",test:aMe},{name:"RegExp",test:oMe},{name:"null",test:lMe},{name:"undefined",test:uMe},{name:"AccessorNode",test:gd},{name:"ArrayNode",test:fl},{name:"AssignmentNode",test:cMe},{name:"BlockNode",test:hMe},{name:"ConditionalNode",test:dMe},{name:"ConstantNode",test:pn},{name:"FunctionNode",test:Pp},{name:"FunctionAssignmentNode",test:aA},{name:"IndexNode",test:qb},{name:"Node",test:zn},{name:"ObjectNode",test:IN},{name:"OperatorNode",test:ai},{name:"ParenthesisNode",test:vd},{name:"RangeNode",test:fMe},{name:"RelationalNode",test:pMe},{name:"SymbolNode",test:ss},{name:"Map",test:hte},{name:"Object",test:RN}]),a.addConversions([{from:"number",to:"BigNumber",convert:function(l){if(t||PT(l),NMe(l)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+l+"). Use function bignumber(x) to convert to BigNumber.");return new t(l)}},{from:"number",to:"Complex",convert:function(l){return r||FT(l),new r(l,0)}},{from:"BigNumber",to:"Complex",convert:function(l){return r||FT(l),new r(l.toNumber(),0)}},{from:"bigint",to:"number",convert:function(l){if(l>Number.MAX_SAFE_INTEGER)throw new TypeError("Cannot implicitly convert bigint to number: value exceeds the max safe integer value (value: "+l+")");return Number(l)}},{from:"bigint",to:"BigNumber",convert:function(l){return t||PT(l),new t(l.toString())}},{from:"bigint",to:"Fraction",convert:function(l){return s||LT(l),new s(l)}},{from:"Fraction",to:"BigNumber",convert:function(l){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(l){return r||FT(l),new r(l.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(l){s||LT(l);var u=new s(l);if(u.valueOf()!==l)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+l+"). Use function fraction(x) to convert to Fraction.");return u}},{from:"string",to:"number",convert:function(l){var u=Number(l);if(isNaN(u))throw new Error('Cannot convert "'+l+'" to a number');return u}},{from:"string",to:"BigNumber",convert:function(l){t||PT(l);try{return new t(l)}catch{throw new Error('Cannot convert "'+l+'" to BigNumber')}}},{from:"string",to:"bigint",convert:function(l){try{return BigInt(l)}catch{throw new Error('Cannot convert "'+l+'" to BigInt')}}},{from:"string",to:"Fraction",convert:function(l){s||LT(l);try{return new s(l)}catch{throw new Error('Cannot convert "'+l+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(l){r||FT(l);try{return new r(l)}catch{throw new Error('Cannot convert "'+l+'" to Complex')}}},{from:"boolean",to:"number",convert:function(l){return+l}},{from:"boolean",to:"BigNumber",convert:function(l){return t||PT(l),new t(+l)}},{from:"boolean",to:"bigint",convert:function(l){return BigInt(+l)}},{from:"boolean",to:"Fraction",convert:function(l){return s||LT(l),new s(+l)}},{from:"boolean",to:"string",convert:function(l){return String(l)}},{from:"Array",to:"Matrix",convert:function(l){return i||VMe(),new i(l)}},{from:"Matrix",to:"Array",convert:function(l){return l.valueOf()}}]),a.onMismatch=(o,l,u)=>{var c=a.createError(o,l,u);if(["wrongType","mismatch"].includes(c.data.category)&&l.length===1&&Vo(l[0])&&u.some(d=>!d.params.includes(","))){var h=new TypeError("Function '".concat(o,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(o,")'."));throw h.data=c.data,h}throw c},a.onMismatch=(o,l,u)=>{var c=a.createError(o,l,u);if(["wrongType","mismatch"].includes(c.data.category)&&l.length===1&&Vo(l[0])&&u.some(d=>!d.params.includes(","))){var h=new TypeError("Function '".concat(o,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(o,")'."));throw h.data=c.data,h}throw c},a});function PT(n){throw new Error("Cannot convert value ".concat(n," into a BigNumber: no class 'BigNumber' provided"))}function FT(n){throw new Error("Cannot convert value ".concat(n," into a Complex number: no class 'Complex' provided"))}function VMe(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}function LT(n){throw new Error("Cannot convert value ".concat(n," into a Fraction, no class 'Fraction' provided."))}var zMe="ResultSet",$Me=[],HMe=re(zMe,$Me,()=>{function n(e){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this.entries=e||[]}return n.prototype.type="ResultSet",n.prototype.isResultSet=!0,n.prototype.valueOf=function(){return this.entries},n.prototype.toString=function(){return"["+this.entries.map(String).join(", ")+"]"},n.prototype.toJSON=function(){return{mathjs:"ResultSet",entries:this.entries}},n.fromJSON=function(e){return new n(e.entries)},n},{isClass:!0});/*!
 *  decimal.js v10.6.0
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var sy=9e15,Xp=1e9,xO="0123456789abcdef",LD="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",OD="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",bO={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-sy,maxE:sy,crypto:!1},xte,Hh,Ht=!0,FN="[DecimalError] ",Fp=FN+"Invalid argument: ",bte=FN+"Precision limit exceeded",_te=FN+"crypto unavailable",wte="[object Decimal]",ra=Math.floor,Ri=Math.pow,GMe=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,jMe=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,qMe=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Ete=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,du=1e7,Nt=7,WMe=9007199254740991,XMe=LD.length-1,_O=OD.length-1,We={toStringTag:wte};We.absoluteValue=We.abs=function(){var n=new this.constructor(this);return n.s<0&&(n.s=1),Mt(n)};We.ceil=function(){return Mt(new this.constructor(this),this.e+1,2)};We.clampedTo=We.clamp=function(n,e){var t,r=this,i=r.constructor;if(n=new i(n),e=new i(e),!n.s||!e.s)return new i(NaN);if(n.gt(e))throw Error(Fp+e);return t=r.cmp(n),t<0?n:r.cmp(e)>0?e:new i(r)};We.comparedTo=We.cmp=function(n){var e,t,r,i,s=this,a=s.d,o=(n=new s.constructor(n)).d,l=s.s,u=n.s;if(!a||!o)return!l||!u?NaN:l!==u?l:a===o?0:!a^l<0?1:-1;if(!a[0]||!o[0])return a[0]?l:o[0]?-u:0;if(l!==u)return l;if(s.e!==n.e)return s.e>n.e^l<0?1:-1;for(r=a.length,i=o.length,e=0,t=r<i?r:i;e<t;++e)if(a[e]!==o[e])return a[e]>o[e]^l<0?1:-1;return r===i?0:r>i^l<0?1:-1};We.cosine=We.cos=function(){var n,e,t=this,r=t.constructor;return t.d?t.d[0]?(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+Nt,r.rounding=1,t=KMe(r,Cte(r,t)),r.precision=n,r.rounding=e,Mt(Hh==2||Hh==3?t.neg():t,n,e,!0)):new r(1):new r(NaN)};We.cubeRoot=We.cbrt=function(){var n,e,t,r,i,s,a,o,l,u,c=this,h=c.constructor;if(!c.isFinite()||c.isZero())return new h(c);for(Ht=!1,s=c.s*Ri(c.s*c,1/3),!s||Math.abs(s)==1/0?(t=As(c.d),n=c.e,(s=(n-t.length+1)%3)&&(t+=s==1||s==-2?"0":"00"),s=Ri(t,1/3),n=ra((n+1)/3)-(n%3==(n<0?-1:2)),s==1/0?t="5e"+n:(t=s.toExponential(),t=t.slice(0,t.indexOf("e")+1)+n),r=new h(t),r.s=c.s):r=new h(s.toString()),a=(n=h.precision)+3;;)if(o=r,l=o.times(o).times(o),u=l.plus(c),r=pr(u.plus(c).times(o),u.plus(l),a+2,1),As(o.d).slice(0,a)===(t=As(r.d)).slice(0,a))if(t=t.slice(a-3,a+1),t=="9999"||!i&&t=="4999"){if(!i&&(Mt(o,n+1,0),o.times(o).times(o).eq(c))){r=o;break}a+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(Mt(r,n+1,1),e=!r.times(r).times(r).eq(c));break}return Ht=!0,Mt(r,n,h.rounding,e)};We.decimalPlaces=We.dp=function(){var n,e=this.d,t=NaN;if(e){if(n=e.length-1,t=(n-ra(this.e/Nt))*Nt,n=e[n],n)for(;n%10==0;n/=10)t--;t<0&&(t=0)}return t};We.dividedBy=We.div=function(n){return pr(this,new this.constructor(n))};We.dividedToIntegerBy=We.divToInt=function(n){var e=this,t=e.constructor;return Mt(pr(e,new t(n),0,1,1),t.precision,t.rounding)};We.equals=We.eq=function(n){return this.cmp(n)===0};We.floor=function(){return Mt(new this.constructor(this),this.e+1,3)};We.greaterThan=We.gt=function(n){return this.cmp(n)>0};We.greaterThanOrEqualTo=We.gte=function(n){var e=this.cmp(n);return e==1||e===0};We.hyperbolicCosine=We.cosh=function(){var n,e,t,r,i,s=this,a=s.constructor,o=new a(1);if(!s.isFinite())return new a(s.s?1/0:NaN);if(s.isZero())return o;t=a.precision,r=a.rounding,a.precision=t+Math.max(s.e,s.sd())+4,a.rounding=1,i=s.d.length,i<32?(n=Math.ceil(i/3),e=(1/ON(4,n)).toString()):(n=16,e="2.3283064365386962890625e-10"),s=_b(a,1,s.times(e),new a(1),!0);for(var l,u=n,c=new a(8);u--;)l=s.times(s),s=o.minus(l.times(c.minus(l.times(c))));return Mt(s,a.precision=t,a.rounding=r,!0)};We.hyperbolicSine=We.sinh=function(){var n,e,t,r,i=this,s=i.constructor;if(!i.isFinite()||i.isZero())return new s(i);if(e=s.precision,t=s.rounding,s.precision=e+Math.max(i.e,i.sd())+4,s.rounding=1,r=i.d.length,r<3)i=_b(s,2,i,i,!0);else{n=1.4*Math.sqrt(r),n=n>16?16:n|0,i=i.times(1/ON(5,n)),i=_b(s,2,i,i,!0);for(var a,o=new s(5),l=new s(16),u=new s(20);n--;)a=i.times(i),i=i.times(o.plus(a.times(l.times(a).plus(u))))}return s.precision=e,s.rounding=t,Mt(i,e,t,!0)};We.hyperbolicTangent=We.tanh=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+7,r.rounding=1,pr(t.sinh(),t.cosh(),r.precision=n,r.rounding=e)):new r(t.s)};We.inverseCosine=We.acos=function(){var n=this,e=n.constructor,t=n.abs().cmp(1),r=e.precision,i=e.rounding;return t!==-1?t===0?n.isNeg()?lc(e,r,i):new e(0):new e(NaN):n.isZero()?lc(e,r+4,i).times(.5):(e.precision=r+6,e.rounding=1,n=new e(1).minus(n).div(n.plus(1)).sqrt().atan(),e.precision=r,e.rounding=i,n.times(2))};We.inverseHyperbolicCosine=We.acosh=function(){var n,e,t=this,r=t.constructor;return t.lte(1)?new r(t.eq(1)?0:NaN):t.isFinite()?(n=r.precision,e=r.rounding,r.precision=n+Math.max(Math.abs(t.e),t.sd())+4,r.rounding=1,Ht=!1,t=t.times(t).minus(1).sqrt().plus(t),Ht=!0,r.precision=n,r.rounding=e,t.ln()):new r(t)};We.inverseHyperbolicSine=We.asinh=function(){var n,e,t=this,r=t.constructor;return!t.isFinite()||t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+2*Math.max(Math.abs(t.e),t.sd())+6,r.rounding=1,Ht=!1,t=t.times(t).plus(1).sqrt().plus(t),Ht=!0,r.precision=n,r.rounding=e,t.ln())};We.inverseHyperbolicTangent=We.atanh=function(){var n,e,t,r,i=this,s=i.constructor;return i.isFinite()?i.e>=0?new s(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(n=s.precision,e=s.rounding,r=i.sd(),Math.max(r,n)<2*-i.e-1?Mt(new s(i),n,e,!0):(s.precision=t=r-i.e,i=pr(i.plus(1),new s(1).minus(i),t+n,1),s.precision=n+4,s.rounding=1,i=i.ln(),s.precision=n,s.rounding=e,i.times(.5))):new s(NaN)};We.inverseSine=We.asin=function(){var n,e,t,r,i=this,s=i.constructor;return i.isZero()?new s(i):(e=i.abs().cmp(1),t=s.precision,r=s.rounding,e!==-1?e===0?(n=lc(s,t+4,r).times(.5),n.s=i.s,n):new s(NaN):(s.precision=t+6,s.rounding=1,i=i.div(new s(1).minus(i.times(i)).sqrt().plus(1)).atan(),s.precision=t,s.rounding=r,i.times(2)))};We.inverseTangent=We.atan=function(){var n,e,t,r,i,s,a,o,l,u=this,c=u.constructor,h=c.precision,d=c.rounding;if(u.isFinite()){if(u.isZero())return new c(u);if(u.abs().eq(1)&&h+4<=_O)return a=lc(c,h+4,d).times(.25),a.s=u.s,a}else{if(!u.s)return new c(NaN);if(h+4<=_O)return a=lc(c,h+4,d).times(.5),a.s=u.s,a}for(c.precision=o=h+10,c.rounding=1,t=Math.min(28,o/Nt+2|0),n=t;n;--n)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(Ht=!1,e=Math.ceil(o/Nt),r=1,l=u.times(u),a=new c(u),i=u;n!==-1;)if(i=i.times(l),s=a.minus(i.div(r+=2)),i=i.times(l),a=s.plus(i.div(r+=2)),a.d[e]!==void 0)for(n=e;a.d[n]===s.d[n]&&n--;);return t&&(a=a.times(2<<t-1)),Ht=!0,Mt(a,c.precision=h,c.rounding=d,!0)};We.isFinite=function(){return!!this.d};We.isInteger=We.isInt=function(){return!!this.d&&ra(this.e/Nt)>this.d.length-2};We.isNaN=function(){return!this.s};We.isNegative=We.isNeg=function(){return this.s<0};We.isPositive=We.isPos=function(){return this.s>0};We.isZero=function(){return!!this.d&&this.d[0]===0};We.lessThan=We.lt=function(n){return this.cmp(n)<0};We.lessThanOrEqualTo=We.lte=function(n){return this.cmp(n)<1};We.logarithm=We.log=function(n){var e,t,r,i,s,a,o,l,u=this,c=u.constructor,h=c.precision,d=c.rounding,f=5;if(n==null)n=new c(10),e=!0;else{if(n=new c(n),t=n.d,n.s<0||!t||!t[0]||n.eq(1))return new c(NaN);e=n.eq(10)}if(t=u.d,u.s<0||!t||!t[0]||u.eq(1))return new c(t&&!t[0]?-1/0:u.s!=1?NaN:t?0:1/0);if(e)if(t.length>1)s=!0;else{for(i=t[0];i%10===0;)i/=10;s=i!==1}if(Ht=!1,o=h+f,a=np(u,o),r=e?kD(c,o+10):np(n,o),l=pr(a,r,o,1),Rw(l.d,i=h,d))do if(o+=10,a=np(u,o),r=e?kD(c,o+10):np(n,o),l=pr(a,r,o,1),!s){+As(l.d).slice(i+1,i+15)+1==1e14&&(l=Mt(l,h+1,0));break}while(Rw(l.d,i+=10,d));return Ht=!0,Mt(l,h,d)};We.minus=We.sub=function(n){var e,t,r,i,s,a,o,l,u,c,h,d,f=this,p=f.constructor;if(n=new p(n),!f.d||!n.d)return!f.s||!n.s?n=new p(NaN):f.d?n.s=-n.s:n=new p(n.d||f.s!==n.s?f:NaN),n;if(f.s!=n.s)return n.s=-n.s,f.plus(n);if(u=f.d,d=n.d,o=p.precision,l=p.rounding,!u[0]||!d[0]){if(d[0])n.s=-n.s;else if(u[0])n=new p(f);else return new p(l===3?-0:0);return Ht?Mt(n,o,l):n}if(t=ra(n.e/Nt),c=ra(f.e/Nt),u=u.slice(),s=c-t,s){for(h=s<0,h?(e=u,s=-s,a=d.length):(e=d,t=c,a=u.length),r=Math.max(Math.ceil(o/Nt),a)+2,s>r&&(s=r,e.length=1),e.reverse(),r=s;r--;)e.push(0);e.reverse()}else{for(r=u.length,a=d.length,h=r<a,h&&(a=r),r=0;r<a;r++)if(u[r]!=d[r]){h=u[r]<d[r];break}s=0}for(h&&(e=u,u=d,d=e,n.s=-n.s),a=u.length,r=d.length-a;r>0;--r)u[a++]=0;for(r=d.length;r>s;){if(u[--r]<d[r]){for(i=r;i&&u[--i]===0;)u[i]=du-1;--u[i],u[r]+=du}u[r]-=d[r]}for(;u[--a]===0;)u.pop();for(;u[0]===0;u.shift())--t;return u[0]?(n.d=u,n.e=LN(u,t),Ht?Mt(n,o,l):n):new p(l===3?-0:0)};We.modulo=We.mod=function(n){var e,t=this,r=t.constructor;return n=new r(n),!t.d||!n.s||n.d&&!n.d[0]?new r(NaN):!n.d||t.d&&!t.d[0]?Mt(new r(t),r.precision,r.rounding):(Ht=!1,r.modulo==9?(e=pr(t,n.abs(),0,3,1),e.s*=n.s):e=pr(t,n,0,r.modulo,1),e=e.times(n),Ht=!0,t.minus(e))};We.naturalExponential=We.exp=function(){return wO(this)};We.naturalLogarithm=We.ln=function(){return np(this)};We.negated=We.neg=function(){var n=new this.constructor(this);return n.s=-n.s,Mt(n)};We.plus=We.add=function(n){var e,t,r,i,s,a,o,l,u,c,h=this,d=h.constructor;if(n=new d(n),!h.d||!n.d)return!h.s||!n.s?n=new d(NaN):h.d||(n=new d(n.d||h.s===n.s?h:NaN)),n;if(h.s!=n.s)return n.s=-n.s,h.minus(n);if(u=h.d,c=n.d,o=d.precision,l=d.rounding,!u[0]||!c[0])return c[0]||(n=new d(h)),Ht?Mt(n,o,l):n;if(s=ra(h.e/Nt),r=ra(n.e/Nt),u=u.slice(),i=s-r,i){for(i<0?(t=u,i=-i,a=c.length):(t=c,r=s,a=u.length),s=Math.ceil(o/Nt),a=s>a?s+1:a+1,i>a&&(i=a,t.length=1),t.reverse();i--;)t.push(0);t.reverse()}for(a=u.length,i=c.length,a-i<0&&(i=a,t=c,c=u,u=t),e=0;i;)e=(u[--i]=u[i]+c[i]+e)/du|0,u[i]%=du;for(e&&(u.unshift(e),++r),a=u.length;u[--a]==0;)u.pop();return n.d=u,n.e=LN(u,r),Ht?Mt(n,o,l):n};We.precision=We.sd=function(n){var e,t=this;if(n!==void 0&&n!==!!n&&n!==1&&n!==0)throw Error(Fp+n);return t.d?(e=Ste(t.d),n&&t.e+1>e&&(e=t.e+1)):e=NaN,e};We.round=function(){var n=this,e=n.constructor;return Mt(new e(n),n.e+1,e.rounding)};We.sine=We.sin=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+Nt,r.rounding=1,t=QMe(r,Cte(r,t)),r.precision=n,r.rounding=e,Mt(Hh>2?t.neg():t,n,e,!0)):new r(NaN)};We.squareRoot=We.sqrt=function(){var n,e,t,r,i,s,a=this,o=a.d,l=a.e,u=a.s,c=a.constructor;if(u!==1||!o||!o[0])return new c(!u||u<0&&(!o||o[0])?NaN:o?a:1/0);for(Ht=!1,u=Math.sqrt(+a),u==0||u==1/0?(e=As(o),(e.length+l)%2==0&&(e+="0"),u=Math.sqrt(e),l=ra((l+1)/2)-(l<0||l%2),u==1/0?e="5e"+l:(e=u.toExponential(),e=e.slice(0,e.indexOf("e")+1)+l),r=new c(e)):r=new c(u.toString()),t=(l=c.precision)+3;;)if(s=r,r=s.plus(pr(a,s,t+2,1)).times(.5),As(s.d).slice(0,t)===(e=As(r.d)).slice(0,t))if(e=e.slice(t-3,t+1),e=="9999"||!i&&e=="4999"){if(!i&&(Mt(s,l+1,0),s.times(s).eq(a))){r=s;break}t+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(Mt(r,l+1,1),n=!r.times(r).eq(a));break}return Ht=!0,Mt(r,l,c.rounding,n)};We.tangent=We.tan=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+10,r.rounding=1,t=t.sin(),t.s=1,t=pr(t,new r(1).minus(t.times(t)).sqrt(),n+10,0),r.precision=n,r.rounding=e,Mt(Hh==2||Hh==4?t.neg():t,n,e,!0)):new r(NaN)};We.times=We.mul=function(n){var e,t,r,i,s,a,o,l,u,c=this,h=c.constructor,d=c.d,f=(n=new h(n)).d;if(n.s*=c.s,!d||!d[0]||!f||!f[0])return new h(!n.s||d&&!d[0]&&!f||f&&!f[0]&&!d?NaN:!d||!f?n.s/0:n.s*0);for(t=ra(c.e/Nt)+ra(n.e/Nt),l=d.length,u=f.length,l<u&&(s=d,d=f,f=s,a=l,l=u,u=a),s=[],a=l+u,r=a;r--;)s.push(0);for(r=u;--r>=0;){for(e=0,i=l+r;i>r;)o=s[i]+f[r]*d[i-r-1]+e,s[i--]=o%du|0,e=o/du|0;s[i]=(s[i]+e)%du|0}for(;!s[--a];)s.pop();return e?++t:s.shift(),n.d=s,n.e=LN(s,t),Ht?Mt(n,h.precision,h.rounding):n};We.toBinary=function(n,e){return K4(this,2,n,e)};We.toDecimalPlaces=We.toDP=function(n,e){var t=this,r=t.constructor;return t=new r(t),n===void 0?t:(no(n,0,Xp),e===void 0?e=r.rounding:no(e,0,8),Mt(t,n+t.e+1,e))};We.toExponential=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=Cc(r,!0):(no(n,0,Xp),e===void 0?e=i.rounding:no(e,0,8),r=Mt(new i(r),n+1,e),t=Cc(r,!0,n+1)),r.isNeg()&&!r.isZero()?"-"+t:t};We.toFixed=function(n,e){var t,r,i=this,s=i.constructor;return n===void 0?t=Cc(i):(no(n,0,Xp),e===void 0?e=s.rounding:no(e,0,8),r=Mt(new s(i),n+i.e+1,e),t=Cc(r,!1,n+r.e+1)),i.isNeg()&&!i.isZero()?"-"+t:t};We.toFraction=function(n){var e,t,r,i,s,a,o,l,u,c,h,d,f=this,p=f.d,m=f.constructor;if(!p)return new m(f);if(u=t=new m(1),r=l=new m(0),e=new m(r),s=e.e=Ste(p)-f.e-1,a=s%Nt,e.d[0]=Ri(10,a<0?Nt+a:a),n==null)n=s>0?e:u;else{if(o=new m(n),!o.isInt()||o.lt(u))throw Error(Fp+o);n=o.gt(e)?s>0?e:u:o}for(Ht=!1,o=new m(As(p)),c=m.precision,m.precision=s=p.length*Nt*2;h=pr(o,e,0,1,1),i=t.plus(h.times(r)),i.cmp(n)!=1;)t=r,r=i,i=u,u=l.plus(h.times(i)),l=i,i=e,e=o.minus(h.times(i)),o=i;return i=pr(n.minus(t),r,0,1,1),l=l.plus(i.times(u)),t=t.plus(i.times(r)),l.s=u.s=f.s,d=pr(u,r,s,1).minus(f).abs().cmp(pr(l,t,s,1).minus(f).abs())<1?[u,r]:[l,t],m.precision=c,Ht=!0,d};We.toHexadecimal=We.toHex=function(n,e){return K4(this,16,n,e)};We.toNearest=function(n,e){var t=this,r=t.constructor;if(t=new r(t),n==null){if(!t.d)return t;n=new r(1),e=r.rounding}else{if(n=new r(n),e===void 0?e=r.rounding:no(e,0,8),!t.d)return n.s?t:n;if(!n.d)return n.s&&(n.s=t.s),n}return n.d[0]?(Ht=!1,t=pr(t,n,0,e,1).times(n),Ht=!0,Mt(t)):(n.s=t.s,t=n),t};We.toNumber=function(){return+this};We.toOctal=function(n,e){return K4(this,8,n,e)};We.toPower=We.pow=function(n){var e,t,r,i,s,a,o=this,l=o.constructor,u=+(n=new l(n));if(!o.d||!n.d||!o.d[0]||!n.d[0])return new l(Ri(+o,u));if(o=new l(o),o.eq(1))return o;if(r=l.precision,s=l.rounding,n.eq(1))return Mt(o,r,s);if(e=ra(n.e/Nt),e>=n.d.length-1&&(t=u<0?-u:u)<=WMe)return i=Ate(l,o,t,r),n.s<0?new l(1).div(i):Mt(i,r,s);if(a=o.s,a<0){if(e<n.d.length-1)return new l(NaN);if(n.d[e]&1||(a=1),o.e==0&&o.d[0]==1&&o.d.length==1)return o.s=a,o}return t=Ri(+o,u),e=t==0||!isFinite(t)?ra(u*(Math.log("0."+As(o.d))/Math.LN10+o.e+1)):new l(t+"").e,e>l.maxE+1||e<l.minE-1?new l(e>0?a/0:0):(Ht=!1,l.rounding=o.s=1,t=Math.min(12,(e+"").length),i=wO(n.times(np(o,r+t)),r),i.d&&(i=Mt(i,r+5,1),Rw(i.d,r,s)&&(e=r+10,i=Mt(wO(n.times(np(o,e+t)),e),e+5,1),+As(i.d).slice(r+1,r+15)+1==1e14&&(i=Mt(i,r+1,0)))),i.s=a,Ht=!0,l.rounding=s,Mt(i,r,s))};We.toPrecision=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=Cc(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(no(n,1,Xp),e===void 0?e=i.rounding:no(e,0,8),r=Mt(new i(r),n,e),t=Cc(r,n<=r.e||r.e<=i.toExpNeg,n)),r.isNeg()&&!r.isZero()?"-"+t:t};We.toSignificantDigits=We.toSD=function(n,e){var t=this,r=t.constructor;return n===void 0?(n=r.precision,e=r.rounding):(no(n,1,Xp),e===void 0?e=r.rounding:no(e,0,8)),Mt(new r(t),n,e)};We.toString=function(){var n=this,e=n.constructor,t=Cc(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()&&!n.isZero()?"-"+t:t};We.truncated=We.trunc=function(){return Mt(new this.constructor(this),this.e+1,1)};We.valueOf=We.toJSON=function(){var n=this,e=n.constructor,t=Cc(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()?"-"+t:t};function As(n){var e,t,r,i=n.length-1,s="",a=n[0];if(i>0){for(s+=a,e=1;e<i;e++)r=n[e]+"",t=Nt-r.length,t&&(s+=Xd(t)),s+=r;a=n[e],r=a+"",t=Nt-r.length,t&&(s+=Xd(t))}else if(a===0)return"0";for(;a%10===0;)a/=10;return s+a}function no(n,e,t){if(n!==~~n||n<e||n>t)throw Error(Fp+n)}function Rw(n,e,t,r){var i,s,a,o;for(s=n[0];s>=10;s/=10)--e;return--e<0?(e+=Nt,i=0):(i=Math.ceil((e+1)/Nt),e%=Nt),s=Ri(10,Nt-e),o=n[i]%s|0,r==null?e<3?(e==0?o=o/100|0:e==1&&(o=o/10|0),a=t<4&&o==99999||t>3&&o==49999||o==5e4||o==0):a=(t<4&&o+1==s||t>3&&o+1==s/2)&&(n[i+1]/s/100|0)==Ri(10,e-2)-1||(o==s/2||o==0)&&(n[i+1]/s/100|0)==0:e<4?(e==0?o=o/1e3|0:e==1?o=o/100|0:e==2&&(o=o/10|0),a=(r||t<4)&&o==9999||!r&&t>3&&o==4999):a=((r||t<4)&&o+1==s||!r&&t>3&&o+1==s/2)&&(n[i+1]/s/1e3|0)==Ri(10,e-3)-1,a}function fC(n,e,t){for(var r,i=[0],s,a=0,o=n.length;a<o;){for(s=i.length;s--;)i[s]*=e;for(i[0]+=xO.indexOf(n.charAt(a++)),r=0;r<i.length;r++)i[r]>t-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/t|0,i[r]%=t)}return i.reverse()}function KMe(n,e){var t,r,i;if(e.isZero())return e;r=e.d.length,r<32?(t=Math.ceil(r/3),i=(1/ON(4,t)).toString()):(t=16,i="2.3283064365386962890625e-10"),n.precision+=t,e=_b(n,1,e.times(i),new n(1));for(var s=t;s--;){var a=e.times(e);e=a.times(a).minus(a).times(8).plus(1)}return n.precision-=t,e}var pr=function(){function n(r,i,s){var a,o=0,l=r.length;for(r=r.slice();l--;)a=r[l]*i+o,r[l]=a%s|0,o=a/s|0;return o&&r.unshift(o),r}function e(r,i,s,a){var o,l;if(s!=a)l=s>a?1:-1;else for(o=l=0;o<s;o++)if(r[o]!=i[o]){l=r[o]>i[o]?1:-1;break}return l}function t(r,i,s,a){for(var o=0;s--;)r[s]-=o,o=r[s]<i[s]?1:0,r[s]=o*a+r[s]-i[s];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,s,a,o,l){var u,c,h,d,f,p,m,y,v,b,x,w,_,E,A,T,S,M,D,N,R=r.constructor,O=r.s==i.s?1:-1,G=r.d,I=i.d;if(!G||!G[0]||!I||!I[0])return new R(!r.s||!i.s||(G?I&&G[0]==I[0]:!I)?NaN:G&&G[0]==0||!I?O*0:O/0);for(l?(f=1,c=r.e-i.e):(l=du,f=Nt,c=ra(r.e/f)-ra(i.e/f)),D=I.length,S=G.length,v=new R(O),b=v.d=[],h=0;I[h]==(G[h]||0);h++);if(I[h]>(G[h]||0)&&c--,s==null?(E=s=R.precision,a=R.rounding):o?E=s+(r.e-i.e)+1:E=s,E<0)b.push(1),p=!0;else{if(E=E/f+2|0,h=0,D==1){for(d=0,I=I[0],E++;(h<S||d)&&E--;h++)A=d*l+(G[h]||0),b[h]=A/I|0,d=A%I|0;p=d||h<S}else{for(d=l/(I[0]+1)|0,d>1&&(I=n(I,d,l),G=n(G,d,l),D=I.length,S=G.length),T=D,x=G.slice(0,D),w=x.length;w<D;)x[w++]=0;N=I.slice(),N.unshift(0),M=I[0],I[1]>=l/2&&++M;do d=0,u=e(I,x,D,w),u<0?(_=x[0],D!=w&&(_=_*l+(x[1]||0)),d=_/M|0,d>1?(d>=l&&(d=l-1),m=n(I,d,l),y=m.length,w=x.length,u=e(m,x,y,w),u==1&&(d--,t(m,D<y?N:I,y,l))):(d==0&&(u=d=1),m=I.slice()),y=m.length,y<w&&m.unshift(0),t(x,m,w,l),u==-1&&(w=x.length,u=e(I,x,D,w),u<1&&(d++,t(x,D<w?N:I,w,l))),w=x.length):u===0&&(d++,x=[0]),b[h++]=d,u&&x[0]?x[w++]=G[T]||0:(x=[G[T]],w=1);while((T++<S||x[0]!==void 0)&&E--);p=x[0]!==void 0}b[0]||b.shift()}if(f==1)v.e=c,xte=p;else{for(h=1,d=b[0];d>=10;d/=10)h++;v.e=h+c*f-1,Mt(v,o?s+v.e+1:s,a,p)}return v}}();function Mt(n,e,t,r){var i,s,a,o,l,u,c,h,d,f=n.constructor;e:if(e!=null){if(h=n.d,!h)return n;for(i=1,o=h[0];o>=10;o/=10)i++;if(s=e-i,s<0)s+=Nt,a=e,c=h[d=0],l=c/Ri(10,i-a-1)%10|0;else if(d=Math.ceil((s+1)/Nt),o=h.length,d>=o)if(r){for(;o++<=d;)h.push(0);c=l=0,i=1,s%=Nt,a=s-Nt+1}else break e;else{for(c=o=h[d],i=1;o>=10;o/=10)i++;s%=Nt,a=s-Nt+i,l=a<0?0:c/Ri(10,i-a-1)%10|0}if(r=r||e<0||h[d+1]!==void 0||(a<0?c:c%Ri(10,i-a-1)),u=t<4?(l||r)&&(t==0||t==(n.s<0?3:2)):l>5||l==5&&(t==4||r||t==6&&(s>0?a>0?c/Ri(10,i-a):0:h[d-1])%10&1||t==(n.s<0?8:7)),e<1||!h[0])return h.length=0,u?(e-=n.e+1,h[0]=Ri(10,(Nt-e%Nt)%Nt),n.e=-e||0):h[0]=n.e=0,n;if(s==0?(h.length=d,o=1,d--):(h.length=d+1,o=Ri(10,Nt-s),h[d]=a>0?(c/Ri(10,i-a)%Ri(10,a)|0)*o:0),u)for(;;)if(d==0){for(s=1,a=h[0];a>=10;a/=10)s++;for(a=h[0]+=o,o=1;a>=10;a/=10)o++;s!=o&&(n.e++,h[0]==du&&(h[0]=1));break}else{if(h[d]+=o,h[d]!=du)break;h[d--]=0,o=1}for(s=h.length;h[--s]===0;)h.pop()}return Ht&&(n.e>f.maxE?(n.d=null,n.e=NaN):n.e<f.minE&&(n.e=0,n.d=[0])),n}function Cc(n,e,t){if(!n.isFinite())return Mte(n);var r,i=n.e,s=As(n.d),a=s.length;return e?(t&&(r=t-a)>0?s=s.charAt(0)+"."+s.slice(1)+Xd(r):a>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(n.e<0?"e":"e+")+n.e):i<0?(s="0."+Xd(-i-1)+s,t&&(r=t-a)>0&&(s+=Xd(r))):i>=a?(s+=Xd(i+1-a),t&&(r=t-i-1)>0&&(s=s+"."+Xd(r))):((r=i+1)<a&&(s=s.slice(0,r)+"."+s.slice(r)),t&&(r=t-a)>0&&(i+1===a&&(s+="."),s+=Xd(r))),s}function LN(n,e){var t=n[0];for(e*=Nt;t>=10;t/=10)e++;return e}function kD(n,e,t){if(e>XMe)throw Ht=!0,t&&(n.precision=t),Error(bte);return Mt(new n(LD),e,1,!0)}function lc(n,e,t){if(e>_O)throw Error(bte);return Mt(new n(OD),e,t,!0)}function Ste(n){var e=n.length-1,t=e*Nt+1;if(e=n[e],e){for(;e%10==0;e/=10)t--;for(e=n[0];e>=10;e/=10)t++}return t}function Xd(n){for(var e="";n--;)e+="0";return e}function Ate(n,e,t,r){var i,s=new n(1),a=Math.ceil(r/Nt+4);for(Ht=!1;;){if(t%2&&(s=s.times(e),r$(s.d,a)&&(i=!0)),t=ra(t/2),t===0){t=s.d.length-1,i&&s.d[t]===0&&++s.d[t];break}e=e.times(e),r$(e.d,a)}return Ht=!0,s}function n$(n){return n.d[n.d.length-1]&1}function Tte(n,e,t){for(var r,i,s=new n(e[0]),a=0;++a<e.length;){if(i=new n(e[a]),!i.s){s=i;break}r=s.cmp(i),(r===t||r===0&&s.s===t)&&(s=i)}return s}function wO(n,e){var t,r,i,s,a,o,l,u=0,c=0,h=0,d=n.constructor,f=d.rounding,p=d.precision;if(!n.d||!n.d[0]||n.e>17)return new d(n.d?n.d[0]?n.s<0?0:1/0:1:n.s?n.s<0?0:n:NaN);for(e==null?(Ht=!1,l=p):l=e,o=new d(.03125);n.e>-2;)n=n.times(o),h+=5;for(r=Math.log(Ri(2,h))/Math.LN10*2+5|0,l+=r,t=s=a=new d(1),d.precision=l;;){if(s=Mt(s.times(n),l,1),t=t.times(++c),o=a.plus(pr(s,t,l,1)),As(o.d).slice(0,l)===As(a.d).slice(0,l)){for(i=h;i--;)a=Mt(a.times(a),l,1);if(e==null)if(u<3&&Rw(a.d,l-r,f,u))d.precision=l+=10,t=s=o=new d(1),c=0,u++;else return Mt(a,d.precision=p,f,Ht=!0);else return d.precision=p,a}a=o}}function np(n,e){var t,r,i,s,a,o,l,u,c,h,d,f=1,p=10,m=n,y=m.d,v=m.constructor,b=v.rounding,x=v.precision;if(m.s<0||!y||!y[0]||!m.e&&y[0]==1&&y.length==1)return new v(y&&!y[0]?-1/0:m.s!=1?NaN:y?0:m);if(e==null?(Ht=!1,c=x):c=e,v.precision=c+=p,t=As(y),r=t.charAt(0),Math.abs(s=m.e)<15e14){for(;r<7&&r!=1||r==1&&t.charAt(1)>3;)m=m.times(n),t=As(m.d),r=t.charAt(0),f++;s=m.e,r>1?(m=new v("0."+t),s++):m=new v(r+"."+t.slice(1))}else return u=kD(v,c+2,x).times(s+""),m=np(new v(r+"."+t.slice(1)),c-p).plus(u),v.precision=x,e==null?Mt(m,x,b,Ht=!0):m;for(h=m,l=a=m=pr(m.minus(1),m.plus(1),c,1),d=Mt(m.times(m),c,1),i=3;;){if(a=Mt(a.times(d),c,1),u=l.plus(pr(a,new v(i),c,1)),As(u.d).slice(0,c)===As(l.d).slice(0,c))if(l=l.times(2),s!==0&&(l=l.plus(kD(v,c+2,x).times(s+""))),l=pr(l,new v(f),c,1),e==null)if(Rw(l.d,c-p,b,o))v.precision=c+=p,u=a=m=pr(h.minus(1),h.plus(1),c,1),d=Mt(m.times(m),c,1),i=o=1;else return Mt(l,v.precision=x,b,Ht=!0);else return v.precision=x,l;l=u,i+=2}}function Mte(n){return String(n.s*n.s/0)}function pC(n,e){var t,r,i;for((t=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(t<0&&(t=r),t+=+e.slice(r+1),e=e.substring(0,r)):t<0&&(t=e.length),r=0;e.charCodeAt(r)===48;r++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(r,i),e){if(i-=r,n.e=t=t-r-1,n.d=[],r=(t+1)%Nt,t<0&&(r+=Nt),r<i){for(r&&n.d.push(+e.slice(0,r)),i-=Nt;r<i;)n.d.push(+e.slice(r,r+=Nt));e=e.slice(r),r=Nt-e.length}else r-=i;for(;r--;)e+="0";n.d.push(+e),Ht&&(n.e>n.constructor.maxE?(n.d=null,n.e=NaN):n.e<n.constructor.minE&&(n.e=0,n.d=[0]))}else n.e=0,n.d=[0];return n}function YMe(n,e){var t,r,i,s,a,o,l,u,c;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),Ete.test(e))return pC(n,e)}else if(e==="Infinity"||e==="NaN")return+e||(n.s=NaN),n.e=NaN,n.d=null,n;if(jMe.test(e))t=16,e=e.toLowerCase();else if(GMe.test(e))t=2;else if(qMe.test(e))t=8;else throw Error(Fp+e);for(s=e.search(/p/i),s>0?(l=+e.slice(s+1),e=e.substring(2,s)):e=e.slice(2),s=e.indexOf("."),a=s>=0,r=n.constructor,a&&(e=e.replace(".",""),o=e.length,s=o-s,i=Ate(r,new r(t),s,s*2)),u=fC(e,t,du),c=u.length-1,s=c;u[s]===0;--s)u.pop();return s<0?new r(n.s*0):(n.e=LN(u,c),n.d=u,Ht=!1,a&&(n=pr(n,i,o*4)),l&&(n=n.times(Math.abs(l)<54?Ri(2,l):Lp.pow(2,l))),Ht=!0,n)}function QMe(n,e){var t,r=e.d.length;if(r<3)return e.isZero()?e:_b(n,2,e,e);t=1.4*Math.sqrt(r),t=t>16?16:t|0,e=e.times(1/ON(5,t)),e=_b(n,2,e,e);for(var i,s=new n(5),a=new n(16),o=new n(20);t--;)i=e.times(e),e=e.times(s.plus(i.times(a.times(i).minus(o))));return e}function _b(n,e,t,r,i){var s,a,o,l,u=n.precision,c=Math.ceil(u/Nt);for(Ht=!1,l=t.times(t),o=new n(r);;){if(a=pr(o.times(l),new n(e++*e++),u,1),o=i?r.plus(a):r.minus(a),r=pr(a.times(l),new n(e++*e++),u,1),a=o.plus(r),a.d[c]!==void 0){for(s=c;a.d[s]===o.d[s]&&s--;);if(s==-1)break}s=o,o=r,r=a,a=s}return Ht=!0,a.d.length=c+1,a}function ON(n,e){for(var t=n;--e;)t*=n;return t}function Cte(n,e){var t,r=e.s<0,i=lc(n,n.precision,1),s=i.times(.5);if(e=e.abs(),e.lte(s))return Hh=r?4:1,e;if(t=e.divToInt(i),t.isZero())Hh=r?3:2;else{if(e=e.minus(t.times(i)),e.lte(s))return Hh=n$(t)?r?2:3:r?4:1,e;Hh=n$(t)?r?1:4:r?3:2}return e.minus(i).abs()}function K4(n,e,t,r){var i,s,a,o,l,u,c,h,d,f=n.constructor,p=t!==void 0;if(p?(no(t,1,Xp),r===void 0?r=f.rounding:no(r,0,8)):(t=f.precision,r=f.rounding),!n.isFinite())c=Mte(n);else{for(c=Cc(n),a=c.indexOf("."),p?(i=2,e==16?t=t*4-3:e==8&&(t=t*3-2)):i=e,a>=0&&(c=c.replace(".",""),d=new f(1),d.e=c.length-a,d.d=fC(Cc(d),10,i),d.e=d.d.length),h=fC(c,10,i),s=l=h.length;h[--l]==0;)h.pop();if(!h[0])c=p?"0p+0":"0";else{if(a<0?s--:(n=new f(n),n.d=h,n.e=s,n=pr(n,d,t,r,0,i),h=n.d,s=n.e,u=xte),a=h[t],o=i/2,u=u||h[t+1]!==void 0,u=r<4?(a!==void 0||u)&&(r===0||r===(n.s<0?3:2)):a>o||a===o&&(r===4||u||r===6&&h[t-1]&1||r===(n.s<0?8:7)),h.length=t,u)for(;++h[--t]>i-1;)h[t]=0,t||(++s,h.unshift(1));for(l=h.length;!h[l-1];--l);for(a=0,c="";a<l;a++)c+=xO.charAt(h[a]);if(p){if(l>1)if(e==16||e==8){for(a=e==16?4:3,--l;l%a;l++)c+="0";for(h=fC(c,i,e),l=h.length;!h[l-1];--l);for(a=1,c="1.";a<l;a++)c+=xO.charAt(h[a])}else c=c.charAt(0)+"."+c.slice(1);c=c+(s<0?"p":"p+")+s}else if(s<0){for(;++s;)c="0"+c;c="0."+c}else if(++s>l)for(s-=l;s--;)c+="0";else s<l&&(c=c.slice(0,s)+"."+c.slice(s))}c=(e==16?"0x":e==2?"0b":e==8?"0o":"")+c}return n.s<0?"-"+c:c}function r$(n,e){if(n.length>e)return n.length=e,!0}function ZMe(n){return new this(n).abs()}function JMe(n){return new this(n).acos()}function eCe(n){return new this(n).acosh()}function tCe(n,e){return new this(n).plus(e)}function nCe(n){return new this(n).asin()}function rCe(n){return new this(n).asinh()}function iCe(n){return new this(n).atan()}function sCe(n){return new this(n).atanh()}function aCe(n,e){n=new this(n),e=new this(e);var t,r=this.precision,i=this.rounding,s=r+4;return!n.s||!e.s?t=new this(NaN):!n.d&&!e.d?(t=lc(this,s,1).times(e.s>0?.25:.75),t.s=n.s):!e.d||n.isZero()?(t=e.s<0?lc(this,r,i):new this(0),t.s=n.s):!n.d||e.isZero()?(t=lc(this,s,1).times(.5),t.s=n.s):e.s<0?(this.precision=s,this.rounding=1,t=this.atan(pr(n,e,s,1)),e=lc(this,s,1),this.precision=r,this.rounding=i,t=n.s<0?t.minus(e):t.plus(e)):t=this.atan(pr(n,e,s,1)),t}function oCe(n){return new this(n).cbrt()}function lCe(n){return Mt(n=new this(n),n.e+1,2)}function uCe(n,e,t){return new this(n).clamp(e,t)}function cCe(n){if(!n||typeof n!="object")throw Error(FN+"Object expected");var e,t,r,i=n.defaults===!0,s=["precision",1,Xp,"rounding",0,8,"toExpNeg",-sy,0,"toExpPos",0,sy,"maxE",0,sy,"minE",-sy,0,"modulo",0,9];for(e=0;e<s.length;e+=3)if(t=s[e],i&&(this[t]=bO[t]),(r=n[t])!==void 0)if(ra(r)===r&&r>=s[e+1]&&r<=s[e+2])this[t]=r;else throw Error(Fp+t+": "+r);if(t="crypto",i&&(this[t]=bO[t]),(r=n[t])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[t]=!0;else throw Error(_te);else this[t]=!1;else throw Error(Fp+t+": "+r);return this}function hCe(n){return new this(n).cos()}function dCe(n){return new this(n).cosh()}function Dte(n){var e,t,r;function i(s){var a,o,l,u=this;if(!(u instanceof i))return new i(s);if(u.constructor=i,i$(s)){u.s=s.s,Ht?!s.d||s.e>i.maxE?(u.e=NaN,u.d=null):s.e<i.minE?(u.e=0,u.d=[0]):(u.e=s.e,u.d=s.d.slice()):(u.e=s.e,u.d=s.d?s.d.slice():s.d);return}if(l=typeof s,l==="number"){if(s===0){u.s=1/s<0?-1:1,u.e=0,u.d=[0];return}if(s<0?(s=-s,u.s=-1):u.s=1,s===~~s&&s<1e7){for(a=0,o=s;o>=10;o/=10)a++;Ht?a>i.maxE?(u.e=NaN,u.d=null):a<i.minE?(u.e=0,u.d=[0]):(u.e=a,u.d=[s]):(u.e=a,u.d=[s]);return}if(s*0!==0){s||(u.s=NaN),u.e=NaN,u.d=null;return}return pC(u,s.toString())}if(l==="string")return(o=s.charCodeAt(0))===45?(s=s.slice(1),u.s=-1):(o===43&&(s=s.slice(1)),u.s=1),Ete.test(s)?pC(u,s):YMe(u,s);if(l==="bigint")return s<0?(s=-s,u.s=-1):u.s=1,pC(u,s.toString());throw Error(Fp+s)}if(i.prototype=We,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=cCe,i.clone=Dte,i.isDecimal=i$,i.abs=ZMe,i.acos=JMe,i.acosh=eCe,i.add=tCe,i.asin=nCe,i.asinh=rCe,i.atan=iCe,i.atanh=sCe,i.atan2=aCe,i.cbrt=oCe,i.ceil=lCe,i.clamp=uCe,i.cos=hCe,i.cosh=dCe,i.div=fCe,i.exp=pCe,i.floor=mCe,i.hypot=gCe,i.ln=vCe,i.log=yCe,i.log10=bCe,i.log2=xCe,i.max=_Ce,i.min=wCe,i.mod=ECe,i.mul=SCe,i.pow=ACe,i.random=TCe,i.round=MCe,i.sign=CCe,i.sin=DCe,i.sinh=NCe,i.sqrt=RCe,i.sub=ICe,i.sum=PCe,i.tan=FCe,i.tanh=LCe,i.trunc=OCe,n===void 0&&(n={}),n&&n.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)n.hasOwnProperty(t=r[e++])||(n[t]=this[t]);return i.config(n),i}function fCe(n,e){return new this(n).div(e)}function pCe(n){return new this(n).exp()}function mCe(n){return Mt(n=new this(n),n.e+1,3)}function gCe(){var n,e,t=new this(0);for(Ht=!1,n=0;n<arguments.length;)if(e=new this(arguments[n++]),e.d)t.d&&(t=t.plus(e.times(e)));else{if(e.s)return Ht=!0,new this(1/0);t=e}return Ht=!0,t.sqrt()}function i$(n){return n instanceof Lp||n&&n.toStringTag===wte||!1}function vCe(n){return new this(n).ln()}function yCe(n,e){return new this(n).log(e)}function xCe(n){return new this(n).log(2)}function bCe(n){return new this(n).log(10)}function _Ce(){return Tte(this,arguments,-1)}function wCe(){return Tte(this,arguments,1)}function ECe(n,e){return new this(n).mod(e)}function SCe(n,e){return new this(n).mul(e)}function ACe(n,e){return new this(n).pow(e)}function TCe(n){var e,t,r,i,s=0,a=new this(1),o=[];if(n===void 0?n=this.precision:no(n,1,Xp),r=Math.ceil(n/Nt),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));s<r;)i=e[s],i>=429e7?e[s]=crypto.getRandomValues(new Uint32Array(1))[0]:o[s++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(r*=4);s<r;)i=e[s]+(e[s+1]<<8)+(e[s+2]<<16)+((e[s+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,s):(o.push(i%1e7),s+=4);s=r/4}else throw Error(_te);else for(;s<r;)o[s++]=Math.random()*1e7|0;for(r=o[--s],n%=Nt,r&&n&&(i=Ri(10,Nt-n),o[s]=(r/i|0)*i);o[s]===0;s--)o.pop();if(s<0)t=0,o=[0];else{for(t=-1;o[0]===0;t-=Nt)o.shift();for(r=1,i=o[0];i>=10;i/=10)r++;r<Nt&&(t-=Nt-r)}return a.e=t,a.d=o,a}function MCe(n){return Mt(n=new this(n),n.e+1,this.rounding)}function CCe(n){return n=new this(n),n.d?n.d[0]?n.s:0*n.s:n.s||NaN}function DCe(n){return new this(n).sin()}function NCe(n){return new this(n).sinh()}function RCe(n){return new this(n).sqrt()}function ICe(n,e){return new this(n).sub(e)}function PCe(){var n=0,e=arguments,t=new this(e[n]);for(Ht=!1;t.s&&++n<e.length;)t=t.plus(e[n]);return Ht=!0,Mt(t,this.precision,this.rounding)}function FCe(n){return new this(n).tan()}function LCe(n){return new this(n).tanh()}function OCe(n){return Mt(n=new this(n),n.e+1,1)}We[Symbol.for("nodejs.util.inspect.custom")]=We.toString;We[Symbol.toStringTag]="Decimal";var Lp=We.constructor=Dte(bO);LD=new Lp(LD);OD=new Lp(OD);var kCe="BigNumber",BCe=["?on","config"],UCe=re(kCe,BCe,n=>{var{on:e,config:t}=n,r=Lp.clone({precision:t.precision,modulo:Lp.EUCLID});return r.prototype=Object.create(r.prototype),r.prototype.type="BigNumber",r.prototype.isBigNumber=!0,r.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},r.fromJSON=function(i){return new r(i.value)},e&&e("config",function(i,s){i.precision!==s.precision&&r.config({precision:i.precision})}),r},{isClass:!0});const Us=Math.cosh||function(n){return Math.abs(n)<1e-9?1-n:(Math.exp(n)+Math.exp(-n))*.5},Yo=Math.sinh||function(n){return Math.abs(n)<1e-9?n:(Math.exp(n)-Math.exp(-n))*.5},VCe=n=>{const e=Math.sin(.5*n);return-2*e*e},KI=function(n,e){return n=Math.abs(n),e=Math.abs(e),n<e&&([n,e]=[e,n]),n<1e8?Math.sqrt(n*n+e*e):(e/=n,n*Math.sqrt(1+e*e))},b0=function(){throw SyntaxError("Invalid Param")};function YI(n,e){const t=Math.abs(n),r=Math.abs(e);return n===0?Math.log(r):e===0?Math.log(t):t<3e3&&r<3e3?Math.log(n*n+e*e)*.5:(n=n*.5,e=e*.5,.5*Math.log(n*n+e*e)+Math.LN2)}const zCe={re:0,im:0},Cm=function(n,e){const t=zCe;if(n==null)t.re=t.im=0;else if(e!==void 0)t.re=n,t.im=e;else switch(typeof n){case"object":if("im"in n&&"re"in n)t.re=n.re,t.im=n.im;else if("abs"in n&&"arg"in n){if(!isFinite(n.abs)&&isFinite(n.arg))return Oe.INFINITY;t.re=n.abs*Math.cos(n.arg),t.im=n.abs*Math.sin(n.arg)}else if("r"in n&&"phi"in n){if(!isFinite(n.r)&&isFinite(n.phi))return Oe.INFINITY;t.re=n.r*Math.cos(n.phi),t.im=n.r*Math.sin(n.phi)}else n.length===2?(t.re=n[0],t.im=n[1]):b0();break;case"string":t.im=t.re=0;const r=n.replace(/_/g,"").match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g);let i=1,s=0;r===null&&b0();for(let a=0;a<r.length;a++){const o=r[a];o===" "||o==="	"||o===`
`||(o==="+"?i++:o==="-"?s++:o==="i"||o==="I"?(i+s===0&&b0(),r[a+1]!==" "&&!isNaN(r[a+1])?(t.im+=parseFloat((s%2?"-":"")+r[a+1]),a++):t.im+=parseFloat((s%2?"-":"")+"1"),i=s=0):((i+s===0||isNaN(o))&&b0(),r[a+1]==="i"||r[a+1]==="I"?(t.im+=parseFloat((s%2?"-":"")+o),a++):t.re+=parseFloat((s%2?"-":"")+o),i=s=0))}i+s>0&&b0();break;case"number":t.im=0,t.re=n;break;default:b0()}return isNaN(t.re)||isNaN(t.im),t};function Oe(n,e){if(!(this instanceof Oe))return new Oe(n,e);const t=Cm(n,e);this.re=t.re,this.im=t.im}Oe.prototype={re:0,im:0,sign:function(){const n=KI(this.re,this.im);return new Oe(this.re/n,this.im/n)},add:function(n,e){const t=Cm(n,e),r=this.isInfinite(),i=!(isFinite(t.re)&&isFinite(t.im));return r||i?r&&i?Oe.NAN:Oe.INFINITY:new Oe(this.re+t.re,this.im+t.im)},sub:function(n,e){const t=Cm(n,e),r=this.isInfinite(),i=!(isFinite(t.re)&&isFinite(t.im));return r||i?r&&i?Oe.NAN:Oe.INFINITY:new Oe(this.re-t.re,this.im-t.im)},mul:function(n,e){const t=Cm(n,e),r=this.isInfinite(),i=!(isFinite(t.re)&&isFinite(t.im)),s=this.re===0&&this.im===0,a=t.re===0&&t.im===0;return r&&a||i&&s?Oe.NAN:r||i?Oe.INFINITY:t.im===0&&this.im===0?new Oe(this.re*t.re,0):new Oe(this.re*t.re-this.im*t.im,this.re*t.im+this.im*t.re)},div:function(n,e){const t=Cm(n,e),r=this.isInfinite(),i=!(isFinite(t.re)&&isFinite(t.im)),s=this.re===0&&this.im===0,a=t.re===0&&t.im===0;if(s&&a||r&&i)return Oe.NAN;if(a||r)return Oe.INFINITY;if(s||i)return Oe.ZERO;if(t.im===0)return new Oe(this.re/t.re,this.im/t.re);if(Math.abs(t.re)<Math.abs(t.im)){const o=t.re/t.im,l=t.re*o+t.im;return new Oe((this.re*o+this.im)/l,(this.im*o-this.re)/l)}else{const o=t.im/t.re,l=t.im*o+t.re;return new Oe((this.re+this.im*o)/l,(this.im-this.re*o)/l)}},pow:function(n,e){const t=Cm(n,e),r=this.re===0&&this.im===0;if(t.re===0&&t.im===0)return Oe.ONE;if(t.im===0){if(this.im===0&&this.re>0)return new Oe(Math.pow(this.re,t.re),0);if(this.re===0)switch((t.re%4+4)%4){case 0:return new Oe(Math.pow(this.im,t.re),0);case 1:return new Oe(0,Math.pow(this.im,t.re));case 2:return new Oe(-Math.pow(this.im,t.re),0);case 3:return new Oe(0,-Math.pow(this.im,t.re))}}if(r&&t.re>0)return Oe.ZERO;const s=Math.atan2(this.im,this.re),a=YI(this.re,this.im);let o=Math.exp(t.re*a-t.im*s),l=t.im*a+t.re*s;return new Oe(o*Math.cos(l),o*Math.sin(l))},sqrt:function(){const n=this.re,e=this.im;if(e===0)return n>=0?new Oe(Math.sqrt(n),0):new Oe(0,Math.sqrt(-n));const t=KI(n,e);let r=Math.sqrt(.5*(t+Math.abs(n))),i=Math.abs(e)/(2*r);return n>=0?new Oe(r,e<0?-i:i):new Oe(i,e<0?-r:r)},exp:function(){const n=Math.exp(this.re);return this.im===0?new Oe(n,0):new Oe(n*Math.cos(this.im),n*Math.sin(this.im))},expm1:function(){const n=this.re,e=this.im;return new Oe(Math.expm1(n)*Math.cos(e)+VCe(e),Math.exp(n)*Math.sin(e))},log:function(){const n=this.re,e=this.im;return e===0&&n>0?new Oe(Math.log(n),0):new Oe(YI(n,e),Math.atan2(e,n))},abs:function(){return KI(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){const n=this.re,e=this.im;return new Oe(Math.sin(n)*Us(e),Math.cos(n)*Yo(e))},cos:function(){const n=this.re,e=this.im;return new Oe(Math.cos(n)*Us(e),-Math.sin(n)*Yo(e))},tan:function(){const n=2*this.re,e=2*this.im,t=Math.cos(n)+Us(e);return new Oe(Math.sin(n)/t,Yo(e)/t)},cot:function(){const n=2*this.re,e=2*this.im,t=Math.cos(n)-Us(e);return new Oe(-Math.sin(n)/t,Yo(e)/t)},sec:function(){const n=this.re,e=this.im,t=.5*Us(2*e)+.5*Math.cos(2*n);return new Oe(Math.cos(n)*Us(e)/t,Math.sin(n)*Yo(e)/t)},csc:function(){const n=this.re,e=this.im,t=.5*Us(2*e)-.5*Math.cos(2*n);return new Oe(Math.sin(n)*Us(e)/t,-Math.cos(n)*Yo(e)/t)},asin:function(){const n=this.re,e=this.im,t=new Oe(e*e-n*n+1,-2*n*e).sqrt(),r=new Oe(t.re-e,t.im+n).log();return new Oe(r.im,-r.re)},acos:function(){const n=this.re,e=this.im,t=new Oe(e*e-n*n+1,-2*n*e).sqrt(),r=new Oe(t.re-e,t.im+n).log();return new Oe(Math.PI/2-r.im,r.re)},atan:function(){const n=this.re,e=this.im;if(n===0){if(e===1)return new Oe(0,1/0);if(e===-1)return new Oe(0,-1/0)}const t=n*n+(1-e)*(1-e),r=new Oe((1-e*e-n*n)/t,-2*n/t).log();return new Oe(-.5*r.im,.5*r.re)},acot:function(){const n=this.re,e=this.im;if(e===0)return new Oe(Math.atan2(1,n),0);const t=n*n+e*e;return t!==0?new Oe(n/t,-e/t).atan():new Oe(n!==0?n/0:0,e!==0?-e/0:0).atan()},asec:function(){const n=this.re,e=this.im;if(n===0&&e===0)return new Oe(0,1/0);const t=n*n+e*e;return t!==0?new Oe(n/t,-e/t).acos():new Oe(n!==0?n/0:0,e!==0?-e/0:0).acos()},acsc:function(){const n=this.re,e=this.im;if(n===0&&e===0)return new Oe(Math.PI/2,1/0);const t=n*n+e*e;return t!==0?new Oe(n/t,-e/t).asin():new Oe(n!==0?n/0:0,e!==0?-e/0:0).asin()},sinh:function(){const n=this.re,e=this.im;return new Oe(Yo(n)*Math.cos(e),Us(n)*Math.sin(e))},cosh:function(){const n=this.re,e=this.im;return new Oe(Us(n)*Math.cos(e),Yo(n)*Math.sin(e))},tanh:function(){const n=2*this.re,e=2*this.im,t=Us(n)+Math.cos(e);return new Oe(Yo(n)/t,Math.sin(e)/t)},coth:function(){const n=2*this.re,e=2*this.im,t=Us(n)-Math.cos(e);return new Oe(Yo(n)/t,-Math.sin(e)/t)},csch:function(){const n=this.re,e=this.im,t=Math.cos(2*e)-Us(2*n);return new Oe(-2*Yo(n)*Math.cos(e)/t,2*Us(n)*Math.sin(e)/t)},sech:function(){const n=this.re,e=this.im,t=Math.cos(2*e)+Us(2*n);return new Oe(2*Us(n)*Math.cos(e)/t,-2*Yo(n)*Math.sin(e)/t)},asinh:function(){const n=this.re,e=this.im;if(e===0){if(n===0)return new Oe(0,0);const s=Math.abs(n),a=Math.log(s+Math.sqrt(s*s+1));return new Oe(n<0?-a:a,0)}const t=n*n-e*e+1,r=2*n*e,i=new Oe(t,r).sqrt();return new Oe(n+i.re,e+i.im).log()},acosh:function(){const n=this.re,e=this.im;if(e===0){if(n>1)return new Oe(Math.log(n+Math.sqrt(n-1)*Math.sqrt(n+1)),0);if(n<-1){const i=Math.sqrt(n*n-1);return new Oe(Math.log(-n+i),Math.PI)}return new Oe(0,Math.acos(n))}const t=new Oe(n-1,e).sqrt(),r=new Oe(n+1,e).sqrt();return new Oe(n+t.re*r.re-t.im*r.im,e+t.re*r.im+t.im*r.re).log()},atanh:function(){const n=this.re,e=this.im;if(e===0){if(n===0)return new Oe(0,0);if(n===1)return new Oe(1/0,0);if(n===-1)return new Oe(-1/0,0);if(-1<n&&n<1)return new Oe(.5*Math.log((1+n)/(1-n)),0);if(n>1){const l=(n+1)/(n-1);return new Oe(.5*Math.log(l),-Math.PI/2)}const o=(1+n)/(1-n);return new Oe(.5*Math.log(-o),Math.PI/2)}const t=1-n,r=1+n,i=t*t+e*e;if(i===0)return new Oe(n!==-1?n/0:0,e!==0?e/0:0);const s=(r*t-e*e)/i,a=(e*t+r*e)/i;return new Oe(YI(s,a)/2,Math.atan2(a,s)/2)},acoth:function(){const n=this.re,e=this.im;if(n===0&&e===0)return new Oe(0,Math.PI/2);const t=n*n+e*e;return t!==0?new Oe(n/t,-e/t).atanh():new Oe(n!==0?n/0:0,e!==0?-e/0:0).atanh()},acsch:function(){const n=this.re,e=this.im;if(e===0){if(n===0)return new Oe(1/0,0);const r=1/n;return new Oe(Math.log(r+Math.sqrt(r*r+1)),0)}const t=n*n+e*e;return t!==0?new Oe(n/t,-e/t).asinh():new Oe(n!==0?n/0:0,e!==0?-e/0:0).asinh()},asech:function(){const n=this.re,e=this.im;if(this.isZero())return Oe.INFINITY;const t=n*n+e*e;return t!==0?new Oe(n/t,-e/t).acosh():new Oe(n!==0?n/0:0,e!==0?-e/0:0).acosh()},inverse:function(){if(this.isZero())return Oe.INFINITY;if(this.isInfinite())return Oe.ZERO;const n=this.re,e=this.im,t=n*n+e*e;return new Oe(n/t,-e/t)},conjugate:function(){return new Oe(this.re,-this.im)},neg:function(){return new Oe(-this.re,-this.im)},ceil:function(n){return n=Math.pow(10,n||0),new Oe(Math.ceil(this.re*n)/n,Math.ceil(this.im*n)/n)},floor:function(n){return n=Math.pow(10,n||0),new Oe(Math.floor(this.re*n)/n,Math.floor(this.im*n)/n)},round:function(n){return n=Math.pow(10,n||0),new Oe(Math.round(this.re*n)/n,Math.round(this.im*n)/n)},equals:function(n,e){const t=Cm(n,e);return Math.abs(t.re-this.re)<=Oe.EPSILON&&Math.abs(t.im-this.im)<=Oe.EPSILON},clone:function(){return new Oe(this.re,this.im)},toString:function(){let n=this.re,e=this.im,t="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(n)<Oe.EPSILON&&(n=0),Math.abs(e)<Oe.EPSILON&&(e=0),e===0?t+n:(n!==0?(t+=n,t+=" ",e<0?(e=-e,t+="-"):t+="+",t+=" "):e<0&&(e=-e,t+="-"),e!==1&&(t+=e),t+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!this.isFinite()}};Oe.ZERO=new Oe(0,0);Oe.ONE=new Oe(1,0);Oe.I=new Oe(0,1);Oe.PI=new Oe(Math.PI,0);Oe.E=new Oe(Math.E,0);Oe.INFINITY=new Oe(1/0,1/0);Oe.NAN=new Oe(NaN,NaN);Oe.EPSILON=1e-15;var $Ce="Complex",HCe=[],GCe=re($Ce,HCe,()=>(Object.defineProperty(Oe,"name",{value:"Complex"}),Oe.prototype.constructor=Oe,Oe.prototype.type="Complex",Oe.prototype.isComplex=!0,Oe.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},Oe.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},Oe.prototype.format=function(n){var e="",t=this.im,r=this.re,i=dv(this.re,n),s=dv(this.im,n),a=Tt(n)?n:n?n.precision:null;if(a!==null){var o=Math.pow(10,-a);Math.abs(r/t)<o&&(r=0),Math.abs(t/r)<o&&(t=0)}return t===0?e=i:r===0?t===1?e="i":t===-1?e="-i":e=s+"i":t<0?t===-1?e=i+" - i":e=i+" - "+s.substring(1)+"i":t===1?e=i+" + i":e=i+" + "+s+"i",e},Oe.fromPolar=function(n){switch(arguments.length){case 1:{var e=arguments[0];if(typeof e=="object")return Oe(e);throw new TypeError("Input has to be an object with r and phi keys.")}case 2:{var t=arguments[0],r=arguments[1];if(Tt(t)){if(No(r)&&r.hasBase("ANGLE")&&(r=r.toNumber("rad")),Tt(r))return new Oe({r:t,phi:r});throw new TypeError("Phi is not a number nor an angle unit.")}else throw new TypeError("Radius r is not a number.")}default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},Oe.prototype.valueOf=Oe.prototype.toString,Oe.fromJSON=function(n){return new Oe(n)},Oe.compare=function(n,e){return n.re>e.re?1:n.re<e.re?-1:n.im>e.im?1:n.im<e.im?-1:0},Oe),{isClass:!0});typeof BigInt>"u"&&(BigInt=function(n){if(isNaN(n))throw new Error("");return n});const Et=BigInt(0),cn=BigInt(1),ns=BigInt(2),k1=BigInt(3),ay=BigInt(5),ja=BigInt(10);BigInt(Number.MAX_SAFE_INTEGER);const jCe=2e3,st={s:cn,n:Et,d:cn};function qc(n,e){try{n=BigInt(n)}catch{throw jd()}return n*e}function Bl(n){return typeof n=="bigint"?n:Math.floor(n)}function Tr(n,e){if(e===Et)throw Y4();const t=Object.create(Jo.prototype);t.s=n<Et?-cn:cn,n=n<Et?-n:n;const r=Rm(n,e);return t.n=n/r,t.d=e/r,t}const qCe=[ns*ns,ns,ns*ns,ns,ns*ns,ns*k1,ns,ns*k1];function _0(n){const e=Object.create(null);if(n<=cn)return e[n]=cn,e;const t=r=>{e[r]=(e[r]||Et)+cn};for(;n%ns===Et;)t(ns),n/=ns;for(;n%k1===Et;)t(k1),n/=k1;for(;n%ay===Et;)t(ay),n/=ay;for(let r=0,i=ns+ay;i*i<=n;){for(;n%i===Et;)t(i),n/=i;i+=qCe[r],r=r+1&7}return n>cn&&t(n),e}const Xi=function(n,e){let t=Et,r=cn,i=cn;if(n!=null)if(e!==void 0){if(typeof n=="bigint")t=n;else{if(isNaN(n))throw jd();if(n%1!==0)throw s$();t=BigInt(n)}if(typeof e=="bigint")r=e;else{if(isNaN(e))throw jd();if(e%1!==0)throw s$();r=BigInt(e)}i=t*r}else if(typeof n=="object"){if("d"in n&&"n"in n)t=BigInt(n.n),r=BigInt(n.d),"s"in n&&(t*=BigInt(n.s));else if(0 in n)t=BigInt(n[0]),1 in n&&(r=BigInt(n[1]));else if(typeof n=="bigint")t=n;else throw jd();i=t*r}else if(typeof n=="number"){if(isNaN(n))throw jd();if(n<0&&(i=-cn,n=-n),n%1===0)t=BigInt(n);else{let s=1,a=0,o=1,l=1,u=1,c=1e7;for(n>=1&&(s=10**Math.floor(1+Math.log10(n)),n/=s);o<=c&&u<=c;){let h=(a+l)/(o+u);if(n===h){o+u<=c?(t=a+l,r=o+u):u>o?(t=l,r=u):(t=a,r=o);break}else n>h?(a+=l,o+=u):(l+=a,u+=o),o>c?(t=l,r=u):(t=a,r=o)}t=BigInt(t)*BigInt(s),r=BigInt(r)}}else if(typeof n=="string"){let s=0,a=Et,o=Et,l=Et,u=cn,c=cn,h=n.replace(/_/g,"").match(/\d+|./g);if(h===null)throw jd();if(h[s]==="-"?(i=-cn,s++):h[s]==="+"&&s++,h.length===s+1?o=qc(h[s++],i):h[s+1]==="."||h[s]==="."?(h[s]!=="."&&(a=qc(h[s++],i)),s++,(s+1===h.length||h[s+1]==="("&&h[s+3]===")"||h[s+1]==="'"&&h[s+3]==="'")&&(o=qc(h[s],i),u=ja**BigInt(h[s].length),s++),(h[s]==="("&&h[s+2]===")"||h[s]==="'"&&h[s+2]==="'")&&(l=qc(h[s+1],i),c=ja**BigInt(h[s+1].length)-cn,s+=3)):h[s+1]==="/"||h[s+1]===":"?(o=qc(h[s],i),u=qc(h[s+2],cn),s+=3):h[s+3]==="/"&&h[s+1]===" "&&(a=qc(h[s],i),o=qc(h[s+2],i),u=qc(h[s+4],cn),s+=5),h.length<=s)r=u*c,i=t=l+r*a+c*o;else throw jd()}else if(typeof n=="bigint")t=n,i=n,r=cn;else throw jd();if(r===Et)throw Y4();st.s=i<Et?-cn:cn,st.n=t<Et?-t:t,st.d=r<Et?-r:r};function WCe(n,e,t){let r=cn;for(;e>Et;n=n*n%t,e>>=cn)e&cn&&(r=r*n%t);return r}function XCe(n,e){for(;e%ns===Et;e/=ns);for(;e%ay===Et;e/=ay);if(e===cn)return Et;let t=ja%e,r=1;for(;t!==cn;r++)if(t=t*ja%e,r>jCe)return Et;return BigInt(r)}function KCe(n,e,t){let r=cn,i=WCe(ja,t,e);for(let s=0;s<300;s++){if(r===i)return BigInt(s);r=r*ja%e,i=i*ja%e}return 0}function Rm(n,e){if(!n)return e;if(!e)return n;for(;;){if(n%=e,!n)return e;if(e%=n,!e)return n}}function Jo(n,e){if(Xi(n,e),this instanceof Jo)n=Rm(st.d,st.n),this.s=st.s,this.n=st.n/n,this.d=st.d/n;else return Tr(st.s*st.n,st.d)}const Y4=function(){return new Error("Division by Zero")},jd=function(){return new Error("Invalid argument")},s$=function(){return new Error("Parameters must be integer")};Jo.prototype={s:cn,n:Et,d:cn,abs:function(){return Tr(this.n,this.d)},neg:function(){return Tr(-this.s*this.n,this.d)},add:function(n,e){return Xi(n,e),Tr(this.s*this.n*st.d+st.s*this.d*st.n,this.d*st.d)},sub:function(n,e){return Xi(n,e),Tr(this.s*this.n*st.d-st.s*this.d*st.n,this.d*st.d)},mul:function(n,e){return Xi(n,e),Tr(this.s*st.s*this.n*st.n,this.d*st.d)},div:function(n,e){return Xi(n,e),Tr(this.s*st.s*this.n*st.d,this.d*st.n)},clone:function(){return Tr(this.s*this.n,this.d)},mod:function(n,e){if(n===void 0)return Tr(this.s*this.n%this.d,cn);if(Xi(n,e),Et===st.n*this.d)throw Y4();return Tr(this.s*(st.d*this.n)%(st.n*this.d),st.d*this.d)},gcd:function(n,e){return Xi(n,e),Tr(Rm(st.n,this.n)*Rm(st.d,this.d),st.d*this.d)},lcm:function(n,e){return Xi(n,e),st.n===Et&&this.n===Et?Tr(Et,cn):Tr(st.n*this.n,Rm(st.n,this.n)*Rm(st.d,this.d))},inverse:function(){return Tr(this.s*this.d,this.n)},pow:function(n,e){if(Xi(n,e),st.d===cn)return st.s<Et?Tr((this.s*this.d)**st.n,this.n**st.n):Tr((this.s*this.n)**st.n,this.d**st.n);if(this.s<Et)return null;let t=_0(this.n),r=_0(this.d),i=cn,s=cn;for(let a in t)if(a!=="1"){if(a==="0"){i=Et;break}if(t[a]*=st.n,t[a]%st.d===Et)t[a]/=st.d;else return null;i*=BigInt(a)**t[a]}for(let a in r)if(a!=="1"){if(r[a]*=st.n,r[a]%st.d===Et)r[a]/=st.d;else return null;s*=BigInt(a)**r[a]}return st.s<Et?Tr(s,i):Tr(i,s)},log:function(n,e){if(Xi(n,e),this.s<=Et||st.s<=Et)return null;const t=Object.create(null),r=_0(st.n),i=_0(st.d),s=_0(this.n),a=_0(this.d);for(const u in i)r[u]=(r[u]||Et)-i[u];for(const u in a)s[u]=(s[u]||Et)-a[u];for(const u in r)u!=="1"&&(t[u]=!0);for(const u in s)u!=="1"&&(t[u]=!0);let o=null,l=null;for(const u in t){const c=r[u]||Et,h=s[u]||Et;if(c===Et){if(h!==Et)return null;continue}let d=h,f=c;const p=Rm(d,f);if(d/=p,f/=p,o===null&&l===null)o=d,l=f;else if(d*l!==o*f)return null}return o!==null&&l!==null?Tr(o,l):null},equals:function(n,e){return Xi(n,e),this.s*this.n*st.d===st.s*st.n*this.d},lt:function(n,e){return Xi(n,e),this.s*this.n*st.d<st.s*st.n*this.d},lte:function(n,e){return Xi(n,e),this.s*this.n*st.d<=st.s*st.n*this.d},gt:function(n,e){return Xi(n,e),this.s*this.n*st.d>st.s*st.n*this.d},gte:function(n,e){return Xi(n,e),this.s*this.n*st.d>=st.s*st.n*this.d},compare:function(n,e){Xi(n,e);let t=this.s*this.n*st.d-st.s*st.n*this.d;return(Et<t)-(t<Et)},ceil:function(n){return n=ja**BigInt(n||0),Tr(Bl(this.s*n*this.n/this.d)+(n*this.n%this.d>Et&&this.s>=Et?cn:Et),n)},floor:function(n){return n=ja**BigInt(n||0),Tr(Bl(this.s*n*this.n/this.d)-(n*this.n%this.d>Et&&this.s<Et?cn:Et),n)},round:function(n){return n=ja**BigInt(n||0),Tr(Bl(this.s*n*this.n/this.d)+this.s*((this.s>=Et?cn:Et)+ns*(n*this.n%this.d)>this.d?cn:Et),n)},roundTo:function(n,e){Xi(n,e);const t=this.n*st.d,r=this.d*st.n,i=t%r;let s=Bl(t/r);return i+i>=r&&s++,Tr(this.s*s*st.n,st.d)},divisible:function(n,e){return Xi(n,e),st.n===Et?!1:this.n*st.d%(st.n*this.d)===Et},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(n=15){let e=this.n,t=this.d,r=XCe(e,t),i=KCe(e,t,r),s=this.s<Et?"-":"";if(s+=Bl(e/t),e%=t,e*=ja,e&&(s+="."),r){for(let a=i;a--;)s+=Bl(e/t),e%=t,e*=ja;s+="(";for(let a=r;a--;)s+=Bl(e/t),e%=t,e*=ja;s+=")"}else for(let a=n;e&&a--;)s+=Bl(e/t),e%=t,e*=ja;return s},toFraction:function(n=!1){let e=this.n,t=this.d,r=this.s<Et?"-":"";if(t===cn)r+=e;else{const i=Bl(e/t);n&&i>Et&&(r+=i,r+=" ",e%=t),r+=e,r+="/",r+=t}return r},toLatex:function(n=!1){let e=this.n,t=this.d,r=this.s<Et?"-":"";if(t===cn)r+=e;else{const i=Bl(e/t);n&&i>Et&&(r+=i,e%=t),r+="\\frac{",r+=e,r+="}{",r+=t,r+="}"}return r},toContinued:function(){let n=this.n,e=this.d;const t=[];for(;e;){t.push(Bl(n/e));const r=n%e;n=e,e=r}return t},simplify:function(n=.001){const e=BigInt(Math.ceil(1/n)),t=this.abs(),r=t.toContinued();for(let i=1;i<r.length;i++){let s=Tr(r[i-1],cn);for(let o=i-2;o>=0;o--)s=s.inverse().add(r[o]);let a=s.sub(t);if(a.n*e<a.d)return s.mul(this.s)}return this}};var YCe="Fraction",QCe=[],ZCe=re(YCe,QCe,()=>(Object.defineProperty(Jo,"name",{value:"Fraction"}),Jo.prototype.constructor=Jo,Jo.prototype.type="Fraction",Jo.prototype.isFraction=!0,Jo.prototype.toJSON=function(){return{mathjs:"Fraction",n:String(this.s*this.n),d:String(this.d)}},Jo.fromJSON=function(n){return new Jo(n)},Jo),{isClass:!0}),JCe="Range",eDe=[],tDe=re(JCe,eDe,()=>{function n(e,t,r){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");var i=e!=null,s=t!=null,a=r!=null;if(i){if(jt(e))e=e.toNumber();else if(typeof e!="number"&&!O1(e))throw new TypeError("Parameter start must be a number or bigint")}if(s){if(jt(t))t=t.toNumber();else if(typeof t!="number"&&!O1(t))throw new TypeError("Parameter end must be a number or bigint")}if(a){if(jt(r))r=r.toNumber();else if(typeof r!="number"&&!O1(r))throw new TypeError("Parameter step must be a number or bigint")}if(this.start=i?parseFloat(e):0,this.end=s?parseFloat(t):0,this.step=a?parseFloat(r):1,a&&os(this.step,0))throw new Error("Step must not be zero")}return n.prototype.type="Range",n.prototype.isRange=!0,n.parse=function(e){if(typeof e!="string")return null;var t=e.split(":"),r=t.map(function(s){return parseFloat(s)}),i=r.some(function(s){return isNaN(s)});if(i)return null;switch(r.length){case 2:return new n(r[0],r[1]);case 3:return new n(r[0],r[2],r[1]);default:return null}},n.prototype.clone=function(){return new n(this.start,this.end,this.step)},n.prototype.size=function(){var e=0,t=this.start,r=this.step,i=this.end,s=i-t;return tp(r)===tp(s)?e=Math.ceil(s/r):s===0&&(e=0),isNaN(e)&&(e=0),[e]},n.prototype.min=function(){var e=this.size()[0];if(e>0)return this.step>0?this.start:this.start+(e-1)*this.step},n.prototype.max=function(){var e=this.size()[0];if(e>0)return this.step>0?this.start+(e-1)*this.step:this.start},n.prototype.forEach=function(e){var t=this.start,r=this.step,i=this.end,s=0;if(r>0)for(;t<i;)e(t,[s],this),t+=r,s++;else if(r<0)for(;t>i;)e(t,[s],this),t+=r,s++},n.prototype.map=function(e){var t=[];return this.forEach(function(r,i,s){t[i[0]]=e(r,i,s)}),t},n.prototype.toArray=function(){var e=[];return this.forEach(function(t,r){e[r[0]]=t}),e},n.prototype.valueOf=function(){return this.toArray()},n.prototype.format=function(e){var t=dv(this.start,e);return this.step!==1&&(t+=":"+dv(this.step,e)),t+=":"+dv(this.end,e),t},n.prototype.toString=function(){return this.format()},n.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},n.fromJSON=function(e){return new n(e.start,e.end,e.step)},n},{isClass:!0}),nDe="Matrix",rDe=[],iDe=re(nDe,rDe,()=>{function n(){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator")}return n.prototype.type="Matrix",n.prototype.isMatrix=!0,n.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},n.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},n.prototype.create=function(e,t){throw new Error("Cannot invoke create on a Matrix interface")},n.prototype.subset=function(e,t,r){throw new Error("Cannot invoke subset on a Matrix interface")},n.prototype.get=function(e){throw new Error("Cannot invoke get on a Matrix interface")},n.prototype.set=function(e,t,r){throw new Error("Cannot invoke set on a Matrix interface")},n.prototype.resize=function(e,t){throw new Error("Cannot invoke resize on a Matrix interface")},n.prototype.reshape=function(e,t){throw new Error("Cannot invoke reshape on a Matrix interface")},n.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},n.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},n.prototype.map=function(e,t){throw new Error("Cannot invoke map on a Matrix interface")},n.prototype.forEach=function(e){throw new Error("Cannot invoke forEach on a Matrix interface")},n.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},n.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},n.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},n.prototype.format=function(e){throw new Error("Cannot invoke format on a Matrix interface")},n.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},n},{isClass:!0});function QI(n,e,t){var r=n.constructor,i=new r(2),s="";if(t){if(t<1)throw new Error("size must be in greater than 0");if(!bt(t))throw new Error("size must be an integer");if(n.greaterThan(i.pow(t-1).sub(1))||n.lessThan(i.pow(t-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(t-1,", 2^").concat(t-1,"-1]"));if(!n.isInteger())throw new Error("Value must be an integer");n.lessThan(0)&&(n=n.add(i.pow(t))),s="i".concat(t)}switch(e){case 2:return"".concat(n.toBinary()).concat(s);case 8:return"".concat(n.toOctal()).concat(s);case 16:return"".concat(n.toHexadecimal()).concat(s);default:throw new Error("Base ".concat(e," not supported "))}}function sDe(n,e){if(typeof e=="function")return e(n);if(!n.isFinite())return n.isNaN()?"NaN":n.gt(0)?"Infinity":"-Infinity";var{notation:t,precision:r,wordSize:i}=mte(e);switch(t){case"fixed":return oDe(n,r);case"exponential":return a$(n,r);case"engineering":return aDe(n,r);case"bin":return QI(n,2,i);case"oct":return QI(n,8,i);case"hex":return QI(n,16,i);case"auto":{var s=o$(e==null?void 0:e.lowerExp,-3),a=o$(e==null?void 0:e.upperExp,5);if(n.isZero())return"0";var o,l=n.toSignificantDigits(r),u=l.e;return u>=s&&u<a?o=l.toFixed():o=a$(n,r),o.replace(/((\.\d*?)(0+))($|e)/,function(){var c=arguments[2],h=arguments[4];return c!=="."?c+h:h})}default:throw new Error('Unknown notation "'+t+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function aDe(n,e){var t=n.e,r=t%3===0?t:t<0?t-3-t%3:t-t%3,i=n.mul(Math.pow(10,-r)),s=i.toPrecision(e);if(s.includes("e")){var a=n.constructor;s=new a(s).toFixed()}return s+"e"+(t>=0?"+":"")+r.toString()}function a$(n,e){return e!==void 0?n.toExponential(e-1):n.toExponential()}function oDe(n,e){return n.toFixed(e)}function o$(n,e){return Tt(n)?n:jt(n)?n.toNumber():e}function lDe(n,e){var t=n.length-e.length,r=n.length;return n.substring(t,r)===e}function nn(n,e){var t=uDe(n,e);return e&&typeof e=="object"&&"truncate"in e&&t.length>e.truncate?t.substring(0,e.truncate-3)+"...":t}function uDe(n,e){if(typeof n=="number")return dv(n,e);if(jt(n))return sDe(n,e);if(cDe(n))return!e||e.fraction!=="decimal"?"".concat(n.s*n.n,"/").concat(n.d):n.toString();if(Array.isArray(n))return Nte(n,e);if(Jr(n))return oy(n);if(typeof n=="function")return n.syntax?String(n.syntax):"function";if(n&&typeof n=="object"){if(typeof n.format=="function")return n.format(e);if(n&&n.toString(e)!=={}.toString())return n.toString(e);var t=Object.keys(n).map(r=>oy(r)+": "+nn(n[r],e));return"{"+t.join(", ")+"}"}return String(n)}function oy(n){for(var e=String(n),t="",r=0;r<e.length;){var i=e.charAt(r);t+=i in l$?l$[i]:i,r++}return'"'+t+'"'}var l$={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"};function vl(n){var e=String(n);return e=e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e}function Nte(n,e){if(Array.isArray(n)){for(var t="[",r=n.length,i=0;i<r;i++)i!==0&&(t+=", "),t+=Nte(n[i],e);return t+="]",t}else return nn(n,e)}function cDe(n){return n&&typeof n=="object"&&typeof n.s=="bigint"&&typeof n.n=="bigint"&&typeof n.d=="bigint"||!1}function EO(n,e){if(!Jr(n))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+Yn(n)+", index: 0)");if(!Jr(e))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+Yn(e)+", index: 1)");return n===e?0:n>e?1:-1}function en(n,e,t){if(!(this instanceof en))throw new SyntaxError("Constructor must be called with the new operator");this.actual=n,this.expected=e,this.relation=t,this.message="Dimension mismatch ("+(Array.isArray(n)?"["+n.join(", ")+"]":n)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=new Error().stack}en.prototype=new RangeError;en.prototype.constructor=RangeError;en.prototype.name="DimensionError";en.prototype.isDimensionError=!0;function vu(n,e,t){if(!(this instanceof vu))throw new SyntaxError("Constructor must be called with the new operator");this.index=n,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=t),this.min!==void 0&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":this.max!==void 0&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=new Error().stack}vu.prototype=new RangeError;vu.prototype.constructor=RangeError;vu.prototype.name="IndexError";vu.prototype.isIndexError=!0;function Vt(n){for(var e=[];Array.isArray(n);)e.push(n.length),n=n[0];return e}function Rte(n,e,t){var r,i=n.length;if(i!==e[t])throw new en(i,e[t]);if(t<e.length-1){var s=t+1;for(r=0;r<i;r++){var a=n[r];if(!Array.isArray(a))throw new en(e.length-1,e.length,"<");Rte(n[r],e,s)}}else for(r=0;r<i;r++)if(Array.isArray(n[r]))throw new en(e.length+1,e.length,">")}function u$(n,e){var t=e.length===0;if(t){if(Array.isArray(n))throw new en(n.length,0)}else Rte(n,e,0)}function BD(n,e){var t=n.isMatrix?n._size:Vt(n),r=e._sourceSize;r.forEach((i,s)=>{if(i!==null&&i!==t[s])throw new en(i,t[s])})}function sr(n,e){if(n!==void 0){if(!Tt(n)||!bt(n))throw new TypeError("Index must be an integer (value: "+n+")");if(n<0||typeof e=="number"&&n>=e)throw new vu(n,e)}}function wb(n){for(var e=0;e<n._dimensions.length;++e){var t=n._dimensions[e];if(t._data&&Xn(t._data)){if(t._size[0]===0)return!0}else if(t.isRange){if(t.start===t.end)return!0}else if(Jr(t)&&t.length===0)return!0}return!1}function Eb(n,e,t){if(!Array.isArray(e))throw new TypeError("Array expected");if(e.length===0)throw new Error("Resizing to scalar is not supported");e.forEach(function(i){if(!Tt(i)||!bt(i)||i<0)throw new TypeError("Invalid size, must contain positive integers (size: "+nn(e)+")")}),(Tt(n)||jt(n))&&(n=[n]);var r=t!==void 0?t:0;return SO(n,e,0,r),n}function SO(n,e,t,r){var i,s,a=n.length,o=e[t],l=Math.min(a,o);if(n.length=o,t<e.length-1){var u=t+1;for(i=0;i<l;i++)s=n[i],Array.isArray(s)||(s=[s],n[i]=s),SO(s,e,u,r);for(i=l;i<o;i++)s=[],n[i]=s,SO(s,e,u,r)}else{for(i=0;i<l;i++)for(;Array.isArray(n[i]);)n[i]=n[i][0];for(i=l;i<o;i++)n[i]=r}}function Q4(n,e){var t=Tn(n,!0),r=t.length;if(!Array.isArray(n)||!Array.isArray(e))throw new TypeError("Array expected");if(e.length===0)throw new en(0,r,"!=");e=Z4(e,r);var i=Ite(e);if(r!==i)throw new en(i,r,"!=");try{return hDe(t,e)}catch(s){throw s instanceof en?new en(i,r,"!="):s}}function Z4(n,e){var t=Ite(n),r=n.slice(),i=-1,s=n.indexOf(i),a=n.indexOf(i,s+1)>=0;if(a)throw new Error("More than one wildcard in sizes");var o=s>=0,l=e%t===0;if(o)if(l)r[s]=-e/t;else throw new Error("Could not replace wildcard, since "+e+" is no multiple of "+-t);return r}function Ite(n){return n.reduce((e,t)=>e*t,1)}function hDe(n,e){for(var t=n,r,i=e.length-1;i>0;i--){var s=e[i];r=[];for(var a=t.length/s,o=0;o<a;o++)r.push(t.slice(o*s,(o+1)*s));t=r}return t}function UD(n,e){for(var t=Vt(n);Array.isArray(n)&&n.length===1;)n=n[0],t.shift();for(var r=t.length;t[r-1]===1;)r--;return r<t.length&&(n=Pte(n,r,0),t.length=r),n}function Pte(n,e,t){var r,i;if(t<e){var s=t+1;for(r=0,i=n.length;r<i;r++)n[r]=Pte(n[r],e,s)}else for(;Array.isArray(n);)n=n[0];return n}function Fte(n,e,t,r){var i=r||Vt(n);if(t)for(var s=0;s<t;s++)n=[n],i.unshift(1);for(n=Lte(n,e,0);i.length<e;)i.push(1);return n}function Lte(n,e,t){var r,i;if(Array.isArray(n)){var s=t+1;for(r=0,i=n.length;r<i;r++)n[r]=Lte(n[r],e,s)}else for(var a=t;a<e;a++)n=[n];return n}function Tn(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!Array.isArray(n))return n;if(typeof e!="boolean")throw new TypeError("Boolean expected for second argument of flatten");var t=[];return e?i(n):r(n),t;function r(s){for(var a=0;a<s.length;a++){var o=s[a];Array.isArray(o)?r(o):t.push(o)}}function i(s){if(Array.isArray(s[0]))for(var a=0;a<s.length;a++)i(s[a]);else for(var o=0;o<s.length;o++)t.push(s[o])}}function gp(n,e){return Array.prototype.map.call(n,e)}function Ote(n,e){Array.prototype.forEach.call(n,e)}function c$(n,e){if(Vt(n).length!==1)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(n,e)}function h$(n,e){if(Vt(n).length!==1)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(n,t=>e.test(t))}function d$(n,e){return Array.prototype.join.call(n,e)}function Sb(n){if(!Array.isArray(n))throw new TypeError("Array input expected");if(n.length===0)return n;var e=[],t=0;e[0]={value:n[0],identifier:0};for(var r=1;r<n.length;r++)n[r]===n[r-1]?t++:t=0,e.push({value:n[r],identifier:t});return e}function VD(n){if(!Array.isArray(n))throw new TypeError("Array input expected");if(n.length===0)return n;for(var e=[],t=0;t<n.length;t++)e.push(n[t].value);return e}function kN(n,e){for(var t,r=0,i=0;i<n.length;i++){var s=n[i],a=Array.isArray(s);if(i===0&&a&&(r=s.length),a&&s.length!==r)return;var o=a?kN(s,e):e(s);if(t===void 0)t=o;else if(t!==o)return"mixed"}return t}function kte(n,e,t,r){if(r<t){if(n.length!==e.length)throw new en(n.length,e.length);for(var i=[],s=0;s<n.length;s++)i[s]=kte(n[s],e[s],t,r+1);return i}else return n.concat(e)}function Bte(){var n=Array.prototype.slice.call(arguments,0,-1),e=Array.prototype.slice.call(arguments,-1);if(n.length===1)return n[0];if(n.length>1)return n.slice(1).reduce(function(t,r){return kte(t,r,e,0)},n[0]);throw new Error("Wrong number of arguments in function concat")}function zD(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];for(var r=e.map(d=>d.length),i=Math.max(...r),s=new Array(i).fill(null),a=0;a<e.length;a++)for(var o=e[a],l=r[a],u=0;u<l;u++){var c=i-l+u;o[u]>s[c]&&(s[c]=o[u])}for(var h=0;h<e.length;h++)Ute(e[h],s);return s}function Ute(n,e){for(var t=e.length,r=n.length,i=0;i<r;i++){var s=t-r+i;if(n[i]<e[s]&&n[i]>1||n[i]>e[s])throw new Error("shape mismatch: mismatch is found in arg with shape (".concat(n,") not possible to broadcast dimension ").concat(r," with size ").concat(n[i]," to size ").concat(e[s]))}}function Gm(n,e){var t=Vt(n);if(yd(t,e))return n;Ute(t,e);var r=zD(t,e),i=r.length,s=[...Array(i-t.length).fill(1),...t],a=fDe(n);t.length<i&&(a=Q4(a,s),t=Vt(a));for(var o=0;o<i;o++)t[o]<r[o]&&(a=dDe(a,r[o],o),t=Vt(a));return a}function dDe(n,e,t){return Bte(...Array(e).fill(n),t)}function $D(n,e){if(!Array.isArray(n))throw new Error("Array expected");var t=Vt(n);if(e.length!==t.length)throw new en(e.length,t.length);for(var r=0;r<e.length;r++)sr(e[r],t[r]);return e.reduce((i,s)=>i[s],n)}function AO(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n.length===0)return[];if(t)return s(n);var r=[];return i(n,0);function i(a,o){if(Array.isArray(a)){for(var l=a.length,u=Array(l),c=0;c<l;c++)r[o]=c,u[c]=i(a[c],o+1);return u}else return e(a,r.slice(0,o),n)}function s(a){if(Array.isArray(a)){for(var o=a.length,l=Array(o),u=0;u<o;u++)l[u]=s(a[u]);return l}else return e(a)}}function Vte(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n.length===0)return;if(t){s(n);return}var r=[];i(n,0);function i(a,o){if(Array.isArray(a))for(var l=a.length,u=0;u<l;u++)r[o]=u,i(a[u],o+1);else e(a,r.slice(0,o),n)}function s(a){if(Array.isArray(a))for(var o=a.length,l=0;l<o;l++)s(a[l]);else e(a)}}function fDe(n){return li([],n)}function Dv(n,e,t,r){if(FD.isTypedFunction(n)){var i;if(r)i=1;else{var s=e.isMatrix?e.size():Vt(e),a=s.length?s[s.length-1]===0:!0;if(a)return{isUnary:r,fn:n};var o=s.map(()=>0),l=e.isMatrix?e.get(o):$D(e,o);i=gDe(n,l,o,e)}var u;if(e.isMatrix&&e.dataType!=="mixed"&&e.dataType!==void 0){var c=pDe(n,i);u=c!==void 0?c:n}else u=n;return i>=1&&i<=3?{isUnary:i===1,fn:function(){for(var d=arguments.length,f=new Array(d),p=0;p<d;p++)f[p]=arguments[p];return f$(u,f.slice(0,i),t,n.name)}}:{isUnary:!1,fn:function(){for(var d=arguments.length,f=new Array(d),p=0;p<d;p++)f[p]=arguments[p];return f$(u,f,t,n.name)}}}return r===void 0?{isUnary:mDe(n),fn:n}:{isUnary:r,fn:n}}function pDe(n,e){var t=[];if(Object.entries(n.signatures).forEach(r=>{var[i,s]=r;i.split(",").length===e&&t.push(s)}),t.length===1)return t[0]}function mDe(n){if(n.length!==1)return!1;var e=n.toString();if(/arguments/.test(e))return!1;var t=e.match(/\(.*?\)/);return!/\.\.\./.test(t)}function gDe(n,e,t,r){for(var i=[e,t,r],s=3;s>0;s--){var a=i.slice(0,s);if(FD.resolve(n,a)!==null)return s}}function f$(n,e,t,r){try{return n(...e)}catch(i){vDe(i,e,t,r)}}function vDe(n,e,t,r){var i;if(n instanceof TypeError&&((i=n.data)===null||i===void 0?void 0:i.category)==="wrongType"){var s=[];throw s.push("value: ".concat(Yn(e[0]))),e.length>=2&&s.push("index: ".concat(Yn(e[1]))),e.length>=3&&s.push("array: ".concat(Yn(e[2]))),new TypeError("Function ".concat(t," cannot apply callback arguments ")+"".concat(r,"(").concat(s.join(", "),") at index ").concat(JSON.stringify(e[1])))}else throw new TypeError("Function ".concat(t," cannot apply callback arguments ")+"to function ".concat(r,": ").concat(n.message))}var yDe="DenseMatrix",xDe=["Matrix","config"],bDe=re(yDe,xDe,n=>{var{Matrix:e,config:t}=n;function r(h,d){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(d&&!Jr(d))throw new Error("Invalid datatype: "+d);if(Dt(h))h.type==="DenseMatrix"?(this._data=Ut(h._data),this._size=Ut(h._size),this._datatype=d||h._datatype):(this._data=h.toArray(),this._size=h.size(),this._datatype=d||h._datatype);else if(h&&Xn(h.data)&&Xn(h.size))this._data=h.data,this._size=h.size,u$(this._data,this._size),this._datatype=d||h.datatype;else if(Xn(h))this._data=c(h),this._size=Vt(this._data),u$(this._data,this._size),this._datatype=d;else{if(h)throw new TypeError("Unsupported type of data ("+Yn(h)+")");this._data=[],this._size=[0],this._datatype=d}}r.prototype=new e,r.prototype.createDenseMatrix=function(h,d){return new r(h,d)},Object.defineProperty(r,"name",{value:"DenseMatrix"}),r.prototype.constructor=r,r.prototype.type="DenseMatrix",r.prototype.isDenseMatrix=!0,r.prototype.getDataType=function(){return kN(this._data,Yn)},r.prototype.storage=function(){return"dense"},r.prototype.datatype=function(){return this._datatype},r.prototype.create=function(h,d){return new r(h,d)},r.prototype.subset=function(h,d,f){switch(arguments.length){case 1:return i(this,h);case 2:case 3:return a(this,h,d,f);default:throw new SyntaxError("Wrong number of arguments")}},r.prototype.get=function(h){return $D(this._data,h)},r.prototype.set=function(h,d,f){if(!Xn(h))throw new TypeError("Array expected");if(h.length<this._size.length)throw new en(h.length,this._size.length,"<");var p,m,y,v=h.map(function(x){return x+1});u(this,v,f);var b=this._data;for(p=0,m=h.length-1;p<m;p++)y=h[p],sr(y,b.length),b=b[y];return y=h[h.length-1],sr(y,b.length),b[y]=d,this};function i(h,d){if(!NN(d))throw new TypeError("Invalid index");var f=t.legacySubset?d.size().every(_=>_===1):d.isScalar();if(f)return h.get(d.min());var p=d.size();if(p.length!==h._size.length)throw new en(p.length,h._size.length);for(var m=d.min(),y=d.max(),v=0,b=h._size.length;v<b;v++)sr(m[v],h._size[v]),sr(y[v],h._size[v]);var x=new r,w=s(h._data,d);return x._size=w.size,x._datatype=h._datatype,x._data=w.data,t.legacySubset?x.reshape(d.size()):x}function s(h,d){var f=d.size().length-1,p=Array(f);return{data:m(h),size:p.filter(y=>y!==null)};function m(y){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=d.dimension(v);function x(w,_){return Tt(w)?_(w):w.map(_).valueOf()}return Tt(b)?p[v]=null:p[v]=b.size()[0],v<f?x(b,w=>(sr(w,y.length),m(y[w],v+1))):x(b,w=>(sr(w,y.length),y[w]))}}function a(h,d,f,p){if(!d||d.isIndex!==!0)throw new TypeError("Invalid index");var m=d.size(),y=d.isScalar(),v;if(Dt(f)?(v=f.size(),f=f.valueOf()):v=Vt(f),y){if(v.length!==0)throw new TypeError("Scalar expected");h.set(d.min(),f,p)}else{if(!yd(v,m)){if(v.length===0)f=Gm([f],m);else try{f=Gm(f,m)}catch{}v=Vt(f)}if(m.length<h._size.length)throw new en(m.length,h._size.length,"<");if(v.length<m.length){for(var b=0,x=0;m[b]===1&&v[b]===1;)b++;for(;m[b]===1;)x++,b++;f=Fte(f,m.length,x,v)}if(!yd(m,v))throw new en(m,v,">");var w=d.max().map(function(_){return _+1});u(h,w,p),o(h._data,d,f)}return h}function o(h,d,f){var p=d.size().length-1;m(h,f);function m(y,v){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,x=d.dimension(b),w=(E,A)=>{sr(E,y.length),m(y[E],v[A[0]],b+1)},_=(E,A)=>{sr(E,y.length),y[E]=v[A[0]]};b<p?Tt(x)?w(x,[0]):x.forEach(w):Tt(x)?_(x,[0]):x.forEach(_)}}r.prototype.resize=function(h,d,f){if(!Vo(h))throw new TypeError("Array or Matrix expected");var p=h.valueOf().map(y=>Array.isArray(y)&&y.length===1?y[0]:y),m=f?this.clone():this;return l(m,p,d)};function l(h,d,f){if(d.length===0){for(var p=h._data;Xn(p);)p=p[0];return p}return h._size=d.slice(0),h._data=Eb(h._data,h._size,f),h}r.prototype.reshape=function(h,d){var f=d?this.clone():this;f._data=Q4(f._data,h);var p=f._size.reduce((m,y)=>m*y);return f._size=Z4(h,p),f};function u(h,d,f){for(var p=h._size.slice(0),m=!1;p.length<d.length;)p.push(0),m=!0;for(var y=0,v=d.length;y<v;y++)d[y]>p[y]&&(p[y]=d[y],m=!0);m&&l(h,p,f)}r.prototype.clone=function(){var h=new r({data:Ut(this._data),size:Ut(this._size),datatype:this._datatype});return h},r.prototype.size=function(){return this._size.slice(0)},r.prototype.map=function(h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,f=this,p=f._size.length-1;if(p<0)return f.clone();var m=Dv(h,f,"map",d),y=m.fn,v=f.create(void 0,f._datatype);if(v._size=f._size,d||m.isUnary)return v._data=A(f._data),v;if(p===0){for(var b=f.valueOf(),x=Array(b.length),w=0;w<b.length;w++)x[w]=y(b[w],[w],f);return v._data=x,v}var _=[];return v._data=E(f._data),v;function E(T){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,M=Array(T.length);if(S<p)for(var D=0;D<T.length;D++)_[S]=D,M[D]=E(T[D],S+1);else for(var N=0;N<T.length;N++)_[S]=N,M[N]=y(T[N],_.slice(),f);return M}function A(T){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,M=Array(T.length);if(S<p)for(var D=0;D<T.length;D++)M[D]=A(T[D],S+1);else for(var N=0;N<T.length;N++)M[N]=y(T[N]);return M}},r.prototype.forEach=function(h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,f=this,p=f._size.length-1;if(p<0)return;var m=Dv(h,f,"map",d),y=m.fn;if(d||m.isUnary){w(f._data);return}if(p===0){for(var v=0;v<f._data.length;v++)y(f._data[v],[v],f);return}var b=[];x(f._data);function x(_){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(E<p)for(var A=0;A<_.length;A++)b[E]=A,x(_[A],E+1);else for(var T=0;T<_.length;T++)b[E]=T,y(_[T],b.slice(),f)}function w(_){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(E<p)for(var A=0;A<_.length;A++)w(_[A],E+1);else for(var T=0;T<_.length;T++)y(_[T])}},r.prototype[Symbol.iterator]=function*(){var h=this._size.length-1;if(!(h<0)){if(h===0){for(var d=0;d<this._data.length;d++)yield{value:this._data[d],index:[d]};return}for(var f=Array(h+1).fill(0),p=this._size.reduce((x,w)=>x*w,1),m=0;m<p;m++){for(var y=this._data,v=0;v<h;v++)y=y[f[v]];yield{value:y[f[h]],index:f.slice()};for(var b=h;b>=0&&(f[b]++,!(f[b]<this._size[b]));b--)f[b]=0}}},r.prototype.rows=function(){var h=[],d=this.size();if(d.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");var f=this._data;for(var p of f)h.push(new r([p],this._datatype));return h},r.prototype.columns=function(){var h=this,d=[],f=this.size();if(f.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var p=this._data,m=function(b){var x=p.map(w=>[w[b]]);d.push(new r(x,h._datatype))},y=0;y<f[1];y++)m(y);return d},r.prototype.toArray=function(){return Ut(this._data)},r.prototype.valueOf=function(){return this._data},r.prototype.format=function(h){return nn(this._data,h)},r.prototype.toString=function(){return nn(this._data)},r.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.prototype.diagonal=function(h){if(h){if(jt(h)&&(h=h.toNumber()),!Tt(h)||!bt(h))throw new TypeError("The parameter k must be an integer number")}else h=0;for(var d=h>0?h:0,f=h<0?-h:0,p=this._size[0],m=this._size[1],y=Math.min(p-f,m-d),v=[],b=0;b<y;b++)v[b]=this._data[b+f][b+d];return new r({data:v,size:[y],datatype:this._datatype})},r.diagonal=function(h,d,f,p){if(!Xn(h))throw new TypeError("Array expected, size parameter");if(h.length!==2)throw new Error("Only two dimensions matrix are supported");if(h=h.map(function(T){if(jt(T)&&(T=T.toNumber()),!Tt(T)||!bt(T)||T<1)throw new Error("Size values must be positive integers");return T}),f){if(jt(f)&&(f=f.toNumber()),!Tt(f)||!bt(f))throw new TypeError("The parameter k must be an integer number")}else f=0;var m=f>0?f:0,y=f<0?-f:0,v=h[0],b=h[1],x=Math.min(v-y,b-m),w;if(Xn(d)){if(d.length!==x)throw new Error("Invalid value array length");w=function(S){return d[S]}}else if(Dt(d)){var _=d.size();if(_.length!==1||_[0]!==x)throw new Error("Invalid matrix length");w=function(S){return d.get([S])}}else w=function(){return d};p||(p=jt(w(0))?w(0).mul(0):0);var E=[];if(h.length>0){E=Eb(E,h,p);for(var A=0;A<x;A++)E[A+y][A+m]=w(A)}return new r({data:E,size:[v,b]})},r.fromJSON=function(h){return new r(h)},r.prototype.swapRows=function(h,d){if(!Tt(h)||!bt(h)||!Tt(d)||!bt(d))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return sr(h,this._size[0]),sr(d,this._size[0]),r._swapRows(h,d,this._data),this},r._swapRows=function(h,d,f){var p=f[h];f[h]=f[d],f[d]=p};function c(h){return Dt(h)?c(h.valueOf()):Xn(h)?h.map(c):h}return r},{isClass:!0}),p$="clone",_De=["typed"],wDe=re(p$,_De,n=>{var{typed:e}=n;return e(p$,{any:Ut})});function zte(n){var e=n.length,t=n[0].length,r,i,s=[];for(i=0;i<t;i++){var a=[];for(r=0;r<e;r++)a.push(n[r][i]);s.push(a)}return s}function Wb(n){for(var e=0;e<n.length;e++)if(Vo(n[e]))return!0;return!1}function Op(n,e){Dt(n)?n.forEach(t=>e(t),!1,!0):Vte(n,e,!0)}function qt(n,e,t){if(!t)return Dt(n)?n.map(i=>e(i),!1,!0):AO(n,e,!0);var r=i=>i===0?i:e(i);return Dt(n)?n.map(i=>r(i),!1,!0):AO(n,r,!0)}function BN(n,e,t){var r=Array.isArray(n)?Vt(n):n.size();if(e<0||e>=r.length)throw new vu(e,r.length);return Dt(n)?n.create(HD(n.valueOf(),e,t),n.datatype()):HD(n,e,t)}function HD(n,e,t){var r,i,s,a;if(e<=0)if(Array.isArray(n[0])){for(a=zte(n),i=[],r=0;r<a.length;r++)i[r]=HD(a[r],e-1,t);return i}else{for(s=n[0],r=1;r<n.length;r++)s=t(s,n[r]);return s}else{for(i=[],r=0;r<n.length;r++)i[r]=HD(n[r],e-1,t);return i}}function m$(n,e,t,r,i,s,a,o,l,u,c){var h=n._values,d=n._index,f=n._ptr,p,m,y,v;if(r)for(m=f[e],y=f[e+1],p=m;p<y;p++)v=d[p],t[v]!==s?(t[v]=s,a.push(v),r[v]=h[p]):(r[v]=o(r[v],h[p]),i[v]=s);else for(m=f[e],y=f[e+1],p=m;p<y;p++)v=d[p],t[v]!==s?(t[v]=s,a.push(v)):i[v]=s}var g$="isInteger",EDe=["typed","equal"],SDe=re(g$,EDe,n=>{var{typed:e,equal:t}=n;return e(g$,{number:r=>Number.isFinite(r)?t(r,Math.round(r)):!1,BigNumber:r=>r.isFinite()?t(r.round(),r):!1,bigint:r=>!0,Fraction:r=>r.d===1n,"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))})}),yu="number",Xb="number, number";function $te(n){return Math.abs(n)}$te.signature=yu;function Hte(n,e){return n+e}Hte.signature=Xb;function Gte(n,e){return n-e}Gte.signature=Xb;function jte(n,e){return n*e}jte.signature=Xb;function qte(n){return-n}qte.signature=yu;function Wte(n){return n}Wte.signature=yu;function p1(n){return TMe(n)}p1.signature=yu;function Xte(n){return n*n*n}Xte.signature=yu;function Kte(n){return Math.exp(n)}Kte.signature=yu;function Yte(n){return MMe(n)}Yte.signature=yu;function Qte(n,e){if(!bt(n)||!bt(e))throw new Error("Parameters in function lcm must be integer numbers");if(n===0||e===0)return 0;for(var t,r=n*e;e!==0;)t=e,e=n%t,n=t;return Math.abs(r/n)}Qte.signature=Xb;function v$(n,e){return e?Math.log(n)/Math.log(e):Math.log(n)}function GD(n){return SMe(n)}GD.signature=yu;function TO(n){return EMe(n)}TO.signature=yu;function y$(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,t=e<0;if(t&&(e=-e),e===0)throw new Error("Root must be non-zero");if(n<0&&Math.abs(e)%2!==1)throw new Error("Root must be odd when a is negative.");if(n===0)return t?1/0:0;if(!isFinite(n))return t?0:n;var r=Math.pow(Math.abs(n),1/e);return r=n<0?-r:r,t?1/r:r}function MO(n){return tp(n)}MO.signature=yu;function Zte(n){return n*n}Zte.signature=yu;function Jte(n,e){var t,r,i,s=0,a=1,o=1,l=0;if(!bt(n)||!bt(e))throw new Error("Parameters in function xgcd must be integer numbers");for(;e;)r=Math.floor(n/e),i=n-r*e,t=s,s=a-r*s,a=t,t=o,o=l-r*o,l=t,n=e,e=i;var u;return n<0?u=[-n,-a,-l]:u=[n,n?a:0,l],u}Jte.signature=Xb;function ene(n,e){return n*n<1&&e===1/0||n*n>1&&e===-1/0?0:Math.pow(n,e)}ene.signature=Xb;function R_(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!bt(e)||e<0||e>15)throw new Error("Number of decimals in function round must be an integer from 0 to 15 inclusive");return parseFloat(gte(n,e))}var ADe="number",Kb="number, number";function tne(n,e){if(!bt(n)||!bt(e))throw new Error("Integers expected in function bitAnd");return n&e}tne.signature=Kb;function nne(n){if(!bt(n))throw new Error("Integer expected in function bitNot");return~n}nne.signature=ADe;function rne(n,e){if(!bt(n)||!bt(e))throw new Error("Integers expected in function bitOr");return n|e}rne.signature=Kb;function ine(n,e){if(!bt(n)||!bt(e))throw new Error("Integers expected in function bitXor");return n^e}ine.signature=Kb;function sne(n,e){if(!bt(n)||!bt(e))throw new Error("Integers expected in function leftShift");return n<<e}sne.signature=Kb;function ane(n,e){if(!bt(n)||!bt(e))throw new Error("Integers expected in function rightArithShift");return n>>e}ane.signature=Kb;function one(n,e){if(!bt(n)||!bt(e))throw new Error("Integers expected in function rightLogShift");return n>>>e}one.signature=Kb;function Gh(n,e){if(e<n)return 1;if(e===n)return e;var t=e+n>>1;return Gh(n,t)*Gh(t+1,e)}function lne(n,e){if(!bt(n)||n<0)throw new TypeError("Positive integer value expected in function combinations");if(!bt(e)||e<0)throw new TypeError("Positive integer value expected in function combinations");if(e>n)throw new TypeError("k must be less than or equal to n");for(var t=n-e,r=1,i=e<t?t+1:e+1,s=2,a=e<t?e:t,o=i;o<=n;++o)for(r*=o;s<=a&&r%s===0;)r/=s,++s;return s<=a&&(r/=Gh(s,a)),r}lne.signature="number, number";var TDe=Math.PI,MDe=2*Math.PI,CDe=Math.E,DDe=1.618033988749895,NDe="number",J4="number, number";function une(n){return!n}une.signature=NDe;function CO(n,e){return!!(n||e)}CO.signature=J4;function DO(n,e){return!!n!=!!e}DO.signature=J4;function NO(n,e){return!!(n&&e)}NO.signature=J4;function jD(n){var e;if(bt(n))return n<=0?Number.isFinite(n)?1/0:NaN:n>171?1/0:Gh(1,n-1);if(n<.5)return Math.PI/(Math.sin(Math.PI*n)*jD(1-n));if(n>=171.35)return 1/0;if(n>85){var t=n*n,r=t*n,i=r*n,s=i*n;return Math.sqrt(2*Math.PI/n)*Math.pow(n/Math.E,n)*(1+1/(12*n)+1/(288*t)-139/(51840*r)-571/(2488320*i)+163879/(209018880*s)+5246819/(75246796800*s*n))}--n,e=Cy[0];for(var a=1;a<Cy.length;++a)e+=Cy[a]/(n+a);var o=n+cne+.5;return Math.sqrt(2*Math.PI)*Math.pow(o,n+.5)*Math.exp(-o)*e}jD.signature="number";var cne=4.7421875,Cy=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],hne=.9189385332046728,RDe=5,IDe=7,x$=[1.000000000190015,76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];function qD(n){if(n<0)return NaN;if(n===0)return 1/0;if(!Number.isFinite(n))return n;if(n<.5)return Math.log(Math.PI/Math.sin(Math.PI*n))-qD(1-n);n=n-1;for(var e=n+RDe+.5,t=x$[0],r=IDe-1;r>=1;r--)t+=x$[r]/(n+r);return hne+(n+.5)*Math.log(e)-e+Math.log(t)}qD.signature="number";var ia="number";function dne(n){return RMe(n)}dne.signature=ia;function fne(n){return Math.atan(1/n)}fne.signature=ia;function pne(n){return Number.isFinite(n)?(Math.log((n+1)/n)+Math.log(n/(n-1)))/2:0}pne.signature=ia;function mne(n){return Math.asin(1/n)}mne.signature=ia;function gne(n){var e=1/n;return Math.log(e+Math.sqrt(e*e+1))}gne.signature=ia;function vne(n){return Math.acos(1/n)}vne.signature=ia;function yne(n){var e=1/n,t=Math.sqrt(e*e-1);return Math.log(t+e)}yne.signature=ia;function xne(n){return IMe(n)}xne.signature=ia;function bne(n){return PMe(n)}bne.signature=ia;function _ne(n){return 1/Math.tan(n)}_ne.signature=ia;function wne(n){var e=Math.exp(2*n);return(e+1)/(e-1)}wne.signature=ia;function Ene(n){return 1/Math.sin(n)}Ene.signature=ia;function Sne(n){return n===0?Number.POSITIVE_INFINITY:Math.abs(2/(Math.exp(n)-Math.exp(-n)))*tp(n)}Sne.signature=ia;function Ane(n){return 1/Math.cos(n)}Ane.signature=ia;function Tne(n){return 2/(Math.exp(n)+Math.exp(-n))}Tne.signature=ia;function Mne(n){return LMe(n)}Mne.signature=ia;var eU="number";function Cne(n){return n<0}Cne.signature=eU;function Dne(n){return n>0}Dne.signature=eU;function Nne(n){return Number.isNaN(n)}Nne.signature=eU;function Dl(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e-9,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(t<=0)throw new Error("Relative tolerance must be greater than 0");if(r<0)throw new Error("Absolute tolerance must be at least 0");return n.isNaN()||e.isNaN()?!1:!n.isFinite()||!e.isFinite()?n.eq(e):n.eq(e)?!0:n.minus(e).abs().lte(n.constructor.max(n.constructor.max(n.abs(),e.abs()).mul(t),r))}var b$="isNegative",PDe=["typed","config"],FDe=re(b$,PDe,n=>{var{typed:e,config:t}=n;return e(b$,{number:r=>os(r,0,t.relTol,t.absTol)?!1:Cne(r),BigNumber:r=>Dl(r,new r.constructor(0),t.relTol,t.absTol)?!1:r.isNeg()&&!r.isZero()&&!r.isNaN(),bigint:r=>r<0n,Fraction:r=>r.s<0n,Unit:e.referToSelf(r=>i=>e.find(r,i.valueType())(i.value)),"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))})}),_$="isNumeric",LDe=["typed"],ODe=re(_$,LDe,n=>{var{typed:e}=n;return e(_$,{"number | BigNumber | bigint | Fraction | boolean":()=>!0,"Complex | Unit | string | null | undefined | Node":()=>!1,"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),w$="hasNumericValue",kDe=["typed","isNumeric"],BDe=re(w$,kDe,n=>{var{typed:e,isNumeric:t}=n;return e(w$,{boolean:()=>!0,string:function(i){return i.trim().length>0&&!isNaN(Number(i))},any:function(i){return t(i)}})}),E$="isPositive",UDe=["typed","config"],VDe=re(E$,UDe,n=>{var{typed:e,config:t}=n;return e(E$,{number:r=>os(r,0,t.relTol,t.absTol)?!1:Dne(r),BigNumber:r=>Dl(r,new r.constructor(0),t.relTol,t.absTol)?!1:!r.isNeg()&&!r.isZero()&&!r.isNaN(),bigint:r=>r>0n,Fraction:r=>r.s>0n&&r.n>0n,Unit:e.referToSelf(r=>i=>e.find(r,i.valueType())(i.value)),"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))})}),S$="isZero",zDe=["typed","equalScalar"],$De=re(S$,zDe,n=>{var{typed:e,equalScalar:t}=n;return e(S$,{"number | BigNumber | Complex | Fraction":r=>t(r,0),bigint:r=>r===0n,Unit:e.referToSelf(r=>i=>e.find(r,i.valueType())(i.value)),"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))})}),A$="isNaN",HDe=["typed"],GDe=re(A$,HDe,n=>{var{typed:e}=n;return e(A$,{number:Nne,BigNumber:function(r){return r.isNaN()},bigint:function(r){return!1},Fraction:function(r){return!1},Complex:function(r){return r.isNaN()},Unit:function(r){return Number.isNaN(r.value)},"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),T$="isBounded",jDe=["typed"],qDe=re(T$,jDe,n=>{var{typed:e}=n;return e(T$,{number:t=>Number.isFinite(t),"BigNumber | Complex":t=>t.isFinite(),"bigint | Fraction":()=>!0,"null | undefined":()=>!1,Unit:e.referToSelf(t=>r=>t(r.value)),"Array | Matrix":e.referToSelf(t=>r=>(Array.isArray(r)||(r=r.valueOf()),r.every(i=>t(i))))})}),M$="isFinite",WDe=["typed","isBounded","map"],XDe=re(M$,WDe,n=>{var{typed:e,isBounded:t,map:r}=n;return e(M$,{"Array | Matrix":i=>r(i,t),any:i=>t(i)})}),C$="typeOf",KDe=["typed"],YDe=re(C$,KDe,n=>{var{typed:e}=n;return e(C$,{any:Yn})});function QDe(n,e,t,r){return os(n.re,e.re,t,r)&&os(n.im,e.im,t,r)}var Yb=re("compareUnits",["typed"],n=>{var{typed:e}=n;return{"Unit, Unit":e.referToSelf(t=>(r,i)=>{if(!r.equalBase(i))throw new Error("Cannot compare units with different base");return e.find(t,[r.valueType(),i.valueType()])(r.value,i.value)})}}),WD="equalScalar",ZDe=["typed","config"],JDe=re(WD,ZDe,n=>{var{typed:e,config:t}=n,r=Yb({typed:e});return e(WD,{"boolean, boolean":function(s,a){return s===a},"number, number":function(s,a){return os(s,a,t.relTol,t.absTol)},"BigNumber, BigNumber":function(s,a){return s.eq(a)||Dl(s,a,t.relTol,t.absTol)},"bigint, bigint":function(s,a){return s===a},"Fraction, Fraction":function(s,a){return s.equals(a)},"Complex, Complex":function(s,a){return QDe(s,a,t.relTol,t.absTol)}},r)});re(WD,["typed","config"],n=>{var{typed:e,config:t}=n;return e(WD,{"number, number":function(i,s){return os(i,s,t.relTol,t.absTol)}})});var e2e="SparseMatrix",t2e=["typed","equalScalar","Matrix"],n2e=re(e2e,t2e,n=>{var{typed:e,equalScalar:t,Matrix:r}=n;function i(m,y){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(y&&!Jr(y))throw new Error("Invalid datatype: "+y);if(Dt(m))s(this,m,y);else if(m&&Xn(m.index)&&Xn(m.ptr)&&Xn(m.size))this._values=m.values,this._index=m.index,this._ptr=m.ptr,this._size=m.size,this._datatype=y||m.datatype;else if(Xn(m))a(this,m,y);else{if(m)throw new TypeError("Unsupported type of data ("+Yn(m)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=y}}function s(m,y,v){y.type==="SparseMatrix"?(m._values=y._values?Ut(y._values):void 0,m._index=Ut(y._index),m._ptr=Ut(y._ptr),m._size=Ut(y._size),m._datatype=v||y._datatype):a(m,y.valueOf(),v||y._datatype)}function a(m,y,v){m._values=[],m._index=[],m._ptr=[],m._datatype=v;var b=y.length,x=0,w=t,_=0;if(Jr(v)&&(w=e.find(t,[v,v])||t,_=e.convert(0,v)),b>0){var E=0;do{m._ptr.push(m._index.length);for(var A=0;A<b;A++){var T=y[A];if(Xn(T)){if(E===0&&x<T.length&&(x=T.length),E<T.length){var S=T[E];w(S,_)||(m._values.push(S),m._index.push(A))}}else E===0&&x<1&&(x=1),w(T,_)||(m._values.push(T),m._index.push(A))}E++}while(E<x)}for(;m._ptr.length<=x;)m._ptr.push(m._index.length);m._size=[b,x]}i.prototype=new r,i.prototype.createSparseMatrix=function(m,y){return new i(m,y)},Object.defineProperty(i,"name",{value:"SparseMatrix"}),i.prototype.constructor=i,i.prototype.type="SparseMatrix",i.prototype.isSparseMatrix=!0,i.prototype.getDataType=function(){return kN(this._values,Yn)},i.prototype.storage=function(){return"sparse"},i.prototype.datatype=function(){return this._datatype},i.prototype.create=function(m,y){return new i(m,y)},i.prototype.density=function(){var m=this._size[0],y=this._size[1];return m!==0&&y!==0?this._index.length/(m*y):0},i.prototype.subset=function(m,y,v){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return o(this,m);case 2:case 3:return l(this,m,y,v);default:throw new SyntaxError("Wrong number of arguments")}};function o(m,y){if(!NN(y))throw new TypeError("Invalid index");var v=y.isScalar();if(v)return m.get(y.min());var b=y.size();if(b.length!==m._size.length)throw new en(b.length,m._size.length);var x,w,_,E,A=y.min(),T=y.max();for(x=0,w=m._size.length;x<w;x++)sr(A[x],m._size[x]),sr(T[x],m._size[x]);var S=m._values,M=m._index,D=m._ptr,N=y.dimension(0),R=y.dimension(1),O=[],G=[];function I(ee,J){G[ee]=J[0],O[ee]=!0}Number.isInteger(N)?I(N,[0]):N.forEach(I);var B=S?[]:void 0,$=[],H=[];function Q(ee){for(H.push($.length),_=D[ee],E=D[ee+1];_<E;_++)x=M[_],O[x]===!0&&($.push(G[x]),B&&B.push(S[_]))}return Number.isInteger(R)?Q(R):R.forEach(Q),H.push($.length),new i({values:B,index:$,ptr:H,size:b,datatype:m._datatype})}function l(m,y,v,b){if(!y||y.isIndex!==!0)throw new TypeError("Invalid index");var x=y.size(),w=y.isScalar(),_;if(Dt(v)?(_=v.size(),v=v.toArray()):_=Vt(v),w){if(_.length!==0)throw new TypeError("Scalar expected");m.set(y.min(),v,b)}else{if(x.length!==1&&x.length!==2)throw new en(x.length,m._size.length,"<");if(_.length<x.length){for(var E=0,A=0;x[E]===1&&_[E]===1;)E++;for(;x[E]===1;)A++,E++;v=Fte(v,x.length,A,_)}if(!yd(x,_))throw new en(x,_,">");if(x.length===1){var T=y.dimension(0);D(T,(N,R)=>{sr(N),m.set([N,0],v[R[0]],b)})}else{var S=y.dimension(0),M=y.dimension(1);D(S,(N,R)=>{sr(N),D(M,(O,G)=>{sr(O),m.set([N,O],v[R[0]][G[0]],b)})})}}return m;function D(N,R){Tt(N)?R(N,[0]):N.forEach(R)}}i.prototype.get=function(m){if(!Xn(m))throw new TypeError("Array expected");if(m.length!==this._size.length)throw new en(m.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var y=m[0],v=m[1];sr(y,this._size[0]),sr(v,this._size[1]);var b=u(y,this._ptr[v],this._ptr[v+1],this._index);return b<this._ptr[v+1]&&this._index[b]===y?this._values[b]:0},i.prototype.set=function(m,y,v){if(!Xn(m))throw new TypeError("Array expected");if(m.length!==this._size.length)throw new en(m.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var b=m[0],x=m[1],w=this._size[0],_=this._size[1],E=t,A=0;Jr(this._datatype)&&(E=e.find(t,[this._datatype,this._datatype])||t,A=e.convert(0,this._datatype)),(b>w-1||x>_-1)&&(d(this,Math.max(b+1,w),Math.max(x+1,_),v),w=this._size[0],_=this._size[1]),sr(b,w),sr(x,_);var T=u(b,this._ptr[x],this._ptr[x+1],this._index);return T<this._ptr[x+1]&&this._index[T]===b?E(y,A)?c(T,x,this._values,this._index,this._ptr):this._values[T]=y:E(y,A)||h(T,b,x,y,this._values,this._index,this._ptr),this};function u(m,y,v,b){if(v-y===0)return v;for(var x=y;x<v;x++)if(b[x]===m)return x;return y}function c(m,y,v,b,x){v.splice(m,1),b.splice(m,1);for(var w=y+1;w<x.length;w++)x[w]--}function h(m,y,v,b,x,w,_){x.splice(m,0,b),w.splice(m,0,y);for(var E=v+1;E<_.length;E++)_[E]++}i.prototype.resize=function(m,y,v){if(!Vo(m))throw new TypeError("Array or Matrix expected");var b=m.valueOf().map(w=>Array.isArray(w)&&w.length===1?w[0]:w);if(b.length!==2)throw new Error("Only two dimensions matrix are supported");b.forEach(function(w){if(!Tt(w)||!bt(w)||w<0)throw new TypeError("Invalid size, must contain positive integers (size: "+nn(b)+")")});var x=v?this.clone():this;return d(x,b[0],b[1],y)};function d(m,y,v,b){var x=b||0,w=t,_=0;Jr(m._datatype)&&(w=e.find(t,[m._datatype,m._datatype])||t,_=e.convert(0,m._datatype),x=e.convert(x,m._datatype));var E=!w(x,_),A=m._size[0],T=m._size[1],S,M,D;if(v>T){for(M=T;M<v;M++)if(m._ptr[M]=m._values.length,E)for(S=0;S<A;S++)m._values.push(x),m._index.push(S);m._ptr[v]=m._values.length}else v<T&&(m._ptr.splice(v+1,T-v),m._values.splice(m._ptr[v],m._values.length),m._index.splice(m._ptr[v],m._index.length));if(T=v,y>A){if(E){var N=0;for(M=0;M<T;M++){m._ptr[M]=m._ptr[M]+N,D=m._ptr[M+1]+N;var R=0;for(S=A;S<y;S++,R++)m._values.splice(D+R,0,x),m._index.splice(D+R,0,S),N++}m._ptr[T]=m._values.length}}else if(y<A){var O=0;for(M=0;M<T;M++){m._ptr[M]=m._ptr[M]-O;var G=m._ptr[M],I=m._ptr[M+1]-O;for(D=G;D<I;D++)S=m._index[D],S>y-1&&(m._values.splice(D,1),m._index.splice(D,1),O++)}m._ptr[M]=m._values.length}return m._size[0]=y,m._size[1]=v,m}i.prototype.reshape=function(m,y){if(!Xn(m))throw new TypeError("Array expected");if(m.length!==2)throw new Error("Sparse matrices can only be reshaped in two dimensions");m.forEach(function(H){if(!Tt(H)||!bt(H)||H<=-2||H===0)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+nn(m)+")")});var v=this._size[0]*this._size[1];m=Z4(m,v);var b=m[0]*m[1];if(v!==b)throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var x=y?this.clone():this;if(this._size[0]===m[0]&&this._size[1]===m[1])return x;for(var w=[],_=0;_<x._ptr.length;_++)for(var E=0;E<x._ptr[_+1]-x._ptr[_];E++)w.push(_);for(var A=x._values.slice(),T=x._index.slice(),S=0;S<x._index.length;S++){var M=T[S],D=w[S],N=M*x._size[1]+D;w[S]=N%m[1],T[S]=Math.floor(N/m[1])}x._values.length=0,x._index.length=0,x._ptr.length=m[1]+1,x._size=m.slice();for(var R=0;R<x._ptr.length;R++)x._ptr[R]=0;for(var O=0;O<A.length;O++){var G=T[O],I=w[O],B=A[O],$=u(G,x._ptr[I],x._ptr[I+1],x._index);h($,G,I,B,x._values,x._index,x._ptr)}return x},i.prototype.clone=function(){var m=new i({values:this._values?Ut(this._values):void 0,index:Ut(this._index),ptr:Ut(this._ptr),size:Ut(this._size),datatype:this._datatype});return m},i.prototype.size=function(){return this._size.slice(0)},i.prototype.map=function(m,y){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var v=this,b=this._size[0],x=this._size[1],w=Dv(m,v,"map"),_=function(A,T,S){return w.fn(A,[T,S],v)};return f(this,0,b-1,0,x-1,_,y)};function f(m,y,v,b,x,w,_){var E=[],A=[],T=[],S=t,M=0;Jr(m._datatype)&&(S=e.find(t,[m._datatype,m._datatype])||t,M=e.convert(0,m._datatype));for(var D=function(L,se,Z){var le=w(L,se,Z);S(le,M)||(E.push(le),A.push(se))},N=b;N<=x;N++){T.push(E.length);var R=m._ptr[N],O=m._ptr[N+1];if(_)for(var G=R;G<O;G++){var I=m._index[G];I>=y&&I<=v&&D(m._values[G],I-y,N-b)}else{for(var B={},$=R;$<O;$++){var H=m._index[$];B[H]=m._values[$]}for(var Q=y;Q<=v;Q++){var ee=Q in B?B[Q]:0;D(ee,Q-y,N-b)}}}return T.push(E.length),new i({values:E,index:A,ptr:T,size:[v-y+1,x-b+1]})}i.prototype.forEach=function(m,y){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var v=this,b=this._size[0],x=this._size[1],w=Dv(m,v,"forEach"),_=0;_<x;_++){var E=this._ptr[_],A=this._ptr[_+1];if(y)for(var T=E;T<A;T++){var S=this._index[T];w.fn(this._values[T],[S,_],v)}else{for(var M={},D=E;D<A;D++){var N=this._index[D];M[N]=this._values[D]}for(var R=0;R<b;R++){var O=R in M?M[R]:0;w.fn(O,[R,_],v)}}}},i.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var m=this._size[1],y=0;y<m;y++)for(var v=this._ptr[y],b=this._ptr[y+1],x=v;x<b;x++){var w=this._index[x];yield{value:this._values[x],index:[w,y]}}},i.prototype.toArray=function(){return p(this._values,this._index,this._ptr,this._size,!0)},i.prototype.valueOf=function(){return p(this._values,this._index,this._ptr,this._size,!1)};function p(m,y,v,b,x){var w=b[0],_=b[1],E=[],A,T;for(A=0;A<w;A++)for(E[A]=[],T=0;T<_;T++)E[A][T]=0;for(T=0;T<_;T++)for(var S=v[T],M=v[T+1],D=S;D<M;D++)A=y[D],E[A][T]=m?x?Ut(m[D]):m[D]:1;return E}return i.prototype.format=function(m){for(var y=this._size[0],v=this._size[1],b=this.density(),x="Sparse Matrix ["+nn(y,m)+" x "+nn(v,m)+"] density: "+nn(b,m)+`
`,w=0;w<v;w++)for(var _=this._ptr[w],E=this._ptr[w+1],A=_;A<E;A++){var T=this._index[A];x+=`
    (`+nn(T,m)+", "+nn(w,m)+") ==> "+(this._values?nn(this._values[A],m):"X")}return x},i.prototype.toString=function(){return nn(this.toArray())},i.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},i.prototype.diagonal=function(m){if(m){if(jt(m)&&(m=m.toNumber()),!Tt(m)||!bt(m))throw new TypeError("The parameter k must be an integer number")}else m=0;var y=m>0?m:0,v=m<0?-m:0,b=this._size[0],x=this._size[1],w=Math.min(b-v,x-y),_=[],E=[],A=[];A[0]=0;for(var T=y;T<x&&_.length<w;T++)for(var S=this._ptr[T],M=this._ptr[T+1],D=S;D<M;D++){var N=this._index[D];if(N===T-y+v){_.push(this._values[D]),E[_.length-1]=N-v;break}}return A.push(_.length),new i({values:_,index:E,ptr:A,size:[w,1]})},i.fromJSON=function(m){return new i(m)},i.diagonal=function(m,y,v,b,x){if(!Xn(m))throw new TypeError("Array expected, size parameter");if(m.length!==2)throw new Error("Only two dimensions matrix are supported");if(m=m.map(function(H){if(jt(H)&&(H=H.toNumber()),!Tt(H)||!bt(H)||H<1)throw new Error("Size values must be positive integers");return H}),v){if(jt(v)&&(v=v.toNumber()),!Tt(v)||!bt(v))throw new TypeError("The parameter k must be an integer number")}else v=0;var w=t,_=0;Jr(x)&&(w=e.find(t,[x,x])||t,_=e.convert(0,x));var E=v>0?v:0,A=v<0?-v:0,T=m[0],S=m[1],M=Math.min(T-A,S-E),D;if(Xn(y)){if(y.length!==M)throw new Error("Invalid value array length");D=function(Q){return y[Q]}}else if(Dt(y)){var N=y.size();if(N.length!==1||N[0]!==M)throw new Error("Invalid matrix length");D=function(Q){return y.get([Q])}}else D=function(){return y};for(var R=[],O=[],G=[],I=0;I<S;I++){G.push(R.length);var B=I-E;if(B>=0&&B<M){var $=D(B);w($,_)||(O.push(B+A),R.push($))}}return G.push(R.length),new i({values:R,index:O,ptr:G,size:[T,S]})},i.prototype.swapRows=function(m,y){if(!Tt(m)||!bt(m)||!Tt(y)||!bt(y))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return sr(m,this._size[0]),sr(y,this._size[0]),i._swapRows(m,y,this._size[1],this._values,this._index,this._ptr),this},i._forEachRow=function(m,y,v,b,x){for(var w=b[m],_=b[m+1],E=w;E<_;E++)x(v[E],y[E])},i._swapRows=function(m,y,v,b,x,w){for(var _=0;_<v;_++){var E=w[_],A=w[_+1],T=u(m,E,A,x),S=u(y,E,A,x);if(T<A&&S<A&&x[T]===m&&x[S]===y){if(b){var M=b[T];b[T]=b[S],b[S]=M}continue}if(T<A&&x[T]===m&&(S>=A||x[S]!==y)){var D=b?b[T]:void 0;x.splice(S,0,y),b&&b.splice(S,0,D),x.splice(S<=T?T+1:T,1),b&&b.splice(S<=T?T+1:T,1);continue}if(S<A&&x[S]===y&&(T>=A||x[T]!==m)){var N=b?b[S]:void 0;x.splice(T,0,m),b&&b.splice(T,0,N),x.splice(T<=S?S+1:S,1),b&&b.splice(T<=S?S+1:S,1)}}},i},{isClass:!0}),r2e="number",i2e=["typed"];function s2e(n){var e=n.match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/);if(e){var t={"0b":2,"0o":8,"0x":16}[e[1]],r=e[2],i=e[3];return{input:n,radix:t,integerPart:r,fractionalPart:i}}else return null}function a2e(n){for(var e=parseInt(n.integerPart,n.radix),t=0,r=0;r<n.fractionalPart.length;r++){var i=parseInt(n.fractionalPart[r],n.radix);t+=i/Math.pow(n.radix,r+1)}var s=e+t;if(isNaN(s))throw new SyntaxError('String "'+n.input+'" is not a valid number');return s}var o2e=re(r2e,i2e,n=>{var{typed:e}=n,t=e("number",{"":function(){return 0},number:function(i){return i},string:function(i){if(i==="NaN")return NaN;var s=s2e(i);if(s)return a2e(s);var a=0,o=i.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);o&&(a=Number(o[2]),i=o[1]);var l=Number(i);if(isNaN(l))throw new SyntaxError('String "'+i+'" is not a valid number');if(o){if(l>2**a-1)throw new SyntaxError('String "'.concat(i,'" is out of range'));l>=2**(a-1)&&(l=l-2**a)}return l},BigNumber:function(i){return i.toNumber()},bigint:function(i){return Number(i)},Fraction:function(i){return i.valueOf()},Unit:e.referToSelf(r=>i=>{var s=i.clone();return s.value=r(i.value),s}),null:function(i){return 0},"Unit, string | Unit":function(i,s){return i.toNumber(s)},"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))});return t.fromJSON=function(r){return parseFloat(r.value)},t}),l2e="bigint",u2e=["typed"],c2e=re(l2e,u2e,n=>{var{typed:e}=n,t=e("bigint",{"":function(){return 0n},bigint:function(i){return i},number:function(i){return BigInt(i.toFixed())},BigNumber:function(i){return BigInt(i.round().toString())},Fraction:function(i){return BigInt(i.valueOf().toFixed())},"string | boolean":function(i){return BigInt(i)},null:function(i){return 0n},"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))});return t.fromJSON=function(r){return BigInt(r.value)},t}),D$="string",h2e=["typed"],d2e=re(D$,h2e,n=>{var{typed:e}=n;return e(D$,{"":function(){return""},number:dv,null:function(r){return"null"},boolean:function(r){return r+""},string:function(r){return r},"Array | Matrix":e.referToSelf(t=>r=>qt(r,t)),any:function(r){return String(r)}})}),N$="boolean",f2e=["typed"],p2e=re(N$,f2e,n=>{var{typed:e}=n;return e(N$,{"":function(){return!1},boolean:function(r){return r},number:function(r){return!!r},null:function(r){return!1},BigNumber:function(r){return!r.isZero()},string:function(r){var i=r.toLowerCase();if(i==="true")return!0;if(i==="false")return!1;var s=Number(r);if(r!==""&&!isNaN(s))return!!s;throw new Error('Cannot convert "'+r+'" to a boolean')},"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),m2e="bignumber",g2e=["typed","BigNumber"],v2e=re(m2e,g2e,n=>{var{typed:e,BigNumber:t}=n;return e("bignumber",{"":function(){return new t(0)},number:function(i){return new t(i+"")},string:function(i){var s=i.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(s){var a=s[2],o=t(s[1]),l=new t(2).pow(Number(a));if(o.gt(l.sub(1)))throw new SyntaxError('String "'.concat(i,'" is out of range'));var u=new t(2).pow(Number(a)-1);return o.gte(u)?o.sub(l):o}return new t(i)},BigNumber:function(i){return i},bigint:function(i){return new t(i.toString())},Unit:e.referToSelf(r=>i=>{var s=i.clone();return s.value=r(i.value),s}),Fraction:function(i){return new t(String(i.n)).div(String(i.d)).times(String(i.s))},null:function(i){return new t(0)},"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))})}),y2e="complex",x2e=["typed","Complex"],b2e=re(y2e,x2e,n=>{var{typed:e,Complex:t}=n;return e("complex",{"":function(){return t.ZERO},number:function(i){return new t(i,0)},"number, number":function(i,s){return new t(i,s)},"BigNumber, BigNumber":function(i,s){return new t(i.toNumber(),s.toNumber())},Fraction:function(i){return new t(i.valueOf(),0)},Complex:function(i){return i.clone()},string:function(i){return t(i)},null:function(i){return t(0)},Object:function(i){if("re"in i&&"im"in i)return new t(i.re,i.im);if("r"in i&&"phi"in i||"abs"in i&&"arg"in i)return new t(i);throw new Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))})}),_2e="fraction",w2e=["typed","Fraction"],E2e=re(_2e,w2e,n=>{var{typed:e,Fraction:t}=n;return e("fraction",{number:function(i){if(!Number.isFinite(i)||isNaN(i))throw new Error(i+" cannot be represented as a fraction");return new t(i)},string:function(i){return new t(i)},"number, number":function(i,s){return new t(i,s)},"bigint, bigint":function(i,s){return new t(i,s)},null:function(i){return new t(0)},BigNumber:function(i){return new t(i.toString())},bigint:function(i){return new t(i.toString())},Fraction:function(i){return i},Unit:e.referToSelf(r=>i=>{var s=i.clone();return s.value=r(i.value),s}),Object:function(i){return new t(i)},"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))})}),R$="matrix",S2e=["typed","Matrix","DenseMatrix","SparseMatrix"],A2e=re(R$,S2e,n=>{var{typed:e,Matrix:t,DenseMatrix:r,SparseMatrix:i}=n;return e(R$,{"":function(){return s([])},string:function(o){return s([],o)},"string, string":function(o,l){return s([],o,l)},Array:function(o){return s(o)},Matrix:function(o){return s(o,o.storage())},"Array | Matrix, string":s,"Array | Matrix, string, string":s});function s(a,o,l){if(o==="dense"||o==="default"||o===void 0)return new r(a,l);if(o==="sparse")return new i(a,l);throw new TypeError("Unknown matrix type "+JSON.stringify(o)+".")}}),I$="matrixFromFunction",T2e=["typed","matrix","isZero"],M2e=re(I$,T2e,n=>{var{typed:e,matrix:t,isZero:r}=n;return e(I$,{"Array | Matrix, function, string, string":function(a,o,l,u){return i(a,o,l,u)},"Array | Matrix, function, string":function(a,o,l){return i(a,o,l)},"Matrix, function":function(a,o){return i(a,o,"dense")},"Array, function":function(a,o){return i(a,o,"dense").toArray()},"Array | Matrix, string, function":function(a,o,l){return i(a,l,o)},"Array | Matrix, string, string, function":function(a,o,l,u){return i(a,u,o,l)}});function i(s,a,o,l){var u;return l!==void 0?u=t(o,l):u=t(o),u.resize(s),u.forEach(function(c,h){var d=a(h);r(d)||u.set(h,d)}),u}}),P$="matrixFromRows",C2e=["typed","matrix","flatten","size"],D2e=re(P$,C2e,n=>{var{typed:e,matrix:t,flatten:r,size:i}=n;return e(P$,{"...Array":function(l){return s(l)},"...Matrix":function(l){return t(s(l.map(u=>u.toArray())))}});function s(o){if(o.length===0)throw new TypeError("At least one row is needed to construct a matrix.");var l=a(o[0]),u=[];for(var c of o){var h=a(c);if(h!==l)throw new TypeError("The vectors had different length: "+(l|0)+"  "+(h|0));u.push(r(c))}return u}function a(o){var l=i(o);if(l.length===1)return l[0];if(l.length===2){if(l[0]===1)return l[1];if(l[1]===1)return l[0];throw new TypeError("At least one of the arguments is not a vector.")}else throw new TypeError("Only one- or two-dimensional vectors are supported.")}}),F$="matrixFromColumns",N2e=["typed","matrix","flatten","size"],R2e=re(F$,N2e,n=>{var{typed:e,matrix:t,flatten:r,size:i}=n;return e(F$,{"...Array":function(l){return s(l)},"...Matrix":function(l){return t(s(l.map(u=>u.toArray())))}});function s(o){if(o.length===0)throw new TypeError("At least one column is needed to construct a matrix.");for(var l=a(o[0]),u=[],c=0;c<l;c++)u[c]=[];for(var h of o){var d=a(h);if(d!==l)throw new TypeError("The vectors had different length: "+(l|0)+"  "+(d|0));for(var f=r(h),p=0;p<l;p++)u[p].push(f[p])}return u}function a(o){var l=i(o);if(l.length===1)return l[0];if(l.length===2){if(l[0]===1)return l[1];if(l[1]===1)return l[0];throw new TypeError("At least one of the arguments is not a vector.")}else throw new TypeError("Only one- or two-dimensional vectors are supported.")}}),L$="splitUnit",I2e=["typed"],P2e=re(L$,I2e,n=>{var{typed:e}=n;return e(L$,{"Unit, Array":function(r,i){return r.splitUnit(i)}})}),O$="unaryMinus",F2e=["typed"],L2e=re(O$,F2e,n=>{var{typed:e}=n;return e(O$,{number:qte,"Complex | BigNumber | Fraction":t=>t.neg(),bigint:t=>-t,Unit:e.referToSelf(t=>r=>{var i=r.clone();return i.value=e.find(t,i.valueType())(r.value),i}),"Array | Matrix":e.referToSelf(t=>r=>qt(r,t,!0))})}),k$="unaryPlus",O2e=["typed","config","numeric"],k2e=re(k$,O2e,n=>{var{typed:e,config:t,numeric:r}=n;return e(k$,{number:Wte,Complex:function(s){return s},BigNumber:function(s){return s},bigint:function(s){return s},Fraction:function(s){return s},Unit:function(s){return s.clone()},"Array | Matrix":e.referToSelf(i=>s=>qt(s,i,!0)),boolean:function(s){return r(s?1:0,t.number)},string:function(s){return r(s,Wp(s,t))}})}),B$="abs",B2e=["typed"],U2e=re(B$,B2e,n=>{var{typed:e}=n;return e(B$,{number:$te,"Complex | BigNumber | Fraction | Unit":t=>t.abs(),bigint:t=>t<0n?-t:t,"Array | Matrix":e.referToSelf(t=>r=>qt(r,t,!0))})}),U$="mapSlices",V2e=["typed","isInteger"],RO=re(U$,V2e,n=>{var{typed:e,isInteger:t}=n;return e(U$,{"Array | Matrix, number | BigNumber, function":function(i,s,a){if(!t(s))throw new TypeError("Integer number expected for dimension");var o=Array.isArray(i)?Vt(i):i.size();if(s<0||s>=o.length)throw new vu(s,o.length);return Dt(i)?i.create(XD(i.valueOf(),s,a),i.datatype()):XD(i,s,a)}})},{formerly:"apply"});function XD(n,e,t){var r,i,s;if(e<=0)if(Array.isArray(n[0])){for(s=z2e(n),i=[],r=0;r<s.length;r++)i[r]=XD(s[r],e-1,t);return i}else return t(n);else{for(i=[],r=0;r<n.length;r++)i[r]=XD(n[r],e-1,t);return i}}function z2e(n){var e=n.length,t=n[0].length,r,i,s=[];for(i=0;i<t;i++){var a=[];for(r=0;r<e;r++)a.push(n[r][i]);s.push(a)}return s}var V$="addScalar",$2e=["typed"],H2e=re(V$,$2e,n=>{var{typed:e}=n;return e(V$,{"number, number":Hte,"Complex, Complex":function(r,i){return r.add(i)},"BigNumber, BigNumber":function(r,i){return r.plus(i)},"bigint, bigint":function(r,i){return r+i},"Fraction, Fraction":function(r,i){return r.add(i)},"Unit, Unit":e.referToSelf(t=>(r,i)=>{if(r.value===null||r.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(i.value===null||i.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!r.equalBase(i))throw new Error("Units do not match");var s=r.clone();return s.value=e.find(t,[s.valueType(),i.valueType()])(s.value,i.value),s.fixPrefix=!1,s})})}),z$="subtractScalar",G2e=["typed"],j2e=re(z$,G2e,n=>{var{typed:e}=n;return e(z$,{"number, number":Gte,"Complex, Complex":function(r,i){return r.sub(i)},"BigNumber, BigNumber":function(r,i){return r.minus(i)},"bigint, bigint":function(r,i){return r-i},"Fraction, Fraction":function(r,i){return r.sub(i)},"Unit, Unit":e.referToSelf(t=>(r,i)=>{if(r.value===null||r.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(i.value===null||i.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!r.equalBase(i))throw new Error("Units do not match");var s=r.clone();return s.value=e.find(t,[s.valueType(),i.valueType()])(s.value,i.value),s.fixPrefix=!1,s})})}),$$="cbrt",q2e=["config","typed","isNegative","unaryMinus","matrix","Complex","BigNumber","Fraction"],W2e=re($$,q2e,n=>{var{config:e,typed:t,isNegative:r,unaryMinus:i,matrix:s,Complex:a,BigNumber:o,Fraction:l}=n;return t($$,{number:p1,Complex:u,"Complex, boolean":u,BigNumber:function(d){return d.cbrt()},Unit:c});function u(h,d){var f=h.arg()/3,p=h.abs(),m=new a(p1(p),0).mul(new a(0,f).exp());if(d){var y=[m,new a(p1(p),0).mul(new a(0,f+Math.PI*2/3).exp()),new a(p1(p),0).mul(new a(0,f-Math.PI*2/3).exp())];return e.matrix==="Array"?y:s(y)}else return m}function c(h){if(h.value&&Qh(h.value)){var d=h.clone();return d.value=1,d=d.pow(1/3),d.value=u(h.value),d}else{var f=r(h.value);f&&(h.value=i(h.value));var p;jt(h.value)?p=new o(1).div(3):sA(h.value)?p=new l(1,3):p=1/3;var m=h.pow(p);return f&&(m.value=i(m.value)),m}}}),X2e="matAlgo11xS0s",K2e=["typed","equalScalar"],Is=re(X2e,K2e,n=>{var{typed:e,equalScalar:t}=n;return function(i,s,a,o){var l=i._values,u=i._index,c=i._ptr,h=i._size,d=i._datatype;if(!l)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var f=h[0],p=h[1],m,y=t,v=0,b=a;typeof d=="string"&&(m=d,y=e.find(t,[m,m]),v=e.convert(0,m),s=e.convert(s,m),b=e.find(a,[m,m]));for(var x=[],w=[],_=[],E=0;E<p;E++){_[E]=w.length;for(var A=c[E],T=c[E+1],S=A;S<T;S++){var M=u[S],D=o?b(s,l[S]):b(l[S],s);y(D,v)||(w.push(M),x.push(D))}}return _[p]=w.length,i.createSparseMatrix({values:x,index:w,ptr:_,size:[f,p],datatype:m})}}),Y2e="matAlgo12xSfs",Q2e=["typed","DenseMatrix"],Ui=re(Y2e,Q2e,n=>{var{typed:e,DenseMatrix:t}=n;return function(i,s,a,o){var l=i._values,u=i._index,c=i._ptr,h=i._size,d=i._datatype;if(!l)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var f=h[0],p=h[1],m,y=a;typeof d=="string"&&(m=d,s=e.convert(s,m),y=e.find(a,[m,m]));for(var v=[],b=[],x=[],w=0;w<p;w++){for(var _=w+1,E=c[w],A=c[w+1],T=E;T<A;T++){var S=u[T];b[S]=l[T],x[S]=_}for(var M=0;M<f;M++)w===0&&(v[M]=[]),x[M]===_?v[M][w]=o?y(s,b[M]):y(b[M],s):v[M][w]=o?y(s,0):y(0,s)}return new t({data:v,size:[f,p],datatype:m})}}),Z2e="matAlgo14xDs",J2e=["typed"],Rl=re(Z2e,J2e,n=>{var{typed:e}=n;return function(i,s,a,o){var l=i._data,u=i._size,c=i._datatype,h,d=a;typeof c=="string"&&(h=c,s=e.convert(s,h),d=e.find(a,[h,h]));var f=u.length>0?t(d,0,u,u[0],l,s,o):[];return i.createDenseMatrix({data:f,size:Ut(u),datatype:h})};function t(r,i,s,a,o,l,u){var c=[];if(i===s.length-1)for(var h=0;h<a;h++)c[h]=u?r(l,o[h]):r(o[h],l);else for(var d=0;d<a;d++)c[d]=t(r,i+1,s,s[i+1],o[d],l,u);return c}}),IO="ceil",eNe=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],tNe=new Lp(10),nNe=re(IO,["typed","config","round"],n=>{var{typed:e,config:t,round:r}=n;function i(s){var a=Math.ceil(s),o=r(s);return a===o?a:os(s,o,t.relTol,t.absTol)&&!os(s,a,t.relTol,t.absTol)?o:a}return e(IO,{number:i,"number, number":function(a,o){if(!bt(o))throw new RangeError("number of decimals in function ceil must be an integer");if(o<0||o>15)throw new RangeError("number of decimals in ceil number must be in range 0-15");var l=10**o;return i(a*l)/l}})}),rNe=re(IO,eNe,n=>{var{typed:e,config:t,round:r,matrix:i,equalScalar:s,zeros:a,DenseMatrix:o}=n,l=Is({typed:e,equalScalar:s}),u=Ui({typed:e,DenseMatrix:o}),c=Rl({typed:e}),h=nNe({typed:e,config:t,round:r});function d(f){var p=(v,b)=>Dl(v,b,t.relTol,t.absTol),m=f.ceil(),y=r(f);return m.eq(y)?m:p(f,y)&&!p(f,m)?y:m}return e("ceil",{number:h.signatures.number,"number,number":h.signatures["number,number"],Complex:function(p){return p.ceil()},"Complex, number":function(p,m){return p.ceil(m)},"Complex, BigNumber":function(p,m){return p.ceil(m.toNumber())},BigNumber:d,"BigNumber, BigNumber":function(p,m){var y=tNe.pow(m);return d(p.mul(y)).div(y)},bigint:f=>f,"bigint, number":(f,p)=>f,"bigint, BigNumber":(f,p)=>f,Fraction:function(p){return p.ceil()},"Fraction, number":function(p,m){return p.ceil(m)},"Fraction, BigNumber":function(p,m){return p.ceil(m.toNumber())},"Unit, number, Unit":e.referToSelf(f=>function(p,m,y){var v=p.toNumeric(y);return y.multiply(f(v,m))}),"Unit, BigNumber, Unit":e.referToSelf(f=>(p,m,y)=>f(p,m.toNumber(),y)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(f=>(p,m,y)=>qt(p,v=>f(v,m,y),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(f=>(p,m)=>f(p,0,m)),"Array | Matrix":e.referToSelf(f=>p=>qt(p,f,!0)),"Array, number | BigNumber":e.referToSelf(f=>(p,m)=>qt(p,y=>f(y,m),!0)),"SparseMatrix, number | BigNumber":e.referToSelf(f=>(p,m)=>l(p,m,f,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(f=>(p,m)=>c(p,m,f,!1)),"number | Complex | Fraction | BigNumber, Array":e.referToSelf(f=>(p,m)=>c(i(m),p,f,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf(f=>(p,m)=>s(p,0)?a(m.size(),m.storage()):m.storage()==="dense"?c(m,p,f,!0):u(m,p,f,!0))})}),H$="cube",iNe=["typed"],sNe=re(H$,iNe,n=>{var{typed:e}=n;return e(H$,{number:Xte,Complex:function(r){return r.mul(r).mul(r)},BigNumber:function(r){return r.times(r).times(r)},bigint:function(r){return r*r*r},Fraction:function(r){return r.pow(3)},Unit:function(r){return r.pow(3)}})}),G$="exp",aNe=["typed"],oNe=re(G$,aNe,n=>{var{typed:e}=n;return e(G$,{number:Kte,Complex:function(r){return r.exp()},BigNumber:function(r){return r.exp()}})}),j$="expm1",lNe=["typed","Complex"],uNe=re(j$,lNe,n=>{var{typed:e,Complex:t}=n;return e(j$,{number:Yte,Complex:function(i){var s=Math.exp(i.re);return new t(s*Math.cos(i.im)-1,s*Math.sin(i.im))},BigNumber:function(i){return i.exp().minus(1)}})}),PO="fix",cNe=["typed","Complex","matrix","ceil","floor","equalScalar","zeros","DenseMatrix"],hNe=re(PO,["typed","ceil","floor"],n=>{var{typed:e,ceil:t,floor:r}=n;return e(PO,{number:function(s){return s>0?r(s):t(s)},"number, number":function(s,a){return s>0?r(s,a):t(s,a)}})}),dNe=re(PO,cNe,n=>{var{typed:e,Complex:t,matrix:r,ceil:i,floor:s,equalScalar:a,zeros:o,DenseMatrix:l}=n,u=Ui({typed:e,DenseMatrix:l}),c=Rl({typed:e}),h=hNe({typed:e,ceil:i,floor:s});return e("fix",{number:h.signatures.number,"number, number | BigNumber":h.signatures["number,number"],Complex:function(f){return new t(f.re>0?Math.floor(f.re):Math.ceil(f.re),f.im>0?Math.floor(f.im):Math.ceil(f.im))},"Complex, number":function(f,p){return new t(f.re>0?s(f.re,p):i(f.re,p),f.im>0?s(f.im,p):i(f.im,p))},"Complex, BigNumber":function(f,p){var m=p.toNumber();return new t(f.re>0?s(f.re,m):i(f.re,m),f.im>0?s(f.im,m):i(f.im,m))},BigNumber:function(f){return f.isNegative()?i(f):s(f)},"BigNumber, number | BigNumber":function(f,p){return f.isNegative()?i(f,p):s(f,p)},bigint:d=>d,"bigint, number":(d,f)=>d,"bigint, BigNumber":(d,f)=>d,Fraction:function(f){return f.s<0n?f.ceil():f.floor()},"Fraction, number | BigNumber":function(f,p){return f.s<0n?i(f,p):s(f,p)},"Unit, number, Unit":e.referToSelf(d=>function(f,p,m){var y=f.toNumeric(m);return m.multiply(d(y,p))}),"Unit, BigNumber, Unit":e.referToSelf(d=>(f,p,m)=>d(f,p.toNumber(),m)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(d=>(f,p,m)=>qt(f,y=>d(y,p,m),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(d=>(f,p)=>d(f,0,p)),"Array | Matrix":e.referToSelf(d=>f=>qt(f,d,!0)),"Array | Matrix, number | BigNumber":e.referToSelf(d=>(f,p)=>qt(f,m=>d(m,p),!0)),"number | Complex | Fraction | BigNumber, Array":e.referToSelf(d=>(f,p)=>c(r(p),f,d,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf(d=>(f,p)=>a(f,0)?o(p.size(),p.storage()):p.storage()==="dense"?c(p,f,d,!0):u(p,f,d,!0))})}),FO="floor",fNe=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],pNe=new Lp(10),mNe=re(FO,["typed","config","round"],n=>{var{typed:e,config:t,round:r}=n;function i(s){var a=Math.floor(s),o=r(s);return a===o?a:os(s,o,t.relTol,t.absTol)&&!os(s,a,t.relTol,t.absTol)?o:a}return e(FO,{number:i,"number, number":function(a,o){if(!bt(o))throw new RangeError("number of decimals in function floor must be an integer");if(o<0||o>15)throw new RangeError("number of decimals in floor number must be in range 0 - 15");var l=10**o;return i(a*l)/l}})}),Rne=re(FO,fNe,n=>{var{typed:e,config:t,round:r,matrix:i,equalScalar:s,zeros:a,DenseMatrix:o}=n,l=Is({typed:e,equalScalar:s}),u=Ui({typed:e,DenseMatrix:o}),c=Rl({typed:e}),h=mNe({typed:e,config:t,round:r});function d(f){var p=(v,b)=>Dl(v,b,t.relTol,t.absTol),m=f.floor(),y=r(f);return m.eq(y)?m:p(f,y)&&!p(f,m)?y:m}return e("floor",{number:h.signatures.number,"number,number":h.signatures["number,number"],Complex:function(p){return p.floor()},"Complex, number":function(p,m){return p.floor(m)},"Complex, BigNumber":function(p,m){return p.floor(m.toNumber())},BigNumber:d,"BigNumber, BigNumber":function(p,m){var y=pNe.pow(m);return d(p.mul(y)).div(y)},bigint:f=>f,"bigint, number":(f,p)=>f,"bigint, BigNumber":(f,p)=>f,Fraction:function(p){return p.floor()},"Fraction, number":function(p,m){return p.floor(m)},"Fraction, BigNumber":function(p,m){return p.floor(m.toNumber())},"Unit, number, Unit":e.referToSelf(f=>function(p,m,y){var v=p.toNumeric(y);return y.multiply(f(v,m))}),"Unit, BigNumber, Unit":e.referToSelf(f=>(p,m,y)=>f(p,m.toNumber(),y)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(f=>(p,m,y)=>qt(p,v=>f(v,m,y),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(f=>(p,m)=>f(p,0,m)),"Array | Matrix":e.referToSelf(f=>p=>qt(p,f,!0)),"Array, number | BigNumber":e.referToSelf(f=>(p,m)=>qt(p,y=>f(y,m),!0)),"SparseMatrix, number | BigNumber":e.referToSelf(f=>(p,m)=>l(p,m,f,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(f=>(p,m)=>c(p,m,f,!1)),"number | Complex | Fraction | BigNumber, Array":e.referToSelf(f=>(p,m)=>c(i(m),p,f,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf(f=>(p,m)=>s(p,0)?a(m.size(),m.storage()):m.storage()==="dense"?c(m,p,f,!0):u(m,p,f,!0))})}),gNe="matAlgo02xDS0",vNe=["typed","equalScalar"],xu=re(gNe,vNe,n=>{var{typed:e,equalScalar:t}=n;return function(i,s,a,o){var l=i._data,u=i._size,c=i._datatype||i.getDataType(),h=s._values,d=s._index,f=s._ptr,p=s._size,m=s._datatype||s._data===void 0?s._datatype:s.getDataType();if(u.length!==p.length)throw new en(u.length,p.length);if(u[0]!==p[0]||u[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+p+")");if(!h)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var y=u[0],v=u[1],b,x=t,w=0,_=a;typeof c=="string"&&c===m&&c!=="mixed"&&(b=c,x=e.find(t,[b,b]),w=e.convert(0,b),_=e.find(a,[b,b]));for(var E=[],A=[],T=[],S=0;S<v;S++){T[S]=A.length;for(var M=f[S],D=f[S+1],N=M;N<D;N++){var R=d[N],O=o?_(h[N],l[R][S]):_(l[R][S],h[N]);x(O,w)||(A.push(R),E.push(O))}}return T[v]=A.length,s.createSparseMatrix({values:E,index:A,ptr:T,size:[y,v],datatype:c===i._datatype&&m===s._datatype?b:void 0})}}),yNe="matAlgo03xDSf",xNe=["typed"],sa=re(yNe,xNe,n=>{var{typed:e}=n;return function(r,i,s,a){var o=r._data,l=r._size,u=r._datatype||r.getDataType(),c=i._values,h=i._index,d=i._ptr,f=i._size,p=i._datatype||i._data===void 0?i._datatype:i.getDataType();if(l.length!==f.length)throw new en(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");if(!c)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var m=l[0],y=l[1],v,b=0,x=s;typeof u=="string"&&u===p&&u!=="mixed"&&(v=u,b=e.convert(0,v),x=e.find(s,[v,v]));for(var w=[],_=0;_<m;_++)w[_]=[];for(var E=[],A=[],T=0;T<y;T++){for(var S=T+1,M=d[T],D=d[T+1],N=M;N<D;N++){var R=h[N];E[R]=a?x(c[N],o[R][T]):x(o[R][T],c[N]),A[R]=S}for(var O=0;O<m;O++)A[O]===S?w[O][T]=E[O]:w[O][T]=a?x(b,o[O][T]):x(o[O][T],b)}return r.createDenseMatrix({data:w,size:[m,y],datatype:u===r._datatype&&p===i._datatype?v:void 0})}}),bNe="matAlgo05xSfSf",_Ne=["typed","equalScalar"],UN=re(bNe,_Ne,n=>{var{typed:e,equalScalar:t}=n;return function(i,s,a){var o=i._values,l=i._index,u=i._ptr,c=i._size,h=i._datatype||i._data===void 0?i._datatype:i.getDataType(),d=s._values,f=s._index,p=s._ptr,m=s._size,y=s._datatype||s._data===void 0?s._datatype:s.getDataType();if(c.length!==m.length)throw new en(c.length,m.length);if(c[0]!==m[0]||c[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+m+")");var v=c[0],b=c[1],x,w=t,_=0,E=a;typeof h=="string"&&h===y&&h!=="mixed"&&(x=h,w=e.find(t,[x,x]),_=e.convert(0,x),E=e.find(a,[x,x]));var A=o&&d?[]:void 0,T=[],S=[],M=A?[]:void 0,D=A?[]:void 0,N=[],R=[],O,G,I,B;for(G=0;G<b;G++){S[G]=T.length;var $=G+1;for(I=u[G],B=u[G+1];I<B;I++)O=l[I],T.push(O),N[O]=$,M&&(M[O]=o[I]);for(I=p[G],B=p[G+1];I<B;I++)O=f[I],N[O]!==$&&T.push(O),R[O]=$,D&&(D[O]=d[I]);if(A)for(I=S[G];I<T.length;){O=T[I];var H=N[O],Q=R[O];if(H===$||Q===$){var ee=H===$?M[O]:_,J=Q===$?D[O]:_,L=E(ee,J);w(L,_)?T.splice(I,1):(A.push(L),I++)}}}return S[b]=T.length,i.createSparseMatrix({values:A,index:T,ptr:S,size:[v,b],datatype:h===i._datatype&&y===s._datatype?x:void 0})}}),wNe="matAlgo13xDD",ENe=["typed"],Ine=re(wNe,ENe,n=>{var{typed:e}=n;return function(i,s,a){var o=i._data,l=i._size,u=i._datatype,c=s._data,h=s._size,d=s._datatype,f=[];if(l.length!==h.length)throw new en(l.length,h.length);for(var p=0;p<l.length;p++){if(l[p]!==h[p])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+h+")");f[p]=l[p]}var m,y=a;typeof u=="string"&&u===d&&(m=u,y=e.find(a,[m,m]));var v=f.length>0?t(y,0,f,f[0],o,c):[];return i.createDenseMatrix({data:v,size:f,datatype:m})};function t(r,i,s,a,o,l){var u=[];if(i===s.length-1)for(var c=0;c<a;c++)u[c]=r(o[c],l[c]);else for(var h=0;h<a;h++)u[h]=t(r,i+1,s,s[i+1],o[h],l[h]);return u}});function Wi(n,e){if(yd(n.size(),e.size()))return[n,e];var t=zD(n.size(),e.size());return[n,e].map(r=>SNe(r,t))}function SNe(n,e){return yd(n.size(),e)?n:n.create(Gm(n.valueOf(),e),n.datatype())}var ANe="matrixAlgorithmSuite",TNe=["typed","matrix"],or=re(ANe,TNe,n=>{var{typed:e,matrix:t}=n,r=Ine({typed:e}),i=Rl({typed:e});return function(a){var o=a.elop,l=a.SD||a.DS,u;o?(u={"DenseMatrix, DenseMatrix":(f,p)=>r(...Wi(f,p),o),"Array, Array":(f,p)=>r(...Wi(t(f),t(p)),o).valueOf(),"Array, DenseMatrix":(f,p)=>r(...Wi(t(f),p),o),"DenseMatrix, Array":(f,p)=>r(...Wi(f,t(p)),o)},a.SS&&(u["SparseMatrix, SparseMatrix"]=(f,p)=>a.SS(...Wi(f,p),o,!1)),a.DS&&(u["DenseMatrix, SparseMatrix"]=(f,p)=>a.DS(...Wi(f,p),o,!1),u["Array, SparseMatrix"]=(f,p)=>a.DS(...Wi(t(f),p),o,!1)),l&&(u["SparseMatrix, DenseMatrix"]=(f,p)=>l(...Wi(p,f),o,!0),u["SparseMatrix, Array"]=(f,p)=>l(...Wi(t(p),f),o,!0))):(u={"DenseMatrix, DenseMatrix":e.referToSelf(f=>(p,m)=>r(...Wi(p,m),f)),"Array, Array":e.referToSelf(f=>(p,m)=>r(...Wi(t(p),t(m)),f).valueOf()),"Array, DenseMatrix":e.referToSelf(f=>(p,m)=>r(...Wi(t(p),m),f)),"DenseMatrix, Array":e.referToSelf(f=>(p,m)=>r(...Wi(p,t(m)),f))},a.SS&&(u["SparseMatrix, SparseMatrix"]=e.referToSelf(f=>(p,m)=>a.SS(...Wi(p,m),f,!1))),a.DS&&(u["DenseMatrix, SparseMatrix"]=e.referToSelf(f=>(p,m)=>a.DS(...Wi(p,m),f,!1)),u["Array, SparseMatrix"]=e.referToSelf(f=>(p,m)=>a.DS(...Wi(t(p),m),f,!1))),l&&(u["SparseMatrix, DenseMatrix"]=e.referToSelf(f=>(p,m)=>l(...Wi(m,p),f,!0)),u["SparseMatrix, Array"]=e.referToSelf(f=>(p,m)=>l(...Wi(t(m),p),f,!0))));var c=a.scalar||"any",h=a.Ds||a.Ss;h&&(o?(u["DenseMatrix,"+c]=(f,p)=>i(f,p,o,!1),u[c+", DenseMatrix"]=(f,p)=>i(p,f,o,!0),u["Array,"+c]=(f,p)=>i(t(f),p,o,!1).valueOf(),u[c+", Array"]=(f,p)=>i(t(p),f,o,!0).valueOf()):(u["DenseMatrix,"+c]=e.referToSelf(f=>(p,m)=>i(p,m,f,!1)),u[c+", DenseMatrix"]=e.referToSelf(f=>(p,m)=>i(m,p,f,!0)),u["Array,"+c]=e.referToSelf(f=>(p,m)=>i(t(p),m,f,!1).valueOf()),u[c+", Array"]=e.referToSelf(f=>(p,m)=>i(t(m),p,f,!0).valueOf())));var d=a.sS!==void 0?a.sS:a.Ss;return o?(a.Ss&&(u["SparseMatrix,"+c]=(f,p)=>a.Ss(f,p,o,!1)),d&&(u[c+", SparseMatrix"]=(f,p)=>d(p,f,o,!0))):(a.Ss&&(u["SparseMatrix,"+c]=e.referToSelf(f=>(p,m)=>a.Ss(p,m,f,!1))),d&&(u[c+", SparseMatrix"]=e.referToSelf(f=>(p,m)=>d(m,p,f,!0)))),o&&o.signatures&&fte(u,o.signatures),u}}),q$="mod",MNe=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix","concat"],Pne=re(q$,MNe,n=>{var{typed:e,config:t,round:r,matrix:i,equalScalar:s,zeros:a,DenseMatrix:o,concat:l}=n,u=Rne({typed:e,config:t,round:r,matrix:i,equalScalar:s,zeros:a,DenseMatrix:o}),c=xu({typed:e,equalScalar:s}),h=sa({typed:e}),d=UN({typed:e,equalScalar:s}),f=Is({typed:e,equalScalar:s}),p=Ui({typed:e,DenseMatrix:o}),m=or({typed:e,matrix:i,concat:l});return e(q$,{"number, number":y,"BigNumber, BigNumber":function(b,x){return x.isZero()?b:b.sub(x.mul(u(b.div(x))))},"bigint, bigint":function(b,x){if(x===0n)return b;if(b<0){var w=b%x;return w===0n?w:w+x}return b%x},"Fraction, Fraction":function(b,x){return x.equals(0)?b:b.sub(x.mul(u(b.div(x))))}},m({SS:d,DS:h,SD:c,Ss:f,sS:p}));function y(v,b){return b===0?v:v-b*u(v/b)}}),CNe="matAlgo01xDSid",DNe=["typed"],Kp=re(CNe,DNe,n=>{var{typed:e}=n;return function(r,i,s,a){var o=r._data,l=r._size,u=r._datatype||r.getDataType(),c=i._values,h=i._index,d=i._ptr,f=i._size,p=i._datatype||i._data===void 0?i._datatype:i.getDataType();if(l.length!==f.length)throw new en(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");if(!c)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var m=l[0],y=l[1],v=typeof u=="string"&&u!=="mixed"&&u===p?u:void 0,b=v?e.find(s,[v,v]):s,x,w,_=[];for(x=0;x<m;x++)_[x]=[];var E=[],A=[];for(w=0;w<y;w++){for(var T=w+1,S=d[w],M=d[w+1],D=S;D<M;D++)x=h[D],E[x]=a?b(c[D],o[x][w]):b(o[x][w],c[D]),A[x]=T;for(x=0;x<m;x++)A[x]===T?_[x][w]=E[x]:_[x][w]=o[x][w]}return r.createDenseMatrix({data:_,size:[m,y],datatype:u===r._datatype&&p===i._datatype?v:void 0})}}),NNe="matAlgo04xSidSid",RNe=["typed","equalScalar"],tU=re(NNe,RNe,n=>{var{typed:e,equalScalar:t}=n;return function(i,s,a){var o=i._values,l=i._index,u=i._ptr,c=i._size,h=i._datatype||i._data===void 0?i._datatype:i.getDataType(),d=s._values,f=s._index,p=s._ptr,m=s._size,y=s._datatype||s._data===void 0?s._datatype:s.getDataType();if(c.length!==m.length)throw new en(c.length,m.length);if(c[0]!==m[0]||c[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+m+")");var v=c[0],b=c[1],x,w=t,_=0,E=a;typeof h=="string"&&h===y&&h!=="mixed"&&(x=h,w=e.find(t,[x,x]),_=e.convert(0,x),E=e.find(a,[x,x]));var A=o&&d?[]:void 0,T=[],S=[],M=o&&d?[]:void 0,D=o&&d?[]:void 0,N=[],R=[],O,G,I,B,$;for(G=0;G<b;G++){S[G]=T.length;var H=G+1;for(B=u[G],$=u[G+1],I=B;I<$;I++)O=l[I],T.push(O),N[O]=H,M&&(M[O]=o[I]);for(B=p[G],$=p[G+1],I=B;I<$;I++)if(O=f[I],N[O]===H){if(M){var Q=E(M[O],d[I]);w(Q,_)?N[O]=null:M[O]=Q}}else T.push(O),R[O]=H,D&&(D[O]=d[I]);if(M&&D)for(I=S[G];I<T.length;)O=T[I],N[O]===H?(A[I]=M[O],I++):R[O]===H?(A[I]=D[O],I++):T.splice(I,1)}return S[b]=T.length,i.createSparseMatrix({values:A,index:T,ptr:S,size:[v,b],datatype:h===i._datatype&&y===s._datatype?x:void 0})}}),INe="matAlgo10xSids",PNe=["typed","DenseMatrix"],zv=re(INe,PNe,n=>{var{typed:e,DenseMatrix:t}=n;return function(i,s,a,o){var l=i._values,u=i._index,c=i._ptr,h=i._size,d=i._datatype;if(!l)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var f=h[0],p=h[1],m,y=a;typeof d=="string"&&(m=d,s=e.convert(s,m),y=e.find(a,[m,m]));for(var v=[],b=[],x=[],w=0;w<p;w++){for(var _=w+1,E=c[w],A=c[w+1],T=E;T<A;T++){var S=u[T];b[S]=l[T],x[S]=_}for(var M=0;M<f;M++)w===0&&(v[M]=[]),x[M]===_?v[M][w]=o?y(s,b[M]):y(b[M],s):v[M][w]=s}return new t({data:v,size:[f,p],datatype:m})}});function $v(n,e,t,r){if(!(this instanceof $v))throw new SyntaxError("Constructor must be called with the new operator");this.fn=n,this.count=e,this.min=t,this.max=r,this.message="Wrong number of arguments in function "+n+" ("+e+" provided, "+t+(r!=null?"-"+r:"")+" expected)",this.stack=new Error().stack}$v.prototype=new Error;$v.prototype.constructor=Error;$v.prototype.name="ArgumentsError";$v.prototype.isArgumentsError=!0;var W$="gcd",FNe=["typed","config","round","matrix","equalScalar","zeros","BigNumber","DenseMatrix","concat"],ZI="number | BigNumber | Fraction | Matrix | Array",LNe="".concat(ZI,", ").concat(ZI,", ...").concat(ZI);function X$(n){return!n.some(e=>Array.isArray(e))}var ONe=re(W$,FNe,n=>{var{typed:e,matrix:t,config:r,round:i,equalScalar:s,zeros:a,BigNumber:o,DenseMatrix:l,concat:u}=n,c=Pne({typed:e,config:r,round:i,matrix:t,equalScalar:s,zeros:a,DenseMatrix:l,concat:u}),h=Kp({typed:e}),d=tU({typed:e,equalScalar:s}),f=zv({typed:e,DenseMatrix:l}),p=or({typed:e,matrix:t,concat:u});return e(W$,{"number, number":m,"BigNumber, BigNumber":y,"Fraction, Fraction":(v,b)=>v.gcd(b)},p({SS:d,DS:h,Ss:f}),{[LNe]:e.referToSelf(v=>(b,x,w)=>{for(var _=v(b,x),E=0;E<w.length;E++)_=v(_,w[E]);return _}),Array:e.referToSelf(v=>b=>{if(b.length===1&&Array.isArray(b[0])&&X$(b[0]))return v(...b[0]);if(X$(b))return v(...b);throw new $v("gcd() supports only 1d matrices!")}),Matrix:e.referToSelf(v=>b=>v(b.toArray()))});function m(v,b){if(!bt(v)||!bt(b))throw new Error("Parameters in function gcd must be integer numbers");for(var x;b!==0;)x=c(v,b),v=b,b=x;return v<0?-v:v}function y(v,b){if(!v.isInt()||!b.isInt())throw new Error("Parameters in function gcd must be integer numbers");for(var x=new o(0);!b.isZero();){var w=c(v,b);v=b,b=w}return v.lt(x)?v.neg():v}}),kNe="matAlgo06xS0S0",BNe=["typed","equalScalar"],VN=re(kNe,BNe,n=>{var{typed:e,equalScalar:t}=n;return function(i,s,a){var o=i._values,l=i._size,u=i._datatype||i._data===void 0?i._datatype:i.getDataType(),c=s._values,h=s._size,d=s._datatype||s._data===void 0?s._datatype:s.getDataType();if(l.length!==h.length)throw new en(l.length,h.length);if(l[0]!==h[0]||l[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+h+")");var f=l[0],p=l[1],m,y=t,v=0,b=a;typeof u=="string"&&u===d&&u!=="mixed"&&(m=u,y=e.find(t,[m,m]),v=e.convert(0,m),b=e.find(a,[m,m]));for(var x=o&&c?[]:void 0,w=[],_=[],E=x?[]:void 0,A=[],T=[],S=0;S<p;S++){_[S]=w.length;var M=S+1;if(m$(i,S,A,E,T,M,w,b),m$(s,S,A,E,T,M,w,b),E)for(var D=_[S];D<w.length;){var N=w[D];if(T[N]===M){var R=E[N];y(R,v)?w.splice(D,1):(x.push(R),D++)}else w.splice(D,1)}else for(var O=_[S];O<w.length;){var G=w[O];T[G]!==M?w.splice(O,1):O++}}return _[p]=w.length,i.createSparseMatrix({values:x,index:w,ptr:_,size:[f,p],datatype:u===i._datatype&&d===s._datatype?m:void 0})}}),K$="lcm",UNe=["typed","matrix","equalScalar","concat"],VNe=re(K$,UNe,n=>{var{typed:e,matrix:t,equalScalar:r,concat:i}=n,s=xu({typed:e,equalScalar:r}),a=VN({typed:e,equalScalar:r}),o=Is({typed:e,equalScalar:r}),l=or({typed:e,matrix:t,concat:i}),u="number | BigNumber | Fraction | Matrix | Array",c={};return c["".concat(u,", ").concat(u,", ...").concat(u)]=e.referToSelf(d=>(f,p,m)=>{for(var y=d(f,p),v=0;v<m.length;v++)y=d(y,m[v]);return y}),e(K$,{"number, number":Qte,"BigNumber, BigNumber":h,"Fraction, Fraction":(d,f)=>d.lcm(f)},l({SS:a,DS:s,Ss:o}),c);function h(d,f){if(!d.isInt()||!f.isInt())throw new Error("Parameters in function lcm must be integer numbers");if(d.isZero())return d;if(f.isZero())return f;for(var p=d.times(f);!f.isZero();){var m=f;f=d.mod(m),d=m}return p.div(d).abs()}});function nU(n,e,t,r){return function(i){if(i>0||t.predictable){if(i<=0)return NaN;var s=i.toString(16),a=s.substring(0,15);return n*(s.length-a.length)+e(+("0x"+a))}return r(i.toNumber())}}var Y$="log10",zNe=["typed","config","Complex"],$Ne=GD(16),HNe=re(Y$,zNe,n=>{var{typed:e,config:t,Complex:r}=n;function i(a){return a.log().div(Math.LN10)}function s(a){return i(new r(a,0))}return e(Y$,{number:function(o){return o>=0||t.predictable?GD(o):s(o)},bigint:nU($Ne,GD,t,s),Complex:i,BigNumber:function(o){return!o.isNegative()||t.predictable?o.log():s(o.toNumber())},"Array | Matrix":e.referToSelf(a=>o=>qt(o,a))})}),Q$="log2",GNe=["typed","config","Complex"],jNe=re(Q$,GNe,n=>{var{typed:e,config:t,Complex:r}=n;function i(a){return s(new r(a,0))}return e(Q$,{number:function(o){return o>=0||t.predictable?TO(o):i(o)},bigint:nU(4,TO,t,i),Complex:s,BigNumber:function(o){return!o.isNegative()||t.predictable?o.log(2):i(o.toNumber())},"Array | Matrix":e.referToSelf(a=>o=>qt(o,a))});function s(a){var o=Math.sqrt(a.re*a.re+a.im*a.im);return new r(Math.log2?Math.log2(o):Math.log(o)/Math.LN2,Math.atan2(a.im,a.re)/Math.LN2)}}),qNe="multiplyScalar",WNe=["typed"],XNe=re(qNe,WNe,n=>{var{typed:e}=n;return e("multiplyScalar",{"number, number":jte,"Complex, Complex":function(r,i){return r.mul(i)},"BigNumber, BigNumber":function(r,i){return r.times(i)},"bigint, bigint":function(r,i){return r*i},"Fraction, Fraction":function(r,i){return r.mul(i)},"number | Fraction | BigNumber | Complex, Unit":(t,r)=>r.multiply(t),"Unit, number | Fraction | BigNumber | Complex | Unit":(t,r)=>t.multiply(r)})}),Z$="multiply",KNe=["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],YNe=re(Z$,KNe,n=>{var{typed:e,matrix:t,addScalar:r,multiplyScalar:i,equalScalar:s,dot:a}=n,o=Is({typed:e,equalScalar:s}),l=Rl({typed:e});function u(_,E){switch(_.length){case 1:switch(E.length){case 1:if(_[0]!==E[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(_[0]!==E[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+_[0]+") must match Matrix rows ("+E[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+E.length+" dimensions)")}break;case 2:switch(E.length){case 1:if(_[1]!==E[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+_[1]+") must match Vector length ("+E[0]+")");break;case 2:if(_[1]!==E[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+_[1]+") must match Matrix B rows ("+E[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+E.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+_.length+" dimensions)")}}function c(_,E,A){if(A===0)throw new Error("Cannot multiply two empty vectors");return a(_,E)}function h(_,E){if(E.storage()!=="dense")throw new Error("Support for SparseMatrix not implemented");return d(_,E)}function d(_,E){var A=_._data,T=_._size,S=_._datatype||_.getDataType(),M=E._data,D=E._size,N=E._datatype||E.getDataType(),R=T[0],O=D[1],G,I=r,B=i;S&&N&&S===N&&typeof S=="string"&&S!=="mixed"&&(G=S,I=e.find(r,[G,G]),B=e.find(i,[G,G]));for(var $=[],H=0;H<O;H++){for(var Q=B(A[0],M[0][H]),ee=1;ee<R;ee++)Q=I(Q,B(A[ee],M[ee][H]));$[H]=Q}return _.createDenseMatrix({data:$,size:[O],datatype:S===_._datatype&&N===E._datatype?G:void 0})}var f=e("_multiplyMatrixVector",{"DenseMatrix, any":m,"SparseMatrix, any":b}),p=e("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":y,"DenseMatrix, SparseMatrix":v,"SparseMatrix, DenseMatrix":x,"SparseMatrix, SparseMatrix":w});function m(_,E){var A=_._data,T=_._size,S=_._datatype||_.getDataType(),M=E._data,D=E._datatype||E.getDataType(),N=T[0],R=T[1],O,G=r,I=i;S&&D&&S===D&&typeof S=="string"&&S!=="mixed"&&(O=S,G=e.find(r,[O,O]),I=e.find(i,[O,O]));for(var B=[],$=0;$<N;$++){for(var H=A[$],Q=I(H[0],M[0]),ee=1;ee<R;ee++)Q=G(Q,I(H[ee],M[ee]));B[$]=Q}return _.createDenseMatrix({data:B,size:[N],datatype:S===_._datatype&&D===E._datatype?O:void 0})}function y(_,E){var A=_._data,T=_._size,S=_._datatype||_.getDataType(),M=E._data,D=E._size,N=E._datatype||E.getDataType(),R=T[0],O=T[1],G=D[1],I,B=r,$=i;S&&N&&S===N&&typeof S=="string"&&S!=="mixed"&&S!=="mixed"&&(I=S,B=e.find(r,[I,I]),$=e.find(i,[I,I]));for(var H=[],Q=0;Q<R;Q++){var ee=A[Q];H[Q]=[];for(var J=0;J<G;J++){for(var L=$(ee[0],M[0][J]),se=1;se<O;se++)L=B(L,$(ee[se],M[se][J]));H[Q][J]=L}}return _.createDenseMatrix({data:H,size:[R,G],datatype:S===_._datatype&&N===E._datatype?I:void 0})}function v(_,E){var A=_._data,T=_._size,S=_._datatype||_.getDataType(),M=E._values,D=E._index,N=E._ptr,R=E._size,O=E._datatype||E._data===void 0?E._datatype:E.getDataType();if(!M)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var G=T[0],I=R[1],B,$=r,H=i,Q=s,ee=0;S&&O&&S===O&&typeof S=="string"&&S!=="mixed"&&(B=S,$=e.find(r,[B,B]),H=e.find(i,[B,B]),Q=e.find(s,[B,B]),ee=e.convert(0,B));for(var J=[],L=[],se=[],Z=E.createSparseMatrix({values:J,index:L,ptr:se,size:[G,I],datatype:S===_._datatype&&O===E._datatype?B:void 0}),le=0;le<I;le++){se[le]=L.length;var ue=N[le],te=N[le+1];if(te>ue)for(var Y=0,ie=0;ie<G;ie++){for(var ve=ie+1,ge=void 0,_e=ue;_e<te;_e++){var we=D[_e];Y!==ve?(ge=H(A[ie][we],M[_e]),Y=ve):ge=$(ge,H(A[ie][we],M[_e]))}Y===ve&&!Q(ge,ee)&&(L.push(ie),J.push(ge))}}return se[I]=L.length,Z}function b(_,E){var A=_._values,T=_._index,S=_._ptr,M=_._datatype||_._data===void 0?_._datatype:_.getDataType();if(!A)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var D=E._data,N=E._datatype||E.getDataType(),R=_._size[0],O=E._size[0],G=[],I=[],B=[],$,H=r,Q=i,ee=s,J=0;M&&N&&M===N&&typeof M=="string"&&M!=="mixed"&&($=M,H=e.find(r,[$,$]),Q=e.find(i,[$,$]),ee=e.find(s,[$,$]),J=e.convert(0,$));var L=[],se=[];B[0]=0;for(var Z=0;Z<O;Z++){var le=D[Z];if(!ee(le,J))for(var ue=S[Z],te=S[Z+1],Y=ue;Y<te;Y++){var ie=T[Y];se[ie]?L[ie]=H(L[ie],Q(le,A[Y])):(se[ie]=!0,I.push(ie),L[ie]=Q(le,A[Y]))}}for(var ve=I.length,ge=0;ge<ve;ge++){var _e=I[ge];G[ge]=L[_e]}return B[1]=I.length,_.createSparseMatrix({values:G,index:I,ptr:B,size:[R,1],datatype:M===_._datatype&&N===E._datatype?$:void 0})}function x(_,E){var A=_._values,T=_._index,S=_._ptr,M=_._datatype||_._data===void 0?_._datatype:_.getDataType();if(!A)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var D=E._data,N=E._datatype||E.getDataType(),R=_._size[0],O=E._size[0],G=E._size[1],I,B=r,$=i,H=s,Q=0;M&&N&&M===N&&typeof M=="string"&&M!=="mixed"&&(I=M,B=e.find(r,[I,I]),$=e.find(i,[I,I]),H=e.find(s,[I,I]),Q=e.convert(0,I));for(var ee=[],J=[],L=[],se=_.createSparseMatrix({values:ee,index:J,ptr:L,size:[R,G],datatype:M===_._datatype&&N===E._datatype?I:void 0}),Z=[],le=[],ue=0;ue<G;ue++){L[ue]=J.length;for(var te=ue+1,Y=0;Y<O;Y++){var ie=D[Y][ue];if(!H(ie,Q))for(var ve=S[Y],ge=S[Y+1],_e=ve;_e<ge;_e++){var we=T[_e];le[we]!==te?(le[we]=te,J.push(we),Z[we]=$(ie,A[_e])):Z[we]=B(Z[we],$(ie,A[_e]))}}for(var Be=L[ue],$e=J.length,nt=Be;nt<$e;nt++){var de=J[nt];ee[nt]=Z[de]}}return L[G]=J.length,se}function w(_,E){var A=_._values,T=_._index,S=_._ptr,M=_._datatype||_._data===void 0?_._datatype:_.getDataType(),D=E._values,N=E._index,R=E._ptr,O=E._datatype||E._data===void 0?E._datatype:E.getDataType(),G=_._size[0],I=E._size[1],B=A&&D,$,H=r,Q=i;M&&O&&M===O&&typeof M=="string"&&M!=="mixed"&&($=M,H=e.find(r,[$,$]),Q=e.find(i,[$,$]));for(var ee=B?[]:void 0,J=[],L=[],se=_.createSparseMatrix({values:ee,index:J,ptr:L,size:[G,I],datatype:M===_._datatype&&O===E._datatype?$:void 0}),Z=B?[]:void 0,le=[],ue,te,Y,ie,ve,ge,_e,we,Be=0;Be<I;Be++){L[Be]=J.length;var $e=Be+1;for(ve=R[Be],ge=R[Be+1],ie=ve;ie<ge;ie++)if(we=N[ie],B)for(te=S[we],Y=S[we+1],ue=te;ue<Y;ue++)_e=T[ue],le[_e]!==$e?(le[_e]=$e,J.push(_e),Z[_e]=Q(D[ie],A[ue])):Z[_e]=H(Z[_e],Q(D[ie],A[ue]));else for(te=S[we],Y=S[we+1],ue=te;ue<Y;ue++)_e=T[ue],le[_e]!==$e&&(le[_e]=$e,J.push(_e));if(B)for(var nt=L[Be],de=J.length,Ye=nt;Ye<de;Ye++){var Xe=J[Ye];ee[Ye]=Z[Xe]}}return L[I]=J.length,se}return e(Z$,i,{"Array, Array":e.referTo("Matrix, Matrix",_=>(E,A)=>{u(Vt(E),Vt(A));var T=_(t(E),t(A));return Dt(T)?T.valueOf():T}),"Matrix, Matrix":function(E,A){var T=E.size(),S=A.size();return u(T,S),T.length===1?S.length===1?c(E,A,T[0]):h(E,A):S.length===1?f(E,A):p(E,A)},"Matrix, Array":e.referTo("Matrix,Matrix",_=>(E,A)=>_(E,t(A))),"Array, Matrix":e.referToSelf(_=>(E,A)=>_(t(E,A.storage()),A)),"SparseMatrix, any":function(E,A){return o(E,A,i,!1)},"DenseMatrix, any":function(E,A){return l(E,A,i,!1)},"any, SparseMatrix":function(E,A){return o(A,E,i,!0)},"any, DenseMatrix":function(E,A){return l(A,E,i,!0)},"Array, any":function(E,A){return l(t(E),A,i,!1).valueOf()},"any, Array":function(E,A){return l(t(A),E,i,!0).valueOf()},"any, any":i,"any, any, ...any":e.referToSelf(_=>(E,A,T)=>{for(var S=_(E,A),M=0;M<T.length;M++)S=_(S,T[M]);return S})})}),J$="nthRoot",QNe=["typed","matrix","equalScalar","BigNumber","concat"],ZNe=re(J$,QNe,n=>{var{typed:e,matrix:t,equalScalar:r,BigNumber:i,concat:s}=n,a=Kp({typed:e}),o=xu({typed:e,equalScalar:r}),l=VN({typed:e,equalScalar:r}),u=Is({typed:e,equalScalar:r}),c=or({typed:e,matrix:t,concat:s});function h(){throw new Error("Complex number not supported in function nthRoot. Use nthRoots instead.")}return e(J$,{number:y$,"number, number":y$,BigNumber:f=>d(f,new i(2)),"BigNumber, BigNumber":d,Complex:h,"Complex, number":h,Array:e.referTo("DenseMatrix,number",f=>p=>f(t(p),2).valueOf()),DenseMatrix:e.referTo("DenseMatrix,number",f=>p=>f(p,2)),SparseMatrix:e.referTo("SparseMatrix,number",f=>p=>f(p,2)),"SparseMatrix, SparseMatrix":e.referToSelf(f=>(p,m)=>{if(m.density()===1)return l(p,m,f);throw new Error("Root must be non-zero")}),"DenseMatrix, SparseMatrix":e.referToSelf(f=>(p,m)=>{if(m.density()===1)return a(p,m,f,!1);throw new Error("Root must be non-zero")}),"Array, SparseMatrix":e.referTo("DenseMatrix,SparseMatrix",f=>(p,m)=>f(t(p),m)),"number | BigNumber, SparseMatrix":e.referToSelf(f=>(p,m)=>{if(m.density()===1)return u(m,p,f,!0);throw new Error("Root must be non-zero")})},c({scalar:"number | BigNumber",SD:o,Ss:u,sS:!1}));function d(f,p){var m=i.precision,y=i.clone({precision:m+2}),v=new i(0),b=new y(1),x=p.isNegative();if(x&&(p=p.neg()),p.isZero())throw new Error("Root must be non-zero");if(f.isNegative()&&!p.abs().mod(2).equals(1))throw new Error("Root must be odd when a is negative.");if(f.isZero())return x?new y(1/0):0;if(!f.isFinite())return x?v:f;var w=f.abs().pow(b.div(p));return w=f.isNeg()?w.neg():w,new i((x?b.div(w):w).toPrecision(m))}}),e7="sign",JNe=["typed","BigNumber","Fraction","complex"],eRe=re(e7,JNe,n=>{var{typed:e,BigNumber:t,complex:r,Fraction:i}=n;return e(e7,{number:MO,Complex:function(a){return a.im===0?r(MO(a.re)):a.sign()},BigNumber:function(a){return new t(a.cmp(0))},bigint:function(a){return a>0n?1n:a<0n?-1n:0n},Fraction:function(a){return a.n===0n?new i(0):new i(a.s)},"Array | Matrix":e.referToSelf(s=>a=>qt(a,s,!0)),Unit:e.referToSelf(s=>a=>{if(!a._isDerived()&&a.units[0].unit.offset!==0)throw new TypeError("sign is ambiguous for units with offset");return e.find(s,a.valueType())(a.value)})})}),tRe="sqrt",nRe=["config","typed","Complex"],rRe=re(tRe,nRe,n=>{var{config:e,typed:t,Complex:r}=n;return t("sqrt",{number:i,Complex:function(a){return a.sqrt()},BigNumber:function(a){return!a.isNegative()||e.predictable?a.sqrt():i(a.toNumber())},Unit:function(a){return a.pow(.5)}});function i(s){return isNaN(s)?NaN:s>=0||e.predictable?Math.sqrt(s):new r(s,0).sqrt()}}),t7="square",iRe=["typed"],sRe=re(t7,iRe,n=>{var{typed:e}=n;return e(t7,{number:Zte,Complex:function(r){return r.mul(r)},BigNumber:function(r){return r.times(r)},bigint:function(r){return r*r},Fraction:function(r){return r.mul(r)},Unit:function(r){return r.pow(2)}})}),n7="subtract",aRe=["typed","matrix","equalScalar","subtractScalar","unaryMinus","DenseMatrix","concat"],oRe=re(n7,aRe,n=>{var{typed:e,matrix:t,equalScalar:r,subtractScalar:i,unaryMinus:s,DenseMatrix:a,concat:o}=n,l=Kp({typed:e}),u=sa({typed:e}),c=UN({typed:e,equalScalar:r}),h=zv({typed:e,DenseMatrix:a}),d=Ui({typed:e,DenseMatrix:a}),f=or({typed:e,matrix:t,concat:o});return e(n7,{"any, any":i},f({elop:i,SS:c,DS:l,SD:u,Ss:d,sS:h}))}),r7="xgcd",lRe=["typed","config","matrix","BigNumber"],uRe=re(r7,lRe,n=>{var{typed:e,config:t,matrix:r,BigNumber:i}=n;return e(r7,{"number, number":function(o,l){var u=Jte(o,l);return t.matrix==="Array"?u:r(u)},"BigNumber, BigNumber":s});function s(a,o){var l,u,c,h=new i(0),d=new i(1),f=h,p=d,m=d,y=h;if(!a.isInt()||!o.isInt())throw new Error("Parameters in function xgcd must be integer numbers");for(;!o.isZero();)u=a.div(o).floor(),c=a.mod(o),l=f,f=p.minus(u.times(f)),p=l,l=m,m=y.minus(u.times(m)),y=l,a=o,o=c;var v;return a.lt(h)?v=[a.neg(),p.neg(),y.neg()]:v=[a,a.isZero()?0:p,y],t.matrix==="Array"?v:r(v)}}),i7="invmod",cRe=["typed","config","BigNumber","xgcd","equal","smaller","mod","add","isInteger"],hRe=re(i7,cRe,n=>{var{typed:e,config:t,BigNumber:r,xgcd:i,equal:s,smaller:a,mod:o,add:l,isInteger:u}=n;return e(i7,{"number, number":c,"BigNumber, BigNumber":c});function c(h,d){if(!u(h)||!u(d))throw new Error("Parameters in function invmod must be integer numbers");if(h=o(h,d),s(d,0))throw new Error("Divisor must be non zero");var f=i(h,d);f=f.valueOf();var[p,m]=f;return s(p,r(1))?(m=o(m,d),a(m,r(0))&&(m=l(m,d)),m):NaN}}),dRe="matAlgo09xS0Sf",fRe=["typed","equalScalar"],Fne=re(dRe,fRe,n=>{var{typed:e,equalScalar:t}=n;return function(i,s,a){var o=i._values,l=i._index,u=i._ptr,c=i._size,h=i._datatype||i._data===void 0?i._datatype:i.getDataType(),d=s._values,f=s._index,p=s._ptr,m=s._size,y=s._datatype||s._data===void 0?s._datatype:s.getDataType();if(c.length!==m.length)throw new en(c.length,m.length);if(c[0]!==m[0]||c[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+m+")");var v=c[0],b=c[1],x,w=t,_=0,E=a;typeof h=="string"&&h===y&&h!=="mixed"&&(x=h,w=e.find(t,[x,x]),_=e.convert(0,x),E=e.find(a,[x,x]));var A=o&&d?[]:void 0,T=[],S=[],M=A?[]:void 0,D=[],N,R,O,G,I;for(R=0;R<b;R++){S[R]=T.length;var B=R+1;if(M)for(G=p[R],I=p[R+1],O=G;O<I;O++)N=f[O],D[N]=B,M[N]=d[O];for(G=u[R],I=u[R+1],O=G;O<I;O++)if(N=l[O],M){var $=D[N]===B?M[N]:_,H=E(o[O],$);w(H,_)||(T.push(N),A.push(H))}else T.push(N)}return S[b]=T.length,i.createSparseMatrix({values:A,index:T,ptr:S,size:[v,b],datatype:h===i._datatype&&y===s._datatype?x:void 0})}}),s7="dotMultiply",pRe=["typed","matrix","equalScalar","multiplyScalar","concat"],mRe=re(s7,pRe,n=>{var{typed:e,matrix:t,equalScalar:r,multiplyScalar:i,concat:s}=n,a=xu({typed:e,equalScalar:r}),o=Fne({typed:e,equalScalar:r}),l=Is({typed:e,equalScalar:r}),u=or({typed:e,matrix:t,concat:s});return e(s7,u({elop:i,SS:o,DS:a,Ss:l}))});function gRe(n,e){if(n.isFinite()&&!n.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitAnd");var t=n.constructor;if(n.isNaN()||e.isNaN())return new t(NaN);if(n.isZero()||e.eq(-1)||n.eq(e))return n;if(e.isZero()||n.eq(-1))return e;if(!n.isFinite()||!e.isFinite()){if(!n.isFinite()&&!e.isFinite())return n.isNegative()===e.isNegative()?n:new t(0);if(!n.isFinite())return e.isNegative()?n:n.isNegative()?new t(0):e;if(!e.isFinite())return n.isNegative()?e:e.isNegative()?new t(0):n}return rU(n,e,function(r,i){return r&i})}function Iw(n){if(n.isFinite()&&!n.isInteger())throw new Error("Integer expected in function bitNot");var e=n.constructor,t=e.precision;e.config({precision:1e9});var r=n.plus(new e(1));return r.s=-r.s||null,e.config({precision:t}),r}function vRe(n,e){if(n.isFinite()&&!n.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitOr");var t=n.constructor;if(n.isNaN()||e.isNaN())return new t(NaN);var r=new t(-1);return n.isZero()||e.eq(r)||n.eq(e)?e:e.isZero()||n.eq(r)?n:!n.isFinite()||!e.isFinite()?!n.isFinite()&&!n.isNegative()&&e.isNegative()||n.isNegative()&&!e.isNegative()&&!e.isFinite()?r:n.isNegative()&&e.isNegative()?n.isFinite()?n:e:n.isFinite()?e:n:rU(n,e,function(i,s){return i|s})}function rU(n,e,t){var r=n.constructor,i,s,a=+(n.s<0),o=+(e.s<0);if(a){i=OT(Iw(n));for(var l=0;l<i.length;++l)i[l]^=1}else i=OT(n);if(o){s=OT(Iw(e));for(var u=0;u<s.length;++u)s[u]^=1}else s=OT(e);var c,h,d;i.length<=s.length?(c=i,h=s,d=a):(c=s,h=i,d=o);var f=c.length,p=h.length,m=t(a,o)^1,y=new r(m^1),v=new r(1),b=new r(2),x=r.precision;for(r.config({precision:1e9});f>0;)t(c[--f],h[--p])===m&&(y=y.plus(v)),v=v.times(b);for(;p>0;)t(d,h[--p])===m&&(y=y.plus(v)),v=v.times(b);return r.config({precision:x}),m===0&&(y.s=-y.s),y}function OT(n){for(var e=n.d,t=e[0]+"",r=1;r<e.length;++r){for(var i=e[r]+"",s=7-i.length;s--;)i="0"+i;t+=i}for(var a=t.length;t.charAt(a)==="0";)a--;var o=n.e,l=t.slice(0,a+1||1),u=l.length;if(o>0)if(++o>u)for(o-=u;o--;)l+="0";else o<u&&(l=l.slice(0,o)+"."+l.slice(o));for(var c=[0],h=0;h<l.length;){for(var d=c.length;d--;)c[d]*=10;c[0]+=parseInt(l.charAt(h++));for(var f=0;f<c.length;++f)c[f]>1&&((c[f+1]===null||c[f+1]===void 0)&&(c[f+1]=0),c[f+1]+=c[f]>>1,c[f]&=1)}return c.reverse()}function yRe(n,e){if(n.isFinite()&&!n.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitXor");var t=n.constructor;if(n.isNaN()||e.isNaN())return new t(NaN);if(n.isZero())return e;if(e.isZero())return n;if(n.eq(e))return new t(0);var r=new t(-1);return n.eq(r)?Iw(e):e.eq(r)?Iw(n):!n.isFinite()||!e.isFinite()?!n.isFinite()&&!e.isFinite()?r:new t(n.isNegative()===e.isNegative()?1/0:-1/0):rU(n,e,function(i,s){return i^s})}function xRe(n,e){if(n.isFinite()&&!n.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function leftShift");var t=n.constructor;return n.isNaN()||e.isNaN()||e.isNegative()&&!e.isZero()?new t(NaN):n.isZero()||e.isZero()?n:!n.isFinite()&&!e.isFinite()?new t(NaN):e.lt(55)?n.times(Math.pow(2,e.toNumber())+""):n.times(new t(2).pow(e))}function bRe(n,e){if(n.isFinite()&&!n.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function rightArithShift");var t=n.constructor;return n.isNaN()||e.isNaN()||e.isNegative()&&!e.isZero()?new t(NaN):n.isZero()||e.isZero()?n:e.isFinite()?e.lt(55)?n.div(Math.pow(2,e.toNumber())+"").floor():n.div(new t(2).pow(e)).floor():n.isNegative()?new t(-1):n.isFinite()?new t(0):new t(NaN)}var a7="bitAnd",_Re=["typed","matrix","equalScalar","concat"],Lne=re(a7,_Re,n=>{var{typed:e,matrix:t,equalScalar:r,concat:i}=n,s=xu({typed:e,equalScalar:r}),a=VN({typed:e,equalScalar:r}),o=Is({typed:e,equalScalar:r}),l=or({typed:e,matrix:t,concat:i});return e(a7,{"number, number":tne,"BigNumber, BigNumber":gRe,"bigint, bigint":(u,c)=>u&c},l({SS:a,DS:s,Ss:o}))}),o7="bitNot",wRe=["typed"],ERe=re(o7,wRe,n=>{var{typed:e}=n;return e(o7,{number:nne,BigNumber:Iw,bigint:t=>~t,"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),l7="bitOr",SRe=["typed","matrix","equalScalar","DenseMatrix","concat"],One=re(l7,SRe,n=>{var{typed:e,matrix:t,equalScalar:r,DenseMatrix:i,concat:s}=n,a=Kp({typed:e}),o=tU({typed:e,equalScalar:r}),l=zv({typed:e,DenseMatrix:i}),u=or({typed:e,matrix:t,concat:s});return e(l7,{"number, number":rne,"BigNumber, BigNumber":vRe,"bigint, bigint":(c,h)=>c|h},u({SS:o,DS:a,Ss:l}))}),ARe="matAlgo07xSSf",TRe=["typed","SparseMatrix"],Pc=re(ARe,TRe,n=>{var{typed:e,SparseMatrix:t}=n;return function(s,a,o){var l=s._size,u=s._datatype||s._data===void 0?s._datatype:s.getDataType(),c=a._size,h=a._datatype||a._data===void 0?a._datatype:a.getDataType();if(l.length!==c.length)throw new en(l.length,c.length);if(l[0]!==c[0]||l[1]!==c[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+c+")");var d=l[0],f=l[1],p,m=0,y=o;typeof u=="string"&&u===h&&u!=="mixed"&&(p=u,m=e.convert(0,p),y=e.find(o,[p,p]));for(var v=[],b=[],x=new Array(f+1).fill(0),w=[],_=[],E=[],A=[],T=0;T<f;T++){var S=T+1,M=0;r(s,T,E,w,S),r(a,T,A,_,S);for(var D=0;D<d;D++){var N=E[D]===S?w[D]:m,R=A[D]===S?_[D]:m,O=y(N,R);O!==0&&O!==!1&&(b.push(D),v.push(O),M++)}x[T+1]=x[T]+M}return new t({values:v,index:b,ptr:x,size:[d,f],datatype:u===s._datatype&&h===a._datatype?p:void 0})};function r(i,s,a,o,l){for(var u=i._values,c=i._index,h=i._ptr,d=h[s],f=h[s+1];d<f;d++){var p=c[d];a[p]=l,o[p]=u[d]}}}),u7="bitXor",MRe=["typed","matrix","DenseMatrix","concat","SparseMatrix"],CRe=re(u7,MRe,n=>{var{typed:e,matrix:t,DenseMatrix:r,concat:i,SparseMatrix:s}=n,a=sa({typed:e}),o=Pc({typed:e,SparseMatrix:s}),l=Ui({typed:e,DenseMatrix:r}),u=or({typed:e,matrix:t,concat:i});return e(u7,{"number, number":ine,"BigNumber, BigNumber":yRe,"bigint, bigint":(c,h)=>c^h},u({SS:o,DS:a,Ss:l}))}),c7="arg",DRe=["typed"],NRe=re(c7,DRe,n=>{var{typed:e}=n;return e(c7,{number:function(r){return Math.atan2(0,r)},BigNumber:function(r){return r.constructor.atan2(0,r)},Complex:function(r){return r.arg()},"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),h7="conj",RRe=["typed"],IRe=re(h7,RRe,n=>{var{typed:e}=n;return e(h7,{"number | BigNumber | Fraction":t=>t,Complex:t=>t.conjugate(),Unit:e.referToSelf(t=>r=>new r.constructor(t(r.toNumeric()),r.formatUnits())),"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),d7="im",PRe=["typed"],FRe=re(d7,PRe,n=>{var{typed:e}=n;return e(d7,{number:()=>0,"BigNumber | Fraction":t=>t.mul(0),Complex:t=>t.im,"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),f7="re",LRe=["typed"],ORe=re(f7,LRe,n=>{var{typed:e}=n;return e(f7,{"number | BigNumber | Fraction":t=>t,Complex:t=>t.re,"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),p7="not",kRe=["typed"],BRe=re(p7,kRe,n=>{var{typed:e}=n;return e(p7,{"null | undefined":()=>!0,number:une,Complex:function(r){return r.re===0&&r.im===0},BigNumber:function(r){return r.isZero()||r.isNaN()},bigint:t=>!t,Unit:e.referToSelf(t=>r=>e.find(t,r.valueType())(r.value)),"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),m7="nullish",URe=["typed","matrix","size","flatten","deepEqual"],kne=re(m7,URe,n=>{var{typed:e,matrix:t,size:r,flatten:i,deepEqual:s}=n,a=sa({typed:e}),o=Rl({typed:e}),l=Ine({typed:e});return e(m7,{"number|bigint|Complex|BigNumber|Fraction|Unit|string|boolean|SparseMatrix, any":(u,c)=>u,"null, any":(u,c)=>c,"undefined, any":(u,c)=>c,"SparseMatrix, Array | Matrix":(u,c)=>{var h=r(u),d=r(c);if(s(h,d))return u;throw new en(h,d)},"DenseMatrix, DenseMatrix":e.referToSelf(u=>(c,h)=>l(c,h,u)),"DenseMatrix, SparseMatrix":e.referToSelf(u=>(c,h)=>a(c,h,u,!1)),"DenseMatrix, Array":e.referToSelf(u=>(c,h)=>l(c,t(h),u)),"DenseMatrix, any":e.referToSelf(u=>(c,h)=>o(c,h,u,!1)),"Array, Array":e.referToSelf(u=>(c,h)=>l(t(c),t(h),u).valueOf()),"Array, DenseMatrix":e.referToSelf(u=>(c,h)=>l(t(c),h,u)),"Array, SparseMatrix":e.referToSelf(u=>(c,h)=>a(t(c),h,u,!1)),"Array, any":e.referToSelf(u=>(c,h)=>o(t(c),h,u,!1).valueOf())})}),g7="or",VRe=["typed","matrix","equalScalar","DenseMatrix","concat"],Bne=re(g7,VRe,n=>{var{typed:e,matrix:t,equalScalar:r,DenseMatrix:i,concat:s}=n,a=sa({typed:e}),o=UN({typed:e,equalScalar:r}),l=Ui({typed:e,DenseMatrix:i}),u=or({typed:e,matrix:t,concat:s});return e(g7,{"number, number":CO,"Complex, Complex":function(h,d){return h.re!==0||h.im!==0||d.re!==0||d.im!==0},"BigNumber, BigNumber":function(h,d){return!h.isZero()&&!h.isNaN()||!d.isZero()&&!d.isNaN()},"bigint, bigint":CO,"Unit, Unit":e.referToSelf(c=>(h,d)=>c(h.value||0,d.value||0))},u({SS:o,DS:a,Ss:l}))}),v7="xor",zRe=["typed","matrix","DenseMatrix","concat","SparseMatrix"],$Re=re(v7,zRe,n=>{var{typed:e,matrix:t,DenseMatrix:r,concat:i,SparseMatrix:s}=n,a=sa({typed:e}),o=Pc({typed:e,SparseMatrix:s}),l=Ui({typed:e,DenseMatrix:r}),u=or({typed:e,matrix:t,concat:i});return e(v7,{"number, number":DO,"Complex, Complex":function(h,d){return(h.re!==0||h.im!==0)!=(d.re!==0||d.im!==0)},"bigint, bigint":DO,"BigNumber, BigNumber":function(h,d){return(!h.isZero()&&!h.isNaN())!=(!d.isZero()&&!d.isNaN())},"Unit, Unit":e.referToSelf(c=>(h,d)=>c(h.value||0,d.value||0))},u({SS:o,DS:a,Ss:l}))}),y7="concat",HRe=["typed","matrix","isInteger"],Une=re(y7,HRe,n=>{var{typed:e,matrix:t,isInteger:r}=n;return e(y7,{"...Array | Matrix | number | BigNumber":function(s){var a,o=s.length,l=-1,u,c=!1,h=[];for(a=0;a<o;a++){var d=s[a];if(Dt(d)&&(c=!0),Tt(d)||jt(d)){if(a!==o-1)throw new Error("Dimension must be specified as last argument");if(u=l,l=d.valueOf(),!r(l))throw new TypeError("Integer number expected for dimension");if(l<0||a>0&&l>u)throw new vu(l,u+1)}else{var f=Ut(d).valueOf(),p=Vt(f);if(h[a]=f,u=l,l=p.length-1,a>0&&l!==u)throw new en(u+1,l+1)}}if(h.length===0)throw new SyntaxError("At least one matrix expected");for(var m=h.shift();h.length;)m=Bte(m,h.shift(),l);return c?t(m):m},"...string":function(s){return s.join("")}})}),x7="column",GRe=["typed","Index","matrix","range"],Vne=re(x7,GRe,n=>{var{typed:e,Index:t,matrix:r,range:i}=n;return e(x7,{"Matrix, number":s,"Array, number":function(o,l){return s(r(Ut(o)),l).valueOf()}});function s(a,o){if(a.size().length!==2)throw new Error("Only two dimensional matrix is supported");sr(o,a.size()[1]);var l=i(0,a.size()[0]),u=new t(l,[o]),c=a.subset(u);return Dt(c)?c:r([[c]])}}),b7="count",jRe=["typed","size","prod"],qRe=re(b7,jRe,n=>{var{typed:e,size:t,prod:r}=n;return e(b7,{string:function(s){return s.length},"Matrix | Array":function(s){return r(t(s))}})}),_7="cross",WRe=["typed","matrix","subtract","multiply"],XRe=re(_7,WRe,n=>{var{typed:e,matrix:t,subtract:r,multiply:i}=n;return e(_7,{"Matrix, Matrix":function(o,l){return t(s(o.toArray(),l.toArray()))},"Matrix, Array":function(o,l){return t(s(o.toArray(),l))},"Array, Matrix":function(o,l){return t(s(o,l.toArray()))},"Array, Array":s});function s(a,o){var l=Math.max(Vt(a).length,Vt(o).length);a=UD(a),o=UD(o);var u=Vt(a),c=Vt(o);if(u.length!==1||c.length!==1||u[0]!==3||c[0]!==3)throw new RangeError("Vectors with length 3 expected (Size A = ["+u.join(", ")+"], B = ["+c.join(", ")+"])");var h=[r(i(a[1],o[2]),i(a[2],o[1])),r(i(a[2],o[0]),i(a[0],o[2])),r(i(a[0],o[1]),i(a[1],o[0]))];return l>1?[h]:h}}),w7="diag",KRe=["typed","matrix","DenseMatrix","SparseMatrix"],YRe=re(w7,KRe,n=>{var{typed:e,matrix:t,DenseMatrix:r,SparseMatrix:i}=n;return e(w7,{Array:function(u){return s(u,0,Vt(u),null)},"Array, number":function(u,c){return s(u,c,Vt(u),null)},"Array, BigNumber":function(u,c){return s(u,c.toNumber(),Vt(u),null)},"Array, string":function(u,c){return s(u,0,Vt(u),c)},"Array, number, string":function(u,c,h){return s(u,c,Vt(u),h)},"Array, BigNumber, string":function(u,c,h){return s(u,c.toNumber(),Vt(u),h)},Matrix:function(u){return s(u,0,u.size(),u.storage())},"Matrix, number":function(u,c){return s(u,c,u.size(),u.storage())},"Matrix, BigNumber":function(u,c){return s(u,c.toNumber(),u.size(),u.storage())},"Matrix, string":function(u,c){return s(u,0,u.size(),c)},"Matrix, number, string":function(u,c,h){return s(u,c,u.size(),h)},"Matrix, BigNumber, string":function(u,c,h){return s(u,c.toNumber(),u.size(),h)}});function s(l,u,c,h){if(!bt(u))throw new TypeError("Second parameter in function diag must be an integer");var d=u>0?u:0,f=u<0?-u:0;switch(c.length){case 1:return a(l,u,h,c[0],f,d);case 2:return o(l,u,h,c,f,d)}throw new RangeError("Matrix for function diag must be 2 dimensional")}function a(l,u,c,h,d,f){var p=[h+d,h+f];if(c&&c!=="sparse"&&c!=="dense")throw new TypeError("Unknown matrix type ".concat(c,'"'));var m=c==="sparse"?i.diagonal(p,l,u):r.diagonal(p,l,u);return c!==null?m:m.valueOf()}function o(l,u,c,h,d,f){if(Dt(l)){var p=l.diagonal(u);return c!==null?c!==p.storage()?t(p,c):p:p.valueOf()}for(var m=Math.min(h[0]-d,h[1]-f),y=[],v=0;v<m;v++)y[v]=l[v+d][v+f];return c!==null?t(y):y}}),QRe="filter",ZRe=["typed"],zne=re(QRe,ZRe,n=>{var{typed:e}=n;return e("filter",{"Array, function":E7,"Matrix, function":function(r,i){return r.create(E7(r.valueOf(),i),r.datatype())},"Array, RegExp":h$,"Matrix, RegExp":function(r,i){return r.create(h$(r.valueOf(),i),r.datatype())}})});function E7(n,e){var t=Dv(e,n,"filter");return t.isUnary?c$(n,t.fn):c$(n,function(r,i,s){return t.fn(r,[i],s)})}var S7="flatten",JRe=["typed"],eIe=re(S7,JRe,n=>{var{typed:e}=n;return e(S7,{Array:function(r){return Tn(r)},DenseMatrix:function(r){return r.create(Tn(r.valueOf(),!0),r.datatype())},SparseMatrix:function(r){throw new TypeError("SparseMatrix is not supported by function flatten because it does not support 1D vectors. Convert to a DenseMatrix or Array first. Example: flatten(x.toArray())")}})}),LO="forEach",tIe=["typed"],$ne=re(LO,tIe,n=>{var{typed:e}=n;return e(LO,{"Array, function":nIe,"Matrix, function":function(r,i){r.forEach(i)}})});function nIe(n,e){var t=Dv(e,n,LO);Vte(n,t.fn,t.isUnary)}var A7="getMatrixDataType",rIe=["typed"],iIe=re(A7,rIe,n=>{var{typed:e}=n;return e(A7,{Array:function(r){return kN(r,Yn)},Matrix:function(r){return r.getDataType()}})}),T7="identity",sIe=["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],aIe=re(T7,sIe,n=>{var{typed:e,config:t,matrix:r,BigNumber:i,DenseMatrix:s,SparseMatrix:a}=n;return e(T7,{"":function(){return t.matrix==="Matrix"?r([]):[]},string:function(c){return r(c)},"number | BigNumber":function(c){return l(c,c,t.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, string":function(c,h){return l(c,c,h)},"number | BigNumber, number | BigNumber":function(c,h){return l(c,h,t.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(c,h,d){return l(c,h,d)},Array:function(c){return o(c)},"Array, string":function(c,h){return o(c,h)},Matrix:function(c){return o(c.valueOf(),c.storage())},"Matrix, string":function(c,h){return o(c.valueOf(),h)}});function o(u,c){switch(u.length){case 0:return c?r(c):[];case 1:return l(u[0],u[0],c);case 2:return l(u[0],u[1],c);default:throw new Error("Vector containing two values expected")}}function l(u,c,h){var d=jt(u)||jt(c)?i:null;if(jt(u)&&(u=u.toNumber()),jt(c)&&(c=c.toNumber()),!bt(u)||u<1)throw new Error("Parameters in function identity must be positive integers");if(!bt(c)||c<1)throw new Error("Parameters in function identity must be positive integers");var f=d?new i(1):1,p=d?new d(0):0,m=[u,c];if(h){if(h==="sparse")return a.diagonal(m,f,0,p);if(h==="dense")return s.diagonal(m,f,0,p);throw new TypeError('Unknown matrix type "'.concat(h,'"'))}for(var y=Eb([],m,p),v=u<c?u:c,b=0;b<v;b++)y[b][b]=f;return y}}),M7="kron",oIe=["typed","matrix","multiplyScalar"],lIe=re(M7,oIe,n=>{var{typed:e,matrix:t,multiplyScalar:r}=n;return e(M7,{"Matrix, Matrix":function(o,l){return t(s(o.toArray(),l.toArray()))},"Matrix, Array":function(o,l){return t(s(o.toArray(),l))},"Array, Matrix":function(o,l){return t(s(o,l.toArray()))},"Array, Array":s});function i(a,o){return a.flatMap(l=>o.map(u=>r(l,u)))}function s(a,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;if(l<0){var u=Vt(a).length,c=Vt(o).length;for(l=Math.max(u,c);u++<l;)a=[a];for(;c++<l;)o=[o]}return l===1?i(a,o):a.flatMap(h=>o.map(d=>s(h,d,l-1)))}}),JI="map",uIe=["typed"],Hne=re(JI,uIe,n=>{var{typed:e}=n;return e(JI,{"Array, function":o,"Matrix, function":function(u,c){return u.map(c)},"Array|Matrix, Array|Matrix, ...Array|Matrix|function":(l,u,c)=>t([l,u,...c.slice(0,c.length-1)],c[c.length-1])});function t(l,u){if(typeof u!="function")throw new Error("Last argument must be a callback function");var c=l[0].isMatrix,h=l.map(_=>_.isMatrix?_.size():Vt(_)),d=zD(...h),f=l.length,p=c?(_,E)=>_.get(E):$D,m=l.map((_,E)=>{var A=h[E].map(()=>0);return _.isMatrix?_.get(A):$D(_,A)}),y=e.isTypedFunction(u)?a(u,m,d.map(()=>0),l):s(u,f);if(y<2){var v=i(y,u,null);return r(l,v)}var b=c?l.map(_=>_.isMatrix?_.create(Gm(_.toArray(),d),_.datatype()):l[0].create(Gm(_.valueOf(),d))):l.map(_=>_.isMatrix?Gm(_.toArray(),d):Gm(_,d)),x=i(y,u,b),w=(_,E)=>x([_,...b.slice(1).map(A=>p(A,E))],E);return c?b[0].map(w):o(b[0],w)}function r(l,u){var c=l[0],h=l.map(_=>_.isMatrix?_.valueOf():_),d=l.map(_=>_.isMatrix?_.size():Vt(_)),f=zD(...d),p=d.map(_=>f.length-_.length),m=f.length-1,y=u.length>1,v=y?[]:null,b=w(h,0);if(c.isMatrix){var x=c.create();return x._data=b,x._size=f,x}else return b;function w(_){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,A=f[E],T=Array(A);if(E<m)for(var S=function(O){v&&(v[E]=O),T[O]=w(_.map((G,I)=>p[I]>E?G:G.length===1?G[0]:G[O]),E+1)},M=0;M<A;M++)S(M);else for(var D=function(O){v&&(v[E]=O),T[O]=u(_.map(G=>G.length===1?G[0]:G[O]),v?v.slice():void 0)},N=0;N<A;N++)D(N);return T}}function i(l,u,c){switch(l){case 0:return h=>u(...h);case 1:return(h,d)=>u(...h,d);case 2:return(h,d)=>u(...h,d,...c)}}function s(l,u){var c=l.toString();if(/arguments/.test(c))return 2;var h=c.match(/\(.*?\)/);return/\.\.\./.test(h)||l.length>u+1?2:l.length===u+1?1:0}function a(l,u,c,h){return e.resolve(l,[...u,c,...h])!==null?2:e.resolve(l,[...u,c])!==null?1:(e.resolve(l,u)!==null,0)}function o(l,u){var c=Dv(u,l,JI);return AO(l,c.fn,c.isUnary)}}),C7="diff",cIe=["typed","matrix","subtract","number"],Gne=re(C7,cIe,n=>{var{typed:e,matrix:t,subtract:r,number:i}=n;return e(C7,{"Array | Matrix":function(c){return Dt(c)?t(a(c.toArray())):a(c)},"Array | Matrix, number":function(c,h){if(!bt(h))throw new RangeError("Dimension must be a whole number");return Dt(c)?t(s(c.toArray(),h)):s(c,h)},"Array, BigNumber":e.referTo("Array,number",u=>(c,h)=>u(c,i(h))),"Matrix, BigNumber":e.referTo("Matrix,number",u=>(c,h)=>u(c,i(h)))});function s(u,c){if(Dt(u)&&(u=u.toArray()),!Array.isArray(u))throw RangeError("Array/Matrix does not have that many dimensions");if(c>0){var h=[];return u.forEach(d=>{h.push(s(d,c-1))}),h}else{if(c===0)return a(u);throw RangeError("Cannot have negative dimension")}}function a(u){for(var c=[],h=u.length,d=1;d<h;d++)c.push(o(u[d-1],u[d]));return c}function o(u,c){Dt(u)&&(u=u.toArray()),Dt(c)&&(c=c.toArray());var h=Array.isArray(u),d=Array.isArray(c);if(h&&d)return l(u,c);if(!h&&!d)return r(c,u);throw TypeError("Cannot calculate difference between 1 array and 1 non-array")}function l(u,c){if(u.length!==c.length)throw RangeError("Not all sub-arrays have the same length");for(var h=[],d=u.length,f=0;f<d;f++)h.push(o(u[f],c[f]));return h}}),hIe="ones",dIe=["typed","config","matrix","BigNumber"],fIe=re(hIe,dIe,n=>{var{typed:e,config:t,matrix:r,BigNumber:i}=n;return e("ones",{"":function(){return t.matrix==="Array"?s([]):s([],"default")},"...number | BigNumber | string":function(u){var c=u[u.length-1];if(typeof c=="string"){var h=u.pop();return s(u,h)}else return t.matrix==="Array"?s(u):s(u,"default")},Array:s,Matrix:function(u){var c=u.storage();return s(u.valueOf(),c)},"Array | Matrix, string":function(u,c){return s(u.valueOf(),c)}});function s(l,u){var c=a(l),h=c?new i(1):1;if(o(l),u){var d=r(u);return l.length>0?d.resize(l,h):d}else{var f=[];return l.length>0?Eb(f,l,h):f}}function a(l){var u=!1;return l.forEach(function(c,h,d){jt(c)&&(u=!0,d[h]=c.toNumber())}),u}function o(l){l.forEach(function(u){if(typeof u!="number"||!bt(u)||u<0)throw new Error("Parameters in function ones must be positive integers")})}});function iU(){throw new Error('No "bignumber" implementation available')}function jne(){throw new Error('No "fraction" implementation available')}function pIe(){throw new Error('No "matrix" implementation available')}var D7="range",mIe=["typed","config","?matrix","?bignumber","equal","smaller","smallerEq","larger","largerEq","add","isZero","isPositive"],qne=re(D7,mIe,n=>{var{typed:e,config:t,matrix:r,bignumber:i,smaller:s,smallerEq:a,larger:o,largerEq:l,add:u,isZero:c,isPositive:h}=n;return e(D7,{string:f,"string, boolean":f,number:function(v){throw new TypeError("Too few arguments to function range(): ".concat(v))},boolean:function(v){throw new TypeError("Unexpected type of argument 1 to function range(): ".concat(v,", number|bigint|BigNumber|Fraction"))},"number, number":function(v,b){return d(p(v,b,1,!1))},"number, number, number":function(v,b,x){return d(p(v,b,x,!1))},"number, number, boolean":function(v,b,x){return d(p(v,b,1,x))},"number, number, number, boolean":function(v,b,x,w){return d(p(v,b,x,w))},"bigint, bigint|number":function(v,b){return d(p(v,b,1n,!1))},"number, bigint":function(v,b){return d(p(BigInt(v),b,1n,!1))},"bigint, bigint|number, bigint|number":function(v,b,x){return d(p(v,b,BigInt(x),!1))},"number, bigint, bigint|number":function(v,b,x){return d(p(BigInt(v),b,BigInt(x),!1))},"bigint, bigint|number, boolean":function(v,b,x){return d(p(v,b,1n,x))},"number, bigint, boolean":function(v,b,x){return d(p(BigInt(v),b,1n,x))},"bigint, bigint|number, bigint|number, boolean":function(v,b,x,w){return d(p(v,b,BigInt(x),w))},"number, bigint, bigint|number, boolean":function(v,b,x,w){return d(p(BigInt(v),b,BigInt(x),w))},"BigNumber, BigNumber":function(v,b){var x=v.constructor;return d(p(v,b,new x(1),!1))},"BigNumber, BigNumber, BigNumber":function(v,b,x){return d(p(v,b,x,!1))},"BigNumber, BigNumber, boolean":function(v,b,x){var w=v.constructor;return d(p(v,b,new w(1),x))},"BigNumber, BigNumber, BigNumber, boolean":function(v,b,x,w){return d(p(v,b,x,w))},"Fraction, Fraction":function(v,b){return d(p(v,b,1,!1))},"Fraction, Fraction, Fraction":function(v,b,x){return d(p(v,b,x,!1))},"Fraction, Fraction, boolean":function(v,b,x){return d(p(v,b,1,x))},"Fraction, Fraction, Fraction, boolean":function(v,b,x,w){return d(p(v,b,x,w))},"Unit, Unit, Unit":function(v,b,x){return d(p(v,b,x,!1))},"Unit, Unit, Unit, boolean":function(v,b,x,w){return d(p(v,b,x,w))}});function d(y){return t.matrix==="Matrix"?r?r(y):pIe():y}function f(y,v){var b=m(y);if(!b)throw new SyntaxError('String "'+y+'" is no valid range');return t.number==="BigNumber"?(i===void 0&&iU(),d(p(i(b.start),i(b.end),i(b.step)))):d(p(b.start,b.end,b.step,v))}function p(y,v,b,x){var w=[];if(c(b))throw new Error("Step must be non-zero");for(var _=h(b)?x?a:s:x?l:o,E=y;_(E,v);)w.push(E),E=u(E,b);return w}function m(y){var v=y.split(":"),b=v.map(function(w){return Number(w)}),x=b.some(function(w){return isNaN(w)});if(x)return null;switch(b.length){case 2:return{start:b[0],end:b[1],step:1};case 3:return{start:b[0],end:b[2],step:b[1]};default:return null}}}),N7="reshape",gIe=["typed","isInteger","matrix"],vIe=re(N7,gIe,n=>{var{typed:e,isInteger:t}=n;return e(N7,{"Matrix, Array":function(i,s){return i.reshape(s,!0)},"Array, Array":function(i,s){return s.forEach(function(a){if(!t(a))throw new TypeError("Invalid size for dimension: "+a)}),Q4(i,s)}})}),yIe="resize",xIe=["config","matrix"],bIe=re(yIe,xIe,n=>{var{config:e,matrix:t}=n;return function(s,a,o){if(arguments.length!==2&&arguments.length!==3)throw new $v("resize",arguments.length,2,3);if(Dt(a)&&(a=a.valueOf()),jt(a[0])&&(a=a.map(function(c){return jt(c)?c.toNumber():c})),Dt(s))return s.resize(a,o,!0);if(typeof s=="string")return r(s,a,o);var l=Array.isArray(s)?!1:e.matrix!=="Array";if(a.length===0){for(;Array.isArray(s);)s=s[0];return Ut(s)}else{Array.isArray(s)||(s=[s]),s=Ut(s);var u=Eb(s,a,o);return l?t(u):u}};function r(i,s,a){if(a!==void 0){if(typeof a!="string"||a.length!==1)throw new TypeError("Single character expected as defaultValue")}else a=" ";if(s.length!==1)throw new en(s.length,1);var o=s[0];if(typeof o!="number"||!bt(o))throw new TypeError("Invalid size, must contain positive integers (size: "+nn(s)+")");if(i.length>o)return i.substring(0,o);if(i.length<o){for(var l=i,u=0,c=o-i.length;u<c;u++)l+=a;return l}else return i}}),R7="rotate",_Ie=["typed","multiply","rotationMatrix"],wIe=re(R7,_Ie,n=>{var{typed:e,multiply:t,rotationMatrix:r}=n;return e(R7,{"Array , number | BigNumber | Complex | Unit":function(a,o){i(a,2);var l=t(r(o),a);return l.toArray()},"Matrix , number | BigNumber | Complex | Unit":function(a,o){return i(a,2),t(r(o),a)},"Array, number | BigNumber | Complex | Unit, Array | Matrix":function(a,o,l){i(a,3);var u=t(r(o,l),a);return u},"Matrix, number | BigNumber | Complex | Unit, Array | Matrix":function(a,o,l){return i(a,3),t(r(o,l),a)}});function i(s,a){var o=Array.isArray(s)?Vt(s):s.size();if(o.length>2)throw new RangeError("Vector must be of dimensions 1x".concat(a));if(o.length===2&&o[1]!==1)throw new RangeError("Vector must be of dimensions 1x".concat(a));if(o[0]!==a)throw new RangeError("Vector must be of dimensions 1x".concat(a))}}),I7="rotationMatrix",EIe=["typed","config","multiplyScalar","addScalar","unaryMinus","norm","matrix","BigNumber","DenseMatrix","SparseMatrix","cos","sin"],SIe=re(I7,EIe,n=>{var{typed:e,config:t,multiplyScalar:r,addScalar:i,unaryMinus:s,norm:a,BigNumber:o,matrix:l,DenseMatrix:u,SparseMatrix:c,cos:h,sin:d}=n;return e(I7,{"":function(){return t.matrix==="Matrix"?l([]):[]},string:function(x){return l(x)},"number | BigNumber | Complex | Unit":function(x){return f(x,t.matrix==="Matrix"?"dense":void 0)},"number | BigNumber | Complex | Unit, string":function(x,w){return f(x,w)},"number | BigNumber | Complex | Unit, Array":function(x,w){var _=l(w);return p(_),v(x,_,void 0)},"number | BigNumber | Complex | Unit, Matrix":function(x,w){p(w);var _=w.storage()||(t.matrix==="Matrix"?"dense":void 0);return v(x,w,_)},"number | BigNumber | Complex | Unit, Array, string":function(x,w,_){var E=l(w);return p(E),v(x,E,_)},"number | BigNumber | Complex | Unit, Matrix, string":function(x,w,_){return p(w),v(x,w,_)}});function f(b,x){var w=jt(b),_=w?new o(-1):-1,E=h(b),A=d(b),T=[[E,r(_,A)],[A,E]];return y(T,x)}function p(b){var x=b.size();if(x.length<1||x[0]!==3)throw new RangeError("Vector must be of dimensions 1x3")}function m(b){return b.reduce((x,w)=>r(x,w))}function y(b,x){if(x){if(x==="sparse")return new c(b);if(x==="dense")return new u(b);throw new TypeError('Unknown matrix type "'.concat(x,'"'))}return b}function v(b,x,w){var _=a(x);if(_===0)throw new RangeError("Rotation around zero vector");var E=jt(b)?o:null,A=E?new E(1):1,T=E?new E(-1):-1,S=E?new E(x.get([0])/_):x.get([0])/_,M=E?new E(x.get([1])/_):x.get([1])/_,D=E?new E(x.get([2])/_):x.get([2])/_,N=h(b),R=i(A,s(N)),O=d(b),G=i(N,m([S,S,R])),I=i(m([S,M,R]),m([T,D,O])),B=i(m([S,D,R]),m([M,O])),$=i(m([S,M,R]),m([D,O])),H=i(N,m([M,M,R])),Q=i(m([M,D,R]),m([T,S,O])),ee=i(m([S,D,R]),m([T,M,O])),J=i(m([M,D,R]),m([S,O])),L=i(N,m([D,D,R])),se=[[G,I,B],[$,H,Q],[ee,J,L]];return y(se,w)}}),P7="row",AIe=["typed","Index","matrix","range"],Wne=re(P7,AIe,n=>{var{typed:e,Index:t,matrix:r,range:i}=n;return e(P7,{"Matrix, number":s,"Array, number":function(o,l){return s(r(Ut(o)),l).valueOf()}});function s(a,o){if(a.size().length!==2)throw new Error("Only two dimensional matrix is supported");sr(o,a.size()[0]);var l=i(0,a.size()[1]),u=new t([o],l),c=a.subset(u);return Dt(c)?c:r([[c]])}}),F7="size",TIe=["typed"],MIe=re(F7,TIe,n=>{var{typed:e}=n;return e(F7,{Matrix:t=>t.size(),Array:Vt,string:t=>[t.length],"number | Complex | BigNumber | Unit | boolean | null":t=>[]})}),L7="squeeze",CIe=["typed"],DIe=re(L7,CIe,n=>{var{typed:e}=n;return e(L7,{Array:function(r){return UD(Ut(r))},Matrix:function(r){var i=UD(r.toArray());return Array.isArray(i)?r.create(i,r.datatype()):i},any:function(r){return Ut(r)}})}),O7="subset",NIe=["typed","matrix","zeros","add"],Xne=re(O7,NIe,n=>{var{typed:e,matrix:t,zeros:r,add:i}=n;return e(O7,{"Matrix, Index":function(o,l){return wb(l)?t():(BD(o,l),o.subset(l))},"Array, Index":e.referTo("Matrix, Index",function(a){return function(o,l){var u=a(t(o),l);return l.isScalar()?u:u.valueOf()}}),"Object, Index":IIe,"string, Index":RIe,"Matrix, Index, any, any":function(o,l,u,c){return wb(l)?o:(BD(o,l),o.clone().subset(l,s(u,l),c))},"Array, Index, any, any":e.referTo("Matrix, Index, any, any",function(a){return function(o,l,u,c){var h=a(t(o),l,u,c);return h.isMatrix?h.valueOf():h}}),"Array, Index, any":e.referTo("Matrix, Index, any, any",function(a){return function(o,l,u){return a(t(o),l,u,void 0).valueOf()}}),"Matrix, Index, any":e.referTo("Matrix, Index, any, any",function(a){return function(o,l,u){return a(o,l,u,void 0)}}),"string, Index, string":k7,"string, Index, string, string":k7,"Object, Index, any":PIe});function s(a,o){if(typeof a=="string")throw new Error("can't boradcast a string");if(o.isScalar())return a;var l=o.size();if(l.every(u=>u>0))try{return i(a,r(l))}catch{return a}else return a}});function RIe(n,e){if(!NN(e))throw new TypeError("Index expected");if(wb(e))return"";if(BD(Array.from(n),e),e.size().length!==1)throw new en(e.size().length,1);var t=n.length;sr(e.min()[0],t),sr(e.max()[0],t);var r=e.dimension(0),i="";function s(a){i+=n.charAt(a)}return Number.isInteger(r)?s(r):r.forEach(s),i}function k7(n,e,t,r){if(!e||e.isIndex!==!0)throw new TypeError("Index expected");if(wb(e))return n;if(BD(Array.from(n),e),e.size().length!==1)throw new en(e.size().length,1);if(r!==void 0){if(typeof r!="string"||r.length!==1)throw new TypeError("Single character expected as defaultValue")}else r=" ";var i=e.dimension(0),s=Number.isInteger(i)?1:i.size()[0];if(s!==t.length)throw new en(i.size()[0],t.length);var a=n.length;sr(e.min()[0]),sr(e.max()[0]);for(var o=[],l=0;l<a;l++)o[l]=n.charAt(l);function u(d,f){o[d]=t.charAt(f[0])}if(Number.isInteger(i)?u(i,[0]):i.forEach(u),o.length>a)for(var c=a-1,h=o.length;c<h;c++)o[c]||(o[c]=r);return o.join("")}function IIe(n,e){if(!wb(e)){if(e.size().length!==1)throw new en(e.size(),1);var t=e.dimension(0);if(typeof t!="string")throw new TypeError("String expected as index to retrieve an object property");return Ea(n,t)}}function PIe(n,e,t){if(wb(e))return n;if(e.size().length!==1)throw new en(e.size(),1);var r=e.dimension(0);if(typeof r!="string")throw new TypeError("String expected as index to retrieve an object property");var i=Ut(n);return bb(i,r,t),i}var B7="transpose",FIe=["typed","matrix"],LIe=re(B7,FIe,n=>{var{typed:e,matrix:t}=n;return e(B7,{Array:a=>r(t(a)).valueOf(),Matrix:r,any:Ut});function r(a){var o=a.size(),l;switch(o.length){case 1:l=a.clone();break;case 2:{var u=o[0],c=o[1];if(c===0)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+nn(o)+")");switch(a.storage()){case"dense":l=i(a,u,c);break;case"sparse":l=s(a,u,c);break}}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+nn(o)+")")}return l}function i(a,o,l){for(var u=a._data,c=[],h,d=0;d<l;d++){h=c[d]=[];for(var f=0;f<o;f++)h[f]=Ut(u[f][d])}return a.createDenseMatrix({data:c,size:[l,o],datatype:a._datatype})}function s(a,o,l){for(var u=a._values,c=a._index,h=a._ptr,d=u?[]:void 0,f=[],p=[],m=[],y=0;y<o;y++)m[y]=0;var v,b,x;for(v=0,b=c.length;v<b;v++)m[c[v]]++;for(var w=0,_=0;_<o;_++)p.push(w),w+=m[_],m[_]=p[_];for(p.push(w),x=0;x<l;x++)for(var E=h[x],A=h[x+1],T=E;T<A;T++){var S=m[c[T]]++;f[S]=x,u&&(d[S]=Ut(u[T]))}return a.createSparseMatrix({values:d,index:f,ptr:p,size:[l,o],datatype:a._datatype})}}),U7="ctranspose",OIe=["typed","transpose","conj"],kIe=re(U7,OIe,n=>{var{typed:e,transpose:t,conj:r}=n;return e(U7,{any:function(s){return r(t(s))}})}),V7="zeros",BIe=["typed","config","matrix","BigNumber"],UIe=re(V7,BIe,n=>{var{typed:e,config:t,matrix:r,BigNumber:i}=n;return e(V7,{"":function(){return t.matrix==="Array"?s([]):s([],"default")},"...number | BigNumber | string":function(u){var c=u[u.length-1];if(typeof c=="string"){var h=u.pop();return s(u,h)}else return t.matrix==="Array"?s(u):s(u,"default")},Array:s,Matrix:function(u){var c=u.storage();return s(u.valueOf(),c)},"Array | Matrix, string":function(u,c){return s(u.valueOf(),c)}});function s(l,u){var c=a(l),h=c?new i(0):0;if(o(l),u){var d=r(u);return l.length>0?d.resize(l,h):d}else{var f=[];return l.length>0?Eb(f,l,h):f}}function a(l){var u=!1;return l.forEach(function(c,h,d){jt(c)&&(u=!0,d[h]=c.toNumber())}),u}function o(l){l.forEach(function(u){if(typeof u!="number"||!bt(u)||u<0)throw new Error("Parameters in function zeros must be positive integers")})}}),z7="fft",VIe=["typed","matrix","addScalar","multiplyScalar","divideScalar","exp","tau","i","dotDivide","conj","pow","ceil","log2"],zIe=re(z7,VIe,n=>{var{typed:e,matrix:t,addScalar:r,multiplyScalar:i,divideScalar:s,exp:a,tau:o,i:l,dotDivide:u,conj:c,pow:h,ceil:d,log2:f}=n;return e(z7,{Array:p,Matrix:function(x){return x.create(p(x.valueOf()),x.datatype())}});function p(b){var x=Vt(b);return x.length===1?v(b,x[0]):m(b.map(w=>p(w,x.slice(1))),0)}function m(b,x){var w=Vt(b);if(x!==0)return new Array(w[0]).fill(0).map((E,A)=>m(b[A],x-1));if(w.length===1)return v(b);function _(E){var A=Vt(E);return new Array(A[1]).fill(0).map((T,S)=>new Array(A[0]).fill(0).map((M,D)=>E[D][S]))}return _(m(_(b),1))}function y(b){for(var x=b.length,w=a(s(i(-1,i(l,o)),x)),_=[],E=1-x;E<x;E++)_.push(h(w,s(h(E,2),2)));for(var A=h(2,d(f(x+x-1))),T=[...new Array(x).fill(0).map((I,B)=>i(b[B],_[x-1+B])),...new Array(A-x).fill(0)],S=[...new Array(x+x-1).fill(0).map((I,B)=>s(1,_[B])),...new Array(A-(x+x-1)).fill(0)],M=v(T),D=v(S),N=new Array(A).fill(0).map((I,B)=>i(M[B],D[B])),R=u(c(p(c(N))),A),O=[],G=x-1;G<x+x-1;G++)O.push(i(R[G],_[G]));return O}function v(b){var x=b.length;if(x===1)return[b[0]];if(x%2===0){for(var w=[...v(b.filter((T,S)=>S%2===0)),...v(b.filter((T,S)=>S%2===1))],_=0;_<x/2;_++){var E=w[_],A=i(w[_+x/2],a(i(i(o,l),s(-_,x))));w[_]=r(E,A),w[_+x/2]=r(E,i(-1,A))}return w}else return y(b)}}),$7="ifft",$Ie=["typed","fft","dotDivide","conj"],HIe=re($7,$Ie,n=>{var{typed:e,fft:t,dotDivide:r,conj:i}=n;return e($7,{"Array | Matrix":function(a){var o=Dt(a)?a.size():Vt(a);return r(i(t(i(a))),o.reduce((l,u)=>l*u,1))}})});function Pw(n){"@babel/helpers - typeof";return Pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pw(n)}function GIe(n,e){if(Pw(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(Pw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function jIe(n){var e=GIe(n,"string");return Pw(e)=="symbol"?e:e+""}function wi(n,e,t){return(e=jIe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function H7(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function qIe(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?H7(Object(t),!0).forEach(function(r){wi(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):H7(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var WIe="solveODE",XIe=["typed","add","subtract","multiply","divide","max","map","abs","isPositive","isNegative","larger","smaller","matrix","bignumber","unaryMinus"],KIe=re(WIe,XIe,n=>{var{typed:e,add:t,subtract:r,multiply:i,divide:s,max:a,map:o,abs:l,isPositive:u,isNegative:c,larger:h,smaller:d,matrix:f,bignumber:p,unaryMinus:m}=n;function y(T){return function(S,M,D,N){var R=!(M.length===2&&(M.every(E)||M.every(No)));if(R)throw new Error('"tspan" must be an Array of two numeric values or two units [tStart, tEnd]');var O=M[0],G=M[1],I=h(G,O),B=N.firstStep;if(B!==void 0&&!u(B))throw new Error('"firstStep" must be positive');var $=N.maxStep;if($!==void 0&&!u($))throw new Error('"maxStep" must be positive');var H=N.minStep;if(H&&c(H))throw new Error('"minStep" must be positive or zero');var Q=[O,G,B,H,$].filter(F=>F!==void 0);if(!(Q.every(E)||Q.every(No)))throw new Error('Inconsistent type of "t" dependant variables');for(var ee=1,J=N.tol?N.tol:1e-4,L=N.minDelta?N.minDelta:.2,se=N.maxDelta?N.maxDelta:5,Z=N.maxIter?N.maxIter:1e4,le=[O,G,...D,$,H].some(jt),[ue,te,Y,ie]=le?[p(T.a),p(T.c),p(T.b),p(T.bp)]:[T.a,T.c,T.b,T.bp],ve=B?I?B:m(B):s(r(G,O),ee),ge=[O],_e=[D],we=r(Y,ie),Be=0,$e=0,nt=w(I),de=_(I);nt(ge[Be],G);){var Ye=[];ve=de(ge[Be],G,ve),Ye.push(S(ge[Be],_e[Be]));for(var Xe=1;Xe<te.length;++Xe)Ye.push(S(t(ge[Be],i(te[Xe],ve)),t(_e[Be],i(ve,ue[Xe],Ye))));var ae=a(l(o(i(we,Ye),F=>No(F)?F.value:F)));ae<J&&J/ae>1/4&&(ge.push(t(ge[Be],ve)),_e.push(t(_e[Be],i(ve,Y,Ye))),Be++);var fe=.84*(J/ae)**(1/5);if(d(fe,L)?fe=L:h(fe,se)&&(fe=se),fe=le?p(fe):fe,ve=i(ve,fe),$&&h(l(ve),$)?ve=I?$:m($):H&&d(l(ve),H)&&(ve=I?H:m(H)),$e++,$e>Z)throw new Error("Maximum number of iterations reached, try changing options")}return{t:ge,y:_e}}}function v(T,S,M,D){var N=[[],[.5],[0,.75],[.2222222222222222,.3333333333333333,.4444444444444444]],R=[null,1/2,3/4,1],O=[2/9,1/3,4/9,0],G=[7/24,1/4,1/3,1/8],I={a:N,c:R,b:O,bp:G};return y(I)(T,S,M,D)}function b(T,S,M,D){var N=[[],[.2],[.075,.225],[.9777777777777777,-3.7333333333333334,3.5555555555555554],[2.9525986892242035,-11.595793324188385,9.822892851699436,-.2908093278463649],[2.8462752525252526,-10.757575757575758,8.906422717743473,.2784090909090909,-.2735313036020583],[.09114583333333333,0,.44923629829290207,.6510416666666666,-.322376179245283,.13095238095238096]],R=[null,1/5,3/10,4/5,8/9,1,1],O=[35/384,0,500/1113,125/192,-2187/6784,11/84,0],G=[5179/57600,0,7571/16695,393/640,-92097/339200,187/2100,1/40],I={a:N,c:R,b:O,bp:G};return y(I)(T,S,M,D)}function x(T,S,M,D){var N=D.method?D.method:"RK45",R={RK23:v,RK45:b};if(N.toUpperCase()in R){var O=qIe({},D);return delete O.method,R[N.toUpperCase()](T,S,M,O)}else{var G=Object.keys(R).map(B=>'"'.concat(B,'"')),I="".concat(G.slice(0,-1).join(", ")," and ").concat(G.slice(-1));throw new Error('Unavailable method "'.concat(N,'". Available methods are ').concat(I))}}function w(T){return T?d:h}function _(T){var S=T?h:d;return function(M,D,N){var R=t(M,N);return S(R,D)?r(D,M):N}}function E(T){return jt(T)||Tt(T)}function A(T,S,M,D){var N=x(T,S.toArray(),M.toArray(),D);return{t:f(N.t),y:f(N.y)}}return e("solveODE",{"function, Array, Array, Object":x,"function, Matrix, Matrix, Object":A,"function, Array, Array":(T,S,M)=>x(T,S,M,{}),"function, Matrix, Matrix":(T,S,M)=>A(T,S,M,{}),"function, Array, number | BigNumber | Unit":(T,S,M)=>{var D=x(T,S,[M],{});return{t:D.t,y:D.y.map(N=>N[0])}},"function, Matrix, number | BigNumber | Unit":(T,S,M)=>{var D=x(T,S.toArray(),[M],{});return{t:f(D.t),y:f(D.y.map(N=>N[0]))}},"function, Array, number | BigNumber | Unit, Object":(T,S,M,D)=>{var N=x(T,S,[M],D);return{t:N.t,y:N.y.map(R=>R[0])}},"function, Matrix, number | BigNumber | Unit, Object":(T,S,M,D)=>{var N=x(T,S.toArray(),[M],D);return{t:f(N.t),y:f(N.y.map(R=>R[0]))}}})}),YIe="erf",QIe=["typed"],ZIe=re(YIe,QIe,n=>{var{typed:e}=n;return e("name",{number:function(a){var o=Math.abs(a);return o>=tPe?tp(a):o<=JIe?tp(a)*t(o):o<=4?tp(a)*(1-r(o)):tp(a)*(1-i(o))},"Array | Matrix":e.referToSelf(s=>a=>qt(a,s))});function t(s){var a=s*s,o=Wc[0][4]*a,l=a,u;for(u=0;u<3;u+=1)o=(o+Wc[0][u])*a,l=(l+w0[0][u])*a;return s*(o+Wc[0][3])/(l+w0[0][3])}function r(s){var a=Wc[1][8]*s,o=s,l;for(l=0;l<7;l+=1)a=(a+Wc[1][l])*s,o=(o+w0[1][l])*s;var u=(a+Wc[1][7])/(o+w0[1][7]),c=parseInt(s*16)/16,h=(s-c)*(s+c);return Math.exp(-c*c)*Math.exp(-h)*u}function i(s){var a=1/(s*s),o=Wc[2][5]*a,l=a,u;for(u=0;u<4;u+=1)o=(o+Wc[2][u])*a,l=(l+w0[2][u])*a;var c=a*(o+Wc[2][4])/(l+w0[2][4]);c=(ePe-c)/s,a=parseInt(s*16)/16;var h=(s-a)*(s+a);return Math.exp(-a*a)*Math.exp(-h)*c}}),JIe=.46875,ePe=.5641895835477563,Wc=[[3.1611237438705655,113.86415415105016,377.485237685302,3209.3775891384694,.18577770618460315],[.5641884969886701,8.883149794388377,66.11919063714163,298.6351381974001,881.952221241769,1712.0476126340707,2051.0783778260716,1230.3393547979972,21531153547440383e-24],[.30532663496123236,.36034489994980445,.12578172611122926,.016083785148742275,.0006587491615298378,.016315387137302097]],w0=[[23.601290952344122,244.02463793444417,1282.6165260773723,2844.236833439171],[15.744926110709835,117.6939508913125,537.1811018620099,1621.3895745666903,3290.7992357334597,4362.619090143247,3439.3676741437216,1230.3393548037495],[2.568520192289822,1.8729528499234604,.5279051029514285,.06051834131244132,.0023352049762686918]],tPe=Math.pow(2,53),G7="zeta",nPe=["typed","config","multiply","pow","divide","factorial","equal","smallerEq","isBounded","isNegative","gamma","sin","subtract","add","?Complex","?BigNumber","pi"],rPe=re(G7,nPe,n=>{var{typed:e,config:t,multiply:r,pow:i,divide:s,factorial:a,equal:o,smallerEq:l,isBounded:u,isNegative:c,gamma:h,sin:d,subtract:f,add:p,Complex:m,BigNumber:y,pi:v}=n;return e(G7,{number:A=>b(A,T=>T,()=>20),BigNumber:A=>b(A,T=>new y(T),()=>Math.abs(Math.log10(t.relTol))),Complex:x});function b(A,T,S){return o(A,0)?T(-.5):o(A,1)?T(NaN):u(A)?w(A,T,S,M=>M):c(A)?T(NaN):T(1)}function x(A){return A.re===0&&A.im===0?new m(-.5):A.re===1?new m(NaN,NaN):A.re===1/0&&A.im===0?new m(1):A.im===1/0||A.re===-1/0?new m(NaN,NaN):w(A,T=>T,T=>Math.round(1.3*15+.9*Math.abs(T.im)),T=>T.re)}function w(A,T,S,M){var D=S(A);if(M(A)>-(D-1)/2)return E(A,T(D),T);var N=r(i(2,A),i(T(v),f(A,1)));return N=r(N,d(r(s(T(v),2),A))),N=r(N,h(f(1,A))),r(N,w(f(1,A),T,S,M))}function _(A,T){for(var S=A,M=A;l(M,T);M=p(M,1)){var D=s(r(a(p(T,f(M,1))),i(4,M)),r(a(f(T,M)),a(r(2,M))));S=p(S,D)}return r(T,S)}function E(A,T,S){for(var M=s(1,r(_(S(0),T),f(1,i(2,f(1,A))))),D=S(0),N=S(1);l(N,T);N=p(N,1))D=p(D,s(r((-1)**(N-1),_(N,T)),i(N,A)));return r(M,D)}}),j7="mode",iPe=["typed","isNaN","isNumeric"],sPe=re(j7,iPe,n=>{var{typed:e,isNaN:t,isNumeric:r}=n;return e(j7,{"Array | Matrix":i,"...":function(a){return i(a)}});function i(s){s=Tn(s.valueOf());var a=s.length;if(a===0)throw new Error("Cannot calculate mode of an empty array");for(var o={},l=[],u=0,c=0;c<s.length;c++){var h=s[c];if(r(h)&&t(h))throw new Error("Cannot calculate mode of an array containing NaN values");h in o||(o[h]=0),o[h]++,o[h]===u?l.push(h):o[h]>u&&(u=o[h],l=[h])}return l}});function Ca(n,e,t){var r;return String(n).includes("Unexpected type")?(r=arguments.length>2?" (type: "+Yn(t)+", value: "+JSON.stringify(t)+")":" (type: "+n.data.actual+")",new TypeError("Cannot calculate "+e+", unexpected type of argument"+r)):String(n).includes("complex numbers")?(r=arguments.length>2?" (type: "+Yn(t)+", value: "+JSON.stringify(t)+")":"",new TypeError("Cannot calculate "+e+", no ordering relation is defined for complex numbers"+r)):n}var q7="prod",aPe=["typed","config","multiplyScalar","numeric"],oPe=re(q7,aPe,n=>{var{typed:e,config:t,multiplyScalar:r,numeric:i}=n;return e(q7,{"Array | Matrix":s,"Array | Matrix, number | BigNumber":function(o,l){throw new Error("prod(A, dim) is not yet supported")},"...":function(o){return s(o)}});function s(a){var o;if(Op(a,function(l){try{o=o===void 0?l:r(o,l)}catch(u){throw Ca(u,"prod",l)}}),typeof o=="string"&&(o=i(o,Wp(o,t))),o===void 0)throw new Error("Cannot calculate prod of an empty array");return o}}),W7="format",lPe=["typed"],uPe=re(W7,lPe,n=>{var{typed:e}=n;return e(W7,{any:nn,"any, Object | function | number | BigNumber":nn})}),X7="bin",cPe=["typed","format"],hPe=re(X7,cPe,n=>{var{typed:e,format:t}=n;return e(X7,{"number | BigNumber":function(i){return t(i,{notation:"bin"})},"number | BigNumber, number | BigNumber":function(i,s){return t(i,{notation:"bin",wordSize:s})}})}),K7="oct",dPe=["typed","format"],fPe=re(K7,dPe,n=>{var{typed:e,format:t}=n;return e(K7,{"number | BigNumber":function(i){return t(i,{notation:"oct"})},"number | BigNumber, number | BigNumber":function(i,s){return t(i,{notation:"oct",wordSize:s})}})}),Y7="hex",pPe=["typed","format"],mPe=re(Y7,pPe,n=>{var{typed:e,format:t}=n;return e(Y7,{"number | BigNumber":function(i){return t(i,{notation:"hex"})},"number | BigNumber, number | BigNumber":function(i,s){return t(i,{notation:"hex",wordSize:s})}})}),Kne=/\$([\w.]+)/g,Q7="print",gPe=["typed"],Yne=re(Q7,gPe,n=>{var{typed:e}=n;return e(Q7,{"string, Object | Array":Z7,"string, Object | Array, number | Object":Z7})});function Z7(n,e,t){return n.replace(Kne,function(r,i){var s=i.split("."),a=e[s.shift()];for(a!==void 0&&a.isMatrix&&(a=a.toArray());s.length&&a!==void 0;){var o=s.shift();a=o?a[o]:a+"."}return a!==void 0?Jr(a)?a:nn(a,t):r})}var J7="to",vPe=["typed","matrix","concat"],yPe=re(J7,vPe,n=>{var{typed:e,matrix:t,concat:r}=n,i=or({typed:e,matrix:t,concat:r});return e(J7,{"Unit, Unit | string":(s,a)=>s.to(a)},i({Ds:!0}))}),eH="toBest",xPe=["typed"],bPe=re(eH,xPe,n=>{var{typed:e}=n;return e(eH,{Unit:t=>t.toBest(),"Unit, string":(t,r)=>t.toBest(r.split(",")),"Unit, string, Object":(t,r,i)=>t.toBest(r.split(","),i),"Unit, Array":(t,r)=>t.toBest(r),"Unit, Array, Object":(t,r,i)=>t.toBest(r,i)})}),tH="isPrime",_Pe=["typed"],wPe=re(tH,_Pe,n=>{var{typed:e}=n;return e(tH,{number:function(r){if(r<=3)return r>1;if(r%2===0||r%3===0)return!1;for(var i=5;i*i<=r;i+=6)if(r%i===0||r%(i+2)===0)return!1;return!0},bigint:function(r){if(r<=3n)return r>1n;if(r%2n===0n||r%3n===0n)return!1;for(var i=5n;i*i<=r;i+=6n)if(r%i===0n||r%(i+2n)===0n)return!1;return!0},BigNumber:function(r){if(r.lte(3))return r.gt(1);if(r.mod(2).eq(0)||r.mod(3).eq(0))return!1;if(r.lt(Math.pow(2,32))){for(var i=r.toNumber(),s=5;s*s<=i;s+=6)if(i%s===0||i%(s+2)===0)return!1;return!0}function a(b,x,w){for(var _=1;!x.eq(0);)x.mod(2).eq(0)?(x=x.div(2),b=b.mul(b).mod(w)):(x=x.sub(1),_=b.mul(_).mod(w));return _}var o=r.constructor.clone({precision:r.toFixed(0).length*2});r=new o(r);for(var l=0,u=r.sub(1);u.mod(2).eq(0);)u=u.div(2),l+=1;var c=null;if(r.lt("3317044064679887385961981"))c=[2,3,5,7,11,13,17,19,23,29,31,37,41].filter(b=>b<r);else{var h=Math.min(r.toNumber()-2,Math.floor(2*Math.pow(r.toFixed(0).length*Math.log(10),2)));c=[];for(var d=2;d<=h;d+=1)c.push(h)}for(var f=0;f<c.length;f+=1){var p=c[f],m=a(r.sub(r).add(p),u,r);if(!m.eq(1)){for(var y=0,v=m;!v.eq(r.sub(1));y+=1,v=v.mul(v).mod(r))if(y===l-1)return!1}}return!0},"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),EPe="numeric",SPe=["number","?bignumber","?fraction"],APe=re(EPe,SPe,n=>{var{number:e,bignumber:t,fraction:r}=n,i={string:!0,number:!0,BigNumber:!0,Fraction:!0},s={number:a=>e(a),BigNumber:t?a=>t(a):iU,bigint:a=>BigInt(a),Fraction:r?a=>r(a):jne};return function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"number",u=arguments.length>2?arguments[2]:void 0;if(u!==void 0)throw new SyntaxError("numeric() takes one or two arguments");var c=Yn(o);if(!(c in i))throw new TypeError("Cannot convert "+o+' of type "'+c+'"; valid input types are '+Object.keys(i).join(", "));if(!(l in s))throw new TypeError("Cannot convert "+o+' to type "'+l+'"; valid output types are '+Object.keys(s).join(", "));return l===c?o:s[l](o)}}),nH="divideScalar",TPe=["typed","numeric"],MPe=re(nH,TPe,n=>{var{typed:e,numeric:t}=n;return e(nH,{"number, number":function(i,s){return i/s},"Complex, Complex":function(i,s){return i.div(s)},"BigNumber, BigNumber":function(i,s){return i.div(s)},"bigint, bigint":function(i,s){return i/s},"Fraction, Fraction":function(i,s){return i.div(s)},"Unit, number | Complex | Fraction | BigNumber | Unit":(r,i)=>r.divide(i),"number | Fraction | Complex | BigNumber, Unit":(r,i)=>i.divideInto(r)})}),rH="pow",CPe=["typed","config","identity","multiply","matrix","inv","fraction","number","Complex"],DPe=re(rH,CPe,n=>{var{typed:e,config:t,identity:r,multiply:i,matrix:s,inv:a,number:o,fraction:l,Complex:u}=n;return e(rH,{"number, number":c,"Complex, Complex":function(p,m){return p.pow(m)},"BigNumber, BigNumber":function(p,m){return m.isInteger()||p>=0||t.predictable?p.pow(m):new u(p.toNumber(),0).pow(m.toNumber(),0)},"bigint, bigint":(f,p)=>f**p,"Fraction, Fraction":function(p,m){var y=p.pow(m);if(y!=null)return y;if(t.predictable)throw new Error("Result of pow is non-rational and cannot be expressed as a fraction");return c(p.valueOf(),m.valueOf())},"Array, number":h,"Array, BigNumber":function(p,m){return h(p,m.toNumber())},"Matrix, number":d,"Matrix, BigNumber":function(p,m){return d(p,m.toNumber())},"Unit, number | BigNumber":function(p,m){return p.pow(m)}});function c(f,p){if(t.predictable&&!bt(p)&&f<0)try{var m=l(p),y=o(m);if((p===y||Math.abs((p-y)/p)<1e-14)&&m.d%2n===1n)return(m.n%2n===0n?1:-1)*Math.pow(-f,p)}catch{}return t.predictable&&(f<-1&&p===1/0||f>-1&&f<0&&p===-1/0)?NaN:bt(p)||f>=0||t.predictable?ene(f,p):f*f<1&&p===1/0||f*f>1&&p===-1/0?0:new u(f,0).pow(p,0)}function h(f,p){if(!bt(p))throw new TypeError("For A^b, b must be an integer (value is "+p+")");var m=Vt(f);if(m.length!==2)throw new Error("For A^b, A must be 2 dimensional (A has "+m.length+" dimensions)");if(m[0]!==m[1])throw new Error("For A^b, A must be square (size is "+m[0]+"x"+m[1]+")");if(p<0)try{return h(a(f),-p)}catch(b){throw b.message==="Cannot calculate inverse, determinant is zero"?new TypeError("For A^b, when A is not invertible, b must be a positive integer (value is "+p+")"):b}for(var y=r(m[0]).valueOf(),v=f;p>=1;)(p&1)===1&&(y=i(v,y)),p>>=1,v=i(v,v);return y}function d(f,p){return s(h(f.valueOf(),p))}}),E0="Number of decimals in function round must be an integer",iH="round",NPe=["typed","config","matrix","equalScalar","zeros","BigNumber","DenseMatrix"],RPe=re(iH,NPe,n=>{var{typed:e,config:t,matrix:r,equalScalar:i,zeros:s,BigNumber:a,DenseMatrix:o}=n,l=Is({typed:e,equalScalar:i}),u=Ui({typed:e,DenseMatrix:o}),c=Rl({typed:e});function h(d){return Math.abs(oA(d).exponent)}return e(iH,{number:function(f){var p=R_(f,h(t.relTol)),m=os(f,p,t.relTol,t.absTol)?p:f;return R_(m)},"number, number":function(f,p){var m=h(t.relTol);if(p>=m)return R_(f,p);var y=R_(f,m),v=os(f,y,t.relTol,t.absTol)?y:f;return R_(v,p)},"number, BigNumber":function(f,p){if(!p.isInteger())throw new TypeError(E0);return new a(f).toDecimalPlaces(p.toNumber())},Complex:function(f){return f.round()},"Complex, number":function(f,p){if(p%1)throw new TypeError(E0);return f.round(p)},"Complex, BigNumber":function(f,p){if(!p.isInteger())throw new TypeError(E0);var m=p.toNumber();return f.round(m)},BigNumber:function(f){var p=new a(f).toDecimalPlaces(h(t.relTol)),m=Dl(f,p,t.relTol,t.absTol)?p:f;return m.toDecimalPlaces(0)},"BigNumber, BigNumber":function(f,p){if(!p.isInteger())throw new TypeError(E0);var m=h(t.relTol);if(p>=m)return f.toDecimalPlaces(p.toNumber());var y=f.toDecimalPlaces(m),v=Dl(f,y,t.relTol,t.absTol)?y:f;return v.toDecimalPlaces(p.toNumber())},bigint:d=>d,"bigint, number":(d,f)=>d,"bigint, BigNumber":(d,f)=>d,Fraction:function(f){return f.round()},"Fraction, number":function(f,p){if(p%1)throw new TypeError(E0);return f.round(p)},"Fraction, BigNumber":function(f,p){if(!p.isInteger())throw new TypeError(E0);return f.round(p.toNumber())},"Unit, number, Unit":e.referToSelf(d=>function(f,p,m){var y=f.toNumeric(m);return m.multiply(d(y,p))}),"Unit, BigNumber, Unit":e.referToSelf(d=>(f,p,m)=>d(f,p.toNumber(),m)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(d=>(f,p,m)=>qt(f,y=>d(y,p,m),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(d=>(f,p)=>d(f,0,p)),"Array | Matrix":e.referToSelf(d=>f=>qt(f,d,!0)),"SparseMatrix, number | BigNumber":e.referToSelf(d=>(f,p)=>l(f,p,d,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(d=>(f,p)=>c(f,p,d,!1)),"Array, number | BigNumber":e.referToSelf(d=>(f,p)=>c(r(f),p,d,!1).valueOf()),"number | Complex | BigNumber | Fraction, SparseMatrix":e.referToSelf(d=>(f,p)=>i(f,0)?s(p.size(),p.storage()):u(p,f,d,!0)),"number | Complex | BigNumber | Fraction, DenseMatrix":e.referToSelf(d=>(f,p)=>i(f,0)?s(p.size(),p.storage()):c(p,f,d,!0)),"number | Complex | BigNumber | Fraction, Array":e.referToSelf(d=>(f,p)=>c(r(p),f,d,!0).valueOf())})}),sH="log",IPe=["config","typed","typeOf","divideScalar","Complex"],PPe=Math.log(16),FPe=re(sH,IPe,n=>{var{typed:e,typeOf:t,config:r,divideScalar:i,Complex:s}=n;function a(l){return l.log()}function o(l){return a(new s(l,0))}return e(sH,{number:function(u){return u>=0||r.predictable?v$(u):o(u)},bigint:nU(PPe,v$,r,o),Complex:a,BigNumber:function(u){return!u.isNegative()||r.predictable?u.ln():o(u.toNumber())},"any, any":e.referToSelf(l=>(u,c)=>{if(t(u)==="Fraction"&&t(c)==="Fraction"){var h=u.log(c);if(h!==null)return h}return i(l(u),l(c))})})}),aH="log1p",LPe=["typed","config","divideScalar","log","Complex"],OPe=re(aH,LPe,n=>{var{typed:e,config:t,divideScalar:r,log:i,Complex:s}=n;return e(aH,{number:function(l){return l>=-1||t.predictable?AMe(l):a(new s(l,0))},Complex:a,BigNumber:function(l){var u=l.plus(1);return!u.isNegative()||t.predictable?u.ln():a(new s(l.toNumber(),0))},"Array | Matrix":e.referToSelf(o=>l=>qt(l,o)),"any, any":e.referToSelf(o=>(l,u)=>r(o(l),i(u)))});function a(o){var l=o.re+1;return new s(Math.log(Math.sqrt(l*l+o.im*o.im)),Math.atan2(o.im,l))}}),oH="nthRoots",kPe=["config","typed","divideScalar","Complex"],BPe=re(oH,kPe,n=>{var{typed:e,config:t,divideScalar:r,Complex:i}=n,s=[function(l){return new i(l,0)},function(l){return new i(0,l)},function(l){return new i(-l,0)},function(l){return new i(0,-l)}];function a(o,l){if(l<0)throw new Error("Root must be greater than zero");if(l===0)throw new Error("Root must be non-zero");if(l%1!==0)throw new Error("Root must be an integer");if(o===0||o.abs()===0)return[new i(0,0)];var u=typeof o=="number",c;(u||o.re===0||o.im===0)&&(u?c=2*+(o<0):o.im===0?c=2*+(o.re<0):c=2*+(o.im<0)+1);for(var h=o.arg(),d=o.abs(),f=[],p=Math.pow(d,1/l),m=0;m<l;m++){var y=(c+4*m)/l;if(y===Math.round(y)){f.push(s[y%4](p));continue}f.push(new i({r:p,phi:(h+2*Math.PI*m)/l}))}return f}return e(oH,{Complex:function(l){return a(l,2)},"Complex, number":a})}),lH="dotPow",UPe=["typed","equalScalar","matrix","pow","DenseMatrix","concat","SparseMatrix"],VPe=re(lH,UPe,n=>{var{typed:e,equalScalar:t,matrix:r,pow:i,DenseMatrix:s,concat:a,SparseMatrix:o}=n,l=sa({typed:e}),u=Pc({typed:e,SparseMatrix:o}),c=Is({typed:e,equalScalar:t}),h=Ui({typed:e,DenseMatrix:s}),d=or({typed:e,matrix:r,concat:a}),f={};for(var p in i.signatures)Object.prototype.hasOwnProperty.call(i.signatures,p)&&!p.includes("Matrix")&&!p.includes("Array")&&(f[p]=i.signatures[p]);var m=e(f);return e(lH,d({elop:m,SS:u,DS:l,Ss:c,sS:h}))}),uH="dotDivide",zPe=["typed","matrix","equalScalar","divideScalar","DenseMatrix","concat","SparseMatrix"],$Pe=re(uH,zPe,n=>{var{typed:e,matrix:t,equalScalar:r,divideScalar:i,DenseMatrix:s,concat:a,SparseMatrix:o}=n,l=xu({typed:e,equalScalar:r}),u=sa({typed:e}),c=Pc({typed:e,SparseMatrix:o}),h=Is({typed:e,equalScalar:r}),d=Ui({typed:e,DenseMatrix:s}),f=or({typed:e,matrix:t,concat:a});return e(uH,f({elop:i,SS:c,DS:u,SD:l,Ss:h,sS:d}))});function lA(n){var{DenseMatrix:e}=n;return function(r,i,s){var a=r.size();if(a.length!==2)throw new RangeError("Matrix must be two dimensional (size: "+nn(a)+")");var o=a[0],l=a[1];if(o!==l)throw new RangeError("Matrix must be square (size: "+nn(a)+")");var u=[];if(Dt(i)){var c=i.size(),h=i._data;if(c.length===1){if(c[0]!==o)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var d=0;d<o;d++)u[d]=[h[d]];return new e({data:u,size:[o,1],datatype:i._datatype})}if(c.length===2){if(c[0]!==o||c[1]!==1)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(PD(i)){if(s){u=[];for(var f=0;f<o;f++)u[f]=[h[f][0]];return new e({data:u,size:[o,1],datatype:i._datatype})}return i}if(Hm(i)){for(var p=0;p<o;p++)u[p]=[0];for(var m=i._values,y=i._index,v=i._ptr,b=v[1],x=v[0];x<b;x++){var w=y[x];u[w][0]=m[x]}return new e({data:u,size:[o,1],datatype:i._datatype})}}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}if(Xn(i)){var _=Vt(i);if(_.length===1){if(_[0]!==o)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var E=0;E<o;E++)u[E]=[i[E]];return new e({data:u,size:[o,1]})}if(_.length===2){if(_[0]!==o||_[1]!==1)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var A=0;A<o;A++)u[A]=[i[A][0]];return new e({data:u,size:[o,1]})}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}}}var cH="lsolve",HPe=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],GPe=re(cH,HPe,n=>{var{typed:e,matrix:t,divideScalar:r,multiplyScalar:i,subtractScalar:s,equalScalar:a,DenseMatrix:o}=n,l=lA({DenseMatrix:o});return e(cH,{"SparseMatrix, Array | Matrix":function(d,f){return c(d,f)},"DenseMatrix, Array | Matrix":function(d,f){return u(d,f)},"Array, Array | Matrix":function(d,f){var p=t(d),m=u(p,f);return m.valueOf()}});function u(h,d){d=l(h,d,!0);for(var f=d._data,p=h._size[0],m=h._size[1],y=[],v=h._data,b=0;b<m;b++){var x=f[b][0]||0,w=void 0;if(a(x,0))w=0;else{var _=v[b][b];if(a(_,0))throw new Error("Linear system cannot be solved since matrix is singular");w=r(x,_);for(var E=b+1;E<p;E++)f[E]=[s(f[E][0]||0,i(w,v[E][b]))]}y[b]=[w]}return new o({data:y,size:[p,1]})}function c(h,d){d=l(h,d,!0);for(var f=d._data,p=h._size[0],m=h._size[1],y=h._values,v=h._index,b=h._ptr,x=[],w=0;w<m;w++){var _=f[w][0]||0;if(a(_,0))x[w]=[0];else{for(var E=0,A=[],T=[],S=b[w],M=b[w+1],D=S;D<M;D++){var N=v[D];N===w?E=y[D]:N>w&&(A.push(y[D]),T.push(N))}if(a(E,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var R=r(_,E),O=0,G=T.length;O<G;O++){var I=T[O];f[I]=[s(f[I][0]||0,i(R,A[O]))]}x[w]=[R]}}return new o({data:x,size:[p,1]})}}),hH="usolve",jPe=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],qPe=re(hH,jPe,n=>{var{typed:e,matrix:t,divideScalar:r,multiplyScalar:i,subtractScalar:s,equalScalar:a,DenseMatrix:o}=n,l=lA({DenseMatrix:o});return e(hH,{"SparseMatrix, Array | Matrix":function(d,f){return c(d,f)},"DenseMatrix, Array | Matrix":function(d,f){return u(d,f)},"Array, Array | Matrix":function(d,f){var p=t(d),m=u(p,f);return m.valueOf()}});function u(h,d){d=l(h,d,!0);for(var f=d._data,p=h._size[0],m=h._size[1],y=[],v=h._data,b=m-1;b>=0;b--){var x=f[b][0]||0,w=void 0;if(a(x,0))w=0;else{var _=v[b][b];if(a(_,0))throw new Error("Linear system cannot be solved since matrix is singular");w=r(x,_);for(var E=b-1;E>=0;E--)f[E]=[s(f[E][0]||0,i(w,v[E][b]))]}y[b]=[w]}return new o({data:y,size:[p,1]})}function c(h,d){d=l(h,d,!0);for(var f=d._data,p=h._size[0],m=h._size[1],y=h._values,v=h._index,b=h._ptr,x=[],w=m-1;w>=0;w--){var _=f[w][0]||0;if(a(_,0))x[w]=[0];else{for(var E=0,A=[],T=[],S=b[w],M=b[w+1],D=M-1;D>=S;D--){var N=v[D];N===w?E=y[D]:N<w&&(A.push(y[D]),T.push(N))}if(a(E,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var R=r(_,E),O=0,G=T.length;O<G;O++){var I=T[O];f[I]=[s(f[I][0],i(R,A[O]))]}x[w]=[R]}}return new o({data:x,size:[p,1]})}}),dH="lsolveAll",WPe=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],XPe=re(dH,WPe,n=>{var{typed:e,matrix:t,divideScalar:r,multiplyScalar:i,subtractScalar:s,equalScalar:a,DenseMatrix:o}=n,l=lA({DenseMatrix:o});return e(dH,{"SparseMatrix, Array | Matrix":function(d,f){return c(d,f)},"DenseMatrix, Array | Matrix":function(d,f){return u(d,f)},"Array, Array | Matrix":function(d,f){var p=t(d),m=u(p,f);return m.map(y=>y.valueOf())}});function u(h,d){for(var f=[l(h,d,!0)._data.map(T=>T[0])],p=h._data,m=h._size[0],y=h._size[1],v=0;v<y;v++)for(var b=f.length,x=0;x<b;x++){var w=f[x];if(a(p[v][v],0))if(a(w[v],0)){if(x===0){var E=[...w];E[v]=1;for(var A=v+1;A<y;A++)E[A]=s(E[A],p[A][v]);f.push(E)}}else{if(x===0)return[];f.splice(x,1),x-=1,b-=1}else{w[v]=r(w[v],p[v][v]);for(var _=v+1;_<y;_++)w[_]=s(w[_],i(w[v],p[_][v]))}}return f.map(T=>new o({data:T.map(S=>[S]),size:[m,1]}))}function c(h,d){for(var f=[l(h,d,!0)._data.map(ee=>ee[0])],p=h._size[0],m=h._size[1],y=h._values,v=h._index,b=h._ptr,x=0;x<m;x++)for(var w=f.length,_=0;_<w;_++){for(var E=f[_],A=[],T=[],S=b[x],M=b[x+1],D=0,N=S;N<M;N++){var R=v[N];R===x?D=y[N]:R>x&&(A.push(y[N]),T.push(R))}if(a(D,0))if(a(E[x],0)){if(_===0){var B=[...E];B[x]=1;for(var $=0,H=T.length;$<H;$++){var Q=T[$];B[Q]=s(B[Q],A[$])}f.push(B)}}else{if(_===0)return[];f.splice(_,1),_-=1,w-=1}else{E[x]=r(E[x],D);for(var O=0,G=T.length;O<G;O++){var I=T[O];E[I]=s(E[I],i(E[x],A[O]))}}}return f.map(ee=>new o({data:ee.map(J=>[J]),size:[p,1]}))}}),fH="usolveAll",KPe=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],YPe=re(fH,KPe,n=>{var{typed:e,matrix:t,divideScalar:r,multiplyScalar:i,subtractScalar:s,equalScalar:a,DenseMatrix:o}=n,l=lA({DenseMatrix:o});return e(fH,{"SparseMatrix, Array | Matrix":function(d,f){return c(d,f)},"DenseMatrix, Array | Matrix":function(d,f){return u(d,f)},"Array, Array | Matrix":function(d,f){var p=t(d),m=u(p,f);return m.map(y=>y.valueOf())}});function u(h,d){for(var f=[l(h,d,!0)._data.map(T=>T[0])],p=h._data,m=h._size[0],y=h._size[1],v=y-1;v>=0;v--)for(var b=f.length,x=0;x<b;x++){var w=f[x];if(a(p[v][v],0))if(a(w[v],0)){if(x===0){var E=[...w];E[v]=1;for(var A=v-1;A>=0;A--)E[A]=s(E[A],p[A][v]);f.push(E)}}else{if(x===0)return[];f.splice(x,1),x-=1,b-=1}else{w[v]=r(w[v],p[v][v]);for(var _=v-1;_>=0;_--)w[_]=s(w[_],i(w[v],p[_][v]))}}return f.map(T=>new o({data:T.map(S=>[S]),size:[m,1]}))}function c(h,d){for(var f=[l(h,d,!0)._data.map(ee=>ee[0])],p=h._size[0],m=h._size[1],y=h._values,v=h._index,b=h._ptr,x=m-1;x>=0;x--)for(var w=f.length,_=0;_<w;_++){for(var E=f[_],A=[],T=[],S=b[x],M=b[x+1],D=0,N=M-1;N>=S;N--){var R=v[N];R===x?D=y[N]:R<x&&(A.push(y[N]),T.push(R))}if(a(D,0))if(a(E[x],0)){if(_===0){var B=[...E];B[x]=1;for(var $=0,H=T.length;$<H;$++){var Q=T[$];B[Q]=s(B[Q],A[$])}f.push(B)}}else{if(_===0)return[];f.splice(_,1),_-=1,w-=1}else{E[x]=r(E[x],D);for(var O=0,G=T.length;O<G;O++){var I=T[O];E[I]=s(E[I],i(E[x],A[O]))}}}return f.map(ee=>new o({data:ee.map(J=>[J]),size:[p,1]}))}}),QPe="matAlgo08xS0Sid",ZPe=["typed","equalScalar"],sU=re(QPe,ZPe,n=>{var{typed:e,equalScalar:t}=n;return function(i,s,a){var o=i._values,l=i._index,u=i._ptr,c=i._size,h=i._datatype||i._data===void 0?i._datatype:i.getDataType(),d=s._values,f=s._index,p=s._ptr,m=s._size,y=s._datatype||s._data===void 0?s._datatype:s.getDataType();if(c.length!==m.length)throw new en(c.length,m.length);if(c[0]!==m[0]||c[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+m+")");if(!o||!d)throw new Error("Cannot perform operation on Pattern Sparse Matrices");var v=c[0],b=c[1],x,w=t,_=0,E=a;typeof h=="string"&&h===y&&h!=="mixed"&&(x=h,w=e.find(t,[x,x]),_=e.convert(0,x),E=e.find(a,[x,x]));for(var A=[],T=[],S=[],M=[],D=[],N,R,O,G,I=0;I<b;I++){S[I]=T.length;var B=I+1;for(R=u[I],O=u[I+1],N=R;N<O;N++)G=l[N],D[G]=B,M[G]=o[N],T.push(G);for(R=p[I],O=p[I+1],N=R;N<O;N++)G=f[N],D[G]===B&&(M[G]=E(M[G],d[N]));for(N=S[I];N<T.length;){G=T[N];var $=M[G];w($,_)?T.splice(N,1):(A.push($),N++)}}return S[b]=T.length,i.createSparseMatrix({values:A,index:T,ptr:S,size:[v,b],datatype:h===i._datatype&&y===s._datatype?x:void 0})}}),aU=re("useMatrixForArrayScalar",["typed","matrix"],n=>{var{typed:e,matrix:t}=n;return{"Array, number":e.referTo("DenseMatrix, number",r=>(i,s)=>r(t(i),s).valueOf()),"Array, BigNumber":e.referTo("DenseMatrix, BigNumber",r=>(i,s)=>r(t(i),s).valueOf()),"number, Array":e.referTo("number, DenseMatrix",r=>(i,s)=>r(i,t(s)).valueOf()),"BigNumber, Array":e.referTo("BigNumber, DenseMatrix",r=>(i,s)=>r(i,t(s)).valueOf())}}),pH="leftShift",JPe=["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],e3e=re(pH,JPe,n=>{var{typed:e,matrix:t,equalScalar:r,zeros:i,DenseMatrix:s,concat:a}=n,o=Kp({typed:e}),l=xu({typed:e,equalScalar:r}),u=sU({typed:e,equalScalar:r}),c=zv({typed:e,DenseMatrix:s}),h=Is({typed:e,equalScalar:r}),d=Rl({typed:e}),f=or({typed:e,matrix:t,concat:a}),p=aU({typed:e,matrix:t});return e(pH,{"number, number":sne,"BigNumber, BigNumber":xRe,"bigint, bigint":(m,y)=>m<<y,"SparseMatrix, number | BigNumber":e.referToSelf(m=>(y,v)=>r(v,0)?y.clone():h(y,v,m,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(m=>(y,v)=>r(v,0)?y.clone():d(y,v,m,!1)),"number | BigNumber, SparseMatrix":e.referToSelf(m=>(y,v)=>r(y,0)?i(v.size(),v.storage()):c(v,y,m,!0)),"number | BigNumber, DenseMatrix":e.referToSelf(m=>(y,v)=>r(y,0)?i(v.size(),v.storage()):d(v,y,m,!0))},p,f({SS:u,DS:o,SD:l}))}),mH="rightArithShift",t3e=["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],n3e=re(mH,t3e,n=>{var{typed:e,matrix:t,equalScalar:r,zeros:i,DenseMatrix:s,concat:a}=n,o=Kp({typed:e}),l=xu({typed:e,equalScalar:r}),u=sU({typed:e,equalScalar:r}),c=zv({typed:e,DenseMatrix:s}),h=Is({typed:e,equalScalar:r}),d=Rl({typed:e}),f=or({typed:e,matrix:t,concat:a}),p=aU({typed:e,matrix:t});return e(mH,{"number, number":ane,"BigNumber, BigNumber":bRe,"bigint, bigint":(m,y)=>m>>y,"SparseMatrix, number | BigNumber":e.referToSelf(m=>(y,v)=>r(v,0)?y.clone():h(y,v,m,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(m=>(y,v)=>r(v,0)?y.clone():d(y,v,m,!1)),"number | BigNumber, SparseMatrix":e.referToSelf(m=>(y,v)=>r(y,0)?i(v.size(),v.storage()):c(v,y,m,!0)),"number | BigNumber, DenseMatrix":e.referToSelf(m=>(y,v)=>r(y,0)?i(v.size(),v.storage()):d(v,y,m,!0))},p,f({SS:u,DS:o,SD:l}))}),gH="rightLogShift",r3e=["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],i3e=re(gH,r3e,n=>{var{typed:e,matrix:t,equalScalar:r,zeros:i,DenseMatrix:s,concat:a}=n,o=Kp({typed:e}),l=xu({typed:e,equalScalar:r}),u=sU({typed:e,equalScalar:r}),c=zv({typed:e,DenseMatrix:s}),h=Is({typed:e,equalScalar:r}),d=Rl({typed:e}),f=or({typed:e,matrix:t,concat:a}),p=aU({typed:e,matrix:t});return e(gH,{"number, number":one,"SparseMatrix, number | BigNumber":e.referToSelf(m=>(y,v)=>r(v,0)?y.clone():h(y,v,m,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(m=>(y,v)=>r(v,0)?y.clone():d(y,v,m,!1)),"number | BigNumber, SparseMatrix":e.referToSelf(m=>(y,v)=>r(y,0)?i(v.size(),v.storage()):c(v,y,m,!0)),"number | BigNumber, DenseMatrix":e.referToSelf(m=>(y,v)=>r(y,0)?i(v.size(),v.storage()):d(v,y,m,!0))},p,f({SS:u,DS:o,SD:l}))}),vH="and",s3e=["typed","matrix","equalScalar","zeros","not","concat"],Qne=re(vH,s3e,n=>{var{typed:e,matrix:t,equalScalar:r,zeros:i,not:s,concat:a}=n,o=xu({typed:e,equalScalar:r}),l=VN({typed:e,equalScalar:r}),u=Is({typed:e,equalScalar:r}),c=Rl({typed:e}),h=or({typed:e,matrix:t,concat:a});return e(vH,{"number, number":NO,"Complex, Complex":function(f,p){return(f.re!==0||f.im!==0)&&(p.re!==0||p.im!==0)},"BigNumber, BigNumber":function(f,p){return!f.isZero()&&!p.isZero()&&!f.isNaN()&&!p.isNaN()},"bigint, bigint":NO,"Unit, Unit":e.referToSelf(d=>(f,p)=>d(f.value||0,p.value||0)),"SparseMatrix, any":e.referToSelf(d=>(f,p)=>s(p)?i(f.size(),f.storage()):u(f,p,d,!1)),"DenseMatrix, any":e.referToSelf(d=>(f,p)=>s(p)?i(f.size(),f.storage()):c(f,p,d,!1)),"any, SparseMatrix":e.referToSelf(d=>(f,p)=>s(f)?i(f.size(),f.storage()):u(p,f,d,!0)),"any, DenseMatrix":e.referToSelf(d=>(f,p)=>s(f)?i(f.size(),f.storage()):c(p,f,d,!0)),"Array, any":e.referToSelf(d=>(f,p)=>d(t(f),p).valueOf()),"any, Array":e.referToSelf(d=>(f,p)=>d(f,t(p)).valueOf())},h({SS:l,DS:o}))}),KD="compare",a3e=["typed","config","matrix","equalScalar","BigNumber","Fraction","DenseMatrix","concat"],o3e=re(KD,a3e,n=>{var{typed:e,config:t,equalScalar:r,matrix:i,BigNumber:s,Fraction:a,DenseMatrix:o,concat:l}=n,u=sa({typed:e}),c=UN({typed:e,equalScalar:r}),h=Ui({typed:e,DenseMatrix:o}),d=or({typed:e,matrix:i,concat:l}),f=Yb({typed:e});return e(KD,l3e({typed:e,config:t}),{"boolean, boolean":function(m,y){return m===y?0:m>y?1:-1},"BigNumber, BigNumber":function(m,y){return Dl(m,y,t.relTol,t.absTol)?new s(0):new s(m.cmp(y))},"bigint, bigint":function(m,y){return m===y?0n:m>y?1n:-1n},"Fraction, Fraction":function(m,y){return new a(m.compare(y))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},f,d({SS:c,DS:u,Ss:h}))}),l3e=re(KD,["typed","config"],n=>{var{typed:e,config:t}=n;return e(KD,{"number, number":function(i,s){return os(i,s,t.relTol,t.absTol)?0:i>s?1:-1}})}),u3e=function n(e,t){var r=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,i=/(^[ ]*|[ ]*$)/g,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,a=/^0x[0-9a-f]+$/i,o=/^0/,l=function(x){return n.insensitive&&(""+x).toLowerCase()||""+x},u=l(e).replace(i,"")||"",c=l(t).replace(i,"")||"",h=u.replace(r,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),d=c.replace(r,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),f=parseInt(u.match(a),16)||h.length!==1&&u.match(s)&&Date.parse(u),p=parseInt(c.match(a),16)||f&&c.match(s)&&Date.parse(c)||null,m,y;if(p){if(f<p)return-1;if(f>p)return 1}for(var v=0,b=Math.max(h.length,d.length);v<b;v++){if(m=!(h[v]||"").match(o)&&parseFloat(h[v])||h[v]||0,y=!(d[v]||"").match(o)&&parseFloat(d[v])||d[v]||0,isNaN(m)!==isNaN(y))return isNaN(m)?1:-1;if(typeof m!=typeof y&&(m+="",y+=""),m<y)return-1;if(m>y)return 1}return 0};const S0=S2(u3e);var yH="compareNatural",c3e=["typed","compare"],h3e=re(yH,c3e,n=>{var{typed:e,compare:t}=n,r=t.signatures["boolean,boolean"];return e(yH,{"any, any":i});function i(l,u){var c=Yn(l),h=Yn(u),d;if((c==="number"||c==="BigNumber"||c==="Fraction")&&(h==="number"||h==="BigNumber"||h==="Fraction"))return d=t(l,u),d.toString()!=="0"?d>0?1:-1:S0(c,h);var f=["Array","DenseMatrix","SparseMatrix"];if(f.includes(c)||f.includes(h))return d=s(i,l,u),d!==0?d:S0(c,h);if(c!==h)return S0(c,h);if(c==="Complex")return d3e(l,u);if(c==="Unit")return l.equalBase(u)?i(l.value,u.value):a(i,l.formatUnits(),u.formatUnits());if(c==="boolean")return r(l,u);if(c==="string")return S0(l,u);if(c==="Object")return o(i,l,u);if(c==="null"||c==="undefined")return 0;throw new TypeError('Unsupported type of value "'+c+'"')}function s(l,u,c){return Hm(u)&&Hm(c)?a(l,u.toJSON().values,c.toJSON().values):Hm(u)?s(l,u.toArray(),c):Hm(c)?s(l,u,c.toArray()):PD(u)?s(l,u.toJSON().data,c):PD(c)?s(l,u,c.toJSON().data):Array.isArray(u)?Array.isArray(c)?a(l,u,c):s(l,u,[c]):s(l,[u],c)}function a(l,u,c){for(var h=0,d=Math.min(u.length,c.length);h<d;h++){var f=l(u[h],c[h]);if(f!==0)return f}return u.length>c.length?1:u.length<c.length?-1:0}function o(l,u,c){var h=Object.keys(u),d=Object.keys(c);h.sort(S0),d.sort(S0);var f=a(l,h,d);if(f!==0)return f;for(var p=0;p<h.length;p++){var m=l(u[h[p]],c[d[p]]);if(m!==0)return m}return 0}});function d3e(n,e){return n.re>e.re?1:n.re<e.re?-1:n.im>e.im?1:n.im<e.im?-1:0}var xH="compareText",f3e=["typed","matrix","concat"];EO.signature="any, any";var p3e=re(xH,f3e,n=>{var{typed:e,matrix:t,concat:r}=n,i=or({typed:e,matrix:t,concat:r});return e(xH,EO,i({elop:EO,Ds:!0}))}),YD="equal",m3e=["typed","matrix","equalScalar","DenseMatrix","SparseMatrix"],g3e=re(YD,m3e,n=>{var{typed:e,matrix:t,equalScalar:r,DenseMatrix:i,concat:s,SparseMatrix:a}=n,o=sa({typed:e}),l=Pc({typed:e,SparseMatrix:a}),u=Ui({typed:e,DenseMatrix:i}),c=or({typed:e,matrix:t});return e(YD,v3e({typed:e,equalScalar:r}),c({elop:r,SS:l,DS:o,Ss:u}))}),v3e=re(YD,["typed","equalScalar"],n=>{var{typed:e,equalScalar:t}=n;return e(YD,{"any, any":function(i,s){return i===null?s===null:s===null?i===null:i===void 0?s===void 0:s===void 0?i===void 0:t(i,s)}})}),bH="equalText",y3e=["typed","compareText","isZero"],x3e=re(bH,y3e,n=>{var{typed:e,compareText:t,isZero:r}=n;return e(bH,{"any, any":function(s,a){return r(t(s,a))}})}),QD="smaller",b3e=["typed","config","bignumber","matrix","DenseMatrix","concat","SparseMatrix"],_3e=re(QD,b3e,n=>{var{typed:e,config:t,bignumber:r,matrix:i,DenseMatrix:s,concat:a,SparseMatrix:o}=n,l=sa({typed:e}),u=Pc({typed:e,SparseMatrix:o}),c=Ui({typed:e,DenseMatrix:s}),h=or({typed:e,matrix:i,concat:a}),d=Yb({typed:e});function f(p,m){return p.lt(m)&&!Dl(p,m,t.relTol,t.absTol)}return e(QD,w3e({typed:e,config:t}),{"boolean, boolean":(p,m)=>p<m,"BigNumber, BigNumber":f,"bigint, bigint":(p,m)=>p<m,"Fraction, Fraction":(p,m)=>p.compare(m)===-1,"Fraction, BigNumber":function(m,y){return f(r(m),y)},"BigNumber, Fraction":function(m,y){return f(m,r(y))},"Complex, Complex":function(m,y){throw new TypeError("No ordering relation is defined for complex numbers")}},d,h({SS:u,DS:l,Ss:c}))}),w3e=re(QD,["typed","config"],n=>{var{typed:e,config:t}=n;return e(QD,{"number, number":function(i,s){return i<s&&!os(i,s,t.relTol,t.absTol)}})}),ZD="smallerEq",E3e=["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],S3e=re(ZD,E3e,n=>{var{typed:e,config:t,matrix:r,DenseMatrix:i,concat:s,SparseMatrix:a}=n,o=sa({typed:e}),l=Pc({typed:e,SparseMatrix:a}),u=Ui({typed:e,DenseMatrix:i}),c=or({typed:e,matrix:r,concat:s}),h=Yb({typed:e});return e(ZD,A3e({typed:e,config:t}),{"boolean, boolean":(d,f)=>d<=f,"BigNumber, BigNumber":function(f,p){return f.lte(p)||Dl(f,p,t.relTol,t.absTol)},"bigint, bigint":(d,f)=>d<=f,"Fraction, Fraction":(d,f)=>d.compare(f)!==1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},h,c({SS:l,DS:o,Ss:u}))}),A3e=re(ZD,["typed","config"],n=>{var{typed:e,config:t}=n;return e(ZD,{"number, number":function(i,s){return i<=s||os(i,s,t.relTol,t.absTol)}})}),JD="larger",T3e=["typed","config","bignumber","matrix","DenseMatrix","concat","SparseMatrix"],M3e=re(JD,T3e,n=>{var{typed:e,config:t,bignumber:r,matrix:i,DenseMatrix:s,concat:a,SparseMatrix:o}=n,l=sa({typed:e}),u=Pc({typed:e,SparseMatrix:o}),c=Ui({typed:e,DenseMatrix:s}),h=or({typed:e,matrix:i,concat:a}),d=Yb({typed:e});function f(p,m){return p.gt(m)&&!Dl(p,m,t.relTol,t.absTol)}return e(JD,C3e({typed:e,config:t}),{"boolean, boolean":(p,m)=>p>m,"BigNumber, BigNumber":f,"bigint, bigint":(p,m)=>p>m,"Fraction, Fraction":(p,m)=>p.compare(m)===1,"Fraction, BigNumber":function(m,y){return f(r(m),y)},"BigNumber, Fraction":function(m,y){return f(m,r(y))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},d,h({SS:u,DS:l,Ss:c}))}),C3e=re(JD,["typed","config"],n=>{var{typed:e,config:t}=n;return e(JD,{"number, number":function(i,s){return i>s&&!os(i,s,t.relTol,t.absTol)}})}),e2="largerEq",D3e=["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],N3e=re(e2,D3e,n=>{var{typed:e,config:t,matrix:r,DenseMatrix:i,concat:s,SparseMatrix:a}=n,o=sa({typed:e}),l=Pc({typed:e,SparseMatrix:a}),u=Ui({typed:e,DenseMatrix:i}),c=or({typed:e,matrix:r,concat:s}),h=Yb({typed:e});return e(e2,R3e({typed:e,config:t}),{"boolean, boolean":(d,f)=>d>=f,"BigNumber, BigNumber":function(f,p){return f.gte(p)||Dl(f,p,t.relTol,t.absTol)},"bigint, bigint":function(f,p){return f>=p},"Fraction, Fraction":(d,f)=>d.compare(f)!==-1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},h,c({SS:l,DS:o,Ss:u}))}),R3e=re(e2,["typed","config"],n=>{var{typed:e,config:t}=n;return e(e2,{"number, number":function(i,s){return i>=s||os(i,s,t.relTol,t.absTol)}})}),_H="deepEqual",I3e=["typed","equal"],P3e=re(_H,I3e,n=>{var{typed:e,equal:t}=n;return e(_H,{"any, any":function(s,a){return r(s.valueOf(),a.valueOf())}});function r(i,s){if(Array.isArray(i))if(Array.isArray(s)){var a=i.length;if(a!==s.length)return!1;for(var o=0;o<a;o++)if(!r(i[o],s[o]))return!1;return!0}else return!1;else return Array.isArray(s)?!1:t(i,s)}}),t2="unequal",F3e=["typed","config","equalScalar","matrix","DenseMatrix","concat","SparseMatrix"],L3e=re(t2,F3e,n=>{var{typed:e,config:t,equalScalar:r,matrix:i,DenseMatrix:s,concat:a,SparseMatrix:o}=n,l=sa({typed:e}),u=Pc({typed:e,SparseMatrix:o}),c=Ui({typed:e,DenseMatrix:s}),h=or({typed:e,matrix:i,concat:a});return e(t2,O3e({typed:e,equalScalar:r}),h({elop:d,SS:u,DS:l,Ss:c}));function d(f,p){return!r(f,p)}}),O3e=re(t2,["typed","equalScalar"],n=>{var{typed:e,equalScalar:t}=n;return e(t2,{"any, any":function(i,s){return i===null?s!==null:s===null?i!==null:i===void 0?s!==void 0:s===void 0?i!==void 0:!t(i,s)}})}),wH="partitionSelect",k3e=["typed","isNumeric","isNaN","compare"],B3e=re(wH,k3e,n=>{var{typed:e,isNumeric:t,isNaN:r,compare:i}=n,s=i,a=(u,c)=>-i(u,c);return e(wH,{"Array | Matrix, number":function(c,h){return o(c,h,s)},"Array | Matrix, number, string":function(c,h,d){if(d==="asc")return o(c,h,s);if(d==="desc")return o(c,h,a);throw new Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":o});function o(u,c,h){if(!bt(c)||c<0)throw new Error("k must be a non-negative integer");if(Dt(u)){var d=u.size();if(d.length>1)throw new Error("Only one dimensional matrices supported");return l(u.valueOf(),c,h)}if(Array.isArray(u))return l(u,c,h)}function l(u,c,h){if(c>=u.length)throw new Error("k out of bounds");for(var d=0;d<u.length;d++)if(t(u[d])&&r(u[d]))return u[d];for(var f=0,p=u.length-1;f<p;){for(var m=f,y=p,v=u[Math.floor(Math.random()*(p-f+1))+f];m<y;)if(h(u[m],v)>=0){var b=u[y];u[y]=u[m],u[m]=b,--y}else++m;h(u[m],v)>0&&--m,c<=m?p=m:f=m+1}return u[c]}}),EH="sort",U3e=["typed","matrix","compare","compareNatural"],V3e=re(EH,U3e,n=>{var{typed:e,matrix:t,compare:r,compareNatural:i}=n,s=r,a=(c,h)=>-r(c,h);return e(EH,{Array:function(h){return l(h),h.sort(s)},Matrix:function(h){return u(h),t(h.toArray().sort(s),h.storage())},"Array, function":function(h,d){return l(h),h.sort(d)},"Matrix, function":function(h,d){return u(h),t(h.toArray().sort(d),h.storage())},"Array, string":function(h,d){return l(h),h.sort(o(d))},"Matrix, string":function(h,d){return u(h),t(h.toArray().sort(o(d)),h.storage())}});function o(c){if(c==="asc")return s;if(c==="desc")return a;if(c==="natural")return i;throw new Error('String "asc", "desc", or "natural" expected')}function l(c){if(Vt(c).length!==1)throw new Error("One dimensional array expected")}function u(c){if(c.size().length!==1)throw new Error("One dimensional matrix expected")}}),SH="max",z3e=["typed","config","numeric","larger","isNaN"],Zne=re(SH,z3e,n=>{var{typed:e,config:t,numeric:r,larger:i,isNaN:s}=n;return e(SH,{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(u,c){return BN(u,c.valueOf(),a)},"...":function(u){if(Wb(u))throw new TypeError("Scalar values expected in function max");return o(u)}});function a(l,u){try{return i(l,u)?l:u}catch(c){throw Ca(c,"max",u)}}function o(l){var u;if(Op(l,function(c){try{(s(c)||u===void 0||i(c,u))&&(u=c)}catch(h){throw Ca(h,"max",c)}}),u===void 0)throw new Error("Cannot calculate max of an empty array");return typeof u=="string"&&(u=r(u,Wp(u,t))),u}}),AH="min",$3e=["typed","config","numeric","smaller","isNaN"],Jne=re(AH,$3e,n=>{var{typed:e,config:t,numeric:r,smaller:i,isNaN:s}=n;return e(AH,{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(u,c){return BN(u,c.valueOf(),a)},"...":function(u){if(Wb(u))throw new TypeError("Scalar values expected in function min");return o(u)}});function a(l,u){try{return i(l,u)?l:u}catch(c){throw Ca(c,"min",u)}}function o(l){var u;if(Op(l,function(c){try{(s(c)||u===void 0||i(c,u))&&(u=c)}catch(h){throw Ca(h,"min",c)}}),u===void 0)throw new Error("Cannot calculate min of an empty array");return typeof u=="string"&&(u=r(u,Wp(u,t))),u}}),H3e="ImmutableDenseMatrix",G3e=["smaller","DenseMatrix"],j3e=re(H3e,G3e,n=>{var{smaller:e,DenseMatrix:t}=n;function r(i,s){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(s&&!Jr(s))throw new Error("Invalid datatype: "+s);if(Dt(i)||Xn(i)){var a=new t(i,s);this._data=a._data,this._size=a._size,this._datatype=a._datatype,this._min=null,this._max=null}else if(i&&Xn(i.data)&&Xn(i.size))this._data=i.data,this._size=i.size,this._datatype=i.datatype,this._min=typeof i.min<"u"?i.min:null,this._max=typeof i.max<"u"?i.max:null;else{if(i)throw new TypeError("Unsupported type of data ("+Yn(i)+")");this._data=[],this._size=[0],this._datatype=s,this._min=null,this._max=null}}return r.prototype=new t,r.prototype.type="ImmutableDenseMatrix",r.prototype.isImmutableDenseMatrix=!0,r.prototype.subset=function(i){switch(arguments.length){case 1:{var s=t.prototype.subset.call(this,i);return Dt(s)?new r({data:s._data,size:s._size,datatype:s._datatype}):s}case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},r.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},r.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},r.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},r.prototype.clone=function(){return new r({data:Ut(this._data),size:Ut(this._size),datatype:this._datatype})},r.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.fromJSON=function(i){return new r(i)},r.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},r.prototype.min=function(){if(this._min===null){var i=null;this.forEach(function(s){(i===null||e(s,i))&&(i=s)}),this._min=i!==null?i:void 0}return this._min},r.prototype.max=function(){if(this._max===null){var i=null;this.forEach(function(s){(i===null||e(i,s))&&(i=s)}),this._max=i!==null?i:void 0}return this._max},r},{isClass:!0}),q3e="Index",W3e=["ImmutableDenseMatrix","getMatrixDataType"],X3e=re(q3e,W3e,n=>{var{ImmutableDenseMatrix:e,getMatrixDataType:t}=n;function r(){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._sourceSize=[],this._isScalar=!0;for(var s=0,a=arguments.length;s<a;s++){var o=s<0||arguments.length<=s?void 0:arguments[s],l=Xn(o),u=Dt(o),c=typeof o,h=null;if(X4(o))this._dimensions.push(o),this._isScalar=!1;else if(l||u){var d=void 0;this._isScalar=!1,t(o)==="boolean"?(l&&(d=i(TH(o).valueOf())),u&&(d=i(TH(o._data).valueOf())),h=o.valueOf().length):d=i(o.valueOf()),this._dimensions.push(d)}else if(c==="number")this._dimensions.push(o);else if(c==="bigint")this._dimensions.push(Number(o));else if(c==="string")this._dimensions.push(o);else throw new TypeError("Dimension must be an Array, Matrix, number, bigint, string, or Range");this._sourceSize.push(h)}}r.prototype.type="Index",r.prototype.isIndex=!0;function i(s){for(var a=0,o=s.length;a<o;a++)if(!Tt(s[a])||!bt(s[a]))throw new TypeError("Index parameters must be positive integer numbers");var l=new e;return l._data=s,l._size=[s.length],l}return r.prototype.clone=function(){var s=new r;return s._dimensions=Ut(this._dimensions),s._isScalar=this._isScalar,s._sourceSize=this._sourceSize,s},r.create=function(s){var a=new r;return r.apply(a,s),a},r.prototype.size=function(){for(var s=[],a=0,o=this._dimensions.length;a<o;a++){var l=this._dimensions[a];s[a]=Jr(l)||Tt(l)?1:l.size()[0]}return s},r.prototype.max=function(){for(var s=[],a=0,o=this._dimensions.length;a<o;a++){var l=this._dimensions[a];s[a]=Jr(l)||Tt(l)?l:l.max()}return s},r.prototype.min=function(){for(var s=[],a=0,o=this._dimensions.length;a<o;a++){var l=this._dimensions[a];s[a]=Jr(l)||Tt(l)?l:l.min()}return s},r.prototype.forEach=function(s){for(var a=0,o=this._dimensions.length;a<o;a++)s(this._dimensions[a],a,this)},r.prototype.dimension=function(s){var a;return Tt(s)&&(a=this._dimensions[s])!==null&&a!==void 0?a:null},r.prototype.isObjectProperty=function(){return this._dimensions.length===1&&Jr(this._dimensions[0])},r.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},r.prototype.isScalar=function(){return this._isScalar},r.prototype.toArray=function(){for(var s=[],a=0,o=this._dimensions.length;a<o;a++){var l=this._dimensions[a];s.push(Jr(l)||Tt(l)?l:l.toArray())}return s},r.prototype.valueOf=r.prototype.toArray,r.prototype.toString=function(){for(var s=[],a=0,o=this._dimensions.length;a<o;a++){var l=this._dimensions[a];Jr(l)?s.push(JSON.stringify(l)):s.push(l.toString())}return"["+s.join(", ")+"]"},r.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},r.fromJSON=function(s){return r.create(s.dimensions)},r},{isClass:!0});function TH(n){var e=[];return n.forEach((t,r)=>{t&&e.push(r)}),e}var K3e="FibonacciHeap",Y3e=["smaller","larger"],Q3e=re(K3e,Y3e,n=>{var{smaller:e,larger:t}=n,r=1/Math.log((1+Math.sqrt(5))/2);function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}i.prototype.type="FibonacciHeap",i.prototype.isFibonacciHeap=!0,i.prototype.insert=function(c,h){var d={key:c,value:h,degree:0};if(this._minimum){var f=this._minimum;d.left=f,d.right=f.right,f.right=d,d.right.left=d,e(c,f.key)&&(this._minimum=d)}else d.left=d,d.right=d,this._minimum=d;return this._size++,d},i.prototype.size=function(){return this._size},i.prototype.clear=function(){this._minimum=null,this._size=0},i.prototype.isEmpty=function(){return this._size===0},i.prototype.extractMinimum=function(){var c=this._minimum;if(c===null)return c;for(var h=this._minimum,d=c.degree,f=c.child;d>0;){var p=f.right;f.left.right=f.right,f.right.left=f.left,f.left=h,f.right=h.right,h.right=f,f.right.left=f,f.parent=null,f=p,d--}return c.left.right=c.right,c.right.left=c.left,c===c.right?h=null:(h=c.right,h=u(h,this._size)),this._size--,this._minimum=h,c},i.prototype.remove=function(c){this._minimum=s(this._minimum,c,-1),this.extractMinimum()};function s(c,h,d){h.key=d;var f=h.parent;return f&&e(h.key,f.key)&&(a(c,h,f),o(c,f)),e(h.key,c.key)&&(c=h),c}function a(c,h,d){h.left.right=h.right,h.right.left=h.left,d.degree--,d.child===h&&(d.child=h.right),d.degree===0&&(d.child=null),h.left=c,h.right=c.right,c.right=h,h.right.left=h,h.parent=null,h.mark=!1}function o(c,h){var d=h.parent;d&&(h.mark?(a(c,h,d),o(d)):h.mark=!0)}var l=function(h,d){h.left.right=h.right,h.right.left=h.left,h.parent=d,d.child?(h.left=d.child,h.right=d.child.right,d.child.right=h,h.right.left=h):(d.child=h,h.right=h,h.left=h),d.degree++,h.mark=!1};function u(c,h){var d=Math.floor(Math.log(h)*r)+1,f=new Array(d),p=0,m=c;if(m)for(p++,m=m.right;m!==c;)p++,m=m.right;for(var y;p>0;){for(var v=m.degree,b=m.right;y=f[v],!!y;){if(t(m.key,y.key)){var x=y;y=m,m=x}l(y,m),f[v]=null,v++}f[v]=m,m=b,p--}c=null;for(var w=0;w<d;w++)y=f[w],y&&(c?(y.left.right=y.right,y.right.left=y.left,y.left=c,y.right=c.right,c.right=y,y.right.left=y,e(y.key,c.key)&&(c=y)):c=y);return c}return i},{isClass:!0}),Z3e="Spa",J3e=["addScalar","equalScalar","FibonacciHeap"],eFe=re(Z3e,J3e,n=>{var{addScalar:e,equalScalar:t,FibonacciHeap:r}=n;function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new r}return i.prototype.type="Spa",i.prototype.isSpa=!0,i.prototype.set=function(s,a){if(this._values[s])this._values[s].value=a;else{var o=this._heap.insert(s,a);this._values[s]=o}},i.prototype.get=function(s){var a=this._values[s];return a?a.value:0},i.prototype.accumulate=function(s,a){var o=this._values[s];o?o.value=e(o.value,a):(o=this._heap.insert(s,a),this._values[s]=o)},i.prototype.forEach=function(s,a,o){var l=this._heap,u=this._values,c=[],h=l.extractMinimum();for(h&&c.push(h);h&&h.key<=a;)h.key>=s&&(t(h.value,0)||o(h.key,h.value,this)),h=l.extractMinimum(),h&&c.push(h);for(var d=0;d<c.length;d++){var f=c[d];h=l.insert(f.key,f.value),u[h.key]=h}},i.prototype.swap=function(s,a){var o=this._values[s],l=this._values[a];if(!o&&l)o=this._heap.insert(s,l.value),this._heap.remove(l),this._values[s]=o,this._values[a]=void 0;else if(o&&!l)l=this._heap.insert(a,o.value),this._heap.remove(o),this._values[a]=l,this._values[s]=void 0;else if(o&&l){var u=o.value;o.value=l.value,l.value=u}},i},{isClass:!0});function tFe(n){var e=0,t=1,r=Object.create(null),i=Object.create(null),s=0,a=function(l){var u=i[l];if(u&&(delete r[u],delete i[l],--e,t===u)){if(!e){s=0,t=1;return}for(;!Object.prototype.hasOwnProperty.call(r,++t););}};return n=Math.abs(n),{hit:function(l){var u=i[l],c=++s;if(r[c]=l,i[l]=c,!u)return++e,e<=n?void 0:(l=r[t],a(l),l);if(delete r[u],t===u)for(;!Object.prototype.hasOwnProperty.call(r,++t););},delete:a,clear:function(){e=s=0,t=1,r=Object.create(null),i=Object.create(null)}}}function uA(n){var{hasher:e,limit:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return t=t??Number.POSITIVE_INFINITY,e=e??JSON.stringify,function r(){typeof r.cache!="object"&&(r.cache={values:new Map,lru:tFe(t||Number.POSITIVE_INFINITY)});for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var a=e(i);if(r.cache.values.has(a))return r.cache.lru.hit(a),r.cache.values.get(a);var o=n.apply(n,i);return r.cache.values.set(a,o),r.cache.values.delete(r.cache.lru.hit(a)),o}}var nFe=uA(function(n){return new n(1).exp()},{hasher:zN}),rFe=uA(function(n){return new n(1).plus(new n(5).sqrt()).div(2)},{hasher:zN}),oU=uA(function(n){return n.acos(-1)},{hasher:zN}),iFe=uA(function(n){return oU(n).times(2)},{hasher:zN});function zN(n){return n[0].precision}function MH(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function eP(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?MH(Object(t),!0).forEach(function(r){wi(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):MH(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var sFe="Unit",aFe=["?on","config","addScalar","subtractScalar","multiplyScalar","divideScalar","pow","abs","fix","round","equal","isNumeric","format","number","Complex","BigNumber","Fraction"],oFe=re(sFe,aFe,n=>{var{on:e,config:t,addScalar:r,subtractScalar:i,multiplyScalar:s,divideScalar:a,pow:o,abs:l,fix:u,round:c,equal:h,isNumeric:d,format:f,number:p,Complex:m,BigNumber:y,Fraction:v}=n,b=p,x=!1,w=!0;function _(ae,fe){if(!(this instanceof _))throw new Error("Constructor must be called with the new operator");if(!(ae==null||d(ae)||Qh(ae)))throw new TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(this.fixPrefix=x,this.skipAutomaticSimplification=w,fe===void 0)this.units=[],this.dimensions=se.map(P=>0);else if(typeof fe=="string"){var F=_.parse(fe);this.units=F.units,this.dimensions=F.dimensions}else if(No(fe)&&fe.value===null)this.fixPrefix=fe.fixPrefix,this.skipAutomaticSimplification=fe.skipAutomaticSimplification,this.dimensions=fe.dimensions.slice(0),this.units=fe.units.map(P=>li({},P));else throw new TypeError("Second parameter in Unit constructor must be a string or valueless Unit");this.value=this._normalize(ae)}Object.defineProperty(_,"name",{value:"Unit"}),_.prototype.constructor=_,_.prototype.type="Unit",_.prototype.isUnit=!0;var E,A,T;function S(){for(;T===" "||T==="	";)N()}function M(ae){return ae>="0"&&ae<="9"||ae==="."}function D(ae){return ae>="0"&&ae<="9"}function N(){A++,T=E.charAt(A)}function R(ae){A=ae,T=E.charAt(A)}function O(){var ae="",fe=A;if(T==="+"?N():T==="-"&&(ae+=T,N()),!M(T))return R(fe),null;if(T==="."){if(ae+=T,N(),!D(T))return R(fe),null}else{for(;D(T);)ae+=T,N();T==="."&&(ae+=T,N())}for(;D(T);)ae+=T,N();if(T==="E"||T==="e"){var F="",P=A;if(F+=T,N(),(T==="+"||T==="-")&&(F+=T,N()),!D(T))return R(P),ae;for(ae=ae+F;D(T);)ae+=T,N()}return ae}function G(){for(var ae="";D(T)||_.isValidAlpha(T);)ae+=T,N();var fe=ae.charAt(0);return _.isValidAlpha(fe)?ae:null}function I(ae){return T===ae?(N(),ae):null}_.parse=function(ae,fe){if(fe=fe||{},E=ae,A=-1,T="",typeof E!="string")throw new TypeError("Invalid argument in Unit.parse, string expected");var F=new _;F.units=[];var P=1,K=!1;N(),S();var oe=O(),pe=null;if(oe){if(t.number==="BigNumber")pe=new y(oe);else if(t.number==="Fraction")try{pe=new v(oe)}catch{pe=parseFloat(oe)}else pe=parseFloat(oe);S(),I("*")?(P=1,K=!0):I("/")&&(P=-1,K=!0)}for(var ce=[],Te=1;;){for(S();T==="(";)ce.push(P),Te*=P,P=1,N(),S();var be=void 0;if(T){var Pe=T;if(be=G(),be===null)throw new SyntaxError('Unexpected "'+Pe+'" in "'+E+'" at index '+A.toString())}else break;var Me=B(be);if(Me===null)throw new SyntaxError('Unit "'+be+'" not found.');var Ne=P*Te;if(S(),I("^")){S();var ze=O();if(ze===null)throw new SyntaxError('In "'+ae+'", "^" must be followed by a floating-point number');Ne*=ze}F.units.push({unit:Me.unit,prefix:Me.prefix,power:Ne});for(var Ke=0;Ke<se.length;Ke++)F.dimensions[Ke]+=(Me.unit.dimensions[Ke]||0)*Ne;for(S();T===")";){if(ce.length===0)throw new SyntaxError('Unmatched ")" in "'+E+'" at index '+A.toString());Te/=ce.pop(),N(),S()}if(K=!1,I("*")?(P=1,K=!0):I("/")?(P=-1,K=!0):P=1,Me.unit.base){var Ge=Me.unit.base.key;ge.auto[Ge]={unit:Me.unit,prefix:Me.prefix}}}if(S(),T)throw new SyntaxError('Could not parse: "'+ae+'"');if(K)throw new SyntaxError('Trailing characters: "'+ae+'"');if(ce.length!==0)throw new SyntaxError('Unmatched "(" in "'+E+'"');if(F.units.length===0&&!fe.allowNoUnits)throw new SyntaxError('"'+ae+'" contains no units');return F.value=pe!==void 0?F._normalize(pe):null,F},_.prototype.clone=function(){var ae=new _;ae.fixPrefix=this.fixPrefix,ae.skipAutomaticSimplification=this.skipAutomaticSimplification,ae.value=Ut(this.value),ae.dimensions=this.dimensions.slice(0),ae.units=[];for(var fe=0;fe<this.units.length;fe++){ae.units[fe]={};for(var F in this.units[fe])vt(this.units[fe],F)&&(ae.units[fe][F]=this.units[fe][F])}return ae},_.prototype.valueType=function(){return Yn(this.value)},_.prototype._isDerived=function(){return this.units.length===0?!1:this.units.length>1||Math.abs(this.units[0].power-1)>1e-15},_.prototype._normalize=function(ae){if(ae==null||this.units.length===0)return ae;for(var fe=ae,F=_._getNumberConverter(Yn(ae)),P=0;P<this.units.length;P++){var K=F(this.units[P].unit.value),oe=F(this.units[P].prefix.value),pe=F(this.units[P].power);fe=s(fe,o(s(K,oe),pe))}return fe},_.prototype._denormalize=function(ae,fe){if(ae==null||this.units.length===0)return ae;for(var F=ae,P=_._getNumberConverter(Yn(ae)),K=0;K<this.units.length;K++){var oe=P(this.units[K].unit.value),pe=P(this.units[K].prefix.value),ce=P(this.units[K].power);F=a(F,o(s(oe,pe),ce))}return F};var B=uA(ae=>{if(vt(Y,ae)){var fe=Y[ae],F=fe.prefixes[""];return{unit:fe,prefix:F}}for(var P in Y)if(vt(Y,P)&&lDe(ae,P)){var K=Y[P],oe=ae.length-P.length,pe=ae.substring(0,oe),ce=vt(K.prefixes,pe)?K.prefixes[pe]:void 0;if(ce!==void 0)return{unit:K,prefix:ce}}return null},{hasher:ae=>ae[0],limit:100});_.isValuelessUnit=function(ae){return B(ae)!==null},_.prototype.hasBase=function(ae){if(typeof ae=="string"&&(ae=Z[ae]),!ae)return!1;for(var fe=0;fe<se.length;fe++)if(Math.abs((this.dimensions[fe]||0)-(ae.dimensions[fe]||0))>1e-12)return!1;return!0},_.prototype.equalBase=function(ae){for(var fe=0;fe<se.length;fe++)if(Math.abs((this.dimensions[fe]||0)-(ae.dimensions[fe]||0))>1e-12)return!1;return!0},_.prototype.equals=function(ae){return this.equalBase(ae)&&h(this.value,ae.value)},_.prototype.multiply=function(ae){for(var fe=this.clone(),F=No(ae)?ae:new _(ae),P=0;P<se.length;P++)fe.dimensions[P]=(this.dimensions[P]||0)+(F.dimensions[P]||0);for(var K=0;K<F.units.length;K++){var oe=eP({},F.units[K]);fe.units.push(oe)}if(this.value!==null||F.value!==null){var pe=this.value===null?this._normalize(H(F.value)):this.value,ce=F.value===null?F._normalize(H(this.value)):F.value;fe.value=s(pe,ce)}else fe.value=null;return No(ae)&&(fe.skipAutomaticSimplification=!1),$(fe)},_.prototype.divideInto=function(ae){return new _(ae).divide(this)},_.prototype.divide=function(ae){for(var fe=this.clone(),F=No(ae)?ae:new _(ae),P=0;P<se.length;P++)fe.dimensions[P]=(this.dimensions[P]||0)-(F.dimensions[P]||0);for(var K=0;K<F.units.length;K++){var oe=eP(eP({},F.units[K]),{},{power:-F.units[K].power});fe.units.push(oe)}if(this.value!==null||F.value!==null){var pe=this.value===null?this._normalize(H(F.value)):this.value,ce=F.value===null?F._normalize(H(this.value)):F.value;fe.value=a(pe,ce)}else fe.value=null;return No(ae)&&(fe.skipAutomaticSimplification=!1),$(fe)},_.prototype.pow=function(ae){for(var fe=this.clone(),F=0;F<se.length;F++)fe.dimensions[F]=(this.dimensions[F]||0)*ae;for(var P=0;P<fe.units.length;P++)fe.units[P].power*=ae;return fe.value!==null?fe.value=o(fe.value,ae):fe.value=null,fe.skipAutomaticSimplification=!1,$(fe)};function $(ae){return ae.equalBase(Z.NONE)&&ae.value!==null&&!t.predictable?ae.value:ae}function H(ae){var fe=_._getNumberConverter(Yn(ae));return fe(1)}_.prototype.abs=function(){var ae=this.clone();if(ae.value!==null)if(ae._isDerived()||ae.units.length===0||ae.units[0].unit.offset===0)ae.value=l(ae.value);else{var fe=ae._numberConverter(),F=fe(ae.units[0].unit.value),P=fe(ae.units[0].unit.offset),K=s(F,P);ae.value=i(l(r(ae.value,K)),K)}for(var oe in ae.units)(ae.units[oe].unit.name==="VA"||ae.units[oe].unit.name==="VAR")&&(ae.units[oe].unit=Y.W);return ae},_.prototype.to=function(ae){var fe=this.value===null?this._normalize(1):this.value,F;if(typeof ae=="string")F=_.parse(ae);else if(No(ae))F=ae.clone();else throw new Error("String or Unit expected as parameter");if(!this.equalBase(F))throw new Error("Units do not match ('".concat(F.toString(),"' != '").concat(this.toString(),"')"));if(F.value!==null)throw new Error("Cannot convert to a unit with a value");if(this.value===null||this._isDerived()||this.units.length===0||F.units.length===0||this.units[0].unit.offset===F.units[0].unit.offset)F.value=Ut(fe);else{var P=_._getNumberConverter(Yn(fe)),K=this.units[0].unit.value,oe=this.units[0].unit.offset,pe=s(K,oe),ce=F.units[0].unit.value,Te=F.units[0].unit.offset,be=s(ce,Te);F.value=r(fe,P(i(pe,be)))}return F.fixPrefix=!0,F.skipAutomaticSimplification=!0,F},_.prototype.toNumber=function(ae){return b(this.toNumeric(ae))},_.prototype.toNumeric=function(ae){var fe;return ae?fe=this.to(ae):fe=this.clone(),fe._isDerived()||fe.units.length===0?fe._denormalize(fe.value):fe._denormalize(fe.value,fe.units[0].prefix.value)},_.prototype.toString=function(){return this.format()},_.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.units.length>0?this.formatUnits():null,fixPrefix:this.fixPrefix,skipSimp:this.skipAutomaticSimplification}},_.fromJSON=function(ae){var fe,F,P,K=new _(ae.value,(fe=ae.unit)!==null&&fe!==void 0?fe:void 0);return K.fixPrefix=(F=ae.fixPrefix)!==null&&F!==void 0?F:x,K.skipAutomaticSimplification=(P=ae.skipSimp)!==null&&P!==void 0?P:w,K},_.prototype.valueOf=_.prototype.toString,_.prototype.simplify=function(){var ae=this.clone(),fe=[],F;for(var P in _e)if(vt(_e,P)&&ae.hasBase(Z[P])){F=P;break}if(F==="NONE")ae.units=[];else{var K;if(F&&vt(_e,F)&&(K=_e[F]),K)ae.units=[{unit:K.unit,prefix:K.prefix,power:1}];else{for(var oe=!1,pe=0;pe<se.length;pe++){var ce=se[pe];Math.abs(ae.dimensions[pe]||0)>1e-12&&(vt(_e,ce)?fe.push({unit:_e[ce].unit,prefix:_e[ce].prefix,power:ae.dimensions[pe]||0}):oe=!0)}fe.length<ae.units.length&&!oe&&(ae.units=fe)}}return ae},_.prototype.toSI=function(){for(var ae=this.clone(),fe=[],F=0;F<se.length;F++){var P=se[F];if(Math.abs(ae.dimensions[F]||0)>1e-12)if(vt(ge.si,P))fe.push({unit:ge.si[P].unit,prefix:ge.si[P].prefix,power:ae.dimensions[F]||0});else throw new Error("Cannot express custom unit "+P+" in SI units")}return ae.units=fe,ae.fixPrefix=!0,ae.skipAutomaticSimplification=!0,this.value!==null?(ae.value=null,this.to(ae)):ae},_.prototype.formatUnits=function(){for(var ae="",fe="",F=0,P=0,K=0;K<this.units.length;K++)this.units[K].power>0?(F++,ae+=" "+this.units[K].prefix.name+this.units[K].unit.name,Math.abs(this.units[K].power-1)>1e-15&&(ae+="^"+this.units[K].power)):this.units[K].power<0&&P++;if(P>0)for(var oe=0;oe<this.units.length;oe++)this.units[oe].power<0&&(F>0?(fe+=" "+this.units[oe].prefix.name+this.units[oe].unit.name,Math.abs(this.units[oe].power+1)>1e-15&&(fe+="^"+-this.units[oe].power)):(fe+=" "+this.units[oe].prefix.name+this.units[oe].unit.name,fe+="^"+this.units[oe].power));ae=ae.substr(1),fe=fe.substr(1),F>1&&P>0&&(ae="("+ae+")"),P>1&&F>0&&(fe="("+fe+")");var pe=ae;return F>0&&P>0&&(pe+=" / "),pe+=fe,pe},_.prototype.toBest=function(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(ae&&!Array.isArray(ae))throw new Error("Invalid unit type. Expected string or Unit.");var F=this.units[0].unit.prefixes;if(ae&&ae.length>0){var P=ae.map(pe=>{var ce=null;if(typeof pe=="string"){if(ce=_.parse(pe),!ce)throw new Error("Invalid unit type. Expected compatible string or Unit.")}else if(!No(pe))throw new Error("Invalid unit type. Expected compatible string or Unit.");ce===null&&(ce=pe.clone());try{return this.to(ce.formatUnits()),ce}catch{throw new Error("Invalid unit type. Expected compatible string or Unit.")}}),K=P.map(pe=>pe.units[0].prefix);this.units[0].unit.prefixes=K.reduce((pe,ce)=>(pe[ce.name]=ce,pe),{}),this.units[0].prefix=K[0]}var oe=Q(this,fe).simp;return this.units[0].unit.prefixes=F,oe.fixPrefix=!0,oe},_.prototype.format=function(ae){var{simp:fe,valueStr:F,unitStr:P}=Q(this,ae),K=F;return fe.value&&Qh(fe.value)&&(K="("+K+")"),P.length>0&&K.length>0&&(K+=" "),K+=P,K};function Q(ae){var fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},F=ae.skipAutomaticSimplification||ae.value===null?ae.clone():ae.simplify();ee(F),J(F,fe.offset);var P=F._denormalize(F.value),K=F.value!==null?f(P,fe||{}):"",oe=F.formatUnits();return{simp:F,valueStr:K,unitStr:oe}}function ee(ae){var fe=!1;typeof ae.value<"u"&&ae.value!==null&&Qh(ae.value)&&(fe=Math.abs(ae.value.re)<1e-14);for(var F in ae.units)vt(ae.units,F)&&ae.units[F].unit&&(ae.units[F].unit.name==="VA"&&fe?ae.units[F].unit=Y.VAR:ae.units[F].unit.name==="VAR"&&!fe&&(ae.units[F].unit=Y.VA))}function J(ae,fe){ae.units.length===1&&!ae.fixPrefix&&Math.abs(ae.units[0].power-Math.round(ae.units[0].power))<1e-14&&(ae.units[0].prefix=ae._bestPrefix(fe))}_.prototype._bestPrefix=function(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1.2;if(this.units.length!==1)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");if(Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var fe=this.value!==null?l(this.value):0,F=l(this.units[0].unit.value),P=this.units[0].prefix;if(fe===0)return P;var K=this.units[0].power,oe=Math.log(fe/Math.pow(P.value*F,K))/Math.LN10-ae;if(oe>-2.200001&&oe<1.800001)return P;oe=Math.abs(oe);var pe=this.units[0].unit.prefixes;for(var ce in pe)if(vt(pe,ce)){var Te=pe[ce];if(Te.scientific){var be=Math.abs(Math.log(fe/Math.pow(Te.value*F,K))/Math.LN10-ae);(be<oe||be===oe&&Te.name.length<P.name.length)&&(P=Te,oe=be)}}return P},_.prototype.splitUnit=function(ae){for(var fe=this.clone(),F=[],P=0;P<ae.length&&(fe=fe.to(ae[P]),P!==ae.length-1);P++){var K=fe.toNumeric(),oe=c(K),pe=void 0,ce=h(oe,K);ce?pe=oe:pe=u(fe.toNumeric());var Te=new _(pe,ae[P].toString());F.push(Te),fe=i(fe,Te)}for(var be=0,Pe=0;Pe<F.length;Pe++)be=r(be,F[Pe].value);return h(be,this.value)&&(fe.value=0),F.push(fe),F};var L={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},R:{name:"R",value:1e27,scientific:!0},Q:{name:"Q",value:1e30,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0},r:{name:"r",value:1e-27,scientific:!0},q:{name:"q",value:1e-30,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},ronna:{name:"ronna",value:1e27,scientific:!0},quetta:{name:"quetta",value:1e30,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0},ronto:{name:"ronto",value:1e-27,scientific:!0},quecto:{name:"quecto",value:1e-30,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},R:{name:"R",value:1e54,scientific:!0},Q:{name:"Q",value:1e60,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0},r:{name:"r",value:1e-54,scientific:!0},q:{name:"q",value:1e-60,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},R:{name:"R",value:1e81,scientific:!0},Q:{name:"Q",value:1e90,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0},r:{name:"r",value:1e-81,scientific:!0},q:{name:"q",value:1e-90,scientific:!0}},BINARY_SHORT_SI:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0}},BINARY_SHORT_IEC:{"":{name:"",value:1,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG_SI:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0}},BINARY_LONG_IEC:{"":{name:"",value:1,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};L.SHORTLONG=li({},L.SHORT,L.LONG),L.BINARY_SHORT=li({},L.BINARY_SHORT_SI,L.BINARY_SHORT_IEC),L.BINARY_LONG=li({},L.BINARY_LONG_SI,L.BINARY_LONG_IEC);var se=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],Z={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var le in Z)vt(Z,le)&&(Z[le].key=le);var ue={},te={name:"",base:ue,value:1,offset:0,dimensions:se.map(ae=>0)},Y={meter:{name:"meter",base:Z.LENGTH,prefixes:L.LONG,value:1,offset:0},inch:{name:"inch",base:Z.LENGTH,prefixes:L.NONE,value:.0254,offset:0},foot:{name:"foot",base:Z.LENGTH,prefixes:L.NONE,value:.3048,offset:0},yard:{name:"yard",base:Z.LENGTH,prefixes:L.NONE,value:.9144,offset:0},mile:{name:"mile",base:Z.LENGTH,prefixes:L.NONE,value:1609.344,offset:0},link:{name:"link",base:Z.LENGTH,prefixes:L.NONE,value:.201168,offset:0},rod:{name:"rod",base:Z.LENGTH,prefixes:L.NONE,value:5.0292,offset:0},chain:{name:"chain",base:Z.LENGTH,prefixes:L.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:Z.LENGTH,prefixes:L.NONE,value:1e-10,offset:0},m:{name:"m",base:Z.LENGTH,prefixes:L.SHORT,value:1,offset:0},in:{name:"in",base:Z.LENGTH,prefixes:L.NONE,value:.0254,offset:0},ft:{name:"ft",base:Z.LENGTH,prefixes:L.NONE,value:.3048,offset:0},yd:{name:"yd",base:Z.LENGTH,prefixes:L.NONE,value:.9144,offset:0},mi:{name:"mi",base:Z.LENGTH,prefixes:L.NONE,value:1609.344,offset:0},li:{name:"li",base:Z.LENGTH,prefixes:L.NONE,value:.201168,offset:0},rd:{name:"rd",base:Z.LENGTH,prefixes:L.NONE,value:5.02921,offset:0},ch:{name:"ch",base:Z.LENGTH,prefixes:L.NONE,value:20.1168,offset:0},mil:{name:"mil",base:Z.LENGTH,prefixes:L.NONE,value:254e-7,offset:0},m2:{name:"m2",base:Z.SURFACE,prefixes:L.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:Z.SURFACE,prefixes:L.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:Z.SURFACE,prefixes:L.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:Z.SURFACE,prefixes:L.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:Z.SURFACE,prefixes:L.NONE,value:2589988110336e-6,offset:0},sqrd:{name:"sqrd",base:Z.SURFACE,prefixes:L.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:Z.SURFACE,prefixes:L.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:Z.SURFACE,prefixes:L.NONE,value:64516e-14,offset:0},acre:{name:"acre",base:Z.SURFACE,prefixes:L.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:Z.SURFACE,prefixes:L.NONE,value:1e4,offset:0},m3:{name:"m3",base:Z.VOLUME,prefixes:L.CUBIC,value:1,offset:0},L:{name:"L",base:Z.VOLUME,prefixes:L.SHORT,value:.001,offset:0},l:{name:"l",base:Z.VOLUME,prefixes:L.SHORT,value:.001,offset:0},litre:{name:"litre",base:Z.VOLUME,prefixes:L.LONG,value:.001,offset:0},cuin:{name:"cuin",base:Z.VOLUME,prefixes:L.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:Z.VOLUME,prefixes:L.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:Z.VOLUME,prefixes:L.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:Z.VOLUME,prefixes:L.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:Z.VOLUME,prefixes:L.NONE,value:15e-6,offset:0},drop:{name:"drop",base:Z.VOLUME,prefixes:L.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:Z.VOLUME,prefixes:L.NONE,value:5e-8,offset:0},minim:{name:"minim",base:Z.VOLUME,prefixes:L.NONE,value:61611519921875e-21,offset:0},fluiddram:{name:"fluiddram",base:Z.VOLUME,prefixes:L.NONE,value:36966911953125e-19,offset:0},fluidounce:{name:"fluidounce",base:Z.VOLUME,prefixes:L.NONE,value:295735295625e-16,offset:0},gill:{name:"gill",base:Z.VOLUME,prefixes:L.NONE,value:.00011829411825,offset:0},cc:{name:"cc",base:Z.VOLUME,prefixes:L.NONE,value:1e-6,offset:0},cup:{name:"cup",base:Z.VOLUME,prefixes:L.NONE,value:.0002365882365,offset:0},pint:{name:"pint",base:Z.VOLUME,prefixes:L.NONE,value:.000473176473,offset:0},quart:{name:"quart",base:Z.VOLUME,prefixes:L.NONE,value:.000946352946,offset:0},gallon:{name:"gallon",base:Z.VOLUME,prefixes:L.NONE,value:.003785411784,offset:0},beerbarrel:{name:"beerbarrel",base:Z.VOLUME,prefixes:L.NONE,value:.117347765304,offset:0},oilbarrel:{name:"oilbarrel",base:Z.VOLUME,prefixes:L.NONE,value:.158987294928,offset:0},hogshead:{name:"hogshead",base:Z.VOLUME,prefixes:L.NONE,value:.238480942392,offset:0},g:{name:"g",base:Z.MASS,prefixes:L.SHORT,value:.001,offset:0},gram:{name:"gram",base:Z.MASS,prefixes:L.LONG,value:.001,offset:0},ton:{name:"ton",base:Z.MASS,prefixes:L.SHORT,value:907.18474,offset:0},t:{name:"t",base:Z.MASS,prefixes:L.SHORT,value:1e3,offset:0},tonne:{name:"tonne",base:Z.MASS,prefixes:L.LONG,value:1e3,offset:0},grain:{name:"grain",base:Z.MASS,prefixes:L.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:Z.MASS,prefixes:L.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:Z.MASS,prefixes:L.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:Z.MASS,prefixes:L.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:Z.MASS,prefixes:L.NONE,value:45.359237,offset:0},stick:{name:"stick",base:Z.MASS,prefixes:L.NONE,value:.115,offset:0},stone:{name:"stone",base:Z.MASS,prefixes:L.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:Z.MASS,prefixes:L.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:Z.MASS,prefixes:L.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:Z.MASS,prefixes:L.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:Z.MASS,prefixes:L.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:Z.MASS,prefixes:L.NONE,value:45.359237,offset:0},s:{name:"s",base:Z.TIME,prefixes:L.SHORT,value:1,offset:0},min:{name:"min",base:Z.TIME,prefixes:L.NONE,value:60,offset:0},h:{name:"h",base:Z.TIME,prefixes:L.NONE,value:3600,offset:0},second:{name:"second",base:Z.TIME,prefixes:L.LONG,value:1,offset:0},sec:{name:"sec",base:Z.TIME,prefixes:L.LONG,value:1,offset:0},minute:{name:"minute",base:Z.TIME,prefixes:L.NONE,value:60,offset:0},hour:{name:"hour",base:Z.TIME,prefixes:L.NONE,value:3600,offset:0},day:{name:"day",base:Z.TIME,prefixes:L.NONE,value:86400,offset:0},week:{name:"week",base:Z.TIME,prefixes:L.NONE,value:7*86400,offset:0},month:{name:"month",base:Z.TIME,prefixes:L.NONE,value:2629800,offset:0},year:{name:"year",base:Z.TIME,prefixes:L.NONE,value:31557600,offset:0},decade:{name:"decade",base:Z.TIME,prefixes:L.NONE,value:315576e3,offset:0},century:{name:"century",base:Z.TIME,prefixes:L.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:Z.TIME,prefixes:L.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:Z.FREQUENCY,prefixes:L.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:Z.FREQUENCY,prefixes:L.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:Z.ANGLE,prefixes:L.SHORT,value:1,offset:0},radian:{name:"radian",base:Z.ANGLE,prefixes:L.LONG,value:1,offset:0},deg:{name:"deg",base:Z.ANGLE,prefixes:L.SHORT,value:null,offset:0},degree:{name:"degree",base:Z.ANGLE,prefixes:L.LONG,value:null,offset:0},grad:{name:"grad",base:Z.ANGLE,prefixes:L.SHORT,value:null,offset:0},gradian:{name:"gradian",base:Z.ANGLE,prefixes:L.LONG,value:null,offset:0},cycle:{name:"cycle",base:Z.ANGLE,prefixes:L.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:Z.ANGLE,prefixes:L.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:Z.ANGLE,prefixes:L.NONE,value:null,offset:0},A:{name:"A",base:Z.CURRENT,prefixes:L.SHORT,value:1,offset:0},ampere:{name:"ampere",base:Z.CURRENT,prefixes:L.LONG,value:1,offset:0},K:{name:"K",base:Z.TEMPERATURE,prefixes:L.SHORT,value:1,offset:0},degC:{name:"degC",base:Z.TEMPERATURE,prefixes:L.SHORT,value:1,offset:273.15},degF:{name:"degF",base:Z.TEMPERATURE,prefixes:L.SHORT,value:new v(5,9),offset:459.67},degR:{name:"degR",base:Z.TEMPERATURE,prefixes:L.SHORT,value:new v(5,9),offset:0},kelvin:{name:"kelvin",base:Z.TEMPERATURE,prefixes:L.LONG,value:1,offset:0},celsius:{name:"celsius",base:Z.TEMPERATURE,prefixes:L.LONG,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:Z.TEMPERATURE,prefixes:L.LONG,value:new v(5,9),offset:459.67},rankine:{name:"rankine",base:Z.TEMPERATURE,prefixes:L.LONG,value:new v(5,9),offset:0},mol:{name:"mol",base:Z.AMOUNT_OF_SUBSTANCE,prefixes:L.SHORT,value:1,offset:0},mole:{name:"mole",base:Z.AMOUNT_OF_SUBSTANCE,prefixes:L.LONG,value:1,offset:0},cd:{name:"cd",base:Z.LUMINOUS_INTENSITY,prefixes:L.SHORT,value:1,offset:0},candela:{name:"candela",base:Z.LUMINOUS_INTENSITY,prefixes:L.LONG,value:1,offset:0},N:{name:"N",base:Z.FORCE,prefixes:L.SHORT,value:1,offset:0},newton:{name:"newton",base:Z.FORCE,prefixes:L.LONG,value:1,offset:0},dyn:{name:"dyn",base:Z.FORCE,prefixes:L.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:Z.FORCE,prefixes:L.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:Z.FORCE,prefixes:L.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:Z.FORCE,prefixes:L.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:Z.FORCE,prefixes:L.LONG,value:4448.2216,offset:0},kilogramforce:{name:"kilogramforce",base:Z.FORCE,prefixes:L.NONE,value:9.80665,offset:0},J:{name:"J",base:Z.ENERGY,prefixes:L.SHORT,value:1,offset:0},joule:{name:"joule",base:Z.ENERGY,prefixes:L.LONG,value:1,offset:0},erg:{name:"erg",base:Z.ENERGY,prefixes:L.SHORTLONG,value:1e-7,offset:0},Wh:{name:"Wh",base:Z.ENERGY,prefixes:L.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:Z.ENERGY,prefixes:L.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:Z.ENERGY,prefixes:L.SHORT,value:1602176565e-28,offset:0},electronvolt:{name:"electronvolt",base:Z.ENERGY,prefixes:L.LONG,value:1602176565e-28,offset:0},W:{name:"W",base:Z.POWER,prefixes:L.SHORT,value:1,offset:0},watt:{name:"watt",base:Z.POWER,prefixes:L.LONG,value:1,offset:0},hp:{name:"hp",base:Z.POWER,prefixes:L.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:Z.POWER,prefixes:L.SHORT,value:m.I,offset:0},VA:{name:"VA",base:Z.POWER,prefixes:L.SHORT,value:1,offset:0},Pa:{name:"Pa",base:Z.PRESSURE,prefixes:L.SHORT,value:1,offset:0},psi:{name:"psi",base:Z.PRESSURE,prefixes:L.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:Z.PRESSURE,prefixes:L.NONE,value:101325,offset:0},bar:{name:"bar",base:Z.PRESSURE,prefixes:L.SHORTLONG,value:1e5,offset:0},torr:{name:"torr",base:Z.PRESSURE,prefixes:L.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:Z.PRESSURE,prefixes:L.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:Z.PRESSURE,prefixes:L.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:Z.PRESSURE,prefixes:L.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:Z.ELECTRIC_CHARGE,prefixes:L.LONG,value:1,offset:0},C:{name:"C",base:Z.ELECTRIC_CHARGE,prefixes:L.SHORT,value:1,offset:0},farad:{name:"farad",base:Z.ELECTRIC_CAPACITANCE,prefixes:L.LONG,value:1,offset:0},F:{name:"F",base:Z.ELECTRIC_CAPACITANCE,prefixes:L.SHORT,value:1,offset:0},volt:{name:"volt",base:Z.ELECTRIC_POTENTIAL,prefixes:L.LONG,value:1,offset:0},V:{name:"V",base:Z.ELECTRIC_POTENTIAL,prefixes:L.SHORT,value:1,offset:0},ohm:{name:"ohm",base:Z.ELECTRIC_RESISTANCE,prefixes:L.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:Z.ELECTRIC_INDUCTANCE,prefixes:L.LONG,value:1,offset:0},H:{name:"H",base:Z.ELECTRIC_INDUCTANCE,prefixes:L.SHORT,value:1,offset:0},siemens:{name:"siemens",base:Z.ELECTRIC_CONDUCTANCE,prefixes:L.LONG,value:1,offset:0},S:{name:"S",base:Z.ELECTRIC_CONDUCTANCE,prefixes:L.SHORT,value:1,offset:0},weber:{name:"weber",base:Z.MAGNETIC_FLUX,prefixes:L.LONG,value:1,offset:0},Wb:{name:"Wb",base:Z.MAGNETIC_FLUX,prefixes:L.SHORT,value:1,offset:0},tesla:{name:"tesla",base:Z.MAGNETIC_FLUX_DENSITY,prefixes:L.LONG,value:1,offset:0},T:{name:"T",base:Z.MAGNETIC_FLUX_DENSITY,prefixes:L.SHORT,value:1,offset:0},b:{name:"b",base:Z.BIT,prefixes:L.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:Z.BIT,prefixes:L.BINARY_LONG,value:1,offset:0},B:{name:"B",base:Z.BIT,prefixes:L.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:Z.BIT,prefixes:L.BINARY_LONG,value:8,offset:0}},ie={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fldr:"fluiddram",fluiddrams:"fluiddram",floz:"fluidounce",fluidounces:"fluidounce",gi:"gill",gills:"gill",cp:"cup",cups:"cup",pt:"pint",pints:"pint",qt:"quart",quarts:"quart",gal:"gallon",gallons:"gallon",bbl:"beerbarrel",beerbarrels:"beerbarrel",obl:"oilbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",kgf:"kilogramforce",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",decades:"decade",centuries:"century",millennia:"millennium",hertz:"hertz",radians:"radian",degrees:"degree",gradians:"gradian",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",amps:"ampere",amp:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole",bit:"bits",byte:"bytes"};function ve(ae){if(ae.number==="BigNumber"){var fe=oU(y);Y.rad.value=new y(1),Y.deg.value=fe.div(180),Y.grad.value=fe.div(200),Y.cycle.value=fe.times(2),Y.arcsec.value=fe.div(648e3),Y.arcmin.value=fe.div(10800)}else Y.rad.value=1,Y.deg.value=Math.PI/180,Y.grad.value=Math.PI/200,Y.cycle.value=Math.PI*2,Y.arcsec.value=Math.PI/648e3,Y.arcmin.value=Math.PI/10800;Y.radian.value=Y.rad.value,Y.degree.value=Y.deg.value,Y.gradian.value=Y.grad.value}ve(t),e&&e("config",function(ae,fe){ae.number!==fe.number&&ve(ae)});var ge={si:{NONE:{unit:te,prefix:L.NONE[""]},LENGTH:{unit:Y.m,prefix:L.SHORT[""]},MASS:{unit:Y.g,prefix:L.SHORT.k},TIME:{unit:Y.s,prefix:L.SHORT[""]},CURRENT:{unit:Y.A,prefix:L.SHORT[""]},TEMPERATURE:{unit:Y.K,prefix:L.SHORT[""]},LUMINOUS_INTENSITY:{unit:Y.cd,prefix:L.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:Y.mol,prefix:L.SHORT[""]},ANGLE:{unit:Y.rad,prefix:L.SHORT[""]},BIT:{unit:Y.bits,prefix:L.SHORT[""]},FORCE:{unit:Y.N,prefix:L.SHORT[""]},ENERGY:{unit:Y.J,prefix:L.SHORT[""]},POWER:{unit:Y.W,prefix:L.SHORT[""]},PRESSURE:{unit:Y.Pa,prefix:L.SHORT[""]},ELECTRIC_CHARGE:{unit:Y.C,prefix:L.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:Y.F,prefix:L.SHORT[""]},ELECTRIC_POTENTIAL:{unit:Y.V,prefix:L.SHORT[""]},ELECTRIC_RESISTANCE:{unit:Y.ohm,prefix:L.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:Y.H,prefix:L.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:Y.S,prefix:L.SHORT[""]},MAGNETIC_FLUX:{unit:Y.Wb,prefix:L.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:Y.T,prefix:L.SHORT[""]},FREQUENCY:{unit:Y.Hz,prefix:L.SHORT[""]}}};ge.cgs=JSON.parse(JSON.stringify(ge.si)),ge.cgs.LENGTH={unit:Y.m,prefix:L.SHORT.c},ge.cgs.MASS={unit:Y.g,prefix:L.SHORT[""]},ge.cgs.FORCE={unit:Y.dyn,prefix:L.SHORT[""]},ge.cgs.ENERGY={unit:Y.erg,prefix:L.NONE[""]},ge.us=JSON.parse(JSON.stringify(ge.si)),ge.us.LENGTH={unit:Y.ft,prefix:L.NONE[""]},ge.us.MASS={unit:Y.lbm,prefix:L.NONE[""]},ge.us.TEMPERATURE={unit:Y.degF,prefix:L.NONE[""]},ge.us.FORCE={unit:Y.lbf,prefix:L.NONE[""]},ge.us.ENERGY={unit:Y.BTU,prefix:L.BTU[""]},ge.us.POWER={unit:Y.hp,prefix:L.NONE[""]},ge.us.PRESSURE={unit:Y.psi,prefix:L.NONE[""]},ge.auto=JSON.parse(JSON.stringify(ge.si));var _e=ge.auto;_.setUnitSystem=function(ae){if(vt(ge,ae))_e=ge[ae];else throw new Error("Unit system "+ae+" does not exist. Choices are: "+Object.keys(ge).join(", "))},_.getUnitSystem=function(){for(var ae in ge)if(vt(ge,ae)&&ge[ae]===_e)return ae},_.typeConverters={BigNumber:function(fe){return fe!=null&&fe.isFraction?new y(String(fe.n)).div(String(fe.d)).times(String(fe.s)):new y(fe+"")},Fraction:function(fe){return new v(fe)},Complex:function(fe){return fe},number:function(fe){return fe!=null&&fe.isFraction?p(fe):fe}},_.prototype._numberConverter=function(){var ae=_.typeConverters[this.valueType()];if(ae)return ae;throw new TypeError('Unsupported Unit value type "'+this.valueType()+'"')},_._getNumberConverter=function(ae){if(!_.typeConverters[ae])throw new TypeError('Unsupported type "'+ae+'"');return _.typeConverters[ae]};for(var we in Y)if(vt(Y,we)){var Be=Y[we];Be.dimensions=Be.base.dimensions}for(var $e in ie)if(vt(ie,$e)){var nt=Y[ie[$e]],de={};for(var Ye in nt)vt(nt,Ye)&&(de[Ye]=nt[Ye]);de.name=$e,Y[$e]=de}_.isValidAlpha=function(fe){return/^[a-zA-Z]$/.test(fe)};function Xe(ae){for(var fe=0;fe<ae.length;fe++){if(T=ae.charAt(fe),fe===0&&!_.isValidAlpha(T))throw new Error('Invalid unit name (must begin with alpha character): "'+ae+'"');if(fe>0&&!(_.isValidAlpha(T)||D(T)))throw new Error('Invalid unit name (only alphanumeric characters are allowed): "'+ae+'"')}}return _.createUnit=function(ae,fe){if(typeof ae!="object")throw new TypeError("createUnit expects first parameter to be of type 'Object'");if(fe&&fe.override){for(var F in ae)if(vt(ae,F)&&_.deleteUnit(F),ae[F].aliases)for(var P=0;P<ae[F].aliases.length;P++)_.deleteUnit(ae[F].aliases[P])}var K;for(var oe in ae)vt(ae,oe)&&(K=_.createUnitSingle(oe,ae[oe]));return K},_.createUnitSingle=function(ae,fe){if((typeof fe>"u"||fe===null)&&(fe={}),typeof ae!="string")throw new TypeError("createUnitSingle expects first parameter to be of type 'string'");if(vt(Y,ae))throw new Error('Cannot create unit "'+ae+'": a unit with that name already exists');Xe(ae);var F=null,P=[],K=0,oe,pe,ce;if(fe&&fe.type==="Unit")F=fe.clone();else if(typeof fe=="string")fe!==""&&(oe=fe);else if(typeof fe=="object")oe=fe.definition,pe=fe.prefixes,K=fe.offset,ce=fe.baseName,fe.aliases&&(P=fe.aliases.valueOf());else throw new TypeError('Cannot create unit "'+ae+'" from "'+fe.toString()+'": expecting "string" or "Unit" or "Object"');if(P){for(var Te=0;Te<P.length;Te++)if(vt(Y,P[Te]))throw new Error('Cannot create alias "'+P[Te]+'": a unit with that name already exists')}if(oe&&typeof oe=="string"&&!F)try{F=_.parse(oe,{allowNoUnits:!0})}catch(Le){throw Le.message='Could not create unit "'+ae+'" from "'+oe+'": '+Le.message,Le}else oe&&oe.type==="Unit"&&(F=oe.clone());P=P||[],K=K||0,pe&&pe.toUpperCase?pe=L[pe.toUpperCase()]||L.NONE:pe=L.NONE;var be={};if(F){be={name:ae,value:F.value,dimensions:F.dimensions.slice(0),prefixes:pe,offset:K};var ze=!1;for(var Ke in Z)if(vt(Z,Ke)){for(var Ge=!0,qe=0;qe<se.length;qe++)if(Math.abs((be.dimensions[qe]||0)-(Z[Ke].dimensions[qe]||0))>1e-12){Ge=!1;break}if(Ge){ze=!0,be.base=Z[Ke];break}}if(!ze){ce=ce||ae+"_STUFF";var z={dimensions:F.dimensions.slice(0)};z.key=ce,Z[ce]=z,_e[ce]={unit:be,prefix:L.NONE[""]},be.base=Z[ce]}}else{if(ce=ce||ae+"_STUFF",se.indexOf(ce)>=0)throw new Error('Cannot create new base unit "'+ae+'": a base unit with that name already exists (and cannot be overridden)');se.push(ce);for(var Pe in Z)vt(Z,Pe)&&(Z[Pe].dimensions[se.length-1]=0);for(var Me={dimensions:[]},Ne=0;Ne<se.length;Ne++)Me.dimensions[Ne]=0;Me.dimensions[se.length-1]=1,Me.key=ce,Z[ce]=Me,be={name:ae,value:1,dimensions:Z[ce].dimensions.slice(0),prefixes:pe,offset:K,base:Z[ce]},_e[ce]={unit:be,prefix:L.NONE[""]}}_.UNITS[ae]=be;for(var W=0;W<P.length;W++){var ye=P[W],Ee={};for(var Fe in be)vt(be,Fe)&&(Ee[Fe]=be[Fe]);Ee.name=ye,_.UNITS[ye]=Ee}return delete B.cache,new _(null,ae)},_.deleteUnit=function(ae){delete _.UNITS[ae],delete B.cache},_.PREFIXES=L,_.BASE_DIMENSIONS=se,_.BASE_UNITS=Z,_.UNIT_SYSTEMS=ge,_.UNITS=Y,_},{isClass:!0}),CH="unit",lFe=["typed","Unit"],uFe=re(CH,lFe,n=>{var{typed:e,Unit:t}=n;return e(CH,{Unit:function(i){return i.clone()},string:function(i){return t.isValuelessUnit(i)?new t(null,i):t.parse(i,{allowNoUnits:!0})},"number | BigNumber | Fraction | Complex, string | Unit":function(i,s){return new t(i,s)},"number | BigNumber | Fraction":function(i){return new t(i)},"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))})}),DH="sparse",cFe=["typed","SparseMatrix"],hFe=re(DH,cFe,n=>{var{typed:e,SparseMatrix:t}=n;return e(DH,{"":function(){return new t([])},string:function(i){return new t([],i)},"Array | Matrix":function(i){return new t(i)},"Array | Matrix, string":function(i,s){return new t(i,s)}})}),NH="createUnit",dFe=["typed","Unit"],fFe=re(NH,dFe,n=>{var{typed:e,Unit:t}=n;return e(NH,{"Object, Object":function(i,s){return t.createUnit(i,s)},Object:function(i){return t.createUnit(i,{})},"string, Unit | string | Object, Object":function(i,s,a){var o={};return o[i]=s,t.createUnit(o,a)},"string, Unit | string | Object":function(i,s){var a={};return a[i]=s,t.createUnit(a,{})},string:function(i){var s={};return s[i]={},t.createUnit(s,{})}})}),RH="acos",pFe=["typed","config","Complex"],mFe=re(RH,pFe,n=>{var{typed:e,config:t,Complex:r}=n;return e(RH,{number:function(s){return s>=-1&&s<=1||t.predictable?Math.acos(s):new r(s,0).acos()},Complex:function(s){return s.acos()},BigNumber:function(s){return s.acos()}})}),IH="acosh",gFe=["typed","config","Complex"],vFe=re(IH,gFe,n=>{var{typed:e,config:t,Complex:r}=n;return e(IH,{number:function(s){return s>=1||t.predictable?dne(s):s<=-1?new r(Math.log(Math.sqrt(s*s-1)-s),Math.PI):new r(s,0).acosh()},Complex:function(s){return s.acosh()},BigNumber:function(s){return s.acosh()}})}),PH="acot",yFe=["typed","BigNumber"],xFe=re(PH,yFe,n=>{var{typed:e,BigNumber:t}=n;return e(PH,{number:fne,Complex:function(i){return i.acot()},BigNumber:function(i){return new t(1).div(i).atan()}})}),FH="acoth",bFe=["typed","config","Complex","BigNumber"],_Fe=re(FH,bFe,n=>{var{typed:e,config:t,Complex:r,BigNumber:i}=n;return e(FH,{number:function(a){return a>=1||a<=-1||t.predictable?pne(a):new r(a,0).acoth()},Complex:function(a){return a.acoth()},BigNumber:function(a){return new i(1).div(a).atanh()}})}),LH="acsc",wFe=["typed","config","Complex","BigNumber"],EFe=re(LH,wFe,n=>{var{typed:e,config:t,Complex:r,BigNumber:i}=n;return e(LH,{number:function(a){return a<=-1||a>=1||t.predictable?mne(a):new r(a,0).acsc()},Complex:function(a){return a.acsc()},BigNumber:function(a){return new i(1).div(a).asin()}})}),OH="acsch",SFe=["typed","BigNumber"],AFe=re(OH,SFe,n=>{var{typed:e,BigNumber:t}=n;return e(OH,{number:gne,Complex:function(i){return i.acsch()},BigNumber:function(i){return new t(1).div(i).asinh()}})}),kH="asec",TFe=["typed","config","Complex","BigNumber"],MFe=re(kH,TFe,n=>{var{typed:e,config:t,Complex:r,BigNumber:i}=n;return e(kH,{number:function(a){return a<=-1||a>=1||t.predictable?vne(a):new r(a,0).asec()},Complex:function(a){return a.asec()},BigNumber:function(a){return new i(1).div(a).acos()}})}),BH="asech",CFe=["typed","config","Complex","BigNumber"],DFe=re(BH,CFe,n=>{var{typed:e,config:t,Complex:r,BigNumber:i}=n;return e(BH,{number:function(a){if(a<=1&&a>=-1||t.predictable){var o=1/a;if(o>0||t.predictable)return yne(a);var l=Math.sqrt(o*o-1);return new r(Math.log(l-o),Math.PI)}return new r(a,0).asech()},Complex:function(a){return a.asech()},BigNumber:function(a){return new i(1).div(a).acosh()}})}),UH="asin",NFe=["typed","config","Complex"],RFe=re(UH,NFe,n=>{var{typed:e,config:t,Complex:r}=n;return e(UH,{number:function(s){return s>=-1&&s<=1||t.predictable?Math.asin(s):new r(s,0).asin()},Complex:function(s){return s.asin()},BigNumber:function(s){return s.asin()}})}),IFe="asinh",PFe=["typed"],FFe=re(IFe,PFe,n=>{var{typed:e}=n;return e("asinh",{number:xne,Complex:function(r){return r.asinh()},BigNumber:function(r){return r.asinh()}})}),LFe="atan",OFe=["typed"],kFe=re(LFe,OFe,n=>{var{typed:e}=n;return e("atan",{number:function(r){return Math.atan(r)},Complex:function(r){return r.atan()},BigNumber:function(r){return r.atan()}})}),VH="atan2",BFe=["typed","matrix","equalScalar","BigNumber","DenseMatrix","concat"],UFe=re(VH,BFe,n=>{var{typed:e,matrix:t,equalScalar:r,BigNumber:i,DenseMatrix:s,concat:a}=n,o=xu({typed:e,equalScalar:r}),l=sa({typed:e}),u=Fne({typed:e,equalScalar:r}),c=Is({typed:e,equalScalar:r}),h=Ui({typed:e,DenseMatrix:s}),d=or({typed:e,matrix:t,concat:a});return e(VH,{"number, number":Math.atan2,"BigNumber, BigNumber":(f,p)=>i.atan2(f,p)},d({scalar:"number | BigNumber",SS:u,DS:l,SD:o,Ss:c,sS:h}))}),zH="atanh",VFe=["typed","config","Complex"],zFe=re(zH,VFe,n=>{var{typed:e,config:t,Complex:r}=n;return e(zH,{number:function(s){return s<=1&&s>=-1||t.predictable?bne(s):new r(s,0).atanh()},Complex:function(s){return s.atanh()},BigNumber:function(s){return s.atanh()}})}),Qb=re("trigUnit",["typed"],n=>{var{typed:e}=n;return{Unit:e.referToSelf(t=>r=>{if(!r.hasBase(r.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return e.find(t,r.valueType())(r.value)})}}),$H="cos",$Fe=["typed"],HFe=re($H,$Fe,n=>{var{typed:e}=n,t=Qb({typed:e});return e($H,{number:Math.cos,"Complex | BigNumber":r=>r.cos()},t)}),HH="cosh",GFe=["typed"],jFe=re(HH,GFe,n=>{var{typed:e}=n;return e(HH,{number:FMe,"Complex | BigNumber":t=>t.cosh()})}),GH="cot",qFe=["typed","BigNumber"],WFe=re(GH,qFe,n=>{var{typed:e,BigNumber:t}=n,r=Qb({typed:e});return e(GH,{number:_ne,Complex:i=>i.cot(),BigNumber:i=>new t(1).div(i.tan())},r)}),jH="coth",XFe=["typed","BigNumber"],KFe=re(jH,XFe,n=>{var{typed:e,BigNumber:t}=n;return e(jH,{number:wne,Complex:r=>r.coth(),BigNumber:r=>new t(1).div(r.tanh())})}),qH="csc",YFe=["typed","BigNumber"],QFe=re(qH,YFe,n=>{var{typed:e,BigNumber:t}=n,r=Qb({typed:e});return e(qH,{number:Ene,Complex:i=>i.csc(),BigNumber:i=>new t(1).div(i.sin())},r)}),WH="csch",ZFe=["typed","BigNumber"],JFe=re(WH,ZFe,n=>{var{typed:e,BigNumber:t}=n;return e(WH,{number:Sne,Complex:r=>r.csch(),BigNumber:r=>new t(1).div(r.sinh())})}),XH="sec",eLe=["typed","BigNumber"],tLe=re(XH,eLe,n=>{var{typed:e,BigNumber:t}=n,r=Qb({typed:e});return e(XH,{number:Ane,Complex:i=>i.sec(),BigNumber:i=>new t(1).div(i.cos())},r)}),KH="sech",nLe=["typed","BigNumber"],rLe=re(KH,nLe,n=>{var{typed:e,BigNumber:t}=n;return e(KH,{number:Tne,Complex:r=>r.sech(),BigNumber:r=>new t(1).div(r.cosh())})}),YH="sin",iLe=["typed"],sLe=re(YH,iLe,n=>{var{typed:e}=n,t=Qb({typed:e});return e(YH,{number:Math.sin,"Complex | BigNumber":r=>r.sin()},t)}),QH="sinh",aLe=["typed"],oLe=re(QH,aLe,n=>{var{typed:e}=n;return e(QH,{number:Mne,"Complex | BigNumber":t=>t.sinh()})}),ZH="tan",lLe=["typed"],uLe=re(ZH,lLe,n=>{var{typed:e}=n,t=Qb({typed:e});return e(ZH,{number:Math.tan,"Complex | BigNumber":r=>r.tan()},t)}),cLe="tanh",hLe=["typed"],dLe=re(cLe,hLe,n=>{var{typed:e}=n;return e("tanh",{number:OMe,"Complex | BigNumber":t=>t.tanh()})}),JH="setCartesian",fLe=["typed","size","subset","compareNatural","Index","DenseMatrix"],pLe=re(JH,fLe,n=>{var{typed:e,size:t,subset:r,compareNatural:i,Index:s,DenseMatrix:a}=n;return e(JH,{"Array | Matrix, Array | Matrix":function(l,u){var c=[];if(r(t(l),new s(0))!==0&&r(t(u),new s(0))!==0){var h=Tn(Array.isArray(l)?l:l.toArray()).sort(i),d=Tn(Array.isArray(u)?u:u.toArray()).sort(i);c=[];for(var f=0;f<h.length;f++)for(var p=0;p<d.length;p++)c.push([h[f],d[p]])}return Array.isArray(l)&&Array.isArray(u)?c:new a(c)}})}),eG="setDifference",mLe=["typed","size","subset","compareNatural","Index","DenseMatrix"],gLe=re(eG,mLe,n=>{var{typed:e,size:t,subset:r,compareNatural:i,Index:s,DenseMatrix:a}=n;return e(eG,{"Array | Matrix, Array | Matrix":function(l,u){var c;if(r(t(l),new s(0))===0)c=[];else{if(r(t(u),new s(0))===0)return Tn(l.toArray());var h=Sb(Tn(Array.isArray(l)?l:l.toArray()).sort(i)),d=Sb(Tn(Array.isArray(u)?u:u.toArray()).sort(i));c=[];for(var f,p=0;p<h.length;p++){f=!1;for(var m=0;m<d.length;m++)if(i(h[p].value,d[m].value)===0&&h[p].identifier===d[m].identifier){f=!0;break}f||c.push(h[p])}}return Array.isArray(l)&&Array.isArray(u)?VD(c):new a(VD(c))}})}),tG="setDistinct",vLe=["typed","size","subset","compareNatural","Index","DenseMatrix"],yLe=re(tG,vLe,n=>{var{typed:e,size:t,subset:r,compareNatural:i,Index:s,DenseMatrix:a}=n;return e(tG,{"Array | Matrix":function(l){var u;if(r(t(l),new s(0))===0)u=[];else{var c=Tn(Array.isArray(l)?l:l.toArray()).sort(i);u=[],u.push(c[0]);for(var h=1;h<c.length;h++)i(c[h],c[h-1])!==0&&u.push(c[h])}return Array.isArray(l)?u:new a(u)}})}),nG="setIntersect",xLe=["typed","size","subset","compareNatural","Index","DenseMatrix"],bLe=re(nG,xLe,n=>{var{typed:e,size:t,subset:r,compareNatural:i,Index:s,DenseMatrix:a}=n;return e(nG,{"Array | Matrix, Array | Matrix":function(l,u){var c;if(r(t(l),new s(0))===0||r(t(u),new s(0))===0)c=[];else{var h=Sb(Tn(Array.isArray(l)?l:l.toArray()).sort(i)),d=Sb(Tn(Array.isArray(u)?u:u.toArray()).sort(i));c=[];for(var f=0;f<h.length;f++)for(var p=0;p<d.length;p++)if(i(h[f].value,d[p].value)===0&&h[f].identifier===d[p].identifier){c.push(h[f]);break}}return Array.isArray(l)&&Array.isArray(u)?VD(c):new a(VD(c))}})}),rG="setIsSubset",_Le=["typed","size","subset","compareNatural","Index"],wLe=re(rG,_Le,n=>{var{typed:e,size:t,subset:r,compareNatural:i,Index:s}=n;return e(rG,{"Array | Matrix, Array | Matrix":function(o,l){if(r(t(o),new s(0))===0)return!0;if(r(t(l),new s(0))===0)return!1;for(var u=Sb(Tn(Array.isArray(o)?o:o.toArray()).sort(i)),c=Sb(Tn(Array.isArray(l)?l:l.toArray()).sort(i)),h,d=0;d<u.length;d++){h=!1;for(var f=0;f<c.length;f++)if(i(u[d].value,c[f].value)===0&&u[d].identifier===c[f].identifier){h=!0;break}if(h===!1)return!1}return!0}})}),iG="setMultiplicity",ELe=["typed","size","subset","compareNatural","Index"],SLe=re(iG,ELe,n=>{var{typed:e,size:t,subset:r,compareNatural:i,Index:s}=n;return e(iG,{"number | BigNumber | Fraction | Complex, Array | Matrix":function(o,l){if(r(t(l),new s(0))===0)return 0;for(var u=Tn(Array.isArray(l)?l:l.toArray()),c=0,h=0;h<u.length;h++)i(u[h],o)===0&&c++;return c}})}),sG="setPowerset",ALe=["typed","size","subset","compareNatural","Index"],TLe=re(sG,ALe,n=>{var{typed:e,size:t,subset:r,compareNatural:i,Index:s}=n;return e(sG,{"Array | Matrix":function(u){if(r(t(u),new s(0))===0)return[];for(var c=Tn(Array.isArray(u)?u:u.toArray()).sort(i),h=[],d=0;d.toString(2).length<=c.length;)h.push(a(c,d.toString(2).split("").reverse())),d++;return o(h)}});function a(l,u){for(var c=[],h=0;h<u.length;h++)u[h]==="1"&&c.push(l[h]);return c}function o(l){for(var u=[],c=l.length-1;c>0;c--)for(var h=0;h<c;h++)l[h].length>l[h+1].length&&(u=l[h],l[h]=l[h+1],l[h+1]=u);return l}}),aG="setSize",MLe=["typed","compareNatural"],CLe=re(aG,MLe,n=>{var{typed:e,compareNatural:t}=n;return e(aG,{"Array | Matrix":function(i){return Array.isArray(i)?Tn(i).length:Tn(i.toArray()).length},"Array | Matrix, boolean":function(i,s){if(s===!1||i.length===0)return Array.isArray(i)?Tn(i).length:Tn(i.toArray()).length;for(var a=Tn(Array.isArray(i)?i:i.toArray()).sort(t),o=1,l=1;l<a.length;l++)t(a[l],a[l-1])!==0&&o++;return o}})}),oG="setSymDifference",DLe=["typed","size","concat","subset","setDifference","Index"],NLe=re(oG,DLe,n=>{var{typed:e,size:t,concat:r,subset:i,setDifference:s,Index:a}=n;return e(oG,{"Array | Matrix, Array | Matrix":function(l,u){if(i(t(l),new a(0))===0)return Tn(u);if(i(t(u),new a(0))===0)return Tn(l);var c=Tn(l),h=Tn(u);return r(s(c,h),s(h,c))}})}),lG="setUnion",RLe=["typed","size","concat","subset","setIntersect","setSymDifference","Index"],ILe=re(lG,RLe,n=>{var{typed:e,size:t,concat:r,subset:i,setIntersect:s,setSymDifference:a,Index:o}=n;return e(lG,{"Array | Matrix, Array | Matrix":function(u,c){if(i(t(u),new o(0))===0)return Tn(c);if(i(t(c),new o(0))===0)return Tn(u);var h=Tn(u),d=Tn(c);return r(a(h,d),s(h,d))}})}),uG="add",PLe=["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix","concat"],FLe=re(uG,PLe,n=>{var{typed:e,matrix:t,addScalar:r,equalScalar:i,DenseMatrix:s,SparseMatrix:a,concat:o}=n,l=Kp({typed:e}),u=tU({typed:e,equalScalar:i}),c=zv({typed:e,DenseMatrix:s}),h=or({typed:e,matrix:t,concat:o});return e(uG,{"any, any":r,"any, any, ...any":e.referToSelf(d=>(f,p,m)=>{for(var y=d(f,p),v=0;v<m.length;v++)y=d(y,m[v]);return y})},h({elop:r,DS:l,SS:u,Ss:c}))}),cG="hypot",LLe=["typed","abs","addScalar","divideScalar","multiplyScalar","sqrt","smaller","isPositive"],OLe=re(cG,LLe,n=>{var{typed:e,abs:t,addScalar:r,divideScalar:i,multiplyScalar:s,sqrt:a,smaller:o,isPositive:l}=n;return e(cG,{"... number | BigNumber":u,Array:u,Matrix:c=>u(Tn(c.toArray(),!0))});function u(c){for(var h=0,d=0,f=0;f<c.length;f++){if(Qh(c[f]))throw new TypeError("Unexpected type of argument to hypot");var p=t(c[f]);o(d,p)?(h=s(h,s(i(d,p),i(d,p))),h=r(h,1),d=p):h=r(h,l(p)?s(i(p,d),i(p,d)):p)}return s(d,a(h))}}),hG="norm",kLe=["typed","abs","add","pow","conj","sqrt","multiply","equalScalar","larger","smaller","matrix","ctranspose","eigs"],BLe=re(hG,kLe,n=>{var{typed:e,abs:t,add:r,pow:i,conj:s,sqrt:a,multiply:o,equalScalar:l,larger:u,smaller:c,matrix:h,ctranspose:d,eigs:f}=n;return e(hG,{number:Math.abs,Complex:function(T){return T.abs()},BigNumber:function(T){return T.abs()},boolean:function(T){return Math.abs(T)},Array:function(T){return E(h(T),2)},Matrix:function(T){return E(T,2)},"Array, number | BigNumber | string":function(T,S){return E(h(T),S)},"Matrix, number | BigNumber | string":function(T,S){return E(T,S)}});function p(A){var T=0;return A.forEach(function(S){var M=t(S);u(M,T)&&(T=M)},!0),T}function m(A){var T;return A.forEach(function(S){var M=t(S);(!T||c(M,T))&&(T=M)},!0),T||0}function y(A,T){if(T===Number.POSITIVE_INFINITY||T==="inf")return p(A);if(T===Number.NEGATIVE_INFINITY||T==="-inf")return m(A);if(T==="fro")return E(A,2);if(typeof T=="number"&&!isNaN(T)){if(!l(T,0)){var S=0;return A.forEach(function(M){S=r(i(t(M),T),S)},!0),i(S,1/T)}return Number.POSITIVE_INFINITY}throw new Error("Unsupported parameter value")}function v(A){var T=0;return A.forEach(function(S,M){T=r(T,o(S,s(S)))}),t(a(T))}function b(A){var T=[],S=0;return A.forEach(function(M,D){var N=D[1],R=r(T[N]||0,t(M));u(R,S)&&(S=R),T[N]=R},!0),S}function x(A){var T=A.size();if(T[0]!==T[1])throw new RangeError("Invalid matrix dimensions");var S=d(A),M=o(S,A),D=f(M).values.toArray(),N=D[D.length-1];return t(a(N))}function w(A){var T=[],S=0;return A.forEach(function(M,D){var N=D[0],R=r(T[N]||0,t(M));u(R,S)&&(S=R),T[N]=R},!0),S}function _(A,T){if(T===1)return b(A);if(T===Number.POSITIVE_INFINITY||T==="inf")return w(A);if(T==="fro")return v(A);if(T===2)return x(A);throw new Error("Unsupported parameter value "+T)}function E(A,T){var S=A.size();if(S.length===1)return y(A,T);if(S.length===2){if(S[0]&&S[1])return _(A,T);throw new RangeError("Invalid matrix dimensions")}}}),dG="dot",ULe=["typed","addScalar","multiplyScalar","conj","size"],VLe=re(dG,ULe,n=>{var{typed:e,addScalar:t,multiplyScalar:r,conj:i,size:s}=n;return e(dG,{"Array | DenseMatrix, Array | DenseMatrix":o,"SparseMatrix, SparseMatrix":l});function a(u,c){var h=s(u),d=s(c),f,p;if(h.length===1)f=h[0];else if(h.length===2&&h[1]===1)f=h[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+h.join(", ")+")");if(d.length===1)p=d[0];else if(d.length===2&&d[1]===1)p=d[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+d.join(", ")+")");if(f!==p)throw new RangeError("Vectors must have equal length ("+f+" != "+p+")");if(f===0)throw new RangeError("Cannot calculate the dot product of empty vectors");return f}function o(u,c){var h=a(u,c),d=Dt(u)?u._data:u,f=Dt(u)?u._datatype||u.getDataType():void 0,p=Dt(c)?c._data:c,m=Dt(c)?c._datatype||c.getDataType():void 0,y=s(u).length===2,v=s(c).length===2,b=t,x=r;if(f&&m&&f===m&&typeof f=="string"&&f!=="mixed"){var w=f;b=e.find(t,[w,w]),x=e.find(r,[w,w])}if(!y&&!v){for(var _=x(i(d[0]),p[0]),E=1;E<h;E++)_=b(_,x(i(d[E]),p[E]));return _}if(!y&&v){for(var A=x(i(d[0]),p[0][0]),T=1;T<h;T++)A=b(A,x(i(d[T]),p[T][0]));return A}if(y&&!v){for(var S=x(i(d[0][0]),p[0]),M=1;M<h;M++)S=b(S,x(i(d[M][0]),p[M]));return S}if(y&&v){for(var D=x(i(d[0][0]),p[0][0]),N=1;N<h;N++)D=b(D,x(i(d[N][0]),p[N][0]));return D}}function l(u,c){a(u,c);for(var h=u._index,d=u._values,f=c._index,p=c._values,m=0,y=t,v=r,b=0,x=0;b<h.length&&x<f.length;){var w=h[b],_=f[x];if(w<_){b++;continue}if(w>_){x++;continue}w===_&&(m=y(m,v(d[b],p[x])),b++,x++)}return m}}),zLe="trace",$Le=["typed","matrix","add"],HLe=re(zLe,$Le,n=>{var{typed:e,matrix:t,add:r}=n;return e("trace",{Array:function(o){return i(t(o))},SparseMatrix:s,DenseMatrix:i,any:Ut});function i(a){var o=a._size,l=a._data;switch(o.length){case 1:if(o[0]===1)return Ut(l[0]);throw new RangeError("Matrix must be square (size: "+nn(o)+")");case 2:{var u=o[0],c=o[1];if(u===c){for(var h=0,d=0;d<u;d++)h=r(h,l[d][d]);return h}else throw new RangeError("Matrix must be square (size: "+nn(o)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+nn(o)+")")}}function s(a){var o=a._values,l=a._index,u=a._ptr,c=a._size,h=c[0],d=c[1];if(h===d){var f=0;if(o.length>0)for(var p=0;p<d;p++)for(var m=u[p],y=u[p+1],v=m;v<y;v++){var b=l[v];if(b===p){f=r(f,o[v]);break}if(b>p)break}return f}throw new RangeError("Matrix must be square (size: "+nn(c)+")")}}),fG="index",GLe=["typed","Index"],jLe=re(fG,GLe,n=>{var{typed:e,Index:t}=n;return e(fG,{"...number | string | BigNumber | Range | Array | Matrix":function(i){var s=i.map(function(o){return jt(o)?o.toNumber():Xn(o)||Dt(o)?o.map(function(l){return jt(l)?l.toNumber():l}):o}),a=new t;return t.apply(a,s),a}})}),ere=new Set(["end"]),qLe="Node",WLe=["mathWithTransform"],XLe=re(qLe,WLe,n=>{var{mathWithTransform:e}=n;function t(i){for(var s of[...ere])if(i.has(s))throw new Error('Scope contains an illegal symbol, "'+s+'" is a reserved keyword')}class r{get type(){return"Node"}get isNode(){return!0}evaluate(s){return this.compile().evaluate(s)}compile(){var s=this._compile(e,{}),a={},o=null;function l(u){var c=Ty(u);return t(c),s(c,a,o)}return{evaluate:l}}_compile(s,a){throw new Error("Method _compile must be implemented by type "+this.type)}forEach(s){throw new Error("Cannot run forEach on a Node interface")}map(s){throw new Error("Cannot run map on a Node interface")}_ifNode(s){if(!zn(s))throw new TypeError("Callback function must return a Node");return s}traverse(s){s(this,null,null);function a(o,l){o.forEach(function(u,c,h){l(u,c,h),a(u,l)})}a(this,s)}transform(s){function a(o,l,u){var c=s(o,l,u);return c!==o?c:o.map(a)}return a(this,null,null)}filter(s){var a=[];return this.traverse(function(o,l,u){s(o,l,u)&&a.push(o)}),a}clone(){throw new Error("Cannot clone a Node interface")}cloneDeep(){return this.map(function(s){return s.cloneDeep()})}equals(s){return s?this.type===s.type&&yd(this,s):!1}toString(s){var a=this._getCustomString(s);return typeof a<"u"?a:this._toString(s)}_toString(){throw new Error("_toString not implemented for "+this.type)}toJSON(){throw new Error("Cannot serialize object: toJSON not implemented by "+this.type)}toHTML(s){var a=this._getCustomString(s);return typeof a<"u"?a:this._toHTML(s)}_toHTML(){throw new Error("_toHTML not implemented for "+this.type)}toTex(s){var a=this._getCustomString(s);return typeof a<"u"?a:this._toTex(s)}_toTex(s){throw new Error("_toTex not implemented for "+this.type)}_getCustomString(s){if(s&&typeof s=="object")switch(typeof s.handler){case"object":case"undefined":return;case"function":return s.handler(this,s);default:throw new TypeError("Object or function expected as callback")}}getIdentifier(){return this.type}getContent(){return this}}return r},{isClass:!0,isNode:!0});function Ra(n){return n&&n.isIndexError?new vu(n.index+1,n.min+1,n.max!==void 0?n.max+1:void 0):n}function tre(n){var{subset:e}=n;return function(r,i){try{if(Array.isArray(r))return e(r,i);if(r&&typeof r.subset=="function")return r.subset(i);if(typeof r=="string")return e(r,i);if(typeof r=="object"){if(!i.isObjectProperty())throw new TypeError("Cannot apply a numeric index as object property");return Ea(r,i.getObjectProperty())}else throw new TypeError("Cannot apply index: unsupported type of object")}catch(s){throw Ra(s)}}}var kT="AccessorNode",KLe=["subset","Node"],YLe=re(kT,KLe,n=>{var{subset:e,Node:t}=n,r=tre({subset:e});function i(a){return!(gd(a)||fl(a)||pn(a)||Pp(a)||IN(a)||vd(a)||ss(a))}class s extends t{constructor(o,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(super(),!zn(o))throw new TypeError('Node expected for parameter "object"');if(!qb(l))throw new TypeError('IndexNode expected for parameter "index"');this.object=o,this.index=l,this.optionalChaining=u}get name(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}get type(){return kT}get isAccessorNode(){return!0}_compile(o,l){var u=this.object._compile(o,l),c=this.index._compile(o,l),h=this.optionalChaining,d=gd(this.object)&&this.object.optionalChaining;if(this.index.isObjectProperty()){var f=this.index.getObjectProperty();return function(m,y,v){var b=v||{},x=u(m,y,b);if(h&&x==null){b.optionalShortCircuit=!0;return}if(!(d&&b!==null&&b!==void 0&&b.optionalShortCircuit))return Ea(x,f)}}else return function(m,y,v){var b=v||{},x=u(m,y,b);if(h&&x==null){b.optionalShortCircuit=!0;return}if(!(d&&b!==null&&b!==void 0&&b.optionalShortCircuit)){var w=c(m,y,x);return r(x,w)}}}forEach(o){o(this.object,"object",this),o(this.index,"index",this)}map(o){return new s(this._ifNode(o(this.object,"object",this)),this._ifNode(o(this.index,"index",this)),this.optionalChaining)}clone(){return new s(this.object,this.index,this.optionalChaining)}_toString(o){var l=this.object.toString(o);i(this.object)&&(l="("+l+")");var u=this.optionalChaining?this.index.dotNotation?"?":"?.":"";return l+u+this.index.toString(o)}_toHTML(o){var l=this.object.toHTML(o);return i(this.object)&&(l='<span class="math-parenthesis math-round-parenthesis">(</span>'+l+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l+this.index.toHTML(o)}_toTex(o){var l=this.object.toTex(o);return i(this.object)&&(l="\\left(' + object + '\\right)"),l+this.index.toTex(o)}toJSON(){return{mathjs:kT,object:this.object,index:this.index,optionalChaining:this.optionalChaining}}static fromJSON(o){return new s(o.object,o.index,o.optionalChaining)}}return wi(s,"name",kT),s},{isClass:!0,isNode:!0}),BT="ArrayNode",QLe=["Node"],ZLe=re(BT,QLe,n=>{var{Node:e}=n;class t extends e{constructor(i){if(super(),this.items=i||[],!Array.isArray(this.items)||!this.items.every(zn))throw new TypeError("Array containing Nodes expected")}get type(){return BT}get isArrayNode(){return!0}_compile(i,s){var a=gp(this.items,function(u){return u._compile(i,s)}),o=i.config.matrix!=="Array";if(o){var l=i.matrix;return function(c,h,d){return l(gp(a,function(f){return f(c,h,d)}))}}else return function(c,h,d){return gp(a,function(f){return f(c,h,d)})}}forEach(i){for(var s=0;s<this.items.length;s++){var a=this.items[s];i(a,"items["+s+"]",this)}}map(i){for(var s=[],a=0;a<this.items.length;a++)s[a]=this._ifNode(i(this.items[a],"items["+a+"]",this));return new t(s)}clone(){return new t(this.items.slice(0))}_toString(i){var s=this.items.map(function(a){return a.toString(i)});return"["+s.join(", ")+"]"}toJSON(){return{mathjs:BT,items:this.items}}static fromJSON(i){return new t(i.items)}_toHTML(i){var s=this.items.map(function(a){return a.toHTML(i)});return'<span class="math-parenthesis math-square-parenthesis">[</span>'+s.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'}_toTex(i){function s(a,o){var l=a.some(fl)&&!a.every(fl),u=o||l,c=u?"&":"\\\\",h=a.map(function(d){return d.items?s(d.items,!o):d.toTex(i)}).join(c);return l||!u||u&&!o?"\\begin{bmatrix}"+h+"\\end{bmatrix}":h}return s(this.items,!1)}}return wi(t,"name",BT),t},{isClass:!0,isNode:!0});function JLe(n){var{subset:e,matrix:t}=n;return function(i,s,a){try{if(Array.isArray(i)){var o=t(i).subset(s,a).valueOf();return o.forEach((l,u)=>{i[u]=l}),i}else{if(i&&typeof i.subset=="function")return i.subset(s,a);if(typeof i=="string")return e(i,s,a);if(typeof i=="object"){if(!s.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return bb(i,s.getObjectProperty(),a),i}else throw new TypeError("Cannot apply index: unsupported type of object")}}catch(l){throw Ra(l)}}}var iu=[{AssignmentNode:{},FunctionAssignmentNode:{}},{ConditionalNode:{latexLeftParens:!1,latexRightParens:!1,latexParens:!1}},{"OperatorNode:or":{op:"or",associativity:"left",associativeWith:[]}},{"OperatorNode:xor":{op:"xor",associativity:"left",associativeWith:[]}},{"OperatorNode:and":{op:"and",associativity:"left",associativeWith:[]}},{"OperatorNode:bitOr":{op:"|",associativity:"left",associativeWith:[]}},{"OperatorNode:bitXor":{op:"^|",associativity:"left",associativeWith:[]}},{"OperatorNode:bitAnd":{op:"&",associativity:"left",associativeWith:[]}},{"OperatorNode:equal":{op:"==",associativity:"left",associativeWith:[]},"OperatorNode:unequal":{op:"!=",associativity:"left",associativeWith:[]},"OperatorNode:smaller":{op:"<",associativity:"left",associativeWith:[]},"OperatorNode:larger":{op:">",associativity:"left",associativeWith:[]},"OperatorNode:smallerEq":{op:"<=",associativity:"left",associativeWith:[]},"OperatorNode:largerEq":{op:">=",associativity:"left",associativeWith:[]},RelationalNode:{associativity:"left",associativeWith:[]}},{"OperatorNode:leftShift":{op:"<<",associativity:"left",associativeWith:[]},"OperatorNode:rightArithShift":{op:">>",associativity:"left",associativeWith:[]},"OperatorNode:rightLogShift":{op:">>>",associativity:"left",associativeWith:[]}},{"OperatorNode:to":{op:"to",associativity:"left",associativeWith:[]}},{RangeNode:{}},{"OperatorNode:add":{op:"+",associativity:"left",associativeWith:["OperatorNode:add","OperatorNode:subtract"]},"OperatorNode:subtract":{op:"-",associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{op:"*",associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]},"OperatorNode:divide":{op:"/",associativity:"left",associativeWith:[],latexLeftParens:!1,latexRightParens:!1,latexParens:!1},"OperatorNode:dotMultiply":{op:".*",associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","OperatorNode:dotMultiply","OperatorNode:doDivide"]},"OperatorNode:dotDivide":{op:"./",associativity:"left",associativeWith:[]},"OperatorNode:mod":{op:"mod",associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]}},{"OperatorNode:unaryPlus":{op:"+",associativity:"right"},"OperatorNode:unaryMinus":{op:"-",associativity:"right"},"OperatorNode:bitNot":{op:"~",associativity:"right"},"OperatorNode:not":{op:"not",associativity:"right"}},{"OperatorNode:pow":{op:"^",associativity:"right",associativeWith:[],latexRightParens:!1},"OperatorNode:dotPow":{op:".^",associativity:"right",associativeWith:[]}},{"OperatorNode:nullish":{op:"??",associativity:"left",associativeWith:[]}},{"OperatorNode:factorial":{op:"!",associativity:"left"}},{"OperatorNode:ctranspose":{op:"'",associativity:"left"}}];function UT(n,e){if(!e||e!=="auto")return n;for(var t=n;vd(t);)t=t.content;return t}function Kn(n,e,t,r){var i=n;e!=="keep"&&(i=n.getContent());for(var s=i.getIdentifier(),a=null,o=0;o<iu.length;o++)if(s in iu[o]){a=o;break}if(s==="OperatorNode:multiply"&&i.implicit&&t!=="show"){var l=UT(i.args[0],e);!(pn(l)&&r&&r.getIdentifier()==="OperatorNode:divide"&&yO(UT(r.args[0],e)))&&!(l.getIdentifier()==="OperatorNode:divide"&&yO(UT(l.args[0],e))&&pn(UT(l.args[1])))&&(a+=1)}return a}function I_(n,e){var t=n;e!=="keep"&&(t=n.getContent());var r=t.getIdentifier(),i=Kn(t,e);if(i===null)return null;var s=iu[i][r];if(vt(s,"associativity")){if(s.associativity==="left")return"left";if(s.associativity==="right")return"right";throw Error("'"+r+"' has the invalid associativity '"+s.associativity+"'.")}return null}function tP(n,e,t){var r=t!=="keep"?n.getContent():n,i=t!=="keep"?n.getContent():e,s=r.getIdentifier(),a=i.getIdentifier(),o=Kn(r,t);if(o===null)return null;var l=iu[o][s];if(vt(l,"associativeWith")&&l.associativeWith instanceof Array){for(var u=0;u<l.associativeWith.length;u++)if(l.associativeWith[u]===a)return!0;return!1}return null}function eOe(n){var e="OperatorNode:"+n;for(var t of iu)if(e in t)return t[e].op;return null}var VT="AssignmentNode",tOe=["subset","?matrix","Node"],nOe=re(VT,tOe,n=>{var{subset:e,matrix:t,Node:r}=n,i=tre({subset:e}),s=JLe({subset:e,matrix:t});function a(l,u,c){u||(u="keep");var h=Kn(l,u,c),d=Kn(l.value,u,c);return u==="all"||d!==null&&d<=h}class o extends r{constructor(u,c,h){if(super(),this.object=u,this.index=h?c:null,this.value=h||c,!ss(u)&&!gd(u))throw new TypeError('SymbolNode or AccessorNode expected as "object"');if(ss(u)&&u.name==="end")throw new Error('Cannot assign to symbol "end"');if(this.index&&!qb(this.index))throw new TypeError('IndexNode expected as "index"');if(!zn(this.value))throw new TypeError('Node expected as "value"')}get name(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}get type(){return VT}get isAssignmentNode(){return!0}_compile(u,c){var h=this.object._compile(u,c),d=this.index?this.index._compile(u,c):null,f=this.value._compile(u,c),p=this.object.name;if(this.index)if(this.index.isObjectProperty()){var m=this.index.getObjectProperty();return function(w,_,E){var A=h(w,_,E),T=f(w,_,E);return bb(A,m,T),T}}else{if(ss(this.object))return function(w,_,E){var A=h(w,_,E),T=f(w,_,E),S=d(w,_,A);return w.set(p,s(A,S,T)),T};var y=this.object.object._compile(u,c);if(this.object.index.isObjectProperty()){var v=this.object.index.getObjectProperty();return function(w,_,E){var A=y(w,_,E),T=Ea(A,v),S=d(w,_,T),M=f(w,_,E);return bb(A,v,s(T,S,M)),M}}else{var b=this.object.index._compile(u,c);return function(w,_,E){var A=y(w,_,E),T=b(w,_,A),S=i(A,T),M=d(w,_,S),D=f(w,_,E);return s(A,T,s(S,M,D)),D}}}else{if(!ss(this.object))throw new TypeError("SymbolNode expected as object");return function(w,_,E){var A=f(w,_,E);return w.set(p,A),A}}}forEach(u){u(this.object,"object",this),this.index&&u(this.index,"index",this),u(this.value,"value",this)}map(u){var c=this._ifNode(u(this.object,"object",this)),h=this.index?this._ifNode(u(this.index,"index",this)):null,d=this._ifNode(u(this.value,"value",this));return new o(c,h,d)}clone(){return new o(this.object,this.index,this.value)}_toString(u){var c=this.object.toString(u),h=this.index?this.index.toString(u):"",d=this.value.toString(u);return a(this,u&&u.parenthesis,u&&u.implicit)&&(d="("+d+")"),c+h+" = "+d}toJSON(){return{mathjs:VT,object:this.object,index:this.index,value:this.value}}static fromJSON(u){return new o(u.object,u.index,u.value)}_toHTML(u){var c=this.object.toHTML(u),h=this.index?this.index.toHTML(u):"",d=this.value.toHTML(u);return a(this,u&&u.parenthesis,u&&u.implicit)&&(d='<span class="math-paranthesis math-round-parenthesis">(</span>'+d+'<span class="math-paranthesis math-round-parenthesis">)</span>'),c+h+'<span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+d}_toTex(u){var c=this.object.toTex(u),h=this.index?this.index.toTex(u):"",d=this.value.toTex(u);return a(this,u&&u.parenthesis,u&&u.implicit)&&(d="\\left(".concat(d,"\\right)")),c+h+"="+d}}return wi(o,"name",VT),o},{isClass:!0,isNode:!0}),zT="BlockNode",rOe=["ResultSet","Node"],iOe=re(zT,rOe,n=>{var{ResultSet:e,Node:t}=n;class r extends t{constructor(s){if(super(),!Array.isArray(s))throw new Error("Array expected");this.blocks=s.map(function(a){var o=a&&a.node,l=a&&a.visible!==void 0?a.visible:!0;if(!zn(o))throw new TypeError('Property "node" must be a Node');if(typeof l!="boolean")throw new TypeError('Property "visible" must be a boolean');return{node:o,visible:l}})}get type(){return zT}get isBlockNode(){return!0}_compile(s,a){var o=gp(this.blocks,function(l){return{evaluate:l.node._compile(s,a),visible:l.visible}});return function(u,c,h){var d=[];return Ote(o,function(p){var m=p.evaluate(u,c,h);p.visible&&d.push(m)}),new e(d)}}forEach(s){for(var a=0;a<this.blocks.length;a++)s(this.blocks[a].node,"blocks["+a+"].node",this)}map(s){for(var a=[],o=0;o<this.blocks.length;o++){var l=this.blocks[o],u=this._ifNode(s(l.node,"blocks["+o+"].node",this));a[o]={node:u,visible:l.visible}}return new r(a)}clone(){var s=this.blocks.map(function(a){return{node:a.node,visible:a.visible}});return new r(s)}_toString(s){return this.blocks.map(function(a){return a.node.toString(s)+(a.visible?"":";")}).join(`
`)}toJSON(){return{mathjs:zT,blocks:this.blocks}}static fromJSON(s){return new r(s.blocks)}_toHTML(s){return this.blocks.map(function(a){return a.node.toHTML(s)+(a.visible?"":'<span class="math-separator">;</span>')}).join('<span class="math-separator"><br /></span>')}_toTex(s){return this.blocks.map(function(a){return a.node.toTex(s)+(a.visible?"":";")}).join(`\\;\\;
`)}}return wi(r,"name",zT),r},{isClass:!0,isNode:!0}),$T="ConditionalNode",sOe=["Node"],aOe=re($T,sOe,n=>{var{Node:e}=n;function t(i){if(typeof i=="number"||typeof i=="boolean"||typeof i=="string")return!!i;if(i){if(jt(i))return!i.isZero();if(Qh(i))return!!(i.re||i.im);if(No(i))return!!i.value}if(i==null)return!1;throw new TypeError('Unsupported type of condition "'+Yn(i)+'"')}class r extends e{constructor(s,a,o){if(super(),!zn(s))throw new TypeError("Parameter condition must be a Node");if(!zn(a))throw new TypeError("Parameter trueExpr must be a Node");if(!zn(o))throw new TypeError("Parameter falseExpr must be a Node");this.condition=s,this.trueExpr=a,this.falseExpr=o}get type(){return $T}get isConditionalNode(){return!0}_compile(s,a){var o=this.condition._compile(s,a),l=this.trueExpr._compile(s,a),u=this.falseExpr._compile(s,a);return function(h,d,f){return t(o(h,d,f))?l(h,d,f):u(h,d,f)}}forEach(s){s(this.condition,"condition",this),s(this.trueExpr,"trueExpr",this),s(this.falseExpr,"falseExpr",this)}map(s){return new r(this._ifNode(s(this.condition,"condition",this)),this._ifNode(s(this.trueExpr,"trueExpr",this)),this._ifNode(s(this.falseExpr,"falseExpr",this)))}clone(){return new r(this.condition,this.trueExpr,this.falseExpr)}_toString(s){var a=s&&s.parenthesis?s.parenthesis:"keep",o=Kn(this,a,s&&s.implicit),l=this.condition.toString(s),u=Kn(this.condition,a,s&&s.implicit);(a==="all"||this.condition.type==="OperatorNode"||u!==null&&u<=o)&&(l="("+l+")");var c=this.trueExpr.toString(s),h=Kn(this.trueExpr,a,s&&s.implicit);(a==="all"||this.trueExpr.type==="OperatorNode"||h!==null&&h<=o)&&(c="("+c+")");var d=this.falseExpr.toString(s),f=Kn(this.falseExpr,a,s&&s.implicit);return(a==="all"||this.falseExpr.type==="OperatorNode"||f!==null&&f<=o)&&(d="("+d+")"),l+" ? "+c+" : "+d}toJSON(){return{mathjs:$T,condition:this.condition,trueExpr:this.trueExpr,falseExpr:this.falseExpr}}static fromJSON(s){return new r(s.condition,s.trueExpr,s.falseExpr)}_toHTML(s){var a=s&&s.parenthesis?s.parenthesis:"keep",o=Kn(this,a,s&&s.implicit),l=this.condition.toHTML(s),u=Kn(this.condition,a,s&&s.implicit);(a==="all"||this.condition.type==="OperatorNode"||u!==null&&u<=o)&&(l='<span class="math-parenthesis math-round-parenthesis">(</span>'+l+'<span class="math-parenthesis math-round-parenthesis">)</span>');var c=this.trueExpr.toHTML(s),h=Kn(this.trueExpr,a,s&&s.implicit);(a==="all"||this.trueExpr.type==="OperatorNode"||h!==null&&h<=o)&&(c='<span class="math-parenthesis math-round-parenthesis">(</span>'+c+'<span class="math-parenthesis math-round-parenthesis">)</span>');var d=this.falseExpr.toHTML(s),f=Kn(this.falseExpr,a,s&&s.implicit);return(a==="all"||this.falseExpr.type==="OperatorNode"||f!==null&&f<=o)&&(d='<span class="math-parenthesis math-round-parenthesis">(</span>'+d+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l+'<span class="math-operator math-conditional-operator">?</span>'+c+'<span class="math-operator math-conditional-operator">:</span>'+d}_toTex(s){return"\\begin{cases} {"+this.trueExpr.toTex(s)+"}, &\\quad{\\text{if }\\;"+this.condition.toTex(s)+"}\\\\{"+this.falseExpr.toTex(s)+"}, &\\quad{\\text{otherwise}}\\end{cases}"}}return wi(r,"name",$T),r},{isClass:!0,isNode:!0}),OO=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},oOe={"{":"\\{","}":"\\}","\\":"\\textbackslash{}","#":"\\#",$:"\\$","%":"\\%","&":"\\&","^":"\\textasciicircum{}",_:"\\_","~":"\\textasciitilde{}"},lOe={"":"\\--","":"\\---"," ":"~","	":"\\qquad{}","\r\n":"\\newline{}","\n":"\\newline{}"},uOe=function(e,t){return OO({},e,t)},cOe=function(n){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.preserveFormatting,r=t===void 0?!1:t,i=e.escapeMapFn,s=i===void 0?uOe:i,a=String(n),o="",l=s(OO({},oOe),r?OO({},lOe):{}),u=Object.keys(l),c=function(){var d=!1;u.forEach(function(f,p){d||a.length>=f.length&&a.slice(0,f.length)===f&&(o+=l[u[p]],a=a.slice(f.length,a.length),d=!0)}),d||(o+=a.slice(0,1),a=a.slice(1,a.length))};a;)c();return o};const hOe=S2(cOe);var kO={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega",true:"\\mathrm{True}",false:"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},wn={transpose:"^\\top",ctranspose:"^H",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"\\~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},pG={abs:{1:"\\left|${args[0]}\\right|"},add:{2:"\\left(${args[0]}".concat(wn.add,"${args[1]}\\right)")},cbrt:{1:"\\sqrt[3]{${args[0]}}"},ceil:{1:"\\left\\lceil${args[0]}\\right\\rceil"},cube:{1:"\\left(${args[0]}\\right)^3"},divide:{2:"\\frac{${args[0]}}{${args[1]}}"},dotDivide:{2:"\\left(${args[0]}".concat(wn.dotDivide,"${args[1]}\\right)")},dotMultiply:{2:"\\left(${args[0]}".concat(wn.dotMultiply,"${args[1]}\\right)")},dotPow:{2:"\\left(${args[0]}".concat(wn.dotPow,"${args[1]}\\right)")},exp:{1:"\\exp\\left(${args[0]}\\right)"},expm1:"\\left(e".concat(wn.pow,"{${args[0]}}-1\\right)"),fix:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},floor:{1:"\\left\\lfloor${args[0]}\\right\\rfloor"},fraction:{2:"\\frac{${args[0]}}{${args[1]}}"},gcd:"\\gcd\\left(${args}\\right)",hypot:"\\hypot\\left(${args}\\right)",log:{1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"},log10:{1:"\\log_{10}\\left(${args[0]}\\right)"},log1p:{1:"\\ln\\left(${args[0]}+1\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}+1\\right)"},log2:"\\log_{2}\\left(${args[0]}\\right)",mod:{2:"\\left(${args[0]}".concat(wn.mod,"${args[1]}\\right)")},multiply:{2:"\\left(${args[0]}".concat(wn.multiply,"${args[1]}\\right)")},norm:{1:"\\left\\|${args[0]}\\right\\|",2:void 0},nthRoot:{2:"\\sqrt[${args[1]}]{${args[0]}}"},nthRoots:{2:"\\{y : y^${args[1]} = {${args[0]}}\\}"},pow:{2:"\\left(${args[0]}\\right)".concat(wn.pow,"{${args[1]}}")},round:{1:"\\left\\lfloor${args[0]}\\right\\rceil",2:void 0},sign:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},sqrt:{1:"\\sqrt{${args[0]}}"},square:{1:"\\left(${args[0]}\\right)^2"},subtract:{2:"\\left(${args[0]}".concat(wn.subtract,"${args[1]}\\right)")},unaryMinus:{1:"".concat(wn.unaryMinus,"\\left(${args[0]}\\right)")},unaryPlus:{1:"".concat(wn.unaryPlus,"\\left(${args[0]}\\right)")},bitAnd:{2:"\\left(${args[0]}".concat(wn.bitAnd,"${args[1]}\\right)")},bitNot:{1:wn.bitNot+"\\left(${args[0]}\\right)"},bitOr:{2:"\\left(${args[0]}".concat(wn.bitOr,"${args[1]}\\right)")},bitXor:{2:"\\left(${args[0]}".concat(wn.bitXor,"${args[1]}\\right)")},leftShift:{2:"\\left(${args[0]}".concat(wn.leftShift,"${args[1]}\\right)")},rightArithShift:{2:"\\left(${args[0]}".concat(wn.rightArithShift,"${args[1]}\\right)")},rightLogShift:{2:"\\left(${args[0]}".concat(wn.rightLogShift,"${args[1]}\\right)")},bellNumbers:{1:"\\mathrm{B}_{${args[0]}}"},catalan:{1:"\\mathrm{C}_{${args[0]}}"},stirlingS2:{2:"\\mathrm{S}\\left(${args}\\right)"},arg:{1:"\\arg\\left(${args[0]}\\right)"},conj:{1:"\\left(${args[0]}\\right)^*"},im:{1:"\\Im\\left\\lbrace${args[0]}\\right\\rbrace"},re:{1:"\\Re\\left\\lbrace${args[0]}\\right\\rbrace"},and:{2:"\\left(${args[0]}".concat(wn.and,"${args[1]}\\right)")},not:{1:wn.not+"\\left(${args[0]}\\right)"},or:{2:"\\left(${args[0]}".concat(wn.or,"${args[1]}\\right)")},xor:{2:"\\left(${args[0]}".concat(wn.xor,"${args[1]}\\right)")},cross:{2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"},ctranspose:{1:"\\left(${args[0]}\\right)".concat(wn.ctranspose)},det:{1:"\\det\\left(${args[0]}\\right)"},dot:{2:"\\left(${args[0]}\\cdot${args[1]}\\right)"},expm:{1:"\\exp\\left(${args[0]}\\right)"},inv:{1:"\\left(${args[0]}\\right)^{-1}"},pinv:{1:"\\left(${args[0]}\\right)^{+}"},sqrtm:{1:"{${args[0]}}".concat(wn.pow,"{\\frac{1}{2}}")},trace:{1:"\\mathrm{tr}\\left(${args[0]}\\right)"},transpose:{1:"\\left(${args[0]}\\right)".concat(wn.transpose)},combinations:{2:"\\binom{${args[0]}}{${args[1]}}"},combinationsWithRep:{2:"\\left(\\!\\!{\\binom{${args[0]}}{${args[1]}}}\\!\\!\\right)"},factorial:{1:"\\left(${args[0]}\\right)".concat(wn.factorial)},gamma:{1:"\\Gamma\\left(${args[0]}\\right)"},lgamma:{1:"\\ln\\Gamma\\left(${args[0]}\\right)"},equal:{2:"\\left(${args[0]}".concat(wn.equal,"${args[1]}\\right)")},larger:{2:"\\left(${args[0]}".concat(wn.larger,"${args[1]}\\right)")},largerEq:{2:"\\left(${args[0]}".concat(wn.largerEq,"${args[1]}\\right)")},smaller:{2:"\\left(${args[0]}".concat(wn.smaller,"${args[1]}\\right)")},smallerEq:{2:"\\left(${args[0]}".concat(wn.smallerEq,"${args[1]}\\right)")},unequal:{2:"\\left(${args[0]}".concat(wn.unequal,"${args[1]}\\right)")},erf:{1:"erf\\left(${args[0]}\\right)"},max:"\\max\\left(${args}\\right)",min:"\\min\\left(${args}\\right)",variance:"\\mathrm{Var}\\left(${args}\\right)",acos:{1:"\\cos^{-1}\\left(${args[0]}\\right)"},acosh:{1:"\\cosh^{-1}\\left(${args[0]}\\right)"},acot:{1:"\\cot^{-1}\\left(${args[0]}\\right)"},acoth:{1:"\\coth^{-1}\\left(${args[0]}\\right)"},acsc:{1:"\\csc^{-1}\\left(${args[0]}\\right)"},acsch:{1:"\\mathrm{csch}^{-1}\\left(${args[0]}\\right)"},asec:{1:"\\sec^{-1}\\left(${args[0]}\\right)"},asech:{1:"\\mathrm{sech}^{-1}\\left(${args[0]}\\right)"},asin:{1:"\\sin^{-1}\\left(${args[0]}\\right)"},asinh:{1:"\\sinh^{-1}\\left(${args[0]}\\right)"},atan:{1:"\\tan^{-1}\\left(${args[0]}\\right)"},atan2:{2:"\\mathrm{atan2}\\left(${args}\\right)"},atanh:{1:"\\tanh^{-1}\\left(${args[0]}\\right)"},cos:{1:"\\cos\\left(${args[0]}\\right)"},cosh:{1:"\\cosh\\left(${args[0]}\\right)"},cot:{1:"\\cot\\left(${args[0]}\\right)"},coth:{1:"\\coth\\left(${args[0]}\\right)"},csc:{1:"\\csc\\left(${args[0]}\\right)"},csch:{1:"\\mathrm{csch}\\left(${args[0]}\\right)"},sec:{1:"\\sec\\left(${args[0]}\\right)"},sech:{1:"\\mathrm{sech}\\left(${args[0]}\\right)"},sin:{1:"\\sin\\left(${args[0]}\\right)"},sinh:{1:"\\sinh\\left(${args[0]}\\right)"},tan:{1:"\\tan\\left(${args[0]}\\right)"},tanh:{1:"\\tanh\\left(${args[0]}\\right)"},to:{2:"\\left(${args[0]}".concat(wn.to,"${args[1]}\\right)")},numeric:function(e,t){return e.args[0].toTex()},number:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},string:{0:'\\mathtt{""}',1:"\\mathrm{string}\\left(${args[0]}\\right)"},bignumber:{0:"0",1:"\\left(${args[0]}\\right)"},bigint:{0:"0",1:"\\left(${args[0]}\\right)"},complex:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)+".concat(kO.i,"\\cdot\\left(${args[1]}\\right)\\right)")},matrix:{0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},sparse:{0:"\\begin{bsparse}\\end{bsparse}",1:"\\left(${args[0]}\\right)"},unit:{1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"}},dOe="\\mathrm{${name}}\\left(${args}\\right)",mG={deg:"^\\circ"};function BO(n){return hOe(n,{preserveFormatting:!0})}function nre(n,e){return e=typeof e>"u"?!1:e,e?vt(mG,n)?mG[n]:"\\mathrm{"+BO(n)+"}":vt(kO,n)?kO[n]:BO(n)}var HT="ConstantNode",fOe=["Node","isBounded"],pOe=re(HT,fOe,n=>{var{Node:e,isBounded:t}=n;class r extends e{constructor(s){super(),this.value=s}get type(){return HT}get isConstantNode(){return!0}_compile(s,a){var o=this.value;return function(){return o}}forEach(s){}map(s){return this.clone()}clone(){return new r(this.value)}_toString(s){return nn(this.value,s)}_toHTML(s){var a=this._toString(s);switch(Yn(this.value)){case"number":case"bigint":case"BigNumber":case"Fraction":return'<span class="math-number">'+a+"</span>";case"string":return'<span class="math-string">'+a+"</span>";case"boolean":return'<span class="math-boolean">'+a+"</span>";case"null":return'<span class="math-null-symbol">'+a+"</span>";case"undefined":return'<span class="math-undefined">'+a+"</span>";default:return'<span class="math-symbol">'+a+"</span>"}}toJSON(){return{mathjs:HT,value:this.value}}static fromJSON(s){return new r(s.value)}_toTex(s){var a=this._toString(s),o=Yn(this.value);switch(o){case"string":return"\\mathtt{"+BO(a)+"}";case"number":case"BigNumber":{if(!t(this.value))return this.value.valueOf()<0?"-\\infty":"\\infty";var l=a.toLowerCase().indexOf("e");return l!==-1?a.substring(0,l)+"\\cdot10^{"+a.substring(l+1)+"}":a}case"bigint":return a.toString();case"Fraction":return this.value.toLatex();default:return a}}}return wi(r,"name",HT),r},{isClass:!0,isNode:!0}),GT="FunctionAssignmentNode",mOe=["typed","Node"],gOe=re(GT,mOe,n=>{var{typed:e,Node:t}=n;function r(s,a,o){var l=Kn(s,a,o),u=Kn(s.expr,a,o);return a==="all"||u!==null&&u<=l}class i extends t{constructor(a,o,l){if(super(),typeof a!="string")throw new TypeError('String expected for parameter "name"');if(!Array.isArray(o))throw new TypeError('Array containing strings or objects expected for parameter "params"');if(!zn(l))throw new TypeError('Node expected for parameter "expr"');if(ere.has(a))throw new Error('Illegal function name, "'+a+'" is a reserved keyword');var u=new Set;for(var c of o){var h=typeof c=="string"?c:c.name;if(u.has(h))throw new Error('Duplicate parameter name "'.concat(h,'"'));u.add(h)}this.name=a,this.params=o.map(function(d){return d&&d.name||d}),this.types=o.map(function(d){return d&&d.type||"any"}),this.expr=l}get type(){return GT}get isFunctionAssignmentNode(){return!0}_compile(a,o){var l=Object.create(o);Ote(this.params,function(m){l[m]=!0});var u=this.expr,c=u._compile(a,l),h=this.name,d=this.params,f=d$(this.types,","),p=h+"("+d$(this.params,", ")+")";return function(y,v,b){var x={};x[f]=function(){for(var _=Object.create(v),E=0;E<d.length;E++)_[d[E]]=arguments[E];return c(y,_,b)};var w=e(h,x);return w.syntax=p,w.expr=u.toString(),y.set(h,w),w}}forEach(a){a(this.expr,"expr",this)}map(a){var o=this._ifNode(a(this.expr,"expr",this));return new i(this.name,this.params.slice(0),o)}clone(){return new i(this.name,this.params.slice(0),this.expr)}_toString(a){var o=a&&a.parenthesis?a.parenthesis:"keep",l=this.expr.toString(a);return r(this,o,a&&a.implicit)&&(l="("+l+")"),this.name+"("+this.params.join(", ")+") = "+l}toJSON(){var a=this.types;return{mathjs:GT,name:this.name,params:this.params.map(function(o,l){return{name:o,type:a[l]}}),expr:this.expr}}static fromJSON(a){return new i(a.name,a.params,a.expr)}_toHTML(a){for(var o=a&&a.parenthesis?a.parenthesis:"keep",l=[],u=0;u<this.params.length;u++)l.push('<span class="math-symbol math-parameter">'+vl(this.params[u])+"</span>");var c=this.expr.toHTML(a);return r(this,o,a&&a.implicit)&&(c='<span class="math-parenthesis math-round-parenthesis">(</span>'+c+'<span class="math-parenthesis math-round-parenthesis">)</span>'),'<span class="math-function">'+vl(this.name)+'</span><span class="math-parenthesis math-round-parenthesis">(</span>'+l.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-round-parenthesis">)</span><span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+c}_toTex(a){var o=a&&a.parenthesis?a.parenthesis:"keep",l=this.expr.toTex(a);return r(this,o,a&&a.implicit)&&(l="\\left(".concat(l,"\\right)")),"\\mathrm{"+this.name+"}\\left("+this.params.map(nre).join(",")+"\\right)="+l}}return wi(i,"name",GT),i},{isClass:!0,isNode:!0}),jT="IndexNode",vOe=["Node","size"],yOe=re(jT,vOe,n=>{var{Node:e,size:t}=n;class r extends e{constructor(s,a){if(super(),this.dimensions=s,this.dotNotation=a||!1,!Array.isArray(s)||!s.every(zn))throw new TypeError('Array containing Nodes expected for parameter "dimensions"');if(this.dotNotation&&!this.isObjectProperty())throw new Error("dotNotation only applicable for object properties")}get type(){return jT}get isIndexNode(){return!0}_compile(s,a){var o=gp(this.dimensions,function(u,c){var h=u.filter(p=>p.isSymbolNode&&p.name==="end").length>0;if(h){var d=Object.create(a);d.end=!0;var f=u._compile(s,d);return function(m,y,v){if(!Dt(v)&&!Xn(v)&&!Jr(v))throw new TypeError('Cannot resolve "end": context must be a Matrix, Array, or string but is '+Yn(v));var b=t(v),x=Object.create(y);return x.end=b[c],f(m,x,v)}}else return u._compile(s,a)}),l=Ea(s,"index");return function(c,h,d){var f=gp(o,function(p){return p(c,h,d)});return l(...f)}}forEach(s){for(var a=0;a<this.dimensions.length;a++)s(this.dimensions[a],"dimensions["+a+"]",this)}map(s){for(var a=[],o=0;o<this.dimensions.length;o++)a[o]=this._ifNode(s(this.dimensions[o],"dimensions["+o+"]",this));return new r(a,this.dotNotation)}clone(){return new r(this.dimensions.slice(0),this.dotNotation)}isObjectProperty(){return this.dimensions.length===1&&pn(this.dimensions[0])&&typeof this.dimensions[0].value=="string"}getObjectProperty(){return this.isObjectProperty()?this.dimensions[0].value:null}_toString(s){return this.dotNotation?"."+this.getObjectProperty():"["+this.dimensions.join(", ")+"]"}toJSON(){return{mathjs:jT,dimensions:this.dimensions,dotNotation:this.dotNotation}}static fromJSON(s){return new r(s.dimensions,s.dotNotation)}_toHTML(s){for(var a=[],o=0;o<this.dimensions.length;o++)a[o]=this.dimensions[o].toHTML();return this.dotNotation?'<span class="math-operator math-accessor-operator">.</span><span class="math-symbol math-property">'+vl(this.getObjectProperty())+"</span>":'<span class="math-parenthesis math-square-parenthesis">[</span>'+a.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'}_toTex(s){var a=this.dimensions.map(function(o){return o.toTex(s)});return this.dotNotation?"."+this.getObjectProperty():"_{"+a.join(",")+"}"}}return wi(r,"name",jT),r},{isClass:!0,isNode:!0}),qT="ObjectNode",xOe=["Node"],bOe=re(qT,xOe,n=>{var{Node:e}=n;class t extends e{constructor(i){if(super(),this.properties=i||{},i&&(typeof i!="object"||!Object.keys(i).every(function(s){return zn(i[s])})))throw new TypeError("Object containing Nodes expected")}get type(){return qT}get isObjectNode(){return!0}_compile(i,s){var a={};for(var o in this.properties)if(vt(this.properties,o)){var l=oy(o),u=JSON.parse(l),c=Ea(this.properties,o);a[u]=c._compile(i,s)}return function(d,f,p){var m={};for(var y in a)vt(a,y)&&(m[y]=a[y](d,f,p));return m}}forEach(i){for(var s in this.properties)vt(this.properties,s)&&i(this.properties[s],"properties["+oy(s)+"]",this)}map(i){var s={};for(var a in this.properties)vt(this.properties,a)&&(s[a]=this._ifNode(i(this.properties[a],"properties["+oy(a)+"]",this)));return new t(s)}clone(){var i={};for(var s in this.properties)vt(this.properties,s)&&(i[s]=this.properties[s]);return new t(i)}_toString(i){var s=[];for(var a in this.properties)vt(this.properties,a)&&s.push(oy(a)+": "+this.properties[a].toString(i));return"{"+s.join(", ")+"}"}toJSON(){return{mathjs:qT,properties:this.properties}}static fromJSON(i){return new t(i.properties)}_toHTML(i){var s=[];for(var a in this.properties)vt(this.properties,a)&&s.push('<span class="math-symbol math-property">'+vl(a)+'</span><span class="math-operator math-assignment-operator math-property-assignment-operator math-binary-operator">:</span>'+this.properties[a].toHTML(i));return'<span class="math-parenthesis math-curly-parenthesis">{</span>'+s.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-curly-parenthesis">}</span>'}_toTex(i){var s=[];for(var a in this.properties)vt(this.properties,a)&&s.push("\\mathbf{"+a+":} & "+this.properties[a].toTex(i)+"\\\\");var o="\\left\\{\\begin{array}{ll}"+s.join(`
`)+"\\end{array}\\right\\}";return o}}return wi(t,"name",qT),t},{isClass:!0,isNode:!0});function m1(n,e){return new ote(n,new DN(e),new Set(Object.keys(e)))}var WT="OperatorNode",_Oe=["Node"],wOe=re(WT,_Oe,n=>{var{Node:e}=n;function t(s,a){var o=s;if(a==="auto")for(;vd(o);)o=o.content;return pn(o)?!0:ai(o)?t(o.args[0],a):!1}function r(s,a,o,l,u){var c=Kn(s,a,o),h=I_(s,a);if(a==="all"||l.length>2&&s.getIdentifier()!=="OperatorNode:add"&&s.getIdentifier()!=="OperatorNode:multiply")return l.map(function(M){switch(M.getContent().type){case"ArrayNode":case"ConstantNode":case"SymbolNode":case"ParenthesisNode":return!1;default:return!0}});var d;switch(l.length){case 0:d=[];break;case 1:{var f=Kn(l[0],a,o,s);if(u&&f!==null){var p,m;if(a==="keep"?(p=l[0].getIdentifier(),m=s.getIdentifier()):(p=l[0].getContent().getIdentifier(),m=s.getContent().getIdentifier()),iu[c][m].latexLeftParens===!1){d=[!1];break}if(iu[f][p].latexParens===!1){d=[!1];break}}if(f===null){d=[!1];break}if(f<=c){d=[!0];break}d=[!1]}break;case 2:{var y,v=Kn(l[0],a,o,s),b=tP(s,l[0],a);v===null?y=!1:v===c&&h==="right"&&!b||v<c?y=!0:y=!1;var x,w=Kn(l[1],a,o,s),_=tP(s,l[1],a);if(w===null?x=!1:w===c&&h==="left"&&!_||w<c?x=!0:x=!1,u){var E,A,T;a==="keep"?(E=s.getIdentifier(),A=s.args[0].getIdentifier(),T=s.args[1].getIdentifier()):(E=s.getContent().getIdentifier(),A=s.args[0].getContent().getIdentifier(),T=s.args[1].getContent().getIdentifier()),v!==null&&(iu[c][E].latexLeftParens===!1&&(y=!1),iu[v][A].latexParens===!1&&(y=!1)),w!==null&&(iu[c][E].latexRightParens===!1&&(x=!1),iu[w][T].latexParens===!1&&(x=!1))}d=[y,x]}break;default:(s.getIdentifier()==="OperatorNode:add"||s.getIdentifier()==="OperatorNode:multiply")&&(d=l.map(function(M){var D=Kn(M,a,o,s),N=tP(s,M,a),R=I_(M,a);return D===null?!1:c===D&&h===R&&!N?!0:D<c}));break}if(l.length>=2&&s.getIdentifier()==="OperatorNode:multiply"&&s.implicit&&a!=="all"&&o==="hide")for(var S=1;S<d.length;++S)t(l[S],a)&&!d[S-1]&&(a!=="keep"||!vd(l[S-1]))&&(d[S]=!0);return d}class i extends e{constructor(a,o,l,u,c){if(super(),typeof a!="string")throw new TypeError('string expected for parameter "op"');if(typeof o!="string")throw new TypeError('string expected for parameter "fn"');if(!Array.isArray(l)||!l.every(zn))throw new TypeError('Array containing Nodes expected for parameter "args"');this.implicit=u===!0,this.isPercentage=c===!0,this.op=a,this.fn=o,this.args=l||[]}get type(){return WT}get isOperatorNode(){return!0}_compile(a,o){if(typeof this.fn!="string"||!W4(a,this.fn))throw a[this.fn]?new Error('No access to function "'+this.fn+'"'):new Error("Function "+this.fn+' missing in provided namespace "math"');var l=Ea(a,this.fn),u=gp(this.args,function(p){return p._compile(a,o)});if(typeof l=="function"&&l.rawArgs===!0){var c=this.args;return function(m,y,v){return l(c,a,m1(m,y))}}else if(u.length===1){var h=u[0];return function(m,y,v){return l(h(m,y,v))}}else if(u.length===2){var d=u[0],f=u[1];return function(m,y,v){return l(d(m,y,v),f(m,y,v))}}else return function(m,y,v){return l.apply(null,gp(u,function(b){return b(m,y,v)}))}}forEach(a){for(var o=0;o<this.args.length;o++)a(this.args[o],"args["+o+"]",this)}map(a){for(var o=[],l=0;l<this.args.length;l++)o[l]=this._ifNode(a(this.args[l],"args["+l+"]",this));return new i(this.op,this.fn,o,this.implicit,this.isPercentage)}clone(){return new i(this.op,this.fn,this.args.slice(0),this.implicit,this.isPercentage)}isUnary(){return this.args.length===1}isBinary(){return this.args.length===2}_toString(a){var o=a&&a.parenthesis?a.parenthesis:"keep",l=a&&a.implicit?a.implicit:"hide",u=this.args,c=r(this,o,l,u,!1);if(u.length===1){var h=I_(this,o),d=u[0].toString(a);c[0]&&(d="("+d+")");var f=/[a-zA-Z]+/.test(this.op);return h==="right"?this.op+(f?" ":"")+d:h==="left"?d+(f?" ":"")+this.op:d+this.op}else if(u.length===2){var p=u[0].toString(a),m=u[1].toString(a);return c[0]&&(p="("+p+")"),c[1]&&(m="("+m+")"),this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&l==="hide"?p+" "+m:p+" "+this.op+" "+m}else if(u.length>2&&(this.getIdentifier()==="OperatorNode:add"||this.getIdentifier()==="OperatorNode:multiply")){var y=u.map(function(v,b){return v=v.toString(a),c[b]&&(v="("+v+")"),v});return this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&l==="hide"?y.join(" "):y.join(" "+this.op+" ")}else return this.fn+"("+this.args.join(", ")+")"}toJSON(){return{mathjs:WT,op:this.op,fn:this.fn,args:this.args,implicit:this.implicit,isPercentage:this.isPercentage}}static fromJSON(a){return new i(a.op,a.fn,a.args,a.implicit,a.isPercentage)}_toHTML(a){var o=a&&a.parenthesis?a.parenthesis:"keep",l=a&&a.implicit?a.implicit:"hide",u=this.args,c=r(this,o,l,u,!1);if(u.length===1){var h=I_(this,o),d=u[0].toHTML(a);return c[0]&&(d='<span class="math-parenthesis math-round-parenthesis">(</span>'+d+'<span class="math-parenthesis math-round-parenthesis">)</span>'),h==="right"?'<span class="math-operator math-unary-operator math-lefthand-unary-operator">'+vl(this.op)+"</span>"+d:d+'<span class="math-operator math-unary-operator math-righthand-unary-operator">'+vl(this.op)+"</span>"}else if(u.length===2){var f=u[0].toHTML(a),p=u[1].toHTML(a);return c[0]&&(f='<span class="math-parenthesis math-round-parenthesis">(</span>'+f+'<span class="math-parenthesis math-round-parenthesis">)</span>'),c[1]&&(p='<span class="math-parenthesis math-round-parenthesis">(</span>'+p+'<span class="math-parenthesis math-round-parenthesis">)</span>'),this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&l==="hide"?f+'<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'+p:f+'<span class="math-operator math-binary-operator math-explicit-binary-operator">'+vl(this.op)+"</span>"+p}else{var m=u.map(function(y,v){return y=y.toHTML(a),c[v]&&(y='<span class="math-parenthesis math-round-parenthesis">(</span>'+y+'<span class="math-parenthesis math-round-parenthesis">)</span>'),y});return u.length>2&&(this.getIdentifier()==="OperatorNode:add"||this.getIdentifier()==="OperatorNode:multiply")?this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&l==="hide"?m.join('<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'):m.join('<span class="math-operator math-binary-operator math-explicit-binary-operator">'+vl(this.op)+"</span>"):'<span class="math-function">'+vl(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+m.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}}_toTex(a){var o=a&&a.parenthesis?a.parenthesis:"keep",l=a&&a.implicit?a.implicit:"hide",u=this.args,c=r(this,o,l,u,!0),h=wn[this.fn];if(h=typeof h>"u"?this.op:h,u.length===1){var d=I_(this,o),f=u[0].toTex(a);return c[0]&&(f="\\left(".concat(f,"\\right)")),d==="right"?h+f:f+h}else if(u.length===2){var p=u[0],m=p.toTex(a);c[0]&&(m="\\left(".concat(m,"\\right)"));var y=u[1],v=y.toTex(a);c[1]&&(v="\\left(".concat(v,"\\right)"));var b;switch(o==="keep"?b=p.getIdentifier():b=p.getContent().getIdentifier(),this.getIdentifier()){case"OperatorNode:divide":return h+"{"+m+"}{"+v+"}";case"OperatorNode:pow":switch(m="{"+m+"}",v="{"+v+"}",b){case"ConditionalNode":case"OperatorNode:divide":m="\\left(".concat(m,"\\right)")}break;case"OperatorNode:multiply":if(this.implicit&&l==="hide")return m+"~"+v}return m+h+v}else if(u.length>2&&(this.getIdentifier()==="OperatorNode:add"||this.getIdentifier()==="OperatorNode:multiply")){var x=u.map(function(w,_){return w=w.toTex(a),c[_]&&(w="\\left(".concat(w,"\\right)")),w});return this.getIdentifier()==="OperatorNode:multiply"&&this.implicit&&l==="hide"?x.join("~"):x.join(h)}else return"\\mathrm{"+this.fn+"}\\left("+u.map(function(w){return w.toTex(a)}).join(",")+"\\right)"}getIdentifier(){return this.type+":"+this.fn}}return wi(i,"name",WT),i},{isClass:!0,isNode:!0}),XT="ParenthesisNode",EOe=["Node"],SOe=re(XT,EOe,n=>{var{Node:e}=n;class t extends e{constructor(i){if(super(),!zn(i))throw new TypeError('Node expected for parameter "content"');this.content=i}get type(){return XT}get isParenthesisNode(){return!0}_compile(i,s){return this.content._compile(i,s)}getContent(){return this.content.getContent()}forEach(i){i(this.content,"content",this)}map(i){var s=i(this.content,"content",this);return new t(s)}clone(){return new t(this.content)}_toString(i){return!i||i&&!i.parenthesis||i&&i.parenthesis==="keep"?"("+this.content.toString(i)+")":this.content.toString(i)}toJSON(){return{mathjs:XT,content:this.content}}static fromJSON(i){return new t(i.content)}_toHTML(i){return!i||i&&!i.parenthesis||i&&i.parenthesis==="keep"?'<span class="math-parenthesis math-round-parenthesis">(</span>'+this.content.toHTML(i)+'<span class="math-parenthesis math-round-parenthesis">)</span>':this.content.toHTML(i)}_toTex(i){return!i||i&&!i.parenthesis||i&&i.parenthesis==="keep"?"\\left(".concat(this.content.toTex(i),"\\right)"):this.content.toTex(i)}}return wi(t,"name",XT),t},{isClass:!0,isNode:!0}),KT="RangeNode",AOe=["Node"],TOe=re(KT,AOe,n=>{var{Node:e}=n;function t(i,s,a){var o=Kn(i,s,a),l={},u=Kn(i.start,s,a);if(l.start=u!==null&&u<=o||s==="all",i.step){var c=Kn(i.step,s,a);l.step=c!==null&&c<=o||s==="all"}var h=Kn(i.end,s,a);return l.end=h!==null&&h<=o||s==="all",l}class r extends e{constructor(s,a,o){if(super(),!zn(s))throw new TypeError("Node expected");if(!zn(a))throw new TypeError("Node expected");if(o&&!zn(o))throw new TypeError("Node expected");if(arguments.length>3)throw new Error("Too many arguments");this.start=s,this.end=a,this.step=o||null}get type(){return KT}get isRangeNode(){return!0}needsEnd(){var s=this.filter(function(a){return ss(a)&&a.name==="end"});return s.length>0}_compile(s,a){var o=s.range,l=this.start._compile(s,a),u=this.end._compile(s,a);if(this.step){var c=this.step._compile(s,a);return function(d,f,p){return o(l(d,f,p),u(d,f,p),c(d,f,p))}}else return function(d,f,p){return o(l(d,f,p),u(d,f,p))}}forEach(s){s(this.start,"start",this),s(this.end,"end",this),this.step&&s(this.step,"step",this)}map(s){return new r(this._ifNode(s(this.start,"start",this)),this._ifNode(s(this.end,"end",this)),this.step&&this._ifNode(s(this.step,"step",this)))}clone(){return new r(this.start,this.end,this.step&&this.step)}_toString(s){var a=s&&s.parenthesis?s.parenthesis:"keep",o=t(this,a,s&&s.implicit),l,u=this.start.toString(s);if(o.start&&(u="("+u+")"),l=u,this.step){var c=this.step.toString(s);o.step&&(c="("+c+")"),l+=":"+c}var h=this.end.toString(s);return o.end&&(h="("+h+")"),l+=":"+h,l}toJSON(){return{mathjs:KT,start:this.start,end:this.end,step:this.step}}static fromJSON(s){return new r(s.start,s.end,s.step)}_toHTML(s){var a=s&&s.parenthesis?s.parenthesis:"keep",o=t(this,a,s&&s.implicit),l,u=this.start.toHTML(s);if(o.start&&(u='<span class="math-parenthesis math-round-parenthesis">(</span>'+u+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l=u,this.step){var c=this.step.toHTML(s);o.step&&(c='<span class="math-parenthesis math-round-parenthesis">(</span>'+c+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l+='<span class="math-operator math-range-operator">:</span>'+c}var h=this.end.toHTML(s);return o.end&&(h='<span class="math-parenthesis math-round-parenthesis">(</span>'+h+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l+='<span class="math-operator math-range-operator">:</span>'+h,l}_toTex(s){var a=s&&s.parenthesis?s.parenthesis:"keep",o=t(this,a,s&&s.implicit),l=this.start.toTex(s);if(o.start&&(l="\\left(".concat(l,"\\right)")),this.step){var u=this.step.toTex(s);o.step&&(u="\\left(".concat(u,"\\right)")),l+=":"+u}var c=this.end.toTex(s);return o.end&&(c="\\left(".concat(c,"\\right)")),l+=":"+c,l}}return wi(r,"name",KT),r},{isClass:!0,isNode:!0}),YT="RelationalNode",MOe=["Node"],COe=re(YT,MOe,n=>{var{Node:e}=n,t={equal:"==",unequal:"!=",smaller:"<",larger:">",smallerEq:"<=",largerEq:">="};class r extends e{constructor(s,a){if(super(),!Array.isArray(s))throw new TypeError("Parameter conditionals must be an array");if(!Array.isArray(a))throw new TypeError("Parameter params must be an array");if(s.length!==a.length-1)throw new TypeError("Parameter params must contain exactly one more element than parameter conditionals");this.conditionals=s,this.params=a}get type(){return YT}get isRelationalNode(){return!0}_compile(s,a){var o=this,l=this.params.map(u=>u._compile(s,a));return function(c,h,d){for(var f,p=l[0](c,h,d),m=0;m<o.conditionals.length;m++){f=p,p=l[m+1](c,h,d);var y=Ea(s,o.conditionals[m]);if(!y(f,p))return!1}return!0}}forEach(s){this.params.forEach((a,o)=>s(a,"params["+o+"]",this),this)}map(s){return new r(this.conditionals.slice(),this.params.map((a,o)=>this._ifNode(s(a,"params["+o+"]",this)),this))}clone(){return new r(this.conditionals,this.params)}_toString(s){for(var a=s&&s.parenthesis?s.parenthesis:"keep",o=Kn(this,a,s&&s.implicit),l=this.params.map(function(h,d){var f=Kn(h,a,s&&s.implicit);return a==="all"||f!==null&&f<=o?"("+h.toString(s)+")":h.toString(s)}),u=l[0],c=0;c<this.conditionals.length;c++)u+=" "+t[this.conditionals[c]],u+=" "+l[c+1];return u}toJSON(){return{mathjs:YT,conditionals:this.conditionals,params:this.params}}static fromJSON(s){return new r(s.conditionals,s.params)}_toHTML(s){for(var a=s&&s.parenthesis?s.parenthesis:"keep",o=Kn(this,a,s&&s.implicit),l=this.params.map(function(h,d){var f=Kn(h,a,s&&s.implicit);return a==="all"||f!==null&&f<=o?'<span class="math-parenthesis math-round-parenthesis">(</span>'+h.toHTML(s)+'<span class="math-parenthesis math-round-parenthesis">)</span>':h.toHTML(s)}),u=l[0],c=0;c<this.conditionals.length;c++)u+='<span class="math-operator math-binary-operator math-explicit-binary-operator">'+vl(t[this.conditionals[c]])+"</span>"+l[c+1];return u}_toTex(s){for(var a=s&&s.parenthesis?s.parenthesis:"keep",o=Kn(this,a,s&&s.implicit),l=this.params.map(function(h,d){var f=Kn(h,a,s&&s.implicit);return a==="all"||f!==null&&f<=o?"\\left("+h.toTex(s)+"\right)":h.toTex(s)}),u=l[0],c=0;c<this.conditionals.length;c++)u+=wn[this.conditionals[c]]+l[c+1];return u}}return wi(r,"name",YT),r},{isClass:!0,isNode:!0}),DOe="SymbolNode",NOe=["math","?Unit","Node"],ROe=re(DOe,NOe,n=>{var{math:e,Unit:t,Node:r}=n;function i(a){return t?t.isValuelessUnit(a):!1}class s extends r{constructor(o){if(super(),typeof o!="string")throw new TypeError('String expected for parameter "name"');this.name=o}get type(){return"SymbolNode"}get isSymbolNode(){return!0}_compile(o,l){var u=this.name;if(l[u]===!0)return function(h,d,f){return Ea(d,u)};if(u in o)return function(h,d,f){return h.has(u)?h.get(u):Ea(o,u)};var c=i(u);return function(h,d,f){return h.has(u)?h.get(u):c?new t(null,u):s.onUndefinedSymbol(u)}}forEach(o){}map(o){return this.clone()}static onUndefinedSymbol(o){throw new Error("Undefined symbol "+o)}clone(){return new s(this.name)}_toString(o){return this.name}_toHTML(o){var l=vl(this.name);return l==="true"||l==="false"?'<span class="math-symbol math-boolean">'+l+"</span>":l==="i"?'<span class="math-symbol math-imaginary-symbol">'+l+"</span>":l==="Infinity"?'<span class="math-symbol math-infinity-symbol">'+l+"</span>":l==="NaN"?'<span class="math-symbol math-nan-symbol">'+l+"</span>":l==="null"?'<span class="math-symbol math-null-symbol">'+l+"</span>":l==="undefined"?'<span class="math-symbol math-undefined-symbol">'+l+"</span>":'<span class="math-symbol">'+l+"</span>"}toJSON(){return{mathjs:"SymbolNode",name:this.name}}static fromJSON(o){return new s(o.name)}_toTex(o){var l=!1;typeof e[this.name]>"u"&&i(this.name)&&(l=!0);var u=nre(this.name,l);return u[0]==="\\"?u:" "+u}}return s},{isClass:!0,isNode:!0}),QT="FunctionNode",IOe=["math","Node","SymbolNode"],POe=re(QT,IOe,n=>{var e,{math:t,Node:r,SymbolNode:i}=n,s=l=>nn(l,{truncate:78});function a(l,u,c){for(var h="",d=/\$(?:\{([a-z_][a-z_0-9]*)(?:\[([0-9]+)\])?\}|\$)/gi,f=0,p;(p=d.exec(l))!==null;)if(h+=l.substring(f,p.index),f=p.index,p[0]==="$$")h+="$",f++;else{f+=p[0].length;var m=u[p[1]];if(!m)throw new ReferenceError("Template: Property "+p[1]+" does not exist.");if(p[2]===void 0)switch(typeof m){case"string":h+=m;break;case"object":if(zn(m))h+=m.toTex(c);else if(Array.isArray(m))h+=m.map(function(y,v){if(zn(y))return y.toTex(c);throw new TypeError("Template: "+p[1]+"["+v+"] is not a Node.")}).join(",");else throw new TypeError("Template: "+p[1]+" has to be a Node, String or array of Nodes");break;default:throw new TypeError("Template: "+p[1]+" has to be a Node, String or array of Nodes")}else if(zn(m[p[2]]&&m[p[2]]))h+=m[p[2]].toTex(c);else throw new TypeError("Template: "+p[1]+"["+p[2]+"] is not a Node.")}return h+=l.slice(f),h}class o extends r{constructor(u,c,h){if(super(),typeof u=="string"&&(u=new i(u)),!zn(u))throw new TypeError('Node expected as parameter "fn"');if(!Array.isArray(c)||!c.every(zn))throw new TypeError('Array containing Nodes expected for parameter "args"');var d=typeof h;if(!(d==="undefined"||d==="boolean"))throw new TypeError("optional flag, if specified, must be boolean");this.fn=u,this.args=c||[],this.optional=!!h}get name(){return this.fn.name||""}get type(){return QT}get isFunctionNode(){return!0}_compile(u,c){var h=this.args.map(S=>S._compile(u,c)),d=this.optional||gd(this.fn)&&this.fn.optionalChaining;if(ss(this.fn)){var f=this.fn.name;if(c[f]){var b=this.args;return function(M,D,N){var R=Ea(D,f);if(!(d&&R===void 0)){if(typeof R!="function")throw new TypeError("Argument '".concat(f,"' was not a function; received: ").concat(s(R)));if(R.rawArgs)return R(b,u,m1(M,D));var O=h.map(G=>G(M,D,N));return R.apply(R,O)}}}else{var p=f in u?Ea(u,f):void 0,m=typeof p=="function"&&p.rawArgs===!0,y=S=>{var M;if(S.has(f))M=S.get(f);else if(f in u)M=Ea(u,f);else if(d)M=void 0;else return o.onUndefinedFunction(f);if(typeof M=="function"||d&&M===void 0)return M;throw new TypeError("'".concat(f,`' is not a function; its value is:
  `).concat(s(M)))};if(m){var v=this.args;return function(M,D,N){var R=y(M);if(R.rawArgs===!0)return R(v,u,m1(M,D));var O=h.map(G=>G(M,D,N));return R(...O)}}else switch(h.length){case 0:return function(M,D,N){var R=y(M);if(!(d&&R===void 0))return R()};case 1:return function(M,D,N){var R=y(M);if(!(d&&R===void 0)){var O=h[0];return R(O(M,D,N))}};case 2:return function(M,D,N){var R=y(M);if(!(d&&R===void 0)){var O=h[0],G=h[1];return R(O(M,D,N),G(M,D,N))}};default:return function(M,D,N){var R=y(M);if(!(d&&R===void 0)){var O=h.map(G=>G(M,D,N));return R(...O)}}}}}else if(gd(this.fn)&&qb(this.fn.index)&&this.fn.index.isObjectProperty()){var x=this.fn.object._compile(u,c),w=this.fn.index.getObjectProperty(),_=this.args;return function(M,D,N){var R=x(M,D,N);if(!(d&&(R==null||R[w]===void 0))){var O=JTe(R,w);if(O!=null&&O.rawArgs)return O(_,u,m1(M,D));var G=h.map(I=>I(M,D,N));return O.apply(R,G)}}}else{var E=this.fn.toString(),A=this.fn._compile(u,c),T=this.args;return function(M,D,N){var R=A(M,D,N);if(!(d&&R===void 0)){if(typeof R!="function")throw new TypeError("Expression '".concat(E,"' did not evaluate to a function; value is:")+`
  `.concat(s(R)));if(R.rawArgs)return R(T,u,m1(M,D));var O=h.map(G=>G(M,D,N));return R.apply(R,O)}}}}forEach(u){u(this.fn,"fn",this);for(var c=0;c<this.args.length;c++)u(this.args[c],"args["+c+"]",this)}map(u){for(var c=this._ifNode(u(this.fn,"fn",this)),h=[],d=0;d<this.args.length;d++)h[d]=this._ifNode(u(this.args[d],"args["+d+"]",this));return new o(c,h)}clone(){return new o(this.fn,this.args.slice(0))}toString(u){var c,h=this.fn.toString(u);return u&&typeof u.handler=="object"&&vt(u.handler,h)&&(c=u.handler[h](this,u)),typeof c<"u"?c:super.toString(u)}_toString(u){var c=this.args.map(function(d){return d.toString(u)}),h=aA(this.fn)?"("+this.fn.toString(u)+")":this.fn.toString(u);return h+"("+c.join(", ")+")"}toJSON(){return{mathjs:QT,fn:this.fn,args:this.args}}_toHTML(u){var c=this.args.map(function(h){return h.toHTML(u)});return'<span class="math-function">'+vl(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+c.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}toTex(u){var c;return u&&typeof u.handler=="object"&&vt(u.handler,this.name)&&(c=u.handler[this.name](this,u)),typeof c<"u"?c:super.toTex(u)}_toTex(u){var c=this.args.map(function(f){return f.toTex(u)}),h;pG[this.name]&&(h=pG[this.name]),t[this.name]&&(typeof t[this.name].toTex=="function"||typeof t[this.name].toTex=="object"||typeof t[this.name].toTex=="string")&&(h=t[this.name].toTex);var d;switch(typeof h){case"function":d=h(this,u);break;case"string":d=a(h,this,u);break;case"object":switch(typeof h[c.length]){case"function":d=h[c.length](this,u);break;case"string":d=a(h[c.length],this,u);break}}return typeof d<"u"?d:a(dOe,this,u)}getIdentifier(){return this.type+":"+this.name}}return e=o,wi(o,"name",QT),wi(o,"onUndefinedFunction",function(l){throw new Error("Undefined function "+l)}),wi(o,"fromJSON",function(l){return new e(l.fn,l.args)}),o},{isClass:!0,isNode:!0}),gG="parse",FOe=["typed","numeric","config","AccessorNode","ArrayNode","AssignmentNode","BlockNode","ConditionalNode","ConstantNode","FunctionAssignmentNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","RangeNode","RelationalNode","SymbolNode"],LOe=re(gG,FOe,n=>{var{typed:e,numeric:t,config:r,AccessorNode:i,ArrayNode:s,AssignmentNode:a,BlockNode:o,ConditionalNode:l,ConstantNode:u,FunctionAssignmentNode:c,FunctionNode:h,IndexNode:d,ObjectNode:f,OperatorNode:p,ParenthesisNode:m,RangeNode:y,RelationalNode:v,SymbolNode:b}=n,x=e(gG,{string:function(W){return ee(W,{})},"Array | Matrix":function(W){return w(W,{})},"string, Object":function(W,ye){var Ee=ye.nodes!==void 0?ye.nodes:{};return ee(W,Ee)},"Array | Matrix, Object":w});function w(z){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ye=W.nodes!==void 0?W.nodes:{};return qt(z,function(Ee){if(typeof Ee!="string")throw new TypeError("String expected");return ee(Ee,ye)})}var _={NULL:0,DELIMITER:1,NUMBER:2,SYMBOL:3,UNKNOWN:4},E={",":!0,"(":!0,")":!0,"[":!0,"]":!0,"{":!0,"}":!0,'"':!0,"'":!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"~":!0,"!":!0,"&":!0,"|":!0,"^|":!0,"=":!0,":":!0,"?":!0,"?.":!0,"??":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0,"<<":!0,">>":!0,">>>":!0},A={mod:!0,to:!0,in:!0,and:!0,xor:!0,or:!0,not:!0},T={true:!0,false:!1,null:null,undefined:void 0},S=["NaN","Infinity"],M={'"':'"',"'":"'","\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function D(){return{extraNodes:{},expression:"",comment:"",index:0,token:"",tokenType:_.NULL,nestingLevel:0,conditionalLevel:null}}function N(z,W){return z.expression.substr(z.index,W)}function R(z){return N(z,1)}function O(z){z.index++}function G(z){return z.expression.charAt(z.index-1)}function I(z){return z.expression.charAt(z.index+1)}function B(z){for(z.tokenType=_.NULL,z.token="",z.comment="";;){if(R(z)==="#")for(;R(z)!==`
`&&R(z)!=="";)z.comment+=R(z),O(z);if(x.isWhitespace(R(z),z.nestingLevel))O(z);else break}if(R(z)===""){z.tokenType=_.DELIMITER;return}if(R(z)===`
`&&!z.nestingLevel){z.tokenType=_.DELIMITER,z.token=R(z),O(z);return}var W=R(z),ye=N(z,2),Ee=N(z,3);if(Ee.length===3&&E[Ee]){z.tokenType=_.DELIMITER,z.token=Ee,O(z),O(z),O(z);return}if(ye.length===2&&E[ye]&&(ye!=="?."||!x.isDigit(z.expression.charAt(z.index+2)))){z.tokenType=_.DELIMITER,z.token=ye,O(z),O(z);return}if(E[W]){z.tokenType=_.DELIMITER,z.token=W,O(z);return}if(x.isDigitDot(W)){z.tokenType=_.NUMBER;var Fe=N(z,2);if(Fe==="0b"||Fe==="0o"||Fe==="0x"){for(z.token+=R(z),O(z),z.token+=R(z),O(z);x.isAlpha(R(z),G(z),I(z))||x.isDigit(R(z));)z.token+=R(z),O(z);if(R(z)===".")for(z.token+=".",O(z);x.isAlpha(R(z),G(z),I(z))||x.isDigit(R(z));)z.token+=R(z),O(z);else if(R(z)==="i")for(z.token+="i",O(z);x.isDigit(R(z));)z.token+=R(z),O(z);return}if(R(z)==="."){if(z.token+=R(z),O(z),!x.isDigit(R(z))){z.tokenType=_.DELIMITER;return}}else{for(;x.isDigit(R(z));)z.token+=R(z),O(z);x.isDecimalMark(R(z),I(z))&&(z.token+=R(z),O(z))}for(;x.isDigit(R(z));)z.token+=R(z),O(z);if(R(z)==="E"||R(z)==="e"){if(x.isDigit(I(z))||I(z)==="-"||I(z)==="+"){if(z.token+=R(z),O(z),(R(z)==="+"||R(z)==="-")&&(z.token+=R(z),O(z)),!x.isDigit(R(z)))throw Ge(z,'Digit expected, got "'+R(z)+'"');for(;x.isDigit(R(z));)z.token+=R(z),O(z);if(x.isDecimalMark(R(z),I(z)))throw Ge(z,'Digit expected, got "'+R(z)+'"')}else if(x.isDecimalMark(I(z),z.expression.charAt(z.index+2)))throw O(z),Ge(z,'Digit expected, got "'+R(z)+'"')}return}if(x.isAlpha(R(z),G(z),I(z))){for(;x.isAlpha(R(z),G(z),I(z))||x.isDigit(R(z));)z.token+=R(z),O(z);vt(A,z.token)?z.tokenType=_.DELIMITER:z.tokenType=_.SYMBOL;return}for(z.tokenType=_.UNKNOWN;R(z)!=="";)z.token+=R(z),O(z);throw Ge(z,'Syntax error in part "'+z.token+'"')}function $(z){do B(z);while(z.token===`
`)}function H(z){z.nestingLevel++}function Q(z){z.nestingLevel--}x.isAlpha=function(W,ye,Ee){return x.isValidLatinOrGreek(W)||x.isValidMathSymbol(W,Ee)||x.isValidMathSymbol(ye,W)},x.isValidLatinOrGreek=function(W){return/^[a-zA-Z_$\u00C0-\u02AF\u0370-\u03FF\u2100-\u214F]$/.test(W)},x.isValidMathSymbol=function(W,ye){return/^[\uD835]$/.test(W)&&/^[\uDC00-\uDFFF]$/.test(ye)&&/^[^\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]$/.test(ye)},x.isWhitespace=function(W,ye){return W===" "||W==="	"||W===""||W===`
`&&ye>0},x.isDecimalMark=function(W,ye){return W==="."&&ye!=="/"&&ye!=="*"&&ye!=="^"},x.isDigitDot=function(W){return W>="0"&&W<="9"||W==="."},x.isDigit=function(W){return W>="0"&&W<="9"};function ee(z,W){var ye=D();li(ye,{expression:z,extraNodes:W}),B(ye);var Ee=J(ye);if(ye.token!=="")throw ye.tokenType===_.DELIMITER?qe(ye,"Unexpected operator "+ye.token):Ge(ye,'Unexpected part "'+ye.token+'"');return Ee}function J(z){var W,ye=[],Ee;for(z.token!==""&&z.token!==`
`&&z.token!==";"&&(W=L(z),z.comment&&(W.comment=z.comment));z.token===`
`||z.token===";";)ye.length===0&&W&&(Ee=z.token!==";",ye.push({node:W,visible:Ee})),B(z),z.token!==`
`&&z.token!==";"&&z.token!==""&&(W=L(z),z.comment&&(W.comment=z.comment),Ee=z.token!==";",ye.push({node:W,visible:Ee}));return ye.length>0?new o(ye):(W||(W=new u(void 0),z.comment&&(W.comment=z.comment)),W)}function L(z){var W,ye,Ee,Fe,Le=se(z);if(z.token==="="){if(ss(Le))return W=Le.name,$(z),Ee=L(z),new a(new b(W),Ee);if(gd(Le)){if(Le.optionalChaining)throw Ge(z,"Cannot assign to optional chain");return $(z),Ee=L(z),new a(Le.object,Le.index,Ee)}else if(Pp(Le)&&ss(Le.fn)&&(Fe=!0,ye=[],W=Le.name,Le.args.forEach(function(Ue,tt){ss(Ue)?ye[tt]=Ue.name:Fe=!1}),Fe))return $(z),Ee=L(z),new c(W,ye,Ee);throw Ge(z,"Invalid left hand side of assignment operator =")}return Le}function se(z){for(var W=Z(z);z.token==="?";){var ye=z.conditionalLevel;z.conditionalLevel=z.nestingLevel,$(z);var Ee=W,Fe=L(z);if(z.token!==":")throw Ge(z,"False part of conditional expression expected");z.conditionalLevel=null,$(z);var Le=L(z);W=new l(Ee,Fe,Le),z.conditionalLevel=ye}return W}function Z(z){for(var W=le(z);z.token==="or";)$(z),W=new p("or","or",[W,le(z)]);return W}function le(z){for(var W=ue(z);z.token==="xor";)$(z),W=new p("xor","xor",[W,ue(z)]);return W}function ue(z){for(var W=te(z);z.token==="and";)$(z),W=new p("and","and",[W,te(z)]);return W}function te(z){for(var W=Y(z);z.token==="|";)$(z),W=new p("|","bitOr",[W,Y(z)]);return W}function Y(z){for(var W=ie(z);z.token==="^|";)$(z),W=new p("^|","bitXor",[W,ie(z)]);return W}function ie(z){for(var W=ve(z);z.token==="&";)$(z),W=new p("&","bitAnd",[W,ve(z)]);return W}function ve(z){for(var W=[ge(z)],ye=[],Ee={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};vt(Ee,z.token);){var Fe={name:z.token,fn:Ee[z.token]};ye.push(Fe),$(z),W.push(ge(z))}return W.length===1?W[0]:W.length===2?new p(ye[0].name,ye[0].fn,W):new v(ye.map(Le=>Le.fn),W)}function ge(z){var W,ye,Ee,Fe;W=_e(z);for(var Le={"<<":"leftShift",">>":"rightArithShift",">>>":"rightLogShift"};vt(Le,z.token);)ye=z.token,Ee=Le[ye],$(z),Fe=[W,_e(z)],W=new p(ye,Ee,Fe);return W}function _e(z){var W,ye,Ee,Fe;W=we(z);for(var Le={to:"to",in:"to"};vt(Le,z.token);)ye=z.token,Ee=Le[ye],$(z),ye==="in"&&"])},;".includes(z.token)?W=new p("*","multiply",[W,new b("in")],!0):(Fe=[W,we(z)],W=new p(ye,Ee,Fe));return W}function we(z){var W,ye=[];if(z.token===":"?W=new u(1):W=Be(z),z.token===":"&&z.conditionalLevel!==z.nestingLevel){for(ye.push(W);z.token===":"&&ye.length<3;)$(z),z.token===")"||z.token==="]"||z.token===","||z.token===""?ye.push(new b("end")):ye.push(Be(z));ye.length===3?W=new y(ye[0],ye[2],ye[1]):W=new y(ye[0],ye[1])}return W}function Be(z){var W,ye,Ee,Fe;W=$e(z);for(var Le={"+":"add","-":"subtract"};vt(Le,z.token);){ye=z.token,Ee=Le[ye],$(z);var Ue=$e(z);Ue.isPercentage?Fe=[W,new p("*","multiply",[W,Ue])]:Fe=[W,Ue],W=new p(ye,Ee,Fe)}return W}function $e(z){var W,ye,Ee,Fe;W=nt(z),ye=W;for(var Le={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide","%":"mod",mod:"mod"};vt(Le,z.token);)Ee=z.token,Fe=Le[Ee],$(z),ye=nt(z),W=new p(Ee,Fe,[W,ye]);return W}function nt(z){var W,ye;for(W=de(z),ye=W;z.tokenType===_.SYMBOL||z.token==="in"&&pn(W)||z.token==="in"&&ai(W)&&W.fn==="unaryMinus"&&pn(W.args[0])||z.tokenType===_.NUMBER&&!pn(ye)&&(!ai(ye)||ye.op==="!")||z.token==="(";)ye=de(z),W=new p("*","multiply",[W,ye],!0);return W}function de(z){for(var W=Ye(z),ye=W,Ee=[];z.token==="/"&&yO(ye);)if(Ee.push(li({},z)),$(z),z.tokenType===_.NUMBER)if(Ee.push(li({},z)),$(z),z.tokenType===_.SYMBOL||z.token==="("||z.token==="in")li(z,Ee.pop()),Ee.pop(),ye=Ye(z),W=new p("/","divide",[W,ye]);else{Ee.pop(),li(z,Ee.pop());break}else{li(z,Ee.pop());break}return W}function Ye(z){var W=Xe(z);if(z.token==="%"){var ye=li({},z);$(z);try{Xe(z),li(z,ye)}catch{W=new p("/","divide",[W,new u(100)],!1,!0)}}return W}function Xe(z){var W,ye,Ee,Fe={"-":"unaryMinus","+":"unaryPlus","~":"bitNot",not:"not"};return vt(Fe,z.token)?(Ee=Fe[z.token],W=z.token,$(z),ye=[Xe(z)],new p(W,Ee,ye)):ae(z)}function ae(z){var W,ye,Ee,Fe;return W=fe(z),(z.token==="^"||z.token===".^")&&(ye=z.token,Ee=ye==="^"?"pow":"dotPow",$(z),Fe=[W,Xe(z)],W=new p(ye,Ee,Fe)),W}function fe(z){for(var W=F(z);z.token==="??";)$(z),W=new p("??","nullish",[W,F(z)]);return W}function F(z){var W,ye,Ee,Fe;W=P(z);for(var Le={"!":"factorial","'":"ctranspose"};vt(Le,z.token);)ye=z.token,Ee=Le[ye],B(z),Fe=[W],W=new p(ye,Ee,Fe),W=oe(z,W);return W}function P(z){var W=[];if(z.tokenType===_.SYMBOL&&vt(z.extraNodes,z.token)){var ye=z.extraNodes[z.token];if(B(z),z.token==="("){if(W=[],H(z),B(z),z.token!==")")for(W.push(L(z));z.token===",";)B(z),W.push(L(z));if(z.token!==")")throw Ge(z,"Parenthesis ) expected");Q(z),B(z)}return new ye(W)}return K(z)}function K(z){var W,ye;return z.tokenType===_.SYMBOL||z.tokenType===_.DELIMITER&&z.token in A?(ye=z.token,B(z),vt(T,ye)?W=new u(T[ye]):S.includes(ye)?W=new u(t(ye,"number")):W=new b(ye),W=oe(z,W),W):pe(z)}function oe(z,W,ye){for(var Ee;;){var Fe=!1;z.token==="?."&&(Fe=!0,B(z));var Le=(z.token==="("||z.token==="["||z.token===".")&&!0;if(!(Fe||Le))break;if(Ee=[],z.token==="(")if(Fe||ss(W)||gd(W)){if(H(z),B(z),z.token!==")")for(Ee.push(L(z));z.token===",";)B(z),Ee.push(L(z));if(z.token!==")")throw Ge(z,"Parenthesis ) expected");Q(z),B(z),W=new h(W,Ee,Fe)}else return W;else if(z.token==="["){if(H(z),B(z),z.token!=="]")for(Ee.push(L(z));z.token===",";)B(z),Ee.push(L(z));if(z.token!=="]")throw Ge(z,"Parenthesis ] expected");Q(z),B(z),W=new i(W,new d(Ee),Fe)}else{Fe||B(z);var Ue=z.tokenType===_.SYMBOL||z.tokenType===_.DELIMITER&&z.token in A;if(!Ue){var tt="Property name expected after ";throw tt+=Fe?"optional chain":"dot",Ge(z,tt)}Ee.push(new u(z.token)),B(z);var Pt=!0;W=new i(W,new d(Ee,Pt),Fe)}}return W}function pe(z){var W,ye;return z.token==='"'||z.token==="'"?(ye=ce(z,z.token),W=new u(ye),W=oe(z,W),W):Te(z)}function ce(z,W){for(var ye="";R(z)!==""&&R(z)!==W;)if(R(z)==="\\"){O(z);var Ee=R(z),Fe=M[Ee];if(Fe!==void 0)ye+=Fe,z.index+=1;else if(Ee==="u"){var Le=z.expression.slice(z.index+1,z.index+5);if(/^[0-9A-Fa-f]{4}$/.test(Le))ye+=String.fromCharCode(parseInt(Le,16)),z.index+=5;else throw Ge(z,"Invalid unicode character \\u".concat(Le))}else throw Ge(z,"Bad escape character \\".concat(Ee))}else ye+=R(z),O(z);if(B(z),z.token!==W)throw Ge(z,"End of string ".concat(W," expected"));return B(z),ye}function Te(z){var W,ye,Ee,Fe;if(z.token==="["){if(H(z),B(z),z.token!=="]"){var Le=be(z);if(z.token===";"){for(Ee=1,ye=[Le];z.token===";";)B(z),z.token!=="]"&&(ye[Ee]=be(z),Ee++);if(z.token!=="]")throw Ge(z,"End of matrix ] expected");Q(z),B(z),Fe=ye[0].items.length;for(var Ue=1;Ue<Ee;Ue++)if(ye[Ue].items.length!==Fe)throw qe(z,"Column dimensions mismatch ("+ye[Ue].items.length+" !== "+Fe+")");W=new s(ye)}else{if(z.token!=="]")throw Ge(z,"End of matrix ] expected");Q(z),B(z),W=Le}}else Q(z),B(z),W=new s([]);return oe(z,W)}return Pe(z)}function be(z){for(var W=[L(z)],ye=1;z.token===",";)B(z),z.token!=="]"&&z.token!==";"&&(W[ye]=L(z),ye++);return new s(W)}function Pe(z){if(z.token==="{"){H(z);var W,ye={};do if(B(z),z.token!=="}"){if(z.token==='"'||z.token==="'")W=ce(z,z.token);else if(z.tokenType===_.SYMBOL||z.tokenType===_.DELIMITER&&z.token in A)W=z.token,B(z);else throw Ge(z,"Symbol or string expected as object key");if(z.token!==":")throw Ge(z,"Colon : expected after object key");B(z),ye[W]=L(z)}while(z.token===",");if(z.token!=="}")throw Ge(z,"Comma , or bracket } expected after object value");Q(z),B(z);var Ee=new f(ye);return Ee=oe(z,Ee),Ee}return Me(z)}function Me(z){var W;if(z.tokenType===_.NUMBER){W=z.token,B(z);var ye=Wp(W,r),Ee=t(W,ye);return new u(Ee)}return Ne(z)}function Ne(z){var W;if(z.token==="("){if(H(z),B(z),W=L(z),z.token!==")")throw Ge(z,"Parenthesis ) expected");return Q(z),B(z),W=new m(W),W=oe(z,W),W}return ze(z)}function ze(z){throw z.token===""?Ge(z,"Unexpected end of expression"):Ge(z,"Value expected")}function Ke(z){return z.index-z.token.length+1}function Ge(z,W){var ye=Ke(z),Ee=new SyntaxError(W+" (char "+ye+")");return Ee.char=ye,Ee}function qe(z,W){var ye=Ke(z),Ee=new SyntaxError(W+" (char "+ye+")");return Ee.char=ye,Ee}return e.addConversion({from:"string",to:"Node",convert:x}),x}),vG="compile",OOe=["typed","parse"],kOe=re(vG,OOe,n=>{var{typed:e,parse:t}=n;return e(vG,{string:function(i){return t(i).compile()},"Array | Matrix":function(i){return qt(i,function(s){return t(s).compile()})}})}),yG="evaluate",BOe=["typed","parse"],UOe=re(yG,BOe,n=>{var{typed:e,parse:t}=n;return e(yG,{string:function(i){var s=Nw();return t(i).compile().evaluate(s)},"string, Map | Object":function(i,s){return t(i).compile().evaluate(s)},"Array | Matrix":function(i){var s=Nw();return qt(i,function(a){return t(a).compile().evaluate(s)})},"Array | Matrix, Map | Object":function(i,s){return qt(i,function(a){return t(a).compile().evaluate(s)})}})}),VOe="Parser",zOe=["evaluate","parse"],$Oe=re(VOe,zOe,n=>{var{evaluate:e,parse:t}=n;function r(){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");Object.defineProperty(this,"scope",{value:Nw(),writable:!1})}r.prototype.type="Parser",r.prototype.isParser=!0,r.prototype.evaluate=function(s){return e(s,this.scope)},r.prototype.get=function(s){if(this.scope.has(s))return this.scope.get(s)},r.prototype.getAll=function(){return rMe(this.scope)},r.prototype.getAllAsMap=function(){return this.scope};function i(s){if(s.length===0)return!1;for(var a=0;a<s.length;a++){var o=s.charAt(a-1),l=s.charAt(a),u=s.charAt(a+1),c=t.isAlpha(l,o,u)||a>0&&t.isDigit(l);if(!c)return!1}return!0}return r.prototype.set=function(s,a){if(!i(s))throw new Error("Invalid variable name: '".concat(s,"'. Variable names must follow the specified rules."));return this.scope.set(s,a),a},r.prototype.remove=function(s){this.scope.delete(s)},r.prototype.clear=function(){this.scope.clear()},r.prototype.toJSON=function(){var s={mathjs:"Parser",variables:{},functions:{}};for(var[a,o]of this.scope)if(cte(o)){if(!HOe(o))throw new Error("Cannot serialize external function ".concat(a));s.functions[a]="".concat(o.syntax," = ").concat(o.expr)}else s.variables[a]=o;return s},r.fromJSON=function(s){var a=new r;return Object.entries(s.variables).forEach(o=>{var[l,u]=o;return a.set(l,u)}),Object.entries(s.functions).forEach(o=>{var[l,u]=o;return a.evaluate(u)}),a},r},{isClass:!0});function HOe(n){return typeof n=="function"&&typeof n.syntax=="string"&&typeof n.expr=="string"}var xG="parser",GOe=["typed","Parser"],jOe=re(xG,GOe,n=>{var{typed:e,Parser:t}=n;return e(xG,{"":function(){return new t}})}),bG="lup",qOe=["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtractScalar","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],WOe=re(bG,qOe,n=>{var{typed:e,matrix:t,abs:r,addScalar:i,divideScalar:s,multiplyScalar:a,subtractScalar:o,larger:l,equalScalar:u,unaryMinus:c,DenseMatrix:h,SparseMatrix:d,Spa:f}=n;return e(bG,{DenseMatrix:function(v){return p(v)},SparseMatrix:function(v){return m(v)},Array:function(v){var b=t(v),x=p(b);return{L:x.L.valueOf(),U:x.U.valueOf(),p:x.p}}});function p(y){var v=y._size[0],b=y._size[1],x=Math.min(v,b),w=Ut(y._data),_=[],E=[v,x],A=[],T=[x,b],S,M,D,N=[];for(S=0;S<v;S++)N[S]=S;for(M=0;M<b;M++){if(M>0)for(S=0;S<v;S++){var R=Math.min(S,M),O=0;for(D=0;D<R;D++)O=i(O,a(w[S][D],w[D][M]));w[S][M]=o(w[S][M],O)}var G=M,I=0,B=0;for(S=M;S<v;S++){var $=w[S][M],H=r($);l(H,I)&&(G=S,I=H,B=$)}if(M!==G&&(N[M]=[N[G],N[G]=N[M]][0],h._swapRows(M,G,w)),M<v)for(S=M+1;S<v;S++){var Q=w[S][M];u(Q,0)||(w[S][M]=s(w[S][M],B))}}for(M=0;M<b;M++)for(S=0;S<v;S++){if(M===0&&(S<b&&(A[S]=[]),_[S]=[]),S<M){S<b&&(A[S][M]=w[S][M]),M<v&&(_[S][M]=0);continue}if(S===M){S<b&&(A[S][M]=w[S][M]),M<v&&(_[S][M]=1);continue}S<b&&(A[S][M]=0),M<v&&(_[S][M]=w[S][M])}var ee=new h({data:_,size:E}),J=new h({data:A,size:T}),L=[];for(S=0,x=N.length;S<x;S++)L[N[S]]=S;return{L:ee,U:J,p:L,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
P: `+this.p}}}function m(y){var v=y._size[0],b=y._size[1],x=Math.min(v,b),w=y._values,_=y._index,E=y._ptr,A=[],T=[],S=[],M=[v,x],D=[],N=[],R=[],O=[x,b],G,I,B,$=[],H=[];for(G=0;G<v;G++)$[G]=G,H[G]=G;var Q=function(L,se){var Z=H[L],le=H[se];$[Z]=se,$[le]=L,H[L]=le,H[se]=Z},ee=function(){var L=new f;I<v&&(S.push(A.length),A.push(1),T.push(I)),R.push(D.length);var se=E[I],Z=E[I+1];for(B=se;B<Z;B++)G=_[B],L.set($[G],w[B]);I>0&&L.forEach(0,I-1,function(Y,ie){d._forEachRow(Y,A,T,S,function(ve,ge){ve>Y&&L.accumulate(ve,c(a(ge,ie)))})});var le=I,ue=L.get(I),te=r(ue);L.forEach(I+1,v-1,function(Y,ie){var ve=r(ie);l(ve,te)&&(le=Y,te=ve,ue=ie)}),I!==le&&(d._swapRows(I,le,M[1],A,T,S),d._swapRows(I,le,O[1],D,N,R),L.swap(I,le),Q(I,le)),L.forEach(0,v-1,function(Y,ie){Y<=I?(D.push(ie),N.push(Y)):(ie=s(ie,ue),u(ie,0)||(A.push(ie),T.push(Y)))})};for(I=0;I<b;I++)ee();return R.push(D.length),S.push(A.length),{L:new d({values:A,index:T,ptr:S,size:M}),U:new d({values:D,index:N,ptr:R,size:O}),p:$,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
P: `+this.p}}}}),_G="qr",XOe=["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtractScalar","complex"],KOe=re(_G,XOe,n=>{var{typed:e,matrix:t,zeros:r,identity:i,isZero:s,equal:a,sign:o,sqrt:l,conj:u,unaryMinus:c,addScalar:h,divideScalar:d,multiplyScalar:f,subtractScalar:p,complex:m}=n;return li(e(_G,{DenseMatrix:function(w){return v(w)},SparseMatrix:function(w){return b()},Array:function(w){var _=t(w),E=v(_);return{Q:E.Q.valueOf(),R:E.R.valueOf()}}}),{_denseQRimpl:y});function y(x){var w=x._size[0],_=x._size[1],E=i([w],"dense"),A=E._data,T=x.clone(),S=T._data,M,D,N,R=r([w],"");for(N=0;N<Math.min(_,w);++N){var O=S[N][N],G=c(a(O,0)?1:o(O)),I=u(G),B=0;for(M=N;M<w;M++)B=h(B,f(S[M][N],u(S[M][N])));var $=f(G,l(B));if(!s($)){var H=p(O,$);for(R[N]=1,M=N+1;M<w;M++)R[M]=d(S[M][N],H);var Q=c(u(d(H,$))),ee=void 0;for(D=N;D<_;D++){for(ee=0,M=N;M<w;M++)ee=h(ee,f(u(R[M]),S[M][D]));for(ee=f(ee,Q),M=N;M<w;M++)S[M][D]=f(p(S[M][D],f(R[M],ee)),I)}for(M=0;M<w;M++){for(ee=0,D=N;D<w;D++)ee=h(ee,f(A[M][D],R[D]));for(ee=f(ee,Q),D=N;D<w;++D)A[M][D]=d(p(A[M][D],f(ee,u(R[D]))),I)}}}return{Q:E,R:T,toString:function(){return"Q: "+this.Q.toString()+`
R: `+this.R.toString()}}}function v(x){var w=y(x),_=w.R._data;if(x._data.length>0)for(var E=_[0][0].type==="Complex"?m(0):0,A=0;A<_.length;++A)for(var T=0;T<A&&T<(_[0]||[]).length;++T)_[A][T]=E;return w}function b(x){throw new Error("qr not implemented for sparse matrices yet")}});function YOe(n,e,t,r){n._values;for(var i=n._index,s=n._ptr,a=n._size,o=n._datatype,l=a[0],u=a[1],c=null,h=[],d=[],f=0,p=0;p<u;p++){d[p]=f;for(var m=t?t[p]:p,y=s[m],v=s[m+1],b=y;b<v;b++){var x=i[b];h[f]=x,f++}}return d[u]=f,n.createSparseMatrix({values:c,index:h,ptr:d,size:[l,u],datatype:o})}function rre(n,e,t,r,i,s,a){var o=0;for(t[a]=n;o>=0;){var l=t[a+o],u=t[r+l];u===-1?(o--,s[e++]=l):(t[r+l]=t[i+u],++o,t[a+o]=u)}return e}function QOe(n,e){if(!n)return null;var t=0,r,i=[],s=[],a=0,o=e,l=2*e;for(r=0;r<e;r++)s[a+r]=-1;for(r=e-1;r>=0;r--)n[r]!==-1&&(s[o+r]=s[a+n[r]],s[a+n[r]]=r);for(r=0;r<e;r++)n[r]===-1&&(t=rre(r,t,s,a,o,i,l));return i}function ZOe(n,e){if(!n)return null;var t=n._index,r=n._ptr,i=n._size,s=i[0],a=i[1],o=[],l=[],u=0,c=a,h,d;for(h=0;h<s;h++)l[c+h]=-1;for(var f=0;f<a;f++){o[f]=-1,l[u+f]=-1;for(var p=r[f],m=r[f+1],y=p;y<m;y++){var v=t[y];for(h=l[c+v];h!==-1&&h<f;h=d)d=l[u+h],l[u+h]=f,d===-1&&(o[h]=f);l[c+v]=f}}return o}function JOe(n,e,t){for(var r=n._values,i=n._index,s=n._ptr,a=n._size,o=a[1],l=0,u=0;u<o;u++){var c=s[u];for(s[u]=l;c<s[u+1];c++)e(i[c],u,r?r[c]:1,t)&&(i[l]=i[c],r&&(r[l]=r[c]),l++)}return s[o]=l,i.splice(l,i.length-l),r&&r.splice(l,r.length-l),l}function Kd(n){return-n-2}var eke="csAmd",tke=["add","multiply","transpose"],nke=re(eke,tke,n=>{var{add:e,multiply:t,transpose:r}=n;return function(c,h){if(!h||c<=0||c>3)return null;var d=h._size,f=d[0],p=d[1],m=0,y=Math.max(16,10*Math.sqrt(p));y=Math.min(p-2,y);var v=i(c,h,f,p,y);JOe(v,l,null);for(var b=v._index,x=v._ptr,w=x[p],_=[],E=[],A=0,T=p+1,S=2*(p+1),M=3*(p+1),D=4*(p+1),N=5*(p+1),R=6*(p+1),O=7*(p+1),G=_,I=s(p,x,E,A,M,G,S,O,T,R,D,N),B=a(p,x,E,N,D,R,y,T,M,G,S),$=0,H,Q,ee,J,L,se,Z,le,ue,te,Y,ie,ve,ge,_e,we;B<p;){for(ee=-1;$<p&&(ee=E[M+$])===-1;$++);E[S+ee]!==-1&&(G[E[S+ee]]=-1),E[M+$]=E[S+ee];var Be=E[D+ee],$e=E[T+ee];B+=$e;var nt=0;E[T+ee]=-$e;var de=x[ee],Ye=Be===0?de:w,Xe=Ye;for(J=1;J<=Be+1;J++){for(J>Be?(se=ee,Z=de,le=E[A+ee]-Be):(se=b[de++],Z=x[se],le=E[A+se]),L=1;L<=le;L++)H=b[Z++],!((ue=E[T+H])<=0)&&(nt+=ue,E[T+H]=-ue,b[Xe++]=H,E[S+H]!==-1&&(G[E[S+H]]=G[H]),G[H]!==-1?E[S+G[H]]=E[S+H]:E[M+E[N+H]]=E[S+H]);se!==ee&&(x[se]=Kd(ee),E[R+se]=0)}for(Be!==0&&(w=Xe),E[N+ee]=nt,x[ee]=Ye,E[A+ee]=Xe-Ye,E[D+ee]=-2,I=o(I,m,E,R,p),te=Ye;te<Xe;te++)if(H=b[te],!((Y=E[D+H])<=0)){ue=-E[T+H];var ae=I-ue;for(de=x[H],ie=x[H]+Y-1;de<=ie;de++)se=b[de],E[R+se]>=I?E[R+se]-=ue:E[R+se]!==0&&(E[R+se]=E[N+se]+ae)}for(te=Ye;te<Xe;te++){for(H=b[te],ie=x[H],ve=ie+E[D+H]-1,ge=ie,_e=0,we=0,de=ie;de<=ve;de++)if(se=b[de],E[R+se]!==0){var fe=E[R+se]-I;fe>0?(we+=fe,b[ge++]=se,_e+=se):(x[se]=Kd(ee),E[R+se]=0)}E[D+H]=ge-ie+1;var F=ge,P=ie+E[A+H];for(de=ve+1;de<P;de++){Q=b[de];var K=E[T+Q];K<=0||(we+=K,b[ge++]=Q,_e+=Q)}we===0?(x[H]=Kd(ee),ue=-E[T+H],nt-=ue,$e+=ue,B+=ue,E[T+H]=0,E[D+H]=-1):(E[N+H]=Math.min(E[N+H],we),b[ge]=b[F],b[F]=b[ie],b[ie]=ee,E[A+H]=ge-ie+1,_e=(_e<0?-_e:_e)%p,E[S+H]=E[O+_e],E[O+_e]=H,G[H]=_e)}for(E[N+ee]=nt,m=Math.max(m,nt),I=o(I+m,m,E,R,p),te=Ye;te<Xe;te++)if(H=b[te],!(E[T+H]>=0))for(_e=G[H],H=E[O+_e],E[O+_e]=-1;H!==-1&&E[S+H]!==-1;H=E[S+H],I++){for(le=E[A+H],Y=E[D+H],de=x[H]+1;de<=x[H]+le-1;de++)E[R+b[de]]=I;var oe=H;for(Q=E[S+H];Q!==-1;){var pe=E[A+Q]===le&&E[D+Q]===Y;for(de=x[Q]+1;pe&&de<=x[Q]+le-1;de++)E[R+b[de]]!==I&&(pe=0);pe?(x[Q]=Kd(H),E[T+H]+=E[T+Q],E[T+Q]=0,E[D+Q]=-1,Q=E[S+Q],E[S+oe]=Q):(oe=Q,Q=E[S+Q])}}for(de=Ye,te=Ye;te<Xe;te++)H=b[te],!((ue=-E[T+H])<=0)&&(E[T+H]=ue,we=E[N+H]+nt-ue,we=Math.min(we,p-B-ue),E[M+we]!==-1&&(G[E[M+we]]=H),E[S+H]=E[M+we],G[H]=-1,E[M+we]=H,$=Math.min($,we),E[N+H]=we,b[de++]=H);E[T+ee]=$e,(E[A+ee]=de-Ye)===0&&(x[ee]=-1,E[R+ee]=0),Be!==0&&(w=de)}for(H=0;H<p;H++)x[H]=Kd(x[H]);for(Q=0;Q<=p;Q++)E[M+Q]=-1;for(Q=p;Q>=0;Q--)E[T+Q]>0||(E[S+Q]=E[M+x[Q]],E[M+x[Q]]=Q);for(se=p;se>=0;se--)E[T+se]<=0||x[se]!==-1&&(E[S+se]=E[M+x[se]],E[M+x[se]]=se);for(ee=0,H=0;H<=p;H++)x[H]===-1&&(ee=rre(H,ee,E,M,S,_,R));return _.splice(_.length-1,1),_};function i(u,c,h,d,f){var p=r(c);if(u===1&&d===h)return e(c,p);if(u===2){for(var m=p._index,y=p._ptr,v=0,b=0;b<h;b++){var x=y[b];if(y[b]=v,!(y[b+1]-x>f))for(var w=y[b+1];x<w;x++)m[v++]=m[x]}return y[h]=v,c=r(p),t(p,c)}return t(p,c)}function s(u,c,h,d,f,p,m,y,v,b,x,w){for(var _=0;_<u;_++)h[d+_]=c[_+1]-c[_];h[d+u]=0;for(var E=0;E<=u;E++)h[f+E]=-1,p[E]=-1,h[m+E]=-1,h[y+E]=-1,h[v+E]=1,h[b+E]=1,h[x+E]=0,h[w+E]=h[d+E];var A=o(0,0,h,b,u);return h[x+u]=-2,c[u]=-1,h[b+u]=0,A}function a(u,c,h,d,f,p,m,y,v,b,x){for(var w=0,_=0;_<u;_++){var E=h[d+_];if(E===0)h[f+_]=-2,w++,c[_]=-1,h[p+_]=0;else if(E>m)h[y+_]=0,h[f+_]=-1,w++,c[_]=Kd(u),h[y+u]++;else{var A=h[v+E];A!==-1&&(b[A]=_),h[x+_]=h[v+E],h[v+E]=_}}return w}function o(u,c,h,d,f){if(u<2||u+c<0){for(var p=0;p<f;p++)h[d+p]!==0&&(h[d+p]=1);u=2}return u}function l(u,c){return u!==c}});function rke(n,e,t,r,i,s,a){var o,l,u=0,c;if(n<=e||t[r+e]<=t[i+n])return-1;t[i+n]=t[r+e];var h=t[s+n];if(t[s+n]=e,h===-1)u=1,c=n;else{for(u=2,c=h;c!==t[a+c];c=t[a+c]);for(o=h;o!==c;o=l)l=t[a+o],t[a+o]=c}return{jleaf:u,q:c}}var ike="csCounts",ske=["transpose"],ake=re(ike,ske,n=>{var{transpose:e}=n;return function(t,r,i,s){if(!t||!r||!i)return null;var a=t._size,o=a[0],l=a[1],u,c,h,d,f,p,m,y=4*l+(s?l+o+1:0),v=[],b=0,x=l,w=2*l,_=3*l,E=4*l,A=5*l+1;for(h=0;h<y;h++)v[h]=-1;var T=[],S=e(t),M=S._index,D=S._ptr;for(h=0;h<l;h++)for(c=i[h],T[c]=v[_+c]===-1?1:0;c!==-1&&v[_+c]===-1;c=r[c])v[_+c]=h;if(s){for(h=0;h<l;h++)v[i[h]]=h;for(u=0;u<o;u++){for(h=l,p=D[u],m=D[u+1],f=p;f<m;f++)h=Math.min(h,v[M[f]]);v[A+u]=v[E+h],v[E+h]=u}}for(u=0;u<l;u++)v[b+u]=u;for(h=0;h<l;h++){for(c=i[h],r[c]!==-1&&T[r[c]]--,d=s?v[E+h]:c;d!==-1;d=s?v[A+d]:-1)for(f=D[d];f<D[d+1];f++){u=M[f];var N=rke(u,c,v,_,x,w,b);N.jleaf>=1&&T[c]++,N.jleaf===2&&T[N.q]--}r[c]!==-1&&(v[b+c]=r[c])}for(c=0;c<l;c++)r[c]!==-1&&(T[r[c]]+=T[c]);return T}}),oke="csSqr",lke=["add","multiply","transpose"],uke=re(oke,lke,n=>{var{add:e,multiply:t,transpose:r}=n,i=nke({add:e,multiply:t,transpose:r}),s=ake({transpose:r});return function(l,u,c){var h=u._ptr,d=u._size,f=d[1],p,m={};if(m.q=i(l,u),l&&!m.q)return null;if(c){var y=l?YOe(u,null,m.q):u;m.parent=ZOe(y);var v=QOe(m.parent,f);if(m.cp=s(y,m.parent,v,1),y&&m.parent&&m.cp&&a(y,m))for(m.unz=0,p=0;p<f;p++)m.unz+=m.cp[p]}else m.unz=4*h[f]+f,m.lnz=m.unz;return m};function a(o,l){var u=o._ptr,c=o._index,h=o._size,d=h[0],f=h[1];l.pinv=[],l.leftmost=[];var p=l.parent,m=l.pinv,y=l.leftmost,v=[],b=0,x=d,w=d+f,_=d+2*f,E,A,T,S,M;for(A=0;A<f;A++)v[x+A]=-1,v[w+A]=-1,v[_+A]=0;for(E=0;E<d;E++)y[E]=-1;for(A=f-1;A>=0;A--)for(S=u[A],M=u[A+1],T=S;T<M;T++)y[c[T]]=A;for(E=d-1;E>=0;E--)m[E]=-1,A=y[E],A!==-1&&(v[_+A]++===0&&(v[w+A]=E),v[b+E]=v[x+A],v[x+A]=E);for(l.lnz=0,l.m2=d,A=0;A<f;A++)if(E=v[x+A],l.lnz++,E<0&&(E=l.m2++),m[E]=A,!(--_[A]<=0)){l.lnz+=v[_+A];var D=p[A];D!==-1&&(v[_+D]===0&&(v[w+D]=v[w+A]),v[b+v[w+A]]=v[x+D],v[x+D]=v[b+E],v[_+D]+=v[_+A])}for(E=0;E<d;E++)m[E]<0&&(m[E]=A++);return!0}});function UO(n,e){return n[e]<0}function ire(n,e){n[e]=Kd(n[e])}function wG(n){return n<0?Kd(n):n}function cke(n,e,t,r,i){var s=e._index,a=e._ptr,o=e._size,l=o[1],u,c,h,d=0;for(r[0]=n;d>=0;){n=r[d];var f=i?i[n]:n;UO(a,n)||(ire(a,n),r[l+d]=f<0?0:wG(a[f]));var p=1;for(c=r[l+d],h=f<0?0:wG(a[f+1]);c<h;c++)if(u=s[c],!UO(a,u)){r[l+d]=c,r[++d]=u,p=0;break}p&&(d--,r[--t]=n)}return t}function hke(n,e,t,r,i){var s=n._ptr,a=n._size,o=e._index,l=e._ptr,u=a[1],c,h,d,f=u;for(h=l[t],d=l[t+1],c=h;c<d;c++){var p=o[c];UO(s,p)||(f=cke(p,n,f,r,i))}for(c=f;c<u;c++)ire(s,r[c]);return f}var dke="csSpsolve",fke=["divideScalar","multiply","subtract"],pke=re(dke,fke,n=>{var{divideScalar:e,multiply:t,subtract:r}=n;return function(s,a,o,l,u,c,h){var d=s._values,f=s._index,p=s._ptr,m=s._size,y=m[1],v=a._values,b=a._index,x=a._ptr,w,_,E,A,T=hke(s,a,o,l,c);for(w=T;w<y;w++)u[l[w]]=0;for(_=x[o],E=x[o+1],w=_;w<E;w++)u[b[w]]=v[w];for(var S=T;S<y;S++){var M=l[S],D=c?c[M]:M;if(!(D<0))for(_=p[D],E=p[D+1],u[M]=e(u[M],d[h?_:E-1]),w=h?_+1:_,A=h?E:E-1;w<A;w++){var N=f[w];u[N]=r(u[N],t(d[w],u[M]))}}return T}}),mke="csLu",gke=["abs","divideScalar","multiply","subtract","larger","largerEq","SparseMatrix"],vke=re(mke,gke,n=>{var{abs:e,divideScalar:t,multiply:r,subtract:i,larger:s,largerEq:a,SparseMatrix:o}=n,l=pke({divideScalar:t,multiply:r,subtract:i});return function(c,h,d){if(!c)return null;var f=c._size,p=f[1],m,y=100,v=100;h&&(m=h.q,y=h.lnz||y,v=h.unz||v);var b=[],x=[],w=[],_=new o({values:b,index:x,ptr:w,size:[p,p]}),E=[],A=[],T=[],S=new o({values:E,index:A,ptr:T,size:[p,p]}),M=[],D,N,R=[],O=[];for(D=0;D<p;D++)R[D]=0,M[D]=-1,w[D+1]=0;y=0,v=0;for(var G=0;G<p;G++){w[G]=y,T[G]=v;var I=m?m[G]:G,B=l(_,c,I,O,R,M,1),$=-1,H=-1;for(N=B;N<p;N++)if(D=O[N],M[D]<0){var Q=e(R[D]);s(Q,H)&&(H=Q,$=D)}else A[v]=M[D],E[v++]=R[D];if($===-1||H<=0)return null;M[I]<0&&a(e(R[I]),r(H,d))&&($=I);var ee=R[$];for(A[v]=G,E[v++]=ee,M[$]=G,x[y]=$,b[y++]=1,N=B;N<p;N++)D=O[N],M[D]<0&&(x[y]=D,b[y++]=t(R[D],ee)),R[D]=0}for(w[p]=y,T[p]=v,N=0;N<y;N++)x[N]=M[x[N]];return b.splice(y,b.length-y),x.splice(y,x.length-y),E.splice(v,E.length-v),A.splice(v,A.length-v),{L:_,U:S,pinv:M}}}),EG="slu",yke=["typed","abs","add","multiply","transpose","divideScalar","subtract","larger","largerEq","SparseMatrix"],xke=re(EG,yke,n=>{var{typed:e,abs:t,add:r,multiply:i,transpose:s,divideScalar:a,subtract:o,larger:l,largerEq:u,SparseMatrix:c}=n,h=uke({add:r,multiply:i,transpose:s}),d=vke({abs:t,divideScalar:a,multiply:i,subtract:o,larger:l,largerEq:u,SparseMatrix:c});return e(EG,{"SparseMatrix, number, number":function(p,m,y){if(!bt(m)||m<0||m>3)throw new Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(y<0||y>1)throw new Error("Partial pivoting threshold must be a number from 0 to 1");var v=h(m,p,!1),b=d(p,v,y);return{L:b.L,U:b.U,p:b.pinv,q:v.q,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
p: `+this.p.toString()+(this.q?`
q: `+this.q.toString():"")+`
`}}}})});function SG(n,e){var t,r=e.length,i=[];if(n)for(t=0;t<r;t++)i[n[t]]=e[t];else for(t=0;t<r;t++)i[t]=e[t];return i}var AG="lusolve",bke=["typed","matrix","lup","slu","usolve","lsolve","DenseMatrix"],_ke=re(AG,bke,n=>{var{typed:e,matrix:t,lup:r,slu:i,usolve:s,lsolve:a,DenseMatrix:o}=n,l=lA({DenseMatrix:o});return e(AG,{"Array, Array | Matrix":function(d,f){d=t(d);var p=r(d),m=c(p.L,p.U,p.p,null,f);return m.valueOf()},"DenseMatrix, Array | Matrix":function(d,f){var p=r(d);return c(p.L,p.U,p.p,null,f)},"SparseMatrix, Array | Matrix":function(d,f){var p=r(d);return c(p.L,p.U,p.p,null,f)},"SparseMatrix, Array | Matrix, number, number":function(d,f,p,m){var y=i(d,p,m);return c(y.L,y.U,y.p,y.q,f)},"Object, Array | Matrix":function(d,f){return c(d.L,d.U,d.p,d.q,f)}});function u(h){if(Dt(h))return h;if(Xn(h))return t(h);throw new TypeError("Invalid Matrix LU decomposition")}function c(h,d,f,p,m){h=u(h),d=u(d),f&&(m=l(h,m,!0),m._data=SG(f,m._data));var y=a(h,m),v=s(d,y);return p&&(v._data=SG(p,v._data)),v}}),TG="polynomialRoot",wke=["typed","isZero","equalScalar","add","subtract","multiply","divide","sqrt","unaryMinus","cbrt","typeOf","im","re"],Eke=re(TG,wke,n=>{var{typed:e,isZero:t,equalScalar:r,add:i,subtract:s,multiply:a,divide:o,sqrt:l,unaryMinus:u,cbrt:c,typeOf:h,im:d,re:f}=n;return e(TG,{"number|Complex, ...number|Complex":(p,m)=>{for(var y=[p,...m];y.length>0&&t(y[y.length-1]);)y.pop();if(y.length<2)throw new RangeError("Polynomial [".concat(p,", ").concat(m,"] must have a non-zero non-constant coefficient"));switch(y.length){case 2:return[u(o(y[0],y[1]))];case 3:{var[v,b,x]=y,w=a(2,x),_=a(b,b),E=a(4,x,v);if(r(_,E))return[o(u(b),w)];var A=l(s(_,E));return[o(s(A,b),w),o(s(u(A),b),w)]}case 4:{var[T,S,M,D]=y,N=u(a(3,D)),R=a(M,M),O=a(3,D,S),G=i(a(2,M,M,M),a(27,D,D,T)),I=a(9,D,M,S);if(r(R,O)&&r(G,I))return[o(M,N)];var B=s(R,O),$=s(G,I),H=i(a(18,D,M,S,T),a(M,M,S,S)),Q=i(a(4,M,M,M,T),a(4,D,S,S,S),a(27,D,D,T,T));if(r(H,Q))return[o(s(a(4,D,M,S),i(a(9,D,D,T),a(M,M,M))),a(D,B)),o(s(a(9,D,T),a(M,S)),a(2,B))];var ee;r(R,O)?ee=$:ee=o(i($,l(s(a($,$),a(4,B,B,B)))),2);var J=!0,L=c(ee,J).toArray().map(se=>o(i(M,se,o(B,se)),N));return L.map(se=>h(se)==="Complex"&&r(f(se),f(se)+d(se))?f(se):se)}default:throw new RangeError("only implemented for cubic or lower-order polynomials, not ".concat(y))}}})}),Ske="Help",Ake=["evaluate"],Tke=re(Ske,Ake,n=>{var{evaluate:e}=n;function t(r){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(!r)throw new Error('Argument "doc" missing');this.doc=r}return t.prototype.type="Help",t.prototype.isHelp=!0,t.prototype.toString=function(){var r=this.doc||{},i=`
`;if(r.name&&(i+="Name: "+r.name+`

`),r.category&&(i+="Category: "+r.category+`

`),r.description&&(i+=`Description:
    `+r.description+`

`),r.syntax&&(i+=`Syntax:
    `+r.syntax.join(`
    `)+`

`),r.examples){i+=`Examples:
`;for(var s=!1,a=e("config()"),o={config:h=>(s=!0,e("config(newConfig)",{newConfig:h}))},l=0;l<r.examples.length;l++){var u=r.examples[l];i+="    "+u+`
`;var c=void 0;try{c=e(u,o)}catch(h){c=h}c!==void 0&&!ute(c)&&(i+="        "+nn(c,{precision:14})+`
`)}i+=`
`,s&&e("config(originalConfig)",{originalConfig:a})}return r.mayThrow&&r.mayThrow.length&&(i+="Throws: "+r.mayThrow.join(", ")+`

`),r.seealso&&r.seealso.length&&(i+="See also: "+r.seealso.join(", ")+`
`),i},t.prototype.toJSON=function(){var r=Ut(this.doc);return r.mathjs="Help",r},t.fromJSON=function(r){var i={};return Object.keys(r).filter(s=>s!=="mathjs").forEach(s=>{i[s]=r[s]}),new t(i)},t.prototype.valueOf=t.prototype.toString,t},{isClass:!0}),Mke="Chain",Cke=["?on","math","typed"],Dke=re(Mke,Cke,n=>{var{on:e,math:t,typed:r}=n;function i(u){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");dte(u)?this.value=u.value:this.value=u}i.prototype.type="Chain",i.prototype.isChain=!0,i.prototype.done=function(){return this.value},i.prototype.valueOf=function(){return this.value},i.prototype.toString=function(){return nn(this.value)},i.prototype.toJSON=function(){return{mathjs:"Chain",value:this.value}},i.fromJSON=function(u){return new i(u.value)};function s(u,c){typeof c=="function"&&(i.prototype[u]=o(c))}function a(u,c){gMe(i.prototype,u,function(){var d=c();if(typeof d=="function")return o(d)})}function o(u){return function(){if(arguments.length===0)return new i(u(this.value));for(var c=[this.value],h=0;h<arguments.length;h++)c[h+1]=arguments[h];if(r.isTypedFunction(u)){var d=r.resolve(u,c);if(d.params.length===1)throw new Error("chain function "+u.name+" cannot match rest parameter between chain value and additional arguments.");return new i(d.implementation.apply(u,c))}return new i(u.apply(u,c))}}i.createProxy=function(u,c){if(typeof u=="string")s(u,c);else{var h=function(p){vt(u,p)&&l[p]===void 0&&a(p,()=>u[p])};for(var d in u)h(d)}};var l={expression:!0,docs:!0,type:!0,classes:!0,json:!0,error:!0,isChain:!0};return i.createProxy(t),e&&e("import",function(u,c,h){h||a(u,c)}),i},{isClass:!0}),MG={name:"e",category:"Constants",syntax:["e"],description:"Euler's number, the base of the natural logarithm. Approximately equal to 2.71828",examples:["e","e ^ 2","exp(2)","log(e)"],seealso:["exp"]},Nke={name:"false",category:"Constants",syntax:["false"],description:"Boolean value false",examples:["false"],seealso:["true"]},Rke={name:"i",category:"Constants",syntax:["i"],description:"Imaginary unit, defined as i*i=-1. A complex number is described as a + b*i, where a is the real part, and b is the imaginary part.",examples:["i","i * i","sqrt(-1)"],seealso:[]},Ike={name:"Infinity",category:"Constants",syntax:["Infinity"],description:"Infinity, a number which is larger than the maximum number that can be handled by a floating point number.",examples:["Infinity","1 / 0"],seealso:[]},Pke={name:"LN10",category:"Constants",syntax:["LN10"],description:"Returns the natural logarithm of 10, approximately equal to 2.302",examples:["LN10","log(10)"],seealso:[]},Fke={name:"LN2",category:"Constants",syntax:["LN2"],description:"Returns the natural logarithm of 2, approximately equal to 0.693",examples:["LN2","log(2)"],seealso:[]},Lke={name:"LOG10E",category:"Constants",syntax:["LOG10E"],description:"Returns the base-10 logarithm of E, approximately equal to 0.434",examples:["LOG10E","log(e, 10)"],seealso:[]},Oke={name:"LOG2E",category:"Constants",syntax:["LOG2E"],description:"Returns the base-2 logarithm of E, approximately equal to 1.442",examples:["LOG2E","log(e, 2)"],seealso:[]},kke={name:"NaN",category:"Constants",syntax:["NaN"],description:"Not a number",examples:["NaN","0 / 0"],seealso:[]},Bke={name:"null",category:"Constants",syntax:["null"],description:"Value null",examples:["null"],seealso:["true","false"]},Uke={name:"phi",category:"Constants",syntax:["phi"],description:"Phi is the golden ratio. Two quantities are in the golden ratio if their ratio is the same as the ratio of their sum to the larger of the two quantities. Phi is defined as `(1 + sqrt(5)) / 2` and is approximately 1.618034...",examples:["phi"],seealso:[]},CG={name:"pi",category:"Constants",syntax:["pi"],description:"The number pi is a mathematical constant that is the ratio of a circle's circumference to its diameter, and is approximately equal to 3.14159",examples:["pi","sin(pi/2)"],seealso:["tau"]},Vke={name:"SQRT1_2",category:"Constants",syntax:["SQRT1_2"],description:"Returns the square root of 1/2, approximately equal to 0.707",examples:["SQRT1_2","sqrt(1/2)"],seealso:[]},zke={name:"SQRT2",category:"Constants",syntax:["SQRT2"],description:"Returns the square root of 2, approximately equal to 1.414",examples:["SQRT2","sqrt(2)"],seealso:[]},$ke={name:"tau",category:"Constants",syntax:["tau"],description:"Tau is the ratio constant of a circle's circumference to radius, equal to 2 * pi, approximately 6.2832.",examples:["tau","2 * pi"],seealso:["pi"]},Hke={name:"true",category:"Constants",syntax:["true"],description:"Boolean value true",examples:["true"],seealso:["false"]},Gke={name:"version",category:"Constants",syntax:["version"],description:"A string with the version number of math.js",examples:["version"],seealso:[]},jke={name:"bignumber",category:"Construction",syntax:["bignumber(x)"],description:"Create a big number from a number or string.",examples:["0.1 + 0.2","bignumber(0.1) + bignumber(0.2)",'bignumber("7.2")','bignumber("7.2e500")',"bignumber([0.1, 0.2, 0.3])"],seealso:["boolean","bigint","complex","fraction","index","matrix","string","unit"]},qke={name:"bigint",category:"Construction",syntax:["bigint(x)"],description:"Create a bigint, an integer with an arbitrary number of digits, from a number or string.",examples:["123123123123123123 # a large number will lose digits",'bigint("123123123123123123")','bignumber(["1", "3", "5"])'],seealso:["boolean","bignumber","number","complex","fraction","index","matrix","string","unit"]},Wke={name:"boolean",category:"Construction",syntax:["x","boolean(x)"],description:"Convert a string or number into a boolean.",examples:["boolean(0)","boolean(1)","boolean(3)",'boolean("true")','boolean("false")',"boolean([1, 0, 1, 1])"],seealso:["bignumber","complex","index","matrix","number","string","unit"]},Xke={name:"complex",category:"Construction",syntax:["complex()","complex(re, im)","complex(string)"],description:"Create a complex number.",examples:["complex()","complex(2, 3)",'complex("7 - 2i")'],seealso:["bignumber","boolean","index","matrix","number","string","unit"]},Kke={name:"createUnit",category:"Construction",syntax:["createUnit(definitions)","createUnit(name, definition)"],description:"Create a user-defined unit and register it with the Unit type.",examples:['createUnit("foo")','createUnit("knot", {definition: "0.514444444 m/s", aliases: ["knots", "kt", "kts"]})','createUnit("mph", "1 mile/hour")'],seealso:["unit","splitUnit"]},Yke={name:"fraction",category:"Construction",syntax:["fraction(num)","fraction(matrix)","fraction(num,den)","fraction({n: num, d: den})"],description:"Create a fraction from a number or from integer numerator and denominator.",examples:["fraction(0.125)","fraction(1, 3) + fraction(2, 5)","fraction({n: 333, d: 53})","fraction([sqrt(9), sqrt(10), sqrt(11)])"],seealso:["bignumber","boolean","complex","index","matrix","string","unit"]},Qke={name:"index",category:"Construction",syntax:["[start]","[start:end]","[start:step:end]","[start1, start 2, ...]","[start1:end1, start2:end2, ...]","[start1:step1:end1, start2:step2:end2, ...]"],description:"Create an index to get or replace a subset of a matrix",examples:["A = [1, 2, 3; 4, 5, 6]","A[1, :]","A[1, 2] = 50","A[1:2, 1:2] = 1","B = [1, 2, 3]","B[B>1 and B<3]"],seealso:["bignumber","boolean","complex","matrix","number","range","string","unit"]},Zke={name:"matrix",category:"Construction",syntax:["[]","[a1, b1, ...; a2, b2, ...]","matrix()",'matrix("dense")',"matrix([...])"],description:"Create a matrix.",examples:["[]","[1, 2, 3]","[1, 2, 3; 4, 5, 6]","matrix()","matrix([3, 4])",'matrix([3, 4; 5, 6], "sparse")','matrix([3, 4; 5, 6], "sparse", "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","sparse"]},Jke={name:"number",category:"Construction",syntax:["x","number(x)","number(unit, valuelessUnit)"],description:"Create a number or convert a string or boolean into a number.",examples:["2","2e3","4.05","number(2)",'number("7.2")',"number(true)","number([true, false, true, true])",'number(unit("52cm"), "m")'],seealso:["bignumber","bigint","boolean","complex","fraction","index","matrix","string","unit"]},eBe={name:"sparse",category:"Construction",syntax:["sparse()","sparse([a1, b1, ...; a1, b2, ...])",'sparse([a1, b1, ...; a1, b2, ...], "number")'],description:"Create a sparse matrix.",examples:["sparse()","sparse([3, 4; 5, 6])",'sparse([3, 0; 5, 0], "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","matrix"]},tBe={name:"splitUnit",category:"Construction",syntax:["splitUnit(unit: Unit, parts: Unit[])"],description:"Split a unit in an array of units whose sum is equal to the original unit.",examples:['splitUnit(1 m, ["feet", "inch"])'],seealso:["unit","createUnit"]},nBe={name:"string",category:"Construction",syntax:['"text"',"string(x)"],description:"Create a string or convert a value to a string",examples:['"Hello World!"',"string(4.2)","string(3 + 2i)"],seealso:["bignumber","boolean","complex","index","matrix","number","unit"]},rBe={name:"unit",category:"Construction",syntax:["value unit","unit(value, unit)","unit(string)"],description:"Create a unit.",examples:["5.5 mm","3 inch",'unit(7.1, "kilogram")','unit("23 deg")'],seealso:["bignumber","boolean","complex","index","matrix","number","string"]},iBe={name:"config",category:"Core",syntax:["config()","config(options)"],description:"Get configuration or change configuration.",examples:["config()","1/3 + 1/4",'config({number: "Fraction"})',"1/3 + 1/4"],seealso:[]},sBe={name:"import",category:"Core",syntax:["import(functions)","import(functions, options)"],description:"Import functions or constants from an object.",examples:["import({myFn: f(x)=x^2, myConstant: 32 })","myFn(2)","myConstant"],seealso:[]},aBe={name:"typed",category:"Core",syntax:["typed(signatures)","typed(name, signatures)"],description:"Create a typed function.",examples:['double = typed({ "number": f(x)=x+x, "string": f(x)=concat(x,x) })',"double(2)",'double("hello")'],seealso:[]},oBe={name:"derivative",category:"Algebra",syntax:["derivative(expr, variable)","derivative(expr, variable, {simplify: boolean})"],description:"Takes the derivative of an expression expressed in parser Nodes. The derivative will be taken over the supplied variable in the second parameter. If there are multiple variables in the expression, it will return a partial derivative.",examples:['derivative("2x^3", "x")','derivative("2x^3", "x", {simplify: false})','derivative("2x^2 + 3x + 4", "x")','derivative("sin(2x)", "x")','f = parse("x^2 + x")','x = parse("x")',"df = derivative(f, x)","df.evaluate({x: 3})"],seealso:["simplify","parse","evaluate"]},lBe={name:"leafCount",category:"Algebra",syntax:["leafCount(expr)"],description:"Computes the number of leaves in the parse tree of the given expression",examples:['leafCount("e^(i*pi)-1")','leafCount(parse("{a: 22/7, b: 10^(1/2)}"))'],seealso:["simplify"]},uBe={name:"lsolve",category:"Algebra",syntax:["x=lsolve(L, b)"],description:"Finds one solution of the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lsolveAll","lup","lusolve","usolve","matrix","sparse"]},cBe={name:"lsolveAll",category:"Algebra",syntax:["x=lsolveAll(L, b)"],description:"Finds all solutions of the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lsolve","lup","lusolve","usolve","matrix","sparse"]},hBe={name:"lup",category:"Algebra",syntax:["lup(m)"],description:"Calculate the Matrix LU decomposition with partial pivoting. Matrix A is decomposed in three matrices (L, U, P) where P * A = L * U",examples:["lup([[2, 1], [1, 4]])","lup(matrix([[2, 1], [1, 4]]))","lup(sparse([[2, 1], [1, 4]]))"],seealso:["lusolve","lsolve","usolve","matrix","sparse","slu","qr"]},dBe={name:"lusolve",category:"Algebra",syntax:["x=lusolve(A, b)","x=lusolve(lu, b)"],description:"Solves the linear system A * x = b where A is an [n x n] matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lusolve(a, b)"],seealso:["lup","slu","lsolve","usolve","matrix","sparse"]},fBe={name:"polynomialRoot",category:"Algebra",syntax:["x=polynomialRoot(-6, 3)","x=polynomialRoot(4, -4, 1)","x=polynomialRoot(-8, 12, -6, 1)"],description:"Finds the roots of a univariate polynomial given by its coefficients starting from constant, linear, and so on, increasing in degree.",examples:["a = polynomialRoot(-6, 11, -6, 1)"],seealso:["cbrt","sqrt"]},pBe={name:"qr",category:"Algebra",syntax:["qr(A)"],description:"Calculates the Matrix QR decomposition. Matrix `A` is decomposed in two matrices (`Q`, `R`) where `Q` is an orthogonal matrix and `R` is an upper triangular matrix.",examples:["qr([[1, -1,  4], [1,  4, -2], [1,  4,  2], [1,  -1, 0]])"],seealso:["lup","slu","matrix"]},mBe={name:"rationalize",category:"Algebra",syntax:["rationalize(expr)","rationalize(expr, scope)","rationalize(expr, scope, detailed)"],description:"Transform a rationalizable expression in a rational fraction. If rational fraction is one variable polynomial then converts the numerator and denominator in canonical form, with decreasing exponents, returning the coefficients of numerator.",examples:['rationalize("2x/y - y/(x+1)")','rationalize("2x/y - y/(x+1)", true)'],seealso:["simplify"]},gBe={name:"resolve",category:"Algebra",syntax:["resolve(node, scope)"],description:"Recursively substitute variables in an expression tree.",examples:['resolve(parse("1 + x"), { x: 7 })','resolve(parse("size(text)"), { text: "Hello World" })','resolve(parse("x + y"), { x: parse("3z") })','resolve(parse("3x"), { x: parse("y+z"), z: parse("w^y") })'],seealso:["simplify","evaluate"],mayThrow:["ReferenceError"]},vBe={name:"simplify",category:"Algebra",syntax:["simplify(expr)","simplify(expr, rules)"],description:"Simplify an expression tree.",examples:['simplify("3 + 2 / 4")','simplify("2x + x")','f = parse("x * (x + 2 + x)")',"simplified = simplify(f)","simplified.evaluate({x: 2})"],seealso:["simplifyCore","derivative","evaluate","parse","rationalize","resolve"]},yBe={name:"simplifyConstant",category:"Algebra",syntax:["simplifyConstant(expr)","simplifyConstant(expr, options)"],description:"Replace constant subexpressions of node with their values.",examples:['simplifyConstant("(3-3)*x")','simplifyConstant(parse("z-cos(tau/8)"))'],seealso:["simplify","simplifyCore","evaluate"]},xBe={name:"simplifyCore",category:"Algebra",syntax:["simplifyCore(node)"],description:"Perform simple one-pass simplifications on an expression tree.",examples:['simplifyCore(parse("0*x"))','simplifyCore(parse("(x+0)*2"))'],seealso:["simplify","simplifyConstant","evaluate"]},bBe={name:"slu",category:"Algebra",syntax:["slu(A, order, threshold)"],description:"Calculate the Matrix LU decomposition with full pivoting. Matrix A is decomposed in two matrices (L, U) and two permutation vectors (pinv, q) where P * A * Q = L * U",examples:["slu(sparse([4.5, 0, 3.2, 0; 3.1, 2.9, 0, 0.9; 0, 1.7, 3, 0; 3.5, 0.4, 0, 1]), 1, 0.001)"],seealso:["lusolve","lsolve","usolve","matrix","sparse","lup","qr"]},_Be={name:"symbolicEqual",category:"Algebra",syntax:["symbolicEqual(expr1, expr2)","symbolicEqual(expr1, expr2, options)"],description:"Returns true if the difference of the expressions simplifies to 0",examples:['symbolicEqual("x*y","y*x")','symbolicEqual("abs(x^2)", "x^2")','symbolicEqual("abs(x)", "x", {context: {abs: {trivial: true}}})'],seealso:["simplify","evaluate"]},wBe={name:"usolve",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Finds one solution of the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["usolveAll","lup","lusolve","lsolve","matrix","sparse"]},EBe={name:"usolveAll",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Finds all solutions of the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["usolve","lup","lusolve","lsolve","matrix","sparse"]},SBe={name:"abs",category:"Arithmetic",syntax:["abs(x)"],description:"Compute the absolute value.",examples:["abs(3.5)","abs(-4.2)"],seealso:["sign"]},ABe={name:"add",category:"Operators",syntax:["x + y","add(x, y)"],description:"Add two values.",examples:["a = 2.1 + 3.6","a - 3.6","3 + 2i","3 cm + 2 inch",'"2.3" + "4"'],seealso:["subtract"]},TBe={name:"cbrt",category:"Arithmetic",syntax:["cbrt(x)","cbrt(x, allRoots)"],description:"Compute the cubic root value. If x = y * y * y, then y is the cubic root of x. When `x` is a number or complex number, an optional second argument `allRoots` can be provided to return all three cubic roots. If not provided, the principal root is returned",examples:["cbrt(64)","cube(4)","cbrt(-8)","cbrt(2 + 3i)","cbrt(8i)","cbrt(8i, true)","cbrt(27 m^3)"],seealso:["square","sqrt","cube","multiply"]},MBe={name:"ceil",category:"Arithmetic",syntax:["ceil(x)","ceil(x, n)","ceil(unit, valuelessUnit)","ceil(unit, n, valuelessUnit)"],description:"Round a value towards plus infinity. If x is complex, both real and imaginary part are rounded towards plus infinity.",examples:["ceil(3.2)","ceil(3.8)","ceil(-4.2)","ceil(3.241cm, cm)","ceil(3.241cm, 2, cm)"],seealso:["floor","fix","round"]},CBe={name:"cube",category:"Arithmetic",syntax:["cube(x)"],description:"Compute the cube of a value. The cube of x is x * x * x.",examples:["cube(2)","2^3","2 * 2 * 2"],seealso:["multiply","square","pow"]},DBe={name:"divide",category:"Operators",syntax:["x / y","divide(x, y)"],description:"Divide two values.",examples:["a = 2 / 3","a * 3","4.5 / 2","3 + 4 / 2","(3 + 4) / 2","18 km / 4.5"],seealso:["multiply"]},NBe={name:"dotDivide",category:"Operators",syntax:["x ./ y","dotDivide(x, y)"],description:"Divide two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a ./ b"],seealso:["multiply","dotMultiply","divide"]},RBe={name:"dotMultiply",category:"Operators",syntax:["x .* y","dotMultiply(x, y)"],description:"Multiply two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a .* b"],seealso:["multiply","divide","dotDivide"]},IBe={name:"dotPow",category:"Operators",syntax:["x .^ y","dotPow(x, y)"],description:"Calculates the power of x to y element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","a .^ 2"],seealso:["pow"]},PBe={name:"exp",category:"Arithmetic",syntax:["exp(x)"],description:"Calculate the exponent of a value.",examples:["exp(1.3)","e ^ 1.3","log(exp(1.3))","x = 2.4","(exp(i*x) == cos(x) + i*sin(x))   # Euler's formula"],seealso:["expm","expm1","pow","log"]},FBe={name:"expm",category:"Arithmetic",syntax:["exp(x)"],description:"Compute the matrix exponential, expm(A) = e^A. The matrix must be square. Not to be confused with exp(a), which performs element-wise exponentiation.",examples:["expm([[0,2],[0,0]])"],seealso:["exp"]},LBe={name:"expm1",category:"Arithmetic",syntax:["expm1(x)"],description:"Calculate the value of subtracting 1 from the exponential value.",examples:["expm1(2)","pow(e, 2) - 1","log(expm1(2) + 1)"],seealso:["exp","pow","log"]},OBe={name:"fix",category:"Arithmetic",syntax:["fix(x)","fix(x, n)","fix(unit, valuelessUnit)","fix(unit, n, valuelessUnit)"],description:"Round a value towards zero. If x is complex, both real and imaginary part are rounded towards zero.",examples:["fix(3.2)","fix(3.8)","fix(-4.2)","fix(-4.8)","fix(3.241cm, cm)","fix(3.241cm, 2, cm)"],seealso:["ceil","floor","round"]},kBe={name:"floor",category:"Arithmetic",syntax:["floor(x)","floor(x, n)","floor(unit, valuelessUnit)","floor(unit, n, valuelessUnit)"],description:"Round a value towards minus infinity.If x is complex, both real and imaginary part are rounded towards minus infinity.",examples:["floor(3.2)","floor(3.8)","floor(-4.2)","floor(3.241cm, cm)","floor(3.241cm, 2, cm)"],seealso:["ceil","fix","round"]},BBe={name:"gcd",category:"Arithmetic",syntax:["gcd(a, b)","gcd(a, b, c, ...)"],description:"Compute the greatest common divisor.",examples:["gcd(8, 12)","gcd(-4, 6)","gcd(25, 15, -10)"],seealso:["lcm","xgcd"]},UBe={name:"hypot",category:"Arithmetic",syntax:["hypot(a, b, c, ...)","hypot([a, b, c, ...])"],description:"Calculate the hypotenuse of a list with values.",examples:["hypot(3, 4)","sqrt(3^2 + 4^2)","hypot(-2)","hypot([3, 4, 5])"],seealso:["abs","norm"]},VBe={name:"invmod",category:"Arithmetic",syntax:["invmod(a, b)"],description:"Calculate the (modular) multiplicative inverse of a modulo b. Solution to the equation ax  1 (mod b)",examples:["invmod(8, 12)","invmod(7, 13)","invmod(15151, 15122)"],seealso:["gcd","xgcd"]},zBe={name:"lcm",category:"Arithmetic",syntax:["lcm(x, y)"],description:"Compute the least common multiple.",examples:["lcm(4, 6)","lcm(6, 21)","lcm(6, 21, 5)"],seealso:["gcd"]},$Be={name:"log",category:"Arithmetic",syntax:["log(x)","log(x, base)"],description:"Compute the logarithm of a value. If no base is provided, the natural logarithm of x is calculated. If base if provided, the logarithm is calculated for the specified base. log(x, base) is defined as log(x) / log(base).",examples:["log(3.5)","a = log(2.4)","exp(a)","10 ^ 4","log(10000, 10)","log(10000) / log(10)","b = log(1024, 2)","2 ^ b"],seealso:["exp","log1p","log2","log10"]},HBe={name:"log10",category:"Arithmetic",syntax:["log10(x)"],description:"Compute the 10-base logarithm of a value.",examples:["log10(0.00001)","log10(10000)","10 ^ 4","log(10000) / log(10)","log(10000, 10)"],seealso:["exp","log"]},GBe={name:"log1p",category:"Arithmetic",syntax:["log1p(x)","log1p(x, base)"],description:"Calculate the logarithm of a `value+1`",examples:["log1p(2.5)","exp(log1p(1.4))","pow(10, 4)","log1p(9999, 10)","log1p(9999) / log(10)"],seealso:["exp","log","log2","log10"]},jBe={name:"log2",category:"Arithmetic",syntax:["log2(x)"],description:"Calculate the 2-base of a value. This is the same as calculating `log(x, 2)`.",examples:["log2(0.03125)","log2(16)","log2(16) / log2(2)","pow(2, 4)"],seealso:["exp","log1p","log","log10"]},qBe={name:"mod",category:"Operators",syntax:["x % y","x mod y","mod(x, y)"],description:"Calculates the modulus, the remainder of an integer division.",examples:["7 % 3","11 % 2","10 mod 4","isOdd(x) = x % 2","isOdd(2)","isOdd(3)"],seealso:["divide"]},WBe={name:"multiply",category:"Operators",syntax:["x * y","multiply(x, y)"],description:"multiply two values.",examples:["a = 2.1 * 3.4","a / 3.4","2 * 3 + 4","2 * (3 + 4)","3 * 2.1 km"],seealso:["divide"]},XBe={name:"norm",category:"Arithmetic",syntax:["norm(x)","norm(x, p)"],description:"Calculate the norm of a number, vector or matrix.",examples:["abs(-3.5)","norm(-3.5)","norm(3 - 4i)","norm([1, 2, -3], Infinity)","norm([1, 2, -3], -Infinity)","norm([3, 4], 2)","norm([[1, 2], [3, 4]], 1)",'norm([[1, 2], [3, 4]], "inf")','norm([[1, 2], [3, 4]], "fro")']},KBe={name:"nthRoot",category:"Arithmetic",syntax:["nthRoot(a)","nthRoot(a, root)"],description:'Calculate the nth root of a value. The principal nth root of a positive real number A, is the positive real solution of the equation "x^root = A".',examples:["4 ^ 3","nthRoot(64, 3)","nthRoot(9, 2)","sqrt(9)"],seealso:["nthRoots","pow","sqrt"]},YBe={name:"nthRoots",category:"Arithmetic",syntax:["nthRoots(A)","nthRoots(A, root)"],description:'Calculate the nth roots of a value. An nth root of a positive real number A, is a positive real solution of the equation "x^root = A". This function returns an array of complex values.',examples:["nthRoots(1)","nthRoots(1, 3)"],seealso:["sqrt","pow","nthRoot"]},QBe={name:"pow",category:"Operators",syntax:["x ^ y","pow(x, y)"],description:"Calculates the power of x to y, x^y.",examples:["2^3","2*2*2","1 + e ^ (pi * i)","pow([[1, 2], [4, 3]], 2)","pow([[1, 2], [4, 3]], -1)"],seealso:["multiply","nthRoot","nthRoots","sqrt"]},ZBe={name:"round",category:"Arithmetic",syntax:["round(x)","round(x, n)","round(unit, valuelessUnit)","round(unit, n, valuelessUnit)"],description:"round a value towards the nearest integer.If x is complex, both real and imaginary part are rounded towards the nearest integer. When n is specified, the value is rounded to n decimals.",examples:["round(3.2)","round(3.8)","round(-4.2)","round(-4.8)","round(pi, 3)","round(123.45678, 2)","round(3.241cm, 2, cm)","round([3.2, 3.8, -4.7])"],seealso:["ceil","floor","fix"]},JBe={name:"sign",category:"Arithmetic",syntax:["sign(x)"],description:"Compute the sign of a value. The sign of a value x is 1 when x>0, -1 when x<0, and 0 when x=0.",examples:["sign(3.5)","sign(-4.2)","sign(0)"],seealso:["abs"]},e4e={name:"sqrt",category:"Arithmetic",syntax:["sqrt(x)"],description:"Compute the square root value. If x = y * y, then y is the square root of x.",examples:["sqrt(25)","5 * 5","sqrt(-1)"],seealso:["square","sqrtm","multiply","nthRoot","nthRoots","pow"]},t4e={name:"sqrtm",category:"Arithmetic",syntax:["sqrtm(x)"],description:"Calculate the principal square root of a square matrix. The principal square root matrix `X` of another matrix `A` is such that `X * X = A`.",examples:["sqrtm([[33, 24], [48, 57]])"],seealso:["sqrt","abs","square","multiply"]},n4e={name:"sylvester",category:"Algebra",syntax:["sylvester(A,B,C)"],description:"Solves the real-valued Sylvester equation AX+XB=C for X",examples:["sylvester([[-1, -2], [1, 1]], [[-2, 1], [-1, 2]], [[-3, 2], [3, 0]])","A = [[-1, -2], [1, 1]]; B = [[2, -1], [1, -2]]; C = [[-3, 2], [3, 0]]","sylvester(A, B, C)"],seealso:["schur","lyap"]},r4e={name:"schur",category:"Algebra",syntax:["schur(A)"],description:"Performs a real Schur decomposition of the real matrix A = UTU'",examples:["schur([[1, 0], [-4, 3]])","A = [[1, 0], [-4, 3]]","schur(A)"],seealso:["lyap","sylvester"]},i4e={name:"lyap",category:"Algebra",syntax:["lyap(A,Q)"],description:"Solves the Continuous-time Lyapunov equation AP+PA'+Q=0 for P",examples:["lyap([[-2, 0], [1, -4]], [[3, 1], [1, 3]])","A = [[-2, 0], [1, -4]]","Q = [[3, 1], [1, 3]]","lyap(A,Q)"],seealso:["schur","sylvester"]},s4e={name:"square",category:"Arithmetic",syntax:["square(x)"],description:"Compute the square of a value. The square of x is x * x.",examples:["square(3)","sqrt(9)","3^2","3 * 3"],seealso:["multiply","pow","sqrt","cube"]},a4e={name:"subtract",category:"Operators",syntax:["x - y","subtract(x, y)"],description:"subtract two values.",examples:["a = 5.3 - 2","a + 2","2/3 - 1/6","2 * 3 - 3","2.1 km - 500m"],seealso:["add"]},o4e={name:"unaryMinus",category:"Operators",syntax:["-x","unaryMinus(x)"],description:"Inverse the sign of a value. Converts booleans and strings to numbers.",examples:["-4.5","-(-5.6)",'-"22"'],seealso:["add","subtract","unaryPlus"]},l4e={name:"unaryPlus",category:"Operators",syntax:["+x","unaryPlus(x)"],description:"Converts booleans and strings to numbers.",examples:["+true",'+"2"'],seealso:["add","subtract","unaryMinus"]},u4e={name:"xgcd",category:"Arithmetic",syntax:["xgcd(a, b)"],description:"Calculate the extended greatest common divisor for two values. The result is an array [d, x, y] with 3 entries, where d is the greatest common divisor, and d = x * a + y * b.",examples:["xgcd(8, 12)","gcd(8, 12)","xgcd(36163, 21199)"],seealso:["gcd","lcm"]},c4e={name:"bitAnd",category:"Bitwise",syntax:["x & y","bitAnd(x, y)"],description:"Bitwise AND operation. Performs the logical AND operation on each pair of the corresponding bits of the two given values by multiplying them. If both bits in the compared position are 1, the bit in the resulting binary representation is 1, otherwise, the result is 0",examples:["5 & 3","bitAnd(53, 131)","[1, 12, 31] & 42"],seealso:["bitNot","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},h4e={name:"bitNot",category:"Bitwise",syntax:["~x","bitNot(x)"],description:"Bitwise NOT operation. Performs a logical negation on each bit of the given value. Bits that are 0 become 1, and those that are 1 become 0.",examples:["~1","~2","bitNot([2, -3, 4])"],seealso:["bitAnd","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},d4e={name:"bitOr",category:"Bitwise",syntax:["x | y","bitOr(x, y)"],description:"Bitwise OR operation. Performs the logical inclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if the first bit is 1 or the second bit is 1 or both bits are 1, otherwise, the result is 0.",examples:["5 | 3","bitOr([1, 2, 3], 4)"],seealso:["bitAnd","bitNot","bitXor","leftShift","rightArithShift","rightLogShift"]},f4e={name:"bitXor",category:"Bitwise",syntax:["bitXor(x, y)"],description:"Bitwise XOR operation, exclusive OR. Performs the logical exclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but will be 0 if both are 0 or both are 1.",examples:["bitOr(1, 2)","bitXor([2, 3, 4], 4)"],seealso:["bitAnd","bitNot","bitOr","leftShift","rightArithShift","rightLogShift"]},p4e={name:"leftShift",category:"Bitwise",syntax:["x << y","leftShift(x, y)"],description:"Bitwise left logical shift of a value x by y number of bits.",examples:["4 << 1","8 >> 1"],seealso:["bitAnd","bitNot","bitOr","bitXor","rightArithShift","rightLogShift"]},m4e={name:"rightArithShift",category:"Bitwise",syntax:["x >> y","rightArithShift(x, y)"],description:"Bitwise right arithmetic shift of a value x by y number of bits.",examples:["8 >> 1","4 << 1","-12 >> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightLogShift"]},g4e={name:"rightLogShift",category:"Bitwise",syntax:["x >>> y","rightLogShift(x, y)"],description:"Bitwise right logical shift of a value x by y number of bits.",examples:["8 >>> 1","4 << 1","-12 >>> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightArithShift"]},v4e={name:"bellNumbers",category:"Combinatorics",syntax:["bellNumbers(n)"],description:"The Bell Numbers count the number of partitions of a set. A partition is a pairwise disjoint subset of S whose union is S. `bellNumbers` only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["bellNumbers(3)","bellNumbers(8)"],seealso:["stirlingS2"]},y4e={name:"catalan",category:"Combinatorics",syntax:["catalan(n)"],description:"The Catalan Numbers enumerate combinatorial structures of many different types. catalan only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["catalan(3)","catalan(8)"],seealso:["bellNumbers"]},x4e={name:"composition",category:"Combinatorics",syntax:["composition(n, k)"],description:"The composition counts of n into k parts. composition only takes integer arguments. The following condition must be enforced: k <= n.",examples:["composition(5, 3)"],seealso:["combinations"]},b4e={name:"stirlingS2",category:"Combinatorics",syntax:["stirlingS2(n, k)"],description:"The Stirling numbers of the second kind, counts the number of ways to partition a set of n labelled objects into k nonempty unlabelled subsets. `stirlingS2` only takes integer arguments. The following condition must be enforced: k <= n. If n = k or k = 1, then s(n,k) = 1.",examples:["stirlingS2(5, 3)"],seealso:["bellNumbers","bernoulli"]},_4e={name:"arg",category:"Complex",syntax:["arg(x)"],description:"Compute the argument of a complex value. If x = a+bi, the argument is computed as atan2(b, a).",examples:["arg(2 + 2i)","atan2(3, 2)","arg(2 + 3i)"],seealso:["re","im","conj","abs"]},w4e={name:"conj",category:"Complex",syntax:["conj(x)"],description:"Compute the complex conjugate of a complex value. If x = a+bi, the complex conjugate is a-bi.",examples:["conj(2 + 3i)","conj(2 - 3i)","conj(-5.2i)"],seealso:["re","im","abs","arg"]},E4e={name:"im",category:"Complex",syntax:["im(x)"],description:"Get the imaginary part of a complex number.",examples:["im(2 + 3i)","re(2 + 3i)","im(-5.2i)","im(2.4)"],seealso:["re","conj","abs","arg"]},S4e={name:"re",category:"Complex",syntax:["re(x)"],description:"Get the real part of a complex number.",examples:["re(2 + 3i)","im(2 + 3i)","re(-5.2i)","re(2.4)"],seealso:["im","conj","abs","arg"]},A4e={name:"evaluate",category:"Expression",syntax:["evaluate(expression)","evaluate(expression, scope)","evaluate([expr1, expr2, expr3, ...])","evaluate([expr1, expr2, expr3, ...], scope)"],description:"Evaluate an expression or an array with expressions.",examples:['evaluate("2 + 3")','evaluate("sqrt(16)")','evaluate("2 inch to cm")','evaluate("sin(x * pi)", { "x": 1/2 })','evaluate(["width=2", "height=4","width*height"])'],seealso:["parser","parse","compile"]},T4e={name:"parser",category:"Expression",syntax:["parser()"],description:"Create a parser object that keeps a context of variables and their values, allowing the evaluation of expressions in that context.",examples:["myParser = parser()",'myParser.evaluate("sqrt(3^2 + 4^2)")','myParser.set("x", 3)','myParser.evaluate("y = x + 3")','myParser.evaluate(["y = x + 3", "y = y + 1"])','myParser.get("y")'],seealso:["evaluate","parse","compile"]},M4e={name:"parse",category:"Expression",syntax:["parse(expr)","parse(expr, options)","parse([expr1, expr2, expr3, ...])","parse([expr1, expr2, expr3, ...], options)"],description:"Parse an expression. Returns a node tree, which can be evaluated by invoking node.evaluate() or transformed into a functional object via node.compile().",examples:['node1 = parse("sqrt(3^2 + 4^2)")',"node1.evaluate()","code1 = node1.compile()","code1.evaluate()","scope = {a: 3, b: 4}",'node2 = parse("a * b")',"node2.evaluate(scope)","code2 = node2.compile()","code2.evaluate(scope)"],seealso:["parser","evaluate","compile"]},C4e={name:"compile",category:"Expression",syntax:["compile(expr) ","compile([expr1, expr2, expr3, ...])"],description:"Parse and compile an expression. Returns a an object with a function evaluate([scope]) to evaluate the compiled expression.",examples:['code1 = compile("sqrt(3^2 + 4^2)")',"code1.evaluate() ",'code2 = compile("a * b")',"code2.evaluate({a: 3, b: 4})"],seealso:["parser","parse","evaluate"]},D4e={name:"help",category:"Expression",syntax:["help(object)","help(string)"],description:"Display documentation on a function or data type.",examples:["help(sqrt)",'help("complex")'],seealso:[]},N4e={name:"distance",category:"Geometry",syntax:["distance([x1, y1], [x2, y2])","distance([[x1, y1], [x2, y2]])"],description:"Calculates the Euclidean distance between two points.",examples:["distance([0,0], [4,4])","distance([[0,0], [4,4]])"],seealso:[]},R4e={name:"intersect",category:"Geometry",syntax:["intersect(expr1, expr2, expr3, expr4)","intersect(expr1, expr2, expr3)"],description:"Computes the intersection point of lines and/or planes.",examples:["intersect([0, 0], [10, 10], [10, 0], [0, 10])","intersect([1, 0, 1],  [4, -2, 2], [1, 1, 1, 6])"],seealso:[]},I4e={name:"and",category:"Logical",syntax:["x and y","and(x, y)"],description:"Logical and. Test whether two values are both defined with a nonzero/nonempty value.",examples:["true and false","true and true","2 and 4"],seealso:["not","or","xor"]},P4e={name:"not",category:"Logical",syntax:["not x","not(x)"],description:"Logical not. Flips the boolean value of given argument.",examples:["not true","not false","not 2","not 0"],seealso:["and","or","xor"]},F4e={name:"nullish",category:"Logical",syntax:["x ?? y","nullish(x, y)"],description:"Nullish coalescing operator. Returns the right-hand operand when the left-hand operand is null or undefined, and otherwise returns the left-hand operand.",examples:["null ?? 42","undefined ?? 42","0 ?? 42","false ?? 42","null ?? undefined ?? 42"],seealso:["and","or","not"]},L4e={name:"or",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical or. Test if at least one value is defined with a nonzero/nonempty value.",examples:["true or false","false or false","0 or 4"],seealso:["not","and","xor"]},O4e={name:"xor",category:"Logical",syntax:["x xor y","xor(x, y)"],description:"Logical exclusive or, xor. Test whether one and only one value is defined with a nonzero/nonempty value.",examples:["true xor false","false xor false","true xor true","0 xor 4"],seealso:["not","and","or"]},k4e={name:"mapSlices",category:"Matrix",syntax:["mapSlices(A, dim, callback)"],description:"Generate a matrix one dimension less than A by applying callback to each slice of A along dimension dim.",examples:["A = [[1, 2], [3, 4]]","mapSlices(A, 1, sum)","mapSlices(A, 2, prod)"],seealso:["map","forEach"]},B4e={name:"column",category:"Matrix",syntax:["column(x, index)"],description:"Return a column from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","column(A, 1)","column(A, 2)"],seealso:["row","matrixFromColumns"]},U4e={name:"concat",category:"Matrix",syntax:["concat(A, B, C, ...)","concat(A, B, C, ..., dim)"],description:"Concatenate matrices. By default, the matrices are concatenated by the last dimension. The dimension on which to concatenate can be provided as last argument.",examples:["A = [1, 2; 5, 6]","B = [3, 4; 7, 8]","concat(A, B)","concat(A, B, 1)","concat(A, B, 2)"],seealso:["det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},V4e={name:"count",category:"Matrix",syntax:["count(x)"],description:"Count the number of elements of a matrix, array or string.",examples:["a = [1, 2; 3, 4; 5, 6]","count(a)","size(a)",'count("hello world")'],seealso:["size"]},z4e={name:"cross",category:"Matrix",syntax:["cross(A, B)"],description:"Calculate the cross product for two vectors in three dimensional space.",examples:["cross([1, 1, 0],  [0, 1, 1])","cross([3, -3, 1], [4, 9, 2])","cross([2, 3, 4],  [5, 6, 7])"],seealso:["multiply","dot"]},$4e={name:"ctranspose",category:"Matrix",syntax:["x'","ctranspose(x)"],description:"Complex Conjugate and Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","ctranspose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},H4e={name:"det",category:"Matrix",syntax:["det(x)"],description:"Calculate the determinant of a matrix",examples:["det([1, 2; 3, 4])","det([-2, 2, 3; -1, 1, 3; 2, 0, -1])"],seealso:["concat","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},G4e={name:"diag",category:"Matrix",syntax:["diag(x)","diag(x, k)"],description:"Create a diagonal matrix or retrieve the diagonal of a matrix. When x is a vector, a matrix with the vector values on the diagonal will be returned. When x is a matrix, a vector with the diagonal values of the matrix is returned. When k is provided, the k-th diagonal will be filled in or retrieved, if k is positive, the values are placed on the super diagonal. When k is negative, the values are placed on the sub diagonal.",examples:["diag(1:3)","diag(1:3, 1)","a = [1, 2, 3; 4, 5, 6; 7, 8, 9]","diag(a)"],seealso:["concat","det","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},j4e={name:"diff",category:"Matrix",syntax:["diff(arr)","diff(arr, dim)"],description:["Create a new matrix or array with the difference of the passed matrix or array.","Dim parameter is optional and used to indicate the dimension of the array/matrix to apply the difference","If no dimension parameter is passed it is assumed as dimension 0","Dimension is zero-based in javascript and one-based in the parser","Arrays must be 'rectangular' meaning arrays like [1, 2]","If something is passed as a matrix it will be returned as a matrix but other than that all matrices are converted to arrays"],examples:["A = [1, 2, 4, 7, 0]","diff(A)","diff(A, 1)","B = [[1, 2], [3, 4]]","diff(B)","diff(B, 1)","diff(B, 2)","diff(B, bignumber(2))","diff([[1, 2], matrix([3, 4])], 2)"],seealso:["subtract","partitionSelect"]},q4e={name:"dot",category:"Matrix",syntax:["dot(A, B)","A * B"],description:"Calculate the dot product of two vectors. The dot product of A = [a1, a2, a3, ..., an] and B = [b1, b2, b3, ..., bn] is defined as dot(A, B) = a1 * b1 + a2 * b2 + a3 * b3 + ... + an * bn",examples:["dot([2, 4, 1], [2, 2, 3])","[2, 4, 1] * [2, 2, 3]"],seealso:["multiply","cross"]},W4e={name:"eigs",category:"Matrix",syntax:["eigs(x)"],description:"Calculate the eigenvalues and optionally eigenvectors of a square matrix",examples:["eigs([[5, 2.3], [2.3, 1]])","eigs([[1, 2, 3], [4, 5, 6], [7, 8, 9]], { precision: 1e-6, eigenvectors: false })"],seealso:["inv"]},X4e={name:"filter",category:"Matrix",syntax:["filter(x, test)"],description:"Filter items in a matrix.",examples:["isPositive(x) = x > 0","filter([6, -2, -1, 4, 3], isPositive)","filter([6, -2, 0, 1, 0], x != 0)"],seealso:["sort","map","forEach"]},K4e={name:"flatten",category:"Matrix",syntax:["flatten(x)"],description:"Flatten a multi dimensional matrix into a single dimensional matrix.",examples:["a = [1, 2, 3; 4, 5, 6]","size(a)","b = flatten(a)","size(b)"],seealso:["concat","resize","size","squeeze"]},Y4e={name:"forEach",category:"Matrix",syntax:["forEach(x, callback)"],description:"Iterates over all elements of a matrix/array, and executes the given callback function.",examples:["numberOfPets = {}","addPet(n) = numberOfPets[n] = (numberOfPets[n] ? numberOfPets[n]:0 ) + 1;",'forEach(["Dog","Cat","Cat"], addPet)',"numberOfPets"],seealso:["map","sort","filter"]},Q4e={name:"getMatrixDataType",category:"Matrix",syntax:["getMatrixDataType(x)"],description:'Find the data type of all elements in a matrix or array, for example "number" if all items are a number and "Complex" if all values are complex numbers. If a matrix contains more than one data type, it will return "mixed".',examples:["getMatrixDataType([1, 2, 3])","getMatrixDataType([[5 cm], [2 inch]])",'getMatrixDataType([1, "text"])',"getMatrixDataType([1, bignumber(4)])"],seealso:["matrix","sparse","typeOf"]},Z4e={name:"identity",category:"Matrix",syntax:["identity(n)","identity(m, n)","identity([m, n])"],description:"Returns the identity matrix with size m-by-n. The matrix has ones on the diagonal and zeros elsewhere.",examples:["identity(3)","identity(3, 5)","a = [1, 2, 3; 4, 5, 6]","identity(size(a))"],seealso:["concat","det","diag","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},J4e={name:"inv",category:"Matrix",syntax:["inv(x)"],description:"Calculate the inverse of a matrix",examples:["inv([1, 2; 3, 4])","inv(4)","1 / 4"],seealso:["concat","det","diag","identity","ones","range","size","squeeze","subset","trace","transpose","zeros"]},eUe={name:"pinv",category:"Matrix",syntax:["pinv(x)"],description:"Calculate the MoorePenrose inverse of a matrix",examples:["pinv([1, 2; 3, 4])","pinv([[1, 0], [0, 1], [0, 1]])","pinv(4)"],seealso:["inv"]},tUe={name:"kron",category:"Matrix",syntax:["kron(x, y)"],description:"Calculates the Kronecker product of 2 matrices or vectors.",examples:["kron([[1, 0], [0, 1]], [[1, 2], [3, 4]])","kron([1,1], [2,3,4])"],seealso:["multiply","dot","cross"]},nUe={name:"map",category:"Matrix",syntax:["map(x, callback)","map(x, y, ..., callback)"],description:"Create a new matrix or array with the results of the callback function executed on each entry of the matrix/array or the matrices/arrays.",examples:["map([1, 2, 3], square)","map([1, 2], [3, 4], f(a,b) = a + b)"],seealso:["filter","forEach"]},rUe={name:"matrixFromColumns",category:"Matrix",syntax:["matrixFromColumns(...arr)","matrixFromColumns(row1, row2)","matrixFromColumns(row1, row2, row3)"],description:"Create a dense matrix from vectors as individual columns.",examples:["matrixFromColumns([1, 2, 3], [[4],[5],[6]])"],seealso:["matrix","matrixFromRows","matrixFromFunction","zeros"]},iUe={name:"matrixFromFunction",category:"Matrix",syntax:["matrixFromFunction(size, fn)","matrixFromFunction(size, fn, format)","matrixFromFunction(size, fn, format, datatype)","matrixFromFunction(size, format, fn)","matrixFromFunction(size, format, datatype, fn)"],description:"Create a matrix by evaluating a generating function at each index.",examples:["f(I) = I[1] - I[2]","matrixFromFunction([3,3], f)","g(I) = I[1] - I[2] == 1 ? 4 : 0",'matrixFromFunction([100, 100], "sparse", g)',"matrixFromFunction([5], random)"],seealso:["matrix","matrixFromRows","matrixFromColumns","zeros"]},sUe={name:"matrixFromRows",category:"Matrix",syntax:["matrixFromRows(...arr)","matrixFromRows(row1, row2)","matrixFromRows(row1, row2, row3)"],description:"Create a dense matrix from vectors as individual rows.",examples:["matrixFromRows([1, 2, 3], [[4],[5],[6]])"],seealso:["matrix","matrixFromColumns","matrixFromFunction","zeros"]},aUe={name:"ones",category:"Matrix",syntax:["ones(m)","ones(m, n)","ones(m, n, p, ...)","ones([m])","ones([m, n])","ones([m, n, p, ...])"],description:"Create a matrix containing ones.",examples:["ones(3)","ones(3, 5)","ones([2,3]) * 4.5","a = [1, 2, 3; 4, 5, 6]","ones(size(a))"],seealso:["concat","det","diag","identity","inv","range","size","squeeze","subset","trace","transpose","zeros"]},oUe={name:"partitionSelect",category:"Matrix",syntax:["partitionSelect(x, k)","partitionSelect(x, k, compare)"],description:"Partition-based selection of an array or 1D matrix. Will find the kth smallest value, and mutates the input array. Uses Quickselect.",examples:["partitionSelect([5, 10, 1], 2)",'partitionSelect(["C", "B", "A", "D"], 1, compareText)',"arr = [5, 2, 1]","partitionSelect(arr, 0) # returns 1, arr is now: [1, 2, 5]","arr","partitionSelect(arr, 1, 'desc') # returns 2, arr is now: [5, 2, 1]","arr"],seealso:["sort"]},lUe={name:"range",category:"Type",syntax:["start:end","start:step:end","range(start, end)","range(start, end, step)","range(string)"],description:"Create a range. Lower bound of the range is included, upper bound is excluded.",examples:["1:5","3:-1:-3","range(3, 7)","range(0, 12, 2)",'range("4:10")',"range(1m, 1m, 3m)","a = [1, 2, 3, 4; 5, 6, 7, 8]","a[1:2, 1:2]"],seealso:["concat","det","diag","identity","inv","ones","size","squeeze","subset","trace","transpose","zeros"]},uUe={name:"reshape",category:"Matrix",syntax:["reshape(x, sizes)"],description:"Reshape a multi dimensional array to fit the specified dimensions.",examples:["reshape([1, 2, 3, 4, 5, 6], [2, 3])","reshape([[1, 2], [3, 4]], [1, 4])","reshape([[1, 2], [3, 4]], [4])","reshape([1, 2, 3, 4], [-1, 2])"],seealso:["size","squeeze","resize"]},cUe={name:"resize",category:"Matrix",syntax:["resize(x, size)","resize(x, size, defaultValue)"],description:"Resize a matrix.",examples:["resize([1,2,3,4,5], [3])","resize([1,2,3], [5])","resize([1,2,3], [5], -1)","resize(2, [2, 3])",'resize("hello", [8], "!")'],seealso:["size","subset","squeeze","reshape"]},hUe={name:"rotate",category:"Matrix",syntax:["rotate(w, theta)","rotate(w, theta, v)"],description:"Returns a 2-D rotation matrix (2x2) for a given angle (in radians). Returns a 2-D rotation matrix (3x3) of a given angle (in radians) around given axis.",examples:["rotate([1, 0], pi / 2)",'rotate(matrix([1, 0]), unit("35deg"))','rotate([1, 0, 0], unit("90deg"), [0, 0, 1])','rotate(matrix([1, 0, 0]), unit("90deg"), matrix([0, 0, 1]))'],seealso:["matrix","rotationMatrix"]},dUe={name:"rotationMatrix",category:"Matrix",syntax:["rotationMatrix(theta)","rotationMatrix(theta, v)","rotationMatrix(theta, v, format)"],description:"Returns a 2-D rotation matrix (2x2) for a given angle (in radians). Returns a 2-D rotation matrix (3x3) of a given angle (in radians) around given axis.",examples:["rotationMatrix(pi / 2)",'rotationMatrix(unit("45deg"), [0, 0, 1])','rotationMatrix(1, matrix([0, 0, 1]), "sparse")'],seealso:["cos","sin"]},fUe={name:"row",category:"Matrix",syntax:["row(x, index)"],description:"Return a row from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","row(A, 1)","row(A, 2)"],seealso:["column","matrixFromRows"]},pUe={name:"size",category:"Matrix",syntax:["size(x)"],description:"Calculate the size of a matrix.",examples:["size(2.3)",'size("hello world")',"a = [1, 2; 3, 4; 5, 6]","size(a)","size(1:6)"],seealso:["concat","count","det","diag","identity","inv","ones","range","squeeze","subset","trace","transpose","zeros"]},mUe={name:"sort",category:"Matrix",syntax:["sort(x)","sort(x, compare)"],description:'Sort the items in a matrix. Compare can be a string "asc", "desc", "natural", or a custom sort function.',examples:["sort([5, 10, 1])",'sort(["C", "B", "A", "D"], "natural")',"sortByLength(a, b) = size(a)[1] - size(b)[1]",'sort(["Langdon", "Tom", "Sara"], sortByLength)','sort(["10", "1", "2"], "natural")'],seealso:["map","filter","forEach"]},gUe={name:"squeeze",category:"Matrix",syntax:["squeeze(x)"],description:"Remove inner and outer singleton dimensions from a matrix.",examples:["a = zeros(3,2,1)","size(squeeze(a))","b = zeros(1,1,3)","size(squeeze(b))"],seealso:["concat","det","diag","identity","inv","ones","range","size","subset","trace","transpose","zeros"]},vUe={name:"subset",category:"Matrix",syntax:["value(index)","value(index) = replacement","subset(value, [index])","subset(value, [index], replacement)"],description:"Get or set a subset of the entries of a matrix or characters of a string. Indexes are one-based. There should be one index specification for each dimension of the target. Each specification can be a single index, a list of indices, or a range in colon notation `l:u`. In a range, both the lower bound l and upper bound u are included; and if a bound is omitted it defaults to the most extreme valid value. The cartesian product of the indices specified in each dimension determines the target of the operation.",examples:["d = [1, 2; 3, 4]","e = []","e[1, 1:2] = [5, 6]","e[2, :] = [7, 8]","f = d * e","f[2, 1]","f[:, 1]","f[[1,2], [1,3]] = [9, 10; 11, 12]","f"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","trace","transpose","zeros"]},yUe={name:"trace",category:"Matrix",syntax:["trace(A)"],description:"Calculate the trace of a matrix: the sum of the elements on the main diagonal of a square matrix.",examples:["A = [1, 2, 3; -1, 2, 3; 2, 0, 3]","trace(A)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","transpose","zeros"]},xUe={name:"transpose",category:"Matrix",syntax:["x'","transpose(x)"],description:"Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","transpose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},bUe={name:"zeros",category:"Matrix",syntax:["zeros(m)","zeros(m, n)","zeros(m, n, p, ...)","zeros([m])","zeros([m, n])","zeros([m, n, p, ...])"],description:"Create a matrix containing zeros.",examples:["zeros(3)","zeros(3, 5)","a = [1, 2, 3; 4, 5, 6]","zeros(size(a))"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose"]},_Ue={name:"fft",category:"Matrix",syntax:["fft(x)"],description:"Calculate N-dimensional Fourier transform",examples:["fft([[1, 0], [1, 0]])"],seealso:["ifft"]},wUe={name:"ifft",category:"Matrix",syntax:["ifft(x)"],description:"Calculate N-dimensional inverse Fourier transform",examples:["ifft([[2, 2], [0, 0]])"],seealso:["fft"]},EUe={name:"bernoulli",category:"Probability",syntax:["bernoulli(n)"],description:"The nth Bernoulli number",examples:["bernoulli(4)","bernoulli(fraction(12))"],seealso:["combinations","gamma","stirlingS2"]},SUe={name:"combinations",category:"Probability",syntax:["combinations(n, k)"],description:"Compute the number of combinations of n items taken k at a time",examples:["combinations(7, 5)"],seealso:["combinationsWithRep","permutations","factorial"]},AUe={name:"combinationsWithRep",category:"Probability",syntax:["combinationsWithRep(n, k)"],description:"Compute the number of combinations of n items taken k at a time with replacements.",examples:["combinationsWithRep(7, 5)"],seealso:["combinations","permutations","factorial"]},TUe={name:"factorial",category:"Probability",syntax:["n!","factorial(n)"],description:"Compute the factorial of a value",examples:["5!","5 * 4 * 3 * 2 * 1","3!"],seealso:["combinations","combinationsWithRep","permutations","gamma"]},MUe={name:"gamma",category:"Probability",syntax:["gamma(n)"],description:"Compute the gamma function. For small values, the Lanczos approximation is used, and for large values the extended Stirling approximation.",examples:["gamma(4)","3!","gamma(1/2)","sqrt(pi)"],seealso:["factorial"]},CUe={name:"lgamma",category:"Probability",syntax:["lgamma(n)"],description:"Logarithm of the gamma function for real, positive numbers and complex numbers, using Lanczos approximation for numbers and Stirling series for complex numbers.",examples:["lgamma(4)","lgamma(1/2)","lgamma(i)","lgamma(complex(1.1, 2))"],seealso:["gamma"]},DUe={name:"kldivergence",category:"Probability",syntax:["kldivergence(x, y)"],description:"Calculate the Kullback-Leibler (KL) divergence  between two distributions.",examples:["kldivergence([0.7,0.5,0.4], [0.2,0.9,0.5])"],seealso:[]},NUe={name:"multinomial",category:"Probability",syntax:["multinomial(A)"],description:"Multinomial Coefficients compute the number of ways of picking a1, a2, ..., ai unordered outcomes from `n` possibilities. multinomial takes one array of integers as an argument. The following condition must be enforced: every ai > 0.",examples:["multinomial([1, 2, 1])"],seealso:["combinations","factorial"]},RUe={name:"permutations",category:"Probability",syntax:["permutations(n)","permutations(n, k)"],description:"Compute the number of permutations of n items taken k at a time",examples:["permutations(5)","permutations(5, 3)"],seealso:["combinations","combinationsWithRep","factorial"]},IUe={name:"pickRandom",category:"Probability",syntax:["pickRandom(array)","pickRandom(array, number)","pickRandom(array, weights)","pickRandom(array, number, weights)","pickRandom(array, weights, number)"],description:"Pick a random entry from a given array.",examples:["pickRandom(0:10)","pickRandom([1, 3, 1, 6])","pickRandom([1, 3, 1, 6], 2)","pickRandom([1, 3, 1, 6], [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], 2, [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], [2, 3, 2, 1], 2)"],seealso:["random","randomInt"]},PUe={name:"random",category:"Probability",syntax:["random()","random(max)","random(min, max)","random(size)","random(size, max)","random(size, min, max)"],description:"Return a random number.",examples:["random()","random(10, 20)","random([2, 3])"],seealso:["pickRandom","randomInt"]},FUe={name:"randomInt",category:"Probability",syntax:["randomInt(max)","randomInt(min, max)","randomInt(size)","randomInt(size, max)","randomInt(size, min, max)"],description:"Return a random integer number",examples:["randomInt(10, 20)","randomInt([2, 3], 10)"],seealso:["pickRandom","random"]},LUe={name:"compare",category:"Relational",syntax:["compare(x, y)"],description:"Compare two values. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compare(2, 3)","compare(3, 2)","compare(2, 2)","compare(5cm, 40mm)","compare(2, [1, 2, 3])"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compareNatural","compareText"]},OUe={name:"compareNatural",category:"Relational",syntax:["compareNatural(x, y)"],description:"Compare two values of any type in a deterministic, natural way. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compareNatural(2, 3)","compareNatural(3, 2)","compareNatural(2, 2)","compareNatural(5cm, 40mm)",'compareNatural("2", "10")',"compareNatural(2 + 3i, 2 + 4i)","compareNatural([1, 2, 4], [1, 2, 3])","compareNatural([1, 5], [1, 2, 3])","compareNatural([1, 2], [1, 2])","compareNatural({a: 2}, {a: 4})"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare","compareText"]},kUe={name:"compareText",category:"Relational",syntax:["compareText(x, y)"],description:"Compare two strings lexically. Comparison is case sensitive. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:['compareText("B", "A")','compareText("A", "B")','compareText("A", "A")','compareText("2", "10")','compare("2", "10")',"compare(2, 10)",'compareNatural("2", "10")','compareText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural"]},BUe={name:"deepEqual",category:"Relational",syntax:["deepEqual(x, y)"],description:"Check equality of two matrices element wise. Returns true if the size of both matrices is equal and when and each of the elements are equal.",examples:["deepEqual([1,3,4], [1,3,4])","deepEqual([1,3,4], [1,3])"],seealso:["equal","unequal","smaller","larger","smallerEq","largerEq","compare"]},UUe={name:"equal",category:"Relational",syntax:["x == y","equal(x, y)"],description:"Check equality of two values. Returns true if the values are equal, and false if not.",examples:["2+2 == 3","2+2 == 4","a = 3.2","b = 6-2.8","a == b","50cm == 0.5m"],seealso:["unequal","smaller","larger","smallerEq","largerEq","compare","deepEqual","equalText"]},VUe={name:"equalText",category:"Relational",syntax:["equalText(x, y)"],description:"Check equality of two strings. Comparison is case sensitive. Returns true if the values are equal, and false if not.",examples:['equalText("Hello", "Hello")','equalText("a", "A")','equal("2e3", "2000")','equalText("2e3", "2000")','equalText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural","compareText","equal"]},zUe={name:"larger",category:"Relational",syntax:["x > y","larger(x, y)"],description:"Check if value x is larger than y. Returns true if x is larger than y, and false if not. Comparing a value with NaN returns false.",examples:["2 > 3","5 > 2*2","a = 3.3","b = 6-2.8","(a > b)","(b < a)","5 cm > 2 inch"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare"]},$Ue={name:"largerEq",category:"Relational",syntax:["x >= y","largerEq(x, y)"],description:"Check if value x is larger or equal to y. Returns true if x is larger or equal to y, and false if not.",examples:["2 >= 1+1","2 > 1+1","a = 3.2","b = 6-2.8","(a >= b)"],seealso:["equal","unequal","smallerEq","smaller","compare"]},HUe={name:"smaller",category:"Relational",syntax:["x < y","smaller(x, y)"],description:"Check if value x is smaller than value y. Returns true if x is smaller than y, and false if not. Comparing a value with NaN returns false.",examples:["2 < 3","5 < 2*2","a = 3.3","b = 6-2.8","(a < b)","5 cm < 2 inch"],seealso:["equal","unequal","larger","smallerEq","largerEq","compare"]},GUe={name:"smallerEq",category:"Relational",syntax:["x <= y","smallerEq(x, y)"],description:"Check if value x is smaller or equal to value y. Returns true if x is smaller than y, and false if not.",examples:["2 <= 1+1","2 < 1+1","a = 3.2","b = 6-2.8","(a <= b)"],seealso:["equal","unequal","larger","smaller","largerEq","compare"]},jUe={name:"unequal",category:"Relational",syntax:["x != y","unequal(x, y)"],description:"Check unequality of two values. Returns true if the values are unequal, and false if they are equal.",examples:["2+2 != 3","2+2 != 4","a = 3.2","b = 6-2.8","a != b","50cm != 0.5m","5 cm != 2 inch"],seealso:["equal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]},qUe={name:"setCartesian",category:"Set",syntax:["setCartesian(set1, set2)"],description:"Create the cartesian product of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays and the values will be sorted in ascending order before the operation.",examples:["setCartesian([1, 2], [3, 4])"],seealso:["setUnion","setIntersect","setDifference","setPowerset"]},WUe={name:"setDifference",category:"Set",syntax:["setDifference(set1, set2)"],description:"Create the difference of two (multi)sets: every element of set1, that is not the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setDifference([1, 2, 3, 4], [3, 4, 5, 6])","setDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setSymDifference"]},XUe={name:"setDistinct",category:"Set",syntax:["setDistinct(set)"],description:"Collect the distinct elements of a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setDistinct([1, 1, 1, 2, 2, 3])"],seealso:["setMultiplicity"]},KUe={name:"setIntersect",category:"Set",syntax:["setIntersect(set1, set2)"],description:"Create the intersection of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIntersect([1, 2, 3, 4], [3, 4, 5, 6])","setIntersect([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setDifference"]},YUe={name:"setIsSubset",category:"Set",syntax:["setIsSubset(set1, set2)"],description:"Check whether a (multi)set is a subset of another (multi)set: every element of set1 is the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIsSubset([1, 2], [3, 4, 5, 6])","setIsSubset([3, 4], [3, 4, 5, 6])"],seealso:["setUnion","setIntersect","setDifference"]},QUe={name:"setMultiplicity",category:"Set",syntax:["setMultiplicity(element, set)"],description:"Count the multiplicity of an element in a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setMultiplicity(1, [1, 2, 2, 4])","setMultiplicity(2, [1, 2, 2, 4])"],seealso:["setDistinct","setSize"]},ZUe={name:"setPowerset",category:"Set",syntax:["setPowerset(set)"],description:"Create the powerset of a (multi)set: the powerset contains very possible subsets of a (multi)set. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setPowerset([1, 2, 3])"],seealso:["setCartesian"]},JUe={name:"setSize",category:"Set",syntax:["setSize(set)","setSize(set, unique)"],description:'Count the number of elements of a (multi)set. When the second parameter "unique" is true, count only the unique values. A multi-dimension array will be converted to a single-dimension array before the operation.',examples:["setSize([1, 2, 2, 4])","setSize([1, 2, 2, 4], true)"],seealso:["setUnion","setIntersect","setDifference"]},e5e={name:"setSymDifference",category:"Set",syntax:["setSymDifference(set1, set2)"],description:"Create the symmetric difference of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setSymDifference([1, 2, 3, 4], [3, 4, 5, 6])","setSymDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setDifference"]},t5e={name:"setUnion",category:"Set",syntax:["setUnion(set1, set2)"],description:"Create the union of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setUnion([1, 2, 3, 4], [3, 4, 5, 6])","setUnion([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setIntersect","setDifference"]},n5e={name:"zpk2tf",category:"Signal",syntax:["zpk2tf(z, p, k)"],description:"Compute the transfer function of a zero-pole-gain model.",examples:["zpk2tf([1, 2], [-1, -2], 1)","zpk2tf([1, 2], [-1, -2])","zpk2tf([1 - 3i, 2 + 2i], [-1, -2])"],seealso:[]},r5e={name:"freqz",category:"Signal",syntax:["freqz(b, a)","freqz(b, a, w)"],description:"Calculates the frequency response of a filter given its numerator and denominator coefficients.",examples:["freqz([1, 2], [1, 2, 3])","freqz([1, 2], [1, 2, 3], [0, 1])","freqz([1, 2], [1, 2, 3], 512)"],seealso:[]},i5e={name:"erf",category:"Special",syntax:["erf(x)"],description:"Compute the erf function of a value using a rational Chebyshev approximations for different intervals of x",examples:["erf(0.2)","erf(-0.5)","erf(4)"],seealso:[]},s5e={name:"zeta",category:"Special",syntax:["zeta(s)"],description:"Compute the Riemann Zeta Function using an infinite series and Riemann's Functional Equation for the entire complex plane",examples:["zeta(0.2)","zeta(-0.5)","zeta(4)"],seealso:[]},a5e={name:"mad",category:"Statistics",syntax:["mad(a, b, c, ...)","mad(A)"],description:"Compute the median absolute deviation of a matrix or a list with values. The median absolute deviation is defined as the median of the absolute deviations from the median.",examples:["mad(10, 20, 30)","mad([1, 2, 3])"],seealso:["mean","median","std","abs"]},o5e={name:"max",category:"Statistics",syntax:["max(a, b, c, ...)","max(A)","max(A, dimension)"],description:"Compute the maximum value of a list of values. If any NaN values are found, the function yields the last NaN in the input.",examples:["max(2, 3, 4, 1)","max([2, 3, 4, 1])","max([2, 5; 4, 3])","max([2, 5; 4, 3], 1)","max([2, 5; 4, 3], 2)","max(2.7, 7.1, -4.5, 2.0, 4.1)","min(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["mean","median","min","prod","std","sum","variance"]},l5e={name:"mean",category:"Statistics",syntax:["mean(a, b, c, ...)","mean(A)","mean(A, dimension)"],description:"Compute the arithmetic mean of a list of values.",examples:["mean(2, 3, 4, 1)","mean([2, 3, 4, 1])","mean([2, 5; 4, 3])","mean([2, 5; 4, 3], 1)","mean([2, 5; 4, 3], 2)","mean([1.0, 2.7, 3.2, 4.0])"],seealso:["max","median","min","prod","std","sum","variance"]},u5e={name:"median",category:"Statistics",syntax:["median(a, b, c, ...)","median(A)"],description:"Compute the median of all values. The values are sorted and the middle value is returned. In case of an even number of values, the average of the two middle values is returned.",examples:["median(5, 2, 7)","median([3, -1, 5, 7])"],seealso:["max","mean","min","prod","std","sum","variance","quantileSeq"]},c5e={name:"min",category:"Statistics",syntax:["min(a, b, c, ...)","min(A)","min(A, dimension)"],description:"Compute the minimum value of a list of values. If any NaN values are found, the function yields the last NaN in the input.",examples:["min(2, 3, 4, 1)","min([2, 3, 4, 1])","min([2, 5; 4, 3])","min([2, 5; 4, 3], 1)","min([2, 5; 4, 3], 2)","min(2.7, 7.1, -4.5, 2.0, 4.1)","max(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["max","mean","median","prod","std","sum","variance"]},h5e={name:"mode",category:"Statistics",syntax:["mode(a, b, c, ...)","mode(A)","mode(A, a, b, B, c, ...)"],description:"Computes the mode of all values as an array. In case mode being more than one, multiple values are returned in an array.",examples:["mode(2, 1, 4, 3, 1)","mode([1, 2.7, 3.2, 4, 2.7])","mode(1, 4, 6, 1, 6)"],seealso:["max","mean","min","median","prod","std","sum","variance"]},d5e={name:"prod",category:"Statistics",syntax:["prod(a, b, c, ...)","prod(A)"],description:"Compute the product of all values.",examples:["prod(2, 3, 4)","prod([2, 3, 4])","prod([2, 5; 4, 3])"],seealso:["max","mean","min","median","min","std","sum","variance"]},f5e={name:"quantileSeq",category:"Statistics",syntax:["quantileSeq(A, prob[, sorted])","quantileSeq(A, [prob1, prob2, ...][, sorted])","quantileSeq(A, N[, sorted])"],description:`Compute the prob order quantile of a matrix or a list with values. The sequence is sorted and the middle value is returned. Supported types of sequence values are: Number, BigNumber, Unit Supported types of probability are: Number, BigNumber. 

In case of a (multi dimensional) array or matrix, the prob order quantile of all elements will be calculated.`,examples:["quantileSeq([3, -1, 5, 7], 0.5)","quantileSeq([3, -1, 5, 7], [1/3, 2/3])","quantileSeq([3, -1, 5, 7], 2)","quantileSeq([-1, 3, 5, 7], 0.5, true)"],seealso:["mean","median","min","max","prod","std","sum","variance"]},p5e={name:"std",category:"Statistics",syntax:["std(a, b, c, ...)","std(A)","std(A, dimension)","std(A, normalization)","std(A, dimension, normalization)"],description:'Compute the standard deviation of all values, defined as std(A) = sqrt(variance(A)). Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["std(2, 4, 6)","std([2, 4, 6, 8])",'std([2, 4, 6, 8], "uncorrected")','std([2, 4, 6, 8], "biased")',"std([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","prod","sum","variance"]},m5e={name:"cumsum",category:"Statistics",syntax:["cumsum(a, b, c, ...)","cumsum(A)"],description:"Compute the cumulative sum of all values.",examples:["cumsum(2, 3, 4, 1)","cumsum([2, 3, 4, 1])","cumsum([1, 2; 3, 4])","cumsum([1, 2; 3, 4], 1)","cumsum([1, 2; 3, 4], 2)"],seealso:["max","mean","median","min","prod","std","sum","variance"]},g5e={name:"sum",category:"Statistics",syntax:["sum(a, b, c, ...)","sum(A)","sum(A, dimension)"],description:"Compute the sum of all values.",examples:["sum(2, 3, 4, 1)","sum([2, 3, 4, 1])","sum([2, 5; 4, 3])"],seealso:["max","mean","median","min","prod","std","variance"]},v5e={name:"variance",category:"Statistics",syntax:["variance(a, b, c, ...)","variance(A)","variance(A, dimension)","variance(A, normalization)","variance(A, dimension, normalization)"],description:'Compute the variance of all values. Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["variance(2, 4, 6)","variance([2, 4, 6, 8])",'variance([2, 4, 6, 8], "uncorrected")','variance([2, 4, 6, 8], "biased")',"variance([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","std","sum"]},y5e={name:"corr",category:"Statistics",syntax:["corr(A,B)"],description:"Compute the correlation coefficient of a two list with values, For matrices, the matrix correlation coefficient is calculated.",examples:["corr([2, 4, 6, 8],[1, 2, 3, 6])","corr(matrix([[1, 2.2, 3, 4.8, 5], [1, 2, 3, 4, 5]]), matrix([[4, 5.3, 6.6, 7, 8], [1, 2, 3, 4, 5]]))"],seealso:["max","mean","min","median","min","prod","std","sum"]},x5e={name:"acos",category:"Trigonometry",syntax:["acos(x)"],description:"Compute the inverse cosine of a value in radians.",examples:["acos(0.5)","acos(cos(2.3))"],seealso:["cos","atan","asin"]},b5e={name:"acosh",category:"Trigonometry",syntax:["acosh(x)"],description:"Calculate the hyperbolic arccos of a value, defined as `acosh(x) = ln(sqrt(x^2 - 1) + x)`.",examples:["acosh(1.5)"],seealso:["cosh","asinh","atanh"]},_5e={name:"acot",category:"Trigonometry",syntax:["acot(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acot(0.5)","acot(cot(0.5))","acot(2)"],seealso:["cot","atan"]},w5e={name:"acoth",category:"Trigonometry",syntax:["acoth(x)"],description:"Calculate the inverse hyperbolic tangent of a value, defined as `acoth(x) = (ln((x+1)/x) + ln(x/(x-1))) / 2`.",examples:["acoth(2)","acoth(0.5)"],seealso:["acsch","asech"]},E5e={name:"acsc",category:"Trigonometry",syntax:["acsc(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acsc(2)","acsc(csc(0.5))","acsc(0.5)"],seealso:["csc","asin","asec"]},S5e={name:"acsch",category:"Trigonometry",syntax:["acsch(x)"],description:"Calculate the inverse hyperbolic cosecant of a value, defined as `acsch(x) = ln(1/x + sqrt(1/x^2 + 1))`.",examples:["acsch(0.5)"],seealso:["asech","acoth"]},A5e={name:"asec",category:"Trigonometry",syntax:["asec(x)"],description:"Calculate the inverse secant of a value.",examples:["asec(0.5)","asec(sec(0.5))","asec(2)"],seealso:["acos","acot","acsc"]},T5e={name:"asech",category:"Trigonometry",syntax:["asech(x)"],description:"Calculate the inverse secant of a value.",examples:["asech(0.5)"],seealso:["acsch","acoth"]},M5e={name:"asin",category:"Trigonometry",syntax:["asin(x)"],description:"Compute the inverse sine of a value in radians.",examples:["asin(0.5)","asin(sin(0.5))"],seealso:["sin","acos","atan"]},C5e={name:"asinh",category:"Trigonometry",syntax:["asinh(x)"],description:"Calculate the hyperbolic arcsine of a value, defined as `asinh(x) = ln(x + sqrt(x^2 + 1))`.",examples:["asinh(0.5)"],seealso:["acosh","atanh"]},D5e={name:"atan",category:"Trigonometry",syntax:["atan(x)"],description:"Compute the inverse tangent of a value in radians.",examples:["atan(0.5)","atan(tan(0.5))"],seealso:["tan","acos","asin"]},N5e={name:"atan2",category:"Trigonometry",syntax:["atan2(y, x)"],description:"Computes the principal value of the arc tangent of y/x in radians.",examples:["atan2(2, 2) / pi","angle = 60 deg in rad","x = cos(angle)","y = sin(angle)","atan2(y, x)"],seealso:["sin","cos","tan"]},R5e={name:"atanh",category:"Trigonometry",syntax:["atanh(x)"],description:"Calculate the hyperbolic arctangent of a value, defined as `atanh(x) = ln((1 + x)/(1 - x)) / 2`.",examples:["atanh(0.5)"],seealso:["acosh","asinh"]},I5e={name:"cos",category:"Trigonometry",syntax:["cos(x)"],description:"Compute the cosine of x in radians.",examples:["cos(2)","cos(pi / 4) ^ 2","cos(180 deg)","cos(60 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["acos","sin","tan"]},P5e={name:"cosh",category:"Trigonometry",syntax:["cosh(x)"],description:"Compute the hyperbolic cosine of x in radians.",examples:["cosh(0.5)"],seealso:["sinh","tanh","coth"]},F5e={name:"cot",category:"Trigonometry",syntax:["cot(x)"],description:"Compute the cotangent of x in radians. Defined as 1/tan(x)",examples:["cot(2)","1 / tan(2)"],seealso:["sec","csc","tan"]},L5e={name:"coth",category:"Trigonometry",syntax:["coth(x)"],description:"Compute the hyperbolic cotangent of x in radians.",examples:["coth(2)","1 / tanh(2)"],seealso:["sech","csch","tanh"]},O5e={name:"csc",category:"Trigonometry",syntax:["csc(x)"],description:"Compute the cosecant of x in radians. Defined as 1/sin(x)",examples:["csc(2)","1 / sin(2)"],seealso:["sec","cot","sin"]},k5e={name:"csch",category:"Trigonometry",syntax:["csch(x)"],description:"Compute the hyperbolic cosecant of x in radians. Defined as 1/sinh(x)",examples:["csch(2)","1 / sinh(2)"],seealso:["sech","coth","sinh"]},B5e={name:"sec",category:"Trigonometry",syntax:["sec(x)"],description:"Compute the secant of x in radians. Defined as 1/cos(x)",examples:["sec(2)","1 / cos(2)"],seealso:["cot","csc","cos"]},U5e={name:"sech",category:"Trigonometry",syntax:["sech(x)"],description:"Compute the hyperbolic secant of x in radians. Defined as 1/cosh(x)",examples:["sech(2)","1 / cosh(2)"],seealso:["coth","csch","cosh"]},V5e={name:"sin",category:"Trigonometry",syntax:["sin(x)"],description:"Compute the sine of x in radians.",examples:["sin(2)","sin(pi / 4) ^ 2","sin(90 deg)","sin(30 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["asin","cos","tan"]},z5e={name:"sinh",category:"Trigonometry",syntax:["sinh(x)"],description:"Compute the hyperbolic sine of x in radians.",examples:["sinh(0.5)"],seealso:["cosh","tanh"]},$5e={name:"tan",category:"Trigonometry",syntax:["tan(x)"],description:"Compute the tangent of x in radians.",examples:["tan(0.5)","sin(0.5) / cos(0.5)","tan(pi / 4)","tan(45 deg)"],seealso:["atan","sin","cos"]},H5e={name:"tanh",category:"Trigonometry",syntax:["tanh(x)"],description:"Compute the hyperbolic tangent of x in radians.",examples:["tanh(0.5)","sinh(0.5) / cosh(0.5)"],seealso:["sinh","cosh"]},G5e={name:"to",category:"Units",syntax:["x to unit","to(x, unit)"],description:"Change the unit of a value.",examples:["5 inch to cm","3.2kg to g","16 bytes in bits"],seealso:[]},j5e={name:"toBest",category:"Units",syntax:["toBest(x)","toBest(x, unitList)","toBest(x, unitList, options)"],description:"Converts to the most appropriate display unit.",examples:['toBest(unit(5000, "m"))','toBest(unit(3500000, "W"))','toBest(unit(0.000000123, "A"))','toBest(unit(10, "m"), "cm")','toBest(unit(10, "m"), "mm,km", {offset: 1.5})'],seealso:[]},q5e={name:"bin",category:"Utils",syntax:["bin(value)"],description:"Format a number as binary",examples:["bin(2)"],seealso:["oct","hex"]},W5e={name:"clone",category:"Utils",syntax:["clone(x)"],description:"Clone a variable. Creates a copy of primitive variables, and a deep copy of matrices",examples:["clone(3.5)","clone(2 - 4i)","clone(45 deg)","clone([1, 2; 3, 4])",'clone("hello world")'],seealso:[]},X5e={name:"format",category:"Utils",syntax:["format(value)","format(value, precision)"],description:"Format a value of any type as string.",examples:["format(2.3)","format(3 - 4i)","format([])","format(pi, 3)"],seealso:["print"]},K5e={name:"hasNumericValue",category:"Utils",syntax:["hasNumericValue(x)"],description:"Test whether a value is an numeric value. In case of a string, true is returned if the string contains a numeric value.",examples:["hasNumericValue(2)",'hasNumericValue("2")','isNumeric("2")',"hasNumericValue(0)","hasNumericValue(bignumber(500))","hasNumericValue(fraction(0.125))","hasNumericValue(2 + 3i)",'hasNumericValue([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","isNumeric"]},Y5e={name:"hex",category:"Utils",syntax:["hex(value)"],description:"Format a number as hexadecimal",examples:["hex(240)"],seealso:["bin","oct"]},Q5e={name:"isInteger",category:"Utils",syntax:["isInteger(x)"],description:"Test whether a value is an integer number.",examples:["isInteger(2)","isInteger(3.5)","isInteger([3, 0.5, -2])"],seealso:["isNegative","isNumeric","isPositive","isZero"]},Z5e={name:"isNaN",category:"Utils",syntax:["isNaN(x)"],description:"Test whether a value is NaN (not a number)",examples:["isNaN(2)","isNaN(0 / 0)","isNaN(NaN)","isNaN(Infinity)"],seealso:["isNegative","isNumeric","isPositive","isZero","isFinite","isBounded"]},J5e={name:"isBounded",category:"Utils",syntax:["isBounded(x)"],description:"Test whether a value or its entries are bounded.",examples:["isBounded(Infinity)","isBounded(bigint(3))","isBounded([3, -Infinity, -3])"],seealso:["isFinite","isNumeric","isNaN","isNegative","isPositive"]},eVe={name:"isFinite",category:"Utils",syntax:["isFinite(x)"],description:"Test whether a value is finite, elementwise on collections.",examples:["isFinite(Infinity)","isFinite(bigint(3))","isFinite([3, -Infinity, -3])"],seealso:["isBounded","isNumeric","isNaN","isNegative","isPositive"]},tVe={name:"isNegative",category:"Utils",syntax:["isNegative(x)"],description:"Test whether a value is negative: smaller than zero.",examples:["isNegative(2)","isNegative(0)","isNegative(-4)","isNegative([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isPositive","isZero"]},nVe={name:"isNumeric",category:"Utils",syntax:["isNumeric(x)"],description:"Test whether a value is a numeric value. Returns true when the input is a number, BigNumber, Fraction, or boolean.",examples:["isNumeric(2)",'isNumeric("2")','hasNumericValue("2")',"isNumeric(0)","isNumeric(bignumber(500))","isNumeric(fraction(0.125))","isNumeric(2 + 3i)",'isNumeric([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","hasNumericValue","isFinite","isBounded"]},rVe={name:"isPositive",category:"Utils",syntax:["isPositive(x)"],description:"Test whether a value is positive: larger than zero.",examples:["isPositive(2)","isPositive(0)","isPositive(-4)","isPositive([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},iVe={name:"isPrime",category:"Utils",syntax:["isPrime(x)"],description:"Test whether a value is prime: has no divisors other than itself and one.",examples:["isPrime(3)","isPrime(-2)","isPrime([2, 17, 100])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},sVe={name:"isZero",category:"Utils",syntax:["isZero(x)"],description:"Test whether a value is zero.",examples:["isZero(2)","isZero(0)","isZero(-4)","isZero([3, 0, -2, 0])"],seealso:["isInteger","isNumeric","isNegative","isPositive"]},aVe={name:"numeric",category:"Utils",syntax:["numeric(x)"],description:"Convert a numeric input to a specific numeric type: number, BigNumber, bigint, or Fraction.",examples:['numeric("4")','numeric("4", "number")','numeric("4", "bigint")','numeric("4", "BigNumber")','numeric("4", "Fraction")','numeric(4, "Fraction")','numeric(fraction(2, 5), "number")'],seealso:["number","bigint","fraction","bignumber","string","format"]},oVe={name:"oct",category:"Utils",syntax:["oct(value)"],description:"Format a number as octal",examples:["oct(56)"],seealso:["bin","hex"]},lVe={name:"print",category:"Utils",syntax:["print(template, values)","print(template, values, precision)"],description:"Interpolate values into a string template.",examples:['print("Lucy is $age years old", {age: 5})','print("The value of pi is $pi", {pi: pi}, 3)','print("Hello, $user.name!", {user: {name: "John"}})','print("Values: $1, $2, $3", [6, 9, 4])'],seealso:["format"]},uVe={name:"typeOf",category:"Utils",syntax:["typeOf(x)"],description:"Get the type of a variable.",examples:["typeOf(3.5)","typeOf(2 - 4i)","typeOf(45 deg)",'typeOf("hello world")'],seealso:["getMatrixDataType"]},cVe={name:"solveODE",category:"Numeric",syntax:["solveODE(func, tspan, y0)","solveODE(func, tspan, y0, options)"],description:"Numerical Integration of Ordinary Differential Equations.",examples:["f(t,y) = y","tspan = [0, 4]","solveODE(f, tspan, 1)","solveODE(f, tspan, [1, 2])",'solveODE(f, tspan, 1, { method:"RK23", maxStep:0.1 })'],seealso:["derivative","simplifyCore"]},hVe={bignumber:jke,bigint:qke,boolean:Wke,complex:Xke,createUnit:Kke,fraction:Yke,index:Qke,matrix:Zke,number:Jke,sparse:eBe,splitUnit:tBe,string:nBe,unit:rBe,e:MG,E:MG,false:Nke,i:Rke,Infinity:Ike,LN2:Fke,LN10:Pke,LOG2E:Oke,LOG10E:Lke,NaN:kke,null:Bke,pi:CG,PI:CG,phi:Uke,SQRT1_2:Vke,SQRT2:zke,tau:$ke,true:Hke,version:Gke,speedOfLight:{description:"Speed of light in vacuum",examples:["speedOfLight"]},gravitationConstant:{description:"Newtonian constant of gravitation",examples:["gravitationConstant"]},planckConstant:{description:"Planck constant",examples:["planckConstant"]},reducedPlanckConstant:{description:"Reduced Planck constant",examples:["reducedPlanckConstant"]},magneticConstant:{description:"Magnetic constant (vacuum permeability)",examples:["magneticConstant"]},electricConstant:{description:"Electric constant (vacuum permeability)",examples:["electricConstant"]},vacuumImpedance:{description:"Characteristic impedance of vacuum",examples:["vacuumImpedance"]},coulomb:{description:"Coulomb's constant. Deprecated in favor of coulombConstant",examples:["coulombConstant"]},coulombConstant:{description:"Coulomb's constant",examples:["coulombConstant"]},elementaryCharge:{description:"Elementary charge",examples:["elementaryCharge"]},bohrMagneton:{description:"Bohr magneton",examples:["bohrMagneton"]},conductanceQuantum:{description:"Conductance quantum",examples:["conductanceQuantum"]},inverseConductanceQuantum:{description:"Inverse conductance quantum",examples:["inverseConductanceQuantum"]},magneticFluxQuantum:{description:"Magnetic flux quantum",examples:["magneticFluxQuantum"]},nuclearMagneton:{description:"Nuclear magneton",examples:["nuclearMagneton"]},klitzing:{description:"Von Klitzing constant",examples:["klitzing"]},bohrRadius:{description:"Bohr radius",examples:["bohrRadius"]},classicalElectronRadius:{description:"Classical electron radius",examples:["classicalElectronRadius"]},electronMass:{description:"Electron mass",examples:["electronMass"]},fermiCoupling:{description:"Fermi coupling constant",examples:["fermiCoupling"]},fineStructure:{description:"Fine-structure constant",examples:["fineStructure"]},hartreeEnergy:{description:"Hartree energy",examples:["hartreeEnergy"]},protonMass:{description:"Proton mass",examples:["protonMass"]},deuteronMass:{description:"Deuteron Mass",examples:["deuteronMass"]},neutronMass:{description:"Neutron mass",examples:["neutronMass"]},quantumOfCirculation:{description:"Quantum of circulation",examples:["quantumOfCirculation"]},rydberg:{description:"Rydberg constant",examples:["rydberg"]},thomsonCrossSection:{description:"Thomson cross section",examples:["thomsonCrossSection"]},weakMixingAngle:{description:"Weak mixing angle",examples:["weakMixingAngle"]},efimovFactor:{description:"Efimov factor",examples:["efimovFactor"]},atomicMass:{description:"Atomic mass constant",examples:["atomicMass"]},avogadro:{description:"Avogadro's number",examples:["avogadro"]},boltzmann:{description:"Boltzmann constant",examples:["boltzmann"]},faraday:{description:"Faraday constant",examples:["faraday"]},firstRadiation:{description:"First radiation constant",examples:["firstRadiation"]},loschmidt:{description:"Loschmidt constant at T=273.15 K and p=101.325 kPa",examples:["loschmidt"]},gasConstant:{description:"Gas constant",examples:["gasConstant"]},molarPlanckConstant:{description:"Molar Planck constant",examples:["molarPlanckConstant"]},molarVolume:{description:"Molar volume of an ideal gas at T=273.15 K and p=101.325 kPa",examples:["molarVolume"]},sackurTetrode:{description:"Sackur-Tetrode constant at T=1 K and p=101.325 kPa",examples:["sackurTetrode"]},secondRadiation:{description:"Second radiation constant",examples:["secondRadiation"]},stefanBoltzmann:{description:"Stefan-Boltzmann constant",examples:["stefanBoltzmann"]},wienDisplacement:{description:"Wien displacement law constant",examples:["wienDisplacement"]},molarMass:{description:"Molar mass constant",examples:["molarMass"]},molarMassC12:{description:"Molar mass constant of carbon-12",examples:["molarMassC12"]},gravity:{description:"Standard acceleration of gravity (standard acceleration of free-fall on Earth)",examples:["gravity"]},planckLength:{description:"Planck length",examples:["planckLength"]},planckMass:{description:"Planck mass",examples:["planckMass"]},planckTime:{description:"Planck time",examples:["planckTime"]},planckCharge:{description:"Planck charge",examples:["planckCharge"]},planckTemperature:{description:"Planck temperature",examples:["planckTemperature"]},derivative:oBe,lsolve:uBe,lsolveAll:cBe,lup:hBe,lusolve:dBe,leafCount:lBe,polynomialRoot:fBe,resolve:gBe,simplify:vBe,simplifyConstant:yBe,simplifyCore:xBe,symbolicEqual:_Be,rationalize:mBe,slu:bBe,usolve:wBe,usolveAll:EBe,qr:pBe,abs:SBe,add:ABe,cbrt:TBe,ceil:MBe,cube:CBe,divide:DBe,dotDivide:NBe,dotMultiply:RBe,dotPow:IBe,exp:PBe,expm:FBe,expm1:LBe,fix:OBe,floor:kBe,gcd:BBe,hypot:UBe,lcm:zBe,log:$Be,log2:jBe,log1p:GBe,log10:HBe,mod:qBe,multiply:WBe,norm:XBe,nthRoot:KBe,nthRoots:YBe,pow:QBe,round:ZBe,sign:JBe,sqrt:e4e,sqrtm:t4e,square:s4e,subtract:a4e,unaryMinus:o4e,unaryPlus:l4e,xgcd:u4e,invmod:VBe,bitAnd:c4e,bitNot:h4e,bitOr:d4e,bitXor:f4e,leftShift:p4e,rightArithShift:m4e,rightLogShift:g4e,bellNumbers:v4e,catalan:y4e,composition:x4e,stirlingS2:b4e,config:iBe,import:sBe,typed:aBe,arg:_4e,conj:w4e,re:S4e,im:E4e,evaluate:A4e,help:D4e,parse:M4e,parser:T4e,compile:C4e,distance:N4e,intersect:R4e,and:I4e,not:P4e,nullish:F4e,or:L4e,xor:O4e,mapSlices:k4e,concat:U4e,count:V4e,cross:z4e,column:B4e,ctranspose:$4e,det:H4e,diag:G4e,diff:j4e,dot:q4e,getMatrixDataType:Q4e,identity:Z4e,filter:X4e,flatten:K4e,forEach:Y4e,inv:J4e,pinv:eUe,eigs:W4e,kron:tUe,matrixFromFunction:iUe,matrixFromRows:sUe,matrixFromColumns:rUe,map:nUe,ones:aUe,partitionSelect:oUe,range:lUe,resize:cUe,reshape:uUe,rotate:hUe,rotationMatrix:dUe,row:fUe,size:pUe,sort:mUe,squeeze:gUe,subset:vUe,trace:yUe,transpose:xUe,zeros:bUe,fft:_Ue,ifft:wUe,sylvester:n4e,schur:r4e,lyap:i4e,solveODE:cVe,bernoulli:EUe,combinations:SUe,combinationsWithRep:AUe,factorial:TUe,gamma:MUe,kldivergence:DUe,lgamma:CUe,multinomial:NUe,permutations:RUe,pickRandom:IUe,random:PUe,randomInt:FUe,compare:LUe,compareNatural:OUe,compareText:kUe,deepEqual:BUe,equal:UUe,equalText:VUe,larger:zUe,largerEq:$Ue,smaller:HUe,smallerEq:GUe,unequal:jUe,setCartesian:qUe,setDifference:WUe,setDistinct:XUe,setIntersect:KUe,setIsSubset:YUe,setMultiplicity:QUe,setPowerset:ZUe,setSize:JUe,setSymDifference:e5e,setUnion:t5e,zpk2tf:n5e,freqz:r5e,erf:i5e,zeta:s5e,cumsum:m5e,mad:a5e,max:o5e,mean:l5e,median:u5e,min:c5e,mode:h5e,prod:d5e,quantileSeq:f5e,std:p5e,sum:g5e,variance:v5e,corr:y5e,acos:x5e,acosh:b5e,acot:_5e,acoth:w5e,acsc:E5e,acsch:S5e,asec:A5e,asech:T5e,asin:M5e,asinh:C5e,atan:D5e,atanh:R5e,atan2:N5e,cos:I5e,cosh:P5e,cot:F5e,coth:L5e,csc:O5e,csch:k5e,sec:B5e,sech:U5e,sin:V5e,sinh:z5e,tan:$5e,tanh:H5e,to:G5e,toBest:j5e,clone:W5e,format:X5e,bin:q5e,oct:oVe,hex:Y5e,isNaN:Z5e,isBounded:J5e,isFinite:eVe,isInteger:Q5e,isNegative:tVe,isNumeric:nVe,hasNumericValue:K5e,isPositive:rVe,isPrime:iVe,isZero:sVe,print:lVe,typeOf:uVe,numeric:aVe},DG="help",dVe=["typed","mathWithTransform","Help"],fVe=re(DG,dVe,n=>{var{typed:e,mathWithTransform:t,Help:r}=n;return e(DG,{any:function(s){var a,o=s;if(typeof s!="string"){for(a in t)if(vt(t,a)&&s===t[a]){o=a;break}}var l=Ea(hVe,o);if(!l){var u=typeof o=="function"?o.name:o;throw new Error('No documentation found on "'+u+'"')}return new r(l)}})}),NG="chain",pVe=["typed","Chain"],mVe=re(NG,pVe,n=>{var{typed:e,Chain:t}=n;return e(NG,{"":function(){return new t},any:function(i){return new t(i)}})}),RG="det",gVe=["typed","matrix","subtractScalar","multiply","divideScalar","isZero","unaryMinus"],vVe=re(RG,gVe,n=>{var{typed:e,matrix:t,subtractScalar:r,multiply:i,divideScalar:s,isZero:a,unaryMinus:o}=n;return e(RG,{any:function(c){return Ut(c)},"Array | Matrix":function(c){var h;switch(Dt(c)?h=c.size():Array.isArray(c)?(c=t(c),h=c.size()):h=[],h.length){case 0:return Ut(c);case 1:if(h[0]===1)return Ut(c.valueOf()[0]);if(h[0]===0)return 1;throw new RangeError("Matrix must be square (size: "+nn(h)+")");case 2:{var d=h[0],f=h[1];if(d===f)return l(c.clone().valueOf(),d);if(f===0)return 1;throw new RangeError("Matrix must be square (size: "+nn(h)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+nn(h)+")")}}});function l(u,c,h){if(c===1)return Ut(u[0][0]);if(c===2)return r(i(u[0][0],u[1][1]),i(u[1][0],u[0][1]));for(var d=!1,f=new Array(c).fill(0).map((A,T)=>T),p=0;p<c;p++){var m=f[p];if(a(u[m][p])){var y=void 0;for(y=p+1;y<c;y++)if(!a(u[f[y]][p])){m=f[y],f[y]=f[p],f[p]=m,d=!d;break}if(y===c)return u[m][p]}for(var v=u[m][p],b=p===0?1:u[f[p-1]][p-1],x=p+1;x<c;x++)for(var w=f[x],_=p+1;_<c;_++)u[w][_]=s(r(i(u[w][_],v),i(u[w][p],u[m][_])),b)}var E=u[f[c-1]][c-1];return d?o(E):E}}),IG="inv",yVe=["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],xVe=re(IG,yVe,n=>{var{typed:e,matrix:t,divideScalar:r,addScalar:i,multiply:s,unaryMinus:a,det:o,identity:l,abs:u}=n;return e(IG,{"Array | Matrix":function(d){var f=Dt(d)?d.size():Vt(d);switch(f.length){case 1:if(f[0]===1)return Dt(d)?t([r(1,d.valueOf()[0])]):[r(1,d[0])];throw new RangeError("Matrix must be square (size: "+nn(f)+")");case 2:{var p=f[0],m=f[1];if(p===m)return Dt(d)?t(c(d.valueOf(),p,m),d.storage()):c(d,p,m);throw new RangeError("Matrix must be square (size: "+nn(f)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+nn(f)+")")}},any:function(d){return r(1,d)}});function c(h,d,f){var p,m,y,v,b;if(d===1){if(v=h[0][0],v===0)throw Error("Cannot calculate inverse, determinant is zero");return[[r(1,v)]]}else if(d===2){var x=o(h);if(x===0)throw Error("Cannot calculate inverse, determinant is zero");return[[r(h[1][1],x),r(a(h[0][1]),x)],[r(a(h[1][0]),x),r(h[0][0],x)]]}else{var w=h.concat();for(p=0;p<d;p++)w[p]=w[p].concat();for(var _=l(d).valueOf(),E=0;E<f;E++){var A=u(w[E][E]),T=E;for(p=E+1;p<d;)u(w[p][E])>A&&(A=u(w[p][E]),T=p),p++;if(A===0)throw Error("Cannot calculate inverse, determinant is zero");p=T,p!==E&&(b=w[E],w[E]=w[p],w[p]=b,b=_[E],_[E]=_[p],_[p]=b);var S=w[E],M=_[E];for(p=0;p<d;p++){var D=w[p],N=_[p];if(p!==E){if(D[E]!==0){for(y=r(a(D[E]),S[E]),m=E;m<f;m++)D[m]=i(D[m],s(y,S[m]));for(m=0;m<f;m++)N[m]=i(N[m],s(y,M[m]))}}else{for(y=S[E],m=E;m<f;m++)D[m]=r(D[m],y);for(m=0;m<f;m++)N[m]=r(N[m],y)}}}return _}}}),PG="pinv",bVe=["typed","matrix","inv","deepEqual","equal","dotDivide","dot","ctranspose","divideScalar","multiply","add","Complex"],_Ve=re(PG,bVe,n=>{var{typed:e,matrix:t,inv:r,deepEqual:i,equal:s,dotDivide:a,dot:o,ctranspose:l,divideScalar:u,multiply:c,add:h,Complex:d}=n;return e(PG,{"Array | Matrix":function(x){var w=Dt(x)?x.size():Vt(x);switch(w.length){case 1:return v(x)?l(x):w[0]===1?r(x):a(l(x),o(x,x));case 2:{if(v(x))return l(x);var _=w[0],E=w[1];if(_===E)try{return r(x)}catch(A){if(!(A instanceof Error&&A.message.match(/Cannot calculate inverse, determinant is zero/)))throw A}return Dt(x)?t(f(x.valueOf(),_,E),x.storage()):f(x,_,E)}default:throw new RangeError("Matrix must be two dimensional (size: "+nn(w)+")")}},any:function(x){return s(x,0)?Ut(x):u(1,x)}});function f(b,x,w){var{C:_,F:E}=m(b,x,w),A=c(r(c(l(_),_)),l(_)),T=c(l(E),r(c(E,l(E))));return c(T,A)}function p(b,x,w){for(var _=Ut(b),E=0,A=0;A<x;A++){if(w<=E)return _;for(var T=A;y(_[T][E]);)if(T++,x===T&&(T=A,E++,w===E))return _;[_[T],_[A]]=[_[A],_[T]];for(var S=_[A][E],M=0;M<w;M++)_[A][M]=a(_[A][M],S);for(var D=0;D<x;D++)if(D!==A){S=_[D][E];for(var N=0;N<w;N++)_[D][N]=h(_[D][N],c(-1,c(S,_[A][N])))}E++}return _}function m(b,x,w){var _=p(b,x,w),E=b.map((T,S)=>T.filter((M,D)=>D<x&&!y(o(_[D],_[D])))),A=_.filter((T,S)=>!y(o(_[S],_[S])));return{C:E,F:A}}function y(b){return s(h(b,d(1,1)),h(0,d(1,1)))}function v(b){return i(h(b,d(1,1)),h(c(b,0),d(1,1)))}});function wVe(n){var{addScalar:e,subtract:t,flatten:r,multiply:i,multiplyScalar:s,divideScalar:a,sqrt:o,abs:l,bignumber:u,diag:c,size:h,reshape:d,inv:f,qr:p,usolve:m,usolveAll:y,equal:v,complex:b,larger:x,smaller:w,matrixFromColumns:_,dot:E}=n;function A(J,L,se,Z){var le=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,ue=T(J,L,se,Z,le);S(J,L,se,Z,le,ue);var{values:te,C:Y}=M(J,L,se,Z,le);if(le){var ie=D(J,L,Y,ue,te,se,Z);return{values:te,eigenvectors:ie}}return{values:te}}function T(J,L,se,Z,le){var ue=Z==="BigNumber",te=Z==="Complex",Y=ue?u(0):0,ie=ue?u(1):te?b(1):1,ve=ue?u(1):1,ge=ue?u(10):2,_e=s(ge,ge),we;le&&(we=Array(L).fill(ie));for(var Be=!1;!Be;){Be=!0;for(var $e=0;$e<L;$e++){for(var nt=Y,de=Y,Ye=0;Ye<L;Ye++)$e!==Ye&&(nt=e(nt,l(J[Ye][$e])),de=e(de,l(J[$e][Ye])));if(!v(nt,0)&&!v(de,0)){for(var Xe=ve,ae=nt,fe=a(de,ge),F=s(de,ge);w(ae,fe);)ae=s(ae,_e),Xe=s(Xe,ge);for(;x(ae,F);)ae=a(ae,_e),Xe=a(Xe,ge);var P=w(a(e(ae,de),Xe),s(e(nt,de),.95));if(P){Be=!1;for(var K=a(1,Xe),oe=0;oe<L;oe++)$e!==oe&&(J[$e][oe]=s(J[$e][oe],K),J[oe][$e]=s(J[oe][$e],Xe));le&&(we[$e]=s(we[$e],K))}}}}return le?c(we):null}function S(J,L,se,Z,le,ue){var te=Z==="BigNumber",Y=Z==="Complex",ie=te?u(0):Y?b(0):0;te&&(se=u(se));for(var ve=0;ve<L-2;ve++){for(var ge=0,_e=ie,we=ve+1;we<L;we++){var Be=J[we][ve];w(l(_e),l(Be))&&(_e=Be,ge=we)}if(!w(l(_e),se)){if(ge!==ve+1){var $e=J[ge];J[ge]=J[ve+1],J[ve+1]=$e;for(var nt=0;nt<L;nt++){var de=J[nt][ge];J[nt][ge]=J[nt][ve+1],J[nt][ve+1]=de}if(le){var Ye=ue[ge];ue[ge]=ue[ve+1],ue[ve+1]=Ye}}for(var Xe=ve+2;Xe<L;Xe++){var ae=a(J[Xe][ve],_e);if(ae!==0){for(var fe=0;fe<L;fe++)J[Xe][fe]=t(J[Xe][fe],s(ae,J[ve+1][fe]));for(var F=0;F<L;F++)J[F][ve+1]=e(J[F][ve+1],s(ae,J[F][Xe]));if(le)for(var P=0;P<L;P++)ue[Xe][P]=t(ue[Xe][P],s(ae,ue[ve+1][P]))}}}}return ue}function M(J,L,se,Z,le){var ue=Z==="BigNumber",te=Z==="Complex",Y=ue?u(1):te?b(1):1;ue&&(se=u(se));for(var ie=Ut(J),ve=[],ge=L,_e=[],we=le?c(Array(L).fill(Y)):void 0,Be=le?c(Array(ge).fill(Y)):void 0,$e=0;$e<=100;){$e+=1;for(var nt=ie[ge-1][ge-1],de=0;de<ge;de++)ie[de][de]=t(ie[de][de],nt);var{Q:Ye,R:Xe}=p(ie);ie=i(Xe,Ye);for(var ae=0;ae<ge;ae++)ie[ae][ae]=e(ie[ae][ae],nt);if(le&&(Be=i(Be,Ye)),ge===1||w(l(ie[ge-1][ge-2]),se)){$e=0,ve.push(ie[ge-1][ge-1]),le&&(_e.unshift([[1]]),O(Be,L),we=i(we,Be),ge>1&&(Be=c(Array(ge-1).fill(Y)))),ge-=1,ie.pop();for(var fe=0;fe<ge;fe++)ie[fe].pop()}else if(ge===2||w(l(ie[ge-2][ge-3]),se)){$e=0;var F=N(ie[ge-2][ge-2],ie[ge-2][ge-1],ie[ge-1][ge-2],ie[ge-1][ge-1]);ve.push(...F),le&&(_e.unshift(R(ie[ge-2][ge-2],ie[ge-2][ge-1],ie[ge-1][ge-2],ie[ge-1][ge-1],F[0],F[1],se,Z)),O(Be,L),we=i(we,Be),ge>2&&(Be=c(Array(ge-2).fill(Y)))),ge-=2,ie.pop(),ie.pop();for(var P=0;P<ge;P++)ie[P].pop(),ie[P].pop()}if(ge===0)break}if(ve.sort((pe,ce)=>+t(l(pe),l(ce))),$e>100){var K=Error("The eigenvalues failed to converge. Only found these eigenvalues: "+ve.join(", "));throw K.values=ve,K.vectors=[],K}var oe=le?i(we,G(_e,L)):void 0;return{values:ve,C:oe}}function D(J,L,se,Z,le,ue,te){var Y=f(se),ie=i(Y,J,se),ve=te==="BigNumber",ge=te==="Complex",_e=ve?u(0):ge?b(0):0,we=ve?u(1):ge?b(1):1,Be=[],$e=[];for(var nt of le){var de=I(Be,nt,v);de===-1?(Be.push(nt),$e.push(1)):$e[de]+=1}for(var Ye=[],Xe=Be.length,ae=Array(L).fill(_e),fe=c(Array(L).fill(we)),F=function(){var oe=Be[P],pe=t(ie,i(oe,fe)),ce=y(pe,ae);for(ce.shift();ce.length<$e[P];){var Te=B(pe,L,ce,ue,te);if(Te===null)break;ce.push(Te)}var be=i(f(Z),se);ce=ce.map(Pe=>i(be,Pe)),Ye.push(...ce.map(Pe=>({value:oe,vector:r(Pe)})))},P=0;P<Xe;P++)F();return Ye}function N(J,L,se,Z){var le=e(J,Z),ue=t(s(J,Z),s(L,se)),te=s(le,.5),Y=s(o(t(s(le,le),s(4,ue))),.5);return[e(te,Y),t(te,Y)]}function R(J,L,se,Z,le,ue,te,Y){var ie=Y==="BigNumber",ve=Y==="Complex",ge=ie?u(0):ve?b(0):0,_e=ie?u(1):ve?b(1):1;if(w(l(se),te))return[[_e,ge],[ge,_e]];if(x(l(t(le,ue)),te))return[[t(le,Z),t(ue,Z)],[se,se]];var we=t(J,le),Be=t(Z,le);return w(l(L),te)&&w(l(Be),te)?[[we,_e],[se,ge]]:[[L,ge],[Be,_e]]}function O(J,L){for(var se=0;se<J.length;se++)J[se].push(...Array(L-J[se].length).fill(0));for(var Z=J.length;Z<L;Z++)J.push(Array(L).fill(0)),J[Z][Z]=1;return J}function G(J,L){for(var se=[],Z=0;Z<L;Z++)se[Z]=Array(L).fill(0);var le=0;for(var ue of J){for(var te=ue.length,Y=0;Y<te;Y++)for(var ie=0;ie<te;ie++)se[le+Y][le+ie]=ue[Y][ie];le+=te}return se}function I(J,L,se){for(var Z=0;Z<J.length;Z++)if(se(J[Z],L))return Z;return-1}function B(J,L,se,Z,le){for(var ue=le==="BigNumber"?u(1e3):1e3,te,Y=0;Y<5;++Y){te=$(L,se,le);try{te=m(J,te)}catch{continue}if(x(Q(te),ue))break}if(Y>=5)return null;for(Y=0;;){var ie=m(J,te);if(w(Q(H(te,[ie])),Z))break;if(++Y>=10)return null;te=ee(ie)}return te}function $(J,L,se){var Z=se==="BigNumber",le=se==="Complex",ue=Array(J).fill(0).map(te=>2*Math.random()-1);return Z&&(ue=ue.map(te=>u(te))),le&&(ue=ue.map(te=>b(te))),ue=H(ue,L),ee(ue,se)}function H(J,L){var se=h(J);for(var Z of L)Z=d(Z,se),J=t(J,i(a(E(Z,J),E(Z,Z)),Z));return J}function Q(J){return l(o(E(J,J)))}function ee(J,L){var se=L==="BigNumber",Z=L==="Complex",le=se?u(1):Z?b(1):1;return i(a(le,Q(J)),J)}return A}function EVe(n){var{config:e,addScalar:t,subtract:r,abs:i,atan:s,cos:a,sin:o,multiplyScalar:l,inv:u,bignumber:c,multiply:h,add:d}=n;function f(S,M){var D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.relTol,N=arguments.length>3?arguments[3]:void 0,R=arguments.length>4?arguments[4]:void 0;if(N==="number")return p(S,D,R);if(N==="BigNumber")return m(S,D,R);throw TypeError("Unsupported data type: "+N)}function p(S,M,D){var N=S.length,R=Math.abs(M/N),O,G;if(D){G=new Array(N);for(var I=0;I<N;I++)G[I]=Array(N).fill(0),G[I][I]=1}for(var B=E(S);Math.abs(B[1])>=Math.abs(R);){var $=B[0][0],H=B[0][1];O=y(S[$][$],S[H][H],S[$][H]),S=_(S,O,$,H),D&&(G=b(G,O,$,H)),B=E(S)}for(var Q=Array(N).fill(0),ee=0;ee<N;ee++)Q[ee]=S[ee][ee];return T(Ut(Q),G,D)}function m(S,M,D){var N=S.length,R=i(M/N),O,G;if(D){G=new Array(N);for(var I=0;I<N;I++)G[I]=Array(N).fill(0),G[I][I]=1}for(var B=A(S);i(B[1])>=i(R);){var $=B[0][0],H=B[0][1];O=v(S[$][$],S[H][H],S[$][H]),S=w(S,O,$,H),D&&(G=x(G,O,$,H)),B=A(S)}for(var Q=Array(N).fill(0),ee=0;ee<N;ee++)Q[ee]=S[ee][ee];return T(Ut(Q),G,D)}function y(S,M,D){var N=M-S;return Math.abs(N)<=e.relTol?Math.PI/4:.5*Math.atan(2*D/(M-S))}function v(S,M,D){var N=r(M,S);return i(N)<=e.relTol?c(-1).acos().div(4):l(.5,s(h(2,D,u(N))))}function b(S,M,D,N){for(var R=S.length,O=Math.cos(M),G=Math.sin(M),I=Array(R).fill(0),B=Array(R).fill(0),$=0;$<R;$++)I[$]=O*S[$][D]-G*S[$][N],B[$]=G*S[$][D]+O*S[$][N];for(var H=0;H<R;H++)S[H][D]=I[H],S[H][N]=B[H];return S}function x(S,M,D,N){for(var R=S.length,O=a(M),G=o(M),I=Array(R).fill(c(0)),B=Array(R).fill(c(0)),$=0;$<R;$++)I[$]=r(l(O,S[$][D]),l(G,S[$][N])),B[$]=t(l(G,S[$][D]),l(O,S[$][N]));for(var H=0;H<R;H++)S[H][D]=I[H],S[H][N]=B[H];return S}function w(S,M,D,N){for(var R=S.length,O=c(a(M)),G=c(o(M)),I=l(O,O),B=l(G,G),$=Array(R).fill(c(0)),H=Array(R).fill(c(0)),Q=h(c(2),O,G,S[D][N]),ee=t(r(l(I,S[D][D]),Q),l(B,S[N][N])),J=d(l(B,S[D][D]),Q,l(I,S[N][N])),L=0;L<R;L++)$[L]=r(l(O,S[D][L]),l(G,S[N][L])),H[L]=t(l(G,S[D][L]),l(O,S[N][L]));S[D][D]=ee,S[N][N]=J,S[D][N]=c(0),S[N][D]=c(0);for(var se=0;se<R;se++)se!==D&&se!==N&&(S[D][se]=$[se],S[se][D]=$[se],S[N][se]=H[se],S[se][N]=H[se]);return S}function _(S,M,D,N){for(var R=S.length,O=Math.cos(M),G=Math.sin(M),I=O*O,B=G*G,$=Array(R).fill(0),H=Array(R).fill(0),Q=I*S[D][D]-2*O*G*S[D][N]+B*S[N][N],ee=B*S[D][D]+2*O*G*S[D][N]+I*S[N][N],J=0;J<R;J++)$[J]=O*S[D][J]-G*S[N][J],H[J]=G*S[D][J]+O*S[N][J];S[D][D]=Q,S[N][N]=ee,S[D][N]=0,S[N][D]=0;for(var L=0;L<R;L++)L!==D&&L!==N&&(S[D][L]=$[L],S[L][D]=$[L],S[N][L]=H[L],S[L][N]=H[L]);return S}function E(S){for(var M=S.length,D=0,N=[0,1],R=0;R<M;R++)for(var O=R+1;O<M;O++)Math.abs(D)<Math.abs(S[R][O])&&(D=Math.abs(S[R][O]),N=[R,O]);return[N,D]}function A(S){for(var M=S.length,D=0,N=[0,1],R=0;R<M;R++)for(var O=R+1;O<M;O++)i(D)<i(S[R][O])&&(D=i(S[R][O]),N=[R,O]);return[N,D]}function T(S,M,D){var N=S.length,R=Array(N),O;if(D){O=Array(N);for(var G=0;G<N;G++)O[G]=Array(N)}for(var I=0;I<N;I++){for(var B=0,$=S[0],H=0;H<S.length;H++)i(S[H])<i($)&&(B=H,$=S[B]);if(R[I]=S.splice(B,1)[0],D)for(var Q=0;Q<N;Q++)O[I][Q]=M[Q][B],M[Q].splice(B,1)}if(!D)return{values:R};var ee=O.map((J,L)=>({value:R[L],vector:J}));return{values:R,eigenvectors:ee}}return f}var SVe="eigs",AVe=["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","divideScalar","inv","bignumber","multiply","add","larger","column","flatten","number","complex","sqrt","diag","size","reshape","qr","usolve","usolveAll","im","re","smaller","matrixFromColumns","dot"],TVe=re(SVe,AVe,n=>{var{config:e,typed:t,matrix:r,addScalar:i,subtract:s,equal:a,abs:o,atan:l,cos:u,sin:c,multiplyScalar:h,divideScalar:d,inv:f,bignumber:p,multiply:m,add:y,larger:v,column:b,flatten:x,number:w,complex:_,sqrt:E,diag:A,size:T,reshape:S,qr:M,usolve:D,usolveAll:N,im:R,re:O,smaller:G,matrixFromColumns:I,dot:B}=n,$=EVe({config:e,addScalar:i,subtract:s,abs:o,atan:l,cos:u,sin:c,multiplyScalar:h,inv:f,bignumber:p,multiply:m,add:y}),H=wVe({addScalar:i,subtract:s,multiply:m,multiplyScalar:h,flatten:x,divideScalar:d,sqrt:E,abs:o,bignumber:p,diag:A,size:T,reshape:S,qr:M,inv:f,usolve:D,usolveAll:N,equal:a,complex:_,larger:v,smaller:G,matrixFromColumns:I,dot:B});return t("eigs",{Array:function(ue){return Q(r(ue))},"Array, number|BigNumber":function(ue,te){return Q(r(ue),{precision:te})},"Array, Object"(le,ue){return Q(r(le),ue)},Matrix:function(ue){return Q(ue,{matricize:!0})},"Matrix, number|BigNumber":function(ue,te){return Q(ue,{precision:te,matricize:!0})},"Matrix, Object":function(ue,te){var Y={matricize:!0};return li(Y,te),Q(ue,Y)}});function Q(le){var ue,te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Y="eigenvectors"in te?te.eigenvectors:!0,ie=(ue=te.precision)!==null&&ue!==void 0?ue:e.relTol,ve=ee(le,ie,Y);return te.matricize&&(ve.values=r(ve.values),Y&&(ve.eigenvectors=ve.eigenvectors.map(ge=>{var{value:_e,vector:we}=ge;return{value:_e,vector:r(we)}}))),Y&&Object.defineProperty(ve,"vectors",{enumerable:!1,get:()=>{throw new Error("eigs(M).vectors replaced with eigs(M).eigenvectors")}}),ve}function ee(le,ue,te){var Y=le.toArray(),ie=le.size();if(ie.length!==2||ie[0]!==ie[1])throw new RangeError("Matrix must be square (size: ".concat(nn(ie),")"));var ve=ie[0];if(L(Y,ve,ue)&&(se(Y,ve),J(Y,ve,ue))){var ge=Z(le,Y,ve);return $(Y,ve,ue,ge,te)}var _e=Z(le,Y,ve);return H(Y,ve,ue,_e,te)}function J(le,ue,te){for(var Y=0;Y<ue;Y++)for(var ie=Y;ie<ue;ie++)if(v(p(o(s(le[Y][ie],le[ie][Y]))),te))return!1;return!0}function L(le,ue,te){for(var Y=0;Y<ue;Y++)for(var ie=0;ie<ue;ie++)if(v(p(o(R(le[Y][ie]))),te))return!1;return!0}function se(le,ue){for(var te=0;te<ue;te++)for(var Y=0;Y<ue;Y++)le[te][Y]=O(le[te][Y])}function Z(le,ue,te){var Y=le.datatype();if(Y==="number"||Y==="BigNumber"||Y==="Complex")return Y;for(var ie=!1,ve=!1,ge=!1,_e=0;_e<te;_e++)for(var we=0;we<te;we++){var Be=ue[_e][we];if(Tt(Be)||sA(Be))ie=!0;else if(jt(Be))ve=!0;else if(Qh(Be))ge=!0;else throw TypeError("Unsupported type in Matrix: "+Yn(Be))}if(ve&&ge&&console.warn("Complex BigNumbers not supported, this operation will lose precission."),ge){for(var $e=0;$e<te;$e++)for(var nt=0;nt<te;nt++)ue[$e][nt]=_(ue[$e][nt]);return"Complex"}if(ve){for(var de=0;de<te;de++)for(var Ye=0;Ye<te;Ye++)ue[de][Ye]=p(ue[de][Ye]);return"BigNumber"}if(ie){for(var Xe=0;Xe<te;Xe++)for(var ae=0;ae<te;ae++)ue[Xe][ae]=w(ue[Xe][ae]);return"number"}else throw TypeError("Matrix contains unsupported types only.")}}),FG="expm",MVe=["typed","abs","add","identity","inv","multiply"],CVe=re(FG,MVe,n=>{var{typed:e,abs:t,add:r,identity:i,inv:s,multiply:a}=n;return e(FG,{Matrix:function(h){var d=h.size();if(d.length!==2||d[0]!==d[1])throw new RangeError("Matrix must be square (size: "+nn(d)+")");for(var f=d[0],p=1e-15,m=o(h),y=l(m,p),v=y.q,b=y.j,x=a(h,Math.pow(2,-b)),w=i(f),_=i(f),E=1,A=x,T=-1,S=1;S<=v;S++)S>1&&(A=a(A,x),T=-T),E=E*(v-S+1)/((2*v-S+1)*S),w=r(w,a(E,A)),_=r(_,a(E*T,A));for(var M=a(s(_),w),D=0;D<b;D++)M=a(M,M);return Hm(h)?h.createSparseMatrix(M):M}});function o(c){for(var h=c.size()[0],d=0,f=0;f<h;f++){for(var p=0,m=0;m<h;m++)p+=t(c.get([f,m]));d=Math.max(p,d)}return d}function l(c,h){for(var d=30,f=0;f<d;f++)for(var p=0;p<=f;p++){var m=f-p;if(u(c,p,m)<h)return{q:p,j:m}}throw new Error("Could not find acceptable parameters to compute the matrix exponential (try increasing maxSearchSize in expm.js)")}function u(c,h,d){for(var f=1,p=2;p<=h;p++)f*=p;for(var m=f,y=h+1;y<=2*h;y++)m*=y;var v=m*(2*h+1);return 8*Math.pow(c/Math.pow(2,d),2*h)*f*f/(m*v)}}),LG="sqrtm",DVe=["typed","abs","add","multiply","map","sqrt","subtract","inv","size","max","identity"],NVe=re(LG,DVe,n=>{var{typed:e,abs:t,add:r,multiply:i,map:s,sqrt:a,subtract:o,inv:l,size:u,max:c,identity:h}=n,d=1e3,f=1e-6;function p(m){var y,v=0,b=m,x=h(u(m));do{var w=b;if(b=i(.5,r(w,l(x))),x=i(.5,r(x,l(w))),y=c(t(o(b,w))),y>f&&++v>d)throw new Error("computing square root of matrix: iterative method could not converge")}while(y>f);return b}return e(LG,{"Array | Matrix":function(y){var v=Dt(y)?y.size():Vt(y);switch(v.length){case 1:if(v[0]===1)return s(y,a);throw new RangeError("Matrix must be square (size: "+nn(v)+")");case 2:{var b=v[0],x=v[1];if(b===x)return p(y);throw new RangeError("Matrix must be square (size: "+nn(v)+")")}default:throw new RangeError("Matrix must be at most two dimensional (size: "+nn(v)+")")}}})}),OG="sylvester",RVe=["typed","schur","matrixFromColumns","matrix","multiply","range","concat","transpose","index","subset","add","subtract","identity","lusolve","abs"],IVe=re(OG,RVe,n=>{var{typed:e,schur:t,matrixFromColumns:r,matrix:i,multiply:s,range:a,concat:o,transpose:l,index:u,subset:c,add:h,subtract:d,identity:f,lusolve:p,abs:m,config:y}=n;return e(OG,{"Matrix, Matrix, Matrix":v,"Array, Matrix, Matrix":function(x,w,_){return v(i(x),w,_)},"Array, Array, Matrix":function(x,w,_){return v(i(x),i(w),_)},"Array, Matrix, Array":function(x,w,_){return v(i(x),w,i(_))},"Matrix, Array, Matrix":function(x,w,_){return v(x,i(w),_)},"Matrix, Array, Array":function(x,w,_){return v(x,i(w),i(_))},"Matrix, Matrix, Array":function(x,w,_){return v(x,w,i(_))},"Array, Array, Array":function(x,w,_){return v(i(x),i(w),i(_)).toArray()}});function v(b,x,w){for(var _=x.size()[0],E=b.size()[0],A=t(b),T=A.T,S=A.U,M=t(s(-1,x)),D=M.T,N=M.U,R=s(s(l(S),w),N),O=a(0,E),G=[],I=(_e,we)=>o(_e,we,1),B=(_e,we)=>o(_e,we,0),$=0;$<_;$++)if($<_-1&&m(c(D,u($+1,$)))>1e-5){for(var H=B(c(R,u(O,[$])),c(R,u(O,[$+1]))),Q=0;Q<$;Q++)H=h(H,B(s(G[Q],c(D,u(Q,$))),s(G[Q],c(D,u(Q,$+1)))));var ee=s(f(E),s(-1,c(D,u($,$)))),J=s(f(E),s(-1,c(D,u($+1,$)))),L=s(f(E),s(-1,c(D,u($,$+1)))),se=s(f(E),s(-1,c(D,u($+1,$+1)))),Z=B(I(h(T,ee),J),I(L,h(T,se))),le=p(Z,H);G[$]=le.subset(u(a(0,E),[0])),G[$+1]=le.subset(u(a(E,2*E),[0])),$++}else{for(var ue=c(R,u(O,[$])),te=0;te<$;te++)ue=h(ue,s(G[te],c(D,u(te,$))));var Y=c(D,u($,$)),ie=d(T,s(Y,f(E)));G[$]=p(ie,ue)}var ve=i(r(...G)),ge=s(S,s(ve,l(N)));return ge}}),kG="schur",PVe=["typed","matrix","identity","multiply","qr","norm","subtract"],FVe=re(kG,PVe,n=>{var{typed:e,matrix:t,identity:r,multiply:i,qr:s,norm:a,subtract:o}=n;return e(kG,{Array:function(c){var h=l(t(c));return{U:h.U.valueOf(),T:h.T.valueOf()}},Matrix:function(c){return l(c)}});function l(u){var c=u.size()[0],h=u,d=r(c),f=0,p;do{p=h;var m=s(h),y=m.Q,v=m.R;if(h=i(v,y),d=i(d,y),f++>100)break}while(a(o(h,p))>1e-4);return{U:d,T:h}}}),BG="lyap",LVe=["typed","matrix","sylvester","multiply","transpose"],OVe=re(BG,LVe,n=>{var{typed:e,matrix:t,sylvester:r,multiply:i,transpose:s}=n;return e(BG,{"Matrix, Matrix":function(o,l){return r(o,s(o),i(-1,l))},"Array, Matrix":function(o,l){return r(t(o),s(t(o)),i(-1,l))},"Matrix, Array":function(o,l){return r(o,s(t(o)),t(i(-1,l)))},"Array, Array":function(o,l){return r(t(o),s(t(o)),t(i(-1,l))).toArray()}})}),kVe="divide",BVe=["typed","matrix","multiply","equalScalar","divideScalar","inv"],UVe=re(kVe,BVe,n=>{var{typed:e,matrix:t,multiply:r,equalScalar:i,divideScalar:s,inv:a}=n,o=Is({typed:e,equalScalar:i}),l=Rl({typed:e});return e("divide",fte({"Array | Matrix, Array | Matrix":function(c,h){return r(c,a(h))},"DenseMatrix, any":function(c,h){return l(c,h,s,!1)},"SparseMatrix, any":function(c,h){return o(c,h,s,!1)},"Array, any":function(c,h){return l(t(c),h,s,!1).valueOf()},"any, Array | Matrix":function(c,h){return r(c,a(h))}},s.signatures))}),UG="distance",VVe=["typed","addScalar","subtractScalar","divideScalar","multiplyScalar","deepEqual","sqrt","abs"],zVe=re(UG,VVe,n=>{var{typed:e,addScalar:t,subtractScalar:r,multiplyScalar:i,divideScalar:s,deepEqual:a,sqrt:o,abs:l}=n;return e(UG,{"Array, Array, Array":function(_,E,A){if(_.length===2&&E.length===2&&A.length===2){if(!c(_))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!c(E))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!c(A))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(a(E,A))throw new TypeError("LinePoint1 should not be same with LinePoint2");var T=r(A[1],E[1]),S=r(E[0],A[0]),M=r(i(A[0],E[1]),i(E[0],A[1]));return y(_[0],_[1],T,S,M)}else throw new TypeError("Invalid Arguments: Try again")},"Object, Object, Object":function(_,E,A){if(Object.keys(_).length===2&&Object.keys(E).length===2&&Object.keys(A).length===2){if(!c(_))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!c(E))throw new TypeError("Values of lineOnePtX and lineOnePtY should be numbers or BigNumbers");if(!c(A))throw new TypeError("Values of lineTwoPtX and lineTwoPtY should be numbers or BigNumbers");if(a(p(E),p(A)))throw new TypeError("LinePoint1 should not be same with LinePoint2");if("pointX"in _&&"pointY"in _&&"lineOnePtX"in E&&"lineOnePtY"in E&&"lineTwoPtX"in A&&"lineTwoPtY"in A){var T=r(A.lineTwoPtY,E.lineOnePtY),S=r(E.lineOnePtX,A.lineTwoPtX),M=r(i(A.lineTwoPtX,E.lineOnePtY),i(E.lineOnePtX,A.lineTwoPtY));return y(_.pointX,_.pointY,T,S,M)}else throw new TypeError("Key names do not match")}else throw new TypeError("Invalid Arguments: Try again")},"Array, Array":function(_,E){if(_.length===2&&E.length===3){if(!c(_))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!h(E))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");return y(_[0],_[1],E[0],E[1],E[2])}else if(_.length===3&&E.length===6){if(!h(_))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!f(E))throw new TypeError("Array with 6 numbers or BigNumbers expected for second argument");return v(_[0],_[1],_[2],E[0],E[1],E[2],E[3],E[4],E[5])}else if(_.length===E.length&&_.length>0){if(!d(_))throw new TypeError("All values of an array should be numbers or BigNumbers");if(!d(E))throw new TypeError("All values of an array should be numbers or BigNumbers");return b(_,E)}else throw new TypeError("Invalid Arguments: Try again")},"Object, Object":function(_,E){if(Object.keys(_).length===2&&Object.keys(E).length===3){if(!c(_))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!h(E))throw new TypeError("Values of xCoeffLine, yCoeffLine and constant should be numbers or BigNumbers");if("pointX"in _&&"pointY"in _&&"xCoeffLine"in E&&"yCoeffLine"in E&&"constant"in E)return y(_.pointX,_.pointY,E.xCoeffLine,E.yCoeffLine,E.constant);throw new TypeError("Key names do not match")}else if(Object.keys(_).length===3&&Object.keys(E).length===6){if(!h(_))throw new TypeError("Values of pointX, pointY and pointZ should be numbers or BigNumbers");if(!f(E))throw new TypeError("Values of x0, y0, z0, a, b and c should be numbers or BigNumbers");if("pointX"in _&&"pointY"in _&&"x0"in E&&"y0"in E&&"z0"in E&&"a"in E&&"b"in E&&"c"in E)return v(_.pointX,_.pointY,_.pointZ,E.x0,E.y0,E.z0,E.a,E.b,E.c);throw new TypeError("Key names do not match")}else if(Object.keys(_).length===2&&Object.keys(E).length===2){if(!c(_))throw new TypeError("Values of pointOneX and pointOneY should be numbers or BigNumbers");if(!c(E))throw new TypeError("Values of pointTwoX and pointTwoY should be numbers or BigNumbers");if("pointOneX"in _&&"pointOneY"in _&&"pointTwoX"in E&&"pointTwoY"in E)return b([_.pointOneX,_.pointOneY],[E.pointTwoX,E.pointTwoY]);throw new TypeError("Key names do not match")}else if(Object.keys(_).length===3&&Object.keys(E).length===3){if(!h(_))throw new TypeError("Values of pointOneX, pointOneY and pointOneZ should be numbers or BigNumbers");if(!h(E))throw new TypeError("Values of pointTwoX, pointTwoY and pointTwoZ should be numbers or BigNumbers");if("pointOneX"in _&&"pointOneY"in _&&"pointOneZ"in _&&"pointTwoX"in E&&"pointTwoY"in E&&"pointTwoZ"in E)return b([_.pointOneX,_.pointOneY,_.pointOneZ],[E.pointTwoX,E.pointTwoY,E.pointTwoZ]);throw new TypeError("Key names do not match")}else throw new TypeError("Invalid Arguments: Try again")},Array:function(_){if(!m(_))throw new TypeError("Incorrect array format entered for pairwise distance calculation");return x(_)}});function u(w){return typeof w=="number"||jt(w)}function c(w){return w.constructor!==Array&&(w=p(w)),u(w[0])&&u(w[1])}function h(w){return w.constructor!==Array&&(w=p(w)),u(w[0])&&u(w[1])&&u(w[2])}function d(w){return Array.isArray(w)||(w=p(w)),w.every(u)}function f(w){return w.constructor!==Array&&(w=p(w)),u(w[0])&&u(w[1])&&u(w[2])&&u(w[3])&&u(w[4])&&u(w[5])}function p(w){for(var _=Object.keys(w),E=[],A=0;A<_.length;A++)E.push(w[_[A]]);return E}function m(w){if(w[0].length===2&&u(w[0][0])&&u(w[0][1])){if(w.some(_=>_.length!==2||!u(_[0])||!u(_[1])))return!1}else if(w[0].length===3&&u(w[0][0])&&u(w[0][1])&&u(w[0][2])){if(w.some(_=>_.length!==3||!u(_[0])||!u(_[1])||!u(_[2])))return!1}else return!1;return!0}function y(w,_,E,A,T){var S=l(t(t(i(E,w),i(A,_)),T)),M=o(t(i(E,E),i(A,A)));return s(S,M)}function v(w,_,E,A,T,S,M,D,N){var R=[r(i(r(T,_),N),i(r(S,E),D)),r(i(r(S,E),M),i(r(A,w),N)),r(i(r(A,w),D),i(r(T,_),M))];R=o(t(t(i(R[0],R[0]),i(R[1],R[1])),i(R[2],R[2])));var O=o(t(t(i(M,M),i(D,D)),i(N,N)));return s(R,O)}function b(w,_){for(var E=w.length,A=0,T=0,S=0;S<E;S++)T=r(w[S],_[S]),A=t(i(T,T),A);return o(A)}function x(w){for(var _=[],E=[],A=[],T=0;T<w.length-1;T++)for(var S=T+1;S<w.length;S++)w[0].length===2?(E=[w[T][0],w[T][1]],A=[w[S][0],w[S][1]]):w[0].length===3&&(E=[w[T][0],w[T][1],w[T][2]],A=[w[S][0],w[S][1],w[S][2]]),_.push(b(E,A));return _}}),$Ve="intersect",HVe=["typed","config","abs","add","addScalar","matrix","multiply","multiplyScalar","divideScalar","subtract","smaller","equalScalar","flatten","isZero","isNumeric"],GVe=re($Ve,HVe,n=>{var{typed:e,config:t,abs:r,add:i,addScalar:s,matrix:a,multiply:o,multiplyScalar:l,divideScalar:u,subtract:c,smaller:h,equalScalar:d,flatten:f,isZero:p,isNumeric:m}=n;return e("intersect",{"Array, Array, Array":y,"Array, Array, Array, Array":v,"Matrix, Matrix, Matrix":function(D,N,R){var O=y(D.valueOf(),N.valueOf(),R.valueOf());return O===null?null:a(O)},"Matrix, Matrix, Matrix, Matrix":function(D,N,R,O){var G=v(D.valueOf(),N.valueOf(),R.valueOf(),O.valueOf());return G===null?null:a(G)}});function y(M,D,N){if(M=b(M),D=b(D),N=b(N),!w(M))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!w(D))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!_(N))throw new TypeError("Array with 4 numbers expected as third argument");return S(M[0],M[1],M[2],D[0],D[1],D[2],N[0],N[1],N[2],N[3])}function v(M,D,N,R){if(M=b(M),D=b(D),N=b(N),R=b(R),M.length===2){if(!x(M))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!x(D))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!x(N))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(!x(R))throw new TypeError("Array with 2 numbers or BigNumbers expected for fourth argument");return E(M,D,N,R)}else if(M.length===3){if(!w(M))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!w(D))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!w(N))throw new TypeError("Array with 3 numbers or BigNumbers expected for third argument");if(!w(R))throw new TypeError("Array with 3 numbers or BigNumbers expected for fourth argument");return T(M[0],M[1],M[2],D[0],D[1],D[2],N[0],N[1],N[2],R[0],R[1],R[2])}else throw new TypeError("Arrays with two or thee dimensional points expected")}function b(M){return M.length===1?M[0]:M.length>1&&Array.isArray(M[0])&&M.every(D=>Array.isArray(D)&&D.length===1)?f(M):M}function x(M){return M.length===2&&m(M[0])&&m(M[1])}function w(M){return M.length===3&&m(M[0])&&m(M[1])&&m(M[2])}function _(M){return M.length===4&&m(M[0])&&m(M[1])&&m(M[2])&&m(M[3])}function E(M,D,N,R){var O=M,G=N,I=c(O,D),B=c(G,R),$=c(l(I[0],B[1]),l(B[0],I[1]));if(p($)||h(r($),t.relTol))return null;var H=l(B[0],O[1]),Q=l(B[1],O[0]),ee=l(B[0],G[1]),J=l(B[1],G[0]),L=u(s(c(c(H,Q),ee),J),$);return i(o(I,L),O)}function A(M,D,N,R,O,G,I,B,$,H,Q,ee){var J=l(c(M,D),c(N,R)),L=l(c(O,G),c(I,B)),se=l(c($,H),c(Q,ee));return s(s(J,L),se)}function T(M,D,N,R,O,G,I,B,$,H,Q,ee){var J=A(M,I,H,I,D,B,Q,B,N,$,ee,$),L=A(H,I,R,M,Q,B,O,D,ee,$,G,N),se=A(M,I,R,M,D,B,O,D,N,$,G,N),Z=A(H,I,H,I,Q,B,Q,B,ee,$,ee,$),le=A(R,M,R,M,O,D,O,D,G,N,G,N),ue=c(l(J,L),l(se,Z)),te=c(l(le,Z),l(L,L));if(p(te))return null;var Y=u(ue,te),ie=u(s(J,l(Y,L)),Z),ve=s(M,l(Y,c(R,M))),ge=s(D,l(Y,c(O,D))),_e=s(N,l(Y,c(G,N))),we=s(I,l(ie,c(H,I))),Be=s(B,l(ie,c(Q,B))),$e=s($,l(ie,c(ee,$)));return d(ve,we)&&d(ge,Be)&&d(_e,$e)?[ve,ge,_e]:null}function S(M,D,N,R,O,G,I,B,$,H){var Q=l(M,I),ee=l(R,I),J=l(D,B),L=l(O,B),se=l(N,$),Z=l(G,$),le=c(c(c(H,Q),J),se),ue=c(c(c(s(s(ee,L),Z),Q),J),se),te=u(le,ue),Y=s(M,l(te,c(R,M))),ie=s(D,l(te,c(O,D))),ve=s(N,l(te,c(G,N)));return[Y,ie,ve]}}),VG="sum",jVe=["typed","config","add","numeric"],sre=re(VG,jVe,n=>{var{typed:e,config:t,add:r,numeric:i}=n;return e(VG,{"Array | Matrix":s,"Array | Matrix, number | BigNumber":a,"...":function(l){if(Wb(l))throw new TypeError("Scalar values expected in function sum");return s(l)}});function s(o){var l;return Op(o,function(u){try{l=l===void 0?u:r(l,u)}catch(c){throw Ca(c,"sum",u)}}),l===void 0&&(l=i(0,t.number)),typeof l=="string"&&(l=i(l,Wp(l,t))),l}function a(o,l){try{var u=BN(o,l,r);return u}catch(c){throw Ca(c,"sum")}}}),ZT="cumsum",qVe=["typed","add","unaryPlus"],are=re(ZT,qVe,n=>{var{typed:e,add:t,unaryPlus:r}=n;return e(ZT,{Array:i,Matrix:function(u){return u.create(i(u.valueOf(),u.datatype()))},"Array, number | BigNumber":a,"Matrix, number | BigNumber":function(u,c){return u.create(a(u.valueOf(),c),u.datatype())},"...":function(u){if(Wb(u))throw new TypeError("All values expected to be scalar in function cumsum");return i(u)}});function i(l){try{return s(l)}catch(u){throw Ca(u,ZT)}}function s(l){if(l.length===0)return[];for(var u=[r(l[0])],c=1;c<l.length;++c)u.push(t(u[c-1],l[c]));return u}function a(l,u){var c=Vt(l);if(u<0||u>=c.length)throw new vu(u,c.length);try{return o(l,u)}catch(h){throw Ca(h,ZT)}}function o(l,u){var c,h,d;if(u<=0){var f=l[0][0];if(Array.isArray(f)){for(d=zte(l),h=[],c=0;c<d.length;c++)h[c]=o(d[c],u-1);return h}else return s(l)}else{for(h=[],c=0;c<l.length;c++)h[c]=o(l[c],u-1);return h}}}),zG="mean",WVe=["typed","add","divide"],ore=re(zG,WVe,n=>{var{typed:e,add:t,divide:r}=n;return e(zG,{"Array | Matrix":s,"Array | Matrix, number | BigNumber":i,"...":function(o){if(Wb(o))throw new TypeError("Scalar values expected in function mean");return s(o)}});function i(a,o){try{var l=BN(a,o,t),u=Array.isArray(a)?Vt(a):a.size();return r(l,u[o])}catch(c){throw Ca(c,"mean")}}function s(a){var o,l=0;if(Op(a,function(u){try{o=o===void 0?u:t(o,u),l++}catch(c){throw Ca(c,"mean",u)}}),l===0)throw new Error("Cannot calculate the mean of an empty array");return r(o,l)}}),$G="median",XVe=["typed","add","divide","compare","partitionSelect"],KVe=re($G,XVe,n=>{var{typed:e,add:t,divide:r,compare:i,partitionSelect:s}=n;function a(u){try{u=Tn(u.valueOf());var c=u.length;if(c===0)throw new Error("Cannot calculate median of an empty array");if(c%2===0){for(var h=c/2-1,d=s(u,h+1),f=u[h],p=0;p<h;++p)i(u[p],f)>0&&(f=u[p]);return l(f,d)}else{var m=s(u,(c-1)/2);return o(m)}}catch(y){throw Ca(y,"median")}}var o=e({"number | BigNumber | Complex | Unit":function(c){return c}}),l=e({"number | BigNumber | Complex | Unit, number | BigNumber | Complex | Unit":function(c,h){return r(t(c,h),2)}});return e($G,{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(c,h){throw new Error("median(A, dim) is not yet supported")},"...":function(c){if(Wb(c))throw new TypeError("Scalar values expected in function median");return a(c)}})}),HG="mad",YVe=["typed","abs","map","median","subtract"],QVe=re(HG,YVe,n=>{var{typed:e,abs:t,map:r,median:i,subtract:s}=n;return e(HG,{"Array | Matrix":a,"...":function(l){return a(l)}});function a(o){if(o=Tn(o.valueOf()),o.length===0)throw new Error("Cannot calculate median absolute deviation (mad) of an empty array");try{var l=i(o);return i(r(o,function(u){return t(s(u,l))}))}catch(u){throw u instanceof TypeError&&u.message.includes("median")?new TypeError(u.message.replace("median","mad")):Ca(u,"mad")}}}),nP="unbiased",GG="variance",ZVe=["typed","add","subtract","multiply","divide","mapSlices","isNaN"],lre=re(GG,ZVe,n=>{var{typed:e,add:t,subtract:r,multiply:i,divide:s,mapSlices:a,isNaN:o}=n;return e(GG,{"Array | Matrix":function(h){return l(h,nP)},"Array | Matrix, string":l,"Array | Matrix, number | BigNumber":function(h,d){return u(h,d,nP)},"Array | Matrix, number | BigNumber, string":u,"...":function(h){return l(h,nP)}});function l(c,h){var d,f=0;if(c.length===0)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");if(Op(c,function(y){try{d=d===void 0?y:t(d,y),f++}catch(v){throw Ca(v,"variance",y)}}),f===0)throw new Error("Cannot calculate variance of an empty array");var p=s(d,f);if(d=void 0,Op(c,function(y){var v=r(y,p);d=d===void 0?i(v,v):t(d,i(v,v))}),o(d))return d;switch(h){case"uncorrected":return s(d,f);case"biased":return s(d,f+1);case"unbiased":{var m=jt(d)?d.mul(0):0;return f===1?m:s(d,f-1)}default:throw new Error('Unknown normalization "'+h+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}function u(c,h,d){try{if(c.length===0)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");return a(c,h,f=>l(f,d))}catch(f){throw Ca(f,"variance")}}}),jG="quantileSeq",JVe=["typed","?bignumber","add","subtract","divide","multiply","partitionSelect","compare","isInteger","smaller","smallerEq","larger","mapSlices"],ure=re(jG,JVe,n=>{var{typed:e,bignumber:t,add:r,subtract:i,divide:s,multiply:a,partitionSelect:o,compare:l,isInteger:u,smaller:c,smallerEq:h,larger:d,mapSlices:f}=n;return e(jG,{"Array | Matrix, number | BigNumber":(b,x)=>m(b,x,!1),"Array | Matrix, number | BigNumber, number":(b,x,w)=>p(b,x,!1,w,m),"Array | Matrix, number | BigNumber, boolean":m,"Array | Matrix, number | BigNumber, boolean, number":(b,x,w,_)=>p(b,x,w,_,m),"Array | Matrix, Array | Matrix":(b,x)=>y(b,x,!1),"Array | Matrix, Array | Matrix, number":(b,x,w)=>p(b,x,!1,w,y),"Array | Matrix, Array | Matrix, boolean":y,"Array | Matrix, Array | Matrix, boolean, number":(b,x,w,_)=>p(b,x,w,_,y)});function p(b,x,w,_,E){return f(b,_,A=>E(A,x,w))}function m(b,x,w){var _,E=b.valueOf();if(c(x,0))throw new Error("N/prob must be non-negative");if(h(x,1))return Tt(x)?v(E,x,w):t(v(E,x,w));if(d(x,1)){if(!u(x))throw new Error("N must be a positive integer");if(d(x,4294967295))throw new Error("N must be less than or equal to 2^32-1, as that is the maximum length of an Array");var A=r(x,1);_=[];for(var T=0;c(T,x);T++){var S=s(T+1,A);_.push(v(E,S,w))}return Tt(x)?_:t(_)}}function y(b,x,w){for(var _=b.valueOf(),E=x.valueOf(),A=[],T=0;T<E.length;++T)A.push(v(_,E[T],w));return A}function v(b,x,w){var _=Tn(b),E=_.length;if(E===0)throw new Error("Cannot calculate quantile of an empty sequence");var A=Tt(x)?x*(E-1):x.times(E-1),T=Tt(x)?Math.floor(A):A.floor().toNumber(),S=Tt(x)?A%1:A.minus(T);if(u(A))return w?_[A]:o(_,Tt(x)?A:A.valueOf());var M,D;if(w)M=_[T],D=_[T+1];else{D=o(_,T+1),M=_[T];for(var N=0;N<T;++N)l(_[N],M)>0&&(M=_[N])}return r(a(M,i(1,S)),a(D,S))}}),qG="std",e6e=["typed","map","sqrt","variance"],cre=re(qG,e6e,n=>{var{typed:e,map:t,sqrt:r,variance:i}=n;return e(qG,{"Array | Matrix":s,"Array | Matrix, string":s,"Array | Matrix, number | BigNumber":s,"Array | Matrix, number | BigNumber, string":s,"...":function(o){return s(o)}});function s(a,o){if(a.length===0)throw new SyntaxError("Function std requires one or more parameters (0 provided)");try{var l=i.apply(null,arguments);return Vo(l)?t(l,r):r(l)}catch(u){throw u instanceof TypeError&&u.message.includes(" variance")?new TypeError(u.message.replace(" variance"," std")):u}}}),WG="corr",t6e=["typed","matrix","mean","sqrt","sum","add","subtract","multiply","pow","divide"],n6e=re(WG,t6e,n=>{var{typed:e,matrix:t,sqrt:r,sum:i,add:s,subtract:a,multiply:o,pow:l,divide:u}=n;return e(WG,{"Array, Array":function(f,p){return c(f,p)},"Matrix, Matrix":function(f,p){var m=c(f.toArray(),p.toArray());return Array.isArray(m)?t(m):m}});function c(d,f){var p=[];if(Array.isArray(d[0])&&Array.isArray(f[0])){if(d.length!==f.length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same length.");for(var m=0;m<d.length;m++){if(d[m].length!==f[m].length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same number of elements.");p.push(h(d[m],f[m]))}return p}else{if(d.length!==f.length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same number of elements.");return h(d,f)}}function h(d,f){var p=d.length,m=i(d),y=i(f),v=d.reduce((E,A,T)=>s(E,o(A,f[T])),0),b=i(d.map(E=>l(E,2))),x=i(f.map(E=>l(E,2))),w=a(o(p,v),o(m,y)),_=r(o(a(o(p,b),l(m,2)),a(o(p,x),l(y,2))));return u(w,_)}}),XG="bernoulli",r6e=["typed","config","isInteger","number","?BigNumber","?Fraction"],i6e=re(XG,r6e,n=>{var{typed:e,config:t,number:r,BigNumber:i,Fraction:s}=n,a=[void 0],o=[void 0],l=[void 0],u=50;return e(XG,{number:c=>rP(c,h=>h,a,(h,d)=>h+d,(h,d)=>h*d,(h,d)=>h/d),"bigint | Fraction":c=>rP(r(c),h=>new s(h),o,(h,d)=>h.add(d),(h,d)=>h.mul(d),(h,d)=>h.div(d)),BigNumber:c=>(t.precision!==u&&(l=[void 0],u=t.precision),rP(r(c),h=>new i(h),l,(h,d)=>h.add(d),(h,d)=>h.mul(d),(h,d)=>h.div(d)))})});function rP(n,e,t,r,i,s){if(n<0||!bt(n))throw new RangeError("Bernoulli index must be nonnegative integer");if(n===0)return e(1);if(n===1)return s(e(-1),e(2));if(n%2===1)return e(0);var a=e(1);t.length===1&&t.push([s(a,e(-3)),s(a,e(-2)),s(a,e(6))]);for(var o=n/2,l=e(0),u=e(2);t.length<=o;){for(var c=t.length,h=Math.floor((c+1)/2),d=l,f=1;f<h;++f)d=r(d,i(t[f][0],t[c-f][0]));d=i(d,u),c%2===0&&(d=r(d,i(t[h][0],t[h][0]))),d=s(d,e(-(2*c+1)));var p=s(i(t[c-1][1],e(-c*(2*c-1))),u);t.push([d,p,i(p,d)])}return t[o][2]}var KG="combinations",s6e=["typed"],a6e=re(KG,s6e,n=>{var{typed:e}=n;return e(KG,{"number, number":lne,"BigNumber, BigNumber":function(r,i){var s=r.constructor,a,o,l=r.minus(i),u=new s(1);if(!YG(r)||!YG(i))throw new TypeError("Positive integer value expected in function combinations");if(i.gt(r))throw new TypeError("k must be less than n in function combinations");if(a=u,i.lt(l))for(o=u;o.lte(l);o=o.plus(u))a=a.times(i.plus(o)).dividedBy(o);else for(o=u;o.lte(i);o=o.plus(u))a=a.times(l.plus(o)).dividedBy(o);return a}})});function YG(n){return n.isInteger()&&n.gte(0)}var QG="combinationsWithRep",o6e=["typed"],l6e=re(QG,o6e,n=>{var{typed:e}=n;return e(QG,{"number, number":function(r,i){if(!bt(r)||r<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(!bt(i)||i<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(r<1)throw new TypeError("k must be less than or equal to n + k - 1");if(i<r-1){var s=Gh(r,r+i-1);return s/Gh(1,i)}var a=Gh(i+1,r+i-1);return a/Gh(1,r-1)},"BigNumber, BigNumber":function(r,i){var s=r.constructor,a,o,l=new s(1),u=r.minus(l);if(!ZG(r)||!ZG(i))throw new TypeError("Positive integer value expected in function combinationsWithRep");if(r.lt(l))throw new TypeError("k must be less than or equal to n + k - 1 in function combinationsWithRep");if(a=l,i.lt(u))for(o=l;o.lte(u);o=o.plus(l))a=a.times(i.plus(o)).dividedBy(o);else for(o=l;o.lte(i);o=o.plus(l))a=a.times(u.plus(o)).dividedBy(o);return a}})});function ZG(n){return n.isInteger()&&n.gte(0)}var JG="gamma",u6e=["typed","config","multiplyScalar","pow","BigNumber","Complex"],c6e=re(JG,u6e,n=>{var{typed:e,config:t,multiplyScalar:r,pow:i,BigNumber:s,Complex:a}=n;function o(u){if(u.im===0)return jD(u.re);if(u.re<.5){var c=new a(1-u.re,-u.im),h=new a(Math.PI*u.re,Math.PI*u.im);return new a(Math.PI).div(h.sin()).div(o(c))}u=new a(u.re-1,u.im);for(var d=new a(Cy[0],0),f=1;f<Cy.length;++f){var p=new a(Cy[f],0);d=d.add(p.div(u.add(f)))}var m=new a(u.re+cne+.5,u.im),y=Math.sqrt(2*Math.PI),v=m.pow(u.add(.5)),b=m.neg().exp();return d.mul(y).mul(v).mul(b)}return e(JG,{number:jD,Complex:o,BigNumber:function(c){if(c.isInteger())return c.isNegative()||c.isZero()?new s(1/0):l(c.minus(1));if(!c.isFinite())return new s(c.isNegative()?NaN:1/0);throw new Error("Integer BigNumber expected")}});function l(u){if(u<8)return new s([1,1,2,6,24,120,720,5040][u]);var c=t.precision+(Math.log(u.toNumber())|0),h=s.clone({precision:c});if(u%2===1)return u.times(l(new s(u-1)));for(var d=u,f=new h(u),p=u.toNumber();d>2;)d-=2,p+=d,f=f.times(p);return new s(f.toPrecision(s.precision))}}),ej="lgamma",h6e=["Complex","typed"],d6e=re(ej,h6e,n=>{var{Complex:e,typed:t}=n,r=7,i=7,s=[-.029550653594771242,.00641025641025641,-.0019175269175269176,.0008417508417508417,-.0005952380952380953,.0007936507936507937,-.002777777777777778,.08333333333333333];return t(ej,{number:qD,Complex:a,BigNumber:function(){throw new Error("mathjs doesn't yet provide an implementation of the algorithm lgamma for BigNumber")}});function a(u){var c=6.283185307179586,h=1.1447298858494002,d=.1;if(u.isNaN())return new e(NaN,NaN);if(u.im===0)return new e(qD(u.re),0);if(u.re>=r||Math.abs(u.im)>=i)return o(u);if(u.re<=d){var f=kMe(c,u.im)*Math.floor(.5*u.re+.25),p=u.mul(Math.PI).sin().log(),m=a(new e(1-u.re,-u.im));return new e(h,f).sub(p).sub(m)}else return u.im>=0?l(u):l(u.conjugate()).conjugate()}function o(u){for(var c=u.sub(.5).mul(u.log()).sub(u).add(hne),h=new e(1,0).div(u),d=h.div(u),f=s[0],p=s[1],m=2*d.re,y=d.re*d.re+d.im*d.im,v=2;v<8;v++){var b=p;p=-y*f+s[v],f=m*f+b}var x=h.mul(d.mul(f).add(p));return c.add(x)}function l(u){var c=0,h=0,d=u;for(u=u.add(1);u.re<=r;){d=d.mul(u);var f=d.im<0?1:0;f!==0&&h===0&&c++,h=f,u=u.add(1)}return o(u).sub(d.log()).sub(new e(0,c*2*Math.PI*1))}}),tj="factorial",f6e=["typed","gamma"],p6e=re(tj,f6e,n=>{var{typed:e,gamma:t}=n;return e(tj,{number:function(i){if(i<0)throw new Error("Value must be non-negative");return t(i+1)},BigNumber:function(i){if(i.isNegative())throw new Error("Value must be non-negative");return t(i.plus(1))},"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))})}),nj="kldivergence",m6e=["typed","matrix","divide","sum","multiply","map","dotDivide","log","isNumeric"],g6e=re(nj,m6e,n=>{var{typed:e,matrix:t,divide:r,sum:i,multiply:s,map:a,dotDivide:o,log:l,isNumeric:u}=n;return e(nj,{"Array, Array":function(d,f){return c(t(d),t(f))},"Matrix, Array":function(d,f){return c(d,t(f))},"Array, Matrix":function(d,f){return c(t(d),f)},"Matrix, Matrix":function(d,f){return c(d,f)}});function c(h,d){var f=d.size().length,p=h.size().length;if(f>1)throw new Error("first object must be one dimensional");if(p>1)throw new Error("second object must be one dimensional");if(f!==p)throw new Error("Length of two vectors must be equal");var m=i(h);if(m===0)throw new Error("Sum of elements in first object must be non zero");var y=i(d);if(y===0)throw new Error("Sum of elements in second object must be non zero");var v=r(h,i(h)),b=r(d,i(d)),x=i(s(v,a(o(v,b),w=>l(w))));return u(x)?x:Number.NaN}}),rj="multinomial",v6e=["typed","add","divide","multiply","factorial","isInteger","isPositive"],y6e=re(rj,v6e,n=>{var{typed:e,add:t,divide:r,multiply:i,factorial:s,isInteger:a,isPositive:o}=n;return e(rj,{"Array | Matrix":function(u){var c=0,h=1;return Op(u,function(d){if(!a(d)||!o(d))throw new TypeError("Positive integer value expected in function multinomial");c=t(c,d),h=i(h,s(d))}),r(s(c),h)}})}),ij="permutations",x6e=["typed","factorial"],b6e=re(ij,x6e,n=>{var{typed:e,factorial:t}=n;return e(ij,{"number | BigNumber":t,"number, number":function(i,s){if(!bt(i)||i<0)throw new TypeError("Positive integer value expected in function permutations");if(!bt(s)||s<0)throw new TypeError("Positive integer value expected in function permutations");if(s>i)throw new TypeError("second argument k must be less than or equal to first argument n");return Gh(i-s+1,i)},"BigNumber, BigNumber":function(i,s){var a,o;if(!sj(i)||!sj(s))throw new TypeError("Positive integer value expected in function permutations");if(s.gt(i))throw new TypeError("second argument k must be less than or equal to first argument n");var l=i.mul(0).add(1);for(a=l,o=i.minus(s).plus(1);o.lte(i);o=o.plus(1))a=a.times(o);return a}})});function sj(n){return n.isInteger()&&n.gte(0)}var lU={exports:{}};lU.exports;(function(n){(function(e,t,r){function i(l){var u=this,c=o();u.next=function(){var h=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=h|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function s(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function a(l,u){var c=new i(l),h=u&&u.state,d=c.next;return d.int32=function(){return c.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,h&&(typeof h=="object"&&s(h,c),d.state=function(){return s(c,{})}),d}function o(){var l=4022871197,u=function(c){c=String(c);for(var h=0;h<c.length;h++){l+=c.charCodeAt(h);var d=.02519603282416938*l;l=d>>>0,d-=l,d*=l,l=d>>>0,d-=l,l+=d*4294967296}return(l>>>0)*23283064365386963e-26};return u}t&&t.exports?t.exports=a:this.alea=a})(Nv,n)})(lU);var _6e=lU.exports,uU={exports:{}};uU.exports;(function(n){(function(e,t,r){function i(o){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},o===(o|0)?l.x=o:u+=o;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function s(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function a(o,l){var u=new i(o),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&s(c,u),h.state=function(){return s(u,{})}),h}t&&t.exports?t.exports=a:this.xor128=a})(Nv,n)})(uU);var w6e=uU.exports,cU={exports:{}};cU.exports;(function(n){(function(e,t,r){function i(o){var l=this,u="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:u+=o;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function s(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function a(o,l){var u=new i(o),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&s(c,u),h.state=function(){return s(u,{})}),h}t&&t.exports?t.exports=a:this.xorwow=a})(Nv,n)})(cU);var E6e=cU.exports,hU={exports:{}};hU.exports;(function(n){(function(e,t,r){function i(o){var l=this;l.next=function(){var c=l.x,h=l.i,d,f;return d=c[h],d^=d>>>7,f=d^d<<24,d=c[h+1&7],f^=d^d>>>10,d=c[h+3&7],f^=d^d>>>3,d=c[h+4&7],f^=d^d<<7,d=c[h+7&7],d=d^d<<13,f^=d^d<<9,c[h]=f,l.i=h+1&7,f};function u(c,h){var d,f=[];if(h===(h|0))f[0]=h;else for(h=""+h,d=0;d<h.length;++d)f[d&7]=f[d&7]<<15^h.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],c.x=f,c.i=0,d=256;d>0;--d)c.next()}u(l,o)}function s(o,l){return l.x=o.x.slice(),l.i=o.i,l}function a(o,l){o==null&&(o=+new Date);var u=new i(o),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(c.x&&s(c,u),h.state=function(){return s(u,{})}),h}t&&t.exports?t.exports=a:this.xorshift7=a})(Nv,n)})(hU);var S6e=hU.exports,dU={exports:{}};dU.exports;(function(n){(function(e,t,r){function i(o){var l=this;l.next=function(){var c=l.w,h=l.X,d=l.i,f,p;return l.w=c=c+1640531527|0,p=h[d+34&127],f=h[d=d+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=h[d]=p^f,l.i=d,p+(c^c>>>16)|0};function u(c,h){var d,f,p,m,y,v=[],b=128;for(h===(h|0)?(f=h,h=null):(h=h+"\0",f=0,b=Math.max(b,h.length)),p=0,m=-32;m<b;++m)h&&(f^=h.charCodeAt((m+32)%h.length)),m===0&&(y=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(y=y+1640531527|0,d=v[m&127]^=f+y,p=d==0?p+1:0);for(p>=128&&(v[(h&&h.length||0)&127]=-1),p=127,m=4*128;m>0;--m)f=v[p+34&127],d=v[p=p+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,v[p]=f^d;c.w=y,c.X=v,c.i=p}u(l,o)}function s(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function a(o,l){o==null&&(o=+new Date);var u=new i(o),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(c.X&&s(c,u),h.state=function(){return s(u,{})}),h}t&&t.exports?t.exports=a:this.xor4096=a})(Nv,n)})(dU);var A6e=dU.exports,fU={exports:{}};fU.exports;(function(n){(function(e,t,r){function i(o){var l=this,u="";l.next=function(){var h=l.b,d=l.c,f=l.d,p=l.a;return h=h<<25^h>>>7^d,d=d-f|0,f=f<<24^f>>>8^p,p=p-h|0,l.b=h=h<<20^h>>>12^d,l.c=d=d-f|0,l.d=f<<16^d>>>16^p,l.a=p-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):u+=o;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function s(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function a(o,l){var u=new i(o),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&s(c,u),h.state=function(){return s(u,{})}),h}t&&t.exports?t.exports=a:this.tychei=a})(Nv,n)})(fU);var T6e=fU.exports,hre={exports:{}};const M6e={},C6e=Object.freeze(Object.defineProperty({__proto__:null,default:M6e},Symbol.toStringTag,{value:"Module"})),D6e=xie(C6e);(function(n){(function(e,t,r){var i=256,s=6,a=52,o="random",l=r.pow(i,s),u=r.pow(2,a),c=u*2,h=i-1,d;function f(w,_,E){var A=[];_=_==!0?{entropy:!0}:_||{};var T=v(y(_.entropy?[w,x(t)]:w??b(),3),A),S=new p(A),M=function(){for(var D=S.g(s),N=l,R=0;D<u;)D=(D+R)*i,N*=i,R=S.g(1);for(;D>=c;)D/=2,N/=2,R>>>=1;return(D+R)/N};return M.int32=function(){return S.g(4)|0},M.quick=function(){return S.g(4)/4294967296},M.double=M,v(x(S.S),t),(_.pass||E||function(D,N,R,O){return O&&(O.S&&m(O,S),D.state=function(){return m(S,{})}),R?(r[o]=D,N):D})(M,T,"global"in _?_.global:this==r,_.state)}function p(w){var _,E=w.length,A=this,T=0,S=A.i=A.j=0,M=A.S=[];for(E||(w=[E++]);T<i;)M[T]=T++;for(T=0;T<i;T++)M[T]=M[S=h&S+w[T%E]+(_=M[T])],M[S]=_;(A.g=function(D){for(var N,R=0,O=A.i,G=A.j,I=A.S;D--;)N=I[O=h&O+1],R=R*i+I[h&(I[O]=I[G=h&G+N])+(I[G]=N)];return A.i=O,A.j=G,R})(i)}function m(w,_){return _.i=w.i,_.j=w.j,_.S=w.S.slice(),_}function y(w,_){var E=[],A=typeof w,T;if(_&&A=="object")for(T in w)try{E.push(y(w[T],_-1))}catch{}return E.length?E:A=="string"?w:w+"\0"}function v(w,_){for(var E=w+"",A,T=0;T<E.length;)_[h&T]=h&(A^=_[h&T]*19)+E.charCodeAt(T++);return x(_)}function b(){try{var w;return d&&(w=d.randomBytes)?w=w(i):(w=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(w)),x(w)}catch{var _=e.navigator,E=_&&_.plugins;return[+new Date,e,E,e.screen,x(t)]}}function x(w){return String.fromCharCode.apply(0,w)}if(v(r.random(),t),n.exports){n.exports=f;try{d=D6e}catch{}}else r["seed"+o]=f})(typeof self<"u"?self:Nv,[],Math)})(hre);var N6e=hre.exports,R6e=_6e,I6e=w6e,P6e=E6e,F6e=S6e,L6e=A6e,O6e=T6e,Hv=N6e;Hv.alea=R6e;Hv.xor128=I6e;Hv.xorwow=P6e;Hv.xorshift7=F6e;Hv.xor4096=L6e;Hv.tychei=O6e;var k6e=Hv;const dre=S2(k6e);var B6e=dre(Date.now());function Ab(n){var e;function t(i){e=i===null?B6e:dre(String(i))}t(n);function r(){return e()}return r}var aj="pickRandom",U6e=["typed","config","?on"],V6e=re(aj,U6e,n=>{var{typed:e,config:t,on:r}=n,i=Ab(t.randomSeed);return r&&r("config",function(a,o){a.randomSeed!==o.randomSeed&&(i=Ab(a.randomSeed))}),e(aj,{"Array | Matrix":function(o){return s(o,{})},"Array | Matrix, Object":function(o,l){return s(o,l)},"Array | Matrix, number":function(o,l){return s(o,{number:l})},"Array | Matrix, Array | Matrix":function(o,l){return s(o,{weights:l})},"Array | Matrix, Array | Matrix, number":function(o,l,u){return s(o,{number:u,weights:l})},"Array | Matrix, number, Array | Matrix":function(o,l,u){return s(o,{number:l,weights:u})}});function s(a,o){var{number:l,weights:u,elementWise:c=!0}=o,h=typeof l>"u";h&&(l=1);var d=Dt(a)?a.create:Dt(u)?u.create:null;a=a.valueOf(),u&&(u=u.valueOf()),c===!0&&(a=Tn(a),u=Tn(u));var f=0;if(typeof u<"u"){if(u.length!==a.length)throw new Error("Weights must have the same length as possibles");for(var p=0,m=u.length;p<m;p++){if(!Tt(u[p])||u[p]<0)throw new Error("Weights must be an array of positive numbers");f+=u[p]}}for(var y=a.length,v=[],b;v.length<l;){if(typeof u>"u")b=a[Math.floor(i()*y)];else for(var x=i()*f,w=0,_=a.length;w<_;w++)if(x-=u[w],x<0){b=a[w];break}v.push(b)}return h?v[0]:d?d(v):v}});function pU(n,e){var t=[];if(n=n.slice(0),n.length>1)for(var r=0,i=n.shift();r<i;r++)t.push(pU(n,e));else for(var s=0,a=n.shift();s<a;s++)t.push(e());return t}var oj="random",z6e=["typed","config","?on"],$6e=re(oj,z6e,n=>{var{typed:e,config:t,on:r}=n,i=Ab(t.randomSeed);return r&&r("config",function(o,l){o.randomSeed!==l.randomSeed&&(i=Ab(o.randomSeed))}),e(oj,{"":()=>a(0,1),number:o=>a(0,o),"number, number":(o,l)=>a(o,l),"Array | Matrix":o=>s(o,0,1),"Array | Matrix, number":(o,l)=>s(o,0,l),"Array | Matrix, number, number":(o,l,u)=>s(o,l,u)});function s(o,l,u){var c=pU(o.valueOf(),()=>a(l,u));return Dt(o)?o.create(c,"number"):c}function a(o,l){return o+i()*(l-o)}}),lj="randomInt",H6e=["typed","config","log2","?on"],G6e=re(lj,H6e,n=>{var{typed:e,config:t,log2:r,on:i}=n,s=Ab(t.randomSeed);return i&&i("config",function(u,c){u.randomSeed!==c.randomSeed&&(s=Ab(u.randomSeed))}),e(lj,{"":()=>o(0,2),number:u=>o(0,u),"number, number":(u,c)=>o(u,c),bigint:u=>l(0n,u),"bigint, bigint":l,"Array | Matrix":u=>a(u,0,1),"Array | Matrix, number":(u,c)=>a(u,0,c),"Array | Matrix, number, number":(u,c,h)=>a(u,c,h)});function a(u,c,h){var d=pU(u.valueOf(),()=>o(c,h));return Dt(u)?u.create(d,"number"):d}function o(u,c){return Math.floor(u+s()*(c-u))}function l(u,c){var h=2n**30n,d=c-u;if(d<=h)return u+BigInt(o(0,Number(d)));for(var f=r(d),p=d;p>=d;){p=0n;for(var m=0;m<f;++m)p=2n*p+(s()<.5?0n:1n)}return u+p}}),uj="stirlingS2",j6e=["typed","addScalar","subtractScalar","multiplyScalar","divideScalar","pow","factorial","combinations","isNegative","isInteger","number","?bignumber","larger"],q6e=re(uj,j6e,n=>{var{typed:e,addScalar:t,subtractScalar:r,multiplyScalar:i,divideScalar:s,pow:a,factorial:o,combinations:l,isNegative:u,isInteger:c,number:h,bignumber:d,larger:f}=n,p=[],m=[];return e(uj,{"number | BigNumber, number | BigNumber":function(v,b){if(!c(v)||u(v)||!c(b)||u(b))throw new TypeError("Non-negative integer value expected in function stirlingS2");if(f(b,v))throw new TypeError("k must be less than or equal to n in function stirlingS2");var x=!(Tt(v)&&Tt(b)),w=x?m:p,_=x?d:h,E=h(v),A=h(b);if(w[E]&&w[E].length>A)return w[E][A];for(var T=0;T<=E;++T)if(w[T]||(w[T]=[_(T===0?1:0)]),T!==0)for(var S=w[T],M=w[T-1],D=S.length;D<=T&&D<=A;++D)D===T?S[D]=1:S[D]=t(i(_(D),M[D]),M[D-1]);return w[E][A]}})}),cj="bellNumbers",W6e=["typed","addScalar","isNegative","isInteger","stirlingS2"],X6e=re(cj,W6e,n=>{var{typed:e,addScalar:t,isNegative:r,isInteger:i,stirlingS2:s}=n;return e(cj,{"number | BigNumber":function(o){if(!i(o)||r(o))throw new TypeError("Non-negative integer value expected in function bellNumbers");for(var l=0,u=0;u<=o;u++)l=t(l,s(o,u));return l}})}),hj="catalan",K6e=["typed","addScalar","divideScalar","multiplyScalar","combinations","isNegative","isInteger"],Y6e=re(hj,K6e,n=>{var{typed:e,addScalar:t,divideScalar:r,multiplyScalar:i,combinations:s,isNegative:a,isInteger:o}=n;return e(hj,{"number | BigNumber":function(u){if(!o(u)||a(u))throw new TypeError("Non-negative integer value expected in function catalan");return r(s(i(u,2),u),t(u,1))}})}),dj="composition",Q6e=["typed","addScalar","combinations","isNegative","isPositive","isInteger","larger"],Z6e=re(dj,Q6e,n=>{var{typed:e,addScalar:t,combinations:r,isPositive:i,isNegative:s,isInteger:a,larger:o}=n;return e(dj,{"number | BigNumber, number | BigNumber":function(u,c){if(!a(u)||!i(u)||!a(c)||!i(c))throw new TypeError("Positive integer value expected in function composition");if(o(c,u))throw new TypeError("k must be less than or equal to n in function composition");return r(t(u,-1),t(c,-1))}})}),fj="leafCount",J6e=["parse","typed"],eze=re(fj,J6e,n=>{var{parse:e,typed:t}=n;function r(i){var s=0;return i.forEach(a=>{s+=r(a)}),s||1}return t(fj,{Node:function(s){return r(s)}})});function pj(n){return pn(n)||ai(n)&&n.isUnary()&&pn(n.args[0])}function n2(n){return!!(pn(n)||(Pp(n)||ai(n))&&n.args.every(n2)||vd(n)&&n2(n.content))}function mj(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function iP(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?mj(Object(t),!0).forEach(function(r){wi(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):mj(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var tze="simplifyUtil",nze=["FunctionNode","OperatorNode","SymbolNode"],mU=re(tze,nze,n=>{var{FunctionNode:e,OperatorNode:t,SymbolNode:r}=n,i=!0,s=!1,a="defaultF",o={add:{trivial:i,total:i,commutative:i,associative:i},unaryPlus:{trivial:i,total:i,commutative:i,associative:i},subtract:{trivial:s,total:i,commutative:s,associative:s},multiply:{trivial:i,total:i,commutative:i,associative:i},divide:{trivial:s,total:i,commutative:s,associative:s},paren:{trivial:i,total:i,commutative:i,associative:s},defaultF:{trivial:s,total:i,commutative:s,associative:s}},l={divide:{total:s},log:{total:s}},u={subtract:{total:s},abs:{trivial:i},log:{total:i}};function c(x,w){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:o,E=a;if(typeof x=="string"?E=x:ai(x)?E=x.fn.toString():Pp(x)?E=x.name:vd(x)&&(E="paren"),vt(_,E)){var A=_[E];if(vt(A,w))return A[w];if(vt(o,E))return o[E][w]}if(vt(_,a)){var T=_[a];return vt(T,w)?T[w]:o[a][w]}if(vt(o,E)){var S=o[E];if(vt(S,w))return S[w]}return o[a][w]}function h(x){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;return c(x,"commutative",w)}function d(x){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;return c(x,"associative",w)}function f(x,w){var _=iP({},x);for(var E in w)vt(x,E)?_[E]=iP(iP({},w[E]),x[E]):_[E]=w[E];return _}function p(x,w){if(!x.args||x.args.length===0)return x;x.args=m(x,w);for(var _=0;_<x.args.length;_++)p(x.args[_],w)}function m(x,w){var _,E=[],A=function(S){for(var M=0;M<S.args.length;M++){var D=S.args[M];ai(D)&&_===D.op?A(D):E.push(D)}};return d(x,w)?(_=x.op,A(x),E):x.args}function y(x,w){if(!(!x.args||x.args.length===0)){for(var _=b(x),E=x.args.length,A=0;A<E;A++)y(x.args[A],w);if(E>2&&d(x,w)){for(var T=x.args.pop();x.args.length>0;)T=_([x.args.pop(),T]);x.args=T.args}}}function v(x,w){if(!(!x.args||x.args.length===0)){for(var _=b(x),E=x.args.length,A=0;A<E;A++)v(x.args[A],w);if(E>2&&d(x,w)){for(var T=x.args.shift();x.args.length>0;)T=_([T,x.args.shift()]);x.args=T.args}}}function b(x){return ai(x)?function(w){try{return new t(x.op,x.fn,w,x.implicit)}catch(_){return console.error(_),[]}}:function(w){return new e(new r(x.name),w)}}return{createMakeNodeFunction:b,hasProperty:c,isCommutative:h,isAssociative:d,mergeContext:f,flatten:p,allChildren:m,unflattenr:y,unflattenl:v,defaultContext:o,realContext:l,positiveContext:u}}),rze="simplify",ize=["typed","parse","equal","resolve","simplifyConstant","simplifyCore","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","SymbolNode","replacer"],sze=re(rze,ize,n=>{var{typed:e,parse:t,equal:r,resolve:i,simplifyConstant:s,simplifyCore:a,AccessorNode:o,ArrayNode:l,ConstantNode:u,FunctionNode:c,IndexNode:h,ObjectNode:d,OperatorNode:f,ParenthesisNode:p,SymbolNode:m,replacer:y}=n,{hasProperty:v,isCommutative:b,isAssociative:x,mergeContext:w,flatten:_,unflattenr:E,unflattenl:A,createMakeNodeFunction:T,defaultContext:S,realContext:M,positiveContext:D}=mU({FunctionNode:c,OperatorNode:f,SymbolNode:m});e.addConversion({from:"Object",to:"Map",convert:Ty});var N=e("simplify",{Node:H,"Node, Map":(te,Y)=>H(te,!1,Y),"Node, Map, Object":(te,Y,ie)=>H(te,!1,Y,ie),"Node, Array":H,"Node, Array, Map":H,"Node, Array, Map, Object":H});e.removeConversion({from:"Object",to:"Map",convert:Ty}),N.defaultContext=S,N.realContext=M,N.positiveContext=D;function R(te){return te.transform(function(Y){return vd(Y)?R(Y.content):Y})}var O={true:!0,false:!0,e:!0,i:!0,Infinity:!0,LN2:!0,LN10:!0,LOG2E:!0,LOG10E:!0,NaN:!0,phi:!0,pi:!0,SQRT1_2:!0,SQRT2:!0,tau:!0};N.rules=[a,{l:"log(e)",r:"1"},{s:"n-n1 -> n+-n1",assuming:{subtract:{total:!0}}},{s:"n-n -> 0",assuming:{subtract:{total:!1}}},{s:"-(cl*v) -> v * (-cl)",assuming:{multiply:{commutative:!0},subtract:{total:!0}}},{s:"-(cl*v) -> (-cl) * v",assuming:{multiply:{commutative:!1},subtract:{total:!0}}},{s:"-(v*cl) -> v * (-cl)",assuming:{multiply:{commutative:!1},subtract:{total:!0}}},{l:"-(n1/n2)",r:"-n1/n2"},{l:"-v",r:"v * (-1)"},{l:"(n1 + n2)*(-1)",r:"n1*(-1) + n2*(-1)",repeat:!0},{l:"n/n1^n2",r:"n*n1^-n2"},{l:"n/n1",r:"n*n1^-1"},{s:"(n1*n2)^n3 -> n1^n3 * n2^n3",assuming:{multiply:{commutative:!0}}},{s:"(n1*n2)^(-1) -> n2^(-1) * n1^(-1)",assuming:{multiply:{commutative:!1}}},{s:"(n ^ n1) ^ n2 -> n ^ (n1 * n2)",assuming:{divide:{total:!0}}},{l:" vd   * ( vd   * n1 + n2)",r:"vd^2       * n1 +  vd   * n2"},{s:" vd   * (vd^n4 * n1 + n2)   ->  vd^(1+n4)  * n1 +  vd   * n2",assuming:{divide:{total:!0}}},{s:"vd^n3 * ( vd   * n1 + n2)   ->  vd^(n3+1)  * n1 + vd^n3 * n2",assuming:{divide:{total:!0}}},{s:"vd^n3 * (vd^n4 * n1 + n2)   ->  vd^(n3+n4) * n1 + vd^n3 * n2",assuming:{divide:{total:!0}}},{l:"n*n",r:"n^2"},{s:"n * n^n1 -> n^(n1+1)",assuming:{divide:{total:!0}}},{s:"n^n1 * n^n2 -> n^(n1+n2)",assuming:{divide:{total:!0}}},s,{s:"n+n -> 2*n",assuming:{add:{total:!0}}},{l:"n+-n",r:"0"},{l:"vd*n + vd",r:"vd*(n+1)"},{l:"n3*n1 + n3*n2",r:"n3*(n1+n2)"},{l:"n3^(-n4)*n1 +   n3  * n2",r:"n3^(-n4)*(n1 + n3^(n4+1) *n2)"},{l:"n3^(-n4)*n1 + n3^n5 * n2",r:"n3^(-n4)*(n1 + n3^(n4+n5)*n2)"},{s:"n*vd + vd -> (n+1)*vd",assuming:{multiply:{commutative:!1}}},{s:"vd + n*vd -> (1+n)*vd",assuming:{multiply:{commutative:!1}}},{s:"n1*n3 + n2*n3 -> (n1+n2)*n3",assuming:{multiply:{commutative:!1}}},{s:"n^n1 * n -> n^(n1+1)",assuming:{divide:{total:!0},multiply:{commutative:!1}}},{s:"n1*n3^(-n4) + n2 * n3    -> (n1 + n2*n3^(n4 +  1))*n3^(-n4)",assuming:{multiply:{commutative:!1}}},{s:"n1*n3^(-n4) + n2 * n3^n5 -> (n1 + n2*n3^(n4 + n5))*n3^(-n4)",assuming:{multiply:{commutative:!1}}},{l:"n*cd + cd",r:"(n+1)*cd"},{s:"cd*n + cd -> cd*(n+1)",assuming:{multiply:{commutative:!1}}},{s:"cd + cd*n -> cd*(1+n)",assuming:{multiply:{commutative:!1}}},s,{s:"(-n)*n1 -> -(n*n1)",assuming:{subtract:{total:!0}}},{s:"n1*(-n) -> -(n1*n)",assuming:{subtract:{total:!0},multiply:{commutative:!1}}},{s:"ce+ve -> ve+ce",assuming:{add:{commutative:!0}},imposeContext:{add:{commutative:!1}}},{s:"vd*cd -> cd*vd",assuming:{multiply:{commutative:!0}},imposeContext:{multiply:{commutative:!1}}},{l:"n+-n1",r:"n-n1"},{l:"n+-(n1)",r:"n-(n1)"},{s:"n*(n1^-1) -> n/n1",assuming:{multiply:{commutative:!0}}},{s:"n*n1^-n2 -> n/n1^n2",assuming:{multiply:{commutative:!0}}},{s:"n^-1 -> 1/n",assuming:{multiply:{commutative:!0}}},{l:"n^1",r:"n"},{s:"n*(n1/n2) -> (n*n1)/n2",assuming:{multiply:{associative:!0}}},{s:"n-(n1+n2) -> n-n1-n2",assuming:{addition:{associative:!0,commutative:!0}}},{l:"1*n",r:"n",imposeContext:{multiply:{commutative:!0}}},{s:"n1/(n2/n3) -> (n1*n3)/n2",assuming:{multiply:{associative:!0}}},{l:"n1/(-n2)",r:"-n1/n2"}];function G(te,Y){var ie={};if(te.s){var ve=te.s.split("->");if(ve.length===2)ie.l=ve[0],ie.r=ve[1];else throw SyntaxError("Could not parse rule: "+te.s)}else ie.l=te.l,ie.r=te.r;ie.l=R(t(ie.l)),ie.r=R(t(ie.r));for(var ge of["imposeContext","repeat","assuming"])ge in te&&(ie[ge]=te[ge]);if(te.evaluate&&(ie.evaluate=t(te.evaluate)),x(ie.l,Y)){var _e=!b(ie.l,Y),we;_e&&(we=$());var Be=T(ie.l),$e=$();ie.expanded={},ie.expanded.l=Be([ie.l,$e]),_(ie.expanded.l,Y),E(ie.expanded.l,Y),ie.expanded.r=Be([ie.r,$e]),_e&&(ie.expandedNC1={},ie.expandedNC1.l=Be([we,ie.l]),ie.expandedNC1.r=Be([we,ie.r]),ie.expandedNC2={},ie.expandedNC2.l=Be([we,ie.expanded.l]),ie.expandedNC2.r=Be([we,ie.expanded.r]))}return ie}function I(te,Y){for(var ie=[],ve=0;ve<te.length;ve++){var ge=te[ve],_e=void 0,we=typeof ge;switch(we){case"string":ge={s:ge};case"object":_e=G(ge,Y);break;case"function":_e=ge;break;default:throw TypeError("Unsupported type of rule: "+we)}ie.push(_e)}return ie}var B=0;function $(){return new m("_p"+B++)}function H(te,Y){var ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Nw(),ve=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},ge=ve.consoleDebug;Y=I(Y||N.rules,ve.context);var _e=i(te,ie);_e=R(_e);for(var we={},Be=_e.toString({parenthesis:"all"});!we[Be];){we[Be]=!0,B=0;var $e=Be;ge&&console.log("Working on: ",Be);for(var nt=0;nt<Y.length;nt++){var de="";if(typeof Y[nt]=="function"?(_e=Y[nt](_e,ve),ge&&(de=Y[nt].name)):(_(_e,ve.context),_e=ee(_e,Y[nt],ve.context),ge&&(de="".concat(Y[nt].l.toString()," -> ").concat(Y[nt].r.toString()))),ge){var Ye=_e.toString({parenthesis:"all"});Ye!==$e&&(console.log("Applying",de,"produced",Ye),$e=Ye)}A(_e,ve.context)}Be=_e.toString({parenthesis:"all"})}return _e}function Q(te,Y,ie){var ve=te;if(te)for(var ge=0;ge<te.length;++ge){var _e=ee(te[ge],Y,ie);_e!==te[ge]&&(ve===te&&(ve=te.slice()),ve[ge]=_e)}return ve}function ee(te,Y,ie){if(Y.assuming){for(var ve in Y.assuming)for(var ge in Y.assuming[ve])if(v(ve,ge,ie)!==Y.assuming[ve][ge])return te}var _e=w(Y.imposeContext,ie),we=te;if(we instanceof f||we instanceof c){var Be=Q(we.args,Y,ie);Be!==we.args&&(we=we.clone(),we.args=Be)}else if(we instanceof p){if(we.content){var $e=ee(we.content,Y,ie);$e!==we.content&&(we=new p($e))}}else if(we instanceof l){var nt=Q(we.items,Y,ie);nt!==we.items&&(we=new l(nt))}else if(we instanceof o){var de=we.object;we.object&&(de=ee(we.object,Y,ie));var Ye=we.index;we.index&&(Ye=ee(we.index,Y,ie)),(de!==we.object||Ye!==we.index)&&(we=new o(de,Ye))}else if(we instanceof h){var Xe=Q(we.dimensions,Y,ie);Xe!==we.dimensions&&(we=new h(Xe))}else if(we instanceof d){var ae=!1,fe={};for(var F in we.properties)fe[F]=ee(we.properties[F],Y,ie),fe[F]!==we.properties[F]&&(ae=!0);ae&&(we=new d(fe))}var P=Y.r,K=le(Y.l,we,_e)[0];if(!K&&Y.expanded&&(P=Y.expanded.r,K=le(Y.expanded.l,we,_e)[0]),!K&&Y.expandedNC1&&(P=Y.expandedNC1.r,K=le(Y.expandedNC1.l,we,_e)[0],K||(P=Y.expandedNC2.r,K=le(Y.expandedNC2.l,we,_e)[0])),K){var oe=we.implicit;we=P.clone(),oe&&"implicit"in P&&(we.implicit=!0),we=we.transform(function(pe){return pe.isSymbolNode&&vt(K.placeholders,pe.name)?K.placeholders[pe.name].clone():pe})}return Y.repeat&&we!==te&&(we=ee(we,Y,ie)),we}function J(te,Y){var ie=[],ve,ge,_e=T(te);if(b(te,Y))for(var we=0;we<te.args.length;we++)ge=te.args.slice(0),ge.splice(we,1),ve=ge.length===1?ge[0]:_e(ge),ie.push(_e([te.args[we],ve]));else for(var Be=1;Be<te.args.length;Be++){var $e=te.args[0];Be>1&&($e=_e(te.args.slice(0,Be))),ge=te.args.slice(Be),ve=ge.length===1?ge[0]:_e(ge),ie.push(_e([$e,ve]))}return ie}function L(te,Y){var ie={placeholders:{}};if(!te.placeholders&&!Y.placeholders)return ie;if(te.placeholders){if(!Y.placeholders)return te}else return Y;for(var ve in te.placeholders)if(vt(te.placeholders,ve)&&(ie.placeholders[ve]=te.placeholders[ve],vt(Y.placeholders,ve)&&!ue(te.placeholders[ve],Y.placeholders[ve])))return null;for(var ge in Y.placeholders)vt(Y.placeholders,ge)&&(ie.placeholders[ge]=Y.placeholders[ge]);return ie}function se(te,Y){var ie=[];if(te.length===0||Y.length===0)return ie;for(var ve,ge=0;ge<te.length;ge++)for(var _e=0;_e<Y.length;_e++)ve=L(te[ge],Y[_e]),ve&&ie.push(ve);return ie}function Z(te){if(te.length===0)return te;for(var Y=te.reduce(se),ie=[],ve={},ge=0;ge<Y.length;ge++){var _e=JSON.stringify(Y[ge],y);ve[_e]||(ve[_e]=!0,ie.push(Y[ge]))}return ie}function le(te,Y,ie,ve){var ge=[{placeholders:{}}];if(te instanceof f&&Y instanceof f||te instanceof c&&Y instanceof c){if(te instanceof f){if(te.op!==Y.op||te.fn!==Y.fn)return[]}else if(te instanceof c&&te.name!==Y.name)return[];if(Y.args.length===1&&te.args.length===1||!x(Y,ie)&&Y.args.length===te.args.length||ve){for(var _e=[],we=0;we<te.args.length;we++){var Be=le(te.args[we],Y.args[we],ie);if(Be.length===0)break;_e.push(Be)}if(_e.length!==te.args.length){if(!b(Y,ie)||te.args.length===1)return[];if(te.args.length>2)throw new Error("permuting >2 commutative non-associative rule arguments not yet implemented");var $e=le(te.args[0],Y.args[1],ie);if($e.length===0)return[];var nt=le(te.args[1],Y.args[0],ie);if(nt.length===0)return[];_e=[$e,nt]}ge=Z(_e)}else if(Y.args.length>=2&&te.args.length===2){for(var de=J(Y,ie),Ye=[],Xe=0;Xe<de.length;Xe++){var ae=le(te,de[Xe],ie,!0);Ye=Ye.concat(ae)}return Ye}else{if(te.args.length>2)throw Error("Unexpected non-binary associative function: "+te.toString());return[]}}else if(te instanceof m){if(te.name.length===0)throw new Error("Symbol in rule has 0 length...!?");if(O[te.name]){if(te.name!==Y.name)return[]}else switch(te.name[1]>="a"&&te.name[1]<="z"?te.name.substring(0,2):te.name[0]){case"n":case"_p":ge[0].placeholders[te.name]=Y;break;case"c":case"cl":if(pn(Y))ge[0].placeholders[te.name]=Y;else return[];break;case"v":if(!pn(Y))ge[0].placeholders[te.name]=Y;else return[];break;case"vl":if(ss(Y))ge[0].placeholders[te.name]=Y;else return[];break;case"cd":if(pj(Y))ge[0].placeholders[te.name]=Y;else return[];break;case"vd":if(!pj(Y))ge[0].placeholders[te.name]=Y;else return[];break;case"ce":if(n2(Y))ge[0].placeholders[te.name]=Y;else return[];break;case"ve":if(!n2(Y))ge[0].placeholders[te.name]=Y;else return[];break;default:throw new Error("Invalid symbol in rule: "+te.name)}}else if(te instanceof u){if(!r(te.value,Y.value))return[]}else return[];return ge}function ue(te,Y){if(te instanceof u&&Y instanceof u){if(!r(te.value,Y.value))return!1}else if(te instanceof m&&Y instanceof m){if(te.name!==Y.name)return!1}else if(te instanceof f&&Y instanceof f||te instanceof c&&Y instanceof c){if(te instanceof f){if(te.op!==Y.op||te.fn!==Y.fn)return!1}else if(te instanceof c&&te.name!==Y.name)return!1;if(te.args.length!==Y.args.length)return!1;for(var ie=0;ie<te.args.length;ie++)if(!ue(te.args[ie],Y.args[ie]))return!1}else return!1;return!0}return N}),aze="simplifyConstant",oze=["typed","config","mathWithTransform","matrix","isBounded","?fraction","?bignumber","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","SymbolNode"],lze=re(aze,oze,n=>{var{typed:e,config:t,mathWithTransform:r,matrix:i,isBounded:s,fraction:a,bignumber:o,AccessorNode:l,ArrayNode:u,ConstantNode:c,FunctionNode:h,IndexNode:d,ObjectNode:f,OperatorNode:p,SymbolNode:m}=n,{isCommutative:y,isAssociative:v,allChildren:b,createMakeNodeFunction:x}=mU({FunctionNode:h,OperatorNode:p,SymbolNode:m}),w=e("simplifyConstant",{Node:I=>T(G(I,{})),"Node, Object":function(B,$){return T(G(B,$))}});function _(I){return sA(I)?I.valueOf():I instanceof Array?I.map(_):Dt(I)?i(_(I.valueOf())):I}function E(I,B,$){try{return r[I].apply(null,B)}catch{return B=B.map(_),M(r[I].apply(null,B),$)}}var A=e({Fraction:N,number:function(B){return B<0?D(new c(-B)):new c(B)},BigNumber:function(B){return B<0?D(new c(-B)):new c(B)},bigint:function(B){return B<0n?D(new c(-B)):new c(B)},Complex:function(B){throw new Error("Cannot convert Complex number to Node")},string:function(B){return new c(B)},Matrix:function(B){return new u(B.valueOf().map($=>A($)))}});function T(I){return zn(I)?I:A(I)}function S(I,B){var $=B&&B.exactFractions!==!1;if($&&s(I)&&a){var H=a(I),Q=B&&typeof B.fractionsLimit=="number"?B.fractionsLimit:1/0;if(H.valueOf()===I&&H.n<Q&&H.d<Q)return H}return I}var M=e({"string, Object":function(B,$){var H=Wp(B,t);if(H==="BigNumber")return o===void 0&&iU(),o(B);if(H==="bigint")return BigInt(B);if(H==="Fraction")return a===void 0&&jne(),a(B);var Q=parseFloat(B);return S(Q,$)},"Fraction, Object":function(B,$){return B},"BigNumber, Object":function(B,$){return B},"number, Object":function(B,$){return S(B,$)},"bigint, Object":function(B,$){return B},"Complex, Object":function(B,$){return B.im!==0?B:S(B.re,$)},"Matrix, Object":function(B,$){return i(S(B.valueOf()))},"Array, Object":function(B,$){return B.map(S)}});function D(I){return new p("-","unaryMinus",[I])}function N(I){var B=Q=>t.number==="BigNumber"&&o?o(Q):Number(Q),$=I.s*I.n,H=$<0n?new p("-","unaryMinus",[new c(-B($))]):new c(B($));return I.d===1n?H:new p("/","divide",[H,new c(B(I.d))])}function R(I,B,$){if(!qb(B))return new l(T(I),T(B));if(fl(I)||Dt(I)){for(var H=Array.from(B.dimensions);H.length>0;)if(pn(H[0])&&typeof H[0].value!="string"){var Q=M(H.shift().value,$);fl(I)?I=I.items[Q-1]:(I=I.valueOf()[Q-1],I instanceof Array&&(I=i(I)))}else if(H.length>1&&pn(H[1])&&typeof H[1].value!="string"){var ee=M(H[1].value,$),J=[],L=fl(I)?I.items:I.valueOf();for(var se of L)if(fl(se))J.push(se.items[ee-1]);else if(Dt(I))J.push(se[ee-1]);else break;if(J.length===L.length)fl(I)?I=new u(J):I=i(J),H.splice(1,1);else break}else break;return H.length===B.dimensions.length?new l(T(I),B):H.length>0?(B=new d(H),new l(T(I),B)):I}if(IN(I)&&B.dimensions.length===1&&pn(B.dimensions[0])){var Z=B.dimensions[0].value;return Z in I.properties?I.properties[Z]:new c}return new l(T(I),B)}function O(I,B,$,H){var Q=B.shift(),ee=B.reduce((J,L)=>{if(!zn(L)){var se=J.pop();if(zn(se))return[se,L];try{return J.push(E(I,[se,L],H)),J}catch{J.push(se)}}J.push(T(J.pop()));var Z=J.length===1?J[0]:$(J);return[$([Z,T(L)])]},[Q]);return ee.length===1?ee[0]:$([ee[0],A(ee[1])])}function G(I,B){switch(I.type){case"SymbolNode":return I;case"ConstantNode":switch(typeof I.value){case"number":return M(I.value,B);case"bigint":return M(I.value,B);case"string":return I.value;default:if(!isNaN(I.value))return M(I.value,B)}return I;case"FunctionNode":if(r[I.name]&&r[I.name].rawArgs)return I;{var $=["add","multiply"];if(!$.includes(I.name)){var H=I.args.map(ge=>G(ge,B));if(!H.some(zn))try{return E(I.name,H,B)}catch{}if(I.name==="size"&&H.length===1&&fl(H[0])){for(var Q=[],ee=H[0];fl(ee);)Q.push(ee.items.length),ee=ee.items[0];return i(Q)}return new h(I.name,H.map(T))}}case"OperatorNode":{var J=I.fn.toString(),L,se,Z=x(I);if(ai(I)&&I.isUnary())L=[G(I.args[0],B)],zn(L[0])?se=Z(L):se=E(J,L,B);else if(v(I,B.context))if(L=b(I,B.context),L=L.map(ge=>G(ge,B)),y(J,B.context)){for(var le=[],ue=[],te=0;te<L.length;te++)zn(L[te])?ue.push(L[te]):le.push(L[te]);le.length>1?(se=O(J,le,Z,B),ue.unshift(se),se=O(J,ue,Z,B)):se=O(J,L,Z,B)}else se=O(J,L,Z,B);else L=I.args.map(ge=>G(ge,B)),se=O(J,L,Z,B);return se}case"ParenthesisNode":return G(I.content,B);case"AccessorNode":return R(G(I.object,B),G(I.index,B),B);case"ArrayNode":{var Y=I.items.map(ge=>G(ge,B));return Y.some(zn)?new u(Y.map(T)):i(Y)}case"IndexNode":return new d(I.dimensions.map(ge=>w(ge,B)));case"ObjectNode":{var ie={};for(var ve in I.properties)ie[ve]=w(I.properties[ve],B);return new f(ie)}case"AssignmentNode":case"BlockNode":case"FunctionAssignmentNode":case"RangeNode":case"ConditionalNode":default:throw new Error("Unimplemented node type in simplifyConstant: ".concat(I.type))}}return w}),gj="simplifyCore",uze=["typed","parse","equal","isZero","add","subtract","multiply","divide","pow","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","SymbolNode"],cze=re(gj,uze,n=>{var{typed:e,parse:t,equal:r,isZero:i,add:s,subtract:a,multiply:o,divide:l,pow:u,AccessorNode:c,ArrayNode:h,ConstantNode:d,FunctionNode:f,IndexNode:p,ObjectNode:m,OperatorNode:y,ParenthesisNode:v,SymbolNode:b}=n,x=new d(0),w=new d(1),_=new d(!0),E=new d(!1);function A(D){return ai(D)&&["and","not","or"].includes(D.op)}var{hasProperty:T,isCommutative:S}=mU({FunctionNode:f,OperatorNode:y,SymbolNode:b});function M(D){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R=N?N.context:void 0;if(T(D,"trivial",R)){if(Pp(D)&&D.args.length===1)return M(D.args[0],N);var O=!1,G=0;if(D.forEach(le=>{++G,G===1&&(O=M(le,N))}),G===1)return O}var I=D;if(Pp(I)){var B=eOe(I.name);if(B){if(I.args.length>2&&T(I,"associative",R))for(;I.args.length>2;){var $=I.args.pop(),H=I.args.pop();I.args.push(new y(B,I.name,[$,H]))}I=new y(B,I.name,I.args)}else return new f(M(I.fn),I.args.map(le=>M(le,N)))}if(ai(I)&&I.isUnary()){var Q=M(I.args[0],N);if(I.op==="~"&&ai(Q)&&Q.isUnary()&&Q.op==="~"||I.op==="not"&&ai(Q)&&Q.isUnary()&&Q.op==="not"&&A(Q.args[0]))return Q.args[0];var ee=!0;if(I.op==="-"&&ai(Q)&&(Q.isBinary()&&Q.fn==="subtract"&&(I=new y("-","subtract",[Q.args[1],Q.args[0]]),ee=!1),Q.isUnary()&&Q.op==="-"))return Q.args[0];if(ee)return new y(I.op,I.fn,[Q])}if(ai(I)&&I.isBinary()){var J=M(I.args[0],N),L=M(I.args[1],N);if(I.op==="+"){if(pn(J)&&i(J.value))return L;if(pn(L)&&i(L.value))return J;ai(L)&&L.isUnary()&&L.op==="-"&&(L=L.args[0],I=new y("-","subtract",[J,L]))}if(I.op==="-")return ai(L)&&L.isUnary()&&L.op==="-"?M(new y("+","add",[J,L.args[0]]),N):pn(J)&&i(J.value)?M(new y("-","unaryMinus",[L])):pn(L)&&i(L.value)?J:new y(I.op,I.fn,[J,L]);if(I.op==="*"){if(pn(J)){if(i(J.value))return x;if(r(J.value,1))return L}if(pn(L)){if(i(L.value))return x;if(r(L.value,1))return J;if(S(I,R))return new y(I.op,I.fn,[L,J],I.implicit)}return new y(I.op,I.fn,[J,L],I.implicit)}if(I.op==="/")return pn(J)&&i(J.value)?x:pn(L)&&r(L.value,1)?J:new y(I.op,I.fn,[J,L]);if(I.op==="^"&&pn(L)){if(i(L.value))return w;if(r(L.value,1))return J}if(I.op==="and"){if(pn(J))if(J.value){if(A(L))return L;if(pn(L))return L.value?_:E}else return E;if(pn(L))if(L.value){if(A(J))return J}else return E}if(I.op==="or"){if(pn(J)){if(J.value)return _;if(A(L))return L}if(pn(L)){if(L.value)return _;if(A(J))return J}}return new y(I.op,I.fn,[J,L])}if(ai(I))return new y(I.op,I.fn,I.args.map(le=>M(le,N)));if(fl(I))return new h(I.items.map(le=>M(le,N)));if(gd(I))return new c(M(I.object,N),M(I.index,N));if(qb(I))return new p(I.dimensions.map(le=>M(le,N)));if(IN(I)){var se={};for(var Z in I.properties)se[Z]=M(I.properties[Z],N);return new m(se)}return I}return e(gj,{Node:M,"Node,Object":M})}),hze="resolve",dze=["typed","parse","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode"],fze=re(hze,dze,n=>{var{typed:e,parse:t,ConstantNode:r,FunctionNode:i,OperatorNode:s,ParenthesisNode:a}=n;function o(l,u){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new Set;if(!u)return l;if(ss(l)){if(c.has(l.name)){var h=Array.from(c).join(", ");throw new ReferenceError("recursive loop of variable definitions among {".concat(h,"}"))}var d=u.get(l.name);if(zn(d)){var f=new Set(c);return f.add(l.name),o(d,u,f)}else return typeof d=="number"?t(String(d)):d!==void 0?new r(d):l}else if(ai(l)){var p=l.args.map(function(y){return o(y,u,c)});return new s(l.op,l.fn,p,l.implicit)}else{if(vd(l))return new a(o(l.content,u,c));if(Pp(l)){var m=l.args.map(function(y){return o(y,u,c)});return new i(l.name,m)}}return l.map(y=>o(y,u,c))}return e("resolve",{Node:o,"Node, Map | null | undefined":o,"Node, Object":(l,u)=>o(l,Ty(u)),"Array | Matrix":e.referToSelf(l=>u=>u.map(c=>l(c))),"Array | Matrix, null | undefined":e.referToSelf(l=>u=>u.map(c=>l(c))),"Array, Object":e.referTo("Array,Map",l=>(u,c)=>l(u,Ty(c))),"Matrix, Object":e.referTo("Matrix,Map",l=>(u,c)=>l(u,Ty(c))),"Array | Matrix, Map":e.referToSelf(l=>(u,c)=>u.map(h=>l(h,c)))})}),vj="symbolicEqual",pze=["parse","simplify","typed","OperatorNode"],mze=re(vj,pze,n=>{var{parse:e,simplify:t,typed:r,OperatorNode:i}=n;function s(a,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},u=new i("-","subtract",[a,o]),c=t(u,{},l);return pn(c)&&!c.value}return r(vj,{"Node, Node":s,"Node, Node, Object":s})}),yj="derivative",gze=["typed","config","parse","simplify","equal","isZero","numeric","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode","SymbolNode"],vze=re(yj,gze,n=>{var{typed:e,config:t,parse:r,simplify:i,equal:s,isZero:a,numeric:o,ConstantNode:l,FunctionNode:u,OperatorNode:c,ParenthesisNode:h,SymbolNode:d}=n;function f(w,_){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{simplify:!0},A=new Map,T=_.name;function S(D){var N=A.get(D);if(N!==void 0)return N;var R=v(S,D,T);return A.set(D,R),R}var M=b(w,S);return E.simplify?i(M):M}function p(w){var _=r(w);if(!_.isSymbolNode)throw new TypeError("Invalid variable. "+"Cannot parse ".concat(JSON.stringify(w)," into a variable in function derivative"));return _}var m=e(yj,{"Node, SymbolNode":f,"Node, SymbolNode, Object":f,"Node, string":(w,_)=>f(w,p(_)),"Node, string, Object":(w,_,E)=>f(w,p(_),E)});m._simplify=!0,m.toTex=function(w){return y.apply(null,w.args)};var y=e("_derivTex",{"Node, SymbolNode":function(_,E){return pn(_)&&Yn(_.value)==="string"?y(r(_.value).toString(),E.toString(),1):y(_.toTex(),E.toString(),1)},"Node, ConstantNode":function(_,E){if(Yn(E.value)==="string")return y(_,r(E.value));throw new Error("The second parameter to 'derivative' is a non-string constant")},"Node, SymbolNode, ConstantNode":function(_,E,A){return y(_.toString(),E.name,A.value)},"string, string, number":function(_,E,A){var T;return A===1?T="{d\\over d"+E+"}":T="{d^{"+A+"}\\over d"+E+"^{"+A+"}}",T+"\\left[".concat(_,"\\right]")}}),v=e("_isConst",{"function, ConstantNode, string":function(){return!0},"function, SymbolNode, string":function(_,E,A){return E.name!==A},"function, ParenthesisNode, string":function(_,E,A){return _(E.content,A)},"function, FunctionAssignmentNode, string":function(_,E,A){return E.params.includes(A)?_(E.expr,A):!0},"function, FunctionNode | OperatorNode, string":function(_,E,A){return E.args.every(T=>_(T,A))}}),b=e("_derivative",{"ConstantNode, function":function(){return x(0)},"SymbolNode, function":function(_,E){return E(_)?x(0):x(1)},"ParenthesisNode, function":function(_,E){return new h(b(_.content,E))},"FunctionAssignmentNode, function":function(_,E){return E(_)?x(0):b(_.expr,E)},"FunctionNode, function":function(_,E){if(E(_))return x(0);var A=_.args[0],T,S=!1,M=!1,D;switch(_.name){case"cbrt":S=!0,D=new c("*","multiply",[x(3),new c("^","pow",[A,new c("/","divide",[x(2),x(3)])])]);break;case"sqrt":case"nthRoot":if(_.args.length===1)S=!0,D=new c("*","multiply",[x(2),new u("sqrt",[A])]);else if(_.args.length===2)return T=new c("/","divide",[x(1),_.args[1]]),b(new c("^","pow",[A,T]),E);break;case"log10":T=x(10);case"log":if(!T&&_.args.length===1)D=A.clone(),S=!0;else if(_.args.length===1&&T||_.args.length===2&&E(_.args[1]))D=new c("*","multiply",[A.clone(),new u("log",[T||_.args[1]])]),S=!0;else if(_.args.length===2)return b(new c("/","divide",[new u("log",[A]),new u("log",[_.args[1]])]),E);break;case"pow":if(_.args.length===2)return b(new c("^","pow",[A,_.args[1]]),E);break;case"exp":D=new u("exp",[A.clone()]);break;case"sin":D=new u("cos",[A.clone()]);break;case"cos":D=new c("-","unaryMinus",[new u("sin",[A.clone()])]);break;case"tan":D=new c("^","pow",[new u("sec",[A.clone()]),x(2)]);break;case"sec":D=new c("*","multiply",[_,new u("tan",[A.clone()])]);break;case"csc":M=!0,D=new c("*","multiply",[_,new u("cot",[A.clone()])]);break;case"cot":M=!0,D=new c("^","pow",[new u("csc",[A.clone()]),x(2)]);break;case"asin":S=!0,D=new u("sqrt",[new c("-","subtract",[x(1),new c("^","pow",[A.clone(),x(2)])])]);break;case"acos":S=!0,M=!0,D=new u("sqrt",[new c("-","subtract",[x(1),new c("^","pow",[A.clone(),x(2)])])]);break;case"atan":S=!0,D=new c("+","add",[new c("^","pow",[A.clone(),x(2)]),x(1)]);break;case"asec":S=!0,D=new c("*","multiply",[new u("abs",[A.clone()]),new u("sqrt",[new c("-","subtract",[new c("^","pow",[A.clone(),x(2)]),x(1)])])]);break;case"acsc":S=!0,M=!0,D=new c("*","multiply",[new u("abs",[A.clone()]),new u("sqrt",[new c("-","subtract",[new c("^","pow",[A.clone(),x(2)]),x(1)])])]);break;case"acot":S=!0,M=!0,D=new c("+","add",[new c("^","pow",[A.clone(),x(2)]),x(1)]);break;case"sinh":D=new u("cosh",[A.clone()]);break;case"cosh":D=new u("sinh",[A.clone()]);break;case"tanh":D=new c("^","pow",[new u("sech",[A.clone()]),x(2)]);break;case"sech":M=!0,D=new c("*","multiply",[_,new u("tanh",[A.clone()])]);break;case"csch":M=!0,D=new c("*","multiply",[_,new u("coth",[A.clone()])]);break;case"coth":M=!0,D=new c("^","pow",[new u("csch",[A.clone()]),x(2)]);break;case"asinh":S=!0,D=new u("sqrt",[new c("+","add",[new c("^","pow",[A.clone(),x(2)]),x(1)])]);break;case"acosh":S=!0,D=new u("sqrt",[new c("-","subtract",[new c("^","pow",[A.clone(),x(2)]),x(1)])]);break;case"atanh":S=!0,D=new c("-","subtract",[x(1),new c("^","pow",[A.clone(),x(2)])]);break;case"asech":S=!0,M=!0,D=new c("*","multiply",[A.clone(),new u("sqrt",[new c("-","subtract",[x(1),new c("^","pow",[A.clone(),x(2)])])])]);break;case"acsch":S=!0,M=!0,D=new c("*","multiply",[new u("abs",[A.clone()]),new u("sqrt",[new c("+","add",[new c("^","pow",[A.clone(),x(2)]),x(1)])])]);break;case"acoth":S=!0,M=!0,D=new c("-","subtract",[x(1),new c("^","pow",[A.clone(),x(2)])]);break;case"abs":D=new c("/","divide",[new u(new d("abs"),[A.clone()]),A.clone()]);break;case"gamma":default:throw new Error('Cannot process function "'+_.name+'" in derivative: the function is not supported, undefined, or the number of arguments passed to it are not supported')}var N,R;S?(N="/",R="divide"):(N="*",R="multiply");var O=b(A,E);return M&&(O=new c("-","unaryMinus",[O])),new c(N,R,[O,D])},"OperatorNode, function":function(_,E){if(E(_))return x(0);if(_.op==="+")return new c(_.op,_.fn,_.args.map(function(I){return b(I,E)}));if(_.op==="-"){if(_.isUnary())return new c(_.op,_.fn,[b(_.args[0],E)]);if(_.isBinary())return new c(_.op,_.fn,[b(_.args[0],E),b(_.args[1],E)])}if(_.op==="*"){var A=_.args.filter(function(I){return E(I)});if(A.length>0){var T=_.args.filter(function(I){return!E(I)}),S=T.length===1?T[0]:new c("*","multiply",T),M=A.concat(b(S,E));return new c("*","multiply",M)}return new c("+","add",_.args.map(function(I){return new c("*","multiply",_.args.map(function(B){return B===I?b(B,E):B.clone()}))}))}if(_.op==="/"&&_.isBinary()){var D=_.args[0],N=_.args[1];return E(N)?new c("/","divide",[b(D,E),N]):E(D)?new c("*","multiply",[new c("-","unaryMinus",[D]),new c("/","divide",[b(N,E),new c("^","pow",[N.clone(),x(2)])])]):new c("/","divide",[new c("-","subtract",[new c("*","multiply",[b(D,E),N.clone()]),new c("*","multiply",[D.clone(),b(N,E)])]),new c("^","pow",[N.clone(),x(2)])])}if(_.op==="^"&&_.isBinary()){var R=_.args[0],O=_.args[1];if(E(R))return pn(R)&&(a(R.value)||s(R.value,1))?x(0):new c("*","multiply",[_,new c("*","multiply",[new u("log",[R.clone()]),b(O.clone(),E)])]);if(E(O)){if(pn(O)){if(a(O.value))return x(0);if(s(O.value,1))return b(R,E)}var G=new c("^","pow",[R.clone(),new c("-","subtract",[O,x(1)])]);return new c("*","multiply",[O.clone(),new c("*","multiply",[b(R,E),G])])}return new c("*","multiply",[new c("^","pow",[R.clone(),O.clone()]),new c("+","add",[new c("*","multiply",[b(R,E),new c("/","divide",[O.clone(),R.clone()])]),new c("*","multiply",[b(O,E),new u("log",[R.clone()])])])])}throw new Error('Cannot process operator "'+_.op+'" in derivative: the operator is not supported, undefined, or the number of arguments passed to it are not supported')}});function x(w,_){return new l(o(w,Wp(String(w),t)))}return m}),xj="rationalize",yze=["config","typed","equal","isZero","add","subtract","multiply","divide","pow","parse","simplifyConstant","simplifyCore","simplify","?bignumber","?fraction","mathWithTransform","matrix","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","SymbolNode","ParenthesisNode"],xze=re(xj,yze,n=>{var{config:e,typed:t,equal:r,isZero:i,add:s,subtract:a,multiply:o,divide:l,pow:u,parse:c,simplifyConstant:h,simplifyCore:d,simplify:f,fraction:p,bignumber:m,mathWithTransform:y,matrix:v,AccessorNode:b,ArrayNode:x,ConstantNode:w,FunctionNode:_,IndexNode:E,ObjectNode:A,OperatorNode:T,SymbolNode:S,ParenthesisNode:M}=n;function D(I){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},$=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,H=R(),Q=N(I,B,!0,H.firstRules),ee=Q.variables.length,J={exactFractions:!1},L={exactFractions:!0};if(I=Q.expression,ee>=1){I=O(I);var se,Z,le=!0,ue=!1;I=f(I,H.firstRules,{},J);for(var te;Z=le?H.distrDivRules:H.sucDivRules,I=f(I,Z,{},L),le=!le,te=I.toString(),te!==se;)ue=!0,se=te;ue&&(I=f(I,H.firstRulesAgain,{},J)),I=f(I,H.finalRules,{},J)}var Y=[],ie={};return I.type==="OperatorNode"&&I.isBinary()&&I.op==="/"?(ee===1&&(I.args[0]=G(I.args[0],Y),I.args[1]=G(I.args[1])),$&&(ie.numerator=I.args[0],ie.denominator=I.args[1])):(ee===1&&(I=G(I,Y)),$&&(ie.numerator=I,ie.denominator=null)),$?(ie.coefficients=Y,ie.variables=Q.variables,ie.expression=I,ie):I}return t(xj,{Node:D,"Node, boolean":(I,B)=>D(I,{},B),"Node, Object":D,"Node, Object, boolean":D});function N(I,B,$,H){var Q=[],ee=f(I,H,B,{exactFractions:!1});$=!!$;var J="+-*"+($?"/":"");se(ee);var L={};return L.expression=ee,L.variables=Q,L;function se(Z){var le=Z.type;if(le==="FunctionNode")throw new Error("There is an unsolved function call");if(le==="OperatorNode")if(Z.op==="^"){if(Z.args[1].type!=="ConstantNode"||!bt(parseFloat(Z.args[1].value)))throw new Error("There is a non-integer exponent");se(Z.args[0])}else{if(!J.includes(Z.op))throw new Error("Operator "+Z.op+" invalid in polynomial expression");for(var ue=0;ue<Z.args.length;ue++)se(Z.args[ue])}else if(le==="SymbolNode"){var te=Z.name,Y=Q.indexOf(te);Y===-1&&Q.push(te)}else if(le==="ParenthesisNode")se(Z.content);else if(le!=="ConstantNode")throw new Error("type "+le+" is not allowed in polynomial expression")}}function R(){var I=[d,{l:"n+n",r:"2*n"},{l:"n+-n",r:"0"},h,{l:"n*(n1^-1)",r:"n/n1"},{l:"n*n1^-n2",r:"n/n1^n2"},{l:"n1^-1",r:"1/n1"},{l:"n*(n1/n2)",r:"(n*n1)/n2"},{l:"1*n",r:"n"}],B=[{l:"(-n1)/(-n2)",r:"n1/n2"},{l:"(-n1)*(-n2)",r:"n1*n2"},{l:"n1--n2",r:"n1+n2"},{l:"n1-n2",r:"n1+(-n2)"},{l:"(n1+n2)*n3",r:"(n1*n3 + n2*n3)"},{l:"n1*(n2+n3)",r:"(n1*n2+n1*n3)"},{l:"c1*n + c2*n",r:"(c1+c2)*n"},{l:"c1*n + n",r:"(c1+1)*n"},{l:"c1*n - c2*n",r:"(c1-c2)*n"},{l:"c1*n - n",r:"(c1-1)*n"},{l:"v/c",r:"(1/c)*v"},{l:"v/-c",r:"-(1/c)*v"},{l:"-v*-c",r:"c*v"},{l:"-v*c",r:"-c*v"},{l:"v*-c",r:"-c*v"},{l:"v*c",r:"c*v"},{l:"-(-n1*n2)",r:"(n1*n2)"},{l:"-(n1*n2)",r:"(-n1*n2)"},{l:"-(-n1+n2)",r:"(n1-n2)"},{l:"-(n1+n2)",r:"(-n1-n2)"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"},{l:"-(-n1/n2)",r:"(n1/n2)"},{l:"-(n1/n2)",r:"(-n1/n2)"}],$=[{l:"(n1/n2 + n3/n4)",r:"((n1*n4 + n3*n2)/(n2*n4))"},{l:"(n1/n2 + n3)",r:"((n1 + n3*n2)/n2)"},{l:"(n1 + n2/n3)",r:"((n1*n3 + n2)/n3)"}],H=[{l:"(n1/(n2/n3))",r:"((n1*n3)/n2)"},{l:"(n1/n2/n3)",r:"(n1/(n2*n3))"}],Q={};return Q.firstRules=I.concat(B,H),Q.distrDivRules=$,Q.sucDivRules=H,Q.firstRulesAgain=I.concat(B),Q.finalRules=[d,{l:"n*-n",r:"-n^2"},{l:"n*n",r:"n^2"},h,{l:"n*-n^n1",r:"-n^(n1+1)"},{l:"n*n^n1",r:"n^(n1+1)"},{l:"n^n1*-n^n2",r:"-n^(n1+n2)"},{l:"n^n1*n^n2",r:"n^(n1+n2)"},{l:"n^n1*-n",r:"-n^(n1+1)"},{l:"n^n1*n",r:"n^(n1+1)"},{l:"n^n1/-n",r:"-n^(n1-1)"},{l:"n^n1/n",r:"n^(n1-1)"},{l:"n/-n^n1",r:"-n^(1-n1)"},{l:"n/n^n1",r:"n^(1-n1)"},{l:"n^n1/-n^n2",r:"n^(n1-n2)"},{l:"n^n1/n^n2",r:"n^(n1-n2)"},{l:"n1+(-n2*n3)",r:"n1-n2*n3"},{l:"v*(-c)",r:"-c*v"},{l:"n1+-n2",r:"n1-n2"},{l:"v*c",r:"c*v"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"}],Q}function O(I,B,$){var H=I.type,Q=arguments.length>1;if(H==="OperatorNode"&&I.isBinary()){var ee=!1,J;if(I.op==="^"&&(I.args[0].type==="ParenthesisNode"||I.args[0].type==="OperatorNode")&&I.args[1].type==="ConstantNode"&&(J=parseFloat(I.args[1].value),ee=J>=2&&bt(J)),ee){if(J>2){var L=I.args[0],se=new T("^","pow",[I.args[0].cloneDeep(),new w(J-1)]);I=new T("*","multiply",[L,se])}else I=new T("*","multiply",[I.args[0],I.args[0].cloneDeep()]);Q&&($==="content"?B.content=I:B.args[$]=I)}}if(H==="ParenthesisNode")O(I.content,I,"content");else if(H!=="ConstantNode"&&H!=="SymbolNode")for(var Z=0;Z<I.args.length;Z++)O(I.args[Z],I,Z);if(!Q)return I}function G(I,B){B===void 0&&(B=[]),B[0]=0;var $={};$.cte=1,$.oper="+",$.fire="";var H=0,Q="";te(I,null,$),H=B.length-1;for(var ee=!0,J,L=H;L>=0;L--)if(B[L]!==0){var se=new w(ee?B[L]:Math.abs(B[L])),Z=B[L]<0?"-":"+";if(L>0){var le=new S(Q);if(L>1){var ue=new w(L);le=new T("^","pow",[le,ue])}B[L]===-1&&ee?se=new T("-","unaryMinus",[le]):Math.abs(B[L])===1?se=le:se=new T("*","multiply",[se,le])}ee?J=se:Z==="+"?J=new T("+","add",[J,se]):J=new T("-","subtract",[J,se]),ee=!1}if(ee)return new w(0);return J;function te(Y,ie,ve){var ge=Y.type;if(ge==="FunctionNode")throw new Error("There is an unsolved function call");if(ge==="OperatorNode"){if(!"+-*^".includes(Y.op))throw new Error("Operator "+Y.op+" invalid");if(ie!==null){if((Y.fn==="unaryMinus"||Y.fn==="pow")&&ie.fn!=="add"&&ie.fn!=="subtract"&&ie.fn!=="multiply")throw new Error("Invalid "+Y.op+" placing");if((Y.fn==="subtract"||Y.fn==="add"||Y.fn==="multiply")&&ie.fn!=="add"&&ie.fn!=="subtract")throw new Error("Invalid "+Y.op+" placing");if((Y.fn==="subtract"||Y.fn==="add"||Y.fn==="unaryMinus")&&ve.noFil!==0)throw new Error("Invalid "+Y.op+" placing")}(Y.op==="^"||Y.op==="*")&&(ve.fire=Y.op);for(var _e=0;_e<Y.args.length;_e++)Y.fn==="unaryMinus"&&(ve.oper="-"),(Y.op==="+"||Y.fn==="subtract")&&(ve.fire="",ve.cte=1,ve.oper=_e===0?"+":Y.op),ve.noFil=_e,te(Y.args[_e],Y,ve)}else if(ge==="SymbolNode"){if(Y.name!==Q&&Q!=="")throw new Error("There is more than one variable");if(Q=Y.name,ie===null){B[1]=1;return}if(ie.op==="^"&&ve.noFil!==0)throw new Error("In power the variable should be the first parameter");if(ie.op==="*"&&ve.noFil!==1)throw new Error("In multiply the variable should be the second parameter");(ve.fire===""||ve.fire==="*")&&(H<1&&(B[1]=0),B[1]+=ve.cte*(ve.oper==="+"?1:-1),H=Math.max(1,H))}else if(ge==="ConstantNode"){var we=parseFloat(Y.value);if(ie===null){B[0]=we;return}if(ie.op==="^"){if(ve.noFil!==1)throw new Error("Constant cannot be powered");if(!bt(we)||we<=0)throw new Error("Non-integer exponent is not allowed");for(var Be=H+1;Be<we;Be++)B[Be]=0;we>H&&(B[we]=0),B[we]+=ve.cte*(ve.oper==="+"?1:-1),H=Math.max(we,H);return}ve.cte=we,ve.fire===""&&(B[0]+=ve.cte*(ve.oper==="+"?1:-1))}else throw new Error("Type "+ge+" is not allowed")}}}),bj="zpk2tf",bze=["typed","add","multiply","Complex","number"],_ze=re(bj,bze,n=>{var{typed:e,add:t,multiply:r,Complex:i,number:s}=n;return e(bj,{"Array,Array,number":function(u,c,h){return a(u,c,h)},"Array,Array":function(u,c){return a(u,c,1)},"Matrix,Matrix,number":function(u,c,h){return a(u.valueOf(),c.valueOf(),h)},"Matrix,Matrix":function(u,c){return a(u.valueOf(),c.valueOf(),1)}});function a(l,u,c){l.some(b=>b.type==="BigNumber")&&(l=l.map(b=>s(b))),u.some(b=>b.type==="BigNumber")&&(u=u.map(b=>s(b)));for(var h=[i(1,0)],d=[i(1,0)],f=0;f<l.length;f++){var p=l[f];typeof p=="number"&&(p=i(p,0)),h=o(h,[i(1,0),i(-p.re,-p.im)])}for(var m=0;m<u.length;m++){var y=u[m];typeof y=="number"&&(y=i(y,0)),d=o(d,[i(1,0),i(-y.re,-y.im)])}for(var v=0;v<h.length;v++)h[v]=r(h[v],c);return[h,d]}function o(l,u){for(var c=[],h=0;h<l.length+u.length-1;h++){c[h]=i(0,0);for(var d=0;d<l.length;d++)h-d>=0&&h-d<u.length&&(c[h]=t(c[h],r(l[d],u[h-d])))}return c}}),_j="freqz",wze=["typed","add","multiply","Complex","divide","matrix"],Eze=re(_j,wze,n=>{var{typed:e,add:t,multiply:r,Complex:i,divide:s,matrix:a}=n;return e(_j,{"Array, Array":function(c,h){var d=l(512);return o(c,h,d)},"Array, Array, Array":function(c,h,d){return o(c,h,d)},"Array, Array, number":function(c,h,d){if(d<0)throw new Error("w must be a positive number");var f=l(d);return o(c,h,f)},"Matrix, Matrix":function(c,h){var d=l(512),{w:f,h:p}=o(c.valueOf(),h.valueOf(),d);return{w:a(f),h:a(p)}},"Matrix, Matrix, Matrix":function(c,h,d){var{h:f}=o(c.valueOf(),h.valueOf(),d.valueOf());return{h:a(f),w:a(d)}},"Matrix, Matrix, number":function(c,h,d){if(d<0)throw new Error("w must be a positive number");var f=l(d),{h:p}=o(c.valueOf(),h.valueOf(),f);return{h:a(p),w:a(f)}}});function o(u,c,h){for(var d=[],f=[],p=0;p<h.length;p++){for(var m=i(0,0),y=i(0,0),v=0;v<u.length;v++)m=t(m,r(u[v],i(Math.cos(-v*h[p]),Math.sin(-v*h[p]))));for(var b=0;b<c.length;b++)y=t(y,r(c[b],i(Math.cos(-b*h[p]),Math.sin(-b*h[p]))));d.push(m),f.push(y)}for(var x=[],w=0;w<d.length;w++)x.push(s(d[w],f[w]));return{h:x,w:h}}function l(u){for(var c=[],h=0;h<u;h++)c.push(h/u*Math.PI);return c}}),Sze="reviver",Aze=["classes"],Tze=re(Sze,Aze,n=>{var{classes:e}=n;return function(r,i){var s=e[i&&i.mathjs];return s&&typeof s.fromJSON=="function"?s.fromJSON(i):i}}),Mze="replacer",Cze=[],Dze=re(Mze,Cze,()=>function(e,t){return typeof t=="number"&&(!Number.isFinite(t)||isNaN(t))?{mathjs:"number",value:String(t)}:typeof t=="bigint"?{mathjs:"bigint",value:String(t)}:t}),Nze="15.1.0",Rze=re("true",[],()=>!0),Ize=re("false",[],()=>!1),Pze=re("null",[],()=>null),Fze=Ho("Infinity",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?new t(1/0):1/0}),Lze=Ho("NaN",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?new t(NaN):NaN}),Oze=Ho("pi",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?oU(t):TDe}),kze=Ho("tau",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?iFe(t):MDe}),Bze=Ho("e",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?nFe(t):CDe}),Uze=Ho("phi",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?rFe(t):DDe}),Vze=Ho("LN2",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?new t(2).ln():Math.LN2}),zze=Ho("LN10",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?new t(10).ln():Math.LN10}),$ze=Ho("LOG2E",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?new t(1).div(new t(2).ln()):Math.LOG2E}),Hze=Ho("LOG10E",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?new t(1).div(new t(10).ln()):Math.LOG10E}),Gze=Ho("SQRT1_2",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?new t("0.5").sqrt():Math.SQRT1_2}),jze=Ho("SQRT2",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?new t(2).sqrt():Math.SQRT2}),qze=Ho("i",["Complex"],n=>{var{Complex:e}=n;return e.I}),Wze=re("version",[],()=>Nze);function Ho(n,e,t){return re(n,e,t,{recreateOnConfigChange:!0})}var Xze=zt("speedOfLight","299792458","m s^-1"),Kze=zt("gravitationConstant","6.67430e-11","m^3 kg^-1 s^-2"),Yze=zt("planckConstant","6.62607015e-34","J s"),Qze=zt("reducedPlanckConstant","1.0545718176461565e-34","J s"),Zze=zt("magneticConstant","1.25663706212e-6","N A^-2"),Jze=zt("electricConstant","8.8541878128e-12","F m^-1"),e8e=zt("vacuumImpedance","376.730313667","ohm"),t8e=zt("coulomb","8.987551792261171e9","N m^2 C^-2"),n8e=zt("coulombConstant","8.987551792261171e9","N m^2 C^-2"),r8e=zt("elementaryCharge","1.602176634e-19","C"),i8e=zt("bohrMagneton","9.2740100783e-24","J T^-1"),s8e=zt("conductanceQuantum","7.748091729863649e-5","S"),a8e=zt("inverseConductanceQuantum","12906.403729652257","ohm"),o8e=zt("magneticFluxQuantum","2.0678338484619295e-15","Wb"),l8e=zt("nuclearMagneton","5.0507837461e-27","J T^-1"),u8e=zt("klitzing","25812.807459304513","ohm"),c8e=zt("bohrRadius","5.29177210903e-11","m"),h8e=zt("classicalElectronRadius","2.8179403262e-15","m"),d8e=zt("electronMass","9.1093837015e-31","kg"),f8e=zt("fermiCoupling","1.1663787e-5","GeV^-2"),p8e=$N("fineStructure",.0072973525693),m8e=zt("hartreeEnergy","4.3597447222071e-18","J"),g8e=zt("protonMass","1.67262192369e-27","kg"),v8e=zt("deuteronMass","3.3435830926e-27","kg"),y8e=zt("neutronMass","1.6749271613e-27","kg"),x8e=zt("quantumOfCirculation","3.6369475516e-4","m^2 s^-1"),b8e=zt("rydberg","10973731.568160","m^-1"),_8e=zt("thomsonCrossSection","6.6524587321e-29","m^2"),w8e=$N("weakMixingAngle",.2229),E8e=$N("efimovFactor",22.7),S8e=zt("atomicMass","1.66053906660e-27","kg"),A8e=zt("avogadro","6.02214076e23","mol^-1"),T8e=zt("boltzmann","1.380649e-23","J K^-1"),M8e=zt("faraday","96485.33212331001","C mol^-1"),C8e=zt("firstRadiation","3.7417718521927573e-16","W m^2"),D8e=zt("loschmidt","2.686780111798444e25","m^-3"),N8e=zt("gasConstant","8.31446261815324","J K^-1 mol^-1"),R8e=zt("molarPlanckConstant","3.990312712893431e-10","J s mol^-1"),I8e=zt("molarVolume","0.022413969545014137","m^3 mol^-1"),P8e=$N("sackurTetrode",-1.16487052358),F8e=zt("secondRadiation","0.014387768775039337","m K"),L8e=zt("stefanBoltzmann","5.67037441918443e-8","W m^-2 K^-4"),O8e=zt("wienDisplacement","2.897771955e-3","m K"),k8e=zt("molarMass","0.99999999965e-3","kg mol^-1"),B8e=zt("molarMassC12","11.9999999958e-3","kg mol^-1"),U8e=zt("gravity","9.80665","m s^-2"),V8e=zt("planckLength","1.616255e-35","m"),z8e=zt("planckMass","2.176435e-8","kg"),$8e=zt("planckTime","5.391245e-44","s"),H8e=zt("planckCharge","1.87554603778e-18","C"),G8e=zt("planckTemperature","1.416785e+32","K");function zt(n,e,t){var r=["config","Unit","BigNumber"];return re(n,r,i=>{var{config:s,Unit:a,BigNumber:o}=i,l=s.number==="BigNumber"?new o(e):parseFloat(e),u=new a(l,t);return u.fixPrefix=!0,u})}function $N(n,e){var t=["config","BigNumber"];return re(n,t,r=>{var{config:i,BigNumber:s}=r;return i.number==="BigNumber"?new s(e):e})}function wj(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function j8e(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?wj(Object(t),!0).forEach(function(r){wi(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):wj(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var q8e="mapSlices",W8e=["typed","isInteger"],X8e=re(q8e,W8e,n=>{var{typed:e,isInteger:t}=n,r=RO({typed:e,isInteger:t});return e("mapSlices",{"...any":function(s){var a=s[1];Tt(a)?s[1]=a-1:jt(a)&&(s[1]=a.minus(1));try{return r.apply(null,s)}catch(o){throw Ra(o)}}})},j8e({isTransformFunction:!0},RO.meta)),K8e="column",Y8e=["typed","Index","matrix","range"],Q8e=re(K8e,Y8e,n=>{var{typed:e,Index:t,matrix:r,range:i}=n,s=Vne({typed:e,Index:t,matrix:r,range:i});return e("column",{"...any":function(o){var l=o.length-1,u=o[l];Tt(u)&&(o[l]=u-1);try{return s.apply(null,o)}catch(c){throw Ra(c)}}})},{isTransformFunction:!0});function gU(n,e,t){var r=n.filter(function(l){return ss(l)&&!(l.name in e)&&!t.has(l.name)})[0];if(!r)throw new Error('No undefined variable found in inline expression "'+n+'"');var i=r.name,s=new Map,a=new ote(t,s,new Set([i])),o=n.compile();return function(u){return s.set(i,u),o.evaluate(a)}}var Z8e="transformCallback",J8e=["typed"],vU=re(Z8e,J8e,n=>{var{typed:e}=n;return function(r,i){return e.isTypedFunction(r)?t(r,i):Ej(r,r.length,i)};function t(r,i){var s=Object.fromEntries(Object.entries(r.signatures).map(a=>{var[o,l]=a,u=o.split(",").length;return e.isTypedFunction(l)?[o,t(l,i)]:[o,Ej(l,u,i)]}));return typeof r.name=="string"?e(r.name,s):e(s)}});function Ej(n,e,t){return e===t?n:e===t+1?function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];var a=i.slice(0,t),o=Sj(i[t]);return n(...a,o)}:e>t+1?function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];var a=i.slice(0,t),o=Sj(i[t]),l=i.slice(t+1);return n(...a,o,...l)}:n}function Sj(n){return n.map(e=>e+1)}var e9e="filter",t9e=["typed"],n9e=re(e9e,t9e,n=>{var{typed:e}=n;function t(i,s,a){var o=zne({typed:e}),l=vU({typed:e});if(i.length===0)return o();var u=i[0];if(i.length===1)return o(u);var c=i.length-1,h=i[c];return u&&(u=r(u,a)),h&&(ss(h)||aA(h)?h=r(h,a):h=gU(h,s,a)),o(u,l(h,c))}t.rawArgs=!0;function r(i,s){return i.compile().evaluate(s)}return t},{isTransformFunction:!0}),r9e="forEach",i9e=["typed"],s9e=re(r9e,i9e,n=>{var{typed:e}=n,t=$ne({typed:e}),r=vU({typed:e});function i(a,o,l){if(a.length===0)return t();var u=a[0];if(a.length===1)return t(u);var c=a.length-1,h=a[c];return u&&(u=s(u,l)),h&&(ss(h)||aA(h)?h=s(h,l):h=gU(h,o,l)),t(u,r(h,c))}i.rawArgs=!0;function s(a,o){return a.compile().evaluate(o)}return i},{isTransformFunction:!0}),a9e="index",o9e=["Index","getMatrixDataType"],l9e=re(a9e,o9e,n=>{var{Index:e,getMatrixDataType:t}=n;return function(){for(var i=[],s=0,a=arguments.length;s<a;s++){var o=arguments[s];if(X4(o))o.start--,o.end-=o.step>0?0:2;else if(o&&o.isSet===!0)o=o.map(function(u){return u-1});else if(Xn(o)||Dt(o))t(o)!=="boolean"&&(o=o.map(function(u){return u-1}));else if(Tt(o)||O1(o))o--;else if(jt(o))o=o.toNumber()-1;else if(typeof o!="string")throw new TypeError("Dimension must be an Array, Matrix, number, bigint, string, or Range");i[s]=o}var l=new e;return e.apply(l,i),l}},{isTransformFunction:!0}),u9e="map",c9e=["typed"],h9e=re(u9e,c9e,n=>{var{typed:e}=n,t=Hne({typed:e}),r=vU({typed:e});function i(s,a,o){if(s.length===0)return t();if(s.length===1)return t(s[0]);var l=s.length-1,u=s.slice(0,l),c=s[l];return u=u.map(d=>h(d,o)),c&&(ss(c)||aA(c)?c=h(c,o):c=gU(c,a,o)),t(...u,r(c,l));function h(d,f){return d.compile().evaluate(f)}}return i.rawArgs=!0,i},{isTransformFunction:!0});function d9e(n){return Tt(n)?n-1:jt(n)?n.minus(1):n}function f9e(n){return Tt(n)||jt(n)}function Yp(n){if(n.length===2&&Vo(n[0])){n=n.slice();var e=n[1];f9e(e)&&(n[1]=d9e(e))}return n}var p9e="max",m9e=["typed","config","numeric","larger","isNaN"],g9e=re(p9e,m9e,n=>{var{typed:e,config:t,numeric:r,larger:i,isNaN:s}=n,a=Zne({typed:e,config:t,numeric:r,larger:i,isNaN:s});return e("max",{"...any":function(l){l=Yp(l);try{return a.apply(null,l)}catch(u){throw Ra(u)}}})},{isTransformFunction:!0}),v9e="mean",y9e=["typed","add","divide"],x9e=re(v9e,y9e,n=>{var{typed:e,add:t,divide:r}=n,i=ore({typed:e,add:t,divide:r});return e("mean",{"...any":function(a){a=Yp(a);try{return i.apply(null,a)}catch(o){throw Ra(o)}}})},{isTransformFunction:!0}),b9e="min",_9e=["typed","config","numeric","smaller","isNaN"],w9e=re(b9e,_9e,n=>{var{typed:e,config:t,numeric:r,smaller:i,isNaN:s}=n,a=Jne({typed:e,config:t,numeric:r,smaller:i,isNaN:s});return e("min",{"...any":function(l){l=Yp(l);try{return a.apply(null,l)}catch(u){throw Ra(u)}}})},{isTransformFunction:!0}),E9e="range",S9e=["typed","config","?matrix","?bignumber","equal","smaller","smallerEq","larger","largerEq","add","isZero","isPositive"],A9e=re(E9e,S9e,n=>{var{typed:e,config:t,matrix:r,bignumber:i,equal:s,smaller:a,smallerEq:o,larger:l,largerEq:u,add:c,isZero:h,isPositive:d}=n,f=qne({typed:e,config:t,matrix:r,bignumber:i,equal:s,smaller:a,smallerEq:o,larger:l,largerEq:u,add:c,isZero:h,isPositive:d});return e("range",{"...any":function(m){var y=m.length-1,v=m[y];return typeof v!="boolean"&&m.push(!0),f.apply(null,m)}})},{isTransformFunction:!0}),T9e="row",M9e=["typed","Index","matrix","range"],C9e=re(T9e,M9e,n=>{var{typed:e,Index:t,matrix:r,range:i}=n,s=Wne({typed:e,Index:t,matrix:r,range:i});return e("row",{"...any":function(o){var l=o.length-1,u=o[l];Tt(u)&&(o[l]=u-1);try{return s.apply(null,o)}catch(c){throw Ra(c)}}})},{isTransformFunction:!0}),D9e="subset",N9e=["typed","matrix","zeros","add"],R9e=re(D9e,N9e,n=>{var{typed:e,matrix:t,zeros:r,add:i}=n,s=Xne({typed:e,matrix:t,zeros:r,add:i});return e("subset",{"...any":function(o){try{return s.apply(null,o)}catch(l){throw Ra(l)}}})},{isTransformFunction:!0}),I9e="concat",P9e=["typed","matrix","isInteger"],F9e=re(I9e,P9e,n=>{var{typed:e,matrix:t,isInteger:r}=n,i=Une({typed:e,matrix:t,isInteger:r});return e("concat",{"...any":function(a){var o=a.length-1,l=a[o];Tt(l)?a[o]=l-1:jt(l)&&(a[o]=l.minus(1));try{return i.apply(null,a)}catch(u){throw Ra(u)}}})},{isTransformFunction:!0}),Aj="diff",L9e=["typed","matrix","subtract","number","bignumber"],O9e=re(Aj,L9e,n=>{var{typed:e,matrix:t,subtract:r,number:i,bignumber:s}=n,a=Gne({typed:e,matrix:t,subtract:r,number:i,bignumber:s});return e(Aj,{"...any":function(l){l=Yp(l);try{return a.apply(null,l)}catch(u){throw Ra(u)}}})},{isTransformFunction:!0}),k9e="std",B9e=["typed","map","sqrt","variance"],U9e=re(k9e,B9e,n=>{var{typed:e,map:t,sqrt:r,variance:i}=n,s=cre({typed:e,map:t,sqrt:r,variance:i});return e("std",{"...any":function(o){o=Yp(o);try{return s.apply(null,o)}catch(l){throw Ra(l)}}})},{isTransformFunction:!0}),Tj="sum",V9e=["typed","config","add","numeric"],z9e=re(Tj,V9e,n=>{var{typed:e,config:t,add:r,numeric:i}=n,s=sre({typed:e,config:t,add:r,numeric:i});return e(Tj,{"...any":function(o){o=Yp(o);try{return s.apply(null,o)}catch(l){throw Ra(l)}}})},{isTransformFunction:!0}),$9e="quantileSeq",H9e=["typed","bignumber","add","subtract","divide","multiply","partitionSelect","compare","isInteger","smaller","smallerEq","larger","mapSlices"],G9e=re($9e,H9e,n=>{var{typed:e,bignumber:t,add:r,subtract:i,divide:s,multiply:a,partitionSelect:o,compare:l,isInteger:u,smaller:c,smallerEq:h,larger:d,mapSlices:f}=n,p=ure({typed:e,bignumber:t,add:r,subtract:i,divide:s,multiply:a,partitionSelect:o,compare:l,isInteger:u,smaller:c,smallerEq:h,larger:d,mapSlices:f});return e("quantileSeq",{"Array | Matrix, number | BigNumber":p,"Array | Matrix, number | BigNumber, number":(y,v,b)=>p(y,v,m(b)),"Array | Matrix, number | BigNumber, boolean":p,"Array | Matrix, number | BigNumber, boolean, number":(y,v,b,x)=>p(y,v,b,m(x)),"Array | Matrix, Array | Matrix":p,"Array | Matrix, Array | Matrix, number":(y,v,b)=>p(y,v,m(b)),"Array | Matrix, Array | Matrix, boolean":p,"Array | Matrix, Array | Matrix, boolean, number":(y,v,b,x)=>p(y,v,b,m(x))});function m(y){return Yp([[],y])[1]}},{isTransformFunction:!0}),Mj="cumsum",j9e=["typed","add","unaryPlus"],q9e=re(Mj,j9e,n=>{var{typed:e,add:t,unaryPlus:r}=n,i=are({typed:e,add:t,unaryPlus:r});return e(Mj,{"...any":function(a){if(a.length===2&&Vo(a[0])){var o=a[1];Tt(o)?a[1]=o-1:jt(o)&&(a[1]=o.minus(1))}try{return i.apply(null,a)}catch(l){throw Ra(l)}}})},{isTransformFunction:!0}),Cj="variance",W9e=["typed","add","subtract","multiply","divide","mapSlices","isNaN"],X9e=re(Cj,W9e,n=>{var{typed:e,add:t,subtract:r,multiply:i,divide:s,mapSlices:a,isNaN:o}=n,l=lre({typed:e,add:t,subtract:r,multiply:i,divide:s,mapSlices:a,isNaN:o});return e(Cj,{"...any":function(c){c=Yp(c);try{return l.apply(null,c)}catch(h){throw Ra(h)}}})},{isTransformFunction:!0}),Dj="print",K9e=["typed","matrix","zeros","add"],Y9e=re(Dj,K9e,n=>{var{typed:e,matrix:t,zeros:r,add:i}=n,s=Yne({typed:e,matrix:t,zeros:r,add:i});return e(Dj,{"string, Object | Array":function(l,u){return s(a(l),u)},"string, Object | Array, number | Object":function(l,u,c){return s(a(l),u,c)}});function a(o){return o.replace(Kne,l=>{var u=l.slice(1).split("."),c=u.map(function(h){return!isNaN(h)&&h.length>0?parseInt(h)-1:h});return"$"+c.join(".")})}},{isTransformFunction:!0}),Q9e="and",Z9e=["typed","matrix","zeros","add","equalScalar","not","concat"],J9e=re(Q9e,Z9e,n=>{var{typed:e,matrix:t,equalScalar:r,zeros:i,not:s,concat:a}=n,o=Qne({typed:e,matrix:t,equalScalar:r,zeros:i,not:s,concat:a});function l(u,c,h){var d=u[0].compile().evaluate(h);if(!Vo(d)&&!o(d,!0))return!1;var f=u[1].compile().evaluate(h);return o(d,f)}return l.rawArgs=!0,l},{isTransformFunction:!0}),e$e="or",t$e=["typed","matrix","equalScalar","DenseMatrix","concat"],n$e=re(e$e,t$e,n=>{var{typed:e,matrix:t,equalScalar:r,DenseMatrix:i,concat:s}=n,a=Bne({typed:e,matrix:t,equalScalar:r,DenseMatrix:i,concat:s});function o(l,u,c){var h=l[0].compile().evaluate(c);if(!Vo(h)&&a(h,!1))return!0;var d=l[1].compile().evaluate(c);return a(h,d)}return o.rawArgs=!0,o},{isTransformFunction:!0}),r$e="nullish",i$e=["typed","matrix","size","flatten","deepEqual"],s$e=re(r$e,i$e,n=>{var{typed:e,matrix:t,size:r,flatten:i,deepEqual:s}=n,a=kne({typed:e,matrix:t,size:r,flatten:i,deepEqual:s});function o(l,u,c){var h=l[0].compile().evaluate(c);if(!Vo(h)&&h!=null&&h!==void 0)return h;var d=l[1].compile().evaluate(c);return a(h,d)}return o.rawArgs=!0,o},{isTransformFunction:!0}),a$e="bitAnd",o$e=["typed","matrix","zeros","add","equalScalar","not","concat"],l$e=re(a$e,o$e,n=>{var{typed:e,matrix:t,equalScalar:r,zeros:i,not:s,concat:a}=n,o=Lne({typed:e,matrix:t,equalScalar:r,zeros:i,not:s,concat:a});function l(u,c,h){var d=u[0].compile().evaluate(h);if(!Vo(d)){if(isNaN(d))return NaN;if(d===0||d===!1)return 0}var f=u[1].compile().evaluate(h);return o(d,f)}return l.rawArgs=!0,l},{isTransformFunction:!0}),u$e="bitOr",c$e=["typed","matrix","equalScalar","DenseMatrix","concat"],h$e=re(u$e,c$e,n=>{var{typed:e,matrix:t,equalScalar:r,DenseMatrix:i,concat:s}=n,a=One({typed:e,matrix:t,equalScalar:r,DenseMatrix:i,concat:s});function o(l,u,c){var h=l[0].compile().evaluate(c);if(!Vo(h)){if(isNaN(h))return NaN;if(h===-1)return-1;if(h===!0)return 1}var d=l[1].compile().evaluate(c);return a(h,d)}return o.rawArgs=!0,o},{isTransformFunction:!0}),Je=UCe({config:Ve}),Zn=GCe({}),Nj=Bze({BigNumber:Je,config:Ve}),d$e=Ize({}),f$e=p8e({BigNumber:Je,config:Ve}),Qp=ZCe({}),fre=qze({Complex:Zn}),p$e=Fze({BigNumber:Je,config:Ve}),m$e=zze({BigNumber:Je,config:Ve}),g$e=Hze({BigNumber:Je,config:Ve}),HN=iDe({}),v$e=Lze({BigNumber:Je,config:Ve}),y$e=Pze({}),x$e=Uze({BigNumber:Je,config:Ve}),b$e=tDe({}),pre=HMe({}),_$e=Gze({BigNumber:Je,config:Ve}),w$e=P8e({BigNumber:Je,config:Ve}),mre=kze({BigNumber:Je,config:Ve}),E$e=Rze({}),S$e=Wze({}),Qt=bDe({Matrix:HN,config:Ve}),A$e=E8e({BigNumber:Je,config:Ve}),T$e=Vze({BigNumber:Je,config:Ve}),VO=Oze({BigNumber:Je,config:Ve}),gre=Dze({}),M$e=jze({BigNumber:Je,config:Ve}),me=UMe({BigNumber:Je,Complex:Zn,DenseMatrix:Qt,Fraction:Qp}),C$e=w8e({BigNumber:Je,config:Ve}),Rs=U2e({typed:me}),D$e=mFe({Complex:Zn,config:Ve,typed:me}),N$e=xFe({BigNumber:Je,typed:me}),R$e=EFe({BigNumber:Je,Complex:Zn,config:Ve,typed:me}),Vi=H2e({typed:me}),I$e=NRe({typed:me}),P$e=DFe({BigNumber:Je,Complex:Zn,config:Ve,typed:me}),F$e=FFe({typed:me}),vre=kFe({typed:me}),L$e=zFe({Complex:Zn,config:Ve,typed:me}),O$e=c2e({typed:me}),k$e=ERe({typed:me}),B$e=p2e({typed:me}),U$e=wDe({typed:me}),GN=a6e({typed:me}),fv=b2e({Complex:Zn,typed:me}),Gv=IRe({typed:me}),yU=HFe({typed:me}),V$e=WFe({BigNumber:Je,typed:me}),z$e=QFe({BigNumber:Je,typed:me}),$$e=sNe({typed:me}),rn=JDe({config:Ve,typed:me}),H$e=ZIe({typed:me}),yre=oNe({typed:me}),G$e=uNe({Complex:Zn,typed:me}),j$e=zne({typed:me}),jv=eIe({typed:me}),q$e=$ne({typed:me}),cA=uPe({typed:me}),xU=iIe({typed:me}),W$e=mPe({format:cA,typed:me}),bU=FRe({typed:me}),hA=qDe({typed:me}),Zh=GDe({typed:me}),qv=ODe({typed:me}),X$e=wPe({typed:me}),K$e=$ze({BigNumber:Je,config:Ve}),Y$e=d6e({Complex:Zn,typed:me}),Q$e=HNe({Complex:Zn,config:Ve,typed:me}),_U=jNe({Complex:Zn,config:Ve,typed:me}),Zp=Hne({typed:me}),Z$e=sPe({isNaN:Zh,isNumeric:qv,typed:me}),ni=XNe({typed:me}),r2=BRe({typed:me}),Fc=o2e({typed:me}),J$e=fPe({format:cA,typed:me}),e7e=V6e({config:Ve,typed:me}),t7e=Yne({typed:me}),n7e=$6e({config:Ve,typed:me}),wU=ORe({typed:me}),r7e=tLe({BigNumber:Je,typed:me}),xre=eRe({BigNumber:Je,Fraction:Qp,complex:fv,typed:me}),jN=sLe({typed:me}),zi=MIe({typed:me}),$i=n2e({Matrix:HN,equalScalar:rn,typed:me}),i7e=P2e({typed:me}),s7e=sRe({typed:me}),a7e=d2e({typed:me}),Il=j2e({typed:me}),o7e=uLe({typed:me}),l7e=bPe({typed:me}),qN=YDe({typed:me}),u7e=vFe({Complex:Zn,config:Ve,typed:me}),c7e=AFe({BigNumber:Je,typed:me}),h7e=MFe({BigNumber:Je,Complex:Zn,config:Ve,typed:me}),to=v2e({BigNumber:Je,typed:me}),d7e=l6e({typed:me}),f7e=jFe({typed:me}),p7e=JFe({BigNumber:Je,typed:me}),WN=VLe({addScalar:Vi,conj:Gv,multiplyScalar:ni,size:zi,typed:me}),m7e=BDe({isNumeric:qv,typed:me}),g7e=XDe({isBounded:hA,map:Zp,typed:me}),Jp=FDe({config:Ve,typed:me}),Pl=$De({equalScalar:rn,typed:me}),Ze=A2e({DenseMatrix:Qt,Matrix:HN,SparseMatrix:$i,typed:me}),v7e=M2e({isZero:Pl,matrix:Ze,typed:me}),On=YNe({addScalar:Vi,dot:WN,equalScalar:rn,matrix:Ze,multiplyScalar:ni,typed:me}),y7e=fIe({BigNumber:Je,config:Ve,matrix:Ze,typed:me}),x7e=G6e({config:Ve,log2:_U,typed:me}),b7e=bIe({config:Ve,matrix:Ze}),_7e=rLe({BigNumber:Je,typed:me}),w7e=oLe({typed:me}),E7e=hFe({SparseMatrix:$i,typed:me}),bu=rRe({Complex:Zn,config:Ve,typed:me}),S7e=DIe({typed:me}),A7e=dLe({typed:me}),dA=LIe({matrix:Ze,typed:me}),bre=uRe({BigNumber:Je,config:Ve,matrix:Ze,typed:me}),Ts=UIe({BigNumber:Je,config:Ve,matrix:Ze,typed:me}),T7e=_Fe({BigNumber:Je,Complex:Zn,config:Ve,typed:me}),M7e=RFe({Complex:Zn,config:Ve,typed:me}),C7e=hPe({format:cA,typed:me}),D7e=KFe({BigNumber:Je,typed:me}),EU=kIe({conj:Gv,transpose:dA,typed:me}),_re=YRe({DenseMatrix:Qt,SparseMatrix:$i,matrix:Ze,typed:me}),aa=g3e({DenseMatrix:Qt,SparseMatrix:$i,equalScalar:rn,matrix:Ze,typed:me}),fA=E2e({Fraction:Qp,typed:me}),em=aIe({BigNumber:Je,DenseMatrix:Qt,SparseMatrix:$i,config:Ve,matrix:Ze,typed:me}),Sa=SDe({equal:aa,typed:me}),N7e=lIe({matrix:Ze,multiplyScalar:ni,typed:me}),Fw=RO({isInteger:Sa,typed:me}),SU=R2e({flatten:jv,matrix:Ze,size:zi,typed:me}),Sl=APe({bignumber:to,fraction:fA,number:Fc}),wre=oPe({config:Ve,multiplyScalar:ni,numeric:Sl,typed:me}),Ere=vIe({isInteger:Sa,matrix:Ze,typed:me}),Zb=RPe({BigNumber:Je,DenseMatrix:Qt,config:Ve,equalScalar:rn,matrix:Ze,typed:me,zeros:Ts}),Lc=L2e({typed:me}),R7e=i6e({BigNumber:Je,Fraction:Qp,config:Ve,isInteger:Sa,number:Fc,typed:me}),Sre=W2e({BigNumber:Je,Complex:Zn,Fraction:Qp,config:Ve,isNegative:Jp,matrix:Ze,typed:me,unaryMinus:Lc}),Mn=Une({isInteger:Sa,matrix:Ze,typed:me}),I7e=qRe({prod:wre,size:zi,typed:me}),pA=P3e({equal:aa,typed:me}),Pr=MPe({numeric:Sl,typed:me}),P7e=mRe({concat:Mn,equalScalar:rn,matrix:Ze,multiplyScalar:ni,typed:me}),Are=Rne({DenseMatrix:Qt,config:Ve,equalScalar:rn,matrix:Ze,round:Zb,typed:me,zeros:Ts}),F7e=ONe({BigNumber:Je,DenseMatrix:Qt,concat:Mn,config:Ve,equalScalar:rn,matrix:Ze,round:Zb,typed:me,zeros:Ts}),Wv=VDe({config:Ve,typed:me}),Aa=M3e({DenseMatrix:Qt,SparseMatrix:$i,bignumber:to,concat:Mn,config:Ve,matrix:Ze,typed:me}),L7e=VNe({concat:Mn,equalScalar:rn,matrix:Ze,typed:me}),O7e=e3e({DenseMatrix:Qt,concat:Mn,equalScalar:rn,matrix:Ze,typed:me,zeros:Ts}),Tre=GPe({DenseMatrix:Qt,divideScalar:Pr,equalScalar:rn,matrix:Ze,multiplyScalar:ni,subtractScalar:Il,typed:me}),AU=Zne({config:Ve,isNaN:Zh,larger:Aa,numeric:Sl,typed:me}),Mre=Pne({DenseMatrix:Qt,concat:Mn,config:Ve,equalScalar:rn,matrix:Ze,round:Zb,typed:me,zeros:Ts}),k7e=ZNe({BigNumber:Je,concat:Mn,equalScalar:rn,matrix:Ze,typed:me}),B7e=kne({deepEqual:pA,flatten:jv,matrix:Ze,size:zi,typed:me}),U7e=Bne({DenseMatrix:Qt,concat:Mn,equalScalar:rn,matrix:Ze,typed:me}),TU=KOe({addScalar:Vi,complex:fv,conj:Gv,divideScalar:Pr,equal:aa,identity:em,isZero:Pl,matrix:Ze,multiplyScalar:ni,sign:xre,sqrt:bu,subtractScalar:Il,typed:me,unaryMinus:Lc,zeros:Ts}),V7e=n3e({DenseMatrix:Qt,concat:Mn,equalScalar:rn,matrix:Ze,typed:me,zeros:Ts}),Ta=_3e({DenseMatrix:Qt,SparseMatrix:$i,bignumber:to,concat:Mn,config:Ve,matrix:Ze,typed:me}),Vr=oRe({DenseMatrix:Qt,concat:Mn,equalScalar:rn,matrix:Ze,subtractScalar:Il,typed:me,unaryMinus:Lc}),z7e=yPe({concat:Mn,matrix:Ze,typed:me}),MU=k2e({config:Ve,numeric:Sl,typed:me}),CU=qPe({DenseMatrix:Qt,divideScalar:Pr,equalScalar:rn,matrix:Ze,multiplyScalar:ni,subtractScalar:Il,typed:me}),$7e=$Re({DenseMatrix:Qt,SparseMatrix:$i,concat:Mn,matrix:Ze,typed:me}),hn=FLe({DenseMatrix:Qt,SparseMatrix:$i,addScalar:Vi,concat:Mn,equalScalar:rn,matrix:Ze,typed:me}),H7e=UFe({BigNumber:Je,DenseMatrix:Qt,concat:Mn,equalScalar:rn,matrix:Ze,typed:me}),G7e=Lne({concat:Mn,equalScalar:rn,matrix:Ze,typed:me}),j7e=One({DenseMatrix:Qt,concat:Mn,equalScalar:rn,matrix:Ze,typed:me}),q7e=CRe({DenseMatrix:Qt,SparseMatrix:$i,concat:Mn,matrix:Ze,typed:me}),W7e=Y6e({addScalar:Vi,combinations:GN,divideScalar:Pr,isInteger:Sa,isNegative:Jp,multiplyScalar:ni,typed:me}),Xv=o3e({BigNumber:Je,DenseMatrix:Qt,Fraction:Qp,concat:Mn,config:Ve,equalScalar:rn,matrix:Ze,typed:me}),Cre=p3e({concat:Mn,matrix:Ze,typed:me}),X7e=Z6e({addScalar:Vi,combinations:GN,isInteger:Sa,isNegative:Jp,isPositive:Wv,larger:Aa,typed:me}),K7e=XRe({matrix:Ze,multiply:On,subtract:Vr,typed:me}),Dre=vVe({divideScalar:Pr,isZero:Pl,matrix:Ze,multiply:On,subtractScalar:Il,typed:me,unaryMinus:Lc}),Y7e=Gne({matrix:Ze,number:Fc,subtract:Vr,typed:me}),Q7e=zVe({abs:Rs,addScalar:Vi,deepEqual:pA,divideScalar:Pr,multiplyScalar:ni,sqrt:bu,subtractScalar:Il,typed:me}),mA=$Pe({DenseMatrix:Qt,SparseMatrix:$i,concat:Mn,divideScalar:Pr,equalScalar:rn,matrix:Ze,typed:me}),Z7e=x3e({compareText:Cre,isZero:Pl,typed:me}),Nre=Q3e({larger:Aa,smaller:Ta}),J7e=OLe({abs:Rs,addScalar:Vi,divideScalar:Pr,isPositive:Wv,multiplyScalar:ni,smaller:Ta,sqrt:bu,typed:me}),Rre=j3e({DenseMatrix:Qt,smaller:Ta}),ea=X3e({ImmutableDenseMatrix:Rre,getMatrixDataType:xU}),eHe=GVe({abs:Rs,add:hn,addScalar:Vi,config:Ve,divideScalar:Pr,equalScalar:rn,flatten:jv,isNumeric:qv,isZero:Pl,matrix:Ze,multiply:On,multiplyScalar:ni,smaller:Ta,subtract:Vr,typed:me}),tHe=hRe({BigNumber:Je,add:hn,config:Ve,equal:aa,isInteger:Sa,mod:Mre,smaller:Ta,typed:me,xgcd:bre}),XN=N3e({DenseMatrix:Qt,SparseMatrix:$i,concat:Mn,config:Ve,matrix:Ze,typed:me}),DU=FPe({Complex:Zn,config:Ve,divideScalar:Pr,typeOf:qN,typed:me}),nHe=XPe({DenseMatrix:Qt,divideScalar:Pr,equalScalar:rn,matrix:Ze,multiplyScalar:ni,subtractScalar:Il,typed:me}),rHe=D2e({flatten:jv,matrix:Ze,size:zi,typed:me}),iHe=Jne({config:Ve,isNaN:Zh,numeric:Sl,smaller:Ta,typed:me}),sHe=BPe({Complex:Zn,config:Ve,divideScalar:Pr,typed:me}),KN=B3e({compare:Xv,isNaN:Zh,isNumeric:qv,typed:me}),aHe=i3e({DenseMatrix:Qt,concat:Mn,equalScalar:rn,matrix:Ze,typed:me,zeros:Ts}),Ire=xke({SparseMatrix:$i,abs:Rs,add:hn,divideScalar:Pr,larger:Aa,largerEq:XN,multiply:On,subtract:Vr,transpose:dA,typed:me}),Pre=eFe({FibonacciHeap:Nre,addScalar:Vi,equalScalar:rn}),Go=Xne({add:hn,matrix:Ze,typed:me,zeros:Ts}),NU=sre({add:hn,config:Ve,numeric:Sl,typed:me}),oHe=HLe({add:hn,matrix:Ze,typed:me}),Fre=YPe({DenseMatrix:Qt,divideScalar:Pr,equalScalar:rn,matrix:Ze,multiplyScalar:ni,subtractScalar:Il,typed:me}),lHe=_ze({Complex:Zn,add:hn,multiply:On,number:Fc,typed:me}),RU=rNe({DenseMatrix:Qt,config:Ve,equalScalar:rn,matrix:Ze,round:Zb,typed:me,zeros:Ts}),Oc=h3e({compare:Xv,typed:me}),uHe=are({add:hn,typed:me,unaryPlus:MU}),Lre=dNe({Complex:Zn,DenseMatrix:Qt,ceil:RU,equalScalar:rn,floor:Are,matrix:Ze,typed:me,zeros:Ts}),Ore=jLe({Index:ea,typed:me}),Kv=xVe({abs:Rs,addScalar:Vi,det:Dre,divideScalar:Pr,identity:em,matrix:Ze,multiply:On,typed:me,unaryMinus:Lc}),cHe=OPe({Complex:Zn,config:Ve,divideScalar:Pr,log:DU,typed:me}),kre=WOe({DenseMatrix:Qt,Spa:Pre,SparseMatrix:$i,abs:Rs,addScalar:Vi,divideScalar:Pr,equalScalar:rn,larger:Aa,matrix:Ze,multiplyScalar:ni,subtractScalar:Il,typed:me,unaryMinus:Lc}),hHe=_Ve({Complex:Zn,add:hn,ctranspose:EU,deepEqual:pA,divideScalar:Pr,dot:WN,dotDivide:mA,equal:aa,inv:Kv,matrix:Ze,multiply:On,typed:me}),_u=DPe({Complex:Zn,config:Ve,fraction:fA,identity:em,inv:Kv,matrix:Ze,multiply:On,number:Fc,typed:me}),dHe=pLe({DenseMatrix:Qt,Index:ea,compareNatural:Oc,size:zi,subset:Go,typed:me}),fHe=yLe({DenseMatrix:Qt,Index:ea,compareNatural:Oc,size:zi,subset:Go,typed:me}),pHe=wLe({Index:ea,compareNatural:Oc,size:zi,subset:Go,typed:me}),mHe=TLe({Index:ea,compareNatural:Oc,size:zi,subset:Go,typed:me}),Tb=S3e({DenseMatrix:Qt,SparseMatrix:$i,concat:Mn,config:Ve,matrix:Ze,typed:me}),gHe=V3e({compare:Xv,compareNatural:Oc,matrix:Ze,typed:me}),vHe=NVe({abs:Rs,add:hn,identity:em,inv:Kv,map:Zp,max:AU,multiply:On,size:zi,sqrt:bu,subtract:Vr,typed:me}),yHe=L3e({DenseMatrix:Qt,SparseMatrix:$i,concat:Mn,config:Ve,equalScalar:rn,matrix:Ze,typed:me}),xHe=Qne({concat:Mn,equalScalar:rn,matrix:Ze,not:r2,typed:me,zeros:Ts}),Li=UVe({divideScalar:Pr,equalScalar:rn,inv:Kv,matrix:Ze,multiply:On,typed:me}),bHe=CVe({abs:Rs,add:hn,identity:em,inv:Kv,multiply:On,typed:me}),Bre=zIe({addScalar:Vi,ceil:RU,conj:Gv,divideScalar:Pr,dotDivide:mA,exp:yre,i:fre,log2:_U,matrix:Ze,multiplyScalar:ni,pow:_u,tau:mre,typed:me}),_He=Eze({Complex:Zn,add:hn,divide:Li,matrix:Ze,multiply:On,typed:me}),IU=c6e({BigNumber:Je,Complex:Zn,config:Ve,multiplyScalar:ni,pow:_u,typed:me}),wHe=HIe({conj:Gv,dotDivide:mA,fft:Bre,typed:me}),EHe=g6e({divide:Li,dotDivide:mA,isNumeric:qv,log:DU,map:Zp,matrix:Ze,multiply:On,sum:NU,typed:me}),Ure=_ke({DenseMatrix:Qt,lsolve:Tre,lup:kre,matrix:Ze,slu:Ire,typed:me,usolve:CU}),Vre=ore({add:hn,divide:Li,typed:me}),zre=KVe({add:hn,compare:Xv,divide:Li,partitionSelect:KN,typed:me}),SHe=Eke({add:hn,cbrt:Sre,divide:Li,equalScalar:rn,im:bU,isZero:Pl,multiply:On,re:wU,sqrt:bu,subtract:Vr,typeOf:qN,typed:me,unaryMinus:Lc}),AHe=ure({bignumber:to,add:hn,compare:Xv,divide:Li,isInteger:Sa,larger:Aa,mapSlices:Fw,multiply:On,partitionSelect:KN,smaller:Ta,smallerEq:Tb,subtract:Vr,typed:me}),Mb=qne({bignumber:to,matrix:Ze,add:hn,config:Ve,equal:aa,isPositive:Wv,isZero:Pl,larger:Aa,largerEq:XN,smaller:Ta,smallerEq:Tb,typed:me}),THe=Wne({Index:ea,matrix:Ze,range:Mb,typed:me}),$re=gLe({DenseMatrix:Qt,Index:ea,compareNatural:Oc,size:zi,subset:Go,typed:me}),MHe=SLe({Index:ea,compareNatural:Oc,size:zi,subset:Go,typed:me}),Hre=NLe({Index:ea,concat:Mn,setDifference:$re,size:zi,subset:Go,typed:me}),CHe=KIe({abs:Rs,add:hn,bignumber:to,divide:Li,isNegative:Jp,isPositive:Wv,larger:Aa,map:Zp,matrix:Ze,max:AU,multiply:On,smaller:Ta,subtract:Vr,typed:me,unaryMinus:Lc}),It=oFe({BigNumber:Je,Complex:Zn,Fraction:Qp,abs:Rs,addScalar:Vi,config:Ve,divideScalar:Pr,equal:aa,fix:Lre,format:cA,isNumeric:qv,multiplyScalar:ni,number:Fc,pow:_u,round:Zb,subtractScalar:Il}),DHe=e8e({BigNumber:Je,Unit:It,config:Ve}),NHe=S8e({BigNumber:Je,Unit:It,config:Ve}),RHe=i8e({BigNumber:Je,Unit:It,config:Ve}),IHe=T8e({BigNumber:Je,Unit:It,config:Ve}),Gre=Vne({Index:ea,matrix:Ze,range:Mb,typed:me}),PHe=s8e({BigNumber:Je,Unit:It,config:Ve}),FHe=t8e({BigNumber:Je,Unit:It,config:Ve}),LHe=fFe({Unit:It,typed:me}),OHe=v8e({BigNumber:Je,Unit:It,config:Ve}),jre=TVe({abs:Rs,add:hn,addScalar:Vi,atan:vre,bignumber:to,column:Gre,complex:fv,config:Ve,cos:yU,diag:_re,divideScalar:Pr,dot:WN,equal:aa,flatten:jv,im:bU,inv:Kv,larger:Aa,matrix:Ze,matrixFromColumns:SU,multiply:On,multiplyScalar:ni,number:Fc,qr:TU,re:wU,reshape:Ere,sin:jN,size:zi,smaller:Ta,sqrt:bu,subtract:Vr,typed:me,usolve:CU,usolveAll:Fre}),kHe=d8e({BigNumber:Je,Unit:It,config:Ve}),gA=p6e({gamma:IU,typed:me}),BHe=f8e({BigNumber:Je,Unit:It,config:Ve}),UHe=N8e({BigNumber:Je,Unit:It,config:Ve}),VHe=U8e({BigNumber:Je,Unit:It,config:Ve}),zHe=u8e({BigNumber:Je,Unit:It,config:Ve}),$He=D8e({BigNumber:Je,Unit:It,config:Ve}),HHe=QVe({abs:Rs,map:Zp,median:zre,subtract:Vr,typed:me}),GHe=o8e({BigNumber:Je,Unit:It,config:Ve}),jHe=k8e({BigNumber:Je,Unit:It,config:Ve}),qHe=R8e({BigNumber:Je,Unit:It,config:Ve}),WHe=y6e({add:hn,divide:Li,factorial:gA,isInteger:Sa,isPositive:Wv,multiply:On,typed:me}),PU=BLe({abs:Rs,add:hn,conj:Gv,ctranspose:EU,eigs:jre,equalScalar:rn,larger:Aa,matrix:Ze,multiply:On,pow:_u,smaller:Ta,sqrt:bu,typed:me}),XHe=b6e({factorial:gA,typed:me}),KHe=Yze({BigNumber:Je,Unit:It,config:Ve}),YHe=z8e({BigNumber:Je,Unit:It,config:Ve}),QHe=$8e({BigNumber:Je,Unit:It,config:Ve}),ZHe=Qze({BigNumber:Je,Unit:It,config:Ve}),qre=SIe({BigNumber:Je,DenseMatrix:Qt,SparseMatrix:$i,addScalar:Vi,config:Ve,cos:yU,matrix:Ze,multiplyScalar:ni,norm:PU,sin:jN,typed:me,unaryMinus:Lc}),JHe=b8e({BigNumber:Je,Unit:It,config:Ve}),eGe=F8e({BigNumber:Je,Unit:It,config:Ve}),tGe=CLe({compareNatural:Oc,typed:me}),nGe=Xze({BigNumber:Je,Unit:It,config:Ve}),rGe=L8e({BigNumber:Je,Unit:It,config:Ve}),iGe=_8e({BigNumber:Je,Unit:It,config:Ve}),FU=lre({add:hn,divide:Li,isNaN:Zh,mapSlices:Fw,multiply:On,subtract:Vr,typed:me}),sGe=rPe({BigNumber:Je,Complex:Zn,add:hn,config:Ve,divide:Li,equal:aa,factorial:gA,gamma:IU,isBounded:hA,isNegative:Jp,multiply:On,pi:VO,pow:_u,sin:jN,smallerEq:Tb,subtract:Vr,typed:me}),aGe=A8e({BigNumber:Je,Unit:It,config:Ve}),oGe=c8e({BigNumber:Je,Unit:It,config:Ve}),lGe=n6e({add:hn,divide:Li,matrix:Ze,mean:Vre,multiply:On,pow:_u,sqrt:bu,subtract:Vr,sum:NU,typed:me}),uGe=VPe({DenseMatrix:Qt,SparseMatrix:$i,concat:Mn,equalScalar:rn,matrix:Ze,pow:_u,typed:me}),cGe=r8e({BigNumber:Je,Unit:It,config:Ve}),hGe=M8e({BigNumber:Je,Unit:It,config:Ve}),dGe=m8e({BigNumber:Je,Unit:It,config:Ve}),fGe=a8e({BigNumber:Je,Unit:It,config:Ve}),pGe=Zze({BigNumber:Je,Unit:It,config:Ve}),mGe=B8e({BigNumber:Je,Unit:It,config:Ve}),gGe=y8e({BigNumber:Je,Unit:It,config:Ve}),vGe=H8e({BigNumber:Je,Unit:It,config:Ve}),yGe=G8e({BigNumber:Je,Unit:It,config:Ve}),xGe=x8e({BigNumber:Je,Unit:It,config:Ve}),Wre=bLe({DenseMatrix:Qt,Index:ea,compareNatural:Oc,size:zi,subset:Go,typed:me}),bGe=cre({map:Zp,sqrt:bu,typed:me,variance:FU}),Xre=q6e({bignumber:to,addScalar:Vi,combinations:GN,divideScalar:Pr,factorial:gA,isInteger:Sa,isNegative:Jp,larger:Aa,multiplyScalar:ni,number:Fc,pow:_u,subtractScalar:Il,typed:me}),_Ge=uFe({Unit:It,typed:me}),wGe=X6e({addScalar:Vi,isInteger:Sa,isNegative:Jp,stirlingS2:Xre,typed:me}),EGe=Jze({BigNumber:Je,Unit:It,config:Ve}),SGe=C8e({BigNumber:Je,Unit:It,config:Ve}),AGe=l8e({BigNumber:Je,Unit:It,config:Ve}),TGe=V8e({BigNumber:Je,Unit:It,config:Ve}),MGe=wIe({multiply:On,rotationMatrix:qre,typed:me}),CGe=ILe({Index:ea,concat:Mn,setIntersect:Wre,setSymDifference:Hre,size:zi,subset:Go,typed:me}),DGe=O8e({BigNumber:Je,Unit:It,config:Ve}),NGe=h8e({BigNumber:Je,Unit:It,config:Ve}),RGe=I8e({BigNumber:Je,Unit:It,config:Ve}),Kre=FVe({identity:em,matrix:Ze,multiply:On,norm:PU,qr:TU,subtract:Vr,typed:me}),IGe=n8e({BigNumber:Je,Unit:It,config:Ve}),PGe=Kze({BigNumber:Je,Unit:It,config:Ve}),FGe=g8e({BigNumber:Je,Unit:It,config:Ve}),Yre=IVe({abs:Rs,add:hn,concat:Mn,identity:em,index:Ore,lusolve:Ure,matrix:Ze,matrixFromColumns:SU,multiply:On,range:Mb,schur:Kre,subset:Go,subtract:Vr,transpose:dA,typed:me}),LGe=OVe({matrix:Ze,multiply:On,sylvester:Yre,transpose:dA,typed:me}),Jb={},vA={},Qre={},oa=XLe({mathWithTransform:vA}),e_=bOe({Node:oa}),Ed=wOe({Node:oa}),Yv=SOe({Node:oa}),Zre=COe({Node:oa}),t_=ZLe({Node:oa}),Jre=iOe({Node:oa,ResultSet:pre}),eie=aOe({Node:oa}),tie=TOe({Node:oa}),OGe=Tze({classes:Qre}),LU=Dke({math:Jb,typed:me}),nie=gOe({Node:oa,typed:me}),kGe=mVe({Chain:LU,typed:me}),tm=pOe({Node:oa,isBounded:hA}),n_=yOe({Node:oa,size:zi}),r_=YLe({Node:oa,subset:Go}),rie=nOe({matrix:Ze,Node:oa,subset:Go}),nm=ROe({Unit:It,Node:oa,math:Jb}),rm=POe({Node:oa,SymbolNode:nm,math:Jb}),wu=LOe({AccessorNode:r_,ArrayNode:t_,AssignmentNode:rie,BlockNode:Jre,ConditionalNode:eie,ConstantNode:tm,FunctionAssignmentNode:nie,FunctionNode:rm,IndexNode:n_,ObjectNode:e_,OperatorNode:Ed,ParenthesisNode:Yv,RangeNode:tie,RelationalNode:Zre,SymbolNode:nm,config:Ve,numeric:Sl,typed:me}),iie=fze({ConstantNode:tm,FunctionNode:rm,OperatorNode:Ed,ParenthesisNode:Yv,parse:wu,typed:me}),OU=lze({bignumber:to,fraction:fA,AccessorNode:r_,ArrayNode:t_,ConstantNode:tm,FunctionNode:rm,IndexNode:n_,ObjectNode:e_,OperatorNode:Ed,SymbolNode:nm,config:Ve,isBounded:hA,mathWithTransform:vA,matrix:Ze,typed:me}),BGe=kOe({parse:wu,typed:me}),UGe=eze({parse:wu,typed:me}),kU=cze({AccessorNode:r_,ArrayNode:t_,ConstantNode:tm,FunctionNode:rm,IndexNode:n_,ObjectNode:e_,OperatorNode:Ed,ParenthesisNode:Yv,SymbolNode:nm,add:hn,divide:Li,equal:aa,isZero:Pl,multiply:On,parse:wu,pow:_u,subtract:Vr,typed:me}),yA=UOe({parse:wu,typed:me}),sie=Tke({evaluate:yA}),aie=$Oe({evaluate:yA,parse:wu}),VGe=jOe({Parser:aie,typed:me}),YN=sze({AccessorNode:r_,ArrayNode:t_,ConstantNode:tm,FunctionNode:rm,IndexNode:n_,ObjectNode:e_,OperatorNode:Ed,ParenthesisNode:Yv,SymbolNode:nm,equal:aa,parse:wu,replacer:gre,resolve:iie,simplifyConstant:OU,simplifyCore:kU,typed:me}),zGe=mze({OperatorNode:Ed,parse:wu,simplify:YN,typed:me}),oie=vze({ConstantNode:tm,FunctionNode:rm,OperatorNode:Ed,ParenthesisNode:Yv,SymbolNode:nm,config:Ve,equal:aa,isZero:Pl,numeric:Sl,parse:wu,simplify:YN,typed:me}),$Ge=fVe({Help:sie,mathWithTransform:vA,typed:me}),HGe=xze({bignumber:to,fraction:fA,AccessorNode:r_,ArrayNode:t_,ConstantNode:tm,FunctionNode:rm,IndexNode:n_,ObjectNode:e_,OperatorNode:Ed,ParenthesisNode:Yv,SymbolNode:nm,add:hn,config:Ve,divide:Li,equal:aa,isZero:Pl,mathWithTransform:vA,matrix:Ze,multiply:On,parse:wu,pow:_u,simplify:YN,simplifyConstant:OU,simplifyCore:kU,subtract:Vr,typed:me});li(Jb,{e:Nj,false:d$e,fineStructure:f$e,i:fre,Infinity:p$e,LN10:m$e,LOG10E:g$e,NaN:v$e,null:y$e,phi:x$e,SQRT1_2:_$e,sackurTetrode:w$e,tau:mre,true:E$e,E:Nj,version:S$e,efimovFactor:A$e,LN2:T$e,pi:VO,replacer:gre,reviver:OGe,SQRT2:M$e,typed:me,PI:VO,weakMixingAngle:C$e,abs:Rs,acos:D$e,acot:N$e,acsc:R$e,addScalar:Vi,arg:I$e,asech:P$e,asinh:F$e,atan:vre,atanh:L$e,bigint:O$e,bitNot:k$e,boolean:B$e,clone:U$e,combinations:GN,complex:fv,conj:Gv,cos:yU,cot:V$e,csc:z$e,cube:$$e,equalScalar:rn,erf:H$e,exp:yre,expm1:G$e,filter:j$e,flatten:jv,forEach:q$e,format:cA,getMatrixDataType:xU,hex:W$e,im:bU,isBounded:hA,isNaN:Zh,isNumeric:qv,isPrime:X$e,LOG2E:K$e,lgamma:Y$e,log10:Q$e,log2:_U,map:Zp,mode:Z$e,multiplyScalar:ni,not:r2,number:Fc,oct:J$e,pickRandom:e7e,print:t7e,random:n7e,re:wU,sec:r7e,sign:xre,sin:jN,size:zi,splitUnit:i7e,square:s7e,string:a7e,subtractScalar:Il,tan:o7e,toBest:l7e,typeOf:qN,acosh:u7e,acsch:c7e,asec:h7e,bignumber:to,chain:kGe,combinationsWithRep:d7e,cosh:f7e,csch:p7e,dot:WN,hasNumericValue:m7e,isFinite:g7e,isNegative:Jp,isZero:Pl,matrix:Ze,matrixFromFunction:v7e,multiply:On,ones:y7e,randomInt:x7e,resize:b7e,sech:_7e,sinh:w7e,sparse:E7e,sqrt:bu,squeeze:S7e,tanh:A7e,transpose:dA,xgcd:bre,zeros:Ts,acoth:T7e,asin:M7e,bin:C7e,coth:D7e,ctranspose:EU,diag:_re,equal:aa,fraction:fA,identity:em,isInteger:Sa,kron:N7e,mapSlices:Fw,matrixFromColumns:SU,numeric:Sl,prod:wre,reshape:Ere,round:Zb,unaryMinus:Lc,bernoulli:R7e,cbrt:Sre,concat:Mn,count:I7e,deepEqual:pA,divideScalar:Pr,dotMultiply:P7e,floor:Are,gcd:F7e,isPositive:Wv,larger:Aa,lcm:L7e,leftShift:O7e,lsolve:Tre,max:AU,mod:Mre,nthRoot:k7e,nullish:B7e,or:U7e,qr:TU,rightArithShift:V7e,smaller:Ta,subtract:Vr,to:z7e,unaryPlus:MU,usolve:CU,xor:$7e,add:hn,atan2:H7e,bitAnd:G7e,bitOr:j7e,bitXor:q7e,catalan:W7e,compare:Xv,compareText:Cre,composition:X7e,cross:K7e,det:Dre,diff:Y7e,distance:Q7e,dotDivide:mA,equalText:Z7e,hypot:J7e,intersect:eHe,invmod:tHe,largerEq:XN,log:DU,lsolveAll:nHe,matrixFromRows:rHe,min:iHe,nthRoots:sHe,partitionSelect:KN,rightLogShift:aHe,slu:Ire,subset:Go,sum:NU,trace:oHe,usolveAll:Fre,zpk2tf:lHe,ceil:RU,compareNatural:Oc,cumsum:uHe,fix:Lre,index:Ore,inv:Kv,log1p:cHe,lup:kre,pinv:hHe,pow:_u,setCartesian:dHe,setDistinct:fHe,setIsSubset:pHe,setPowerset:mHe,smallerEq:Tb,sort:gHe,sqrtm:vHe,unequal:yHe,and:xHe,divide:Li,expm:bHe,fft:Bre,freqz:_He,gamma:IU,ifft:wHe,kldivergence:EHe,lusolve:Ure,mean:Vre,median:zre,polynomialRoot:SHe,quantileSeq:AHe,range:Mb,row:THe,setDifference:$re,setMultiplicity:MHe,setSymDifference:Hre,solveODE:CHe,vacuumImpedance:DHe,atomicMass:NHe,bohrMagneton:RHe,boltzmann:IHe,column:Gre,conductanceQuantum:PHe,coulomb:FHe,createUnit:LHe,deuteronMass:OHe,eigs:jre,electronMass:kHe,factorial:gA,fermiCoupling:BHe,gasConstant:UHe,gravity:VHe,klitzing:zHe,loschmidt:$He,mad:HHe,magneticFluxQuantum:GHe,molarMass:jHe,molarPlanckConstant:qHe,multinomial:WHe,norm:PU,permutations:XHe,planckConstant:KHe,planckMass:YHe,planckTime:QHe,reducedPlanckConstant:ZHe,rotationMatrix:qre,rydberg:JHe,secondRadiation:eGe,setSize:tGe,speedOfLight:nGe,stefanBoltzmann:rGe,thomsonCrossSection:iGe,variance:FU,zeta:sGe,avogadro:aGe,bohrRadius:oGe,corr:lGe,dotPow:uGe,elementaryCharge:cGe,faraday:hGe,hartreeEnergy:dGe,inverseConductanceQuantum:fGe,magneticConstant:pGe,molarMassC12:mGe,neutronMass:gGe,parse:wu,planckCharge:vGe,planckTemperature:yGe,quantumOfCirculation:xGe,resolve:iie,setIntersect:Wre,simplifyConstant:OU,std:bGe,stirlingS2:Xre,unit:_Ge,bellNumbers:wGe,compile:BGe,electricConstant:EGe,firstRadiation:SGe,leafCount:UGe,nuclearMagneton:AGe,planckLength:TGe,rotate:MGe,setUnion:CGe,simplifyCore:kU,wienDisplacement:DGe,classicalElectronRadius:NGe,evaluate:yA,molarVolume:RGe,schur:Kre,coulombConstant:IGe,gravitationConstant:PGe,parser:VGe,simplify:YN,symbolicEqual:zGe,derivative:oie,protonMass:FGe,sylvester:Yre,help:$Ge,rationalize:HGe,lyap:LGe,config:Ve});li(vA,Jb,{map:h9e({typed:me}),filter:n9e({typed:me}),forEach:s9e({typed:me}),mapSlices:X8e({isInteger:Sa,typed:me}),and:J9e({add:hn,concat:Mn,equalScalar:rn,matrix:Ze,not:r2,typed:me,zeros:Ts}),cumsum:q9e({add:hn,typed:me,unaryPlus:MU}),nullish:s$e({deepEqual:pA,flatten:jv,matrix:Ze,size:zi,typed:me}),print:Y9e({add:hn,matrix:Ze,typed:me,zeros:Ts}),bitAnd:l$e({add:hn,concat:Mn,equalScalar:rn,matrix:Ze,not:r2,typed:me,zeros:Ts}),concat:F9e({isInteger:Sa,matrix:Ze,typed:me}),diff:O9e({bignumber:to,matrix:Ze,number:Fc,subtract:Vr,typed:me}),max:g9e({config:Ve,isNaN:Zh,larger:Aa,numeric:Sl,typed:me}),min:w9e({config:Ve,isNaN:Zh,numeric:Sl,smaller:Ta,typed:me}),or:n$e({DenseMatrix:Qt,concat:Mn,equalScalar:rn,matrix:Ze,typed:me}),subset:R9e({add:hn,matrix:Ze,typed:me,zeros:Ts}),bitOr:h$e({DenseMatrix:Qt,concat:Mn,equalScalar:rn,matrix:Ze,typed:me}),sum:z9e({add:hn,config:Ve,numeric:Sl,typed:me}),variance:X9e({add:hn,divide:Li,isNaN:Zh,mapSlices:Fw,multiply:On,subtract:Vr,typed:me}),index:l9e({Index:ea,getMatrixDataType:xU}),quantileSeq:G9e({add:hn,bignumber:to,compare:Xv,divide:Li,isInteger:Sa,larger:Aa,mapSlices:Fw,multiply:On,partitionSelect:KN,smaller:Ta,smallerEq:Tb,subtract:Vr,typed:me}),range:A9e({bignumber:to,matrix:Ze,add:hn,config:Ve,equal:aa,isPositive:Wv,isZero:Pl,larger:Aa,largerEq:XN,smaller:Ta,smallerEq:Tb,typed:me}),column:Q8e({Index:ea,matrix:Ze,range:Mb,typed:me}),row:C9e({Index:ea,matrix:Ze,range:Mb,typed:me}),mean:x9e({add:hn,divide:Li,typed:me}),std:U9e({map:Zp,sqrt:bu,typed:me,variance:FU})});li(Qre,{BigNumber:Je,Complex:Zn,Fraction:Qp,Matrix:HN,Node:oa,ObjectNode:e_,OperatorNode:Ed,ParenthesisNode:Yv,Range:b$e,RelationalNode:Zre,ResultSet:pre,ArrayNode:t_,BlockNode:Jre,ConditionalNode:eie,DenseMatrix:Qt,RangeNode:tie,Chain:LU,FunctionAssignmentNode:nie,SparseMatrix:$i,ConstantNode:tm,IndexNode:n_,FibonacciHeap:Nre,ImmutableDenseMatrix:Rre,Index:ea,Spa:Pre,AccessorNode:r_,AssignmentNode:rie,Unit:It,SymbolNode:nm,FunctionNode:rm,Help:sie,Parser:aie});LU.createProxy(Jb);const GGe=[["7","8","9","/"],["4","5","6","*"],["1","2","3","-"],["0",".","=","+"],["(",")","ANS","DEL"]],jGe=[["sin(","cos(","tan(","asin(","acos("],["log(","ln(","exp(","sqrt(","^"],["pi","e","i","abs(","pow("]],qGe=[{label:"det 2x2",snippet:"det([[3,-1],[2,5]])"},{label:"dot ",snippet:"dot([1,2,3],[4,5,6])"},{label:"cross ",snippet:"cross([1,0,0],[0,1,0])"},{label:"|z|",snippet:"abs(3 + 4i)"},{label:"exp(-jw t)",snippet:"exp(-i*2*pi*60*t)"},{label:"sqrt(3)",snippet:"sqrt(3)"}],WGe=[{id:"standard",label:" ",description:"  + ",badge:"Standard"},{id:"roots",label:" ",description:"  ",badge:" "},{id:"derivative",label:" ",description:"/ ",badge:""},{id:"integral",label:" ",description:"Simpson Rule",badge:""},{id:"guide",label:" ",description:"  & ",badge:""}],XGe=(n,e)=>n.reduce((t,r)=>hn(On(t,e),r)),Rj=n=>{if(typeof n=="number")return n.toFixed(6).replace(/\.0+$/,"");const e=n.re||0,t=n.im||0,r=Math.abs(e)<1e-9?"0":e.toFixed(6).replace(/\.0+$/,""),i=Math.abs(t)<1e-9?"0":t.toFixed(6).replace(/\.0+$/,"");if(Math.abs(t)<1e-9)return r;const s=t>=0?"+":"-";return`${r} ${s} ${Math.abs(i)}i`},KGe=n=>{const e=n.map(o=>fv(o,0)),t=e[0];if(aa(t,0))throw new Error("  0   .");const r=e.map(o=>Li(o,t)),i=r.length-1,s=1+Math.max(...r.slice(1).map(o=>Rs(o))),a=Array.from({length:i},(o,l)=>fv({r:s,phi:2*Math.PI*l/i}));for(let o=0;o<80;o++){let l=0;for(let u=0;u<a.length;u++){let c=XGe(r,a[u]),h=fv(1,0);for(let f=0;f<a.length;f++)u!==f&&(h=On(h,Vr(a[u],a[f])));const d=Li(c,h);a[u]=Vr(a[u],d),l=Math.max(l,Rs(d))}if(l<1e-9)break}return a},YGe=(n,e,t,r,i=600)=>{i%2!==0&&(i+=1);const s={},a=(r-t)/i;let o=0;for(let l=0;l<=i;l++){const u=t+l*a;s[e]=u;const c=yA(n,s);l===0||l===i?o+=c:l%2===0?o+=2*c:o+=4*c}return a/3*o};function QGe(){const{isDark:n}=Nl(),[e,t]=xe.useState(""),[r,i]=xe.useState(""),[s,a]=xe.useState([]),[o,l]=xe.useState("1,-3,2"),[u,c]=xe.useState([]),[h,d]=xe.useState(""),[f,p]=xe.useState("x^3 + 2*x"),[m,y]=xe.useState("x"),[v,b]=xe.useState(""),[x,w]=xe.useState("sin(x)"),[_,E]=xe.useState("x"),[A,T]=xe.useState({from:"0",to:"3.14159"}),[S,M]=xe.useState(""),[D,N]=xe.useState(""),[R,O]=xe.useState("standard"),G=n?"bg-gray-900 border-gray-800 text-white":"bg-white border-gray-200 text-gray-900",I=n?"bg-gray-800 hover:bg-gray-700 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900",B=n?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white",$=L=>{if(L==="DEL"){t(se=>se.slice(0,-1));return}if(L==="="){H();return}if(L==="ANS"){s.length>0&&t(se=>se+s[s.length-1].result);return}t(se=>se+L)},H=()=>{if(e.trim())try{const L=e.replace(//g,"pi").replace(//g,"sqrt");let se=yA(L);typeof se=="number"?se=se.toPrecision(10).replace(/\.0+$/,""):qN(se)==="Complex"&&(se=Rj(se)),i(String(se)),a(Z=>[...Z.slice(-9),{expression:e,result:String(se)}])}catch(L){i(`: ${L.message}`)}},Q=()=>{d("");try{const L=o.split(",").map(Z=>Z.trim()).filter(Z=>Z.length>0).map(Z=>Number(Z));if(L.length<2)throw new Error(" 2  . (: 1,-3,2)");if(L.some(Z=>Number.isNaN(Z)))throw new Error("   .");const se=KGe(L);c(se.map(Z=>Rj(Z)))}catch(L){d(L.message),c([])}},ee=()=>{try{const L=oie(f,m).toString();b(`d/d${m} = ${L}`)}catch(L){b(` : ${L.message}`)}},J=()=>{N("");try{const L=Number(A.from),se=Number(A.to);if(Number.isNaN(L)||Number.isNaN(se))throw new Error("  .");if(L===se)throw new Error("  0.");const Z=YGe(x,_,L,se);M(` ${x} d${_} = ${Number(Z).toPrecision(8)}`)}catch(L){N(L.message),M("")}};return k.jsxs("div",{className:"space-y-10",children:[k.jsxs(ct.div,{initial:{opacity:0,y:-30},animate:{opacity:1,y:0},transition:{duration:.5},children:[k.jsx("h1",{className:"text-4xl sm:text-5xl font-bold mb-4 bg-gradient-to-r from-indigo-500 to-blue-500 dark:from-indigo-300 dark:to-blue-300 bg-clip-text text-transparent",children:"  "}),k.jsx("p",{className:`text-sm sm:text-base ${n?"text-gray-300":"text-gray-600"}`,children:"  ,   , /      ."}),k.jsx("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-4 mt-6",children:[{label:" ",value:"  + "},{label:" ",value:" 10 Durand-Kerner"},{label:"/ ",value:"math.js  + Simpson"},{label:"  ",value:"i, det, dot/cross "}].map(L=>k.jsxs("div",{className:`p-4 rounded-2xl border text-sm ${n?"bg-gray-900/70 border-gray-700 text-gray-200":"bg-white border-gray-200 text-gray-700"}`,children:[k.jsx("p",{className:"font-semibold text-xs uppercase tracking-wide text-blue-500",children:L.label}),k.jsx("p",{className:"mt-2 text-base font-medium",children:L.value})]},L.label))})]}),k.jsx("div",{className:"space-y-6",children:k.jsxs(ct.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5},className:`p-6 rounded-3xl border shadow-sm ${G}`,children:[k.jsx("div",{className:"flex flex-wrap gap-3",children:WGe.map(L=>k.jsxs("button",{onClick:()=>O(L.id),className:`flex-1 min-w-[140px] p-4 rounded-2xl border text-left transition ${R===L.id?n?"bg-blue-900/40 border-blue-500 text-white":"bg-blue-50 border-blue-400 text-blue-900":n?"bg-gray-800 border-gray-700 text-gray-200":"bg-white border-gray-200 text-gray-700"}`,children:[k.jsx("p",{className:"text-xs uppercase tracking-wide text-blue-400",children:L.badge}),k.jsx("p",{className:"text-lg font-semibold mt-1",children:L.label}),k.jsx("p",{className:"text-sm mt-1 opacity-80",children:L.description})]},L.id))}),k.jsxs("div",{className:"mt-8",children:[R==="standard"&&k.jsxs("div",{className:"space-y-6",children:[k.jsxs("div",{className:`relative overflow-hidden rounded-2xl p-6 ${n?"bg-gradient-to-br from-gray-900 via-slate-900 to-gray-800":"bg-gradient-to-br from-white via-blue-50 to-blue-100 border border-blue-100"}`,children:[k.jsx("span",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-blue-300",children:"Expression"}),k.jsx("input",{className:`w-full bg-transparent text-right text-3xl font-semibold mt-3 focus:outline-none ${n?"text-white placeholder:text-gray-500":"text-gray-900 placeholder:text-gray-500"}`,value:e,onChange:L=>t(L.target.value),placeholder:"  (: (3+4i)*(2-i) + sin(pi/3))"}),r&&k.jsxs("p",{className:`text-right text-lg font-mono mt-2 ${r.startsWith("")?"text-red-300":"text-emerald-300"}`,children:["= ",r]}),k.jsx("button",{onClick:H,className:`mt-4 px-4 py-2 rounded-full text-sm font-semibold ${B}`,children:" / ENTER"})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx("p",{className:`text-xs font-semibold tracking-wide ${n?"text-gray-400":"text-gray-500"}`,children:"   "}),k.jsx("div",{className:"flex flex-wrap gap-2",children:qGe.map(L=>k.jsx("button",{onClick:()=>$(L.snippet),className:`px-3 py-1.5 rounded-full text-xs font-medium border ${n?"border-gray-700 text-gray-200 hover:bg-gray-800":"border-gray-300 text-gray-700 hover:bg-gray-100"}`,children:L.label},L.label))})]}),k.jsxs("div",{className:"grid gap-5 md:grid-cols-2",children:[k.jsxs("div",{className:`p-4 rounded-2xl border ${n?"border-gray-700 bg-gray-900/40":"border-gray-200 bg-white"}`,children:[k.jsxs("div",{className:"flex items-center justify-between mb-3",children:[k.jsx("h3",{className:"text-lg font-semibold",children:" "}),k.jsx("span",{className:"text-xs text-blue-500",children:"   "})]}),k.jsx("div",{className:"grid grid-cols-4 gap-3",children:GGe.map((L,se)=>k.jsx("div",{className:"contents",children:L.map(Z=>k.jsx("button",{onClick:()=>$(Z==="pi"?"":Z),className:`py-3 rounded-xl font-semibold text-lg transition ${["/","*","-","+","=","ANS"].includes(Z)?B:I}`,children:Z},Z))},`basic-${se}`))})]}),k.jsxs("div",{className:`p-4 rounded-2xl border ${n?"border-gray-700 bg-gray-900/40":"border-gray-200 bg-white"}`,children:[k.jsxs("div",{className:"flex items-center justify-between mb-3",children:[k.jsx("h3",{className:"text-lg font-semibold",children:" "}),k.jsx("span",{className:"text-xs text-blue-500",children:"    "})]}),k.jsx("div",{className:"grid grid-cols-5 gap-3",children:jGe.map((L,se)=>k.jsx("div",{className:"contents",children:L.map(Z=>k.jsx("button",{onClick:()=>$(Z==="pi"?"":Z),className:`py-3 rounded-xl font-semibold text-sm transition ${B}`,children:Z},Z))},`sci-${se}`))}),k.jsx("button",{onClick:H,className:`w-full mt-3 py-3 rounded-xl font-semibold text-lg ${B}`,children:" (=)"})]})]}),k.jsxs("div",{className:`p-5 rounded-2xl border ${n?"border-gray-700 bg-gray-900/40":"border-gray-200 bg-white"}`,children:[k.jsxs("div",{className:"flex items-center justify-between mb-2",children:[k.jsx("p",{className:"font-semibold",children:" 10 "}),k.jsx("button",{onClick:()=>a([]),className:`text-sm ${n?"text-red-300":"text-red-500"}`,children:" "})]}),k.jsxs("div",{className:"max-h-64 overflow-y-auto space-y-2",children:[s.length===0&&k.jsx("p",{className:"text-sm text-gray-500",children:" "}),s.map((L,se)=>k.jsxs("button",{onClick:()=>{t(L.expression),i(L.result)},className:`w-full text-left p-3 rounded-xl ${n?"bg-gray-800 hover:bg-gray-700":"bg-gray-100 hover:bg-gray-200"}`,children:[k.jsx("p",{className:"text-sm break-words",children:L.expression}),k.jsxs("p",{className:"text-sm font-semibold text-green-500",children:["= ",L.result]})]},`${L.expression}-${se}`))]})]})]}),R==="roots"&&k.jsxs("div",{children:[k.jsx("h2",{className:"text-xl font-bold mb-4",children:"  "}),k.jsxs("p",{className:`text-sm mb-3 ${n?"text-gray-300":"text-gray-600"}`,children:["   (: x - 3x + 2  ",k.jsx("span",{className:"font-mono",children:"1,-3,2"}),")"]}),k.jsx("input",{value:o,onChange:L=>l(L.target.value),className:`w-full mb-3 px-4 py-2 rounded-xl border ${n?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`}),k.jsx("button",{onClick:Q,className:`w-full py-3 rounded-xl font-semibold ${B}`,children:" "}),h&&k.jsx("p",{className:"text-sm text-red-400 mt-3",children:h}),u.length>0&&k.jsx("ul",{className:"mt-4 space-y-1 text-sm font-mono",children:u.map((L,se)=>k.jsxs("li",{children:["x",se+1," = ",L]},se))})]}),R==="derivative"&&k.jsxs("div",{children:[k.jsx("h2",{className:"text-xl font-bold mb-4",children:" "}),k.jsx("input",{value:f,onChange:L=>p(L.target.value),className:`w-full mb-3 px-4 py-2 rounded-xl border ${n?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"f(x) = "}),k.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-3",children:[k.jsx("label",{className:"text-sm",children:""}),k.jsx("input",{value:m,onChange:L=>y(L.target.value),className:`w-20 text-center px-2 py-2 rounded-xl border ${n?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`}),k.jsxs("button",{onClick:ee,className:`flex-1 min-w-[140px] py-2 rounded-xl font-semibold ${B}`,children:["d/d",m]})]}),v&&k.jsx("p",{className:"text-sm font-mono text-green-400",children:v})]}),R==="integral"&&k.jsxs("div",{children:[k.jsx("h2",{className:"text-xl font-bold mb-4",children:" "}),k.jsx("input",{value:x,onChange:L=>w(L.target.value),className:`w-full mb-3 px-4 py-2 rounded-xl border ${n?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"f(x)"}),k.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-3",children:[k.jsx("label",{className:"text-sm",children:""}),k.jsx("input",{value:_,onChange:L=>E(L.target.value),className:`w-24 text-center px-3 py-2 rounded-xl border ${n?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`}),k.jsx("input",{value:A.from,onChange:L=>T(se=>({...se,from:L.target.value})),className:`flex-1 min-w-[140px] px-3 py-2 rounded-xl border ${n?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:""}),k.jsx("input",{value:A.to,onChange:L=>T(se=>({...se,to:L.target.value})),className:`flex-1 min-w-[140px] px-3 py-2 rounded-xl border ${n?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:""})]}),k.jsx("button",{onClick:J,className:`w-full py-3 rounded-xl font-semibold ${B}`,children:" "}),D&&k.jsx("p",{className:"text-sm text-red-400 mt-3",children:D}),S&&k.jsx("p",{className:"text-sm font-mono text-green-400 mt-3",children:S})]}),R==="guide"&&k.jsxs("div",{children:[k.jsx("h2",{className:"text-xl font-bold mb-3",children:"  "}),k.jsxs("ul",{className:`text-sm space-y-2 ${n?"text-gray-300":"text-gray-600"}`,children:[k.jsx("li",{children:"   (: (3+4i)*(2-i))"}),k.jsx("li",{children:"   ( 10, Durand-Kerner )"}),k.jsx("li",{children:"   (math.js )"}),k.jsx("li",{children:"   (Simpson rule)"}),k.jsx("li",{children:"    : , e, i, trig/log, pow"})]})]})]})]})})]})}const i2=n=>{const e=n.code||n.message;return{"auth/email-already-in-use":"  .","auth/invalid-email":"   .","auth/weak-password":"  . ( 6)","auth/user-not-found":"  .","auth/wrong-password":" .","auth/too-many-requests":"   .    .","auth/network-request-failed":"  ."}[e]||n.message||"  ."},ZGe=async(n,e,t)=>{try{const r=JSON.parse(localStorage.getItem("firebaseUsers")||"{}"),i=btoa(n);if(r[i])throw new Error("  .");await hee(AD,T4);let s=null,a=!1;try{s=(await Promise.race([Bxe(AD,n,e),new Promise((u,c)=>setTimeout(()=>c(new Error("Firebase timeout")),5e3))])).user}catch(l){if(console.warn("Firebase  :",i2(l)),l.code==="auth/email-already-in-use")throw l;a=!0}const o={uid:(s==null?void 0:s.uid)||"local-"+Date.now(),email:n,password:btoa(e),username:t.username,affiliation:t.affiliation||"",bio:"",created_at:new Date().toISOString(),isLocal:a||!s};return r[i]=o,localStorage.setItem("firebaseUsers",JSON.stringify(r)),{uid:o.uid,email:o.email,username:o.username,isLocal:o.isLocal}}catch(r){throw console.error(" :",r),new Error(i2(r))}},JGe=async(n,e)=>{try{await hee(AD,T4);let t=null,r=!1;try{t=(await Promise.race([Uxe(AD,n,e),new Promise((s,a)=>setTimeout(()=>a(new Error("Firebase timeout")),5e3))])).user}catch(i){console.warn("Firebase  ,   :",i2(i));const s=JSON.parse(localStorage.getItem("firebaseUsers")||"{}"),a=btoa(n);if(s[a]){const o=s[a];if(btoa(e)===o.password)r=!0,t={uid:o.uid,email:o.email,displayName:o.username};else throw new Error(" .")}else throw new Error("  .")}if(!t)throw new Error(" ");return{uid:t.uid,email:t.email,username:t.displayName||n.split("@")[0],isLocal:r}}catch(t){throw console.error(" :",t),new Error(i2(t))}},eje=n=>{localStorage.setItem("currentUser",JSON.stringify(n)),localStorage.setItem("authToken",n.uid)};function tje(){const n=Fb(),{isDark:e}=Nl(),[t,r]=xe.useState({email:"",password:""}),[i,s]=xe.useState(""),[a,o]=xe.useState(!1),l="auto",u=h=>{const{name:d,value:f}=h.target;r(p=>({...p,[d]:f})),s("")},c=async h=>{h.preventDefault(),o(!0),s("");try{if(!t.email||!t.password){s("  ."),o(!1);return}if(!t.email.includes("@")){s("   ."),o(!1);return}let d=null;if(l==="auto"||l==="firebase")try{d=await JGe(t.email,t.password);const f={uid:d.uid,email:d.email,username:d.username,role:"user",authProvider:d.isLocal?"firebase-local":"firebase"};eje(f),localStorage.setItem("user",JSON.stringify(f)),localStorage.setItem("authToken",d.uid),localStorage.setItem("isAuthenticated","true"),console.log(`   (${d.isLocal?" ":"Firebase"}):`),window.dispatchEvent(new Event("auth-change")),setTimeout(()=>n("/"),500);return}catch(f){console.warn("Firebase  :",f.message)}s(" :     .")}catch(d){console.error(" :",d),s("   .")}finally{o(!1)}};return k.jsx("div",{className:`min-h-screen flex items-center justify-center px-4 sm:px-6 lg:px-8 transition-colors duration-200 ${e?"bg-gray-900":"bg-gray-50"}`,children:k.jsxs(ct.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6},className:`w-full max-w-md space-y-8 rounded-lg shadow-lg p-8 transition-colors duration-200 ${e?"bg-gray-800":"bg-white"}`,children:[k.jsxs("div",{className:"text-center",children:[k.jsx(ct.h1,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.1},className:`text-3xl font-bold mb-2 transition-colors duration-200 ${e?"text-white":"text-gray-900"}`,children:""}),k.jsx(ct.p,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.2},className:`transition-colors duration-200 ${e?"text-gray-400":"text-gray-600"}`,children:"   "})]}),i&&k.jsx(ct.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:`p-3 rounded-lg text-sm border-l-4 transition-colors duration-200 ${e?"bg-red-900/30 border-red-600 text-red-200":"bg-red-50 border-red-500 text-red-800"}`,children:i}),k.jsxs(ct.form,{onSubmit:c,className:"space-y-6",initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.3},children:[k.jsxs("div",{children:[k.jsx("label",{htmlFor:"email",className:`block text-sm font-medium mb-2 transition-colors duration-200 ${e?"text-gray-300":"text-gray-700"}`,children:""}),k.jsx(ct.input,{whileFocus:{scale:1.02},type:"email",id:"email",name:"email",value:t.email,onChange:u,placeholder:"your@example.com",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 ${e?"bg-gray-700 border-gray-600 text-white placeholder-gray-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-400"}`})]}),k.jsxs("div",{children:[k.jsx("label",{htmlFor:"password",className:`block text-sm font-medium mb-2 transition-colors duration-200 ${e?"text-gray-300":"text-gray-700"}`,children:""}),k.jsx(ct.input,{whileFocus:{scale:1.02},type:"password",id:"password",name:"password",value:t.password,onChange:u,placeholder:"",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 ${e?"bg-gray-700 border-gray-600 text-white placeholder-gray-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-400"}`})]}),k.jsx(ct.button,{type:"submit",disabled:a,whileHover:{scale:1.02},whileTap:{scale:.98},className:`w-full py-2 px-4 rounded-lg font-medium text-white transition-all duration-200 ${a?"bg-blue-400 cursor-not-allowed opacity-50":"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800"}`,children:a?" ...":""})]}),k.jsxs(ct.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.4},className:`text-center text-sm transition-colors duration-200 ${e?"text-gray-400":"text-gray-600"}`,children:[" ?"," ",k.jsx(hr,{to:"/signup",className:"text-blue-600 hover:text-blue-700 font-medium",children:""})]})]})})}function nje(){const n=Fb(),{isDark:e}=Nl(),[t,r]=xe.useState({username:"",email:"",password:"",confirmPassword:"",affiliation:"",agreeTerms:!1}),[i,s]=xe.useState({}),[a,o]=xe.useState(!1),[l,u]=xe.useState(""),c="auto",h=p=>{const{name:m,value:y,type:v,checked:b}=p.target;r(x=>({...x,[m]:v==="checkbox"?b:y})),i[m]&&s(x=>({...x,[m]:""}))},d=()=>{const p={};return t.username.trim()?t.username.length<3&&(p.username=" 3  ."):p.username=" .",t.email?t.email.includes("@")||(p.email="   ."):p.email=" .",t.password?t.password.length<8?p.password=" 8  .":/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(t.password)||(p.password=" , ,   ."):p.password=" .",t.password!==t.confirmPassword&&(p.confirmPassword="  ."),t.agreeTerms||(p.agreeTerms=" ."),p},f=async p=>{p.preventDefault();const m=d();if(Object.keys(m).length>0){s(m);return}o(!0),u("");try{let y=!1,v=null;if(c==="auto"||c==="firebase")try{const b=await ZGe(t.email,t.password,{username:t.username,affiliation:t.affiliation});console.log("  :",b.username),y=!0}catch(b){console.warn("Firebase  :",b.message),v=b.message}if(!y&&(c==="auto"||c==="local")){const b=JSON.parse(localStorage.getItem("firebaseUsers")||"{}"),x=btoa(t.email);if(b[x]){s({submit:"  ."}),o(!1);return}const w={uid:"local-"+Date.now(),email:t.email,password:btoa(t.password),username:t.username,affiliation:t.affiliation||"",bio:"",created_at:new Date().toISOString(),isLocal:!0};b[x]=w,localStorage.setItem("firebaseUsers",JSON.stringify(b)),console.log("    "),y=!0}y&&(u(" .   ..."),setTimeout(()=>{n("/login")},2e3))}catch(y){console.error(" :",y),s({submit:"   .  ."})}finally{o(!1)}};return k.jsx("div",{className:`min-h-screen flex items-center justify-center px-4 sm:px-6 lg:px-8 transition-colors duration-200 ${e?"bg-gray-900":"bg-gray-50"}`,children:k.jsxs(ct.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6},className:`w-full max-w-md space-y-8 rounded-lg shadow-lg p-8 transition-colors duration-200 ${e?"bg-gray-800":"bg-white"}`,children:[k.jsxs("div",{className:"text-center",children:[k.jsx(ct.h1,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.1},className:`text-3xl font-bold mb-2 transition-colors duration-200 ${e?"text-white":"text-gray-900"}`,children:""}),k.jsx(ct.p,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.2},className:`transition-colors duration-200 ${e?"text-gray-400":"text-gray-600"}`,children:"   "})]}),l&&k.jsx(ct.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg dark:bg-green-900 dark:border-green-700 dark:text-green-200",children:l}),i.submit&&k.jsx(ct.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg dark:bg-red-900 dark:border-red-700 dark:text-red-200",children:i.submit}),k.jsxs(ct.form,{onSubmit:f,className:"space-y-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.3},children:[k.jsxs("div",{children:[k.jsx("label",{htmlFor:"username",className:`block text-sm font-medium mb-2 transition-colors duration-200 ${e?"text-gray-300":"text-gray-700"}`,children:""}),k.jsx(ct.input,{whileFocus:{scale:1.02},type:"text",id:"username",name:"username",value:t.username,onChange:h,placeholder:"  ",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 ${e?"bg-gray-700 border-gray-600 text-white placeholder-gray-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-400"} ${i.username?"border-red-500":""}`}),i.username&&k.jsx("p",{className:"text-red-600 text-sm mt-1 dark:text-red-400",children:i.username})]}),k.jsxs("div",{children:[k.jsx("label",{htmlFor:"email",className:`block text-sm font-medium mb-2 transition-colors duration-200 ${e?"text-gray-300":"text-gray-700"}`,children:""}),k.jsx(ct.input,{whileFocus:{scale:1.02},type:"email",id:"email",name:"email",value:t.email,onChange:h,placeholder:"your@institution.edu",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 ${e?"bg-gray-700 border-gray-600 text-white placeholder-gray-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-400"} ${i.email?"border-red-500":""}`}),i.email&&k.jsx("p",{className:"text-red-600 text-sm mt-1 dark:text-red-400",children:i.email})]}),k.jsxs("div",{children:[k.jsx("label",{htmlFor:"affiliation",className:`block text-sm font-medium mb-2 transition-colors duration-200 ${e?"text-gray-300":"text-gray-700"}`,children:"  ()"}),k.jsx(ct.input,{whileFocus:{scale:1.02},type:"text",id:"affiliation",name:"affiliation",value:t.affiliation,onChange:h,placeholder:",  ",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 ${e?"bg-gray-700 border-gray-600 text-white placeholder-gray-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-400"}`})]}),k.jsxs("div",{children:[k.jsx("label",{htmlFor:"password",className:`block text-sm font-medium mb-2 transition-colors duration-200 ${e?"text-gray-300":"text-gray-700"}`,children:""}),k.jsx(ct.input,{whileFocus:{scale:1.02},type:"password",id:"password",name:"password",value:t.password,onChange:h,placeholder:"",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 ${e?"bg-gray-700 border-gray-600 text-white placeholder-gray-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-400"} ${i.password?"border-red-500":""}`}),k.jsx("p",{className:`text-xs mt-1 transition-colors duration-200 ${e?"text-gray-400":"text-gray-500"}`,children:" 8, // "}),i.password&&k.jsx("p",{className:"text-red-600 text-sm mt-1 dark:text-red-400",children:i.password})]}),k.jsxs("div",{children:[k.jsx("label",{htmlFor:"confirmPassword",className:`block text-sm font-medium mb-2 transition-colors duration-200 ${e?"text-gray-300":"text-gray-700"}`,children:" "}),k.jsx(ct.input,{whileFocus:{scale:1.02},type:"password",id:"confirmPassword",name:"confirmPassword",value:t.confirmPassword,onChange:h,placeholder:"",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 ${e?"bg-gray-700 border-gray-600 text-white placeholder-gray-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-400"} ${i.confirmPassword?"border-red-500":""}`}),i.confirmPassword&&k.jsx("p",{className:"text-red-600 text-sm mt-1 dark:text-red-400",children:i.confirmPassword})]}),k.jsxs("div",{className:"flex items-center",children:[k.jsx("input",{type:"checkbox",id:"agreeTerms",name:"agreeTerms",checked:t.agreeTerms,onChange:h,className:"h-4 w-4 rounded"}),k.jsx("label",{htmlFor:"agreeTerms",className:`ml-3 text-sm transition-colors duration-200 ${e?"text-gray-300":"text-gray-700"}`,children:"   "})]}),i.agreeTerms&&k.jsx("p",{className:"text-red-600 text-sm mt-1 dark:text-red-400",children:i.agreeTerms}),k.jsx(ct.button,{type:"submit",disabled:a,whileHover:{scale:1.02},whileTap:{scale:.98},className:`w-full py-2 px-4 rounded-lg font-medium text-white transition-all duration-200 ${a?"bg-blue-400 cursor-not-allowed opacity-50":"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800"}`,children:a?" ...":""})]}),k.jsxs(ct.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.4},className:`text-center text-sm transition-colors duration-200 ${e?"text-gray-400":"text-gray-600"}`,children:["  ?"," ",k.jsx(hr,{to:"/login",className:"text-blue-600 hover:text-blue-700 font-medium",children:""})]})]})})}const P_=({children:n})=>t3()?n:k.jsx(Uoe,{to:"/login",replace:!0});function rje(){return k.jsx(Joe,{children:k.jsx(Koe,{basename:"/1201-project/",children:k.jsxs($oe,{children:[k.jsx(us,{path:"/login",element:k.jsx(tje,{})}),k.jsx(us,{path:"/signup",element:k.jsx(nje,{})}),k.jsxs(us,{element:k.jsx(ale,{}),children:[k.jsx(us,{path:"/",element:k.jsx(Vde,{})}),k.jsx(us,{path:"/concepts",element:k.jsx(zde,{})}),k.jsx(us,{path:"/concepts/:slug",element:k.jsx(Hde,{})}),k.jsx(us,{path:"/papers",element:k.jsx(R_e,{})}),k.jsx(us,{path:"/visualizations",element:k.jsx(ZTe,{})}),k.jsx(us,{path:"/calculator",element:k.jsx(QGe,{})}),k.jsx(us,{path:"/forum",element:k.jsx(P_,{children:k.jsx(I_e,{})})}),k.jsx(us,{path:"/forum/:postId",element:k.jsx(P_,{children:k.jsx(P_e,{})})}),k.jsx(us,{path:"/profile",element:k.jsx(P_,{children:k.jsx(O_e,{})})}),k.jsx(us,{path:"/bookmarks",element:k.jsx(P_,{children:k.jsx(k_e,{})})}),k.jsx(us,{path:"/notes",element:k.jsx(P_,{children:k.jsx(B_e,{})})}),k.jsx(us,{path:"/glossary",element:k.jsx(F_e,{})}),k.jsx(us,{path:"/references",element:k.jsx(L_e,{})})]})]})})})}sP.createRoot(document.getElementById("root")).render(k.jsx(Hj.StrictMode,{children:k.jsx(rje,{})}));
