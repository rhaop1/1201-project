var die=Object.defineProperty;var u5=n=>{throw TypeError(n)};var fie=(n,e,t)=>e in n?die(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Qe=(n,e,t)=>fie(n,typeof e!="symbol"?e+"":e,t),tR=(n,e,t)=>e.has(n)||u5("Cannot "+t);var g=(n,e,t)=>(tR(n,e,"read from private field"),t?t.call(n):e.get(n)),G=(n,e,t)=>e.has(n)?u5("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),B=(n,e,t,r)=>(tR(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),X=(n,e,t)=>(tR(n,e,"access private method"),t);var Ei=(n,e,t,r)=>({set _(i){B(n,e,i,t)},get _(){return g(n,e,r)}});function pie(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var Iv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function w2(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function mie(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var Nj={exports:{}},E2={},Rj={exports:{}},mn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ES=Symbol.for("react.element"),gie=Symbol.for("react.portal"),vie=Symbol.for("react.fragment"),yie=Symbol.for("react.strict_mode"),xie=Symbol.for("react.profiler"),bie=Symbol.for("react.provider"),_ie=Symbol.for("react.context"),wie=Symbol.for("react.forward_ref"),Eie=Symbol.for("react.suspense"),Sie=Symbol.for("react.memo"),Aie=Symbol.for("react.lazy"),c5=Symbol.iterator;function Tie(n){return n===null||typeof n!="object"?null:(n=c5&&n[c5]||n["@@iterator"],typeof n=="function"?n:null)}var Ij={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Pj=Object.assign,Fj={};function Cb(n,e,t){this.props=n,this.context=e,this.refs=Fj,this.updater=t||Ij}Cb.prototype.isReactComponent={};Cb.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Cb.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function Lj(){}Lj.prototype=Cb.prototype;function VO(n,e,t){this.props=n,this.context=e,this.refs=Fj,this.updater=t||Ij}var zO=VO.prototype=new Lj;zO.constructor=VO;Pj(zO,Cb.prototype);zO.isPureReactComponent=!0;var h5=Array.isArray,Oj=Object.prototype.hasOwnProperty,$O={current:null},kj={key:!0,ref:!0,__self:!0,__source:!0};function Bj(n,e,t){var r,i={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)Oj.call(e,r)&&!kj.hasOwnProperty(r)&&(i[r]=e[r]);var o=arguments.length-2;if(o===1)i.children=t;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(n&&n.defaultProps)for(r in o=n.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:ES,type:n,key:s,ref:a,props:i,_owner:$O.current}}function Mie(n,e){return{$$typeof:ES,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function HO(n){return typeof n=="object"&&n!==null&&n.$$typeof===ES}function Cie(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var d5=/\/+/g;function nR(n,e){return typeof n=="object"&&n!==null&&n.key!=null?Cie(""+n.key):e.toString(36)}function ZT(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case ES:case gie:a=!0}}if(a)return a=n,i=i(a),n=r===""?"."+nR(a,0):r,h5(i)?(t="",n!=null&&(t=n.replace(d5,"$&/")+"/"),ZT(i,e,t,"",function(u){return u})):i!=null&&(HO(i)&&(i=Mie(i,t+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(d5,"$&/")+"/")+n)),e.push(i)),1;if(a=0,r=r===""?".":r+":",h5(n))for(var o=0;o<n.length;o++){s=n[o];var l=r+nR(s,o);a+=ZT(s,e,t,l,i)}else if(l=Tie(n),typeof l=="function")for(n=l.call(n),o=0;!(s=n.next()).done;)s=s.value,l=r+nR(s,o++),a+=ZT(s,e,t,l,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function AA(n,e,t){if(n==null)return n;var r=[],i=0;return ZT(n,r,"","",function(s){return e.call(t,s,i++)}),r}function Die(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Da={current:null},JT={transition:null},Nie={ReactCurrentDispatcher:Da,ReactCurrentBatchConfig:JT,ReactCurrentOwner:$O};function Uj(){throw Error("act(...) is not supported in production builds of React.")}mn.Children={map:AA,forEach:function(n,e,t){AA(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return AA(n,function(){e++}),e},toArray:function(n){return AA(n,function(e){return e})||[]},only:function(n){if(!HO(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};mn.Component=Cb;mn.Fragment=vie;mn.Profiler=xie;mn.PureComponent=VO;mn.StrictMode=yie;mn.Suspense=Eie;mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nie;mn.act=Uj;mn.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=Pj({},n.props),i=n.key,s=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=$O.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var o=n.type.defaultProps;for(l in e)Oj.call(e,l)&&!kj.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];r.children=o}return{$$typeof:ES,type:n.type,key:i,ref:s,props:r,_owner:a}};mn.createContext=function(n){return n={$$typeof:_ie,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:bie,_context:n},n.Consumer=n};mn.createElement=Bj;mn.createFactory=function(n){var e=Bj.bind(null,n);return e.type=n,e};mn.createRef=function(){return{current:null}};mn.forwardRef=function(n){return{$$typeof:wie,render:n}};mn.isValidElement=HO;mn.lazy=function(n){return{$$typeof:Aie,_payload:{_status:-1,_result:n},_init:Die}};mn.memo=function(n,e){return{$$typeof:Sie,type:n,compare:e===void 0?null:e}};mn.startTransition=function(n){var e=JT.transition;JT.transition={};try{n()}finally{JT.transition=e}};mn.unstable_act=Uj;mn.useCallback=function(n,e){return Da.current.useCallback(n,e)};mn.useContext=function(n){return Da.current.useContext(n)};mn.useDebugValue=function(){};mn.useDeferredValue=function(n){return Da.current.useDeferredValue(n)};mn.useEffect=function(n,e){return Da.current.useEffect(n,e)};mn.useId=function(){return Da.current.useId()};mn.useImperativeHandle=function(n,e,t){return Da.current.useImperativeHandle(n,e,t)};mn.useInsertionEffect=function(n,e){return Da.current.useInsertionEffect(n,e)};mn.useLayoutEffect=function(n,e){return Da.current.useLayoutEffect(n,e)};mn.useMemo=function(n,e){return Da.current.useMemo(n,e)};mn.useReducer=function(n,e,t){return Da.current.useReducer(n,e,t)};mn.useRef=function(n){return Da.current.useRef(n)};mn.useState=function(n){return Da.current.useState(n)};mn.useSyncExternalStore=function(n,e,t){return Da.current.useSyncExternalStore(n,e,t)};mn.useTransition=function(){return Da.current.useTransition()};mn.version="18.3.1";Rj.exports=mn;var xe=Rj.exports;const Vj=w2(xe),Rie=pie({__proto__:null,default:Vj},[xe]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iie=xe,Pie=Symbol.for("react.element"),Fie=Symbol.for("react.fragment"),Lie=Object.prototype.hasOwnProperty,Oie=Iie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kie={key:!0,ref:!0,__self:!0,__source:!0};function zj(n,e,t){var r,i={},s=null,a=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)Lie.call(e,r)&&!kie.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:Pie,type:n,key:s,ref:a,props:i,_owner:Oie.current}}E2.Fragment=Fie;E2.jsx=zj;E2.jsxs=zj;Nj.exports=E2;var k=Nj.exports,rP={},$j={exports:{}},$o={},Hj={exports:{}},Gj={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e($,H){var Z=$.length;$.push(H);e:for(;0<Z;){var J=Z-1>>>1,ee=$[J];if(0<i(ee,H))$[J]=H,$[Z]=ee,Z=J;else break e}}function t($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var H=$[0],Z=$.pop();if(Z!==H){$[0]=Z;e:for(var J=0,ee=$.length,O=ee>>>1;J<O;){var ue=2*(J+1)-1,Q=$[ue],re=ue+1,le=$[re];if(0>i(Q,Z))re<ee&&0>i(le,Q)?($[J]=le,$[re]=Z,J=re):($[J]=Q,$[ue]=Z,J=ue);else if(re<ee&&0>i(le,Z))$[J]=le,$[re]=Z,J=re;else break e}}return H}function i($,H){var Z=$.sortIndex-H.sortIndex;return Z!==0?Z:$.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],u=[],c=1,h=null,d=3,f=!1,p=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x($){for(var H=t(u);H!==null;){if(H.callback===null)r(u);else if(H.startTime<=$)r(u),H.sortIndex=H.expirationTime,e(l,H);else break;H=t(u)}}function w($){if(m=!1,x($),!p)if(t(l)!==null)p=!0,I(_);else{var H=t(u);H!==null&&F(w,H.startTime-$)}}function _($,H){p=!1,m&&(m=!1,v(T),T=-1),f=!0;var Z=d;try{for(x(H),h=t(l);h!==null&&(!(h.expirationTime>H)||$&&!D());){var J=h.callback;if(typeof J=="function"){h.callback=null,d=h.priorityLevel;var ee=J(h.expirationTime<=H);H=n.unstable_now(),typeof ee=="function"?h.callback=ee:h===t(l)&&r(l),x(H)}else r(l);h=t(l)}if(h!==null)var O=!0;else{var ue=t(u);ue!==null&&F(w,ue.startTime-H),O=!1}return O}finally{h=null,d=Z,f=!1}}var E=!1,A=null,T=-1,S=5,M=-1;function D(){return!(n.unstable_now()-M<S)}function N(){if(A!==null){var $=n.unstable_now();M=$;var H=!0;try{H=A(!0,$)}finally{H?R():(E=!1,A=null)}}else E=!1}var R;if(typeof b=="function")R=function(){b(N)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,j=z.port2;z.port1.onmessage=N,R=function(){j.postMessage(null)}}else R=function(){y(N,0)};function I($){A=$,E||(E=!0,R())}function F($,H){T=y(function(){$(n.unstable_now())},H)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_continueExecution=function(){p||f||(p=!0,I(_))},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return d},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function($){switch(d){case 1:case 2:case 3:var H=3;break;default:H=d}var Z=d;d=H;try{return $()}finally{d=Z}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function($,H){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var Z=d;d=$;try{return H()}finally{d=Z}},n.unstable_scheduleCallback=function($,H,Z){var J=n.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?J+Z:J):Z=J,$){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=Z+ee,$={id:c++,callback:H,priorityLevel:$,startTime:Z,expirationTime:ee,sortIndex:-1},Z>J?($.sortIndex=Z,e(u,$),t(l)===null&&$===t(u)&&(m?(v(T),T=-1):m=!0,F(w,Z-J))):($.sortIndex=ee,e(l,$),p||f||(p=!0,I(_))),$},n.unstable_shouldYield=D,n.unstable_wrapCallback=function($){var H=d;return function(){var Z=d;d=H;try{return $.apply(this,arguments)}finally{d=Z}}}})(Gj);Hj.exports=Gj;var Bie=Hj.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uie=xe,Vo=Bie;function et(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var jj=new Set,k1={};function Pv(n,e){eb(n,e),eb(n+"Capture",e)}function eb(n,e){for(k1[n]=e,n=0;n<e.length;n++)jj.add(e[n])}var nd=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),iP=Object.prototype.hasOwnProperty,Vie=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f5={},p5={};function zie(n){return iP.call(p5,n)?!0:iP.call(f5,n)?!1:Vie.test(n)?p5[n]=!0:(f5[n]=!0,!1)}function $ie(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function Hie(n,e,t,r){if(e===null||typeof e>"u"||$ie(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Na(n,e,t,r,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Cs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Cs[n]=new Na(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Cs[e]=new Na(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Cs[n]=new Na(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Cs[n]=new Na(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Cs[n]=new Na(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Cs[n]=new Na(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Cs[n]=new Na(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Cs[n]=new Na(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Cs[n]=new Na(n,5,!1,n.toLowerCase(),null,!1,!1)});var GO=/[\-:]([a-z])/g;function jO(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(GO,jO);Cs[e]=new Na(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(GO,jO);Cs[e]=new Na(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(GO,jO);Cs[e]=new Na(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Cs[n]=new Na(n,1,!1,n.toLowerCase(),null,!1,!1)});Cs.xlinkHref=new Na("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Cs[n]=new Na(n,1,!1,n.toLowerCase(),null,!0,!0)});function qO(n,e,t,r){var i=Cs.hasOwnProperty(e)?Cs[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Hie(e,t,i,r)&&(t=null),r||i===null?zie(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var _d=Uie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,TA=Symbol.for("react.element"),U0=Symbol.for("react.portal"),V0=Symbol.for("react.fragment"),WO=Symbol.for("react.strict_mode"),sP=Symbol.for("react.profiler"),qj=Symbol.for("react.provider"),Wj=Symbol.for("react.context"),XO=Symbol.for("react.forward_ref"),aP=Symbol.for("react.suspense"),oP=Symbol.for("react.suspense_list"),KO=Symbol.for("react.memo"),qd=Symbol.for("react.lazy"),Xj=Symbol.for("react.offscreen"),m5=Symbol.iterator;function l_(n){return n===null||typeof n!="object"?null:(n=m5&&n[m5]||n["@@iterator"],typeof n=="function"?n:null)}var Vr=Object.assign,rR;function P_(n){if(rR===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);rR=e&&e[1]||""}return`
`+rR+n}var iR=!1;function sR(n,e){if(!n||iR)return"";iR=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){r=u}n.call(e.prototype)}else{try{throw Error()}catch(u){r=u}n()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=a&&0<=o);break}}}finally{iR=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?P_(n):""}function Gie(n){switch(n.tag){case 5:return P_(n.type);case 16:return P_("Lazy");case 13:return P_("Suspense");case 19:return P_("SuspenseList");case 0:case 2:case 15:return n=sR(n.type,!1),n;case 11:return n=sR(n.type.render,!1),n;case 1:return n=sR(n.type,!0),n;default:return""}}function lP(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case V0:return"Fragment";case U0:return"Portal";case sP:return"Profiler";case WO:return"StrictMode";case aP:return"Suspense";case oP:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Wj:return(n.displayName||"Context")+".Consumer";case qj:return(n._context.displayName||"Context")+".Provider";case XO:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case KO:return e=n.displayName||null,e!==null?e:lP(n.type)||"Memo";case qd:e=n._payload,n=n._init;try{return lP(n(e))}catch{}}return null}function jie(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return lP(e);case 8:return e===WO?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function yp(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Kj(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function qie(n){var e=Kj(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function MA(n){n._valueTracker||(n._valueTracker=qie(n))}function Yj(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=Kj(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function pC(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function uP(n,e){var t=e.checked;return Vr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function g5(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=yp(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Qj(n,e){e=e.checked,e!=null&&qO(n,"checked",e,!1)}function cP(n,e){Qj(n,e);var t=yp(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?hP(n,e.type,t):e.hasOwnProperty("defaultValue")&&hP(n,e.type,yp(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function v5(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function hP(n,e,t){(e!=="number"||pC(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var F_=Array.isArray;function dy(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+yp(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function dP(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(et(91));return Vr({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function y5(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(et(92));if(F_(t)){if(1<t.length)throw Error(et(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:yp(t)}}function Zj(n,e){var t=yp(e.value),r=yp(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function x5(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function Jj(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function fP(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?Jj(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var CA,eq=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(CA=CA||document.createElement("div"),CA.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=CA.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function B1(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var m1={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Wie=["Webkit","ms","Moz","O"];Object.keys(m1).forEach(function(n){Wie.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),m1[e]=m1[n]})});function tq(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||m1.hasOwnProperty(n)&&m1[n]?(""+e).trim():e+"px"}function nq(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=tq(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var Xie=Vr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function pP(n,e){if(e){if(Xie[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(et(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(et(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(et(61))}if(e.style!=null&&typeof e.style!="object")throw Error(et(62))}}function mP(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gP=null;function YO(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var vP=null,fy=null,py=null;function b5(n){if(n=TS(n)){if(typeof vP!="function")throw Error(et(280));var e=n.stateNode;e&&(e=C2(e),vP(n.stateNode,n.type,e))}}function rq(n){fy?py?py.push(n):py=[n]:fy=n}function iq(){if(fy){var n=fy,e=py;if(py=fy=null,b5(n),e)for(n=0;n<e.length;n++)b5(e[n])}}function sq(n,e){return n(e)}function aq(){}var aR=!1;function oq(n,e,t){if(aR)return n(e,t);aR=!0;try{return sq(n,e,t)}finally{aR=!1,(fy!==null||py!==null)&&(aq(),iq())}}function U1(n,e){var t=n.stateNode;if(t===null)return null;var r=C2(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(et(231,e,typeof t));return t}var yP=!1;if(nd)try{var u_={};Object.defineProperty(u_,"passive",{get:function(){yP=!0}}),window.addEventListener("test",u_,u_),window.removeEventListener("test",u_,u_)}catch{yP=!1}function Kie(n,e,t,r,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var g1=!1,mC=null,gC=!1,xP=null,Yie={onError:function(n){g1=!0,mC=n}};function Qie(n,e,t,r,i,s,a,o,l){g1=!1,mC=null,Kie.apply(Yie,arguments)}function Zie(n,e,t,r,i,s,a,o,l){if(Qie.apply(this,arguments),g1){if(g1){var u=mC;g1=!1,mC=null}else throw Error(et(198));gC||(gC=!0,xP=u)}}function Fv(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function lq(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function _5(n){if(Fv(n)!==n)throw Error(et(188))}function Jie(n){var e=n.alternate;if(!e){if(e=Fv(n),e===null)throw Error(et(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return _5(i),n;if(s===r)return _5(i),e;s=s.sibling}throw Error(et(188))}if(t.return!==r.return)t=i,r=s;else{for(var a=!1,o=i.child;o;){if(o===t){a=!0,t=i,r=s;break}if(o===r){a=!0,r=i,t=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===t){a=!0,t=s,r=i;break}if(o===r){a=!0,r=s,t=i;break}o=o.sibling}if(!a)throw Error(et(189))}}if(t.alternate!==r)throw Error(et(190))}if(t.tag!==3)throw Error(et(188));return t.stateNode.current===t?n:e}function uq(n){return n=Jie(n),n!==null?cq(n):null}function cq(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=cq(n);if(e!==null)return e;n=n.sibling}return null}var hq=Vo.unstable_scheduleCallback,w5=Vo.unstable_cancelCallback,ese=Vo.unstable_shouldYield,tse=Vo.unstable_requestPaint,oi=Vo.unstable_now,nse=Vo.unstable_getCurrentPriorityLevel,QO=Vo.unstable_ImmediatePriority,dq=Vo.unstable_UserBlockingPriority,vC=Vo.unstable_NormalPriority,rse=Vo.unstable_LowPriority,fq=Vo.unstable_IdlePriority,S2=null,hc=null;function ise(n){if(hc&&typeof hc.onCommitFiberRoot=="function")try{hc.onCommitFiberRoot(S2,n,void 0,(n.current.flags&128)===128)}catch{}}var cu=Math.clz32?Math.clz32:ose,sse=Math.log,ase=Math.LN2;function ose(n){return n>>>=0,n===0?32:31-(sse(n)/ase|0)|0}var DA=64,NA=4194304;function L_(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function yC(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,a=t&268435455;if(a!==0){var o=a&~i;o!==0?r=L_(o):(s&=a,s!==0&&(r=L_(s)))}else a=t&~i,a!==0?r=L_(a):s!==0&&(r=L_(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-cu(e),i=1<<t,r|=n[t],e&=~i;return r}function lse(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function use(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var a=31-cu(s),o=1<<a,l=i[a];l===-1?(!(o&t)||o&r)&&(i[a]=lse(o,e)):l<=e&&(n.expiredLanes|=o),s&=~o}}function bP(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function pq(){var n=DA;return DA<<=1,!(DA&4194240)&&(DA=64),n}function oR(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function SS(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-cu(e),n[e]=t}function cse(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-cu(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function ZO(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-cu(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var Yn=0;function mq(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var gq,JO,vq,yq,xq,_P=!1,RA=[],ip=null,sp=null,ap=null,V1=new Map,z1=new Map,Qd=[],hse="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function E5(n,e){switch(n){case"focusin":case"focusout":ip=null;break;case"dragenter":case"dragleave":sp=null;break;case"mouseover":case"mouseout":ap=null;break;case"pointerover":case"pointerout":V1.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":z1.delete(e.pointerId)}}function c_(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=TS(e),e!==null&&JO(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function dse(n,e,t,r,i){switch(e){case"focusin":return ip=c_(ip,n,e,t,r,i),!0;case"dragenter":return sp=c_(sp,n,e,t,r,i),!0;case"mouseover":return ap=c_(ap,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return V1.set(s,c_(V1.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,z1.set(s,c_(z1.get(s)||null,n,e,t,r,i)),!0}return!1}function bq(n){var e=km(n.target);if(e!==null){var t=Fv(e);if(t!==null){if(e=t.tag,e===13){if(e=lq(t),e!==null){n.blockedOn=e,xq(n.priority,function(){vq(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function eM(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=wP(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);gP=r,t.target.dispatchEvent(r),gP=null}else return e=TS(t),e!==null&&JO(e),n.blockedOn=t,!1;e.shift()}return!0}function S5(n,e,t){eM(n)&&t.delete(e)}function fse(){_P=!1,ip!==null&&eM(ip)&&(ip=null),sp!==null&&eM(sp)&&(sp=null),ap!==null&&eM(ap)&&(ap=null),V1.forEach(S5),z1.forEach(S5)}function h_(n,e){n.blockedOn===e&&(n.blockedOn=null,_P||(_P=!0,Vo.unstable_scheduleCallback(Vo.unstable_NormalPriority,fse)))}function $1(n){function e(i){return h_(i,n)}if(0<RA.length){h_(RA[0],n);for(var t=1;t<RA.length;t++){var r=RA[t];r.blockedOn===n&&(r.blockedOn=null)}}for(ip!==null&&h_(ip,n),sp!==null&&h_(sp,n),ap!==null&&h_(ap,n),V1.forEach(e),z1.forEach(e),t=0;t<Qd.length;t++)r=Qd[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Qd.length&&(t=Qd[0],t.blockedOn===null);)bq(t),t.blockedOn===null&&Qd.shift()}var my=_d.ReactCurrentBatchConfig,xC=!0;function pse(n,e,t,r){var i=Yn,s=my.transition;my.transition=null;try{Yn=1,ek(n,e,t,r)}finally{Yn=i,my.transition=s}}function mse(n,e,t,r){var i=Yn,s=my.transition;my.transition=null;try{Yn=4,ek(n,e,t,r)}finally{Yn=i,my.transition=s}}function ek(n,e,t,r){if(xC){var i=wP(n,e,t,r);if(i===null)vR(n,e,r,bC,t),E5(n,r);else if(dse(i,n,e,t,r))r.stopPropagation();else if(E5(n,r),e&4&&-1<hse.indexOf(n)){for(;i!==null;){var s=TS(i);if(s!==null&&gq(s),s=wP(n,e,t,r),s===null&&vR(n,e,r,bC,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else vR(n,e,r,null,t)}}var bC=null;function wP(n,e,t,r){if(bC=null,n=YO(r),n=km(n),n!==null)if(e=Fv(n),e===null)n=null;else if(t=e.tag,t===13){if(n=lq(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return bC=n,null}function _q(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nse()){case QO:return 1;case dq:return 4;case vC:case rse:return 16;case fq:return 536870912;default:return 16}default:return 16}}var Qf=null,tk=null,tM=null;function wq(){if(tM)return tM;var n,e=tk,t=e.length,r,i="value"in Qf?Qf.value:Qf.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var a=t-n;for(r=1;r<=a&&e[t-r]===i[s-r];r++);return tM=i.slice(n,1<r?1-r:void 0)}function nM(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function IA(){return!0}function A5(){return!1}function Ho(n){function e(t,r,i,s,a){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?IA:A5,this.isPropagationStopped=A5,this}return Vr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=IA)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=IA)},persist:function(){},isPersistent:IA}),e}var Db={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nk=Ho(Db),AS=Vr({},Db,{view:0,detail:0}),gse=Ho(AS),lR,uR,d_,A2=Vr({},AS,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rk,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==d_&&(d_&&n.type==="mousemove"?(lR=n.screenX-d_.screenX,uR=n.screenY-d_.screenY):uR=lR=0,d_=n),lR)},movementY:function(n){return"movementY"in n?n.movementY:uR}}),T5=Ho(A2),vse=Vr({},A2,{dataTransfer:0}),yse=Ho(vse),xse=Vr({},AS,{relatedTarget:0}),cR=Ho(xse),bse=Vr({},Db,{animationName:0,elapsedTime:0,pseudoElement:0}),_se=Ho(bse),wse=Vr({},Db,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Ese=Ho(wse),Sse=Vr({},Db,{data:0}),M5=Ho(Sse),Ase={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Tse={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Mse={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cse(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=Mse[n])?!!e[n]:!1}function rk(){return Cse}var Dse=Vr({},AS,{key:function(n){if(n.key){var e=Ase[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=nM(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Tse[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rk,charCode:function(n){return n.type==="keypress"?nM(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?nM(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Nse=Ho(Dse),Rse=Vr({},A2,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),C5=Ho(Rse),Ise=Vr({},AS,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rk}),Pse=Ho(Ise),Fse=Vr({},Db,{propertyName:0,elapsedTime:0,pseudoElement:0}),Lse=Ho(Fse),Ose=Vr({},A2,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),kse=Ho(Ose),Bse=[9,13,27,32],ik=nd&&"CompositionEvent"in window,v1=null;nd&&"documentMode"in document&&(v1=document.documentMode);var Use=nd&&"TextEvent"in window&&!v1,Eq=nd&&(!ik||v1&&8<v1&&11>=v1),D5=" ",N5=!1;function Sq(n,e){switch(n){case"keyup":return Bse.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Aq(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var z0=!1;function Vse(n,e){switch(n){case"compositionend":return Aq(e);case"keypress":return e.which!==32?null:(N5=!0,D5);case"textInput":return n=e.data,n===D5&&N5?null:n;default:return null}}function zse(n,e){if(z0)return n==="compositionend"||!ik&&Sq(n,e)?(n=wq(),tM=tk=Qf=null,z0=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Eq&&e.locale!=="ko"?null:e.data;default:return null}}var $se={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function R5(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!$se[n.type]:e==="textarea"}function Tq(n,e,t,r){rq(r),e=_C(e,"onChange"),0<e.length&&(t=new nk("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var y1=null,H1=null;function Hse(n){kq(n,0)}function T2(n){var e=G0(n);if(Yj(e))return n}function Gse(n,e){if(n==="change")return e}var Mq=!1;if(nd){var hR;if(nd){var dR="oninput"in document;if(!dR){var I5=document.createElement("div");I5.setAttribute("oninput","return;"),dR=typeof I5.oninput=="function"}hR=dR}else hR=!1;Mq=hR&&(!document.documentMode||9<document.documentMode)}function P5(){y1&&(y1.detachEvent("onpropertychange",Cq),H1=y1=null)}function Cq(n){if(n.propertyName==="value"&&T2(H1)){var e=[];Tq(e,H1,n,YO(n)),oq(Hse,e)}}function jse(n,e,t){n==="focusin"?(P5(),y1=e,H1=t,y1.attachEvent("onpropertychange",Cq)):n==="focusout"&&P5()}function qse(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return T2(H1)}function Wse(n,e){if(n==="click")return T2(e)}function Xse(n,e){if(n==="input"||n==="change")return T2(e)}function Kse(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var fu=typeof Object.is=="function"?Object.is:Kse;function G1(n,e){if(fu(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!iP.call(e,i)||!fu(n[i],e[i]))return!1}return!0}function F5(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function L5(n,e){var t=F5(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=F5(t)}}function Dq(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?Dq(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function Nq(){for(var n=window,e=pC();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=pC(n.document)}return e}function sk(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function Yse(n){var e=Nq(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&Dq(t.ownerDocument.documentElement,t)){if(r!==null&&sk(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=L5(t,s);var a=L5(t,r);i&&a&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Qse=nd&&"documentMode"in document&&11>=document.documentMode,$0=null,EP=null,x1=null,SP=!1;function O5(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;SP||$0==null||$0!==pC(r)||(r=$0,"selectionStart"in r&&sk(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),x1&&G1(x1,r)||(x1=r,r=_C(EP,"onSelect"),0<r.length&&(e=new nk("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=$0)))}function PA(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var H0={animationend:PA("Animation","AnimationEnd"),animationiteration:PA("Animation","AnimationIteration"),animationstart:PA("Animation","AnimationStart"),transitionend:PA("Transition","TransitionEnd")},fR={},Rq={};nd&&(Rq=document.createElement("div").style,"AnimationEvent"in window||(delete H0.animationend.animation,delete H0.animationiteration.animation,delete H0.animationstart.animation),"TransitionEvent"in window||delete H0.transitionend.transition);function M2(n){if(fR[n])return fR[n];if(!H0[n])return n;var e=H0[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in Rq)return fR[n]=e[t];return n}var Iq=M2("animationend"),Pq=M2("animationiteration"),Fq=M2("animationstart"),Lq=M2("transitionend"),Oq=new Map,k5="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Up(n,e){Oq.set(n,e),Pv(e,[n])}for(var pR=0;pR<k5.length;pR++){var mR=k5[pR],Zse=mR.toLowerCase(),Jse=mR[0].toUpperCase()+mR.slice(1);Up(Zse,"on"+Jse)}Up(Iq,"onAnimationEnd");Up(Pq,"onAnimationIteration");Up(Fq,"onAnimationStart");Up("dblclick","onDoubleClick");Up("focusin","onFocus");Up("focusout","onBlur");Up(Lq,"onTransitionEnd");eb("onMouseEnter",["mouseout","mouseover"]);eb("onMouseLeave",["mouseout","mouseover"]);eb("onPointerEnter",["pointerout","pointerover"]);eb("onPointerLeave",["pointerout","pointerover"]);Pv("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Pv("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Pv("onBeforeInput",["compositionend","keypress","textInput","paste"]);Pv("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Pv("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Pv("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var O_="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eae=new Set("cancel close invalid load scroll toggle".split(" ").concat(O_));function B5(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,Zie(r,e,void 0,n),n.currentTarget=null}function kq(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;B5(i,o,u),s=l}else for(a=0;a<r.length;a++){if(o=r[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;B5(i,o,u),s=l}}}if(gC)throw n=xP,gC=!1,xP=null,n}function _r(n,e){var t=e[DP];t===void 0&&(t=e[DP]=new Set);var r=n+"__bubble";t.has(r)||(Bq(e,n,2,!1),t.add(r))}function gR(n,e,t){var r=0;e&&(r|=4),Bq(t,n,r,e)}var FA="_reactListening"+Math.random().toString(36).slice(2);function j1(n){if(!n[FA]){n[FA]=!0,jj.forEach(function(t){t!=="selectionchange"&&(eae.has(t)||gR(t,!1,n),gR(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[FA]||(e[FA]=!0,gR("selectionchange",!1,e))}}function Bq(n,e,t,r){switch(_q(e)){case 1:var i=pse;break;case 4:i=mse;break;default:i=ek}t=i.bind(null,e,t,n),i=void 0,!yP||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function vR(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=km(o),a===null)return;if(l=a.tag,l===5||l===6){r=s=a;continue e}o=o.parentNode}}r=r.return}oq(function(){var u=s,c=YO(t),h=[];e:{var d=Oq.get(n);if(d!==void 0){var f=nk,p=n;switch(n){case"keypress":if(nM(t)===0)break e;case"keydown":case"keyup":f=Nse;break;case"focusin":p="focus",f=cR;break;case"focusout":p="blur",f=cR;break;case"beforeblur":case"afterblur":f=cR;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=T5;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=yse;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Pse;break;case Iq:case Pq:case Fq:f=_se;break;case Lq:f=Lse;break;case"scroll":f=gse;break;case"wheel":f=kse;break;case"copy":case"cut":case"paste":f=Ese;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=C5}var m=(e&4)!==0,y=!m&&n==="scroll",v=m?d!==null?d+"Capture":null:d;m=[];for(var b=u,x;b!==null;){x=b;var w=x.stateNode;if(x.tag===5&&w!==null&&(x=w,v!==null&&(w=U1(b,v),w!=null&&m.push(q1(b,w,x)))),y)break;b=b.return}0<m.length&&(d=new f(d,p,null,t,c),h.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=n==="mouseover"||n==="pointerover",f=n==="mouseout"||n==="pointerout",d&&t!==gP&&(p=t.relatedTarget||t.fromElement)&&(km(p)||p[rd]))break e;if((f||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=t.relatedTarget||t.toElement,f=u,p=p?km(p):null,p!==null&&(y=Fv(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=u),f!==p)){if(m=T5,w="onMouseLeave",v="onMouseEnter",b="mouse",(n==="pointerout"||n==="pointerover")&&(m=C5,w="onPointerLeave",v="onPointerEnter",b="pointer"),y=f==null?d:G0(f),x=p==null?d:G0(p),d=new m(w,b+"leave",f,t,c),d.target=y,d.relatedTarget=x,w=null,km(c)===u&&(m=new m(v,b+"enter",p,t,c),m.target=x,m.relatedTarget=y,w=m),y=w,f&&p)t:{for(m=f,v=p,b=0,x=m;x;x=i0(x))b++;for(x=0,w=v;w;w=i0(w))x++;for(;0<b-x;)m=i0(m),b--;for(;0<x-b;)v=i0(v),x--;for(;b--;){if(m===v||v!==null&&m===v.alternate)break t;m=i0(m),v=i0(v)}m=null}else m=null;f!==null&&U5(h,d,f,m,!1),p!==null&&y!==null&&U5(h,y,p,m,!0)}}e:{if(d=u?G0(u):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var _=Gse;else if(R5(d))if(Mq)_=Xse;else{_=qse;var E=jse}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(_=Wse);if(_&&(_=_(n,u))){Tq(h,_,t,c);break e}E&&E(n,d,u),n==="focusout"&&(E=d._wrapperState)&&E.controlled&&d.type==="number"&&hP(d,"number",d.value)}switch(E=u?G0(u):window,n){case"focusin":(R5(E)||E.contentEditable==="true")&&($0=E,EP=u,x1=null);break;case"focusout":x1=EP=$0=null;break;case"mousedown":SP=!0;break;case"contextmenu":case"mouseup":case"dragend":SP=!1,O5(h,t,c);break;case"selectionchange":if(Qse)break;case"keydown":case"keyup":O5(h,t,c)}var A;if(ik)e:{switch(n){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else z0?Sq(n,t)&&(T="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(T="onCompositionStart");T&&(Eq&&t.locale!=="ko"&&(z0||T!=="onCompositionStart"?T==="onCompositionEnd"&&z0&&(A=wq()):(Qf=c,tk="value"in Qf?Qf.value:Qf.textContent,z0=!0)),E=_C(u,T),0<E.length&&(T=new M5(T,n,null,t,c),h.push({event:T,listeners:E}),A?T.data=A:(A=Aq(t),A!==null&&(T.data=A)))),(A=Use?Vse(n,t):zse(n,t))&&(u=_C(u,"onBeforeInput"),0<u.length&&(c=new M5("onBeforeInput","beforeinput",null,t,c),h.push({event:c,listeners:u}),c.data=A))}kq(h,e)})}function q1(n,e,t){return{instance:n,listener:e,currentTarget:t}}function _C(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=U1(n,t),s!=null&&r.unshift(q1(n,s,i)),s=U1(n,e),s!=null&&r.push(q1(n,s,i))),n=n.return}return r}function i0(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function U5(n,e,t,r,i){for(var s=e._reactName,a=[];t!==null&&t!==r;){var o=t,l=o.alternate,u=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&u!==null&&(o=u,i?(l=U1(t,s),l!=null&&a.unshift(q1(t,l,o))):i||(l=U1(t,s),l!=null&&a.push(q1(t,l,o)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var tae=/\r\n?/g,nae=/\u0000|\uFFFD/g;function V5(n){return(typeof n=="string"?n:""+n).replace(tae,`
`).replace(nae,"")}function LA(n,e,t){if(e=V5(e),V5(n)!==e&&t)throw Error(et(425))}function wC(){}var AP=null,TP=null;function MP(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var CP=typeof setTimeout=="function"?setTimeout:void 0,rae=typeof clearTimeout=="function"?clearTimeout:void 0,z5=typeof Promise=="function"?Promise:void 0,iae=typeof queueMicrotask=="function"?queueMicrotask:typeof z5<"u"?function(n){return z5.resolve(null).then(n).catch(sae)}:CP;function sae(n){setTimeout(function(){throw n})}function yR(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),$1(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);$1(e)}function op(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function $5(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Nb=Math.random().toString(36).slice(2),ac="__reactFiber$"+Nb,W1="__reactProps$"+Nb,rd="__reactContainer$"+Nb,DP="__reactEvents$"+Nb,aae="__reactListeners$"+Nb,oae="__reactHandles$"+Nb;function km(n){var e=n[ac];if(e)return e;for(var t=n.parentNode;t;){if(e=t[rd]||t[ac]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=$5(n);n!==null;){if(t=n[ac])return t;n=$5(n)}return e}n=t,t=n.parentNode}return null}function TS(n){return n=n[ac]||n[rd],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function G0(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(et(33))}function C2(n){return n[W1]||null}var NP=[],j0=-1;function Vp(n){return{current:n}}function Sr(n){0>j0||(n.current=NP[j0],NP[j0]=null,j0--)}function xr(n,e){j0++,NP[j0]=n.current,n.current=e}var xp={},ea=Vp(xp),Qa=Vp(!1),gv=xp;function tb(n,e){var t=n.type.contextTypes;if(!t)return xp;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function Za(n){return n=n.childContextTypes,n!=null}function EC(){Sr(Qa),Sr(ea)}function H5(n,e,t){if(ea.current!==xp)throw Error(et(168));xr(ea,e),xr(Qa,t)}function Uq(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(et(108,jie(n)||"Unknown",i));return Vr({},t,r)}function SC(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||xp,gv=ea.current,xr(ea,n),xr(Qa,Qa.current),!0}function G5(n,e,t){var r=n.stateNode;if(!r)throw Error(et(169));t?(n=Uq(n,e,gv),r.__reactInternalMemoizedMergedChildContext=n,Sr(Qa),Sr(ea),xr(ea,n)):Sr(Qa),xr(Qa,t)}var th=null,D2=!1,xR=!1;function Vq(n){th===null?th=[n]:th.push(n)}function lae(n){D2=!0,Vq(n)}function zp(){if(!xR&&th!==null){xR=!0;var n=0,e=Yn;try{var t=th;for(Yn=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}th=null,D2=!1}catch(i){throw th!==null&&(th=th.slice(n+1)),hq(QO,zp),i}finally{Yn=e,xR=!1}}return null}var q0=[],W0=0,AC=null,TC=0,pl=[],ml=0,vv=null,Bh=1,Uh="";function wm(n,e){q0[W0++]=TC,q0[W0++]=AC,AC=n,TC=e}function zq(n,e,t){pl[ml++]=Bh,pl[ml++]=Uh,pl[ml++]=vv,vv=n;var r=Bh;n=Uh;var i=32-cu(r)-1;r&=~(1<<i),t+=1;var s=32-cu(e)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Bh=1<<32-cu(e)+i|t<<i|r,Uh=s+n}else Bh=1<<s|t<<i|r,Uh=n}function ak(n){n.return!==null&&(wm(n,1),zq(n,1,0))}function ok(n){for(;n===AC;)AC=q0[--W0],q0[W0]=null,TC=q0[--W0],q0[W0]=null;for(;n===vv;)vv=pl[--ml],pl[ml]=null,Uh=pl[--ml],pl[ml]=null,Bh=pl[--ml],pl[ml]=null}var Bo=null,Oo=null,Dr=!1,ru=null;function $q(n,e){var t=xl(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function j5(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Bo=n,Oo=op(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Bo=n,Oo=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=vv!==null?{id:Bh,overflow:Uh}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=xl(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Bo=n,Oo=null,!0):!1;default:return!1}}function RP(n){return(n.mode&1)!==0&&(n.flags&128)===0}function IP(n){if(Dr){var e=Oo;if(e){var t=e;if(!j5(n,e)){if(RP(n))throw Error(et(418));e=op(t.nextSibling);var r=Bo;e&&j5(n,e)?$q(r,t):(n.flags=n.flags&-4097|2,Dr=!1,Bo=n)}}else{if(RP(n))throw Error(et(418));n.flags=n.flags&-4097|2,Dr=!1,Bo=n}}}function q5(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Bo=n}function OA(n){if(n!==Bo)return!1;if(!Dr)return q5(n),Dr=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!MP(n.type,n.memoizedProps)),e&&(e=Oo)){if(RP(n))throw Hq(),Error(et(418));for(;e;)$q(n,e),e=op(e.nextSibling)}if(q5(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(et(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Oo=op(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Oo=null}}else Oo=Bo?op(n.stateNode.nextSibling):null;return!0}function Hq(){for(var n=Oo;n;)n=op(n.nextSibling)}function nb(){Oo=Bo=null,Dr=!1}function lk(n){ru===null?ru=[n]:ru.push(n)}var uae=_d.ReactCurrentBatchConfig;function f_(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(et(309));var r=t.stateNode}if(!r)throw Error(et(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof n!="string")throw Error(et(284));if(!t._owner)throw Error(et(290,n))}return n}function kA(n,e){throw n=Object.prototype.toString.call(e),Error(et(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function W5(n){var e=n._init;return e(n._payload)}function Gq(n){function e(v,b){if(n){var x=v.deletions;x===null?(v.deletions=[b],v.flags|=16):x.push(b)}}function t(v,b){if(!n)return null;for(;b!==null;)e(v,b),b=b.sibling;return null}function r(v,b){for(v=new Map;b!==null;)b.key!==null?v.set(b.key,b):v.set(b.index,b),b=b.sibling;return v}function i(v,b){return v=hp(v,b),v.index=0,v.sibling=null,v}function s(v,b,x){return v.index=x,n?(x=v.alternate,x!==null?(x=x.index,x<b?(v.flags|=2,b):x):(v.flags|=2,b)):(v.flags|=1048576,b)}function a(v){return n&&v.alternate===null&&(v.flags|=2),v}function o(v,b,x,w){return b===null||b.tag!==6?(b=TR(x,v.mode,w),b.return=v,b):(b=i(b,x),b.return=v,b)}function l(v,b,x,w){var _=x.type;return _===V0?c(v,b,x.props.children,w,x.key):b!==null&&(b.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===qd&&W5(_)===b.type)?(w=i(b,x.props),w.ref=f_(v,b,x),w.return=v,w):(w=uM(x.type,x.key,x.props,null,v.mode,w),w.ref=f_(v,b,x),w.return=v,w)}function u(v,b,x,w){return b===null||b.tag!==4||b.stateNode.containerInfo!==x.containerInfo||b.stateNode.implementation!==x.implementation?(b=MR(x,v.mode,w),b.return=v,b):(b=i(b,x.children||[]),b.return=v,b)}function c(v,b,x,w,_){return b===null||b.tag!==7?(b=uv(x,v.mode,w,_),b.return=v,b):(b=i(b,x),b.return=v,b)}function h(v,b,x){if(typeof b=="string"&&b!==""||typeof b=="number")return b=TR(""+b,v.mode,x),b.return=v,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case TA:return x=uM(b.type,b.key,b.props,null,v.mode,x),x.ref=f_(v,null,b),x.return=v,x;case U0:return b=MR(b,v.mode,x),b.return=v,b;case qd:var w=b._init;return h(v,w(b._payload),x)}if(F_(b)||l_(b))return b=uv(b,v.mode,x,null),b.return=v,b;kA(v,b)}return null}function d(v,b,x,w){var _=b!==null?b.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return _!==null?null:o(v,b,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case TA:return x.key===_?l(v,b,x,w):null;case U0:return x.key===_?u(v,b,x,w):null;case qd:return _=x._init,d(v,b,_(x._payload),w)}if(F_(x)||l_(x))return _!==null?null:c(v,b,x,w,null);kA(v,x)}return null}function f(v,b,x,w,_){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(x)||null,o(b,v,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case TA:return v=v.get(w.key===null?x:w.key)||null,l(b,v,w,_);case U0:return v=v.get(w.key===null?x:w.key)||null,u(b,v,w,_);case qd:var E=w._init;return f(v,b,x,E(w._payload),_)}if(F_(w)||l_(w))return v=v.get(x)||null,c(b,v,w,_,null);kA(b,w)}return null}function p(v,b,x,w){for(var _=null,E=null,A=b,T=b=0,S=null;A!==null&&T<x.length;T++){A.index>T?(S=A,A=null):S=A.sibling;var M=d(v,A,x[T],w);if(M===null){A===null&&(A=S);break}n&&A&&M.alternate===null&&e(v,A),b=s(M,b,T),E===null?_=M:E.sibling=M,E=M,A=S}if(T===x.length)return t(v,A),Dr&&wm(v,T),_;if(A===null){for(;T<x.length;T++)A=h(v,x[T],w),A!==null&&(b=s(A,b,T),E===null?_=A:E.sibling=A,E=A);return Dr&&wm(v,T),_}for(A=r(v,A);T<x.length;T++)S=f(A,v,T,x[T],w),S!==null&&(n&&S.alternate!==null&&A.delete(S.key===null?T:S.key),b=s(S,b,T),E===null?_=S:E.sibling=S,E=S);return n&&A.forEach(function(D){return e(v,D)}),Dr&&wm(v,T),_}function m(v,b,x,w){var _=l_(x);if(typeof _!="function")throw Error(et(150));if(x=_.call(x),x==null)throw Error(et(151));for(var E=_=null,A=b,T=b=0,S=null,M=x.next();A!==null&&!M.done;T++,M=x.next()){A.index>T?(S=A,A=null):S=A.sibling;var D=d(v,A,M.value,w);if(D===null){A===null&&(A=S);break}n&&A&&D.alternate===null&&e(v,A),b=s(D,b,T),E===null?_=D:E.sibling=D,E=D,A=S}if(M.done)return t(v,A),Dr&&wm(v,T),_;if(A===null){for(;!M.done;T++,M=x.next())M=h(v,M.value,w),M!==null&&(b=s(M,b,T),E===null?_=M:E.sibling=M,E=M);return Dr&&wm(v,T),_}for(A=r(v,A);!M.done;T++,M=x.next())M=f(A,v,T,M.value,w),M!==null&&(n&&M.alternate!==null&&A.delete(M.key===null?T:M.key),b=s(M,b,T),E===null?_=M:E.sibling=M,E=M);return n&&A.forEach(function(N){return e(v,N)}),Dr&&wm(v,T),_}function y(v,b,x,w){if(typeof x=="object"&&x!==null&&x.type===V0&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case TA:e:{for(var _=x.key,E=b;E!==null;){if(E.key===_){if(_=x.type,_===V0){if(E.tag===7){t(v,E.sibling),b=i(E,x.props.children),b.return=v,v=b;break e}}else if(E.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===qd&&W5(_)===E.type){t(v,E.sibling),b=i(E,x.props),b.ref=f_(v,E,x),b.return=v,v=b;break e}t(v,E);break}else e(v,E);E=E.sibling}x.type===V0?(b=uv(x.props.children,v.mode,w,x.key),b.return=v,v=b):(w=uM(x.type,x.key,x.props,null,v.mode,w),w.ref=f_(v,b,x),w.return=v,v=w)}return a(v);case U0:e:{for(E=x.key;b!==null;){if(b.key===E)if(b.tag===4&&b.stateNode.containerInfo===x.containerInfo&&b.stateNode.implementation===x.implementation){t(v,b.sibling),b=i(b,x.children||[]),b.return=v,v=b;break e}else{t(v,b);break}else e(v,b);b=b.sibling}b=MR(x,v.mode,w),b.return=v,v=b}return a(v);case qd:return E=x._init,y(v,b,E(x._payload),w)}if(F_(x))return p(v,b,x,w);if(l_(x))return m(v,b,x,w);kA(v,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,b!==null&&b.tag===6?(t(v,b.sibling),b=i(b,x),b.return=v,v=b):(t(v,b),b=TR(x,v.mode,w),b.return=v,v=b),a(v)):t(v,b)}return y}var rb=Gq(!0),jq=Gq(!1),MC=Vp(null),CC=null,X0=null,uk=null;function ck(){uk=X0=CC=null}function hk(n){var e=MC.current;Sr(MC),n._currentValue=e}function PP(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function gy(n,e){CC=n,uk=X0=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Xa=!0),n.firstContext=null)}function Tl(n){var e=n._currentValue;if(uk!==n)if(n={context:n,memoizedValue:e,next:null},X0===null){if(CC===null)throw Error(et(308));X0=n,CC.dependencies={lanes:0,firstContext:n}}else X0=X0.next=n;return e}var Bm=null;function dk(n){Bm===null?Bm=[n]:Bm.push(n)}function qq(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,dk(e)):(t.next=i.next,i.next=t),e.interleaved=t,id(n,r)}function id(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Wd=!1;function fk(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Wq(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function jh(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function lp(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,In&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,id(n,t)}return i=r.interleaved,i===null?(e.next=e,dk(r)):(e.next=i.next,i.next=e),r.interleaved=e,id(n,t)}function rM(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,ZO(n,t)}}function X5(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=a:s=s.next=a,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function DC(n,e,t,r){var i=n.updateQueue;Wd=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var c=n.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==a&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,c=u=l=null,o=s;do{var d=o.lane,f=o.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=n,m=o;switch(d=e,f=t,m.tag){case 1:if(p=m.payload,typeof p=="function"){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,d=typeof p=="function"?p.call(f,h,d):p,d==null)break e;h=Vr({},h,d);break e;case 2:Wd=!0}}o.callback!==null&&o.lane!==0&&(n.flags|=64,d=i.effects,d===null?i.effects=[o]:d.push(o))}else f={eventTime:f,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=f,l=h):c=c.next=f,a|=d;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;d=o,o=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(c===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);xv|=a,n.lanes=a,n.memoizedState=h}}function K5(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(et(191,i));i.call(r)}}}var MS={},dc=Vp(MS),X1=Vp(MS),K1=Vp(MS);function Um(n){if(n===MS)throw Error(et(174));return n}function pk(n,e){switch(xr(K1,e),xr(X1,n),xr(dc,MS),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:fP(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=fP(e,n)}Sr(dc),xr(dc,e)}function ib(){Sr(dc),Sr(X1),Sr(K1)}function Xq(n){Um(K1.current);var e=Um(dc.current),t=fP(e,n.type);e!==t&&(xr(X1,n),xr(dc,t))}function mk(n){X1.current===n&&(Sr(dc),Sr(X1))}var Lr=Vp(0);function NC(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var bR=[];function gk(){for(var n=0;n<bR.length;n++)bR[n]._workInProgressVersionPrimary=null;bR.length=0}var iM=_d.ReactCurrentDispatcher,_R=_d.ReactCurrentBatchConfig,yv=0,kr=null,Ci=null,rs=null,RC=!1,b1=!1,Y1=0,cae=0;function Ps(){throw Error(et(321))}function vk(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!fu(n[t],e[t]))return!1;return!0}function yk(n,e,t,r,i,s){if(yv=s,kr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,iM.current=n===null||n.memoizedState===null?pae:mae,n=t(r,i),b1){s=0;do{if(b1=!1,Y1=0,25<=s)throw Error(et(301));s+=1,rs=Ci=null,e.updateQueue=null,iM.current=gae,n=t(r,i)}while(b1)}if(iM.current=IC,e=Ci!==null&&Ci.next!==null,yv=0,rs=Ci=kr=null,RC=!1,e)throw Error(et(300));return n}function xk(){var n=Y1!==0;return Y1=0,n}function Fu(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rs===null?kr.memoizedState=rs=n:rs=rs.next=n,rs}function Ml(){if(Ci===null){var n=kr.alternate;n=n!==null?n.memoizedState:null}else n=Ci.next;var e=rs===null?kr.memoizedState:rs.next;if(e!==null)rs=e,Ci=n;else{if(n===null)throw Error(et(310));Ci=n,n={memoizedState:Ci.memoizedState,baseState:Ci.baseState,baseQueue:Ci.baseQueue,queue:Ci.queue,next:null},rs===null?kr.memoizedState=rs=n:rs=rs.next=n}return rs}function Q1(n,e){return typeof e=="function"?e(n):e}function wR(n){var e=Ml(),t=e.queue;if(t===null)throw Error(et(311));t.lastRenderedReducer=n;var r=Ci,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var o=a=null,l=null,u=s;do{var c=u.lane;if((yv&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:n(r,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=h,a=r):l=l.next=h,kr.lanes|=c,xv|=c}u=u.next}while(u!==null&&u!==s);l===null?a=r:l.next=o,fu(r,e.memoizedState)||(Xa=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,kr.lanes|=s,xv|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function ER(n){var e=Ml(),t=e.queue;if(t===null)throw Error(et(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var a=i=i.next;do s=n(s,a.action),a=a.next;while(a!==i);fu(s,e.memoizedState)||(Xa=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function Kq(){}function Yq(n,e){var t=kr,r=Ml(),i=e(),s=!fu(r.memoizedState,i);if(s&&(r.memoizedState=i,Xa=!0),r=r.queue,bk(Jq.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||rs!==null&&rs.memoizedState.tag&1){if(t.flags|=2048,Z1(9,Zq.bind(null,t,r,i,e),void 0,null),ss===null)throw Error(et(349));yv&30||Qq(t,e,i)}return i}function Qq(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=kr.updateQueue,e===null?(e={lastEffect:null,stores:null},kr.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function Zq(n,e,t,r){e.value=t,e.getSnapshot=r,eW(e)&&tW(n)}function Jq(n,e,t){return t(function(){eW(e)&&tW(n)})}function eW(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!fu(n,t)}catch{return!0}}function tW(n){var e=id(n,1);e!==null&&hu(e,n,1,-1)}function Y5(n){var e=Fu();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Q1,lastRenderedState:n},e.queue=n,n=n.dispatch=fae.bind(null,kr,n),[e.memoizedState,n]}function Z1(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=kr.updateQueue,e===null?(e={lastEffect:null,stores:null},kr.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function nW(){return Ml().memoizedState}function sM(n,e,t,r){var i=Fu();kr.flags|=n,i.memoizedState=Z1(1|e,t,void 0,r===void 0?null:r)}function N2(n,e,t,r){var i=Ml();r=r===void 0?null:r;var s=void 0;if(Ci!==null){var a=Ci.memoizedState;if(s=a.destroy,r!==null&&vk(r,a.deps)){i.memoizedState=Z1(e,t,s,r);return}}kr.flags|=n,i.memoizedState=Z1(1|e,t,s,r)}function Q5(n,e){return sM(8390656,8,n,e)}function bk(n,e){return N2(2048,8,n,e)}function rW(n,e){return N2(4,2,n,e)}function iW(n,e){return N2(4,4,n,e)}function sW(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function aW(n,e,t){return t=t!=null?t.concat([n]):null,N2(4,4,sW.bind(null,e,n),t)}function _k(){}function oW(n,e){var t=Ml();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&vk(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function lW(n,e){var t=Ml();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&vk(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function uW(n,e,t){return yv&21?(fu(t,e)||(t=pq(),kr.lanes|=t,xv|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Xa=!0),n.memoizedState=t)}function hae(n,e){var t=Yn;Yn=t!==0&&4>t?t:4,n(!0);var r=_R.transition;_R.transition={};try{n(!1),e()}finally{Yn=t,_R.transition=r}}function cW(){return Ml().memoizedState}function dae(n,e,t){var r=cp(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},hW(n))dW(e,t);else if(t=qq(n,e,t,r),t!==null){var i=_a();hu(t,n,r,i),fW(t,e,r)}}function fae(n,e,t){var r=cp(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(hW(n))dW(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,t);if(i.hasEagerState=!0,i.eagerState=o,fu(o,a)){var l=e.interleaved;l===null?(i.next=i,dk(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}t=qq(n,e,i,r),t!==null&&(i=_a(),hu(t,n,r,i),fW(t,e,r))}}function hW(n){var e=n.alternate;return n===kr||e!==null&&e===kr}function dW(n,e){b1=RC=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function fW(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,ZO(n,t)}}var IC={readContext:Tl,useCallback:Ps,useContext:Ps,useEffect:Ps,useImperativeHandle:Ps,useInsertionEffect:Ps,useLayoutEffect:Ps,useMemo:Ps,useReducer:Ps,useRef:Ps,useState:Ps,useDebugValue:Ps,useDeferredValue:Ps,useTransition:Ps,useMutableSource:Ps,useSyncExternalStore:Ps,useId:Ps,unstable_isNewReconciler:!1},pae={readContext:Tl,useCallback:function(n,e){return Fu().memoizedState=[n,e===void 0?null:e],n},useContext:Tl,useEffect:Q5,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,sM(4194308,4,sW.bind(null,e,n),t)},useLayoutEffect:function(n,e){return sM(4194308,4,n,e)},useInsertionEffect:function(n,e){return sM(4,2,n,e)},useMemo:function(n,e){var t=Fu();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Fu();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=dae.bind(null,kr,n),[r.memoizedState,n]},useRef:function(n){var e=Fu();return n={current:n},e.memoizedState=n},useState:Y5,useDebugValue:_k,useDeferredValue:function(n){return Fu().memoizedState=n},useTransition:function(){var n=Y5(!1),e=n[0];return n=hae.bind(null,n[1]),Fu().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=kr,i=Fu();if(Dr){if(t===void 0)throw Error(et(407));t=t()}else{if(t=e(),ss===null)throw Error(et(349));yv&30||Qq(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,Q5(Jq.bind(null,r,s,n),[n]),r.flags|=2048,Z1(9,Zq.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=Fu(),e=ss.identifierPrefix;if(Dr){var t=Uh,r=Bh;t=(r&~(1<<32-cu(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Y1++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=cae++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},mae={readContext:Tl,useCallback:oW,useContext:Tl,useEffect:bk,useImperativeHandle:aW,useInsertionEffect:rW,useLayoutEffect:iW,useMemo:lW,useReducer:wR,useRef:nW,useState:function(){return wR(Q1)},useDebugValue:_k,useDeferredValue:function(n){var e=Ml();return uW(e,Ci.memoizedState,n)},useTransition:function(){var n=wR(Q1)[0],e=Ml().memoizedState;return[n,e]},useMutableSource:Kq,useSyncExternalStore:Yq,useId:cW,unstable_isNewReconciler:!1},gae={readContext:Tl,useCallback:oW,useContext:Tl,useEffect:bk,useImperativeHandle:aW,useInsertionEffect:rW,useLayoutEffect:iW,useMemo:lW,useReducer:ER,useRef:nW,useState:function(){return ER(Q1)},useDebugValue:_k,useDeferredValue:function(n){var e=Ml();return Ci===null?e.memoizedState=n:uW(e,Ci.memoizedState,n)},useTransition:function(){var n=ER(Q1)[0],e=Ml().memoizedState;return[n,e]},useMutableSource:Kq,useSyncExternalStore:Yq,useId:cW,unstable_isNewReconciler:!1};function Hl(n,e){if(n&&n.defaultProps){e=Vr({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function FP(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Vr({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var R2={isMounted:function(n){return(n=n._reactInternals)?Fv(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=_a(),i=cp(n),s=jh(r,i);s.payload=e,t!=null&&(s.callback=t),e=lp(n,s,i),e!==null&&(hu(e,n,i,r),rM(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=_a(),i=cp(n),s=jh(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=lp(n,s,i),e!==null&&(hu(e,n,i,r),rM(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=_a(),r=cp(n),i=jh(t,r);i.tag=2,e!=null&&(i.callback=e),e=lp(n,i,r),e!==null&&(hu(e,n,r,t),rM(e,n,r))}};function Z5(n,e,t,r,i,s,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!G1(t,r)||!G1(i,s):!0}function pW(n,e,t){var r=!1,i=xp,s=e.contextType;return typeof s=="object"&&s!==null?s=Tl(s):(i=Za(e)?gv:ea.current,r=e.contextTypes,s=(r=r!=null)?tb(n,i):xp),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=R2,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function J5(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&R2.enqueueReplaceState(e,e.state,null)}function LP(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},fk(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Tl(s):(s=Za(e)?gv:ea.current,i.context=tb(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(FP(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&R2.enqueueReplaceState(i,i.state,null),DC(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function sb(n,e){try{var t="",r=e;do t+=Gie(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function SR(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function OP(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var vae=typeof WeakMap=="function"?WeakMap:Map;function mW(n,e,t){t=jh(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){FC||(FC=!0,qP=r),OP(n,e)},t}function gW(n,e,t){t=jh(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){OP(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){OP(n,e),typeof r!="function"&&(up===null?up=new Set([this]):up.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function eV(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new vae;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=Rae.bind(null,n,e,t),e.then(n,n))}function tV(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function nV(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=jh(-1,1),e.tag=2,lp(t,e,1))),t.lanes|=1),n)}var yae=_d.ReactCurrentOwner,Xa=!1;function ya(n,e,t,r){e.child=n===null?jq(e,null,t,r):rb(e,n.child,t,r)}function rV(n,e,t,r,i){t=t.render;var s=e.ref;return gy(e,i),r=yk(n,e,t,r,s,i),t=xk(),n!==null&&!Xa?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,sd(n,e,i)):(Dr&&t&&ak(e),e.flags|=1,ya(n,e,r,i),e.child)}function iV(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!Dk(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,vW(n,e,s,r,i)):(n=uM(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var a=s.memoizedProps;if(t=t.compare,t=t!==null?t:G1,t(a,r)&&n.ref===e.ref)return sd(n,e,i)}return e.flags|=1,n=hp(s,r),n.ref=e.ref,n.return=e,e.child=n}function vW(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(G1(s,r)&&n.ref===e.ref)if(Xa=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(Xa=!0);else return e.lanes=n.lanes,sd(n,e,i)}return kP(n,e,t,r,i)}function yW(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},xr(Y0,Do),Do|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,xr(Y0,Do),Do|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,xr(Y0,Do),Do|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,xr(Y0,Do),Do|=r;return ya(n,e,i,t),e.child}function xW(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function kP(n,e,t,r,i){var s=Za(t)?gv:ea.current;return s=tb(e,s),gy(e,i),t=yk(n,e,t,r,s,i),r=xk(),n!==null&&!Xa?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,sd(n,e,i)):(Dr&&r&&ak(e),e.flags|=1,ya(n,e,t,i),e.child)}function sV(n,e,t,r,i){if(Za(t)){var s=!0;SC(e)}else s=!1;if(gy(e,i),e.stateNode===null)aM(n,e),pW(e,t,r),LP(e,t,r,i),r=!0;else if(n===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=t.contextType;typeof u=="object"&&u!==null?u=Tl(u):(u=Za(t)?gv:ea.current,u=tb(e,u));var c=t.getDerivedStateFromProps,h=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||l!==u)&&J5(e,a,r,u),Wd=!1;var d=e.memoizedState;a.state=d,DC(e,r,a,i),l=e.memoizedState,o!==r||d!==l||Qa.current||Wd?(typeof c=="function"&&(FP(e,t,c,r),l=e.memoizedState),(o=Wd||Z5(e,t,o,r,d,l,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),a.props=r,a.state=l,a.context=u,r=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,Wq(n,e),o=e.memoizedProps,u=e.type===e.elementType?o:Hl(e.type,o),a.props=u,h=e.pendingProps,d=a.context,l=t.contextType,typeof l=="object"&&l!==null?l=Tl(l):(l=Za(t)?gv:ea.current,l=tb(e,l));var f=t.getDerivedStateFromProps;(c=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&J5(e,a,r,l),Wd=!1,d=e.memoizedState,a.state=d,DC(e,r,a,i);var p=e.memoizedState;o!==h||d!==p||Qa.current||Wd?(typeof f=="function"&&(FP(e,t,f,r),p=e.memoizedState),(u=Wd||Z5(e,t,u,r,d,p,l)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,p,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,p,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),a.props=r,a.state=p,a.context=l,r=u):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),r=!1)}return BP(n,e,t,r,s,i)}function BP(n,e,t,r,i,s){xW(n,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&G5(e,t,!1),sd(n,e,s);r=e.stateNode,yae.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&a?(e.child=rb(e,n.child,null,s),e.child=rb(e,null,o,s)):ya(n,e,o,s),e.memoizedState=r.state,i&&G5(e,t,!0),e.child}function bW(n){var e=n.stateNode;e.pendingContext?H5(n,e.pendingContext,e.pendingContext!==e.context):e.context&&H5(n,e.context,!1),pk(n,e.containerInfo)}function aV(n,e,t,r,i){return nb(),lk(i),e.flags|=256,ya(n,e,t,r),e.child}var UP={dehydrated:null,treeContext:null,retryLane:0};function VP(n){return{baseLanes:n,cachePool:null,transitions:null}}function _W(n,e,t){var r=e.pendingProps,i=Lr.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=n!==null&&n.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),xr(Lr,i&1),n===null)return IP(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,n=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=F2(a,r,0,null),n=uv(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=VP(t),e.memoizedState=UP,n):wk(e,a));if(i=n.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return xae(n,e,a,r,o,i,t);if(s){s=r.fallback,a=e.mode,i=n.child,o=i.sibling;var l={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=hp(i,l),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=hp(o,s):(s=uv(s,a,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=n.child.memoizedState,a=a===null?VP(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=n.childLanes&~t,e.memoizedState=UP,r}return s=n.child,n=s.sibling,r=hp(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function wk(n,e){return e=F2({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function BA(n,e,t,r){return r!==null&&lk(r),rb(e,n.child,null,t),n=wk(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function xae(n,e,t,r,i,s,a){if(t)return e.flags&256?(e.flags&=-257,r=SR(Error(et(422))),BA(n,e,a,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=F2({mode:"visible",children:r.children},i,0,null),s=uv(s,i,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&rb(e,n.child,null,a),e.child.memoizedState=VP(a),e.memoizedState=UP,s);if(!(e.mode&1))return BA(n,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(et(419)),r=SR(s,r,void 0),BA(n,e,a,r)}if(o=(a&n.childLanes)!==0,Xa||o){if(r=ss,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,id(n,i),hu(r,n,i,-1))}return Ck(),r=SR(Error(et(421))),BA(n,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=Iae.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,Oo=op(i.nextSibling),Bo=e,Dr=!0,ru=null,n!==null&&(pl[ml++]=Bh,pl[ml++]=Uh,pl[ml++]=vv,Bh=n.id,Uh=n.overflow,vv=e),e=wk(e,r.children),e.flags|=4096,e)}function oV(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),PP(n.return,e,t)}function AR(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function wW(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(ya(n,e,r.children,t),r=Lr.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&oV(n,t,e);else if(n.tag===19)oV(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(xr(Lr,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&NC(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),AR(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&NC(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}AR(e,!0,t,null,s);break;case"together":AR(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function aM(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function sd(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),xv|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(et(153));if(e.child!==null){for(n=e.child,t=hp(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=hp(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function bae(n,e,t){switch(e.tag){case 3:bW(e),nb();break;case 5:Xq(e);break;case 1:Za(e.type)&&SC(e);break;case 4:pk(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;xr(MC,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(xr(Lr,Lr.current&1),e.flags|=128,null):t&e.child.childLanes?_W(n,e,t):(xr(Lr,Lr.current&1),n=sd(n,e,t),n!==null?n.sibling:null);xr(Lr,Lr.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return wW(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),xr(Lr,Lr.current),r)break;return null;case 22:case 23:return e.lanes=0,yW(n,e,t)}return sd(n,e,t)}var EW,zP,SW,AW;EW=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};zP=function(){};SW=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Um(dc.current);var s=null;switch(t){case"input":i=uP(n,i),r=uP(n,r),s=[];break;case"select":i=Vr({},i,{value:void 0}),r=Vr({},r,{value:void 0}),s=[];break;case"textarea":i=dP(n,i),r=dP(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=wC)}pP(t,r);var a;t=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(k1.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(o=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(t||(t={}),t[a]=l[a])}else t||(s||(s=[]),s.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(k1.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&_r("scroll",n),s||o===l||(s=[])):(s=s||[]).push(u,l))}t&&(s=s||[]).push("style",t);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};AW=function(n,e,t,r){t!==r&&(e.flags|=4)};function p_(n,e){if(!Dr)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Fs(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function _ae(n,e,t){var r=e.pendingProps;switch(ok(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fs(e),null;case 1:return Za(e.type)&&EC(),Fs(e),null;case 3:return r=e.stateNode,ib(),Sr(Qa),Sr(ea),gk(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(OA(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ru!==null&&(KP(ru),ru=null))),zP(n,e),Fs(e),null;case 5:mk(e);var i=Um(K1.current);if(t=e.type,n!==null&&e.stateNode!=null)SW(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(et(166));return Fs(e),null}if(n=Um(dc.current),OA(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[ac]=e,r[W1]=s,n=(e.mode&1)!==0,t){case"dialog":_r("cancel",r),_r("close",r);break;case"iframe":case"object":case"embed":_r("load",r);break;case"video":case"audio":for(i=0;i<O_.length;i++)_r(O_[i],r);break;case"source":_r("error",r);break;case"img":case"image":case"link":_r("error",r),_r("load",r);break;case"details":_r("toggle",r);break;case"input":g5(r,s),_r("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},_r("invalid",r);break;case"textarea":y5(r,s),_r("invalid",r)}pP(t,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&LA(r.textContent,o,n),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&LA(r.textContent,o,n),i=["children",""+o]):k1.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&_r("scroll",r)}switch(t){case"input":MA(r),v5(r,s,!0);break;case"textarea":MA(r),x5(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=wC)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Jj(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=a.createElement(t,{is:r.is}):(n=a.createElement(t),t==="select"&&(a=n,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):n=a.createElementNS(n,t),n[ac]=e,n[W1]=r,EW(n,e,!1,!1),e.stateNode=n;e:{switch(a=mP(t,r),t){case"dialog":_r("cancel",n),_r("close",n),i=r;break;case"iframe":case"object":case"embed":_r("load",n),i=r;break;case"video":case"audio":for(i=0;i<O_.length;i++)_r(O_[i],n);i=r;break;case"source":_r("error",n),i=r;break;case"img":case"image":case"link":_r("error",n),_r("load",n),i=r;break;case"details":_r("toggle",n),i=r;break;case"input":g5(n,r),i=uP(n,r),_r("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=Vr({},r,{value:void 0}),_r("invalid",n);break;case"textarea":y5(n,r),i=dP(n,r),_r("invalid",n);break;default:i=r}pP(t,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?nq(n,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&eq(n,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&B1(n,l):typeof l=="number"&&B1(n,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(k1.hasOwnProperty(s)?l!=null&&s==="onScroll"&&_r("scroll",n):l!=null&&qO(n,s,l,a))}switch(t){case"input":MA(n),v5(n,r,!1);break;case"textarea":MA(n),x5(n);break;case"option":r.value!=null&&n.setAttribute("value",""+yp(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?dy(n,!!r.multiple,s,!1):r.defaultValue!=null&&dy(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=wC)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Fs(e),null;case 6:if(n&&e.stateNode!=null)AW(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(et(166));if(t=Um(K1.current),Um(dc.current),OA(e)){if(r=e.stateNode,t=e.memoizedProps,r[ac]=e,(s=r.nodeValue!==t)&&(n=Bo,n!==null))switch(n.tag){case 3:LA(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&LA(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[ac]=e,e.stateNode=r}return Fs(e),null;case 13:if(Sr(Lr),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Dr&&Oo!==null&&e.mode&1&&!(e.flags&128))Hq(),nb(),e.flags|=98560,s=!1;else if(s=OA(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(et(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(et(317));s[ac]=e}else nb(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Fs(e),s=!1}else ru!==null&&(KP(ru),ru=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Lr.current&1?Ni===0&&(Ni=3):Ck())),e.updateQueue!==null&&(e.flags|=4),Fs(e),null);case 4:return ib(),zP(n,e),n===null&&j1(e.stateNode.containerInfo),Fs(e),null;case 10:return hk(e.type._context),Fs(e),null;case 17:return Za(e.type)&&EC(),Fs(e),null;case 19:if(Sr(Lr),s=e.memoizedState,s===null)return Fs(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)p_(s,!1);else{if(Ni!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(a=NC(n),a!==null){for(e.flags|=128,p_(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,n=a.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return xr(Lr,Lr.current&1|2),e.child}n=n.sibling}s.tail!==null&&oi()>ab&&(e.flags|=128,r=!0,p_(s,!1),e.lanes=4194304)}else{if(!r)if(n=NC(a),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),p_(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Dr)return Fs(e),null}else 2*oi()-s.renderingStartTime>ab&&t!==1073741824&&(e.flags|=128,r=!0,p_(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(t=s.last,t!==null?t.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=oi(),e.sibling=null,t=Lr.current,xr(Lr,r?t&1|2:t&1),e):(Fs(e),null);case 22:case 23:return Mk(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Do&1073741824&&(Fs(e),e.subtreeFlags&6&&(e.flags|=8192)):Fs(e),null;case 24:return null;case 25:return null}throw Error(et(156,e.tag))}function wae(n,e){switch(ok(e),e.tag){case 1:return Za(e.type)&&EC(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return ib(),Sr(Qa),Sr(ea),gk(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return mk(e),null;case 13:if(Sr(Lr),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(et(340));nb()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Sr(Lr),null;case 4:return ib(),null;case 10:return hk(e.type._context),null;case 22:case 23:return Mk(),null;case 24:return null;default:return null}}var UA=!1,Ws=!1,Eae=typeof WeakSet=="function"?WeakSet:Set,gt=null;function K0(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Kr(n,e,r)}else t.current=null}function $P(n,e,t){try{t()}catch(r){Kr(n,e,r)}}var lV=!1;function Sae(n,e){if(AP=xC,n=Nq(),sk(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var a=0,o=-1,l=-1,u=0,c=0,h=n,d=null;t:for(;;){for(var f;h!==t||i!==0&&h.nodeType!==3||(o=a+i),h!==s||r!==0&&h.nodeType!==3||(l=a+r),h.nodeType===3&&(a+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===n)break t;if(d===t&&++u===i&&(o=a),d===s&&++c===r&&(l=a),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(TP={focusedElem:n,selectionRange:t},xC=!1,gt=e;gt!==null;)if(e=gt,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,gt=n;else for(;gt!==null;){e=gt;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,y=p.memoizedState,v=e.stateNode,b=v.getSnapshotBeforeUpdate(e.elementType===e.type?m:Hl(e.type,m),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(et(163))}}catch(w){Kr(e,e.return,w)}if(n=e.sibling,n!==null){n.return=e.return,gt=n;break}gt=e.return}return p=lV,lV=!1,p}function _1(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&$P(e,t,s)}i=i.next}while(i!==r)}}function I2(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function HP(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function TW(n){var e=n.alternate;e!==null&&(n.alternate=null,TW(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[ac],delete e[W1],delete e[DP],delete e[aae],delete e[oae])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function MW(n){return n.tag===5||n.tag===3||n.tag===4}function uV(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||MW(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function GP(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=wC));else if(r!==4&&(n=n.child,n!==null))for(GP(n,e,t),n=n.sibling;n!==null;)GP(n,e,t),n=n.sibling}function jP(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(jP(n,e,t),n=n.sibling;n!==null;)jP(n,e,t),n=n.sibling}var ms=null,nu=!1;function Ld(n,e,t){for(t=t.child;t!==null;)CW(n,e,t),t=t.sibling}function CW(n,e,t){if(hc&&typeof hc.onCommitFiberUnmount=="function")try{hc.onCommitFiberUnmount(S2,t)}catch{}switch(t.tag){case 5:Ws||K0(t,e);case 6:var r=ms,i=nu;ms=null,Ld(n,e,t),ms=r,nu=i,ms!==null&&(nu?(n=ms,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):ms.removeChild(t.stateNode));break;case 18:ms!==null&&(nu?(n=ms,t=t.stateNode,n.nodeType===8?yR(n.parentNode,t):n.nodeType===1&&yR(n,t),$1(n)):yR(ms,t.stateNode));break;case 4:r=ms,i=nu,ms=t.stateNode.containerInfo,nu=!0,Ld(n,e,t),ms=r,nu=i;break;case 0:case 11:case 14:case 15:if(!Ws&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&$P(t,e,a),i=i.next}while(i!==r)}Ld(n,e,t);break;case 1:if(!Ws&&(K0(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(o){Kr(t,e,o)}Ld(n,e,t);break;case 21:Ld(n,e,t);break;case 22:t.mode&1?(Ws=(r=Ws)||t.memoizedState!==null,Ld(n,e,t),Ws=r):Ld(n,e,t);break;default:Ld(n,e,t)}}function cV(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new Eae),e.forEach(function(r){var i=Pae.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function Fl(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:ms=o.stateNode,nu=!1;break e;case 3:ms=o.stateNode.containerInfo,nu=!0;break e;case 4:ms=o.stateNode.containerInfo,nu=!0;break e}o=o.return}if(ms===null)throw Error(et(160));CW(s,a,i),ms=null,nu=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Kr(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)DW(e,n),e=e.sibling}function DW(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Fl(e,n),Cu(n),r&4){try{_1(3,n,n.return),I2(3,n)}catch(m){Kr(n,n.return,m)}try{_1(5,n,n.return)}catch(m){Kr(n,n.return,m)}}break;case 1:Fl(e,n),Cu(n),r&512&&t!==null&&K0(t,t.return);break;case 5:if(Fl(e,n),Cu(n),r&512&&t!==null&&K0(t,t.return),n.flags&32){var i=n.stateNode;try{B1(i,"")}catch(m){Kr(n,n.return,m)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,a=t!==null?t.memoizedProps:s,o=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Qj(i,s),mP(o,a);var u=mP(o,s);for(a=0;a<l.length;a+=2){var c=l[a],h=l[a+1];c==="style"?nq(i,h):c==="dangerouslySetInnerHTML"?eq(i,h):c==="children"?B1(i,h):qO(i,c,h,u)}switch(o){case"input":cP(i,s);break;case"textarea":Zj(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?dy(i,!!s.multiple,f,!1):d!==!!s.multiple&&(s.defaultValue!=null?dy(i,!!s.multiple,s.defaultValue,!0):dy(i,!!s.multiple,s.multiple?[]:"",!1))}i[W1]=s}catch(m){Kr(n,n.return,m)}}break;case 6:if(Fl(e,n),Cu(n),r&4){if(n.stateNode===null)throw Error(et(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(m){Kr(n,n.return,m)}}break;case 3:if(Fl(e,n),Cu(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{$1(e.containerInfo)}catch(m){Kr(n,n.return,m)}break;case 4:Fl(e,n),Cu(n);break;case 13:Fl(e,n),Cu(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Ak=oi())),r&4&&cV(n);break;case 22:if(c=t!==null&&t.memoizedState!==null,n.mode&1?(Ws=(u=Ws)||c,Fl(e,n),Ws=u):Fl(e,n),Cu(n),r&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!c&&n.mode&1)for(gt=n,c=n.child;c!==null;){for(h=gt=c;gt!==null;){switch(d=gt,f=d.child,d.tag){case 0:case 11:case 14:case 15:_1(4,d,d.return);break;case 1:K0(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){r=d,t=d.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Kr(r,t,m)}}break;case 5:K0(d,d.return);break;case 22:if(d.memoizedState!==null){dV(h);continue}}f!==null?(f.return=d,gt=f):dV(h)}c=c.sibling}e:for(c=null,h=n;;){if(h.tag===5){if(c===null){c=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=tq("display",a))}catch(m){Kr(n,n.return,m)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(m){Kr(n,n.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Fl(e,n),Cu(n),r&4&&cV(n);break;case 21:break;default:Fl(e,n),Cu(n)}}function Cu(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(MW(t)){var r=t;break e}t=t.return}throw Error(et(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(B1(i,""),r.flags&=-33);var s=uV(n);jP(n,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,o=uV(n);GP(n,o,a);break;default:throw Error(et(161))}}catch(l){Kr(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function Aae(n,e,t){gt=n,NW(n)}function NW(n,e,t){for(var r=(n.mode&1)!==0;gt!==null;){var i=gt,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||UA;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Ws;o=UA;var u=Ws;if(UA=a,(Ws=l)&&!u)for(gt=i;gt!==null;)a=gt,l=a.child,a.tag===22&&a.memoizedState!==null?fV(i):l!==null?(l.return=a,gt=l):fV(i);for(;s!==null;)gt=s,NW(s),s=s.sibling;gt=i,UA=o,Ws=u}hV(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,gt=s):hV(n)}}function hV(n){for(;gt!==null;){var e=gt;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ws||I2(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ws)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Hl(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&K5(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}K5(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&$1(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(et(163))}Ws||e.flags&512&&HP(e)}catch(d){Kr(e,e.return,d)}}if(e===n){gt=null;break}if(t=e.sibling,t!==null){t.return=e.return,gt=t;break}gt=e.return}}function dV(n){for(;gt!==null;){var e=gt;if(e===n){gt=null;break}var t=e.sibling;if(t!==null){t.return=e.return,gt=t;break}gt=e.return}}function fV(n){for(;gt!==null;){var e=gt;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{I2(4,e)}catch(l){Kr(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Kr(e,i,l)}}var s=e.return;try{HP(e)}catch(l){Kr(e,s,l)}break;case 5:var a=e.return;try{HP(e)}catch(l){Kr(e,a,l)}}}catch(l){Kr(e,e.return,l)}if(e===n){gt=null;break}var o=e.sibling;if(o!==null){o.return=e.return,gt=o;break}gt=e.return}}var Tae=Math.ceil,PC=_d.ReactCurrentDispatcher,Ek=_d.ReactCurrentOwner,_l=_d.ReactCurrentBatchConfig,In=0,ss=null,vi=null,As=0,Do=0,Y0=Vp(0),Ni=0,J1=null,xv=0,P2=0,Sk=0,w1=null,qa=null,Ak=0,ab=1/0,Qc=null,FC=!1,qP=null,up=null,VA=!1,Zf=null,LC=0,E1=0,WP=null,oM=-1,lM=0;function _a(){return In&6?oi():oM!==-1?oM:oM=oi()}function cp(n){return n.mode&1?In&2&&As!==0?As&-As:uae.transition!==null?(lM===0&&(lM=pq()),lM):(n=Yn,n!==0||(n=window.event,n=n===void 0?16:_q(n.type)),n):1}function hu(n,e,t,r){if(50<E1)throw E1=0,WP=null,Error(et(185));SS(n,t,r),(!(In&2)||n!==ss)&&(n===ss&&(!(In&2)&&(P2|=t),Ni===4&&Zd(n,As)),Ja(n,r),t===1&&In===0&&!(e.mode&1)&&(ab=oi()+500,D2&&zp()))}function Ja(n,e){var t=n.callbackNode;use(n,e);var r=yC(n,n===ss?As:0);if(r===0)t!==null&&w5(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&w5(t),e===1)n.tag===0?lae(pV.bind(null,n)):Vq(pV.bind(null,n)),iae(function(){!(In&6)&&zp()}),t=null;else{switch(mq(r)){case 1:t=QO;break;case 4:t=dq;break;case 16:t=vC;break;case 536870912:t=fq;break;default:t=vC}t=BW(t,RW.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function RW(n,e){if(oM=-1,lM=0,In&6)throw Error(et(327));var t=n.callbackNode;if(vy()&&n.callbackNode!==t)return null;var r=yC(n,n===ss?As:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=OC(n,r);else{e=r;var i=In;In|=2;var s=PW();(ss!==n||As!==e)&&(Qc=null,ab=oi()+500,lv(n,e));do try{Dae();break}catch(o){IW(n,o)}while(!0);ck(),PC.current=s,In=i,vi!==null?e=0:(ss=null,As=0,e=Ni)}if(e!==0){if(e===2&&(i=bP(n),i!==0&&(r=i,e=XP(n,i))),e===1)throw t=J1,lv(n,0),Zd(n,r),Ja(n,oi()),t;if(e===6)Zd(n,r);else{if(i=n.current.alternate,!(r&30)&&!Mae(i)&&(e=OC(n,r),e===2&&(s=bP(n),s!==0&&(r=s,e=XP(n,s))),e===1))throw t=J1,lv(n,0),Zd(n,r),Ja(n,oi()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(et(345));case 2:Em(n,qa,Qc);break;case 3:if(Zd(n,r),(r&130023424)===r&&(e=Ak+500-oi(),10<e)){if(yC(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){_a(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=CP(Em.bind(null,n,qa,Qc),e);break}Em(n,qa,Qc);break;case 4:if(Zd(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var a=31-cu(r);s=1<<a,a=e[a],a>i&&(i=a),r&=~s}if(r=i,r=oi()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Tae(r/1960))-r,10<r){n.timeoutHandle=CP(Em.bind(null,n,qa,Qc),r);break}Em(n,qa,Qc);break;case 5:Em(n,qa,Qc);break;default:throw Error(et(329))}}}return Ja(n,oi()),n.callbackNode===t?RW.bind(null,n):null}function XP(n,e){var t=w1;return n.current.memoizedState.isDehydrated&&(lv(n,e).flags|=256),n=OC(n,e),n!==2&&(e=qa,qa=t,e!==null&&KP(e)),n}function KP(n){qa===null?qa=n:qa.push.apply(qa,n)}function Mae(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!fu(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Zd(n,e){for(e&=~Sk,e&=~P2,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-cu(e),r=1<<t;n[t]=-1,e&=~r}}function pV(n){if(In&6)throw Error(et(327));vy();var e=yC(n,0);if(!(e&1))return Ja(n,oi()),null;var t=OC(n,e);if(n.tag!==0&&t===2){var r=bP(n);r!==0&&(e=r,t=XP(n,r))}if(t===1)throw t=J1,lv(n,0),Zd(n,e),Ja(n,oi()),t;if(t===6)throw Error(et(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Em(n,qa,Qc),Ja(n,oi()),null}function Tk(n,e){var t=In;In|=1;try{return n(e)}finally{In=t,In===0&&(ab=oi()+500,D2&&zp())}}function bv(n){Zf!==null&&Zf.tag===0&&!(In&6)&&vy();var e=In;In|=1;var t=_l.transition,r=Yn;try{if(_l.transition=null,Yn=1,n)return n()}finally{Yn=r,_l.transition=t,In=e,!(In&6)&&zp()}}function Mk(){Do=Y0.current,Sr(Y0)}function lv(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,rae(t)),vi!==null)for(t=vi.return;t!==null;){var r=t;switch(ok(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&EC();break;case 3:ib(),Sr(Qa),Sr(ea),gk();break;case 5:mk(r);break;case 4:ib();break;case 13:Sr(Lr);break;case 19:Sr(Lr);break;case 10:hk(r.type._context);break;case 22:case 23:Mk()}t=t.return}if(ss=n,vi=n=hp(n.current,null),As=Do=e,Ni=0,J1=null,Sk=P2=xv=0,qa=w1=null,Bm!==null){for(e=0;e<Bm.length;e++)if(t=Bm[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}t.pending=r}Bm=null}return n}function IW(n,e){do{var t=vi;try{if(ck(),iM.current=IC,RC){for(var r=kr.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}RC=!1}if(yv=0,rs=Ci=kr=null,b1=!1,Y1=0,Ek.current=null,t===null||t.return===null){Ni=1,J1=e,vi=null;break}e:{var s=n,a=t.return,o=t,l=e;if(e=As,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=tV(a);if(f!==null){f.flags&=-257,nV(f,a,o,s,e),f.mode&1&&eV(s,u,e),e=f,l=u;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){eV(s,u,e),Ck();break e}l=Error(et(426))}}else if(Dr&&o.mode&1){var y=tV(a);if(y!==null){!(y.flags&65536)&&(y.flags|=256),nV(y,a,o,s,e),lk(sb(l,o));break e}}s=l=sb(l,o),Ni!==4&&(Ni=2),w1===null?w1=[s]:w1.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=mW(s,l,e);X5(s,v);break e;case 1:o=l;var b=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof b.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(up===null||!up.has(x)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=gW(s,o,e);X5(s,w);break e}}s=s.return}while(s!==null)}LW(t)}catch(_){e=_,vi===t&&t!==null&&(vi=t=t.return);continue}break}while(!0)}function PW(){var n=PC.current;return PC.current=IC,n===null?IC:n}function Ck(){(Ni===0||Ni===3||Ni===2)&&(Ni=4),ss===null||!(xv&268435455)&&!(P2&268435455)||Zd(ss,As)}function OC(n,e){var t=In;In|=2;var r=PW();(ss!==n||As!==e)&&(Qc=null,lv(n,e));do try{Cae();break}catch(i){IW(n,i)}while(!0);if(ck(),In=t,PC.current=r,vi!==null)throw Error(et(261));return ss=null,As=0,Ni}function Cae(){for(;vi!==null;)FW(vi)}function Dae(){for(;vi!==null&&!ese();)FW(vi)}function FW(n){var e=kW(n.alternate,n,Do);n.memoizedProps=n.pendingProps,e===null?LW(n):vi=e,Ek.current=null}function LW(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=wae(t,e),t!==null){t.flags&=32767,vi=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Ni=6,vi=null;return}}else if(t=_ae(t,e,Do),t!==null){vi=t;return}if(e=e.sibling,e!==null){vi=e;return}vi=e=n}while(e!==null);Ni===0&&(Ni=5)}function Em(n,e,t){var r=Yn,i=_l.transition;try{_l.transition=null,Yn=1,Nae(n,e,t,r)}finally{_l.transition=i,Yn=r}return null}function Nae(n,e,t,r){do vy();while(Zf!==null);if(In&6)throw Error(et(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(et(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(cse(n,s),n===ss&&(vi=ss=null,As=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||VA||(VA=!0,BW(vC,function(){return vy(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=_l.transition,_l.transition=null;var a=Yn;Yn=1;var o=In;In|=4,Ek.current=null,Sae(n,t),DW(t,n),Yse(TP),xC=!!AP,TP=AP=null,n.current=t,Aae(t),tse(),In=o,Yn=a,_l.transition=s}else n.current=t;if(VA&&(VA=!1,Zf=n,LC=i),s=n.pendingLanes,s===0&&(up=null),ise(t.stateNode),Ja(n,oi()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(FC)throw FC=!1,n=qP,qP=null,n;return LC&1&&n.tag!==0&&vy(),s=n.pendingLanes,s&1?n===WP?E1++:(E1=0,WP=n):E1=0,zp(),null}function vy(){if(Zf!==null){var n=mq(LC),e=_l.transition,t=Yn;try{if(_l.transition=null,Yn=16>n?16:n,Zf===null)var r=!1;else{if(n=Zf,Zf=null,LC=0,In&6)throw Error(et(331));var i=In;for(In|=4,gt=n.current;gt!==null;){var s=gt,a=s.child;if(gt.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(gt=u;gt!==null;){var c=gt;switch(c.tag){case 0:case 11:case 15:_1(8,c,s)}var h=c.child;if(h!==null)h.return=c,gt=h;else for(;gt!==null;){c=gt;var d=c.sibling,f=c.return;if(TW(c),c===u){gt=null;break}if(d!==null){d.return=f,gt=d;break}gt=f}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(m!==null)}}gt=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,gt=a;else e:for(;gt!==null;){if(s=gt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:_1(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,gt=v;break e}gt=s.return}}var b=n.current;for(gt=b;gt!==null;){a=gt;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,gt=x;else e:for(a=b;gt!==null;){if(o=gt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:I2(9,o)}}catch(_){Kr(o,o.return,_)}if(o===a){gt=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,gt=w;break e}gt=o.return}}if(In=i,zp(),hc&&typeof hc.onPostCommitFiberRoot=="function")try{hc.onPostCommitFiberRoot(S2,n)}catch{}r=!0}return r}finally{Yn=t,_l.transition=e}}return!1}function mV(n,e,t){e=sb(t,e),e=mW(n,e,1),n=lp(n,e,1),e=_a(),n!==null&&(SS(n,1,e),Ja(n,e))}function Kr(n,e,t){if(n.tag===3)mV(n,n,t);else for(;e!==null;){if(e.tag===3){mV(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(up===null||!up.has(r))){n=sb(t,n),n=gW(e,n,1),e=lp(e,n,1),n=_a(),e!==null&&(SS(e,1,n),Ja(e,n));break}}e=e.return}}function Rae(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=_a(),n.pingedLanes|=n.suspendedLanes&t,ss===n&&(As&t)===t&&(Ni===4||Ni===3&&(As&130023424)===As&&500>oi()-Ak?lv(n,0):Sk|=t),Ja(n,e)}function OW(n,e){e===0&&(n.mode&1?(e=NA,NA<<=1,!(NA&130023424)&&(NA=4194304)):e=1);var t=_a();n=id(n,e),n!==null&&(SS(n,e,t),Ja(n,t))}function Iae(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),OW(n,t)}function Pae(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(et(314))}r!==null&&r.delete(e),OW(n,t)}var kW;kW=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Qa.current)Xa=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Xa=!1,bae(n,e,t);Xa=!!(n.flags&131072)}else Xa=!1,Dr&&e.flags&1048576&&zq(e,TC,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;aM(n,e),n=e.pendingProps;var i=tb(e,ea.current);gy(e,t),i=yk(null,e,r,n,i,t);var s=xk();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Za(r)?(s=!0,SC(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,fk(e),i.updater=R2,e.stateNode=i,i._reactInternals=e,LP(e,r,n,t),e=BP(null,e,r,!0,s,t)):(e.tag=0,Dr&&s&&ak(e),ya(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(aM(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=Lae(r),n=Hl(r,n),i){case 0:e=kP(null,e,r,n,t);break e;case 1:e=sV(null,e,r,n,t);break e;case 11:e=rV(null,e,r,n,t);break e;case 14:e=iV(null,e,r,Hl(r.type,n),t);break e}throw Error(et(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hl(r,i),kP(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hl(r,i),sV(n,e,r,i,t);case 3:e:{if(bW(e),n===null)throw Error(et(387));r=e.pendingProps,s=e.memoizedState,i=s.element,Wq(n,e),DC(e,r,null,t);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=sb(Error(et(423)),e),e=aV(n,e,r,t,i);break e}else if(r!==i){i=sb(Error(et(424)),e),e=aV(n,e,r,t,i);break e}else for(Oo=op(e.stateNode.containerInfo.firstChild),Bo=e,Dr=!0,ru=null,t=jq(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(nb(),r===i){e=sd(n,e,t);break e}ya(n,e,r,t)}e=e.child}return e;case 5:return Xq(e),n===null&&IP(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,a=i.children,MP(r,i)?a=null:s!==null&&MP(r,s)&&(e.flags|=32),xW(n,e),ya(n,e,a,t),e.child;case 6:return n===null&&IP(e),null;case 13:return _W(n,e,t);case 4:return pk(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=rb(e,null,r,t):ya(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hl(r,i),rV(n,e,r,i,t);case 7:return ya(n,e,e.pendingProps,t),e.child;case 8:return ya(n,e,e.pendingProps.children,t),e.child;case 12:return ya(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,xr(MC,r._currentValue),r._currentValue=a,s!==null)if(fu(s.value,a)){if(s.children===i.children&&!Qa.current){e=sd(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=jh(-1,t&-t),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),PP(s.return,t,e),o.lanes|=t;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(et(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),PP(a,t,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}ya(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,gy(e,t),i=Tl(i),r=r(i),e.flags|=1,ya(n,e,r,t),e.child;case 14:return r=e.type,i=Hl(r,e.pendingProps),i=Hl(r.type,i),iV(n,e,r,i,t);case 15:return vW(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hl(r,i),aM(n,e),e.tag=1,Za(r)?(n=!0,SC(e)):n=!1,gy(e,t),pW(e,r,i),LP(e,r,i,t),BP(null,e,r,!0,n,t);case 19:return wW(n,e,t);case 22:return yW(n,e,t)}throw Error(et(156,e.tag))};function BW(n,e){return hq(n,e)}function Fae(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xl(n,e,t,r){return new Fae(n,e,t,r)}function Dk(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Lae(n){if(typeof n=="function")return Dk(n)?1:0;if(n!=null){if(n=n.$$typeof,n===XO)return 11;if(n===KO)return 14}return 2}function hp(n,e){var t=n.alternate;return t===null?(t=xl(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function uM(n,e,t,r,i,s){var a=2;if(r=n,typeof n=="function")Dk(n)&&(a=1);else if(typeof n=="string")a=5;else e:switch(n){case V0:return uv(t.children,i,s,e);case WO:a=8,i|=8;break;case sP:return n=xl(12,t,e,i|2),n.elementType=sP,n.lanes=s,n;case aP:return n=xl(13,t,e,i),n.elementType=aP,n.lanes=s,n;case oP:return n=xl(19,t,e,i),n.elementType=oP,n.lanes=s,n;case Xj:return F2(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case qj:a=10;break e;case Wj:a=9;break e;case XO:a=11;break e;case KO:a=14;break e;case qd:a=16,r=null;break e}throw Error(et(130,n==null?n:typeof n,""))}return e=xl(a,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function uv(n,e,t,r){return n=xl(7,n,r,e),n.lanes=t,n}function F2(n,e,t,r){return n=xl(22,n,r,e),n.elementType=Xj,n.lanes=t,n.stateNode={isHidden:!1},n}function TR(n,e,t){return n=xl(6,n,null,e),n.lanes=t,n}function MR(n,e,t){return e=xl(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function Oae(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=oR(0),this.expirationTimes=oR(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=oR(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Nk(n,e,t,r,i,s,a,o,l){return n=new Oae(n,e,t,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=xl(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},fk(s),n}function kae(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U0,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function UW(n){if(!n)return xp;n=n._reactInternals;e:{if(Fv(n)!==n||n.tag!==1)throw Error(et(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Za(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(et(171))}if(n.tag===1){var t=n.type;if(Za(t))return Uq(n,t,e)}return e}function VW(n,e,t,r,i,s,a,o,l){return n=Nk(t,r,!0,n,i,s,a,o,l),n.context=UW(null),t=n.current,r=_a(),i=cp(t),s=jh(r,i),s.callback=e??null,lp(t,s,i),n.current.lanes=i,SS(n,i,r),Ja(n,r),n}function L2(n,e,t,r){var i=e.current,s=_a(),a=cp(i);return t=UW(t),e.context===null?e.context=t:e.pendingContext=t,e=jh(s,a),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=lp(i,e,a),n!==null&&(hu(n,i,a,s),rM(n,i,a)),a}function kC(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function gV(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Rk(n,e){gV(n,e),(n=n.alternate)&&gV(n,e)}function Bae(){return null}var zW=typeof reportError=="function"?reportError:function(n){console.error(n)};function Ik(n){this._internalRoot=n}O2.prototype.render=Ik.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(et(409));L2(n,e,null,null)};O2.prototype.unmount=Ik.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;bv(function(){L2(null,n,null,null)}),e[rd]=null}};function O2(n){this._internalRoot=n}O2.prototype.unstable_scheduleHydration=function(n){if(n){var e=yq();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Qd.length&&e!==0&&e<Qd[t].priority;t++);Qd.splice(t,0,n),t===0&&bq(n)}};function Pk(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function k2(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function vV(){}function Uae(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=kC(a);s.call(u)}}var a=VW(e,r,n,0,null,!1,!1,"",vV);return n._reactRootContainer=a,n[rd]=a.current,j1(n.nodeType===8?n.parentNode:n),bv(),a}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var u=kC(l);o.call(u)}}var l=Nk(n,0,!1,null,null,!1,!1,"",vV);return n._reactRootContainer=l,n[rd]=l.current,j1(n.nodeType===8?n.parentNode:n),bv(function(){L2(e,l,t,r)}),l}function B2(n,e,t,r,i){var s=t._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=kC(a);o.call(l)}}L2(e,a,n,i)}else a=Uae(t,e,n,i,r);return kC(a)}gq=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=L_(e.pendingLanes);t!==0&&(ZO(e,t|1),Ja(e,oi()),!(In&6)&&(ab=oi()+500,zp()))}break;case 13:bv(function(){var r=id(n,1);if(r!==null){var i=_a();hu(r,n,1,i)}}),Rk(n,1)}};JO=function(n){if(n.tag===13){var e=id(n,134217728);if(e!==null){var t=_a();hu(e,n,134217728,t)}Rk(n,134217728)}};vq=function(n){if(n.tag===13){var e=cp(n),t=id(n,e);if(t!==null){var r=_a();hu(t,n,e,r)}Rk(n,e)}};yq=function(){return Yn};xq=function(n,e){var t=Yn;try{return Yn=n,e()}finally{Yn=t}};vP=function(n,e,t){switch(e){case"input":if(cP(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=C2(r);if(!i)throw Error(et(90));Yj(r),cP(r,i)}}}break;case"textarea":Zj(n,t);break;case"select":e=t.value,e!=null&&dy(n,!!t.multiple,e,!1)}};sq=Tk;aq=bv;var Vae={usingClientEntryPoint:!1,Events:[TS,G0,C2,rq,iq,Tk]},m_={findFiberByHostInstance:km,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zae={bundleType:m_.bundleType,version:m_.version,rendererPackageName:m_.rendererPackageName,rendererConfig:m_.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_d.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=uq(n),n===null?null:n.stateNode},findFiberByHostInstance:m_.findFiberByHostInstance||Bae,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zA=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zA.isDisabled&&zA.supportsFiber)try{S2=zA.inject(zae),hc=zA}catch{}}$o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Vae;$o.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Pk(e))throw Error(et(200));return kae(n,e,null,t)};$o.createRoot=function(n,e){if(!Pk(n))throw Error(et(299));var t=!1,r="",i=zW;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Nk(n,1,!1,null,null,t,!1,r,i),n[rd]=e.current,j1(n.nodeType===8?n.parentNode:n),new Ik(e)};$o.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(et(188)):(n=Object.keys(n).join(","),Error(et(268,n)));return n=uq(e),n=n===null?null:n.stateNode,n};$o.flushSync=function(n){return bv(n)};$o.hydrate=function(n,e,t){if(!k2(e))throw Error(et(200));return B2(null,n,e,!0,t)};$o.hydrateRoot=function(n,e,t){if(!Pk(n))throw Error(et(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",a=zW;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=VW(e,null,n,1,t??null,i,!1,s,a),n[rd]=e.current,j1(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new O2(e)};$o.render=function(n,e,t){if(!k2(e))throw Error(et(200));return B2(null,n,e,!1,t)};$o.unmountComponentAtNode=function(n){if(!k2(n))throw Error(et(40));return n._reactRootContainer?(bv(function(){B2(null,null,n,!1,function(){n._reactRootContainer=null,n[rd]=null})}),!0):!1};$o.unstable_batchedUpdates=Tk;$o.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!k2(t))throw Error(et(200));if(n==null||n._reactInternals===void 0)throw Error(et(38));return B2(n,e,t,!1,r)};$o.version="18.3.1-next-f1338f8080-20240426";function $W(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE($W)}catch(n){console.error(n)}}$W(),$j.exports=$o;var $ae=$j.exports,yV=$ae;rP.createRoot=yV.createRoot,rP.hydrateRoot=yV.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ew(){return ew=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},ew.apply(this,arguments)}var Jf;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Jf||(Jf={}));const xV="popstate";function Hae(n){n===void 0&&(n={});function e(r,i){let{pathname:s,search:a,hash:o}=r.location;return YP("",{pathname:s,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){return typeof i=="string"?i:BC(i)}return jae(e,t,null,n)}function li(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Fk(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Gae(){return Math.random().toString(36).substr(2,8)}function bV(n,e){return{usr:n.state,key:n.key,idx:e}}function YP(n,e,t,r){return t===void 0&&(t=null),ew({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Rb(e):e,{state:t,key:e&&e.key||r||Gae()})}function BC(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Rb(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function jae(n,e,t,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,a=i.history,o=Jf.Pop,l=null,u=c();u==null&&(u=0,a.replaceState(ew({},a.state,{idx:u}),""));function c(){return(a.state||{idx:null}).idx}function h(){o=Jf.Pop;let y=c(),v=y==null?null:y-u;u=y,l&&l({action:o,location:m.location,delta:v})}function d(y,v){o=Jf.Push;let b=YP(m.location,y,v);u=c()+1;let x=bV(b,u),w=m.createHref(b);try{a.pushState(x,"",w)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;i.location.assign(w)}s&&l&&l({action:o,location:m.location,delta:1})}function f(y,v){o=Jf.Replace;let b=YP(m.location,y,v);u=c();let x=bV(b,u),w=m.createHref(b);a.replaceState(x,"",w),s&&l&&l({action:o,location:m.location,delta:0})}function p(y){let v=i.location.origin!=="null"?i.location.origin:i.location.href,b=typeof y=="string"?y:BC(y);return b=b.replace(/ $/,"%20"),li(v,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,v)}let m={get action(){return o},get location(){return n(i,a)},listen(y){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(xV,h),l=y,()=>{i.removeEventListener(xV,h),l=null}},createHref(y){return e(i,y)},createURL:p,encodeLocation(y){let v=p(y);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:d,replace:f,go(y){return a.go(y)}};return m}var _V;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(_V||(_V={}));function qae(n,e,t){return t===void 0&&(t="/"),Wae(n,e,t)}function Wae(n,e,t,r){let i=typeof e=="string"?Rb(e):e,s=Lk(i.pathname||"/",t);if(s==null)return null;let a=HW(n);Xae(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let u=aoe(s);o=roe(a[l],u)}return o}function HW(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let i=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(li(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=dp([r,l.relativePath]),c=t.concat(l);s.children&&s.children.length>0&&(li(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),HW(s.children,e,c,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:toe(u,s.index),routesMeta:c})};return n.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let l of GW(s.path))i(s,a,l)}),e}function GW(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let a=GW(r.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),i&&o.push(...a),o.map(l=>n.startsWith("/")&&l===""?"/":l)}function Xae(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:noe(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const Kae=/^:[\w-]+$/,Yae=3,Qae=2,Zae=1,Jae=10,eoe=-2,wV=n=>n==="*";function toe(n,e){let t=n.split("/"),r=t.length;return t.some(wV)&&(r+=eoe),e&&(r+=Qae),t.filter(i=>!wV(i)).reduce((i,s)=>i+(Kae.test(s)?Yae:s===""?Zae:Jae),r)}function noe(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function roe(n,e,t){let{routesMeta:r}=n,i={},s="/",a=[];for(let o=0;o<r.length;++o){let l=r[o],u=o===r.length-1,c=s==="/"?e:e.slice(s.length)||"/",h=ioe({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),d=l.route;if(!h)return null;Object.assign(i,h.params),a.push({params:i,pathname:dp([s,h.pathname]),pathnameBase:hoe(dp([s,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(s=dp([s,h.pathnameBase]))}return a}function ioe(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=soe(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:r.reduce((u,c,h)=>{let{paramName:d,isOptional:f}=c;if(d==="*"){let m=o[h]||"";a=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const p=o[h];return f&&!p?u[d]=void 0:u[d]=(p||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:a,pattern:n}}function soe(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Fk(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(r.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function aoe(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Fk(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Lk(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}const ooe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,loe=n=>ooe.test(n);function uoe(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?Rb(n):n,s;if(t)if(loe(t))s=t;else{if(t.includes("//")){let a=t;t=t.replace(/\/\/+/g,"/"),Fk(!1,"Pathnames cannot have embedded double slashes - normalizing "+(a+" -> "+t))}t.startsWith("/")?s=EV(t.substring(1),"/"):s=EV(t,e)}else s=e;return{pathname:s,search:doe(r),hash:foe(i)}}function EV(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function CR(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function coe(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Ok(n,e){let t=coe(n);return e?t.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function kk(n,e,t,r){r===void 0&&(r=!1);let i;typeof n=="string"?i=Rb(n):(i=ew({},n),li(!i.pathname||!i.pathname.includes("?"),CR("?","pathname","search",i)),li(!i.pathname||!i.pathname.includes("#"),CR("#","pathname","hash",i)),li(!i.search||!i.search.includes("#"),CR("#","search","hash",i)));let s=n===""||i.pathname==="",a=s?"/":i.pathname,o;if(a==null)o=t;else{let h=e.length-1;if(!r&&a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),h-=1;i.pathname=d.join("/")}o=h>=0?e[h]:"/"}let l=uoe(i,o),u=a&&a!=="/"&&a.endsWith("/"),c=(s||a===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const dp=n=>n.join("/").replace(/\/\/+/g,"/"),hoe=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),doe=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,foe=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function poe(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const jW=["post","put","patch","delete"];new Set(jW);const moe=["get",...jW];new Set(moe);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tw(){return tw=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},tw.apply(this,arguments)}const Bk=xe.createContext(null),goe=xe.createContext(null),$p=xe.createContext(null),U2=xe.createContext(null),Rc=xe.createContext({outlet:null,matches:[],isDataRoute:!1}),qW=xe.createContext(null);function voe(n,e){let{relative:t}=e===void 0?{}:e;Ib()||li(!1);let{basename:r,navigator:i}=xe.useContext($p),{hash:s,pathname:a,search:o}=KW(n,{relative:t}),l=a;return r!=="/"&&(l=a==="/"?r:dp([r,a])),i.createHref({pathname:l,search:o,hash:s})}function Ib(){return xe.useContext(U2)!=null}function Pb(){return Ib()||li(!1),xe.useContext(U2).location}function WW(n){xe.useContext($p).static||xe.useLayoutEffect(n)}function Fb(){let{isDataRoute:n}=xe.useContext(Rc);return n?Ioe():yoe()}function yoe(){Ib()||li(!1);let n=xe.useContext(Bk),{basename:e,future:t,navigator:r}=xe.useContext($p),{matches:i}=xe.useContext(Rc),{pathname:s}=Pb(),a=JSON.stringify(Ok(i,t.v7_relativeSplatPath)),o=xe.useRef(!1);return WW(()=>{o.current=!0}),xe.useCallback(function(u,c){if(c===void 0&&(c={}),!o.current)return;if(typeof u=="number"){r.go(u);return}let h=kk(u,JSON.parse(a),s,c.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:dp([e,h.pathname])),(c.replace?r.replace:r.push)(h,c.state,c)},[e,r,a,s,n])}const xoe=xe.createContext(null);function boe(n){let e=xe.useContext(Rc).outlet;return e&&xe.createElement(xoe.Provider,{value:n},e)}function XW(){let{matches:n}=xe.useContext(Rc),e=n[n.length-1];return e?e.params:{}}function KW(n,e){let{relative:t}=e===void 0?{}:e,{future:r}=xe.useContext($p),{matches:i}=xe.useContext(Rc),{pathname:s}=Pb(),a=JSON.stringify(Ok(i,r.v7_relativeSplatPath));return xe.useMemo(()=>kk(n,JSON.parse(a),s,t==="path"),[n,a,s,t])}function _oe(n,e){return woe(n,e)}function woe(n,e,t,r){Ib()||li(!1);let{navigator:i}=xe.useContext($p),{matches:s}=xe.useContext(Rc),a=s[s.length-1],o=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let u=Pb(),c;if(e){var h;let y=typeof e=="string"?Rb(e):e;l==="/"||(h=y.pathname)!=null&&h.startsWith(l)||li(!1),c=y}else c=u;let d=c.pathname||"/",f=d;if(l!=="/"){let y=l.replace(/^\//,"").split("/");f="/"+d.replace(/^\//,"").split("/").slice(y.length).join("/")}let p=qae(n,{pathname:f}),m=Moe(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},o,y.params),pathname:dp([l,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:dp([l,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,t,r);return e&&m?xe.createElement(U2.Provider,{value:{location:tw({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Jf.Pop}},m):m}function Eoe(){let n=Roe(),e=poe(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return xe.createElement(xe.Fragment,null,xe.createElement("h2",null,"Unexpected Application Error!"),xe.createElement("h3",{style:{fontStyle:"italic"}},e),t?xe.createElement("pre",{style:i},t):null,null)}const Soe=xe.createElement(Eoe,null);class Aoe extends xe.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?xe.createElement(Rc.Provider,{value:this.props.routeContext},xe.createElement(qW.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Toe(n){let{routeContext:e,match:t,children:r}=n,i=xe.useContext(Bk);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),xe.createElement(Rc.Provider,{value:e},r)}function Moe(n,e,t,r){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var s;if(!t)return null;if(t.errors)n=t.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=(i=t)==null?void 0:i.errors;if(o!=null){let c=a.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);c>=0||li(!1),a=a.slice(0,Math.min(a.length,c+1))}let l=!1,u=-1;if(t&&r&&r.v7_partialHydration)for(let c=0;c<a.length;c++){let h=a[c];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=c),h.route.id){let{loaderData:d,errors:f}=t,p=h.route.loader&&d[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||p){l=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((c,h,d)=>{let f,p=!1,m=null,y=null;t&&(f=o&&h.route.id?o[h.route.id]:void 0,m=h.route.errorElement||Soe,l&&(u<0&&d===0?(Poe("route-fallback"),p=!0,y=null):u===d&&(p=!0,y=h.route.hydrateFallbackElement||null)));let v=e.concat(a.slice(0,d+1)),b=()=>{let x;return f?x=m:p?x=y:h.route.Component?x=xe.createElement(h.route.Component,null):h.route.element?x=h.route.element:x=c,xe.createElement(Toe,{match:h,routeContext:{outlet:c,matches:v,isDataRoute:t!=null},children:x})};return t&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?xe.createElement(Aoe,{location:t.location,revalidation:t.revalidation,component:m,error:f,children:b(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):b()},null)}var YW=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(YW||{}),QW=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(QW||{});function Coe(n){let e=xe.useContext(Bk);return e||li(!1),e}function Doe(n){let e=xe.useContext(goe);return e||li(!1),e}function Noe(n){let e=xe.useContext(Rc);return e||li(!1),e}function ZW(n){let e=Noe(),t=e.matches[e.matches.length-1];return t.route.id||li(!1),t.route.id}function Roe(){var n;let e=xe.useContext(qW),t=Doe(),r=ZW();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function Ioe(){let{router:n}=Coe(YW.UseNavigateStable),e=ZW(QW.UseNavigateStable),t=xe.useRef(!1);return WW(()=>{t.current=!0}),xe.useCallback(function(i,s){s===void 0&&(s={}),t.current&&(typeof i=="number"?n.navigate(i):n.navigate(i,tw({fromRouteId:e},s)))},[n,e])}const SV={};function Poe(n,e,t){SV[n]||(SV[n]=!0)}function Foe(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function Loe(n){let{to:e,replace:t,state:r,relative:i}=n;Ib()||li(!1);let{future:s,static:a}=xe.useContext($p),{matches:o}=xe.useContext(Rc),{pathname:l}=Pb(),u=Fb(),c=kk(e,Ok(o,s.v7_relativeSplatPath),l,i==="path"),h=JSON.stringify(c);return xe.useEffect(()=>u(JSON.parse(h),{replace:t,state:r,relative:i}),[u,h,i,t,r]),null}function Ooe(n){return boe(n.context)}function ls(n){li(!1)}function koe(n){let{basename:e="/",children:t=null,location:r,navigationType:i=Jf.Pop,navigator:s,static:a=!1,future:o}=n;Ib()&&li(!1);let l=e.replace(/^\/*/,"/"),u=xe.useMemo(()=>({basename:l,navigator:s,static:a,future:tw({v7_relativeSplatPath:!1},o)}),[l,o,s,a]);typeof r=="string"&&(r=Rb(r));let{pathname:c="/",search:h="",hash:d="",state:f=null,key:p="default"}=r,m=xe.useMemo(()=>{let y=Lk(c,l);return y==null?null:{location:{pathname:y,search:h,hash:d,state:f,key:p},navigationType:i}},[l,c,h,d,f,p,i]);return m==null?null:xe.createElement($p.Provider,{value:u},xe.createElement(U2.Provider,{children:t,value:m}))}function Boe(n){let{children:e,location:t}=n;return _oe(QP(e),t)}new Promise(()=>{});function QP(n,e){e===void 0&&(e=[]);let t=[];return xe.Children.forEach(n,(r,i)=>{if(!xe.isValidElement(r))return;let s=[...e,i];if(r.type===xe.Fragment){t.push.apply(t,QP(r.props.children,s));return}r.type!==ls&&li(!1),!r.props.index||!r.props.children||li(!1);let a={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=QP(r.props.children,s)),t.push(a)}),t}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ZP(){return ZP=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},ZP.apply(this,arguments)}function Uoe(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function Voe(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function zoe(n,e){return n.button===0&&(!e||e==="_self")&&!Voe(n)}const $oe=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Hoe="6";try{window.__reactRouterVersion=Hoe}catch{}const Goe="startTransition",AV=Rie[Goe];function joe(n){let{basename:e,children:t,future:r,window:i}=n,s=xe.useRef();s.current==null&&(s.current=Hae({window:i,v5Compat:!0}));let a=s.current,[o,l]=xe.useState({action:a.action,location:a.location}),{v7_startTransition:u}=r||{},c=xe.useCallback(h=>{u&&AV?AV(()=>l(h)):l(h)},[l,u]);return xe.useLayoutEffect(()=>a.listen(c),[a,c]),xe.useEffect(()=>Foe(r),[r]),xe.createElement(koe,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:a,future:r})}const qoe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Woe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,hr=xe.forwardRef(function(e,t){let{onClick:r,relative:i,reloadDocument:s,replace:a,state:o,target:l,to:u,preventScrollReset:c,viewTransition:h}=e,d=Uoe(e,$oe),{basename:f}=xe.useContext($p),p,m=!1;if(typeof u=="string"&&Woe.test(u)&&(p=u,qoe))try{let x=new URL(window.location.href),w=u.startsWith("//")?new URL(x.protocol+u):new URL(u),_=Lk(w.pathname,f);w.origin===x.origin&&_!=null?u=_+w.search+w.hash:m=!0}catch{}let y=voe(u,{relative:i}),v=Xoe(u,{replace:a,state:o,target:l,preventScrollReset:c,relative:i,viewTransition:h});function b(x){r&&r(x),x.defaultPrevented||v(x)}return xe.createElement("a",ZP({},d,{href:p||y,onClick:m||s?r:b,ref:t,target:l}))});var TV;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(TV||(TV={}));var MV;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(MV||(MV={}));function Xoe(n,e){let{target:t,replace:r,state:i,preventScrollReset:s,relative:a,viewTransition:o}=e===void 0?{}:e,l=Fb(),u=Pb(),c=KW(n,{relative:a});return xe.useCallback(h=>{if(zoe(h,t)){h.preventDefault();let d=r!==void 0?r:BC(u)===BC(c);l(n,{replace:d,state:i,preventScrollReset:s,relative:a,viewTransition:o})}},[u,l,c,r,i,t,n,s,a,o])}const JW=xe.createContext(),Nl=()=>{const n=xe.useContext(JW);if(!n)throw new Error("useTheme must be used within ThemeProvider");return n},Koe=({children:n})=>{const[e,t]=xe.useState(()=>{const i=localStorage.getItem("theme");return i?i==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches});xe.useEffect(()=>{const i=document.documentElement;e?i.classList.add("dark"):i.classList.remove("dark"),localStorage.setItem("theme",e?"dark":"light")},[e]);const r=()=>{t(i=>!i)};return k.jsx(JW.Provider,{value:{isDark:e,toggleTheme:r},children:n})},eX="authToken",tX="user",Yoe=()=>localStorage.getItem(eX),Qoe=()=>{localStorage.removeItem(eX)},bp=()=>{const n=localStorage.getItem(tX);return n?JSON.parse(n):null},Zoe=()=>{localStorage.removeItem(tX)},JP=()=>!!Yoe(),Joe=()=>{Qoe(),Zoe()};function ele(){const{isDark:n,toggleTheme:e}=Nl(),t=Fb(),[r,i]=xe.useState(!1),[s,a]=xe.useState(!1),[o,l]=xe.useState(null),[u,c]=xe.useState(!1);xe.useEffect(()=>{JP()&&(l(bp()),c(!0));const f=()=>{JP()?(l(bp()),c(!0)):(l(null),c(!1))};return window.addEventListener("auth-change",f),()=>window.removeEventListener("auth-change",f)},[]);const h=()=>{Joe(),localStorage.removeItem("user"),localStorage.removeItem("authToken"),l(null),c(!1),a(!1),i(!1),window.dispatchEvent(new Event("auth-change")),t("/")},d=[{to:"/",label:""},{to:"/concepts",label:""},{to:"/papers",label:" "},{to:"/visualizations",label:""},{to:"/calculator",label:""},{to:"/forum",label:""},{to:"/glossary",label:" "},{to:"/references",label:" "},...u&&o?[{to:"/notes",label:""}]:[]];return k.jsx("header",{className:`sticky top-0 z-40 transition-colors duration-300 ${n?"bg-gray-900 border-gray-800":"bg-white border-gray-200"} border-b backdrop-blur`,children:k.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[k.jsxs("div",{className:"flex items-center justify-between",children:[k.jsx(hr,{to:"/",className:"text-xl sm:text-2xl font-bold text-blue-500 dark:text-blue-400 whitespace-nowrap",children:"Astro Hub"}),k.jsxs("nav",{className:"hidden md:flex items-center gap-3 lg:gap-6",children:[d.map(f=>k.jsx(hr,{to:f.to,className:`transition text-sm lg:text-base ${n?"text-gray-300 hover:text-blue-400":"text-gray-600 hover:text-blue-600"}`,children:f.label},f.to)),k.jsx("button",{onClick:e,className:`p-2 rounded-lg border transition text-lg ${n?"border-gray-700 hover:bg-gray-800":"border-gray-300 hover:bg-gray-100"}`,"aria-label":" ",children:n?"":""}),u&&o?k.jsxs("div",{className:"relative",children:[k.jsxs("button",{onClick:()=>a(!s),className:`p-2 rounded-lg border transition ${n?"border-gray-700 hover:bg-gray-800":"border-gray-300 hover:bg-gray-100"}`,children:[" ",o.username]}),s&&k.jsxs("div",{className:`absolute right-0 mt-2 w-48 rounded-lg shadow-lg ${n?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border`,children:[k.jsx(hr,{to:"/profile",className:`block px-4 py-2 first:rounded-t-lg ${n?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-100"}`,onClick:()=>a(!1),children:""}),k.jsx(hr,{to:"/bookmarks",className:`block px-4 py-2 ${n?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-100"}`,onClick:()=>a(!1),children:""}),k.jsx(hr,{to:"/notes",className:`block px-4 py-2 ${n?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-100"}`,onClick:()=>a(!1),children:""}),k.jsx("button",{onClick:h,className:`w-full text-left px-4 py-2 last:rounded-b-lg ${n?"text-red-400 hover:bg-gray-700":"text-red-600 hover:bg-gray-100"}`,children:""})]})]}):k.jsxs("div",{className:"flex gap-2",children:[k.jsx(hr,{to:"/login",className:`px-4 py-2 rounded-lg border transition ${n?"border-blue-400 text-blue-400 hover:bg-blue-400 hover:text-gray-900":"border-blue-600 text-blue-600 hover:bg-blue-600 hover:text-white"}`,children:""}),k.jsx(hr,{to:"/signup",className:`px-4 py-2 rounded-lg transition text-white ${n?"bg-blue-600 hover:bg-blue-700":"bg-blue-500 hover:bg-blue-600"}`,children:""})]})]}),k.jsxs("div",{className:"md:hidden flex items-center gap-3",children:[k.jsx("button",{onClick:e,className:`p-2 rounded-lg border transition text-lg ${n?"border-gray-700 hover:bg-gray-800":"border-gray-300 hover:bg-gray-100"}`,"aria-label":" ",children:n?"":""}),k.jsx("button",{onClick:()=>i(!r),className:`p-2 transition ${n?"text-gray-300 hover:text-blue-400":"text-gray-600 hover:text-blue-600"}`,"aria-label":"",children:r?"":""})]})]}),r&&k.jsxs("nav",{className:`md:hidden mt-4 space-y-2 pb-4 border-t transition-colors duration-300 pt-4 ${n?"border-gray-800":"border-gray-200"}`,children:[d.map(f=>k.jsx(hr,{to:f.to,className:`block py-2 transition ${n?"text-gray-300 hover:text-blue-400":"text-gray-600 hover:text-blue-600"}`,onClick:()=>i(!1),children:f.label},f.to)),u&&o?k.jsx(k.Fragment,{children:k.jsxs("div",{className:`py-2 border-t transition-colors duration-300 ${n?"border-gray-800":"border-gray-200"} mt-2 pt-2`,children:[k.jsx("div",{className:`px-2 py-1 text-sm ${n?"text-gray-400":"text-gray-500"}`,children:o.username}),k.jsx(hr,{to:"/profile",className:`block py-2 transition ${n?"text-gray-300 hover:text-blue-400":"text-gray-600 hover:text-blue-600"}`,onClick:()=>i(!1),children:""}),k.jsx(hr,{to:"/bookmarks",className:`block py-2 transition ${n?"text-gray-300 hover:text-blue-400":"text-gray-600 hover:text-blue-600"}`,onClick:()=>i(!1),children:""}),k.jsx(hr,{to:"/notes",className:`block py-2 transition ${n?"text-gray-300 hover:text-blue-400":"text-gray-600 hover:text-blue-600"}`,onClick:()=>i(!1),children:""}),k.jsx("button",{onClick:h,className:`w-full text-left py-2 transition ${n?"text-red-400 hover:text-red-300":"text-red-600 hover:text-red-700"}`,children:""})]})}):k.jsxs("div",{className:`py-2 border-t transition-colors duration-300 mt-2 pt-2 ${n?"border-gray-800":"border-gray-200"}`,children:[k.jsx(hr,{to:"/login",className:`block py-2 transition ${n?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"}`,onClick:()=>i(!1),children:""}),k.jsx(hr,{to:"/signup",className:`block py-2 transition ${n?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"}`,onClick:()=>i(!1),children:""})]})]})]})})}function tle(){const[n,e]=xe.useState(0);return xe.useEffect(()=>{const t=()=>{const r=window.scrollY,i=document.documentElement.scrollHeight-window.innerHeight,s=i>0?r/i*100:0;e(Math.min(100,Math.max(0,s)))};return window.addEventListener("scroll",t,{passive:!0}),()=>window.removeEventListener("scroll",t)},[]),k.jsx("div",{className:"scroll-progress",children:k.jsx("div",{className:"scroll-progress__bar",style:{transform:`scaleX(${n/100})`}})})}function nle(){const{isDark:n}=Nl();return k.jsxs("div",{className:`min-h-screen transition-colors duration-300 ${n?"bg-gray-950 text-gray-100":"bg-white text-gray-900"}`,children:[k.jsx(tle,{}),k.jsx(ele,{}),k.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:k.jsx(Ooe,{})}),k.jsx("footer",{className:`border-t py-6 text-center text-sm transition-colors duration-300 ${n?"bg-gray-900 border-gray-800 text-gray-400":"bg-gray-50 border-gray-200 text-gray-600"}`,children:k.jsx("p",{children:" 2025 Astrophysics Hub    "})})]})}const nX=xe.createContext({});function rle(n){const e=xe.useRef(null);return e.current===null&&(e.current=n()),e.current}const Uk=typeof window<"u",ile=Uk?xe.useLayoutEffect:xe.useEffect,Vk=xe.createContext(null);function zk(n,e){n.indexOf(e)===-1&&n.push(e)}function $k(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const ad=(n,e,t)=>t>e?e:t<n?n:t;let Hk=()=>{};const od={},rX=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function iX(n){return typeof n=="object"&&n!==null}const sX=n=>/^0[^.\s]+$/u.test(n);function Gk(n){let e;return()=>(e===void 0&&(e=n()),e)}const wl=n=>n,sle=(n,e)=>t=>e(n(t)),CS=(...n)=>n.reduce(sle),nw=(n,e,t)=>{const r=e-n;return r===0?1:(t-n)/r};class jk{constructor(){this.subscriptions=[]}add(e){return zk(this.subscriptions,e),()=>$k(this.subscriptions,e)}notify(e,t,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,r);else for(let s=0;s<i;s++){const a=this.subscriptions[s];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const fc=n=>n*1e3,bl=n=>n/1e3;function aX(n,e){return e?n*(1e3/e):0}const oX=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,ale=1e-7,ole=12;function lle(n,e,t,r,i){let s,a,o=0;do a=e+(t-e)/2,s=oX(a,r,i)-n,s>0?t=a:e=a;while(Math.abs(s)>ale&&++o<ole);return a}function DS(n,e,t,r){if(n===e&&t===r)return wl;const i=s=>lle(s,0,1,n,t);return s=>s===0||s===1?s:oX(i(s),e,r)}const lX=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,uX=n=>e=>1-n(1-e),cX=DS(.33,1.53,.69,.99),qk=uX(cX),hX=lX(qk),dX=n=>(n*=2)<1?.5*qk(n):.5*(2-Math.pow(2,-10*(n-1))),Wk=n=>1-Math.sin(Math.acos(n)),fX=uX(Wk),pX=lX(Wk),ule=DS(.42,0,1,1),cle=DS(0,0,.58,1),mX=DS(.42,0,.58,1),hle=n=>Array.isArray(n)&&typeof n[0]!="number",gX=n=>Array.isArray(n)&&typeof n[0]=="number",dle={linear:wl,easeIn:ule,easeInOut:mX,easeOut:cle,circIn:Wk,circInOut:pX,circOut:fX,backIn:qk,backInOut:hX,backOut:cX,anticipate:dX},fle=n=>typeof n=="string",CV=n=>{if(gX(n)){Hk(n.length===4);const[e,t,r,i]=n;return DS(e,t,r,i)}else if(fle(n))return dle[n];return n},$A=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function ple(n,e){let t=new Set,r=new Set,i=!1,s=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(c){a.has(c)&&(u.schedule(c),n()),c(o)}const u={schedule:(c,h=!1,d=!1)=>{const p=d&&i?t:r;return h&&a.add(c),p.has(c)||p.add(c),c},cancel:c=>{r.delete(c),a.delete(c)},process:c=>{if(o=c,i){s=!0;return}i=!0,[t,r]=[r,t],t.forEach(l),t.clear(),i=!1,s&&(s=!1,u.process(c))}};return u}const mle=40;function vX(n,e){let t=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,a=$A.reduce((x,w)=>(x[w]=ple(s),x),{}),{setup:o,read:l,resolveKeyframes:u,preUpdate:c,update:h,preRender:d,render:f,postRender:p}=a,m=()=>{const x=od.useManualTiming?i.timestamp:performance.now();t=!1,od.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(x-i.timestamp,mle),1)),i.timestamp=x,i.isProcessing=!0,o.process(i),l.process(i),u.process(i),c.process(i),h.process(i),d.process(i),f.process(i),p.process(i),i.isProcessing=!1,t&&e&&(r=!1,n(m))},y=()=>{t=!0,r=!0,i.isProcessing||n(m)};return{schedule:$A.reduce((x,w)=>{const _=a[w];return x[w]=(E,A=!1,T=!1)=>(t||y(),_.schedule(E,A,T)),x},{}),cancel:x=>{for(let w=0;w<$A.length;w++)a[$A[w]].cancel(x)},state:i,steps:a}}const{schedule:Nr,cancel:_p,state:gs,steps:DR}=vX(typeof requestAnimationFrame<"u"?requestAnimationFrame:wl,!0);let cM;function gle(){cM=void 0}const Ka={now:()=>(cM===void 0&&Ka.set(gs.isProcessing||od.useManualTiming?gs.timestamp:performance.now()),cM),set:n=>{cM=n,queueMicrotask(gle)}},yX=n=>e=>typeof e=="string"&&e.startsWith(n),Xk=yX("--"),vle=yX("var(--"),Kk=n=>vle(n)?yle.test(n.split("/*")[0].trim()):!1,yle=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Lb={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},rw={...Lb,transform:n=>ad(0,1,n)},HA={...Lb,default:1},S1=n=>Math.round(n*1e5)/1e5,Yk=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function xle(n){return n==null}const ble=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Qk=(n,e)=>t=>!!(typeof t=="string"&&ble.test(t)&&t.startsWith(n)||e&&!xle(t)&&Object.prototype.hasOwnProperty.call(t,e)),xX=(n,e,t)=>r=>{if(typeof r!="string")return r;const[i,s,a,o]=r.match(Yk);return{[n]:parseFloat(i),[e]:parseFloat(s),[t]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},_le=n=>ad(0,255,n),NR={...Lb,transform:n=>Math.round(_le(n))},Vm={test:Qk("rgb","red"),parse:xX("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:r=1})=>"rgba("+NR.transform(n)+", "+NR.transform(e)+", "+NR.transform(t)+", "+S1(rw.transform(r))+")"};function wle(n){let e="",t="",r="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const e3={test:Qk("#"),parse:wle,transform:Vm.transform},NS=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),Hd=NS("deg"),pc=NS("%"),kt=NS("px"),Ele=NS("vh"),Sle=NS("vw"),DV={...pc,parse:n=>pc.parse(n)/100,transform:n=>pc.transform(n*100)},Q0={test:Qk("hsl","hue"),parse:xX("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:r=1})=>"hsla("+Math.round(n)+", "+pc.transform(S1(e))+", "+pc.transform(S1(t))+", "+S1(rw.transform(r))+")"},gi={test:n=>Vm.test(n)||e3.test(n)||Q0.test(n),parse:n=>Vm.test(n)?Vm.parse(n):Q0.test(n)?Q0.parse(n):e3.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Vm.transform(n):Q0.transform(n),getAnimatableNone:n=>{const e=gi.parse(n);return e.alpha=0,gi.transform(e)}},Ale=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Tle(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(Yk))==null?void 0:e.length)||0)+(((t=n.match(Ale))==null?void 0:t.length)||0)>0}const bX="number",_X="color",Mle="var",Cle="var(",NV="${}",Dle=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function iw(n){const e=n.toString(),t=[],r={color:[],number:[],var:[]},i=[];let s=0;const o=e.replace(Dle,l=>(gi.test(l)?(r.color.push(s),i.push(_X),t.push(gi.parse(l))):l.startsWith(Cle)?(r.var.push(s),i.push(Mle),t.push(l)):(r.number.push(s),i.push(bX),t.push(parseFloat(l))),++s,NV)).split(NV);return{values:t,split:o,indexes:r,types:i}}function wX(n){return iw(n).values}function EX(n){const{split:e,types:t}=iw(n),r=e.length;return i=>{let s="";for(let a=0;a<r;a++)if(s+=e[a],i[a]!==void 0){const o=t[a];o===bX?s+=S1(i[a]):o===_X?s+=gi.transform(i[a]):s+=i[a]}return s}}const Nle=n=>typeof n=="number"?0:gi.test(n)?gi.getAnimatableNone(n):n;function Rle(n){const e=wX(n);return EX(n)(e.map(Nle))}const wp={test:Tle,parse:wX,createTransformer:EX,getAnimatableNone:Rle};function RR(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function Ile({hue:n,saturation:e,lightness:t,alpha:r}){n/=360,e/=100,t/=100;let i=0,s=0,a=0;if(!e)i=s=a=t;else{const o=t<.5?t*(1+e):t+e-t*e,l=2*t-o;i=RR(l,o,n+1/3),s=RR(l,o,n),a=RR(l,o,n-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:r}}function UC(n,e){return t=>t>0?e:n}const Or=(n,e,t)=>n+(e-n)*t,IR=(n,e,t)=>{const r=n*n,i=t*(e*e-r)+r;return i<0?0:Math.sqrt(i)},Ple=[e3,Vm,Q0],Fle=n=>Ple.find(e=>e.test(n));function RV(n){const e=Fle(n);if(!e)return!1;let t=e.parse(n);return e===Q0&&(t=Ile(t)),t}const IV=(n,e)=>{const t=RV(n),r=RV(e);if(!t||!r)return UC(n,e);const i={...t};return s=>(i.red=IR(t.red,r.red,s),i.green=IR(t.green,r.green,s),i.blue=IR(t.blue,r.blue,s),i.alpha=Or(t.alpha,r.alpha,s),Vm.transform(i))},t3=new Set(["none","hidden"]);function Lle(n,e){return t3.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function Ole(n,e){return t=>Or(n,e,t)}function Zk(n){return typeof n=="number"?Ole:typeof n=="string"?Kk(n)?UC:gi.test(n)?IV:Ule:Array.isArray(n)?SX:typeof n=="object"?gi.test(n)?IV:kle:UC}function SX(n,e){const t=[...n],r=t.length,i=n.map((s,a)=>Zk(s)(s,e[a]));return s=>{for(let a=0;a<r;a++)t[a]=i[a](s);return t}}function kle(n,e){const t={...n,...e},r={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(r[i]=Zk(n[i])(n[i],e[i]));return i=>{for(const s in r)t[s]=r[s](i);return t}}function Ble(n,e){const t=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const s=e.types[i],a=n.indexes[s][r[s]],o=n.values[a]??0;t[i]=o,r[s]++}return t}const Ule=(n,e)=>{const t=wp.createTransformer(e),r=iw(n),i=iw(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?t3.has(n)&&!i.values.length||t3.has(e)&&!r.values.length?Lle(n,e):CS(SX(Ble(r,i),i.values),t):UC(n,e)};function AX(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Or(n,e,t):Zk(n)(n,e)}const Vle=n=>{const e=({timestamp:t})=>n(t);return{start:(t=!0)=>Nr.update(e,t),stop:()=>_p(e),now:()=>gs.isProcessing?gs.timestamp:Ka.now()}},TX=(n,e,t=10)=>{let r="";const i=Math.max(Math.round(e/t),2);for(let s=0;s<i;s++)r+=Math.round(n(s/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},VC=2e4;function Jk(n){let e=0;const t=50;let r=n.next(e);for(;!r.done&&e<VC;)e+=t,r=n.next(e);return e>=VC?1/0:e}function zle(n,e=100,t){const r=t({...n,keyframes:[0,e]}),i=Math.min(Jk(r),VC);return{type:"keyframes",ease:s=>r.next(i*s).value/e,duration:bl(i)}}const $le=5;function MX(n,e,t){const r=Math.max(e-$le,0);return aX(t-n(r),e-r)}const Wr={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},PR=.001;function Hle({duration:n=Wr.duration,bounce:e=Wr.bounce,velocity:t=Wr.velocity,mass:r=Wr.mass}){let i,s,a=1-e;a=ad(Wr.minDamping,Wr.maxDamping,a),n=ad(Wr.minDuration,Wr.maxDuration,bl(n)),a<1?(i=u=>{const c=u*a,h=c*n,d=c-t,f=n3(u,a),p=Math.exp(-h);return PR-d/f*p},s=u=>{const h=u*a*n,d=h*t+t,f=Math.pow(a,2)*Math.pow(u,2)*n,p=Math.exp(-h),m=n3(Math.pow(u,2),a);return(-i(u)+PR>0?-1:1)*((d-f)*p)/m}):(i=u=>{const c=Math.exp(-u*n),h=(u-t)*n+1;return-PR+c*h},s=u=>{const c=Math.exp(-u*n),h=(t-u)*(n*n);return c*h});const o=5/n,l=jle(i,s,o);if(n=fc(n),isNaN(l))return{stiffness:Wr.stiffness,damping:Wr.damping,duration:n};{const u=Math.pow(l,2)*r;return{stiffness:u,damping:a*2*Math.sqrt(r*u),duration:n}}}const Gle=12;function jle(n,e,t){let r=t;for(let i=1;i<Gle;i++)r=r-n(r)/e(r);return r}function n3(n,e){return n*Math.sqrt(1-e*e)}const qle=["duration","bounce"],Wle=["stiffness","damping","mass"];function PV(n,e){return e.some(t=>n[t]!==void 0)}function Xle(n){let e={velocity:Wr.velocity,stiffness:Wr.stiffness,damping:Wr.damping,mass:Wr.mass,isResolvedFromDuration:!1,...n};if(!PV(n,Wle)&&PV(n,qle))if(n.visualDuration){const t=n.visualDuration,r=2*Math.PI/(t*1.2),i=r*r,s=2*ad(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:Wr.mass,stiffness:i,damping:s}}else{const t=Hle(n);e={...e,...t,mass:Wr.mass},e.isResolvedFromDuration=!0}return e}function zC(n=Wr.visualDuration,e=Wr.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:r,restDelta:i}=t;const s=t.keyframes[0],a=t.keyframes[t.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:u,mass:c,duration:h,velocity:d,isResolvedFromDuration:f}=Xle({...t,velocity:-bl(t.velocity||0)}),p=d||0,m=u/(2*Math.sqrt(l*c)),y=a-s,v=bl(Math.sqrt(l/c)),b=Math.abs(y)<5;r||(r=b?Wr.restSpeed.granular:Wr.restSpeed.default),i||(i=b?Wr.restDelta.granular:Wr.restDelta.default);let x;if(m<1){const _=n3(v,m);x=E=>{const A=Math.exp(-m*v*E);return a-A*((p+m*v*y)/_*Math.sin(_*E)+y*Math.cos(_*E))}}else if(m===1)x=_=>a-Math.exp(-v*_)*(y+(p+v*y)*_);else{const _=v*Math.sqrt(m*m-1);x=E=>{const A=Math.exp(-m*v*E),T=Math.min(_*E,300);return a-A*((p+m*v*y)*Math.sinh(T)+_*y*Math.cosh(T))/_}}const w={calculatedDuration:f&&h||null,next:_=>{const E=x(_);if(f)o.done=_>=h;else{let A=_===0?p:0;m<1&&(A=_===0?fc(p):MX(x,_,E));const T=Math.abs(A)<=r,S=Math.abs(a-E)<=i;o.done=T&&S}return o.value=o.done?a:E,o},toString:()=>{const _=Math.min(Jk(w),VC),E=TX(A=>w.next(_*A).value,_,30);return _+"ms "+E},toTransition:()=>{}};return w}zC.applyToOptions=n=>{const e=zle(n,100,zC);return n.ease=e.ease,n.duration=fc(e.duration),n.type="keyframes",n};function r3({keyframes:n,velocity:e=0,power:t=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:u=.5,restSpeed:c}){const h=n[0],d={done:!1,value:h},f=T=>o!==void 0&&T<o||l!==void 0&&T>l,p=T=>o===void 0?l:l===void 0||Math.abs(o-T)<Math.abs(l-T)?o:l;let m=t*e;const y=h+m,v=a===void 0?y:a(y);v!==y&&(m=v-h);const b=T=>-m*Math.exp(-T/r),x=T=>v+b(T),w=T=>{const S=b(T),M=x(T);d.done=Math.abs(S)<=u,d.value=d.done?v:M};let _,E;const A=T=>{f(d.value)&&(_=T,E=zC({keyframes:[d.value,p(d.value)],velocity:MX(x,T,d.value),damping:i,stiffness:s,restDelta:u,restSpeed:c}))};return A(0),{calculatedDuration:null,next:T=>{let S=!1;return!E&&_===void 0&&(S=!0,w(T),A(T)),_!==void 0&&T>=_?E.next(T-_):(!S&&w(T),d)}}}function Kle(n,e,t){const r=[],i=t||od.mix||AX,s=n.length-1;for(let a=0;a<s;a++){let o=i(n[a],n[a+1]);if(e){const l=Array.isArray(e)?e[a]||wl:e;o=CS(l,o)}r.push(o)}return r}function Yle(n,e,{clamp:t=!0,ease:r,mixer:i}={}){const s=n.length;if(Hk(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const a=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const o=Kle(e,r,i),l=o.length,u=c=>{if(a&&c<n[0])return e[0];let h=0;if(l>1)for(;h<n.length-2&&!(c<n[h+1]);h++);const d=nw(n[h],n[h+1],c);return o[h](d)};return t?c=>u(ad(n[0],n[s-1],c)):u}function Qle(n,e){const t=n[n.length-1];for(let r=1;r<=e;r++){const i=nw(0,e,r);n.push(Or(t,1,i))}}function Zle(n){const e=[0];return Qle(e,n.length-1),e}function Jle(n,e){return n.map(t=>t*e)}function eue(n,e){return n.map(()=>e||mX).splice(0,n.length-1)}function A1({duration:n=300,keyframes:e,times:t,ease:r="easeInOut"}){const i=hle(r)?r.map(CV):CV(r),s={done:!1,value:e[0]},a=Jle(t&&t.length===e.length?t:Zle(e),n),o=Yle(a,e,{ease:Array.isArray(i)?i:eue(e,i)});return{calculatedDuration:n,next:l=>(s.value=o(l),s.done=l>=n,s)}}const tue=n=>n!==null;function eB(n,{repeat:e,repeatType:t="loop"},r,i=1){const s=n.filter(tue),o=i<0||e&&t!=="loop"&&e%2===1?0:s.length-1;return!o||r===void 0?s[o]:r}const nue={decay:r3,inertia:r3,tween:A1,keyframes:A1,spring:zC};function CX(n){typeof n.type=="string"&&(n.type=nue[n.type])}class tB{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const rue=n=>n/100;class nB extends tB{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var r,i;const{motionValue:t}=this.options;t&&t.updatedAt!==Ka.now()&&this.tick(Ka.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(i=(r=this.options).onStop)==null||i.call(r))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;CX(e);const{type:t=A1,repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:a=0}=e;let{keyframes:o}=e;const l=t||A1;l!==A1&&typeof o[0]!="number"&&(this.mixKeyframes=CS(rue,AX(o[0],o[1])),o=[0,100]);const u=l({...e,keyframes:o});s==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...o].reverse(),velocity:-a})),u.calculatedDuration===null&&(u.calculatedDuration=Jk(u));const{calculatedDuration:c}=u;this.calculatedDuration=c,this.resolvedDuration=c+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=u}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:r,totalDuration:i,mixKeyframes:s,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:u=0,keyframes:c,repeat:h,repeatType:d,repeatDelay:f,type:p,onUpdate:m,finalKeyframe:y}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const v=this.currentTime-u*(this.playbackSpeed>=0?1:-1),b=this.playbackSpeed>=0?v<0:v>i;this.currentTime=Math.max(v,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let x=this.currentTime,w=r;if(h){const T=Math.min(this.currentTime,i)/o;let S=Math.floor(T),M=T%1;!M&&T>=1&&(M=1),M===1&&S--,S=Math.min(S,h+1),!!(S%2)&&(d==="reverse"?(M=1-M,f&&(M-=f/o)):d==="mirror"&&(w=a)),x=ad(0,1,M)*o}const _=b?{done:!1,value:c[0]}:w.next(x);s&&(_.value=s(_.value));let{done:E}=_;!b&&l!==null&&(E=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&E);return A&&p!==r3&&(_.value=eB(c,this.options,y,this.speed)),m&&m(_.value),A&&this.finish(),_}then(e,t){return this.finished.then(e,t)}get duration(){return bl(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+bl(e)}get time(){return bl(this.currentTime)}set time(e){var t;e=fc(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(t=this.driver)==null||t.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Ka.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=bl(this.currentTime))}play(){var i,s;if(this.isStopped)return;const{driver:e=Vle,startTime:t}=this.options;this.driver||(this.driver=e(a=>this.tick(a))),(s=(i=this.options).onPlay)==null||s.call(i);const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=t??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ka.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,t;this.notifyFinished(),this.teardown(),this.state="finished",(t=(e=this.options).onComplete)==null||t.call(e)}cancel(){var e,t;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(t=(e=this.options).onCancel)==null||t.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var t;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(t=this.driver)==null||t.stop(),e.observe(this)}}function iue(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const zm=n=>n*180/Math.PI,i3=n=>{const e=zm(Math.atan2(n[1],n[0]));return s3(e)},sue={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:i3,rotateZ:i3,skewX:n=>zm(Math.atan(n[1])),skewY:n=>zm(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},s3=n=>(n=n%360,n<0&&(n+=360),n),FV=i3,LV=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),OV=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),aue={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:LV,scaleY:OV,scale:n=>(LV(n)+OV(n))/2,rotateX:n=>s3(zm(Math.atan2(n[6],n[5]))),rotateY:n=>s3(zm(Math.atan2(-n[2],n[0]))),rotateZ:FV,rotate:FV,skewX:n=>zm(Math.atan(n[4])),skewY:n=>zm(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function a3(n){return n.includes("scale")?1:0}function o3(n,e){if(!n||n==="none")return a3(e);const t=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(t)r=aue,i=t;else{const o=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=sue,i=o}if(!i)return a3(e);const s=r[e],a=i[1].split(",").map(lue);return typeof s=="function"?s(a):a[s]}const oue=(n,e)=>{const{transform:t="none"}=getComputedStyle(n);return o3(t,e)};function lue(n){return parseFloat(n.trim())}const Ob=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],kb=new Set(Ob),kV=n=>n===Lb||n===kt,uue=new Set(["x","y","z"]),cue=Ob.filter(n=>!uue.has(n));function hue(n){const e=[];return cue.forEach(t=>{const r=n.getValue(t);r!==void 0&&(e.push([t,r.get()]),r.set(t.startsWith("scale")?1:0))}),e}const cv={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>o3(e,"x"),y:(n,{transform:e})=>o3(e,"y")};cv.translateX=cv.x;cv.translateY=cv.y;const hv=new Set;let l3=!1,u3=!1,c3=!1;function DX(){if(u3){const n=Array.from(hv).filter(r=>r.needsMeasurement),e=new Set(n.map(r=>r.element)),t=new Map;e.forEach(r=>{const i=hue(r);i.length&&(t.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=t.get(r);i&&i.forEach(([s,a])=>{var o;(o=r.getValue(s))==null||o.set(a)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}u3=!1,l3=!1,hv.forEach(n=>n.complete(c3)),hv.clear()}function NX(){hv.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(u3=!0)})}function due(){c3=!0,NX(),DX(),c3=!1}class rB{constructor(e,t,r,i,s,a=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=i,this.element=s,this.isAsync=a}scheduleResolve(){this.state="scheduled",this.isAsync?(hv.add(this),l3||(l3=!0,Nr.read(NX),Nr.resolveKeyframes(DX))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:i}=this;if(e[0]===null){const s=i==null?void 0:i.get(),a=e[e.length-1];if(s!==void 0)e[0]=s;else if(r&&t){const o=r.readValue(t,a);o!=null&&(e[0]=o)}e[0]===void 0&&(e[0]=a),i&&s===void 0&&i.set(e[0])}iue(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),hv.delete(this)}cancel(){this.state==="scheduled"&&(hv.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const fue=n=>n.startsWith("--");function pue(n,e,t){fue(e)?n.style.setProperty(e,t):n.style[e]=t}const mue=Gk(()=>window.ScrollTimeline!==void 0),gue={};function vue(n,e){const t=Gk(n);return()=>gue[e]??t()}const RX=vue(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),k_=([n,e,t,r])=>`cubic-bezier(${n}, ${e}, ${t}, ${r})`,BV={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:k_([0,.65,.55,1]),circOut:k_([.55,0,1,.45]),backIn:k_([.31,.01,.66,-.59]),backOut:k_([.33,1.53,.69,.99])};function IX(n,e){if(n)return typeof n=="function"?RX()?TX(n,e):"ease-out":gX(n)?k_(n):Array.isArray(n)?n.map(t=>IX(t,e)||BV.easeOut):BV[n]}function yue(n,e,t,{delay:r=0,duration:i=300,repeat:s=0,repeatType:a="loop",ease:o="easeOut",times:l}={},u=void 0){const c={[e]:t};l&&(c.offset=l);const h=IX(o,i);Array.isArray(h)&&(c.easing=h);const d={delay:r,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"};return u&&(d.pseudoElement=u),n.animate(c,d)}function PX(n){return typeof n=="function"&&"applyToOptions"in n}function xue({type:n,...e}){return PX(n)&&RX()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class bue extends tB{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:r,keyframes:i,pseudoElement:s,allowFlatten:a=!1,finalKeyframe:o,onComplete:l}=e;this.isPseudoElement=!!s,this.allowFlatten=a,this.options=e,Hk(typeof e.type!="string");const u=xue(e);this.animation=yue(t,r,i,u,s),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const c=eB(i,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(c):pue(t,r,c),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,t;(t=(e=this.animation).finish)==null||t.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,t;this.isPseudoElement||(t=(e=this.animation).commitStyles)==null||t.call(e)}get duration(){var t,r;const e=((r=(t=this.animation.effect)==null?void 0:t.getComputedTiming)==null?void 0:r.call(t).duration)||0;return bl(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+bl(e)}get time(){return bl(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=fc(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&mue()?(this.animation.timeline=e,wl):t(this)}}const FX={anticipate:dX,backInOut:hX,circInOut:pX};function _ue(n){return n in FX}function wue(n){typeof n.ease=="string"&&_ue(n.ease)&&(n.ease=FX[n.ease])}const UV=10;class Eue extends bue{constructor(e){wue(e),CX(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:r,onComplete:i,element:s,...a}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const o=new nB({...a,autoplay:!1}),l=fc(this.finishedTime??this.time);t.setWithVelocity(o.sample(l-UV).value,o.sample(l).value,UV),o.stop()}}const VV=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(wp.test(n)||n==="0")&&!n.startsWith("url("));function Sue(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function Aue(n,e,t,r){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],a=VV(i,e),o=VV(s,e);return!a||!o?!1:Sue(n)||(t==="spring"||PX(t))&&r}function h3(n){n.duration=0,n.type="keyframes"}const Tue=new Set(["opacity","clipPath","filter","transform"]),Mue=Gk(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Cue(n){var c;const{motionValue:e,name:t,repeatDelay:r,repeatType:i,damping:s,type:a}=n;if(!(((c=e==null?void 0:e.owner)==null?void 0:c.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=e.owner.getProps();return Mue()&&t&&Tue.has(t)&&(t!=="transform"||!u)&&!l&&!r&&i!=="mirror"&&s!==0&&a!=="inertia"}const Due=40;class Nue extends tB{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:a="loop",keyframes:o,name:l,motionValue:u,element:c,...h}){var p;super(),this.stop=()=>{var m,y;this._animation&&(this._animation.stop(),(m=this.stopTimeline)==null||m.call(this)),(y=this.keyframeResolver)==null||y.cancel()},this.createdAt=Ka.now();const d={autoplay:e,delay:t,type:r,repeat:i,repeatDelay:s,repeatType:a,name:l,motionValue:u,element:c,...h},f=(c==null?void 0:c.KeyframeResolver)||rB;this.keyframeResolver=new f(o,(m,y,v)=>this.onKeyframesResolved(m,y,d,!v),l,u,c),(p=this.keyframeResolver)==null||p.scheduleResolve()}onKeyframesResolved(e,t,r,i){this.keyframeResolver=void 0;const{name:s,type:a,velocity:o,delay:l,isHandoff:u,onUpdate:c}=r;this.resolvedAt=Ka.now(),Aue(e,s,a,o)||((od.instantAnimations||!l)&&(c==null||c(eB(e,r,t))),e[0]=e[e.length-1],h3(r),r.repeat=0);const d={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>Due?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...r,keyframes:e},f=!u&&Cue(d)?new Eue({...d,element:d.motionValue.owner.current}):new nB(d);f.finished.then(()=>this.notifyFinished()).catch(wl),this.pendingTimeline&&(this.stopTimeline=f.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=f}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),due()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const Rue=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Iue(n){const e=Rue.exec(n);if(!e)return[,];const[,t,r,i]=e;return[`--${t??r}`,i]}function LX(n,e,t=1){const[r,i]=Iue(n);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const a=s.trim();return rX(a)?parseFloat(a):a}return Kk(i)?LX(i,e,t+1):i}function iB(n,e){return(n==null?void 0:n[e])??(n==null?void 0:n.default)??n}const OX=new Set(["width","height","top","left","right","bottom",...Ob]),Pue={test:n=>n==="auto",parse:n=>n},kX=n=>e=>e.test(n),BX=[Lb,kt,pc,Hd,Sle,Ele,Pue],zV=n=>BX.find(kX(n));function Fue(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||sX(n):!0}const Lue=new Set(["brightness","contrast","saturate","opacity"]);function Oue(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[r]=t.match(Yk)||[];if(!r)return n;const i=t.replace(r,"");let s=Lue.has(e)?1:0;return r!==t&&(s*=100),e+"("+s+i+")"}const kue=/\b([a-z-]*)\(.*?\)/gu,d3={...wp,getAnimatableNone:n=>{const e=n.match(kue);return e?e.map(Oue).join(" "):n}},$V={...Lb,transform:Math.round},Bue={rotate:Hd,rotateX:Hd,rotateY:Hd,rotateZ:Hd,scale:HA,scaleX:HA,scaleY:HA,scaleZ:HA,skew:Hd,skewX:Hd,skewY:Hd,distance:kt,translateX:kt,translateY:kt,translateZ:kt,x:kt,y:kt,z:kt,perspective:kt,transformPerspective:kt,opacity:rw,originX:DV,originY:DV,originZ:kt},sB={borderWidth:kt,borderTopWidth:kt,borderRightWidth:kt,borderBottomWidth:kt,borderLeftWidth:kt,borderRadius:kt,radius:kt,borderTopLeftRadius:kt,borderTopRightRadius:kt,borderBottomRightRadius:kt,borderBottomLeftRadius:kt,width:kt,maxWidth:kt,height:kt,maxHeight:kt,top:kt,right:kt,bottom:kt,left:kt,padding:kt,paddingTop:kt,paddingRight:kt,paddingBottom:kt,paddingLeft:kt,margin:kt,marginTop:kt,marginRight:kt,marginBottom:kt,marginLeft:kt,backgroundPositionX:kt,backgroundPositionY:kt,...Bue,zIndex:$V,fillOpacity:rw,strokeOpacity:rw,numOctaves:$V},Uue={...sB,color:gi,backgroundColor:gi,outlineColor:gi,fill:gi,stroke:gi,borderColor:gi,borderTopColor:gi,borderRightColor:gi,borderBottomColor:gi,borderLeftColor:gi,filter:d3,WebkitFilter:d3},UX=n=>Uue[n];function VX(n,e){let t=UX(n);return t!==d3&&(t=wp),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const Vue=new Set(["auto","none","0"]);function zue(n,e,t){let r=0,i;for(;r<n.length&&!i;){const s=n[r];typeof s=="string"&&!Vue.has(s)&&iw(s).values.length&&(i=n[r]),r++}if(i&&t)for(const s of e)n[s]=VX(t,i)}class $ue extends rB{constructor(e,t,r,i,s){super(e,t,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),Kk(u))){const c=LX(u,t.current);c!==void 0&&(e[l]=c),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!OX.has(r)||e.length!==2)return;const[i,s]=e,a=zV(i),o=zV(s);if(a!==o)if(kV(a)&&kV(o))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else cv[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let i=0;i<e.length;i++)(e[i]===null||Fue(e[i]))&&r.push(i);r.length&&zue(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=cv[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var o;const{element:e,name:t,unresolvedKeyframes:r}=this;if(!e||!e.current)return;const i=e.getValue(t);i&&i.jump(this.measuredOrigin,!1);const s=r.length-1,a=r[s];r[s]=cv[t](e.measureViewportBox(),window.getComputedStyle(e.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([l,u])=>{e.getValue(l).set(u)}),this.resolveNoneKeyframes()}}function Hue(n,e,t){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let r=document;const i=(t==null?void 0:t[n])??r.querySelectorAll(n);return i?Array.from(i):[]}return Array.from(n)}const zX=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function Gue(n){return iX(n)&&"offsetHeight"in n}const HV=30,jue=n=>!isNaN(parseFloat(n));class que{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{var s;const i=Ka.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((s=this.events.change)==null||s.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Ka.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=jue(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new jk);const r=this.events[e].add(t);return e==="change"?()=>{r(),Nr.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Ka.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>HV)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,HV);return aX(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,t;(e=this.dependents)==null||e.clear(),(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ob(n,e){return new que(n,e)}const{schedule:aB}=vX(queueMicrotask,!1),Vl={x:!1,y:!1};function $X(){return Vl.x||Vl.y}function Wue(n){return n==="x"||n==="y"?Vl[n]?null:(Vl[n]=!0,()=>{Vl[n]=!1}):Vl.x||Vl.y?null:(Vl.x=Vl.y=!0,()=>{Vl.x=Vl.y=!1})}function HX(n,e){const t=Hue(n),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[t,i,()=>r.abort()]}function GV(n){return!(n.pointerType==="touch"||$X())}function Xue(n,e,t={}){const[r,i,s]=HX(n,t),a=o=>{if(!GV(o))return;const{target:l}=o,u=e(l,o);if(typeof u!="function"||!l)return;const c=h=>{GV(h)&&(u(h),l.removeEventListener("pointerleave",c))};l.addEventListener("pointerleave",c,i)};return r.forEach(o=>{o.addEventListener("pointerenter",a,i)}),s}const GX=(n,e)=>e?n===e?!0:GX(n,e.parentElement):!1,oB=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,Kue=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Yue(n){return Kue.has(n.tagName)||n.tabIndex!==-1}const hM=new WeakSet;function jV(n){return e=>{e.key==="Enter"&&n(e)}}function FR(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Que=(n,e)=>{const t=n.currentTarget;if(!t)return;const r=jV(()=>{if(hM.has(t))return;FR(t,"down");const i=jV(()=>{FR(t,"up")}),s=()=>FR(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",r,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",r),e)};function qV(n){return oB(n)&&!$X()}function Zue(n,e,t={}){const[r,i,s]=HX(n,t),a=o=>{const l=o.currentTarget;if(!qV(o))return;hM.add(l);const u=e(l,o),c=(f,p)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",d),hM.has(l)&&hM.delete(l),qV(f)&&typeof u=="function"&&u(f,{success:p})},h=f=>{c(f,l===window||l===document||t.useGlobalTarget||GX(l,f.target))},d=f=>{c(f,!1)};window.addEventListener("pointerup",h,i),window.addEventListener("pointercancel",d,i)};return r.forEach(o=>{(t.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),Gue(o)&&(o.addEventListener("focus",u=>Que(u,i)),!Yue(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),s}function jX(n){return iX(n)&&"ownerSVGElement"in n}function Jue(n){return jX(n)&&n.tagName==="svg"}const Ks=n=>!!(n&&n.getVelocity),ece=[...BX,gi,wp],tce=n=>ece.find(kX(n)),qX=xe.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function nce(n=!0){const e=xe.useContext(Vk);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:i}=e,s=xe.useId();xe.useEffect(()=>{if(n)return i(s)},[n]);const a=xe.useCallback(()=>n&&r&&r(s),[s,r,n]);return!t&&r?[!1,a]:[!0]}const WX=xe.createContext({strict:!1}),WV={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},lb={};for(const n in WV)lb[n]={isEnabled:e=>WV[n].some(t=>!!e[t])};function rce(n){for(const e in n)lb[e]={...lb[e],...n[e]}}const ice=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function $C(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||ice.has(n)}let XX=n=>!$C(n);function sce(n){typeof n=="function"&&(XX=e=>e.startsWith("on")?!$C(e):n(e))}try{sce(require("@emotion/is-prop-valid").default)}catch{}function ace(n,e,t){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(XX(i)||t===!0&&$C(i)||!e&&!$C(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}const V2=xe.createContext({});function z2(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function sw(n){return typeof n=="string"||Array.isArray(n)}const lB=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],uB=["initial",...lB];function $2(n){return z2(n.animate)||uB.some(e=>sw(n[e]))}function KX(n){return!!($2(n)||n.variants)}function oce(n,e){if($2(n)){const{initial:t,animate:r}=n;return{initial:t===!1||sw(t)?t:void 0,animate:sw(r)?r:void 0}}return n.inherit!==!1?e:{}}function lce(n){const{initial:e,animate:t}=oce(n,xe.useContext(V2));return xe.useMemo(()=>({initial:e,animate:t}),[XV(e),XV(t)])}function XV(n){return Array.isArray(n)?n.join(" "):n}const aw={};function uce(n){for(const e in n)aw[e]=n[e],Xk(e)&&(aw[e].isCSSVariable=!0)}function YX(n,{layout:e,layoutId:t}){return kb.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!aw[n]||n==="opacity")}const cce={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},hce=Ob.length;function dce(n,e,t){let r="",i=!0;for(let s=0;s<hce;s++){const a=Ob[s],o=n[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||t){const u=zX(o,sB[a]);if(!l){i=!1;const c=cce[a]||a;r+=`${c}(${u}) `}t&&(e[a]=u)}}return r=r.trim(),t?r=t(e,i?"":r):i&&(r="none"),r}function cB(n,e,t){const{style:r,vars:i,transformOrigin:s}=n;let a=!1,o=!1;for(const l in e){const u=e[l];if(kb.has(l)){a=!0;continue}else if(Xk(l)){i[l]=u;continue}else{const c=zX(u,sB[l]);l.startsWith("origin")?(o=!0,s[l]=c):r[l]=c}}if(e.transform||(a||t?r.transform=dce(e,n.transform,t):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:u="50%",originZ:c=0}=s;r.transformOrigin=`${l} ${u} ${c}`}}const hB=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function QX(n,e,t){for(const r in e)!Ks(e[r])&&!YX(r,t)&&(n[r]=e[r])}function fce({transformTemplate:n},e){return xe.useMemo(()=>{const t=hB();return cB(t,e,n),Object.assign({},t.vars,t.style)},[e])}function pce(n,e){const t=n.style||{},r={};return QX(r,t,n),Object.assign(r,fce(n,e)),r}function mce(n,e){const t={},r=pce(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=r,t}const gce={offset:"stroke-dashoffset",array:"stroke-dasharray"},vce={offset:"strokeDashoffset",array:"strokeDasharray"};function yce(n,e,t=1,r=0,i=!0){n.pathLength=1;const s=i?gce:vce;n[s.offset]=kt.transform(-r);const a=kt.transform(e),o=kt.transform(t);n[s.array]=`${a} ${o}`}function ZX(n,{attrX:e,attrY:t,attrScale:r,pathLength:i,pathSpacing:s=1,pathOffset:a=0,...o},l,u,c){if(cB(n,o,u),l){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:h,style:d}=n;h.transform&&(d.transform=h.transform,delete h.transform),(d.transform||h.transformOrigin)&&(d.transformOrigin=h.transformOrigin??"50% 50%",delete h.transformOrigin),d.transform&&(d.transformBox=(c==null?void 0:c.transformBox)??"fill-box",delete h.transformBox),e!==void 0&&(h.x=e),t!==void 0&&(h.y=t),r!==void 0&&(h.scale=r),i!==void 0&&yce(h,i,s,a,!1)}const JX=()=>({...hB(),attrs:{}}),eK=n=>typeof n=="string"&&n.toLowerCase()==="svg";function xce(n,e,t,r){const i=xe.useMemo(()=>{const s=JX();return ZX(s,e,eK(r),n.transformTemplate,n.style),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};QX(s,n.style,n),i.style={...s,...i.style}}return i}const bce=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function dB(n){return typeof n!="string"||n.includes("-")?!1:!!(bce.indexOf(n)>-1||/[A-Z]/u.test(n))}function _ce(n,e,t,{latestValues:r},i,s=!1){const o=(dB(n)?xce:mce)(e,r,i,n),l=ace(e,typeof n=="string",s),u=n!==xe.Fragment?{...l,...o,ref:t}:{},{children:c}=e,h=xe.useMemo(()=>Ks(c)?c.get():c,[c]);return xe.createElement(n,{...u,children:h})}function KV(n){const e=[{},{}];return n==null||n.values.forEach((t,r)=>{e[0][r]=t.get(),e[1][r]=t.getVelocity()}),e}function fB(n,e,t,r){if(typeof e=="function"){const[i,s]=KV(r);e=e(t!==void 0?t:n.custom,i,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,s]=KV(r);e=e(t!==void 0?t:n.custom,i,s)}return e}function dM(n){return Ks(n)?n.get():n}function wce({scrapeMotionValuesFromProps:n,createRenderState:e},t,r,i){return{latestValues:Ece(t,r,i,n),renderState:e()}}function Ece(n,e,t,r){const i={},s=r(n,{});for(const d in s)i[d]=dM(s[d]);let{initial:a,animate:o}=n;const l=$2(n),u=KX(n);e&&u&&!l&&n.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let c=t?t.initial===!1:!1;c=c||a===!1;const h=c?o:a;if(h&&typeof h!="boolean"&&!z2(h)){const d=Array.isArray(h)?h:[h];for(let f=0;f<d.length;f++){const p=fB(n,d[f]);if(p){const{transitionEnd:m,transition:y,...v}=p;for(const b in v){let x=v[b];if(Array.isArray(x)){const w=c?x.length-1:0;x=x[w]}x!==null&&(i[b]=x)}for(const b in m)i[b]=m[b]}}}return i}const tK=n=>(e,t)=>{const r=xe.useContext(V2),i=xe.useContext(Vk),s=()=>wce(n,e,r,i);return t?s():rle(s)};function pB(n,e,t){var s;const{style:r}=n,i={};for(const a in r)(Ks(r[a])||e.style&&Ks(e.style[a])||YX(a,n)||((s=t==null?void 0:t.getValue(a))==null?void 0:s.liveStyle)!==void 0)&&(i[a]=r[a]);return i}const Sce=tK({scrapeMotionValuesFromProps:pB,createRenderState:hB});function nK(n,e,t){const r=pB(n,e,t);for(const i in n)if(Ks(n[i])||Ks(e[i])){const s=Ob.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=n[i]}return r}const Ace=tK({scrapeMotionValuesFromProps:nK,createRenderState:JX}),Tce=Symbol.for("motionComponentSymbol");function Z0(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function Mce(n,e,t){return xe.useCallback(r=>{r&&n.onMount&&n.onMount(r),e&&(r?e.mount(r):e.unmount()),t&&(typeof t=="function"?t(r):Z0(t)&&(t.current=r))},[e])}const mB=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Cce="framerAppearId",rK="data-"+mB(Cce),iK=xe.createContext({});function Dce(n,e,t,r,i){var m,y;const{visualElement:s}=xe.useContext(V2),a=xe.useContext(WX),o=xe.useContext(Vk),l=xe.useContext(qX).reducedMotion,u=xe.useRef(null);r=r||a.renderer,!u.current&&r&&(u.current=r(n,{visualState:e,parent:s,props:t,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const c=u.current,h=xe.useContext(iK);c&&!c.projection&&i&&(c.type==="html"||c.type==="svg")&&Nce(u.current,t,i,h);const d=xe.useRef(!1);xe.useInsertionEffect(()=>{c&&d.current&&c.update(t,o)});const f=t[rK],p=xe.useRef(!!f&&!((m=window.MotionHandoffIsComplete)!=null&&m.call(window,f))&&((y=window.MotionHasOptimisedAnimation)==null?void 0:y.call(window,f)));return ile(()=>{c&&(d.current=!0,window.MotionIsMounted=!0,c.updateFeatures(),c.scheduleRenderMicrotask(),p.current&&c.animationState&&c.animationState.animateChanges())}),xe.useEffect(()=>{c&&(!p.current&&c.animationState&&c.animationState.animateChanges(),p.current&&(queueMicrotask(()=>{var v;(v=window.MotionHandoffMarkAsComplete)==null||v.call(window,f)}),p.current=!1),c.enteringChildren=void 0)}),c}function Nce(n,e,t,r){const{layoutId:i,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:u,layoutCrossfade:c}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:sK(n.parent)),n.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!a||o&&Z0(o),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,crossfade:c,layoutScroll:l,layoutRoot:u})}function sK(n){if(n)return n.options.allowProjection!==!1?n.projection:sK(n.parent)}function LR(n,{forwardMotionProps:e=!1}={},t,r){t&&rce(t);const i=dB(n)?Ace:Sce;function s(o,l){let u;const c={...xe.useContext(qX),...o,layoutId:Rce(o)},{isStatic:h}=c,d=lce(o),f=i(o,h);if(!h&&Uk){Ice();const p=Pce(c);u=p.MeasureLayout,d.visualElement=Dce(n,f,c,r,p.ProjectionNode)}return k.jsxs(V2.Provider,{value:d,children:[u&&d.visualElement?k.jsx(u,{visualElement:d.visualElement,...c}):null,_ce(n,o,Mce(f,d.visualElement,l),f,h,e)]})}s.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const a=xe.forwardRef(s);return a[Tce]=n,a}function Rce({layoutId:n}){const e=xe.useContext(nX).id;return e&&n!==void 0?e+"-"+n:n}function Ice(n,e){xe.useContext(WX).strict}function Pce(n){const{drag:e,layout:t}=lb;if(!e&&!t)return{};const r={...e,...t};return{MeasureLayout:e!=null&&e.isEnabled(n)||t!=null&&t.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function Fce(n,e){if(typeof Proxy>"u")return LR;const t=new Map,r=(s,a)=>LR(s,a,n,e),i=(s,a)=>r(s,a);return new Proxy(i,{get:(s,a)=>a==="create"?r:(t.has(a)||t.set(a,LR(a,void 0,n,e)),t.get(a))})}function aK({top:n,left:e,right:t,bottom:r}){return{x:{min:e,max:t},y:{min:n,max:r}}}function Lce({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function Oce(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),r=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:r.y,right:r.x}}function OR(n){return n===void 0||n===1}function f3({scale:n,scaleX:e,scaleY:t}){return!OR(n)||!OR(e)||!OR(t)}function Sm(n){return f3(n)||oK(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function oK(n){return YV(n.x)||YV(n.y)}function YV(n){return n&&n!=="0%"}function HC(n,e,t){const r=n-t,i=e*r;return t+i}function QV(n,e,t,r,i){return i!==void 0&&(n=HC(n,i,r)),HC(n,t,r)+e}function p3(n,e=0,t=1,r,i){n.min=QV(n.min,e,t,r,i),n.max=QV(n.max,e,t,r,i)}function lK(n,{x:e,y:t}){p3(n.x,e.translate,e.scale,e.originPoint),p3(n.y,t.translate,t.scale,t.originPoint)}const ZV=.999999999999,JV=1.0000000000001;function kce(n,e,t,r=!1){const i=t.length;if(!i)return;e.x=e.y=1;let s,a;for(let o=0;o<i;o++){s=t[o],a=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&ey(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,lK(n,a)),r&&Sm(s.latestValues)&&ey(n,s.latestValues))}e.x<JV&&e.x>ZV&&(e.x=1),e.y<JV&&e.y>ZV&&(e.y=1)}function J0(n,e){n.min=n.min+e,n.max=n.max+e}function e6(n,e,t,r,i=.5){const s=Or(n.min,n.max,i);p3(n,e,t,s,r)}function ey(n,e){e6(n.x,e.x,e.scaleX,e.scale,e.originX),e6(n.y,e.y,e.scaleY,e.scale,e.originY)}function uK(n,e){return aK(Oce(n.getBoundingClientRect(),e))}function Bce(n,e,t){const r=uK(n,t),{scroll:i}=e;return i&&(J0(r.x,i.offset.x),J0(r.y,i.offset.y)),r}const t6=()=>({translate:0,scale:1,origin:0,originPoint:0}),ty=()=>({x:t6(),y:t6()}),n6=()=>({min:0,max:0}),ri=()=>({x:n6(),y:n6()}),m3={current:null},cK={current:!1};function Uce(){if(cK.current=!0,!!Uk)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>m3.current=n.matches;n.addEventListener("change",e),e()}else m3.current=!1}const Vce=new WeakMap;function zce(n,e,t){for(const r in e){const i=e[r],s=t[r];if(Ks(i))n.addValue(r,i);else if(Ks(s))n.addValue(r,ob(i,{owner:n}));else if(s!==i)if(n.hasValue(r)){const a=n.getValue(r);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=n.getStaticValue(r);n.addValue(r,ob(a!==void 0?a:i,{owner:n}))}}for(const r in t)e[r]===void 0&&n.removeValue(r);return e}const r6=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class $ce{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=rB,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const d=Ka.now();this.renderScheduledAt<d&&(this.renderScheduledAt=d,Nr.render(this.render,!1,!0))};const{latestValues:l,renderState:u}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!s,this.isControllingVariants=$2(t),this.isVariantNode=KX(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:c,...h}=this.scrapeMotionValuesFromProps(t,{},this);for(const d in h){const f=h[d];l[d]!==void 0&&Ks(f)&&f.set(l[d])}}mount(e){var t;this.current=e,Vce.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,i)=>this.bindToMotionValue(i,r)),cK.current||Uce(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:m3.current,(t=this.parent)==null||t.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),_p(this.notifyUpdate),_p(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=kb.has(e);r&&this.onBindTransform&&this.onBindTransform();const i=t.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&Nr.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let s;window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),s&&s(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in lb){const t=lb[e];if(!t)continue;const{isEnabled:r,Feature:i}=t;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ri()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<r6.length;r++){const i=r6[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,a=e[s];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=zce(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&t!==void 0&&(r=ob(t===null?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(rX(r)||sX(r))?r=parseFloat(r):!tce(r)&&wp.test(t)&&(r=VX(e,t)),this.setBaseTarget(e,Ks(r)?r.get():r)),Ks(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var s;const{initial:t}=this.props;let r;if(typeof t=="string"||typeof t=="object"){const a=fB(this.props,t,(s=this.presenceContext)==null?void 0:s.custom);a&&(r=a[e])}if(t&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Ks(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new jk),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){aB.render(this.render)}}class hK extends $ce{constructor(){super(...arguments),this.KeyframeResolver=$ue}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ks(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function dK(n,{style:e,vars:t},r,i){const s=n.style;let a;for(a in e)s[a]=e[a];i==null||i.applyProjectionStyles(s,r);for(a in t)s.setProperty(a,t[a])}function Hce(n){return window.getComputedStyle(n)}class Gce extends hK{constructor(){super(...arguments),this.type="html",this.renderInstance=dK}readValueFromInstance(e,t){var r;if(kb.has(t))return(r=this.projection)!=null&&r.isProjecting?a3(t):oue(e,t);{const i=Hce(e),s=(Xk(t)?i.getPropertyValue(t):i[t])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:t}){return uK(e,t)}build(e,t,r){cB(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return pB(e,t,r)}}const fK=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function jce(n,e,t,r){dK(n,e,void 0,r);for(const i in e.attrs)n.setAttribute(fK.has(i)?i:mB(i),e.attrs[i])}class qce extends hK{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ri}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(kb.has(t)){const r=UX(t);return r&&r.default||0}return t=fK.has(t)?t:mB(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return nK(e,t,r)}build(e,t,r){ZX(e,t,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,t,r,i){jce(e,t,r,i)}mount(e){this.isSVGTag=eK(e.tagName),super.mount(e)}}const Wce=(n,e)=>dB(n)?new qce(e):new Gce(e,{allowProjection:n!==xe.Fragment});function yy(n,e,t){const r=n.getProps();return fB(r,e,t!==void 0?t:r.custom,n)}const g3=n=>Array.isArray(n);function Xce(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,ob(t))}function Kce(n){return g3(n)?n[n.length-1]||0:n}function Yce(n,e){const t=yy(n,e);let{transitionEnd:r={},transition:i={},...s}=t||{};s={...s,...r};for(const a in s){const o=Kce(s[a]);Xce(n,a,o)}}function Qce(n){return!!(Ks(n)&&n.add)}function v3(n,e){const t=n.getValue("willChange");if(Qce(t))return t.add(e);if(!t&&od.WillChange){const r=new od.WillChange("auto");n.addValue("willChange",r),r.add(e)}}function pK(n){return n.props[rK]}const Zce=n=>n!==null;function Jce(n,{repeat:e,repeatType:t="loop"},r){const i=n.filter(Zce),s=e&&t!=="loop"&&e%2===1?0:i.length-1;return i[s]}const ehe={type:"spring",stiffness:500,damping:25,restSpeed:10},the=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),nhe={type:"keyframes",duration:.8},rhe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},ihe=(n,{keyframes:e})=>e.length>2?nhe:kb.has(n)?n.startsWith("scale")?the(e[1]):ehe:rhe;function she({when:n,delay:e,delayChildren:t,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:u,...c}){return!!Object.keys(c).length}const gB=(n,e,t,r={},i,s)=>a=>{const o=iB(r,n)||{},l=o.delay||r.delay||0;let{elapsed:u=0}=r;u=u-fc(l);const c={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-u,onUpdate:d=>{e.set(d),o.onUpdate&&o.onUpdate(d)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:n,motionValue:e,element:s?void 0:i};she(o)||Object.assign(c,ihe(n,c)),c.duration&&(c.duration=fc(c.duration)),c.repeatDelay&&(c.repeatDelay=fc(c.repeatDelay)),c.from!==void 0&&(c.keyframes[0]=c.from);let h=!1;if((c.type===!1||c.duration===0&&!c.repeatDelay)&&(h3(c),c.delay===0&&(h=!0)),(od.instantAnimations||od.skipAnimations)&&(h=!0,h3(c),c.delay=0),c.allowFlatten=!o.type&&!o.ease,h&&!s&&e.get()!==void 0){const d=Jce(c.keyframes,o);if(d!==void 0){Nr.update(()=>{c.onUpdate(d),c.onComplete()});return}}return o.isSync?new nB(c):new Nue(c)};function ahe({protectedKeys:n,needsAnimating:e},t){const r=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,r}function mK(n,e,{delay:t=0,transitionOverride:r,type:i}={}){let{transition:s=n.getDefaultTransition(),transitionEnd:a,...o}=e;r&&(s=r);const l=[],u=i&&n.animationState&&n.animationState.getState()[i];for(const c in o){const h=n.getValue(c,n.latestValues[c]??null),d=o[c];if(d===void 0||u&&ahe(u,c))continue;const f={delay:t,...iB(s||{},c)},p=h.get();if(p!==void 0&&!h.isAnimating&&!Array.isArray(d)&&d===p&&!f.velocity)continue;let m=!1;if(window.MotionHandoffAnimation){const v=pK(n);if(v){const b=window.MotionHandoffAnimation(v,c,Nr);b!==null&&(f.startTime=b,m=!0)}}v3(n,c),h.start(gB(c,h,d,n.shouldReduceMotion&&OX.has(c)?{type:!1}:f,n,m));const y=h.animation;y&&l.push(y)}return a&&Promise.all(l).then(()=>{Nr.update(()=>{a&&Yce(n,a)})}),l}function gK(n,e,t,r=0,i=1){const s=Array.from(n).sort((u,c)=>u.sortNodePosition(c)).indexOf(e),a=n.size,o=(a-1)*r;return typeof t=="function"?t(s,a):i===1?s*r:o-s*r}function y3(n,e,t={}){var l;const r=yy(n,e,t.type==="exit"?(l=n.presenceContext)==null?void 0:l.custom:void 0);let{transition:i=n.getDefaultTransition()||{}}=r||{};t.transitionOverride&&(i=t.transitionOverride);const s=r?()=>Promise.all(mK(n,r,t)):()=>Promise.resolve(),a=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:c=0,staggerChildren:h,staggerDirection:d}=i;return ohe(n,e,u,c,h,d,t)}:()=>Promise.resolve(),{when:o}=i;if(o){const[u,c]=o==="beforeChildren"?[s,a]:[a,s];return u().then(()=>c())}else return Promise.all([s(),a(t.delay)])}function ohe(n,e,t=0,r=0,i=0,s=1,a){const o=[];for(const l of n.variantChildren)l.notify("AnimationStart",e),o.push(y3(l,e,{...a,delay:t+(typeof r=="function"?0:r)+gK(n.variantChildren,l,r,i,s)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(o)}function lhe(n,e,t={}){n.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>y3(n,s,t));r=Promise.all(i)}else if(typeof e=="string")r=y3(n,e,t);else{const i=typeof e=="function"?yy(n,e,t.custom):e;r=Promise.all(mK(n,i,t))}return r.then(()=>{n.notify("AnimationComplete",e)})}function vK(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let r=0;r<t;r++)if(e[r]!==n[r])return!1;return!0}const uhe=uB.length;function yK(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?yK(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<uhe;t++){const r=uB[t],i=n.props[r];(sw(i)||i===!1)&&(e[r]=i)}return e}const che=[...lB].reverse(),hhe=lB.length;function dhe(n){return e=>Promise.all(e.map(({animation:t,options:r})=>lhe(n,t,r)))}function fhe(n){let e=dhe(n),t=i6(),r=!0;const i=l=>(u,c)=>{var d;const h=yy(n,c,l==="exit"?(d=n.presenceContext)==null?void 0:d.custom:void 0);if(h){const{transition:f,transitionEnd:p,...m}=h;u={...u,...m,...p}}return u};function s(l){e=l(n)}function a(l){const{props:u}=n,c=yK(n.parent)||{},h=[],d=new Set;let f={},p=1/0;for(let y=0;y<hhe;y++){const v=che[y],b=t[v],x=u[v]!==void 0?u[v]:c[v],w=sw(x),_=v===l?b.isActive:null;_===!1&&(p=y);let E=x===c[v]&&x!==u[v]&&w;if(E&&r&&n.manuallyAnimateOnMount&&(E=!1),b.protectedKeys={...f},!b.isActive&&_===null||!x&&!b.prevProp||z2(x)||typeof x=="boolean")continue;const A=phe(b.prevProp,x);let T=A||v===l&&b.isActive&&!E&&w||y>p&&w,S=!1;const M=Array.isArray(x)?x:[x];let D=M.reduce(i(v),{});_===!1&&(D={});const{prevResolvedValues:N={}}=b,R={...N,...D},z=F=>{T=!0,d.has(F)&&(S=!0,d.delete(F)),b.needsAnimating[F]=!0;const $=n.getValue(F);$&&($.liveStyle=!1)};for(const F in R){const $=D[F],H=N[F];if(f.hasOwnProperty(F))continue;let Z=!1;g3($)&&g3(H)?Z=!vK($,H):Z=$!==H,Z?$!=null?z(F):d.add(F):$!==void 0&&d.has(F)?z(F):b.protectedKeys[F]=!0}b.prevProp=x,b.prevResolvedValues=D,b.isActive&&(f={...f,...D}),r&&n.blockInitialAnimation&&(T=!1);const j=E&&A;T&&(!j||S)&&h.push(...M.map(F=>{const $={type:v};if(typeof F=="string"&&r&&!j&&n.manuallyAnimateOnMount&&n.parent){const{parent:H}=n,Z=yy(H,F);if(H.enteringChildren&&Z){const{delayChildren:J}=Z.transition||{};$.delay=gK(H.enteringChildren,n,J)}}return{animation:F,options:$}}))}if(d.size){const y={};if(typeof u.initial!="boolean"){const v=yy(n,Array.isArray(u.initial)?u.initial[0]:u.initial);v&&v.transition&&(y.transition=v.transition)}d.forEach(v=>{const b=n.getBaseTarget(v),x=n.getValue(v);x&&(x.liveStyle=!0),y[v]=b??null}),h.push({animation:y})}let m=!!h.length;return r&&(u.initial===!1||u.initial===u.animate)&&!n.manuallyAnimateOnMount&&(m=!1),r=!1,m?e(h):Promise.resolve()}function o(l,u){var h;if(t[l].isActive===u)return Promise.resolve();(h=n.variantChildren)==null||h.forEach(d=>{var f;return(f=d.animationState)==null?void 0:f.setActive(l,u)}),t[l].isActive=u;const c=a(l);for(const d in t)t[d].protectedKeys={};return c}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>t,reset:()=>{t=i6()}}}function phe(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!vK(e,n):!1}function mm(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function i6(){return{animate:mm(!0),whileInView:mm(),whileHover:mm(),whileTap:mm(),whileDrag:mm(),whileFocus:mm(),exit:mm()}}class Hp{constructor(e){this.isMounted=!1,this.node=e}update(){}}class mhe extends Hp{constructor(e){super(e),e.animationState||(e.animationState=fhe(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();z2(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let ghe=0;class vhe extends Hp{constructor(){super(...arguments),this.id=ghe++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const yhe={animation:{Feature:mhe},exit:{Feature:vhe}};function ow(n,e,t,r={passive:!0}){return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t)}function RS(n){return{point:{x:n.pageX,y:n.pageY}}}const xhe=n=>e=>oB(e)&&n(e,RS(e));function T1(n,e,t,r){return ow(n,e,xhe(t),r)}const xK=1e-4,bhe=1-xK,_he=1+xK,bK=.01,whe=0-bK,Ehe=0+bK;function xa(n){return n.max-n.min}function She(n,e,t){return Math.abs(n-e)<=t}function s6(n,e,t,r=.5){n.origin=r,n.originPoint=Or(e.min,e.max,n.origin),n.scale=xa(t)/xa(e),n.translate=Or(t.min,t.max,n.origin)-n.originPoint,(n.scale>=bhe&&n.scale<=_he||isNaN(n.scale))&&(n.scale=1),(n.translate>=whe&&n.translate<=Ehe||isNaN(n.translate))&&(n.translate=0)}function M1(n,e,t,r){s6(n.x,e.x,t.x,r?r.originX:void 0),s6(n.y,e.y,t.y,r?r.originY:void 0)}function a6(n,e,t){n.min=t.min+e.min,n.max=n.min+xa(e)}function Ahe(n,e,t){a6(n.x,e.x,t.x),a6(n.y,e.y,t.y)}function o6(n,e,t){n.min=e.min-t.min,n.max=n.min+xa(e)}function C1(n,e,t){o6(n.x,e.x,t.x),o6(n.y,e.y,t.y)}function Zo(n){return[n("x"),n("y")]}const _K=({current:n})=>n?n.ownerDocument.defaultView:null,l6=(n,e)=>Math.abs(n-e);function The(n,e){const t=l6(n.x,e.x),r=l6(n.y,e.y);return Math.sqrt(t**2+r**2)}class wK{constructor(e,t,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:s=!1,distanceThreshold:a=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=BR(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,p=The(d.offset,{x:0,y:0})>=this.distanceThreshold;if(!f&&!p)return;const{point:m}=d,{timestamp:y}=gs;this.history.push({...m,timestamp:y});const{onStart:v,onMove:b}=this.handlers;f||(v&&v(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,d)},this.handlePointerMove=(d,f)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=kR(f,this.transformPagePoint),Nr.update(this.updatePoint,!0)},this.handlePointerUp=(d,f)=>{this.end();const{onEnd:p,onSessionEnd:m,resumeAnimation:y}=this.handlers;if(this.dragSnapToOrigin&&y&&y(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=BR(d.type==="pointercancel"?this.lastMoveEventInfo:kR(f,this.transformPagePoint),this.history);this.startEvent&&p&&p(d,v),m&&m(d,v)},!oB(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=r,this.distanceThreshold=a,this.contextWindow=i||window;const o=RS(e),l=kR(o,this.transformPagePoint),{point:u}=l,{timestamp:c}=gs;this.history=[{...u,timestamp:c}];const{onSessionStart:h}=t;h&&h(e,BR(l,this.history)),this.removeListeners=CS(T1(this.contextWindow,"pointermove",this.handlePointerMove),T1(this.contextWindow,"pointerup",this.handlePointerUp),T1(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),_p(this.updatePoint)}}function kR(n,e){return e?{point:e(n.point)}:n}function u6(n,e){return{x:n.x-e.x,y:n.y-e.y}}function BR({point:n},e){return{point:n,delta:u6(n,EK(e)),offset:u6(n,Mhe(e)),velocity:Che(e,.1)}}function Mhe(n){return n[0]}function EK(n){return n[n.length-1]}function Che(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,r=null;const i=EK(n);for(;t>=0&&(r=n[t],!(i.timestamp-r.timestamp>fc(e)));)t--;if(!r)return{x:0,y:0};const s=bl(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const a={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function Dhe(n,{min:e,max:t},r){return e!==void 0&&n<e?n=r?Or(e,n,r.min):Math.max(n,e):t!==void 0&&n>t&&(n=r?Or(t,n,r.max):Math.min(n,t)),n}function c6(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function Nhe(n,{top:e,left:t,bottom:r,right:i}){return{x:c6(n.x,t,i),y:c6(n.y,e,r)}}function h6(n,e){let t=e.min-n.min,r=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,r]=[r,t]),{min:t,max:r}}function Rhe(n,e){return{x:h6(n.x,e.x),y:h6(n.y,e.y)}}function Ihe(n,e){let t=.5;const r=xa(n),i=xa(e);return i>r?t=nw(e.min,e.max-r,n.min):r>i&&(t=nw(n.min,n.max-i,e.min)),ad(0,1,t)}function Phe(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const x3=.35;function Fhe(n=x3){return n===!1?n=0:n===!0&&(n=x3),{x:d6(n,"left","right"),y:d6(n,"top","bottom")}}function d6(n,e,t){return{min:f6(n,e),max:f6(n,t)}}function f6(n,e){return typeof n=="number"?n:n[e]||0}const Lhe=new WeakMap;class Ohe{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ri(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const s=h=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(RS(h).point)},a=(h,d)=>{const{drag:f,dragPropagation:p,onDragStart:m}=this.getProps();if(f&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Wue(f),!this.openDragLock))return;this.latestPointerEvent=h,this.latestPanInfo=d,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Zo(v=>{let b=this.getAxisMotionValue(v).get()||0;if(pc.test(b)){const{projection:x}=this.visualElement;if(x&&x.layout){const w=x.layout.layoutBox[v];w&&(b=xa(w)*(parseFloat(b)/100))}}this.originPoint[v]=b}),m&&Nr.postRender(()=>m(h,d)),v3(this.visualElement,"transform");const{animationState:y}=this.visualElement;y&&y.setActive("whileDrag",!0)},o=(h,d)=>{this.latestPointerEvent=h,this.latestPanInfo=d;const{dragPropagation:f,dragDirectionLock:p,onDirectionLock:m,onDrag:y}=this.getProps();if(!f&&!this.openDragLock)return;const{offset:v}=d;if(p&&this.currentDirection===null){this.currentDirection=khe(v),this.currentDirection!==null&&m&&m(this.currentDirection);return}this.updateAxis("x",d.point,v),this.updateAxis("y",d.point,v),this.visualElement.render(),y&&y(h,d)},l=(h,d)=>{this.latestPointerEvent=h,this.latestPanInfo=d,this.stop(h,d),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>Zo(h=>{var d;return this.getAnimationState(h)==="paused"&&((d=this.getAxisMotionValue(h).animation)==null?void 0:d.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new wK(e,{onSessionStart:s,onStart:a,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,distanceThreshold:r,contextWindow:_K(this.visualElement)})}stop(e,t){const r=e||this.latestPointerEvent,i=t||this.latestPanInfo,s=this.isDragging;if(this.cancel(),!s||!i||!r)return;const{velocity:a}=i;this.startAnimation(a);const{onDragEnd:o}=this.getProps();o&&Nr.postRender(()=>o(r,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:i}=this.getProps();if(!r||!GA(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let a=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(a=Dhe(a,this.constraints[e],this.elastic[e])),s.set(a)}resolveConstraints(){var s;const{dragConstraints:e,dragElastic:t}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(s=this.visualElement.projection)==null?void 0:s.layout,i=this.constraints;e&&Z0(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=Nhe(r.layoutBox,e):this.constraints=!1,this.elastic=Fhe(t),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Zo(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=Phe(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Z0(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=Bce(r,i.root,this.visualElement.getTransformPagePoint());let a=Rhe(i.layout.layoutBox,s);if(t){const o=t(Lce(a));this.hasMutatedConstraints=!!o,o&&(a=aK(o))}return a}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},u=Zo(c=>{if(!GA(c,t,this.currentDirection))return;let h=l&&l[c]||{};a&&(h={min:0,max:0});const d=i?200:1e6,f=i?40:1e7,p={type:"inertia",velocity:r?e[c]:0,bounceStiffness:d,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...s,...h};return this.startAxisValueAnimation(c,p)});return Promise.all(u).then(o)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return v3(this.visualElement,e),r.start(gB(e,r,0,t,this.visualElement,!1))}stopAnimation(){Zo(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Zo(e=>{var t;return(t=this.getAxisMotionValue(e).animation)==null?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)==null?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[t];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Zo(t=>{const{drag:r}=this.getProps();if(!GA(t,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(t);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[t];s.set(e[t]-Or(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!Z0(t)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Zo(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();i[a]=Ihe({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Zo(a=>{if(!GA(a,e,null))return;const o=this.getAxisMotionValue(a),{min:l,max:u}=this.constraints[a];o.set(Or(l,u,i[a]))})}addListeners(){if(!this.visualElement.current)return;Lhe.set(this.visualElement,this);const e=this.visualElement.current,t=T1(e,"pointerdown",l=>{const{drag:u,dragListener:c=!0}=this.getProps();u&&c&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();Z0(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),Nr.read(r);const a=ow(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(Zo(c=>{const h=this.getAxisMotionValue(c);h&&(this.originPoint[c]+=l[c].translate,h.set(h.get()+l[c].translate))}),this.visualElement.render())});return()=>{a(),t(),s(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:a=x3,dragMomentum:o=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function GA(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function khe(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class Bhe extends Hp{constructor(e){super(e),this.removeGroupControls=wl,this.removeListeners=wl,this.controls=new Ohe(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||wl}unmount(){this.removeGroupControls(),this.removeListeners()}}const p6=n=>(e,t)=>{n&&Nr.postRender(()=>n(e,t))};class Uhe extends Hp{constructor(){super(...arguments),this.removePointerDownListener=wl}onPointerDown(e){this.session=new wK(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:_K(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:p6(e),onStart:p6(t),onMove:r,onEnd:(s,a)=>{delete this.session,i&&Nr.postRender(()=>i(s,a))}}}mount(){this.removePointerDownListener=T1(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const fM={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function m6(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const g_={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(kt.test(n))n=parseFloat(n);else return n;const t=m6(n,e.target.x),r=m6(n,e.target.y);return`${t}% ${r}%`}},Vhe={correct:(n,{treeScale:e,projectionDelta:t})=>{const r=n,i=wp.parse(n);if(i.length>5)return r;const s=wp.createTransformer(n),a=typeof i[0]!="number"?1:0,o=t.x.scale*e.x,l=t.y.scale*e.y;i[0+a]/=o,i[1+a]/=l;const u=Or(o,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=u),typeof i[3+a]=="number"&&(i[3+a]/=u),s(i)}};let UR=!1;class zhe extends xe.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;uce($he),s&&(t.group&&t.group.add(s),r&&r.register&&i&&r.register(s),UR&&s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),fM.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:i,isPresent:s}=this.props,{projection:a}=r;return a&&(a.isPresent=s,UR=!0,i||e.layoutDependency!==t||t===void 0||e.isPresent!==s?a.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?a.promote():a.relegate()||Nr.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),aB.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:i}=e;UR=!0,i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function SK(n){const[e,t]=nce(),r=xe.useContext(nX);return k.jsx(zhe,{...n,layoutGroup:r,switchLayoutGroup:xe.useContext(iK),isPresent:e,safeToRemove:t})}const $he={borderRadius:{...g_,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:g_,borderTopRightRadius:g_,borderBottomLeftRadius:g_,borderBottomRightRadius:g_,boxShadow:Vhe};function Hhe(n,e,t){const r=Ks(n)?n:ob(n);return r.start(gB("",r,e,t)),r.animation}const Ghe=(n,e)=>n.depth-e.depth;class jhe{constructor(){this.children=[],this.isDirty=!1}add(e){zk(this.children,e),this.isDirty=!0}remove(e){$k(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Ghe),this.isDirty=!1,this.children.forEach(e)}}function qhe(n,e){const t=Ka.now(),r=({timestamp:i})=>{const s=i-t;s>=e&&(_p(r),n(s-e))};return Nr.setup(r,!0),()=>_p(r)}const AK=["TopLeft","TopRight","BottomLeft","BottomRight"],Whe=AK.length,g6=n=>typeof n=="string"?parseFloat(n):n,v6=n=>typeof n=="number"||kt.test(n);function Xhe(n,e,t,r,i,s){i?(n.opacity=Or(0,t.opacity??1,Khe(r)),n.opacityExit=Or(e.opacity??1,0,Yhe(r))):s&&(n.opacity=Or(e.opacity??1,t.opacity??1,r));for(let a=0;a<Whe;a++){const o=`border${AK[a]}Radius`;let l=y6(e,o),u=y6(t,o);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||v6(l)===v6(u)?(n[o]=Math.max(Or(g6(l),g6(u),r),0),(pc.test(u)||pc.test(l))&&(n[o]+="%")):n[o]=u}(e.rotate||t.rotate)&&(n.rotate=Or(e.rotate||0,t.rotate||0,r))}function y6(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const Khe=TK(0,.5,fX),Yhe=TK(.5,.95,wl);function TK(n,e,t){return r=>r<n?0:r>e?1:t(nw(n,e,r))}function x6(n,e){n.min=e.min,n.max=e.max}function qo(n,e){x6(n.x,e.x),x6(n.y,e.y)}function b6(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function _6(n,e,t,r,i){return n-=e,n=HC(n,1/t,r),i!==void 0&&(n=HC(n,1/i,r)),n}function Qhe(n,e=0,t=1,r=.5,i,s=n,a=n){if(pc.test(e)&&(e=parseFloat(e),e=Or(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=Or(s.min,s.max,r);n===s&&(o-=e),n.min=_6(n.min,e,t,o,i),n.max=_6(n.max,e,t,o,i)}function w6(n,e,[t,r,i],s,a){Qhe(n,e[t],e[r],e[i],e.scale,s,a)}const Zhe=["x","scaleX","originX"],Jhe=["y","scaleY","originY"];function E6(n,e,t,r){w6(n.x,e,Zhe,t?t.x:void 0,r?r.x:void 0),w6(n.y,e,Jhe,t?t.y:void 0,r?r.y:void 0)}function S6(n){return n.translate===0&&n.scale===1}function MK(n){return S6(n.x)&&S6(n.y)}function A6(n,e){return n.min===e.min&&n.max===e.max}function ede(n,e){return A6(n.x,e.x)&&A6(n.y,e.y)}function T6(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function CK(n,e){return T6(n.x,e.x)&&T6(n.y,e.y)}function M6(n){return xa(n.x)/xa(n.y)}function C6(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class tde{constructor(){this.members=[]}add(e){zk(this.members,e),e.scheduleRender()}remove(e){if($k(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let r;for(let i=t;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function nde(n,e,t){let r="";const i=n.x.translate/e.x,s=n.y.translate/e.y,a=(t==null?void 0:t.z)||0;if((i||s||a)&&(r=`translate3d(${i}px, ${s}px, ${a}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:u,rotate:c,rotateX:h,rotateY:d,skewX:f,skewY:p}=t;u&&(r=`perspective(${u}px) ${r}`),c&&(r+=`rotate(${c}deg) `),h&&(r+=`rotateX(${h}deg) `),d&&(r+=`rotateY(${d}deg) `),f&&(r+=`skewX(${f}deg) `),p&&(r+=`skewY(${p}deg) `)}const o=n.x.scale*e.x,l=n.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const VR=["","X","Y","Z"],rde=1e3;let ide=0;function zR(n,e,t,r){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),r&&(r[n]=0))}function DK(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=pK(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Nr,!(i||s))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&DK(r)}function NK({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(a={},o=e==null?void 0:e()){this.id=ide++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(ode),this.nodes.forEach(hde),this.nodes.forEach(dde),this.nodes.forEach(lde)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new jhe)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new jk),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=jX(a)&&!Jue(a),this.instance=a;const{layoutId:o,layout:l,visualElement:u}=this.options;if(u&&!u.current&&u.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),n){let c,h=0;const d=()=>this.root.updateBlockedByResize=!1;Nr.read(()=>{h=window.innerWidth}),n(a,()=>{const f=window.innerWidth;f!==h&&(h=f,this.root.updateBlockedByResize=!0,c&&c(),c=qhe(d,250),fM.hasAnimatedSinceResize&&(fM.hasAnimatedSinceResize=!1,this.nodes.forEach(R6)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&u&&(o||l)&&this.addEventListener("didUpdate",({delta:c,hasLayoutChanged:h,hasRelativeLayoutChanged:d,layout:f})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||u.getDefaultTransition()||vde,{onLayoutAnimationStart:m,onLayoutAnimationComplete:y}=u.getProps(),v=!this.targetLayout||!CK(this.targetLayout,f),b=!h&&d;if(this.options.layoutRoot||this.resumeFrom||b||h&&(v||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const x={...iB(p,"layout"),onPlay:m,onComplete:y};(u.shouldReduceMotion||this.options.layoutRoot)&&(x.delay=0,x.type=!1),this.startAnimation(x),this.setAnimationOrigin(c,b)}else h||R6(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=f})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),_p(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(fde),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&DK(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let c=0;c<this.path.length;c++){const h=this.path[c];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(D6);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(N6);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(cde),this.nodes.forEach(sde),this.nodes.forEach(ade)):this.nodes.forEach(N6),this.clearAllSnapshots();const o=Ka.now();gs.delta=ad(0,1e3/60,o-gs.timestamp),gs.timestamp=o,gs.isProcessing=!0,DR.update.process(gs),DR.preRender.process(gs),DR.render.process(gs),gs.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,aB.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(ude),this.sharedNodes.forEach(pde)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Nr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Nr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!xa(this.snapshot.measuredBox.x)&&!xa(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ri(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!MK(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,c=u!==this.prevTransformTemplateValue;a&&this.instance&&(o||Sm(this.latestValues)||c)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),yde(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:a}=this.options;if(!a)return ri();const o=a.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(xde))){const{scroll:c}=this.root;c&&(J0(o.x,c.offset.x),J0(o.y,c.offset.y))}return o}removeElementScroll(a){var l;const o=ri();if(qo(o,a),(l=this.scroll)!=null&&l.wasRoot)return o;for(let u=0;u<this.path.length;u++){const c=this.path[u],{scroll:h,options:d}=c;c!==this.root&&h&&d.layoutScroll&&(h.wasRoot&&qo(o,a),J0(o.x,h.offset.x),J0(o.y,h.offset.y))}return o}applyTransform(a,o=!1){const l=ri();qo(l,a);for(let u=0;u<this.path.length;u++){const c=this.path[u];!o&&c.options.layoutScroll&&c.scroll&&c!==c.root&&ey(l,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),Sm(c.latestValues)&&ey(l,c.latestValues)}return Sm(this.latestValues)&&ey(l,this.latestValues),l}removeTransform(a){const o=ri();qo(o,a);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!Sm(u.latestValues))continue;f3(u.latestValues)&&u.updateSnapshot();const c=ri(),h=u.measurePageBox();qo(c,h),E6(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,c)}return Sm(this.latestValues)&&E6(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==gs.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var d;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(a||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(d=this.parent)!=null&&d.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:c,layoutId:h}=this.options;if(!(!this.layout||!(c||h))){if(this.resolvedRelativeTargetAt=gs.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ri(),this.relativeTargetOrigin=ri(),C1(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),qo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=ri(),this.targetWithTransforms=ri()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Ahe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):qo(this.target,this.layout.layoutBox),lK(this.target,this.targetDelta)):qo(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ri(),this.relativeTargetOrigin=ri(),C1(this.relativeTargetOrigin,this.target,f.target),qo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||f3(this.parent.latestValues)||oK(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var p;const a=this.getLead(),o=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||(p=this.parent)!=null&&p.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===gs.timestamp&&(l=!1),l)return;const{layout:u,layoutId:c}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||c))return;qo(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,d=this.treeScale.y;kce(this.layoutCorrected,this.treeScale,this.path,o),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=ri());const{target:f}=a;if(!f){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(b6(this.prevProjectionDelta.x,this.projectionDelta.x),b6(this.prevProjectionDelta.y,this.projectionDelta.y)),M1(this.projectionDelta,this.layoutCorrected,f,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==d||!C6(this.projectionDelta.x,this.prevProjectionDelta.x)||!C6(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",f))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ty(),this.projectionDelta=ty(),this.projectionDeltaWithTransform=ty()}setAnimationOrigin(a,o=!1){const l=this.snapshot,u=l?l.latestValues:{},c={...this.latestValues},h=ty();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const d=ri(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,m=f!==p,y=this.getStack(),v=!y||y.members.length<=1,b=!!(m&&!v&&this.options.crossfade===!0&&!this.path.some(gde));this.animationProgress=0;let x;this.mixTargetDelta=w=>{const _=w/1e3;I6(h.x,a.x,_),I6(h.y,a.y,_),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(C1(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mde(this.relativeTarget,this.relativeTargetOrigin,d,_),x&&ede(this.relativeTarget,x)&&(this.isProjectionDirty=!1),x||(x=ri()),qo(x,this.relativeTarget)),m&&(this.animationValues=c,Xhe(c,u,this.latestValues,_,b,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){var o,l,u;this.notifyListeners("animationStart"),(o=this.currentAnimation)==null||o.stop(),(u=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||u.stop(),this.pendingAnimation&&(_p(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Nr.update(()=>{fM.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=ob(0)),this.currentAnimation=Hhe(this.motionValue,[0,1e3],{...a,velocity:0,isSync:!0,onUpdate:c=>{this.mixTargetDelta(c),a.onUpdate&&a.onUpdate(c)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(rde),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:u,latestValues:c}=a;if(!(!o||!l||!u)){if(this!==a&&this.layout&&u&&RK(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||ri();const h=xa(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+h;const d=xa(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+d}qo(o,l),ey(o,c),M1(this.projectionDeltaWithTransform,this.layoutCorrected,o,c)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new tde),this.sharedNodes.get(a).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const u={};l.z&&zR("z",a,u,this.animationValues);for(let c=0;c<VR.length;c++)zR(`rotate${VR[c]}`,a,u,this.animationValues),zR(`skew${VR[c]}`,a,u,this.animationValues);a.render();for(const c in u)a.setStaticValue(c,u[c]),this.animationValues&&(this.animationValues[c]=u[c]);a.scheduleRender()}applyProjectionStyles(a,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){a.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,a.visibility="",a.opacity="",a.pointerEvents=dM(o==null?void 0:o.pointerEvents)||"",a.transform=l?l(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(a.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,a.pointerEvents=dM(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Sm(this.latestValues)&&(a.transform=l?l({},""):"none",this.hasProjected=!1);return}a.visibility="";const c=u.animationValues||u.latestValues;this.applyTransformsToTarget();let h=nde(this.projectionDeltaWithTransform,this.treeScale,c);l&&(h=l(c,h)),a.transform=h;const{x:d,y:f}=this.projectionDelta;a.transformOrigin=`${d.origin*100}% ${f.origin*100}% 0`,u.animationValues?a.opacity=u===this?c.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:c.opacityExit:a.opacity=u===this?c.opacity!==void 0?c.opacity:"":c.opacityExit!==void 0?c.opacityExit:0;for(const p in aw){if(c[p]===void 0)continue;const{correct:m,applyTo:y,isCSSVariable:v}=aw[p],b=h==="none"?c[p]:m(c[p],u);if(y){const x=y.length;for(let w=0;w<x;w++)a[y[w]]=b}else v?this.options.visualElement.renderState.vars[p]=b:a[p]=b}this.options.layoutId&&(a.pointerEvents=u===this?dM(o==null?void 0:o.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(D6),this.root.sharedNodes.clear()}}}function sde(n){n.updateLayout()}function ade(n){var t;const e=((t=n.resumeFrom)==null?void 0:t.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=n.layout,{animationType:s}=n.options,a=e.source!==n.layout.source;s==="size"?Zo(h=>{const d=a?e.measuredBox[h]:e.layoutBox[h],f=xa(d);d.min=r[h].min,d.max=d.min+f}):RK(s,e.layoutBox,r)&&Zo(h=>{const d=a?e.measuredBox[h]:e.layoutBox[h],f=xa(r[h]);d.max=d.min+f,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[h].max=n.relativeTarget[h].min+f)});const o=ty();M1(o,r,e.layoutBox);const l=ty();a?M1(l,n.applyTransform(i,!0),e.measuredBox):M1(l,r,e.layoutBox);const u=!MK(o);let c=!1;if(!n.resumeFrom){const h=n.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:d,layout:f}=h;if(d&&f){const p=ri();C1(p,e.layoutBox,d.layoutBox);const m=ri();C1(m,r,f.layoutBox),CK(p,m)||(c=!0),h.options.layoutRoot&&(n.relativeTarget=m,n.relativeTargetOrigin=p,n.relativeParent=h)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:e,delta:l,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:c})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function ode(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function lde(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function ude(n){n.clearSnapshot()}function D6(n){n.clearMeasurements()}function N6(n){n.isLayoutDirty=!1}function cde(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function R6(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function hde(n){n.resolveTargetDelta()}function dde(n){n.calcProjection()}function fde(n){n.resetSkewAndRotation()}function pde(n){n.removeLeadSnapshot()}function I6(n,e,t){n.translate=Or(e.translate,0,t),n.scale=Or(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function P6(n,e,t,r){n.min=Or(e.min,t.min,r),n.max=Or(e.max,t.max,r)}function mde(n,e,t,r){P6(n.x,e.x,t.x,r),P6(n.y,e.y,t.y,r)}function gde(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const vde={duration:.45,ease:[.4,0,.1,1]},F6=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),L6=F6("applewebkit/")&&!F6("chrome/")?Math.round:wl;function O6(n){n.min=L6(n.min),n.max=L6(n.max)}function yde(n){O6(n.x),O6(n.y)}function RK(n,e,t){return n==="position"||n==="preserve-aspect"&&!She(M6(e),M6(t),.2)}function xde(n){var e;return n!==n.root&&((e=n.scroll)==null?void 0:e.wasRoot)}const bde=NK({attachResizeListener:(n,e)=>ow(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),$R={current:void 0},IK=NK({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!$R.current){const n=new bde({});n.mount(window),n.setOptions({layoutScroll:!0}),$R.current=n}return $R.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),_de={pan:{Feature:Uhe},drag:{Feature:Bhe,ProjectionNode:IK,MeasureLayout:SK}};function k6(n,e,t){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,s=r[i];s&&Nr.postRender(()=>s(e,RS(e)))}class wde extends Hp{mount(){const{current:e}=this.node;e&&(this.unmount=Xue(e,(t,r)=>(k6(this.node,r,"Start"),i=>k6(this.node,i,"End"))))}unmount(){}}class Ede extends Hp{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=CS(ow(this.node.current,"focus",()=>this.onFocus()),ow(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function B6(n,e,t){const{props:r}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),s=r[i];s&&Nr.postRender(()=>s(e,RS(e)))}class Sde extends Hp{mount(){const{current:e}=this.node;e&&(this.unmount=Zue(e,(t,r)=>(B6(this.node,r,"Start"),(i,{success:s})=>B6(this.node,i,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const b3=new WeakMap,HR=new WeakMap,Ade=n=>{const e=b3.get(n.target);e&&e(n)},Tde=n=>{n.forEach(Ade)};function Mde({root:n,...e}){const t=n||document;HR.has(t)||HR.set(t,{});const r=HR.get(t),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(Tde,{root:n,...e})),r[i]}function Cde(n,e,t){const r=Mde(e);return b3.set(n,t),r.observe(n),()=>{b3.delete(n),r.unobserve(n)}}const Dde={some:0,all:1};class Nde extends Hp{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:i="some",once:s}=e,a={root:t?t.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:Dde[i]},o=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,s&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:c,onViewportLeave:h}=this.node.getProps(),d=u?c:h;d&&d(l)};return Cde(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(Rde(e,t))&&this.startObserver()}unmount(){}}function Rde({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const Ide={inView:{Feature:Nde},tap:{Feature:Sde},focus:{Feature:Ede},hover:{Feature:wde}},Pde={layout:{ProjectionNode:IK,MeasureLayout:SK}},Fde={...yhe,...Ide,..._de,...Pde},ct=Fce(Fde,Wce),vB=[{slug:"general-relativity",title:"   ",category:"relativity",description:"Einstein Field Equation, Schwarzschild/Kerr ,  ",content:{overview:"    . Schwarzschild Kerr        (vacuum solution).",keyPoints:["Einstein Field Equation: G = 8GT","Schwarzschild :  ,   ","Kerr :  , ergosphere "," :  / ","Shapiro delay:    ",": f = f0(1-2GM/rc)"],keyFormulas:[{tex:"G_{\\mu\\nu} = R_{\\mu\\nu} - \\frac{1}{2}g_{\\mu\\nu}R = \\frac{8\\pi G}{c^4}T_{\\mu\\nu}",desc:"Einstein Field Equation"},{tex:"ds^2 = -\\left(1 - \\frac{2GM}{c^2r}\\right)c^2dt^2 + \\left(1 - \\frac{2GM}{c^2r}\\right)^{-1}dr^2 + r^2(d\\theta^2 + \\sin^2\\theta\\,d\\phi^2)",desc:"Schwarzschild "},{tex:"r_s = \\frac{2GM}{c^2}",desc:"Schwarzschild "},{tex:"\\frac{d^2x^\\lambda}{d\\tau^2} + \\Gamma^\\lambda_{\\mu\\nu}\\frac{dx^\\mu}{d\\tau}\\frac{dx^\\nu}{d\\tau} = 0",desc:" "}],observations:'   (42.98"/century),  ,  ',relatedPapers:["The Mathematical Theory of Black Holes (Chandrasekhar, 1983)","General Relativity (Carroll, 2004)","Gravitational Waves from Coalescing Compact Binaries (Abbott et al. LIGO, 2016)"]}},{slug:"stellar-structure",title:"   ",category:"stars",description:"  , Lane-Emden ,   ",content:{overview:"         .         .",keyPoints:[" : dP/dr = -GM/r","  : radiative flux  opacity ","Lane-Emden  :   "," : PP chain (), CNO cycle ()"," : convection instability criterion (adiabatic gradient vs. radiative gradient)",": photosphere  "],keyFormulas:[{tex:"\\frac{dP}{dr} = -\\rho \\frac{GM(<r)}{r^2}",desc:"  "},{tex:"F_\\mathrm{rad} = -\\frac{c}{3\\kappa\\rho}\\frac{dT^4}{dr}",desc:" "},{tex:"\\frac{d^2u}{d\\xi^2} + \\frac{2}{\\xi}\\frac{du}{d\\xi} + u^n = 0",desc:"Lane-Emden "},{tex:"PP\\,\\mathrm{chain}: {}^1H + {}^1H \\to {}^2H + e^+ + \\nu",desc:"-  "}],observations:"  L=3.82810W,  R=6.9610m,   T_c~1.5710K,  _c~150 g/cm",relatedPapers:["Stellar Interiors: Physical Principles, Structure and Evolution (Hansen, Kawaler & Trimble, 2004)","The Theory of Stellar Structure and Evolution (Kippenhahn, Weigert & Weiss, 2012)"]}},{slug:"black-hole-astrophysics",title:" : Kerr  ",category:"relativity",description:"Kerr ergosphere, ISCO , Hawking ,  ",content:{overview:" (Kerr )   .  (Hawking )   ,       .",keyPoints:["Kerr :   a = J/M ","Ergosphere:   g_tt=0 ","ISCO (Innermost Stable Circular Orbit): a=0  r_ISCO = 6GM/c","Hawking :  T_H = c/(8kGM)","Penrose process:    ","Accretion disk: viscosity   "],keyFormulas:[{tex:"ds^2 = -\\frac{\\Delta}{\\rho^2}(c\\,dt - a\\sin^2\\theta\\,d\\phi)^2 + \\frac{\\rho^2}{\\Delta}dr^2 + \\rho^2 d\\theta^2 + \\frac{\\sin^2\\theta}{\\rho^2}(a c\\,dt - (r^2+a^2)d\\phi)^2",desc:"Kerr  (Boyer-Lindquist )"},{tex:"r_{\\mathrm{ISCO}} = \\frac{GM}{c^2}\\left(3 + Z_2 - \\sqrt{(3-Z_1)(3+Z_1+2Z_2)}\\right)",desc:"ISCO  (Kerr )"},{tex:"T_H = \\frac{\\hbar c^3}{8\\pi k_B G M}",desc:"Hawking "},{tex:"\\eta = 1 - \\sqrt{1 - \\frac{2GM}{c^2 r_{\\mathrm{ISCO}}}}",desc:" "}],observations:"M87   M=(6.50.7)10M (EHT 2019), Sagittarius A*  M=(4.2970.013)10M",relatedPapers:["Black Hole Accretion in Supermassive and Stellar Mass Regimes (Done et al. 2007)","The Event Horizon Telescope Collaboration (2019, ApJ Letters)","Information and the Nature of Reality (Wheeler & Ford, 1998)"]}},{slug:"galaxy-dynamics",title:"  ",category:"galaxies",description:"Jeans ,   , CDM,  ",content:{overview:"  , ,    . Jeans        .",keyPoints:["Jeans :    "," :   NFW  ","Virial theorem: 2K + U = 0 ( )"," :   ~85%","CDM : M0.3, 0.7"," : N-body + hydrodynamics"],keyFormulas:[{tex:"\\frac{d\\sigma_r^2}{dr} + 2\\frac{\\beta}{r}\\sigma_r^2 = -\\frac{GM(<r)}{r^2}",desc:"Jeans "},{tex:"v_{\\mathrm{c}}(r) = \\sqrt{\\frac{GM(<r)}{r}}",desc:"  "},{tex:"\\rho_{\\mathrm{NFW}}(r) = \\frac{\\rho_s}{(r/r_s)(1+r/r_s)^2}",desc:"Navarro-Frenk-White  "},{tex:"2\\langle K \\rangle + \\langle U \\rangle = 0",desc:" Virial "}],observations:"    (220 km/s at 8 kpc),    ( )",relatedPapers:["Galactic Dynamics (Binney & Tremaine, 2008)","The Concentration of Dark Matter Halos (Navarro, Frenk & White, 1997)","Simulations of the formation, evolution and clustering of galaxies and quasars (Springel et al. 2005)"]}},{slug:"cosmology",title:"  ",category:"cosmology",description:"Friedmann , CMB  ,  ",content:{overview:"      . Friedmann     , CMB    CDM  .",keyPoints:["Friedmann : a(t)  "," : t = 13.7870.020 Gyr (Planck 2018)"," : _   120 ","CMB :   T/T ~ 10","  : C_     "," : w(z) = p/(c)"],keyFormulas:[{tex:"\\left(\\frac{\\dot{a}}{a}\\right)^2 + \\frac{k}{a^2} = \\frac{8\\pi G}{3}\\rho",desc:"1 Friedmann "},{tex:"\\frac{\\ddot{a}}{a} = -\\frac{4\\pi G}{3}(\\rho + 3p) + \\frac{\\Lambda}{3}",desc:"2 Friedmann "},{tex:"T(z) = T_0 (1+z)",desc:"  "},{tex:"w = \\frac{p}{\\rho c^2}",desc:"  "}],observations:"CMB: b=0.049, cdm=0.264, =0.684, H0=67.4 km/s/Mpc (Planck 2018)",relatedPapers:["Planck 2018 results (Planck Collaboration, 2018)","A High-Resolution Cosmic Microwave Background Map (WMAP, 2003-2013)","Observational Evidence from Supernovae for an Accelerating Universe (Perlmutter et al. 1999)"]}},{slug:"observational-astronomy",title:" : , , ",category:"observations",description:"Equivalent Width, Voigt profile, CCD photometry,  ",content:{overview:"    .   (Equivalent Width, Doppler shift), CCD ,      .",keyPoints:["Equivalent Width (EW):    ","Voigt profile:  +   ","CCD : -(S/N), (dynamic range)",'X-ray : Chandra  0.5",   100 eV',"IR  (JWST): NIRCam  0.6-5m,  /~1600"," (VLBI): baseline ~10000 km,  ~as"],keyFormulas:[{tex:"EW = \\int_{\\lambda_1}^{\\lambda_2} \\left(1 - \\frac{F_\\lambda}{F_c}\\right)d\\lambda",desc:""},{tex:"f(\\nu) = \\frac{I(\\nu_0)}{\\sqrt{\\pi}}\\int_{-\\infty}^{\\infty}\\frac{e^{-t^2}}{1+(a(\\nu-\\nu_0+t\\Delta\\nu_D)/\\Delta\\nu_D)^2}dt",desc:"Voigt "},{tex:"(S/N)_{\\mathrm{CCD}} = \\frac{Ne}{\\sqrt{Ne + n_r^2 + n_d^2}}",desc:"CCD -"},{tex:"\\theta_{\\mathrm{res}} \\approx 1.22\\frac{\\lambda}{D}",desc:"  (Rayleigh criterion)"}],observations:"JWST NIRCam z~11   (_obs~2m), Chandra    , EHT   (48as)",relatedPapers:["Observational Astrophysics (Birney, Gonzalez & Oesper, 2006)","Modern Observational Astronomy: the Principles, Science and Techniques (Filippenko, 2006)"]}},{slug:"mass-luminosity",title:"- ",category:"stars",description:"    ",content:{overview:"       .       .",keyPoints:[": L  M^3.5 ()","     (2.5~4.5)","     "],keyFormulas:[{tex:"L \\approx M^{3.5}",desc:"-  ()"},{tex:"t_{\\mathrm{lifetime}} \\approx \\frac{M}{L} \\propto M^{-2.5}",desc:"  "}],observations:"  1   1, 10   ~3000",relatedPapers:["Mass-Luminosity Relations (1970)","Stellar Evolution Theory (1995)"]}},{slug:"dark-matter-rotation",title:"  ",category:"galaxies",description:"      ",content:{overview:"            ,    .",keyPoints:["   :    "," :  v  1/r ( )",": v   (100~300 km/s)"," :   ~85%"],keyFormulas:[{tex:"v(r) = \\sqrt{\\frac{GM(<r)}{r}}",desc:"   "},{tex:"M(<r) \\propto r",desc:" r  "}],observations:"M31 ,     ",relatedPapers:["The Rotation of Spiral Nebulae (1975)","Dark Matter and Galaxy Formation (2010)"]}},{slug:"cosmic-microwave-background",title:"  (CMB)",category:"cosmology",description:"    , ,  ",content:{overview:"CMB   38       .      .",keyPoints:[": 1965 Penzias & Wilson",": 2.725 K ( )",":   T/T ~ 10",":   "],keyFormulas:[{tex:"T(z) = T_0 (1 + z)",desc:"  CMB "},{tex:"T_0 = 2.725 \\, \\mathrm{K}",desc:"CMB  "}],observations:"WMAP, Planck   m=0.315, =0.685, H0=67 km/s/Mpc ",relatedPapers:["A Measurement of the Fluctuations in the Cosmic Microwave Background (1992)","Planck 2018 results (2018)"]}},{slug:"gravitational-waves",title:"   ",category:"observations",description:"LIGO/Virgo ,  ,  ,   ",content:{overview:"     . 2015  (GW150914) ,   (BBH),  (BNS),  (NSBH)    . /          .",keyPoints:["LIGO/Virgo :    h ~ 10  "," :  (inspection)  (merger)  (ringdown) 3"," :  , , ,   Bayesian "," : r-process     ",": GW + GRB() + kilonova()  "," :   H0  ,   "],keyFormulas:[{tex:"h_+(t) = \\frac{2G}{c^4}\\frac{M_c^{5/3}}{D_L}\\left(\\pi f(t)\\right)^{2/3}\\cos(\\Phi(t))",desc:"  +  ( )"},{tex:"\\frac{df}{dt} = \\frac{96}{5}\\pi^{8/3}\\frac{G^{5/3}}{c^5}M_c^{5/3}f^{11/3}",desc:"   (chirp)"},{tex:"M_c = \\frac{(m_1 m_2)^{3/5}}{(m_1 + m_2)^{1/5}}",desc:" (chirp mass)"},{tex:"T_{\\mathrm{merge}} = \\frac{5}{256}\\frac{c^5}{G^3}\\frac{1}{M_c^{5/3}\\pi^{8/3}f_0^{8/3}}",desc:"   (f)"},{tex:"Q = \\frac{M \\omega}{c} \\quad (\\text{ISCO})\\, Q_{\\text{Kerr}} \\sim \\frac{c^3}{G M} \\left(1 + \\sqrt{1-a^*/a}\\right)",desc:"  "}],observations:"GW150914:  36+29 M, GW170817:  1.36-1.60 M, GW190814: -  (  9:1)",relatedPapers:["Observation of Gravitational Waves from a Binary Black Hole Merger (Abbott et al., PRL 2016)","GW170817: Observation of Gravitational Waves from a Binary Neutron Star Inspiral (Abbott et al., PRL 2017)","Tests of General Relativity with GW150914 (Abbott et al., PRL 2016)"]}},{slug:"high-energy-astrophysics",title:"  X ",category:"observations",description:"X-ray binary, AGN  , Compton , Synchrotron ",content:{overview:"  X(0.1~100 keV), (>100 keV)   . X , (AGN),      .      Compton  Synchrotron     .",keyPoints:["X-ray binary: / +   ( )","Low-mass X-ray binary (LMXB):   < 1 M,  X ","High-mass X-ray binary (HMXB):   > 10 M,  ","Compton :   +    ,  ","Inverse Compton:   +     X/","Synchrotron :     ","AGN  :   Seyfert 1/2  (  )"],keyFormulas:[{tex:"E_\\gamma \\approx 4\\gamma k_B T_e",desc:"Compton   (Thomson regime)"},{tex:"\\nu_{\\mathrm{sync}} = \\frac{e B}{2\\pi m_e c} \\gamma^2",desc:"Synchrotron  "},{tex:"L_\\mathrm{Edd} = \\frac{4\\pi G M m_p c}{\\sigma_T} \\approx 1.3 \\times 10^{38} \\left(\\frac{M}{M_\\odot}\\right) \\, \\mathrm{erg~s^{-1}}",desc:"Eddington  "},{tex:"\\tau_T = n_e \\sigma_T L",desc:"Thomson "}],observations:"Cygnus X-1 ( HMXB), Sco X-1 ( LMXB), M87  AGN ( ), NGC 4151 ()",relatedPapers:["Physics of Compact Objects (Wheeler et al., 1996)","X-ray Binaries (Lewin & van der Klis, 2006)","AGN Unification Model (Antonucci, 1993)"]}},{slug:"cosmic-ray-physics",title:"   ",category:"observations",description:"Fermi ,  ,   , - ",content:{overview:"    ( ).  ,  ,    . Fermi          .   ,  ,     .",keyPoints:["Fermi 1 :  / ,   (E/E  %)","Fermi 2 :  (magnetic mirror)    ","  : SNe Ia  SNe II  "," : E^(-2.7) power law (  10~10 eV)"," : CR      (  )"," : ~90% , ~10% , ~1%  "," (UHECR): E > 10 eV,  (GZK cutoff)"],keyFormulas:[{tex:"\\frac{dE}{dt} \\propto E",desc:"Fermi 1  (  )"},{tex:"N(E) \\propto E^{-\\alpha}",desc:"  power law (  2.7)"},{tex:"E_c = \\frac{3eB\\,r_L^2}{2\\Delta t}",desc:"Fermi    (  r_L,   t)"},{tex:"E_{\\mathrm{GZK}} \\approx 5 \\times 10^{19} \\, \\mathrm{eV}",desc:"GZK cutoff  (CMB )"}],observations:"  :    , IceCube   ( CR  )",relatedPapers:["The Origin of Cosmic Rays (Jokipii, 1987)","Cosmic Ray Propagation and Solar Modulation (Potgieter, 2013)","Supernova Remnants as Cosmic Ray Accelerators (Berezhko & Vlk, 2007)"]}},{slug:"adaptive-optics-interferometry",title:"  ",category:"observations",description:"  , VLBI,  ,  ",content:{overview:"    . (AO)          . VLBI( )         .",keyPoints:[" seeing:      (typical ~0.5~2 arcsec)"," :  = /(2D), D  ",": (wavefront sensor) +  (deformable mirror)  ","Strehl ratio: AO  . Strehl  1 (), 0 (  )","VLBI (Very Long Baseline Interferometry):   ,   "," : Keck I&II, VLTI (  ~ 1 )"," (phase closure):     "],keyFormulas:[{tex:"\\theta_{\\mathrm{diff}} = 1.22 \\frac{\\lambda}{D}",desc:"Rayleigh  "},{tex:"B_{\\mathrm{eff}} = \\lambda D / d",desc:"   ( , D baseline, d  )"},{tex:"S = \\exp\\left(-\\frac{\\pi^2}{2\\ln 2} \\sigma_\\phi^2\\right)",desc:"Strehl ratio (_: RMS  )"}],observations:"Event Horizon Telescope (EHT): 10  VLBI M87, Sgr A*   (2019, 2022)",relatedPapers:["Adaptive Optics for Astronomy (Roddier, 1999)","VLBI Astrometry (Porcas et al., 2003)","First M87 Event Horizon Telescope Results (EHT Collaboration, 2019)"]}},{slug:"modified-gravity",title:" : MOND TeVeS",category:"relativity",description:"  ,   , CDM ",content:{overview:"           . MOND (  )      , TeVeS  .",keyPoints:["MOND : a < a  F = m(a/a)  (a ~ 1.210 m/s)","  :   MOND   ( )","Deep MOND (Deep Modified Newtonian Dynamics): a << a F  (GMm/r)","TeVeS (Tensor-Vector-Scalar):  MOND,    ","Bullet Cluster :     , MOND  ","  (UV completion): MOND   "],keyFormulas:[{tex:"F = m \\frac{a^2}{a_0}\\,\\, (a << a_0)",desc:"Deep MOND "},{tex:"a_0 = \\frac{cH_0}{6}\\approx 1.2 \\times 10^{-10}\\,\\mathrm{m/s^2}",desc:"MOND "},{tex:"v_\\mathrm{rot} \\approx \\sqrt[4]{GMa_0}\\,\\, (a << a_0)",desc:"MOND   ( )"}],observations:"  ,   , CMB , BBN  ",relatedPapers:["MOND and the Dark Matter Problem (Milgrom, 2015)","Relativistic MOND via TeVeS (Bekenstein, 2004)","The Bullet Cluster Evidence against Dark Matter (Clowe et al., 2006)"]}},{slug:"dark-matter-detection",title:" : WIMPs, Axions,  ",category:"galaxies",description:" ,  ,  ,  ",content:{overview:"    85%   . WIMPs (   ) axions  ,     .",keyPoints:["WIMPs (Weakly Interacting Massive Particles):  10~1000 GeV/c,   ","Axions:    (eV ), QCD  "," : XENON, LUX, SuperCDMS       "," :      ,  "," : LHC      "," :    "],keyFormulas:[{tex:"\\sigma_{\\mathrm{WIMP-nucleon}} \\sim 10^{-45}\\,\\mathrm{cm}^2\\,\\, (\\mathrm{spin\\text{-}independent})",desc:"WIMP-  "},{tex:"m_a \\sim 10^{-6}\\,\\mathrm{eV} \\sim 10^{-2}\\,\\mathrm{eV}",desc:"  "},{tex:"F_a = \\frac{m_e v^2}{g_{a\\gamma\\gamma} m_a}",desc:"  "}],observations:"Planck 2018: _cdm h = 0.1200.001, LHC Run 2: WIMP   , AMS:   ",relatedPapers:["Dark Matter Candidates: From Theory to Direct Detection (Hooper & Kolb, 2010)","Axion Dark Matter Searches (Irastorza & Redondo, 2018)","XENON1T Results on Light Dark Matter Particles (XENON Collaboration, 2019)"]}},{slug:"exoplanet-systems",title:": , ,  ",category:"stars",description:"  ,  ,   , TRAPPIST-1 ",content:{overview:"5500   (2024).   (protoplanetary disk)    , /     .",keyPoints:[" :          (  )"," :        (m sin i)"," (transit photometry):        ( 0.01%)"," :      (HO, CO, CH)","  :         ","TESS/JWST:   ,    "],keyFormulas:[{tex:"\\frac{\\Delta F}{F} = \\frac{R_p^2}{R_*^2}",desc:"   (R_p: , R_*:  )"},{tex:"a_\\mathrm{HZ} = \\sqrt{\\frac{L_*}{L_\\odot}}",desc:"   "},{tex:"K = \\frac{(m \\sin i)}{\\sqrt{1-e^2}} \\sqrt{\\frac{GM_*}{a^3}}",desc:"RV  ( )"}],observations:"Kepler  2662, TESS  600+ (), TRAPPIST-1: 7   (3   )",relatedPapers:["Exoplanet Atmospheres (Seager, 2010)","Planet Formation in Protoplanetary Disks (Nakano et al., 2015)","JWST Transiting Exoplanet Community Early Release Science Program (Louie et al., 2023)"]}},{slug:"supernova-cosmology",title:" :  Ia  ",category:"cosmology",description:"  Ia ,   ,  , w ",content:{overview:'1998,   Type Ia  "  "   (Nobel 2011). SNe Ia      .',keyPoints:["Type Ia SN:       ",":    M_V  -19.3 (0.3)","Phillips :       (  )","Dust extinction:     (E(B-V) )","Hubble diagram:   vs  _ _m  "," :  ()  , w = -1 "],keyFormulas:[{tex:"m = M + 5\\log_{10}(d_L) + 25",desc:"  (m:  , M:  )"},{tex:"d_L = \\frac{1+z}{H_0} \\int_0^z \\frac{dz^\\prime}{E(z^\\prime)}",desc:"  (CDM)"},{tex:"M_V^\\mathrm{corr} = M_V - 2.5\\alpha(s-1)",desc:"Phillips  (s:  )"}],observations:"Riess et al. 1998 42 SNe Ia, Perlmutter et al. 1999 52 SNe Ia,  1000+  , H = 73.041.04 km/s/Mpc (SH0ES 2022)",relatedPapers:["Observational Evidence from Supernovae for an Accelerating Universe (Riess et al., 1998)","Measurements of  and  from 42 High-Redshift Supernovae (Perlmutter et al., 1999)","Local Void is Consistent with CDM (Kenworthy et al., 2021)"]}},{slug:"agn-unified-model",title:"   : , ,  ",category:"galaxies",description:" ,  , Fanaroff-Riley , Eddington ",content:{overview:"AGN (Active Galactic Nuclei)  (SMBH)  .  ( ,  )    ,   .",keyPoints:["SMBH:    10~10 M",":   (inner disk) +   (outer disk)","(Torus):    ,    >> 1","(Jet):   ,    ~ 0.99","Fanaroff-Riley : FR I (,  ) vs FR II (,  )","Eddington : L_Edd = 4GMm_p c/_T  1.410(M/M) W"," (BLR/NLR):    "],keyFormulas:[{tex:"L_\\mathrm{Edd} = \\frac{4\\pi GMm_p c}{\\sigma_T} = 1.4 \\times 10^{31}\\left(\\frac{M}{M_\\odot}\\right)\\,\\mathrm{W}",desc:"Eddington "},{tex:"\\lambda_\\mathrm{Edd} = \\frac{L_\\mathrm{bol}}{L_\\mathrm{Edd}}",desc:"Eddington "},{tex:"\\dot{M} = \\frac{L}{\\eta c^2}",desc:" (: radiative efficiency)"}],observations:"M87 SMBH M=(6.50.7)10M, Centaurus A   >4 Mpc, NGC 1068   (ALMA)",relatedPapers:["AGN Unification: The Quest Continues (Krolik, 2007)","Accretion in Supermassive Black Holes (Narayan & Quataert, 2005)","First M87 Event Horizon Telescope Results (EHT Collaboration, 2019)"]}}],U6=[{term:"Absolute Magnitude ()",definition:"  10 pc    .    ."},{term:"Accretion Disk ( )",definition:",        .  40%   ."},{term:"Adiabatic Gradient ( )",definition:"        . dT/dP = T/(P)."},{term:"Blackbody Radiation ()",definition:"   ,      . Planck  ."},{term:"Blue Shift ()",definition:"      .  < 0."},{term:"CCD Photometry (CCD )",definition:"Charge-Coupled Device    . -  100  ."},{term:"CMB Power Spectrum (CMB )",definition:"CMB      C_ .  ,    ."},{term:"CNO Cycle (CNO )",definition:"   : C  N  C  N  O  N  C + He."},{term:"Doppler Shift ( )",definition:"    . v << c  / = v/c."},{term:"Dynamical Mass ( )",definition:"Jeans     .      ."},{term:"EOS Parameter ( )",definition:" w = p/(c). CDM w = -1.  ."},{term:"Equivalent Width (, EW)",definition:"     .  column density  ."},{term:"Ergosphere ()",definition:"Kerr   g_tt > 0 .       ."},{term:"Friedmann Equation ( )",definition:"    . (/a) + k/a = 8G/3."},{term:"Geodesic ()",definition:'    . Riemannian  "" .'},{term:"Gravitational Redshift ()",definition:"     . / = -GM/cr."},{term:"Gravitational Waves ()",definition:"   .  h ~ 10 (LIGO).  ,   ."},{term:"Gravitational Wave Strain ( )",definition:"LIGO     : h = L/L ~ 10.   ."},{term:"Gravitational Wave Detector ( )",definition:"LIGO, Virgo, KAGRA    .      ."},{term:"MOND (Modified Newtonian Dynamics)",definition:"      . a < a ~ 10 m/s   ."},{term:"TeVeS (Tensor-Vector-Scalar Gravity)",definition:"MOND  .   = ."},{term:"Bullet Cluster ( )",definition:"    . X-        ."},{term:"WIMPs (Weakly Interacting Massive Particles)",definition:" .  10~1000 GeV/c,     ."},{term:"Axion ()",definition:"     (eV~meV ). QCD  Peccei-Quinn  ."},{term:"Exoplanet ()",definition:"    . 5500+  (2024).  ,   ."},{term:"Habitable Zone (  )",definition:"          .    ."},{term:"Type Ia Supernova (Ia )",definition:"      .      ."},{term:"Phillips Relation (Phillips )",definition:"Type Ia SN     .      ."},{term:"AGN (Active Galactic Nuclei)",definition:" .       ."},{term:"SMBH (Supermassive Black Hole)",definition:"   .  10~10 M.     ."},{term:"AGN Torus (AGN )",definition:"AGN     .    >> 1.     ."},{term:"Eddington Luminosity (Eddington )",definition:"    . L_Edd = 4GMm_p c/_T  1.410(M/M) W."},{term:"Fanaroff-Riley Classification",definition:"Radio galaxy  . FR I:    . FR II:    ."},{term:"Hawking Radiation ( )",definition:"   .  T_H = c/(8kGM)."},{term:"Hubble Constant ( )",definition:"   . H  67-73 km/s/Mpc (   )."},{term:"Hubble Distance ( )",definition:"     . d_H = c/H  4400 Mpc."},{term:"ISCO (  )",definition:"Innermost Stable Circular Orbit.     . r_ISCO = 6GM/c (Schwarzschild)."},{term:"Jeans Equation ( )",definition:"   . d_r/dr + 2_r/r = -GM/r."},{term:"Jeans Mass ( )",definition:"    . M_J = (kT/G)^(3/2)(5T/G)^(1/2)."},{term:"Kerr Metric ( )",definition:"   .   a = J/Mc .    ."},{term:"Lane-Emden Equation (- )",definition:"     . du/d + 2/du/d + u^n = 0."},{term:"Luminosity Distance ( )",definition:"      . d_L = (1+z)d_c (CDM)."},{term:"LIGO (Laser Interferometer Gravitational-Wave Observatory)",definition:"  . Hanford & Livingston   .   4 km,   125 W."},{term:"Mass-Luminosity Relation (- )",definition:"L  M^,    3.5.    ."},{term:"MHD Simulations ( )",definition:"     .  , ,   ."},{term:"Matched Filtering ( )",definition:"   .   (cross-correlation) S/N ."},{term:"Merger ()",definition:"   . /     ."},{term:"NFW Profile (NFW  )",definition:"Navarro-Frenk-White   :   1/(r/r_s(1+r/r_s))."},{term:"Neutron Star ()",definition:"     .  ~10 km,  ~10^17 kg/cm,  ."},{term:"Opacity ()",definition:"    .  = /().     ."},{term:"Photometric Redshift ( )",definition:"     .     ."},{term:"Planck Function ( )",definition:"   . B_ = 2h/c1/(e^(h/kT)-1)."},{term:"QFT in Curved Spacetime (  )",definition:" . Hawking   ."},{term:"Radiative Transfer ( )",definition:"    . F_rad = -c/(3)dT/dr."},{term:"Redshift ()",definition:"    . z = (_obs - _emit)/_emit."},{term:"Rotation Curve ()",definition:"   vs  .     ."},{term:"Schwarzschild Metric ( )",definition:"   .   . r_s = 2GM/c ."},{term:"Shapiro Delay ( )",definition:"   . t = (2GM/c)ln(4rr/b)."},{term:"Spectral Classification ( )",definition:"   : O B A F G K M.   100 K ."},{term:"Starburst Galaxy ( )",definition:"     . SFR > 1 M/yr.    ."},{term:"Stefan-Boltzmann Law (- )",definition:"  : L = 4RT,  = 5.6710 W m K."},{term:"Tully-Fisher Relation (- )",definition:"     .    ."},{term:"Tidal Deformability ( )",definition:"    .  .    ."},{term:"Time Delay ( )",definition:"     .  (sky localization) ."},{term:"Virial Theorem ( )",definition:"  : 2K + U = 0 ( )."},{term:"Virgo (  )",definition:" Cascina  .   3 km,   200 W. LIGO 3  ."},{term:"Voigt Profile ( )",definition:" ( + )   .    ."},{term:"White Dwarf ()",definition:"   .    .   (Hubble time > age)."},{term:"X-ray Spectroscopy (X )",definition:"Chandra, XMM-Newton     .  K (6.4 keV)    ."},{term:"Zero-Age Main Sequence (ZAMS)",definition:"      . Hertzsprung-Russell  ."}],Lde=[{id:1,title:"Observation of Gravitational Waves from a Binary Black Hole Merger",authors:"Abbott, B. P. et al. (LIGO/Virgo Collaboration)",year:2016,arxivId:"1602.03837",journal:"Physical Review Letters 116, 061102",doi:"10.1103/PhysRevLett.116.061102",abstract:"On 14 September 2015 at 09:50:45 UTC the two detectors of the Laser Interferometer Gravitational-Wave Observatory observed a transient gravitational-wave signal. The signal sweeps upward in frequency from 35 to 250 Hz, with peak gravitational-wave strain of 1.0  10.",summary:{background:"  100     .        .",methodology:"Matched filtering :     . S/N > 24 . Bayesian parameter estimation , , ,  .",theory:"   : dE/dt = -32/5G/(c)(mm)(m+m)/(a).    Kerr  .",data_analysis:"Advanced LIGO (2 ): N = 510/Hz @ 100Hz. 4 km arm interferometer, Fabry-Prot cavity resonator .  :   , /  subtraction.",results:"  () q = 1.20.1,   M = 65 M,    M_f = 62 M,  E = 3.0 Mc (   ).",limiting_factors:" shot noise  thermal noise ,   0.2  parameter inference  ."}},{id:2,title:"First M87 Event Horizon Telescope Results. I. The Shadow of the Supermassive Black Hole",authors:"Event Horizon Telescope Collaboration",year:2019,arxivId:"1906.11238",journal:"The Astrophysical Journal Letters 875, L1",doi:"10.3847/2041-8213/ab0ec7",abstract:"We present the first Event Horizon Telescope (EHT) observations at 1.3 mm wavelength of the supermassive black hole candidate in the galactic center of the radio galaxy M87. We have resolved the central compact radio source on angular scales of ~5 microarcseconds.",summary:{background:"         . VLBI    10,000 km .",methodology:"Very Long Baseline Interferometry (VLBI): 8    .    . Phase calibration, self-calibration  . Imaging: CLEAN ,   .",theory:"General relativistic magnetohydrodynamics (GRMHD)    . Kerr     (null geodesics).   : r_shadow  5.2 GM/c (M87  r_shadow  42 as).",data_analysis:"Visibility :   . u-v plane   .     . Uncertainty quantification:    .",results:"  M = (6.50.7)10 M.     d = 42.03.0 as.   10%  .    .",limiting_factors:"  ,    ,  (intraday variability) ,    ."}},{id:3,title:"A Universe of Black Holes and Bulges Revealed by JWST",authors:"Labb, I. et al.",year:2023,arxivId:"2306.02465",journal:"Nature ( )",doi:"10.1038/nature25755",abstract:"The James Webb Space Telescope (JWST) has revealed a population of surprisingly massive galaxies at z > 10, indicating accelerated galaxy assembly in the early universe.",summary:{background:"JWST     (z > 6)    .        .",methodology:"NIRCam : 0.6-5 m ,   SED fitting.  : NIRSpec   (R ~ 1000). (PSF) ,  .",theory:"SED modeling: Stellar population synthesis (FSPS, BAGPIPES). Dust attenuation curve . Photometric redshift vs spectroscopic redshift . Virial mass : M_vir = r/G ( ).",data_analysis:": P(z, params | data)  L(data | z, params)  Prior(z, params). Bayesian inference , , SFR .     (confidence interval) .",results:" z = 13.2  JADES-GS-z13-0:  M* = (3.21.9)10 M.  ~500 Myr.    330 Myr   (   a = 0.07).",limiting_factors:"  ,      degeneracy,  -    ,   ."}},{id:4,title:"The Weak Gravitational Lensing Signal and the Clustering of GAMA Galaxies",authors:"Leauthaud, A. et al.",year:2017,arxivId:"1511.06428",journal:"Monthly Notices of the Royal Astronomical Society",doi:"10.1093/mnras/stw2897",abstract:"We present joint measurements of the weak gravitational lensing signal around GAMA galaxies and their clustering. These measurements allow direct constraints on galaxy assembly bias and the dark matter halo profiles.",summary:{background:"          .     .",methodology:"Weak lensing shear : background     (typical  ~ 0.01).  :  = _cr  _tan. 2-point correlation   clustering .",theory:"NFW : (r) = _s / [(r/r_s)(1+r/r_s)].  c  r    M = (4/3)_crit200r. Halo mass function  .",data_analysis:"Forward modeling:   shear     .  galaxy-halo  (P(halo mass | galaxy properties)). Likelihood: L = _i P(data_i | model, params).",results:"  M* = 10 M     M_DM ~ 10 M.   c = 5.01.5.      .",limiting_factors:"    S/N,    (shape noise), systematic lensing , photometric redshift ."}},{id:5,title:"GW170817: Observation of Gravitational Waves from a Binary Neutron Star Inspiral",authors:"Abbott, B. P. et al. (LIGO/Virgo Collaboration)",year:2017,arxivId:"1710.05832",journal:"Physical Review Letters 119, 161101",doi:"10.1103/PhysRevLett.119.161101",abstract:"On August 17, 2017 at 12:41:04 UTC the Advanced LIGO and Advanced Virgo gravitational-wave detectors made their first observation of a binary neutron star inspiral. A loud gravitational-wave signal was detected with a duration of approximately 100 seconds.",summary:{background:"   r-process (  )  .  +  (kilonova)     .",methodology:"Bayesian parameter estimation: 9  ~ , , ,  . Matched filtering  . 3 (LIGO Hanford, LIGO Livingston, Virgo)  source localization (sky position ).",theory:"  :   M_max . Tidal deformability   (compressibility) .    5 (  ).",data_analysis:"  ~100 sec     . Nested sampling    (marginalized probability) . Model comparison: BNS vs NSBH vs BBH.",results:"  : m = 1.36-1.60 M, m = 1.17-1.36 M. Tidal deformability  = 560. r-process    0.03-0.05 M.  kilonova AT2017gfo   .",limiting_factors:"Virgo    source localization  (~600 sq deg),   (gap),  merger   ."}}],T0=[{id:1,name:"  ",description:", ,    "},{id:2,name:" ",description:" , , CCD, , VLBI  "},{id:3,name:" ",description:"LIGO, EHT, JWST     "},{id:4,name:" ",description:"N-body, MHD, hydrodynamics   "},{id:5,name:" ",description:", Bayesian ,   "},{id:6,name:" ",description:", ,  ,   "}],GR={textbooks:[{title:"Gravitational Waves Volume 1: Theory and Experiments",authors:"Maggiore, M.",year:2007},{title:"The Theory of Stellar Structure and Evolution",authors:"Kippenhahn, R., Weigert, A. & Weiss, A.",year:2012},{title:"Galactic Dynamics",authors:"Binney, J. & Tremaine, S.",year:2008},{title:"General Relativity",authors:"Carroll, S. M.",year:2004},{title:"Black Hole Thermodynamics",authors:"Wald, R. M.",year:2001},{title:"Observational Astrophysics",authors:"Birney, D. S., Gonzalez, G. & Oesper, D. A.",year:2006},{title:"The Early Universe",authors:"Kolb, E. W. & Turner, M. S.",year:1990},{title:"Modern Astrophysics",authors:"Carroll, B. W., Ostlie, D. A. & et al.",year:2007}],databases:[{name:"NASA ADS (Astrophysics Data System)",url:"https://ui.adsabs.harvard.edu/",desc:"    . 240+  ."},{name:"arXiv Astro-ph",url:"https://arxiv.org/archive/astro-ph",desc:" .  ~50  .   ."},{name:"Simbad",url:"https://simbad.u-strasbg.fr/",desc:", ,      , ."},{name:"NED (NASA Extragalactic Database)",url:"https://ned.ipac.caltech.edu/",desc:"   . , ,    ."},{name:"VizieR",url:"https://vizier.cds.unistra.fr/",desc:"700+      ."},{name:"Gravitational Wave Open Science Center (GWOSC)",url:"https://gwosc.readthedocs.io/",desc:"LIGO/Virgo  ,  , ."}],tools:[{name:"GIZMO",url:"https://www.tapir.caltech.edu/~phopkins/Site/GIZMO.html",desc:"N-body +  +  +    ."},{name:"ATHENA++",url:"https://www.athena-code.org/",desc:"  (GRMHD) .    ."},{name:"Planck 2018 Legacy Release",url:"https://irsa.ipac.caltech.edu/data/Planck/",desc:"CMB  ,  ,   ."},{name:"FSPS (Flexible Stellar Population Synthesis)",url:"https://github.com/bd-j/fsps",desc:"   . SED ."},{name:"dynesty (Dynamic Nested Sampling)",url:"https://github.com/joshspeagle/dynesty",desc:"   Bayesian .   ."},{name:"SIMBAD Sky Map",url:"http://simbad.u-strasbg.fr/simbad/sim-fcoo",desc:"      ."},{name:"JWST Exposure Time Calculator",url:"https://jwst.etc.stsci.edu/",desc:"JWST     S/N ."}]},pM={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},mM={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4}}};function Ode(){const{isDark:n}=Nl(),e=vB.slice(0,3);return xe.useEffect(()=>{if(!localStorage.getItem("registeredUsers")){const r={[btoa("test@example.com")]:{email:"test@example.com",password:btoa("Test1234"),username:"",affiliation:" ",createdAt:new Date().toISOString()}};localStorage.setItem("registeredUsers",JSON.stringify(r)),console.log("   : test@example.com / Test1234")}},[]),k.jsxs("div",{className:"space-y-8 sm:space-y-12",children:[k.jsxs("section",{className:"py-8 sm:py-12 md:py-20 text-center",children:[k.jsx(ct.div,{initial:{opacity:0,y:-30},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},children:k.jsx("h1",{className:"text-4xl sm:text-5xl md:text-6xl font-bold mb-4 bg-gradient-to-r from-blue-500 to-purple-600 dark:from-blue-400 dark:to-purple-500 bg-clip-text text-transparent",children:" "})}),k.jsx(ct.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"text-base sm:text-lg md:text-xl text-gray-600 dark:text-gray-300 mb-8 px-4",children:" ,  ,   "}),k.jsxs(ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},className:"flex flex-col sm:flex-row gap-4 justify-center px-4",children:[k.jsx(ct.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:k.jsx(hr,{to:"/concepts",className:"block px-8 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 transition font-medium shadow-lg hover:shadow-xl",children:" "})}),k.jsx(ct.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:k.jsx(hr,{to:"/papers",className:"block px-8 py-3 bg-gradient-to-r from-orange-600 to-orange-700 text-white rounded-lg hover:from-orange-700 hover:to-orange-800 transition font-medium shadow-lg hover:shadow-xl",children:" "})})]})]}),k.jsx(ct.section,{variants:pM,initial:"hidden",whileInView:"visible",viewport:{once:!0,amount:.2},className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 sm:gap-6",children:[{title:" ",description:", ,        ",icon:""},{title:" ",description:"    .    ",icon:""},{title:"",description:", ,    .    ",icon:""}].map((t,r)=>k.jsxs(ct.div,{variants:mM,whileHover:{y:-8,boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1)"},className:`p-6 rounded-lg border transition ${n?"bg-gray-800 border-gray-700 hover:border-blue-500":"bg-white border-gray-200 hover:border-blue-500"}`,children:[k.jsx("div",{className:"text-4xl mb-3",children:t.icon}),k.jsx("h3",{className:`text-lg sm:text-xl font-bold mb-2 ${n?"text-white":"text-gray-900"}`,children:t.title}),k.jsx("p",{className:`text-sm sm:text-base ${n?"text-gray-300":"text-gray-600"}`,children:t.description})]},r))}),k.jsxs(ct.section,{initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.6},viewport:{once:!0,amount:.2},children:[k.jsx(ct.h2,{initial:{opacity:0,x:-30},whileInView:{opacity:1,x:0},transition:{duration:.6},viewport:{once:!0},className:"text-2xl sm:text-3xl md:text-4xl font-bold mb-6 text-gray-900 dark:text-white",children:" "}),k.jsx(ct.div,{variants:pM,initial:"hidden",whileInView:"visible",viewport:{once:!0,amount:.1},className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:e.map(t=>k.jsx(ct.div,{variants:mM,whileHover:{y:-8},className:`p-6 rounded-lg border transition cursor-pointer ${n?"bg-gray-800 border-gray-700 hover:border-blue-500":"bg-white border-gray-200 hover:border-blue-500"}`,children:k.jsxs(hr,{to:`/concepts/${t.slug}`,children:[k.jsx("h3",{className:"text-base sm:text-lg font-bold text-blue-600 dark:text-blue-400 mb-2",children:t.title}),k.jsx("p",{className:`text-sm sm:text-base ${n?"text-gray-300":"text-gray-600"}`,children:t.description})]})},t.slug))})]}),k.jsxs(ct.section,{initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.6},viewport:{once:!0,amount:.2},children:[k.jsx(ct.h2,{initial:{opacity:0,x:-30},whileInView:{opacity:1,x:0},transition:{duration:.6},viewport:{once:!0},className:"text-2xl sm:text-3xl md:text-4xl font-bold mb-6 text-gray-900 dark:text-white",children:"  "}),k.jsx(ct.div,{variants:pM,initial:"hidden",whileInView:"visible",viewport:{once:!0,amount:.1},className:"space-y-4",children:Lde.map(t=>k.jsxs(ct.div,{variants:mM,whileHover:{x:8},className:`p-4 sm:p-6 rounded-lg border transition ${n?"bg-gray-800 border-gray-700 hover:border-orange-500":"bg-white border-gray-200 hover:border-orange-500"}`,children:[k.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-2",children:[k.jsxs("div",{className:"flex-1",children:[k.jsx("h3",{className:"font-bold text-blue-600 dark:text-blue-400 text-sm sm:text-base",children:t.title}),k.jsxs("p",{className:`text-xs sm:text-sm ${n?"text-gray-400":"text-gray-500"}`,children:[t.authors," (",t.year,")"]})]}),k.jsx("span",{className:`text-xs px-3 py-1 rounded whitespace-nowrap ${n?"bg-gray-700 text-gray-300":"bg-gray-200 text-gray-700"}`,children:t.year})]}),k.jsx("p",{className:`text-xs sm:text-sm mt-3 ${n?"text-gray-300":"text-gray-600"}`,children:t.abstract})]},t.id))}),k.jsx(ct.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},className:"mt-8 text-center",children:k.jsx(ct.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:k.jsx(hr,{to:"/papers",className:"inline-block px-8 py-3 bg-gradient-to-r from-orange-600 to-orange-700 text-white rounded-lg hover:from-orange-700 hover:to-orange-800 transition font-medium shadow-lg hover:shadow-xl",children:"   "})})})]})]})}function kde(){const{isDark:n}=Nl(),e={relativity:"",stars:"",galaxies:"",cosmology:"",observations:""},t={relativity:"from-red-500 to-pink-500",stars:"from-yellow-500 to-orange-500",galaxies:"from-purple-500 to-indigo-500",cosmology:"from-blue-500 to-cyan-500",observations:"from-green-500 to-emerald-500"};return k.jsxs("div",{className:"space-y-12 sm:space-y-16",children:[k.jsxs(ct.div,{initial:{opacity:0,y:-30},animate:{opacity:1,y:0},transition:{duration:.6},children:[k.jsx("h1",{className:"text-4xl sm:text-5xl font-bold mb-4 bg-gradient-to-r from-blue-600 to-purple-600 dark:from-blue-400 dark:to-purple-400 bg-clip-text text-transparent",children:" "}),k.jsx(ct.p,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.2},className:`text-sm sm:text-base ${n?"text-gray-300":"text-gray-600"}`,children:"  5  , 14     ."})]}),Object.entries(e).map(([r,i],s)=>{const a=vB.filter(o=>o.category===r);return a.length===0?null:k.jsxs(ct.section,{initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.6},viewport:{once:!0,amount:.1},children:[k.jsx(ct.div,{initial:{opacity:0,x:-30},whileInView:{opacity:1,x:0},transition:{duration:.6},viewport:{once:!0},className:"mb-6",children:k.jsx("div",{className:`inline-block bg-gradient-to-r ${t[r]} p-0.5 rounded-lg`,children:k.jsx("div",{className:`px-4 py-2 rounded-md ${n?"bg-gray-900":"bg-white"}`,children:k.jsx("h2",{className:`text-lg sm:text-xl font-bold bg-gradient-to-r ${t[r]} bg-clip-text text-transparent`,children:i})})})}),k.jsx(ct.div,{variants:pM,initial:"hidden",whileInView:"visible",viewport:{once:!0,amount:.1},className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:a.map((o,l)=>k.jsxs(ct.div,{variants:mM,whileHover:{y:-12,boxShadow:"0 20px 40px -10px rgba(0, 0, 0, 0.15)"},className:`group relative overflow-hidden rounded-xl border-2 transition cursor-pointer ${n?"bg-gradient-to-br from-gray-800 to-gray-900 border-gray-700 hover:border-blue-500":"bg-gradient-to-br from-white to-gray-50 border-gray-200 hover:border-blue-500"}`,children:[k.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${t[r]} opacity-0 group-hover:opacity-5 transition-opacity duration-300`}),k.jsxs(hr,{to:`/concepts/${o.slug}`,className:"relative block p-6",children:[k.jsx("div",{className:"mb-4",children:k.jsx("span",{className:`inline-block px-3 py-1 text-xs font-semibold rounded-full ${n?"bg-gray-700 text-blue-300":"bg-blue-100 text-blue-700"}`,children:i})}),k.jsx("h3",{className:"text-base sm:text-lg font-bold mb-2 text-blue-600 dark:text-blue-400 group-hover:translate-x-1 transition-transform",children:o.title}),k.jsx("p",{className:`text-sm sm:text-base line-clamp-2 mb-4 ${n?"text-gray-300":"text-gray-600"}`,children:o.description}),k.jsxs("div",{className:`text-xs space-y-1 ${n?"text-gray-400":"text-gray-500"}`,children:[o.content.keyPoints.slice(0,2).map((u,c)=>k.jsxs("div",{className:"flex items-start gap-2",children:[k.jsx("span",{className:"text-blue-400",children:""}),k.jsx("span",{className:"line-clamp-1",children:u})]},c)),o.content.keyPoints.length>2&&k.jsxs("div",{className:"text-blue-500 font-medium",children:["+ ",o.content.keyPoints.length-2," ..."]})]})]})]},o.slug))})]},r)})]})}function Bde({tex:n,display:e=!1}){return xe.useEffect(()=>{if(window.katex)try{window.katex.render(n,document.getElementById(`math-${n}`),{displayMode:e,throwOnError:!1})}catch(t){console.error("KaTeX error:",t)}},[n,e]),k.jsx("div",{id:`math-${n}`,className:"inline-block"})}function Ude(){const{slug:n}=XW(),e=vB.find(r=>r.slug===n);if(!e)return k.jsx("div",{className:"text-center py-12 text-gray-600 dark:text-gray-300",children:"   ."});const{content:t}=e;return k.jsxs("div",{className:"max-w-3xl mx-auto space-y-6 sm:space-y-8",children:[k.jsxs("div",{children:[k.jsx("h1",{className:"text-3xl sm:text-4xl font-bold mb-2 text-gray-900 dark:text-white",children:e.title}),k.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm sm:text-base",children:e.description})]}),k.jsxs("section",{className:"bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 sm:p-6 rounded-lg",children:[k.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-4 text-gray-900 dark:text-white",children:""}),k.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed text-sm sm:text-base",children:t.overview})]}),k.jsxs("section",{className:"px-4 sm:px-0",children:[k.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-4 text-gray-900 dark:text-white",children:" "}),k.jsx("ul",{className:"space-y-2",children:t.keyPoints.map((r,i)=>k.jsxs("li",{className:"flex gap-3 text-sm sm:text-base",children:[k.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-bold flex-shrink-0",children:""}),k.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:r})]},i))})]}),t.keyFormulas&&t.keyFormulas.length>0&&k.jsxs("section",{className:"px-4 sm:px-0",children:[k.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-4 text-gray-900 dark:text-white",children:" "}),k.jsx("div",{className:"space-y-4",children:t.keyFormulas.map((r,i)=>k.jsxs("div",{className:"bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 sm:p-6 rounded-lg overflow-x-auto",children:[k.jsx(Bde,{tex:r.tex}),k.jsx("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 mt-2",children:r.desc})]},i))})]}),k.jsxs("section",{className:"bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 sm:p-6 rounded-lg",children:[k.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-4 text-gray-900 dark:text-white",children:" "}),k.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm sm:text-base",children:t.observations})]}),t.relatedPapers&&t.relatedPapers.length>0&&k.jsxs("section",{className:"px-4 sm:px-0",children:[k.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-4 text-gray-900 dark:text-white",children:" "}),k.jsx("ul",{className:"space-y-2",children:t.relatedPapers.map((r,i)=>k.jsx("li",{className:"text-gray-700 dark:text-gray-300 border-l-2 border-blue-600 dark:border-blue-400 pl-4 text-sm sm:text-base",children:r},i))})]})]})}const Vde=()=>{};var V6={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PK=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},zde=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],a=n[t++],o=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},FK={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],a=i+1<n.length,o=a?n[i+1]:0,l=i+2<n.length,u=l?n[i+2]:0,c=s>>2,h=(s&3)<<4|o>>4;let d=(o&15)<<2|u>>6,f=u&63;l||(f=64,a||(d=64)),r.push(t[c],t[h],t[d],t[f])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(PK(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):zde(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],o=i<n.length?t[n.charAt(i)]:0;++i;const u=i<n.length?t[n.charAt(i)]:64;++i;const h=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||o==null||u==null||h==null)throw new $de;const d=s<<2|o>>4;if(r.push(d),u!==64){const f=o<<4&240|u>>2;if(r.push(f),h!==64){const p=u<<6&192|h;r.push(p)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class $de extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Hde=function(n){const e=PK(n);return FK.encodeByteArray(e,!0)},GC=function(n){return Hde(n).replace(/\./g,"")},LK=function(n){try{return FK.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gde(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jde=()=>Gde().__FIREBASE_DEFAULTS__,qde=()=>{if(typeof process>"u"||typeof V6>"u")return;const n=V6.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Wde=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&LK(n[1]);return e&&JSON.parse(e)},H2=()=>{try{return Vde()||jde()||qde()||Wde()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},OK=n=>{var e,t;return(t=(e=H2())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},kK=n=>{const e=OK(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},BK=()=>{var n;return(n=H2())==null?void 0:n.config},UK=n=>{var e;return(e=H2())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xde{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lv(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function yB(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VK(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[GC(JSON.stringify(t)),GC(JSON.stringify(a)),""].join(".")}const D1={};function Kde(){const n={prod:[],emulator:[]};for(const e of Object.keys(D1))D1[e]?n.emulator.push(e):n.prod.push(e);return n}function Yde(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let z6=!1;function xB(n,e){if(typeof window>"u"||typeof document>"u"||!Lv(window.location.host)||D1[n]===e||D1[n]||z6)return;D1[n]=e;function t(d){return`__firebase__banner__${d}`}const r="__firebase__banner",s=Kde().prod.length>0;function a(){const d=document.getElementById(r);d&&d.remove()}function o(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function l(d,f){d.setAttribute("width","24"),d.setAttribute("id",f),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function u(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{z6=!0,a()},d}function c(d,f){d.setAttribute("id",f),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function h(){const d=Yde(r),f=t("text"),p=document.getElementById(f)||document.createElement("span"),m=t("learnmore"),y=document.getElementById(m)||document.createElement("a"),v=t("preprendIcon"),b=document.getElementById(v)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const x=d.element;o(x),c(y,m);const w=u();l(b,v),x.append(b,p,y,w),document.body.appendChild(x)}s?(p.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,p.innerText="Preview backend running in this workspace."),p.setAttribute("id",f)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ta(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Qde(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ta())}function Zde(){var e;const n=(e=H2())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Jde(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function efe(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function tfe(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function nfe(){const n=ta();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function rfe(){return!Zde()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ife(){try{return typeof indexedDB=="object"}catch{return!1}}function sfe(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)==null?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const afe="FirebaseError";class Ic extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=afe,Object.setPrototypeOf(this,Ic.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,IS.prototype.create)}}class IS{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?ofe(s,r):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Ic(i,o,r)}}function ofe(n,e){return n.replace(lfe,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const lfe=/\{\$([^}]+)}/g;function ufe(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function _v(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],a=e[i];if($6(s)&&$6(a)){if(!_v(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function $6(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PS(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function B_(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function U_(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function cfe(n,e){const t=new hfe(n,e);return t.subscribe.bind(t)}class hfe{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");dfe(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=jR),i.error===void 0&&(i.error=jR),i.complete===void 0&&(i.complete=jR);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function dfe(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function jR(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Li(n){return n&&n._delegate?n._delegate:n}class Ep{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Am="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ffe{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Xde;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(mfe(e))try{this.getOrInitializeService({instanceIdentifier:Am})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Am){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Am){return this.instances.has(e)}getOptions(e=Am){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);r===o&&a.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:pfe(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Am){return this.component?this.component.multipleInstances?e:Am:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function pfe(n){return n===Am?void 0:n}function mfe(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gfe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ffe(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vn;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(vn||(vn={}));const vfe={debug:vn.DEBUG,verbose:vn.VERBOSE,info:vn.INFO,warn:vn.WARN,error:vn.ERROR,silent:vn.SILENT},yfe=vn.INFO,xfe={[vn.DEBUG]:"log",[vn.VERBOSE]:"log",[vn.INFO]:"info",[vn.WARN]:"warn",[vn.ERROR]:"error"},bfe=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=xfe[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class bB{constructor(e){this.name=e,this._logLevel=yfe,this._logHandler=bfe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in vn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?vfe[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,vn.DEBUG,...e),this._logHandler(this,vn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,vn.VERBOSE,...e),this._logHandler(this,vn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,vn.INFO,...e),this._logHandler(this,vn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,vn.WARN,...e),this._logHandler(this,vn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,vn.ERROR,...e),this._logHandler(this,vn.ERROR,...e)}}const _fe=(n,e)=>e.some(t=>n instanceof t);let H6,G6;function wfe(){return H6||(H6=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Efe(){return G6||(G6=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const zK=new WeakMap,_3=new WeakMap,$K=new WeakMap,qR=new WeakMap,_B=new WeakMap;function Sfe(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(fp(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&zK.set(t,n)}).catch(()=>{}),_B.set(e,n),e}function Afe(n){if(_3.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});_3.set(n,e)}let w3={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return _3.get(n);if(e==="objectStoreNames")return n.objectStoreNames||$K.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return fp(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Tfe(n){w3=n(w3)}function Mfe(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(WR(this),e,...t);return $K.set(r,e.sort?e.sort():[e]),fp(r)}:Efe().includes(n)?function(...e){return n.apply(WR(this),e),fp(zK.get(this))}:function(...e){return fp(n.apply(WR(this),e))}}function Cfe(n){return typeof n=="function"?Mfe(n):(n instanceof IDBTransaction&&Afe(n),_fe(n,wfe())?new Proxy(n,w3):n)}function fp(n){if(n instanceof IDBRequest)return Sfe(n);if(qR.has(n))return qR.get(n);const e=Cfe(n);return e!==n&&(qR.set(n,e),_B.set(e,n)),e}const WR=n=>_B.get(n);function Dfe(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(n,e),o=fp(a);return r&&a.addEventListener("upgradeneeded",l=>{r(fp(a.result),l.oldVersion,l.newVersion,fp(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const Nfe=["get","getKey","getAll","getAllKeys","count"],Rfe=["put","add","delete","clear"],XR=new Map;function j6(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(XR.get(e))return XR.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=Rfe.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Nfe.includes(t)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(o.shift())),(await Promise.all([u[t](...o),i&&l.done]))[0]};return XR.set(e,s),s}Tfe(n=>({...n,get:(e,t,r)=>j6(e,t)||n.get(e,t,r),has:(e,t)=>!!j6(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ife{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Pfe(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Pfe(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const E3="@firebase/app",q6="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ld=new bB("@firebase/app"),Ffe="@firebase/app-compat",Lfe="@firebase/analytics-compat",Ofe="@firebase/analytics",kfe="@firebase/app-check-compat",Bfe="@firebase/app-check",Ufe="@firebase/auth",Vfe="@firebase/auth-compat",zfe="@firebase/database",$fe="@firebase/data-connect",Hfe="@firebase/database-compat",Gfe="@firebase/functions",jfe="@firebase/functions-compat",qfe="@firebase/installations",Wfe="@firebase/installations-compat",Xfe="@firebase/messaging",Kfe="@firebase/messaging-compat",Yfe="@firebase/performance",Qfe="@firebase/performance-compat",Zfe="@firebase/remote-config",Jfe="@firebase/remote-config-compat",epe="@firebase/storage",tpe="@firebase/storage-compat",npe="@firebase/firestore",rpe="@firebase/ai",ipe="@firebase/firestore-compat",spe="firebase",ape="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S3="[DEFAULT]",ope={[E3]:"fire-core",[Ffe]:"fire-core-compat",[Ofe]:"fire-analytics",[Lfe]:"fire-analytics-compat",[Bfe]:"fire-app-check",[kfe]:"fire-app-check-compat",[Ufe]:"fire-auth",[Vfe]:"fire-auth-compat",[zfe]:"fire-rtdb",[$fe]:"fire-data-connect",[Hfe]:"fire-rtdb-compat",[Gfe]:"fire-fn",[jfe]:"fire-fn-compat",[qfe]:"fire-iid",[Wfe]:"fire-iid-compat",[Xfe]:"fire-fcm",[Kfe]:"fire-fcm-compat",[Yfe]:"fire-perf",[Qfe]:"fire-perf-compat",[Zfe]:"fire-rc",[Jfe]:"fire-rc-compat",[epe]:"fire-gcs",[tpe]:"fire-gcs-compat",[npe]:"fire-fst",[ipe]:"fire-fst-compat",[rpe]:"fire-vertex","fire-js":"fire-js",[spe]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jC=new Map,lpe=new Map,A3=new Map;function W6(n,e){try{n.container.addComponent(e)}catch(t){ld.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function wv(n){const e=n.name;if(A3.has(e))return ld.debug(`There were multiple attempts to register component ${e}.`),!1;A3.set(e,n);for(const t of jC.values())W6(t,n);for(const t of lpe.values())W6(t,n);return!0}function G2(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Fo(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const upe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},pp=new IS("app","Firebase",upe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cpe{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ep("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw pp.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ov=ape;function HK(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:S3,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw pp.create("bad-app-name",{appName:String(i)});if(t||(t=BK()),!t)throw pp.create("no-options");const s=jC.get(i);if(s){if(_v(t,s.options)&&_v(r,s.config))return s;throw pp.create("duplicate-app",{appName:i})}const a=new gfe(i);for(const l of A3.values())a.addComponent(l);const o=new cpe(t,r,a);return jC.set(i,o),o}function wB(n=S3){const e=jC.get(n);if(!e&&n===S3&&BK())return HK();if(!e)throw pp.create("no-app",{appName:n});return e}function mc(n,e,t){let r=ope[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ld.warn(a.join(" "));return}wv(new Ep(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hpe="firebase-heartbeat-database",dpe=1,lw="firebase-heartbeat-store";let KR=null;function GK(){return KR||(KR=Dfe(hpe,dpe,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(lw)}catch(t){console.warn(t)}}}}).catch(n=>{throw pp.create("idb-open",{originalErrorMessage:n.message})})),KR}async function fpe(n){try{const t=(await GK()).transaction(lw),r=await t.objectStore(lw).get(jK(n));return await t.done,r}catch(e){if(e instanceof Ic)ld.warn(e.message);else{const t=pp.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ld.warn(t.message)}}}async function X6(n,e){try{const r=(await GK()).transaction(lw,"readwrite");await r.objectStore(lw).put(e,jK(n)),await r.done}catch(t){if(t instanceof Ic)ld.warn(t.message);else{const r=pp.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ld.warn(r.message)}}}function jK(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ppe=1024,mpe=30;class gpe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ype(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=K6();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>mpe){const a=xpe(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ld.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=K6(),{heartbeatsToSend:r,unsentEntries:i}=vpe(this._heartbeatsCache.heartbeats),s=GC(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return ld.warn(t),""}}}function K6(){return new Date().toISOString().substring(0,10)}function vpe(n,e=ppe){const t=[];let r=n.slice();for(const i of n){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Y6(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Y6(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class ype{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ife()?sfe().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await fpe(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return X6(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return X6(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Y6(n){return GC(JSON.stringify({version:2,heartbeats:n})).length}function xpe(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bpe(n){wv(new Ep("platform-logger",e=>new Ife(e),"PRIVATE")),wv(new Ep("heartbeat",e=>new gpe(e),"PRIVATE")),mc(E3,q6,n),mc(E3,q6,"esm2020"),mc("fire-js","")}bpe("");var Q6=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var mp,qK;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,T){function S(){}S.prototype=T.prototype,A.F=T.prototype,A.prototype=new S,A.prototype.constructor=A,A.D=function(M,D,N){for(var R=Array(arguments.length-2),z=2;z<arguments.length;z++)R[z-2]=arguments[z];return T.prototype[D].apply(M,R)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,T,S){S||(S=0);const M=Array(16);if(typeof T=="string")for(var D=0;D<16;++D)M[D]=T.charCodeAt(S++)|T.charCodeAt(S++)<<8|T.charCodeAt(S++)<<16|T.charCodeAt(S++)<<24;else for(D=0;D<16;++D)M[D]=T[S++]|T[S++]<<8|T[S++]<<16|T[S++]<<24;T=A.g[0],S=A.g[1],D=A.g[2];let N=A.g[3],R;R=T+(N^S&(D^N))+M[0]+3614090360&4294967295,T=S+(R<<7&4294967295|R>>>25),R=N+(D^T&(S^D))+M[1]+3905402710&4294967295,N=T+(R<<12&4294967295|R>>>20),R=D+(S^N&(T^S))+M[2]+606105819&4294967295,D=N+(R<<17&4294967295|R>>>15),R=S+(T^D&(N^T))+M[3]+3250441966&4294967295,S=D+(R<<22&4294967295|R>>>10),R=T+(N^S&(D^N))+M[4]+4118548399&4294967295,T=S+(R<<7&4294967295|R>>>25),R=N+(D^T&(S^D))+M[5]+1200080426&4294967295,N=T+(R<<12&4294967295|R>>>20),R=D+(S^N&(T^S))+M[6]+2821735955&4294967295,D=N+(R<<17&4294967295|R>>>15),R=S+(T^D&(N^T))+M[7]+4249261313&4294967295,S=D+(R<<22&4294967295|R>>>10),R=T+(N^S&(D^N))+M[8]+1770035416&4294967295,T=S+(R<<7&4294967295|R>>>25),R=N+(D^T&(S^D))+M[9]+2336552879&4294967295,N=T+(R<<12&4294967295|R>>>20),R=D+(S^N&(T^S))+M[10]+4294925233&4294967295,D=N+(R<<17&4294967295|R>>>15),R=S+(T^D&(N^T))+M[11]+2304563134&4294967295,S=D+(R<<22&4294967295|R>>>10),R=T+(N^S&(D^N))+M[12]+1804603682&4294967295,T=S+(R<<7&4294967295|R>>>25),R=N+(D^T&(S^D))+M[13]+4254626195&4294967295,N=T+(R<<12&4294967295|R>>>20),R=D+(S^N&(T^S))+M[14]+2792965006&4294967295,D=N+(R<<17&4294967295|R>>>15),R=S+(T^D&(N^T))+M[15]+1236535329&4294967295,S=D+(R<<22&4294967295|R>>>10),R=T+(D^N&(S^D))+M[1]+4129170786&4294967295,T=S+(R<<5&4294967295|R>>>27),R=N+(S^D&(T^S))+M[6]+3225465664&4294967295,N=T+(R<<9&4294967295|R>>>23),R=D+(T^S&(N^T))+M[11]+643717713&4294967295,D=N+(R<<14&4294967295|R>>>18),R=S+(N^T&(D^N))+M[0]+3921069994&4294967295,S=D+(R<<20&4294967295|R>>>12),R=T+(D^N&(S^D))+M[5]+3593408605&4294967295,T=S+(R<<5&4294967295|R>>>27),R=N+(S^D&(T^S))+M[10]+38016083&4294967295,N=T+(R<<9&4294967295|R>>>23),R=D+(T^S&(N^T))+M[15]+3634488961&4294967295,D=N+(R<<14&4294967295|R>>>18),R=S+(N^T&(D^N))+M[4]+3889429448&4294967295,S=D+(R<<20&4294967295|R>>>12),R=T+(D^N&(S^D))+M[9]+568446438&4294967295,T=S+(R<<5&4294967295|R>>>27),R=N+(S^D&(T^S))+M[14]+3275163606&4294967295,N=T+(R<<9&4294967295|R>>>23),R=D+(T^S&(N^T))+M[3]+4107603335&4294967295,D=N+(R<<14&4294967295|R>>>18),R=S+(N^T&(D^N))+M[8]+1163531501&4294967295,S=D+(R<<20&4294967295|R>>>12),R=T+(D^N&(S^D))+M[13]+2850285829&4294967295,T=S+(R<<5&4294967295|R>>>27),R=N+(S^D&(T^S))+M[2]+4243563512&4294967295,N=T+(R<<9&4294967295|R>>>23),R=D+(T^S&(N^T))+M[7]+1735328473&4294967295,D=N+(R<<14&4294967295|R>>>18),R=S+(N^T&(D^N))+M[12]+2368359562&4294967295,S=D+(R<<20&4294967295|R>>>12),R=T+(S^D^N)+M[5]+4294588738&4294967295,T=S+(R<<4&4294967295|R>>>28),R=N+(T^S^D)+M[8]+2272392833&4294967295,N=T+(R<<11&4294967295|R>>>21),R=D+(N^T^S)+M[11]+1839030562&4294967295,D=N+(R<<16&4294967295|R>>>16),R=S+(D^N^T)+M[14]+4259657740&4294967295,S=D+(R<<23&4294967295|R>>>9),R=T+(S^D^N)+M[1]+2763975236&4294967295,T=S+(R<<4&4294967295|R>>>28),R=N+(T^S^D)+M[4]+1272893353&4294967295,N=T+(R<<11&4294967295|R>>>21),R=D+(N^T^S)+M[7]+4139469664&4294967295,D=N+(R<<16&4294967295|R>>>16),R=S+(D^N^T)+M[10]+3200236656&4294967295,S=D+(R<<23&4294967295|R>>>9),R=T+(S^D^N)+M[13]+681279174&4294967295,T=S+(R<<4&4294967295|R>>>28),R=N+(T^S^D)+M[0]+3936430074&4294967295,N=T+(R<<11&4294967295|R>>>21),R=D+(N^T^S)+M[3]+3572445317&4294967295,D=N+(R<<16&4294967295|R>>>16),R=S+(D^N^T)+M[6]+76029189&4294967295,S=D+(R<<23&4294967295|R>>>9),R=T+(S^D^N)+M[9]+3654602809&4294967295,T=S+(R<<4&4294967295|R>>>28),R=N+(T^S^D)+M[12]+3873151461&4294967295,N=T+(R<<11&4294967295|R>>>21),R=D+(N^T^S)+M[15]+530742520&4294967295,D=N+(R<<16&4294967295|R>>>16),R=S+(D^N^T)+M[2]+3299628645&4294967295,S=D+(R<<23&4294967295|R>>>9),R=T+(D^(S|~N))+M[0]+4096336452&4294967295,T=S+(R<<6&4294967295|R>>>26),R=N+(S^(T|~D))+M[7]+1126891415&4294967295,N=T+(R<<10&4294967295|R>>>22),R=D+(T^(N|~S))+M[14]+2878612391&4294967295,D=N+(R<<15&4294967295|R>>>17),R=S+(N^(D|~T))+M[5]+4237533241&4294967295,S=D+(R<<21&4294967295|R>>>11),R=T+(D^(S|~N))+M[12]+1700485571&4294967295,T=S+(R<<6&4294967295|R>>>26),R=N+(S^(T|~D))+M[3]+2399980690&4294967295,N=T+(R<<10&4294967295|R>>>22),R=D+(T^(N|~S))+M[10]+4293915773&4294967295,D=N+(R<<15&4294967295|R>>>17),R=S+(N^(D|~T))+M[1]+2240044497&4294967295,S=D+(R<<21&4294967295|R>>>11),R=T+(D^(S|~N))+M[8]+1873313359&4294967295,T=S+(R<<6&4294967295|R>>>26),R=N+(S^(T|~D))+M[15]+4264355552&4294967295,N=T+(R<<10&4294967295|R>>>22),R=D+(T^(N|~S))+M[6]+2734768916&4294967295,D=N+(R<<15&4294967295|R>>>17),R=S+(N^(D|~T))+M[13]+1309151649&4294967295,S=D+(R<<21&4294967295|R>>>11),R=T+(D^(S|~N))+M[4]+4149444226&4294967295,T=S+(R<<6&4294967295|R>>>26),R=N+(S^(T|~D))+M[11]+3174756917&4294967295,N=T+(R<<10&4294967295|R>>>22),R=D+(T^(N|~S))+M[2]+718787259&4294967295,D=N+(R<<15&4294967295|R>>>17),R=S+(N^(D|~T))+M[9]+3951481745&4294967295,A.g[0]=A.g[0]+T&4294967295,A.g[1]=A.g[1]+(D+(R<<21&4294967295|R>>>11))&4294967295,A.g[2]=A.g[2]+D&4294967295,A.g[3]=A.g[3]+N&4294967295}r.prototype.v=function(A,T){T===void 0&&(T=A.length);const S=T-this.blockSize,M=this.C;let D=this.h,N=0;for(;N<T;){if(D==0)for(;N<=S;)i(this,A,N),N+=this.blockSize;if(typeof A=="string"){for(;N<T;)if(M[D++]=A.charCodeAt(N++),D==this.blockSize){i(this,M),D=0;break}}else for(;N<T;)if(M[D++]=A[N++],D==this.blockSize){i(this,M),D=0;break}}this.h=D,this.o+=T},r.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var T=1;T<A.length-8;++T)A[T]=0;T=this.o*8;for(var S=A.length-8;S<A.length;++S)A[S]=T&255,T/=256;for(this.v(A),A=Array(16),T=0,S=0;S<4;++S)for(let M=0;M<32;M+=8)A[T++]=this.g[S]>>>M&255;return A};function s(A,T){var S=o;return Object.prototype.hasOwnProperty.call(S,A)?S[A]:S[A]=T(A)}function a(A,T){this.h=T;const S=[];let M=!0;for(let D=A.length-1;D>=0;D--){const N=A[D]|0;M&&N==T||(S[D]=N,M=!1)}this.g=S}var o={};function l(A){return-128<=A&&A<128?s(A,function(T){return new a([T|0],T<0?-1:0)}):new a([A|0],A<0?-1:0)}function u(A){if(isNaN(A)||!isFinite(A))return h;if(A<0)return y(u(-A));const T=[];let S=1;for(let M=0;A>=S;M++)T[M]=A/S|0,S*=4294967296;return new a(T,0)}function c(A,T){if(A.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(A.charAt(0)=="-")return y(c(A.substring(1),T));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const S=u(Math.pow(T,8));let M=h;for(let N=0;N<A.length;N+=8){var D=Math.min(8,A.length-N);const R=parseInt(A.substring(N,N+D),T);D<8?(D=u(Math.pow(T,D)),M=M.j(D).add(u(R))):(M=M.j(S),M=M.add(u(R)))}return M}var h=l(0),d=l(1),f=l(16777216);n=a.prototype,n.m=function(){if(m(this))return-y(this).m();let A=0,T=1;for(let S=0;S<this.g.length;S++){const M=this.i(S);A+=(M>=0?M:4294967296+M)*T,T*=4294967296}return A},n.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(p(this))return"0";if(m(this))return"-"+y(this).toString(A);const T=u(Math.pow(A,6));var S=this;let M="";for(;;){const D=w(S,T).g;S=v(S,D.j(T));let N=((S.g.length>0?S.g[0]:S.h)>>>0).toString(A);if(S=D,p(S))return N+M;for(;N.length<6;)N="0"+N;M=N+M}},n.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function p(A){if(A.h!=0)return!1;for(let T=0;T<A.g.length;T++)if(A.g[T]!=0)return!1;return!0}function m(A){return A.h==-1}n.l=function(A){return A=v(this,A),m(A)?-1:p(A)?0:1};function y(A){const T=A.g.length,S=[];for(let M=0;M<T;M++)S[M]=~A.g[M];return new a(S,~A.h).add(d)}n.abs=function(){return m(this)?y(this):this},n.add=function(A){const T=Math.max(this.g.length,A.g.length),S=[];let M=0;for(let D=0;D<=T;D++){let N=M+(this.i(D)&65535)+(A.i(D)&65535),R=(N>>>16)+(this.i(D)>>>16)+(A.i(D)>>>16);M=R>>>16,N&=65535,R&=65535,S[D]=R<<16|N}return new a(S,S[S.length-1]&-2147483648?-1:0)};function v(A,T){return A.add(y(T))}n.j=function(A){if(p(this)||p(A))return h;if(m(this))return m(A)?y(this).j(y(A)):y(y(this).j(A));if(m(A))return y(this.j(y(A)));if(this.l(f)<0&&A.l(f)<0)return u(this.m()*A.m());const T=this.g.length+A.g.length,S=[];for(var M=0;M<2*T;M++)S[M]=0;for(M=0;M<this.g.length;M++)for(let D=0;D<A.g.length;D++){const N=this.i(M)>>>16,R=this.i(M)&65535,z=A.i(D)>>>16,j=A.i(D)&65535;S[2*M+2*D]+=R*j,b(S,2*M+2*D),S[2*M+2*D+1]+=N*j,b(S,2*M+2*D+1),S[2*M+2*D+1]+=R*z,b(S,2*M+2*D+1),S[2*M+2*D+2]+=N*z,b(S,2*M+2*D+2)}for(A=0;A<T;A++)S[A]=S[2*A+1]<<16|S[2*A];for(A=T;A<2*T;A++)S[A]=0;return new a(S,0)};function b(A,T){for(;(A[T]&65535)!=A[T];)A[T+1]+=A[T]>>>16,A[T]&=65535,T++}function x(A,T){this.g=A,this.h=T}function w(A,T){if(p(T))throw Error("division by zero");if(p(A))return new x(h,h);if(m(A))return T=w(y(A),T),new x(y(T.g),y(T.h));if(m(T))return T=w(A,y(T)),new x(y(T.g),T.h);if(A.g.length>30){if(m(A)||m(T))throw Error("slowDivide_ only works with positive integers.");for(var S=d,M=T;M.l(A)<=0;)S=_(S),M=_(M);var D=E(S,1),N=E(M,1);for(M=E(M,2),S=E(S,2);!p(M);){var R=N.add(M);R.l(A)<=0&&(D=D.add(S),N=R),M=E(M,1),S=E(S,1)}return T=v(A,D.j(T)),new x(D,T)}for(D=h;A.l(T)>=0;){for(S=Math.max(1,Math.floor(A.m()/T.m())),M=Math.ceil(Math.log(S)/Math.LN2),M=M<=48?1:Math.pow(2,M-48),N=u(S),R=N.j(T);m(R)||R.l(A)>0;)S-=M,N=u(S),R=N.j(T);p(N)&&(N=d),D=D.add(N),A=v(A,R)}return new x(D,A)}n.B=function(A){return w(this,A).h},n.and=function(A){const T=Math.max(this.g.length,A.g.length),S=[];for(let M=0;M<T;M++)S[M]=this.i(M)&A.i(M);return new a(S,this.h&A.h)},n.or=function(A){const T=Math.max(this.g.length,A.g.length),S=[];for(let M=0;M<T;M++)S[M]=this.i(M)|A.i(M);return new a(S,this.h|A.h)},n.xor=function(A){const T=Math.max(this.g.length,A.g.length),S=[];for(let M=0;M<T;M++)S[M]=this.i(M)^A.i(M);return new a(S,this.h^A.h)};function _(A){const T=A.g.length+1,S=[];for(let M=0;M<T;M++)S[M]=A.i(M)<<1|A.i(M-1)>>>31;return new a(S,A.h)}function E(A,T){const S=T>>5;T%=32;const M=A.g.length-S,D=[];for(let N=0;N<M;N++)D[N]=T>0?A.i(N+S)>>>T|A.i(N+S+1)<<32-T:A.i(N+S);return new a(D,A.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,qK=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=c,mp=a}).apply(typeof Q6<"u"?Q6:typeof self<"u"?self:typeof window<"u"?window:{});var jA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var WK,V_,XK,gM,T3,KK,YK,QK;(function(){var n,e=Object.defineProperty;function t(C){C=[typeof globalThis=="object"&&globalThis,C,typeof window=="object"&&window,typeof self=="object"&&self,typeof jA=="object"&&jA];for(var U=0;U<C.length;++U){var q=C[U];if(q&&q.Math==Math)return q}throw Error("Cannot find global object")}var r=t(this);function i(C,U){if(U)e:{var q=r;C=C.split(".");for(var he=0;he<C.length-1;he++){var Ce=C[he];if(!(Ce in q))break e;q=q[Ce]}C=C[C.length-1],he=q[C],U=U(he),U!=he&&U!=null&&e(q,C,{configurable:!0,writable:!0,value:U})}}i("Symbol.dispose",function(C){return C||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(C){return C||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(C){return C||function(U){var q=[],he;for(he in U)Object.prototype.hasOwnProperty.call(U,he)&&q.push([he,U[he]]);return q}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},a=this||self;function o(C){var U=typeof C;return U=="object"&&C!=null||U=="function"}function l(C,U,q){return C.call.apply(C.bind,arguments)}function u(C,U,q){return u=l,u.apply(null,arguments)}function c(C,U){var q=Array.prototype.slice.call(arguments,1);return function(){var he=q.slice();return he.push.apply(he,arguments),C.apply(this,he)}}function h(C,U){function q(){}q.prototype=U.prototype,C.Z=U.prototype,C.prototype=new q,C.prototype.constructor=C,C.Ob=function(he,Ce,ke){for(var rt=Array(arguments.length-2),ln=2;ln<arguments.length;ln++)rt[ln-2]=arguments[ln];return U.prototype[Ce].apply(he,rt)}}var d=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?C=>C&&AsyncContext.Snapshot.wrap(C):C=>C;function f(C){const U=C.length;if(U>0){const q=Array(U);for(let he=0;he<U;he++)q[he]=C[he];return q}return[]}function p(C,U){for(let he=1;he<arguments.length;he++){const Ce=arguments[he];var q=typeof Ce;if(q=q!="object"?q:Ce?Array.isArray(Ce)?"array":q:"null",q=="array"||q=="object"&&typeof Ce.length=="number"){q=C.length||0;const ke=Ce.length||0;C.length=q+ke;for(let rt=0;rt<ke;rt++)C[q+rt]=Ce[rt]}else C.push(Ce)}}class m{constructor(U,q){this.i=U,this.j=q,this.h=0,this.g=null}get(){let U;return this.h>0?(this.h--,U=this.g,this.g=U.next,U.next=null):U=this.i(),U}}function y(C){a.setTimeout(()=>{throw C},0)}function v(){var C=A;let U=null;return C.g&&(U=C.g,C.g=C.g.next,C.g||(C.h=null),U.next=null),U}class b{constructor(){this.h=this.g=null}add(U,q){const he=x.get();he.set(U,q),this.h?this.h.next=he:this.g=he,this.h=he}}var x=new m(()=>new w,C=>C.reset());class w{constructor(){this.next=this.g=this.h=null}set(U,q){this.h=U,this.g=q,this.next=null}reset(){this.next=this.g=this.h=null}}let _,E=!1,A=new b,T=()=>{const C=Promise.resolve(void 0);_=()=>{C.then(S)}};function S(){for(var C;C=v();){try{C.h.call(C.g)}catch(q){y(q)}var U=x;U.j(C),U.h<100&&(U.h++,C.next=U.g,U.g=C)}E=!1}function M(){this.u=this.u,this.C=this.C}M.prototype.u=!1,M.prototype.dispose=function(){this.u||(this.u=!0,this.N())},M.prototype[Symbol.dispose]=function(){this.dispose()},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(C,U){this.type=C,this.g=this.target=U,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var N=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var C=!1,U=Object.defineProperty({},"passive",{get:function(){C=!0}});try{const q=()=>{};a.addEventListener("test",q,U),a.removeEventListener("test",q,U)}catch{}return C}();function R(C){return/^[\s\xa0]*$/.test(C)}function z(C,U){D.call(this,C?C.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,C&&this.init(C,U)}h(z,D),z.prototype.init=function(C,U){const q=this.type=C.type,he=C.changedTouches&&C.changedTouches.length?C.changedTouches[0]:null;this.target=C.target||C.srcElement,this.g=U,U=C.relatedTarget,U||(q=="mouseover"?U=C.fromElement:q=="mouseout"&&(U=C.toElement)),this.relatedTarget=U,he?(this.clientX=he.clientX!==void 0?he.clientX:he.pageX,this.clientY=he.clientY!==void 0?he.clientY:he.pageY,this.screenX=he.screenX||0,this.screenY=he.screenY||0):(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0),this.button=C.button,this.key=C.key||"",this.ctrlKey=C.ctrlKey,this.altKey=C.altKey,this.shiftKey=C.shiftKey,this.metaKey=C.metaKey,this.pointerId=C.pointerId||0,this.pointerType=C.pointerType,this.state=C.state,this.i=C,C.defaultPrevented&&z.Z.h.call(this)},z.prototype.h=function(){z.Z.h.call(this);const C=this.i;C.preventDefault?C.preventDefault():C.returnValue=!1};var j="closure_listenable_"+(Math.random()*1e6|0),I=0;function F(C,U,q,he,Ce){this.listener=C,this.proxy=null,this.src=U,this.type=q,this.capture=!!he,this.ha=Ce,this.key=++I,this.da=this.fa=!1}function $(C){C.da=!0,C.listener=null,C.proxy=null,C.src=null,C.ha=null}function H(C,U,q){for(const he in C)U.call(q,C[he],he,C)}function Z(C,U){for(const q in C)U.call(void 0,C[q],q,C)}function J(C){const U={};for(const q in C)U[q]=C[q];return U}const ee="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(C,U){let q,he;for(let Ce=1;Ce<arguments.length;Ce++){he=arguments[Ce];for(q in he)C[q]=he[q];for(let ke=0;ke<ee.length;ke++)q=ee[ke],Object.prototype.hasOwnProperty.call(he,q)&&(C[q]=he[q])}}function ue(C){this.src=C,this.g={},this.h=0}ue.prototype.add=function(C,U,q,he,Ce){const ke=C.toString();C=this.g[ke],C||(C=this.g[ke]=[],this.h++);const rt=re(C,U,he,Ce);return rt>-1?(U=C[rt],q||(U.fa=!1)):(U=new F(U,this.src,ke,!!he,Ce),U.fa=q,C.push(U)),U};function Q(C,U){const q=U.type;if(q in C.g){var he=C.g[q],Ce=Array.prototype.indexOf.call(he,U,void 0),ke;(ke=Ce>=0)&&Array.prototype.splice.call(he,Ce,1),ke&&($(U),C.g[q].length==0&&(delete C.g[q],C.h--))}}function re(C,U,q,he){for(let Ce=0;Ce<C.length;++Ce){const ke=C[Ce];if(!ke.da&&ke.listener==U&&ke.capture==!!q&&ke.ha==he)return Ce}return-1}var le="closure_lm_"+(Math.random()*1e6|0),te={};function Y(C,U,q,he,Ce){if(Array.isArray(U)){for(let ke=0;ke<U.length;ke++)Y(C,U[ke],q,he,Ce);return null}return q=de(q),C&&C[j]?C.J(U,q,o(he)?!!he.capture:!1,Ce):oe(C,U,q,!1,he,Ce)}function oe(C,U,q,he,Ce,ke){if(!U)throw Error("Invalid event type");const rt=o(Ce)?!!Ce.capture:!!Ce;let ln=ze(C);if(ln||(C[le]=ln=new ue(C)),q=ln.add(U,q,he,rt,ke),q.proxy)return q;if(he=ve(),q.proxy=he,he.src=C,he.listener=q,C.addEventListener)N||(Ce=rt),Ce===void 0&&(Ce=!1),C.addEventListener(U.toString(),he,Ce);else if(C.attachEvent)C.attachEvent(_e(U.toString()),he);else if(C.addListener&&C.removeListener)C.addListener(he);else throw Error("addEventListener and attachEvent are unavailable.");return q}function ve(){function C(q){return U.call(C.src,C.listener,q)}const U=Be;return C}function me(C,U,q,he,Ce){if(Array.isArray(U))for(var ke=0;ke<U.length;ke++)me(C,U[ke],q,he,Ce);else he=o(he)?!!he.capture:!!he,q=de(q),C&&C[j]?(C=C.i,ke=String(U).toString(),ke in C.g&&(U=C.g[ke],q=re(U,q,he,Ce),q>-1&&($(U[q]),Array.prototype.splice.call(U,q,1),U.length==0&&(delete C.g[ke],C.h--)))):C&&(C=ze(C))&&(U=C.g[U.toString()],C=-1,U&&(C=re(U,q,he,Ce)),(q=C>-1?U[C]:null)&&be(q))}function be(C){if(typeof C!="number"&&C&&!C.da){var U=C.src;if(U&&U[j])Q(U.i,C);else{var q=C.type,he=C.proxy;U.removeEventListener?U.removeEventListener(q,he,C.capture):U.detachEvent?U.detachEvent(_e(q),he):U.addListener&&U.removeListener&&U.removeListener(he),(q=ze(U))?(Q(q,C),q.h==0&&(q.src=null,U[le]=null)):$(C)}}}function _e(C){return C in te?te[C]:te[C]="on"+C}function Be(C,U){if(C.da)C=!0;else{U=new z(U,this);const q=C.listener,he=C.ha||C.src;C.fa&&be(C),C=q.call(he,U)}return C}function ze(C){return C=C[le],C instanceof ue?C:null}var tt="__closure_events_fn_"+(Math.random()*1e9>>>0);function de(C){return typeof C=="function"?C:(C[tt]||(C[tt]=function(U){return C.handleEvent(U)}),C[tt])}function Xe(){M.call(this),this.i=new ue(this),this.M=this,this.G=null}h(Xe,M),Xe.prototype[j]=!0,Xe.prototype.removeEventListener=function(C,U,q,he){me(this,C,U,q,he)};function Ke(C,U){var q,he=C.G;if(he)for(q=[];he;he=he.G)q.push(he);if(C=C.M,he=U.type||U,typeof U=="string")U=new D(U,C);else if(U instanceof D)U.target=U.target||C;else{var Ce=U;U=new D(he,C),O(U,Ce)}Ce=!0;let ke,rt;if(q)for(rt=q.length-1;rt>=0;rt--)ke=U.g=q[rt],Ce=se(ke,he,!0,U)&&Ce;if(ke=U.g=C,Ce=se(ke,he,!0,U)&&Ce,Ce=se(ke,he,!1,U)&&Ce,q)for(rt=0;rt<q.length;rt++)ke=U.g=q[rt],Ce=se(ke,he,!1,U)&&Ce}Xe.prototype.N=function(){if(Xe.Z.N.call(this),this.i){var C=this.i;for(const U in C.g){const q=C.g[U];for(let he=0;he<q.length;he++)$(q[he]);delete C.g[U],C.h--}}this.G=null},Xe.prototype.J=function(C,U,q,he){return this.i.add(String(C),U,!1,q,he)},Xe.prototype.K=function(C,U,q,he){return this.i.add(String(C),U,!0,q,he)};function se(C,U,q,he){if(U=C.i.g[String(U)],!U)return!0;U=U.concat();let Ce=!0;for(let ke=0;ke<U.length;++ke){const rt=U[ke];if(rt&&!rt.da&&rt.capture==q){const ln=rt.listener,wi=rt.ha||rt.src;rt.fa&&Q(C.i,rt),Ce=ln.call(wi,he)!==!1&&Ce}}return Ce&&!he.defaultPrevented}function fe(C,U){if(typeof C!="function")if(C&&typeof C.handleEvent=="function")C=u(C.handleEvent,C);else throw Error("Invalid listener argument");return Number(U)>2147483647?-1:a.setTimeout(C,U||0)}function L(C){C.g=fe(()=>{C.g=null,C.i&&(C.i=!1,L(C))},C.l);const U=C.h;C.h=null,C.m.apply(null,U)}class P extends M{constructor(U,q){super(),this.m=U,this.l=q,this.h=null,this.i=!1,this.g=null}j(U){this.h=arguments,this.g?this.i=!0:L(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function K(C){M.call(this),this.h=C,this.g={}}h(K,M);var ae=[];function pe(C){H(C.g,function(U,q){this.g.hasOwnProperty(q)&&be(U)},C),C.g={}}K.prototype.N=function(){K.Z.N.call(this),pe(this)},K.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ce=a.JSON.stringify,Ae=a.JSON.parse,we=class{stringify(C){return a.JSON.stringify(C,void 0)}parse(C){return a.JSON.parse(C,void 0)}};function Pe(){}function Te(){}var Ne={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function $e(){D.call(this,"d")}h($e,D);function Ye(){D.call(this,"c")}h(Ye,D);var Ge={},qe=null;function V(){return qe=qe||new Xe}Ge.Ia="serverreachability";function W(C){D.call(this,Ge.Ia,C)}h(W,D);function ye(C){const U=V();Ke(U,new W(U))}Ge.STAT_EVENT="statevent";function Ee(C,U){D.call(this,Ge.STAT_EVENT,C),this.stat=U}h(Ee,D);function Fe(C){const U=V();Ke(U,new Ee(U,C))}Ge.Ja="timingevent";function Le(C,U){D.call(this,Ge.Ja,C),this.size=U}h(Le,D);function Ue(C,U){if(typeof C!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){C()},U)}function nt(){this.g=!0}nt.prototype.ua=function(){this.g=!1};function Pt(C,U,q,he,Ce,ke){C.info(function(){if(C.g)if(ke){var rt="",ln=ke.split("&");for(let or=0;or<ln.length;or++){var wi=ln[or].split("=");if(wi.length>1){const Gi=wi[0];wi=wi[1];const Mu=Gi.split("_");rt=Mu.length>=2&&Mu[1]=="type"?rt+(Gi+"="+wi+"&"):rt+(Gi+"=redacted&")}}}else rt=null;else rt=ke;return"XMLHTTP REQ ("+he+") [attempt "+Ce+"]: "+U+`
`+q+`
`+rt})}function Vn(C,U,q,he,Ce,ke,rt){C.info(function(){return"XMLHTTP RESP ("+he+") [ attempt "+Ce+"]: "+U+`
`+q+`
`+ke+" "+rt})}function dn(C,U,q,he){C.info(function(){return"XMLHTTP TEXT ("+U+"): "+io(C,q)+(he?" "+he:"")})}function Ia(C,U){C.info(function(){return"TIMEOUT: "+U})}nt.prototype.info=function(){};function io(C,U){if(!C.g)return U;if(!U)return null;try{const ke=JSON.parse(U);if(ke){for(C=0;C<ke.length;C++)if(Array.isArray(ke[C])){var q=ke[C];if(!(q.length<2)){var he=q[1];if(Array.isArray(he)&&!(he.length<1)){var Ce=he[0];if(Ce!="noop"&&Ce!="stop"&&Ce!="close")for(let rt=1;rt<he.length;rt++)he[rt]=""}}}}return ce(ke)}catch{return U}}var Sd={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},am={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ad;function om(){}h(om,Pe),om.prototype.g=function(){return new XMLHttpRequest},Ad=new om;function Su(C){return encodeURIComponent(String(C))}function Zv(C){var U=1;C=C.split(":");const q=[];for(;U>0&&C.length;)q.push(C.shift()),U--;return C.length&&q.push(C.join(":")),q}function $i(C,U,q,he){this.j=C,this.i=U,this.l=q,this.S=he||1,this.V=new K(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Td}function Td(){this.i=null,this.g="",this.h=!1}var lm={},Md={};function Au(C,U,q){C.M=1,C.A=kn(xt(U)),C.u=q,C.R=!0,um(C,null)}function um(C,U){C.F=Date.now(),Dd(C),C.B=xt(C.A);var q=C.B,he=C.S;Array.isArray(he)||(he=[String(he)]),Tu(q.i,"t",he),C.C=0,q=C.j.L,C.h=new Td,C.g=s5(C.j,q?U:null,!C.u),C.P>0&&(C.O=new P(u(C.Y,C,C.g),C.P)),U=C.V,q=C.g,he=C.ba;var Ce="readystatechange";Array.isArray(Ce)||(Ce&&(ae[0]=Ce.toString()),Ce=ae);for(let ke=0;ke<Ce.length;ke++){const rt=Y(q,Ce[ke],he||U.handleEvent,!1,U.h||U);if(!rt)break;U.g[rt.key]=rt}U=C.J?J(C.J):{},C.u?(C.v||(C.v="POST"),U["Content-Type"]="application/x-www-form-urlencoded",C.g.ea(C.B,C.v,C.u,U)):(C.v="GET",C.g.ea(C.B,C.v,null,U)),ye(),Pt(C.i,C.v,C.B,C.l,C.S,C.u)}$i.prototype.ba=function(C){C=C.target;const U=this.O;U&&Id(C)==3?U.j():this.Y(C)},$i.prototype.Y=function(C){try{if(C==this.g)e:{const ln=Id(this.g),wi=this.g.ya(),or=this.g.ca();if(!(ln<3)&&(ln!=3||this.g&&(this.h.h||this.g.la()||XU(this.g)))){this.K||ln!=4||wi==7||(wi==8||or<=0?ye(3):ye(2)),hm(this);var U=this.g.ca();this.X=U;var q=Cd(this);if(this.o=U==200,Vn(this.i,this.v,this.B,this.l,this.S,ln,U),this.o){if(this.U&&!this.L){t:{if(this.g){var he,Ce=this.g;if((he=Ce.g?Ce.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(he)){var ke=he;break t}}ke=null}if(C=ke)dn(this.i,this.l,C,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,bn(this,C);else{this.o=!1,this.m=3,Fe(12),oa(this),Bc(this);break e}}if(this.R){C=!0;let Gi;for(;!this.K&&this.C<q.length;)if(Gi=Jv(this,q),Gi==Md){ln==4&&(this.m=4,Fe(14),C=!1),dn(this.i,this.l,null,"[Incomplete Response]");break}else if(Gi==lm){this.m=4,Fe(15),dn(this.i,this.l,q,"[Invalid Chunk]"),C=!1;break}else dn(this.i,this.l,Gi,null),bn(this,Gi);if(cm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ln!=4||q.length!=0||this.h.h||(this.m=1,Fe(16),C=!1),this.o=this.o&&C,!C)dn(this.i,this.l,q,"[Invalid Chunked Response]"),oa(this),Bc(this);else if(q.length>0&&!this.W){this.W=!0;var rt=this.j;rt.g==this&&rt.aa&&!rt.P&&(rt.j.info("Great, no buffering proxy detected. Bytes received: "+q.length),JN(rt),rt.P=!0,Fe(11))}}else dn(this.i,this.l,q,null),bn(this,q);ln==4&&oa(this),this.o&&!this.K&&(ln==4?t5(this.j,this):(this.o=!1,Dd(this)))}else cie(this.g),U==400&&q.indexOf("Unknown SID")>0?(this.m=3,Fe(12)):(this.m=0,Fe(13)),oa(this),Bc(this)}}}catch{}finally{}};function Cd(C){if(!cm(C))return C.g.la();const U=XU(C.g);if(U==="")return"";let q="";const he=U.length,Ce=Id(C.g)==4;if(!C.h.i){if(typeof TextDecoder>"u")return oa(C),Bc(C),"";C.h.i=new a.TextDecoder}for(let ke=0;ke<he;ke++)C.h.h=!0,q+=C.h.i.decode(U[ke],{stream:!(Ce&&ke==he-1)});return U.length=0,C.h.g+=q,C.C=0,C.h.g}function cm(C){return C.g?C.v=="GET"&&C.M!=2&&C.j.Aa:!1}function Jv(C,U){var q=C.C,he=U.indexOf(`
`,q);return he==-1?Md:(q=Number(U.substring(q,he)),isNaN(q)?lm:(he+=1,he+q>U.length?Md:(U=U.slice(he,he+q),C.C=he+q,U)))}$i.prototype.cancel=function(){this.K=!0,oa(this)};function Dd(C){C.T=Date.now()+C.H,e0(C,C.H)}function e0(C,U){if(C.D!=null)throw Error("WatchDog timer not null");C.D=Ue(u(C.aa,C),U)}function hm(C){C.D&&(a.clearTimeout(C.D),C.D=null)}$i.prototype.aa=function(){this.D=null;const C=Date.now();C-this.T>=0?(Ia(this.i,this.B),this.M!=2&&(ye(),Fe(17)),oa(this),this.m=2,Bc(this)):e0(this,this.T-C)};function Bc(C){C.j.I==0||C.K||t5(C.j,C)}function oa(C){hm(C);var U=C.O;U&&typeof U.dispose=="function"&&U.dispose(),C.O=null,pe(C.V),C.g&&(U=C.g,C.g=null,U.abort(),U.dispose())}function bn(C,U){try{var q=C.j;if(q.I!=0&&(q.g==C||Me(q.h,C))){if(!C.L&&Me(q.h,C)&&q.I==3){try{var he=q.Ba.g.parse(U)}catch{he=null}if(Array.isArray(he)&&he.length==3){var Ce=he;if(Ce[0]==0){e:if(!q.v){if(q.g)if(q.g.F+3e3<C.F)wA(q),bA(q);else break e;ZN(q),Fe(18)}}else q.xa=Ce[1],0<q.xa-q.K&&Ce[2]<37500&&q.F&&q.A==0&&!q.C&&(q.C=Ue(u(q.Va,q),6e3));Re(q.h)<=1&&q.ta&&(q.ta=void 0)}else fm(q,11)}else if((C.L||q.g==C)&&wA(q),!R(U))for(Ce=q.Ba.g.parse(U),U=0;U<Ce.length;U++){let or=Ce[U];const Gi=or[0];if(!(Gi<=q.K))if(q.K=Gi,or=or[1],q.I==2)if(or[0]=="c"){q.M=or[1],q.ba=or[2];const Mu=or[3];Mu!=null&&(q.ka=Mu,q.j.info("VER="+q.ka));const pm=or[4];pm!=null&&(q.za=pm,q.j.info("SVER="+q.za));const Pd=or[5];Pd!=null&&typeof Pd=="number"&&Pd>0&&(he=1.5*Pd,q.O=he,q.j.info("backChannelRequestTimeoutMs_="+he)),he=q;const Fd=C.g;if(Fd){const SA=Fd.g?Fd.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(SA){var ke=he.h;ke.g||SA.indexOf("spdy")==-1&&SA.indexOf("quic")==-1&&SA.indexOf("h2")==-1||(ke.j=ke.l,ke.g=new Set,ke.h&&(it(ke,ke.h),ke.h=null))}if(he.G){const eR=Fd.g?Fd.g.getResponseHeader("X-HTTP-Session-Id"):null;eR&&(he.wa=eR,Ot(he.J,he.G,eR))}}q.I=3,q.l&&q.l.ra(),q.aa&&(q.T=Date.now()-C.F,q.j.info("Handshake RTT: "+q.T+"ms")),he=q;var rt=C;if(he.na=i5(he,he.L?he.ba:null,he.W),rt.L){ht(he.h,rt);var ln=rt,wi=he.O;wi&&(ln.H=wi),ln.D&&(hm(ln),Dd(ln)),he.g=rt}else JU(he);q.i.length>0&&_A(q)}else or[0]!="stop"&&or[0]!="close"||fm(q,7);else q.I==3&&(or[0]=="stop"||or[0]=="close"?or[0]=="stop"?fm(q,7):QN(q):or[0]!="noop"&&q.l&&q.l.qa(or),q.A=0)}}ye(4)}catch{}}var ne=class{constructor(C,U){this.g=C,this.map=U}};function Se(C){this.l=C||10,a.PerformanceNavigationTiming?(C=a.performance.getEntriesByType("navigation"),C=C.length>0&&(C[0].nextHopProtocol=="hq"||C[0].nextHopProtocol=="h2")):C=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=C?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ie(C){return C.h?!0:C.g?C.g.size>=C.j:!1}function Re(C){return C.h?1:C.g?C.g.size:0}function Me(C,U){return C.h?C.h==U:C.g?C.g.has(U):!1}function it(C,U){C.g?C.g.add(U):C.h=U}function ht(C,U){C.h&&C.h==U?C.h=null:C.g&&C.g.has(U)&&C.g.delete(U)}Se.prototype.cancel=function(){if(this.i=at(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const C of this.g.values())C.cancel();this.g.clear()}};function at(C){if(C.h!=null)return C.i.concat(C.h.G);if(C.g!=null&&C.g.size!==0){let U=C.i;for(const q of C.g.values())U=U.concat(q.G);return U}return f(C.i)}var mt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wt(C,U){if(C){C=C.split("&");for(let q=0;q<C.length;q++){const he=C[q].indexOf("=");let Ce,ke=null;he>=0?(Ce=C[q].substring(0,he),ke=C[q].substring(he+1)):Ce=C[q],U(Ce,ke?decodeURIComponent(ke.replace(/\+/g," ")):"")}}}function At(C){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let U;C instanceof At?(this.l=C.l,Wt(this,C.j),this.o=C.o,this.g=C.g,Cn(this,C.u),this.h=C.h,mr(this,$U(C.i)),this.m=C.m):C&&(U=String(C).match(mt))?(this.l=!1,Wt(this,U[1]||"",!0),this.o=St(U[2]||""),this.g=St(U[3]||"",!0),Cn(this,U[4]),this.h=St(U[5]||"",!0),mr(this,U[6]||"",!0),this.m=St(U[7]||"")):(this.l=!1,this.i=new ui(null,this.l))}At.prototype.toString=function(){const C=[];var U=this.j;U&&C.push(_n(U,Is,!0),":");var q=this.g;return(q||U=="file")&&(C.push("//"),(U=this.o)&&C.push(_n(U,Is,!0),"@"),C.push(Su(q).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),q=this.u,q!=null&&C.push(":",String(q))),(q=this.h)&&(this.g&&q.charAt(0)!="/"&&C.push("/"),C.push(_n(q,q.charAt(0)=="/"?la:Nd,!0))),(q=this.i.toString())&&C.push("?",q),(q=this.m)&&C.push("#",_n(q,Zn)),C.join("")},At.prototype.resolve=function(C){const U=xt(this);let q=!!C.j;q?Wt(U,C.j):q=!!C.o,q?U.o=C.o:q=!!C.g,q?U.g=C.g:q=C.u!=null;var he=C.h;if(q)Cn(U,C.u);else if(q=!!C.h){if(he.charAt(0)!="/")if(this.g&&!this.h)he="/"+he;else{var Ce=U.h.lastIndexOf("/");Ce!=-1&&(he=U.h.slice(0,Ce+1)+he)}if(Ce=he,Ce==".."||Ce==".")he="";else if(Ce.indexOf("./")!=-1||Ce.indexOf("/.")!=-1){he=Ce.lastIndexOf("/",0)==0,Ce=Ce.split("/");const ke=[];for(let rt=0;rt<Ce.length;){const ln=Ce[rt++];ln=="."?he&&rt==Ce.length&&ke.push(""):ln==".."?((ke.length>1||ke.length==1&&ke[0]!="")&&ke.pop(),he&&rt==Ce.length&&ke.push("")):(ke.push(ln),he=!0)}he=ke.join("/")}else he=Ce}return q?U.h=he:q=C.i.toString()!=="",q?mr(U,$U(C.i)):q=!!C.m,q&&(U.m=C.m),U};function xt(C){return new At(C)}function Wt(C,U,q){C.j=q?St(U,!0):U,C.j&&(C.j=C.j.replace(/:$/,""))}function Cn(C,U){if(U){if(U=Number(U),isNaN(U)||U<0)throw Error("Bad port number "+U);C.u=U}else C.u=null}function mr(C,U,q){U instanceof ui?(C.i=U,iie(C.i,C.l)):(q||(U=_n(U,dm)),C.i=new ui(U,C.l))}function Ot(C,U,q){C.i.set(U,q)}function kn(C){return Ot(C,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),C}function St(C,U){return C?U?decodeURI(C.replace(/%25/g,"%2525")):decodeURIComponent(C):""}function _n(C,U,q){return typeof C=="string"?(C=encodeURI(C).replace(U,Dn),q&&(C=C.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C):null}function Dn(C){return C=C.charCodeAt(0),"%"+(C>>4&15).toString(16)+(C&15).toString(16)}var Is=/[#\/\?@]/g,Nd=/[#\?:]/g,la=/[#\?]/g,dm=/[#\?@]/g,Zn=/#/g;function ui(C,U){this.h=this.g=null,this.i=C||null,this.j=!!U}function ci(C){C.g||(C.g=new Map,C.h=0,C.i&&wt(C.i,function(U,q){C.add(decodeURIComponent(U.replace(/\+/g," ")),q)}))}n=ui.prototype,n.add=function(C,U){ci(this),this.i=null,C=n0(this,C);let q=this.g.get(C);return q||this.g.set(C,q=[]),q.push(U),this.h+=1,this};function Hi(C,U){ci(C),U=n0(C,U),C.g.has(U)&&(C.i=null,C.h-=C.g.get(U).length,C.g.delete(U))}function os(C,U){return ci(C),U=n0(C,U),C.g.has(U)}n.forEach=function(C,U){ci(this),this.g.forEach(function(q,he){q.forEach(function(Ce){C.call(U,Ce,he,this)},this)},this)};function t0(C,U){ci(C);let q=[];if(typeof U=="string")os(C,U)&&(q=q.concat(C.g.get(n0(C,U))));else for(C=Array.from(C.g.values()),U=0;U<C.length;U++)q=q.concat(C[U]);return q}n.set=function(C,U){return ci(this),this.i=null,C=n0(this,C),os(this,C)&&(this.h-=this.g.get(C).length),this.g.set(C,[U]),this.h+=1,this},n.get=function(C,U){return C?(C=t0(this,C),C.length>0?String(C[0]):U):U};function Tu(C,U,q){Hi(C,U),q.length>0&&(C.i=null,C.g.set(n0(C,U),f(q)),C.h+=q.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const C=[],U=Array.from(this.g.keys());for(let he=0;he<U.length;he++){var q=U[he];const Ce=Su(q);q=t0(this,q);for(let ke=0;ke<q.length;ke++){let rt=Ce;q[ke]!==""&&(rt+="="+Su(q[ke])),C.push(rt)}}return this.i=C.join("&")};function $U(C){const U=new ui;return U.i=C.i,C.g&&(U.g=new Map(C.g),U.h=C.h),U}function n0(C,U){return U=String(U),C.j&&(U=U.toLowerCase()),U}function iie(C,U){U&&!C.j&&(ci(C),C.i=null,C.g.forEach(function(q,he){const Ce=he.toLowerCase();he!=Ce&&(Hi(this,he),Tu(this,Ce,q))},C)),C.j=U}function sie(C,U){const q=new nt;if(a.Image){const he=new Image;he.onload=c(Rd,q,"TestLoadImage: loaded",!0,U,he),he.onerror=c(Rd,q,"TestLoadImage: error",!1,U,he),he.onabort=c(Rd,q,"TestLoadImage: abort",!1,U,he),he.ontimeout=c(Rd,q,"TestLoadImage: timeout",!1,U,he),a.setTimeout(function(){he.ontimeout&&he.ontimeout()},1e4),he.src=C}else U(!1)}function aie(C,U){const q=new nt,he=new AbortController,Ce=setTimeout(()=>{he.abort(),Rd(q,"TestPingServer: timeout",!1,U)},1e4);fetch(C,{signal:he.signal}).then(ke=>{clearTimeout(Ce),ke.ok?Rd(q,"TestPingServer: ok",!0,U):Rd(q,"TestPingServer: server error",!1,U)}).catch(()=>{clearTimeout(Ce),Rd(q,"TestPingServer: error",!1,U)})}function Rd(C,U,q,he,Ce){try{Ce&&(Ce.onload=null,Ce.onerror=null,Ce.onabort=null,Ce.ontimeout=null),he(q)}catch{}}function oie(){this.g=new we}function KN(C){this.i=C.Sb||null,this.h=C.ab||!1}h(KN,Pe),KN.prototype.g=function(){return new yA(this.i,this.h)};function yA(C,U){Xe.call(this),this.H=C,this.o=U,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(yA,Xe),n=yA.prototype,n.open=function(C,U){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=C,this.D=U,this.readyState=1,s_(this)},n.send=function(C){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const U={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};C&&(U.body=C),(this.H||a).fetch(new Request(this.D,U)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,i_(this)),this.readyState=0},n.Pa=function(C){if(this.g&&(this.l=C,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=C.headers,this.readyState=2,s_(this)),this.g&&(this.readyState=3,s_(this),this.g)))if(this.responseType==="arraybuffer")C.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in C){if(this.j=C.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;HU(this)}else C.text().then(this.Oa.bind(this),this.ga.bind(this))};function HU(C){C.j.read().then(C.Ma.bind(C)).catch(C.ga.bind(C))}n.Ma=function(C){if(this.g){if(this.o&&C.value)this.response.push(C.value);else if(!this.o){var U=C.value?C.value:new Uint8Array(0);(U=this.B.decode(U,{stream:!C.done}))&&(this.response=this.responseText+=U)}C.done?i_(this):s_(this),this.readyState==3&&HU(this)}},n.Oa=function(C){this.g&&(this.response=this.responseText=C,i_(this))},n.Na=function(C){this.g&&(this.response=C,i_(this))},n.ga=function(){this.g&&i_(this)};function i_(C){C.readyState=4,C.l=null,C.j=null,C.B=null,s_(C)}n.setRequestHeader=function(C,U){this.A.append(C,U)},n.getResponseHeader=function(C){return this.h&&this.h.get(C.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const C=[],U=this.h.entries();for(var q=U.next();!q.done;)q=q.value,C.push(q[0]+": "+q[1]),q=U.next();return C.join(`\r
`)};function s_(C){C.onreadystatechange&&C.onreadystatechange.call(C)}Object.defineProperty(yA.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(C){this.m=C?"include":"same-origin"}});function GU(C){let U="";return H(C,function(q,he){U+=he,U+=":",U+=q,U+=`\r
`}),U}function YN(C,U,q){e:{for(he in q){var he=!1;break e}he=!0}he||(q=GU(q),typeof C=="string"?q!=null&&Su(q):Ot(C,U,q))}function $r(C){Xe.call(this),this.headers=new Map,this.L=C||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h($r,Xe);var lie=/^https?$/i,uie=["POST","PUT"];n=$r.prototype,n.Fa=function(C){this.H=C},n.ea=function(C,U,q,he){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+C);U=U?U.toUpperCase():"GET",this.D=C,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ad.g(),this.g.onreadystatechange=d(u(this.Ca,this));try{this.B=!0,this.g.open(U,String(C),!0),this.B=!1}catch(ke){jU(this,ke);return}if(C=q||"",q=new Map(this.headers),he)if(Object.getPrototypeOf(he)===Object.prototype)for(var Ce in he)q.set(Ce,he[Ce]);else if(typeof he.keys=="function"&&typeof he.get=="function")for(const ke of he.keys())q.set(ke,he.get(ke));else throw Error("Unknown input type for opt_headers: "+String(he));he=Array.from(q.keys()).find(ke=>ke.toLowerCase()=="content-type"),Ce=a.FormData&&C instanceof a.FormData,!(Array.prototype.indexOf.call(uie,U,void 0)>=0)||he||Ce||q.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ke,rt]of q)this.g.setRequestHeader(ke,rt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(C),this.v=!1}catch(ke){jU(this,ke)}};function jU(C,U){C.h=!1,C.g&&(C.j=!0,C.g.abort(),C.j=!1),C.l=U,C.o=5,qU(C),xA(C)}function qU(C){C.A||(C.A=!0,Ke(C,"complete"),Ke(C,"error"))}n.abort=function(C){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=C||7,Ke(this,"complete"),Ke(this,"abort"),xA(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xA(this,!0)),$r.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?WU(this):this.Xa())},n.Xa=function(){WU(this)};function WU(C){if(C.h&&typeof s<"u"){if(C.v&&Id(C)==4)setTimeout(C.Ca.bind(C),0);else if(Ke(C,"readystatechange"),Id(C)==4){C.h=!1;try{const ke=C.ca();e:switch(ke){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var U=!0;break e;default:U=!1}var q;if(!(q=U)){var he;if(he=ke===0){let rt=String(C.D).match(mt)[1]||null;!rt&&a.self&&a.self.location&&(rt=a.self.location.protocol.slice(0,-1)),he=!lie.test(rt?rt.toLowerCase():"")}q=he}if(q)Ke(C,"complete"),Ke(C,"success");else{C.o=6;try{var Ce=Id(C)>2?C.g.statusText:""}catch{Ce=""}C.l=Ce+" ["+C.ca()+"]",qU(C)}}finally{xA(C)}}}}function xA(C,U){if(C.g){C.m&&(clearTimeout(C.m),C.m=null);const q=C.g;C.g=null,U||Ke(C,"ready");try{q.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Id(C){return C.g?C.g.readyState:0}n.ca=function(){try{return Id(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(C){if(this.g){var U=this.g.responseText;return C&&U.indexOf(C)==0&&(U=U.substring(C.length)),Ae(U)}};function XU(C){try{if(!C.g)return null;if("response"in C.g)return C.g.response;switch(C.F){case"":case"text":return C.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in C.g)return C.g.mozResponseArrayBuffer}return null}catch{return null}}function cie(C){const U={};C=(C.g&&Id(C)>=2&&C.g.getAllResponseHeaders()||"").split(`\r
`);for(let he=0;he<C.length;he++){if(R(C[he]))continue;var q=Zv(C[he]);const Ce=q[0];if(q=q[1],typeof q!="string")continue;q=q.trim();const ke=U[Ce]||[];U[Ce]=ke,ke.push(q)}Z(U,function(he){return he.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function a_(C,U,q){return q&&q.internalChannelParams&&q.internalChannelParams[C]||U}function KU(C){this.za=0,this.i=[],this.j=new nt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=a_("failFast",!1,C),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=a_("baseRetryDelayMs",5e3,C),this.Za=a_("retryDelaySeedMs",1e4,C),this.Ta=a_("forwardChannelMaxRetries",2,C),this.va=a_("forwardChannelRequestTimeoutMs",2e4,C),this.ma=C&&C.xmlHttpFactory||void 0,this.Ua=C&&C.Rb||void 0,this.Aa=C&&C.useFetchStreams||!1,this.O=void 0,this.L=C&&C.supportsCrossDomainXhr||!1,this.M="",this.h=new Se(C&&C.concurrentRequestLimit),this.Ba=new oie,this.S=C&&C.fastHandshake||!1,this.R=C&&C.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=C&&C.Pb||!1,C&&C.ua&&this.j.ua(),C&&C.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&C&&C.detectBufferingProxy||!1,this.ia=void 0,C&&C.longPollingTimeout&&C.longPollingTimeout>0&&(this.ia=C.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=KU.prototype,n.ka=8,n.I=1,n.connect=function(C,U,q,he){Fe(0),this.W=C,this.H=U||{},q&&he!==void 0&&(this.H.OSID=q,this.H.OAID=he),this.F=this.X,this.J=i5(this,null,this.W),_A(this)};function QN(C){if(YU(C),C.I==3){var U=C.V++,q=xt(C.J);if(Ot(q,"SID",C.M),Ot(q,"RID",U),Ot(q,"TYPE","terminate"),o_(C,q),U=new $i(C,C.j,U),U.M=2,U.A=kn(xt(q)),q=!1,a.navigator&&a.navigator.sendBeacon)try{q=a.navigator.sendBeacon(U.A.toString(),"")}catch{}!q&&a.Image&&(new Image().src=U.A,q=!0),q||(U.g=s5(U.j,null),U.g.ea(U.A)),U.F=Date.now(),Dd(U)}r5(C)}function bA(C){C.g&&(JN(C),C.g.cancel(),C.g=null)}function YU(C){bA(C),C.v&&(a.clearTimeout(C.v),C.v=null),wA(C),C.h.cancel(),C.m&&(typeof C.m=="number"&&a.clearTimeout(C.m),C.m=null)}function _A(C){if(!Ie(C.h)&&!C.m){C.m=!0;var U=C.Ea;_||T(),E||(_(),E=!0),A.add(U,C),C.D=0}}function hie(C,U){return Re(C.h)>=C.h.j-(C.m?1:0)?!1:C.m?(C.i=U.G.concat(C.i),!0):C.I==1||C.I==2||C.D>=(C.Sa?0:C.Ta)?!1:(C.m=Ue(u(C.Ea,C,U),n5(C,C.D)),C.D++,!0)}n.Ea=function(C){if(this.m)if(this.m=null,this.I==1){if(!C){this.V=Math.floor(Math.random()*1e5),C=this.V++;const Ce=new $i(this,this.j,C);let ke=this.o;if(this.U&&(ke?(ke=J(ke),O(ke,this.U)):ke=this.U),this.u!==null||this.R||(Ce.J=ke,ke=null),this.S)e:{for(var U=0,q=0;q<this.i.length;q++){t:{var he=this.i[q];if("__data__"in he.map&&(he=he.map.__data__,typeof he=="string")){he=he.length;break t}he=void 0}if(he===void 0)break;if(U+=he,U>4096){U=q;break e}if(U===4096||q===this.i.length-1){U=q+1;break e}}U=1e3}else U=1e3;U=ZU(this,Ce,U),q=xt(this.J),Ot(q,"RID",C),Ot(q,"CVER",22),this.G&&Ot(q,"X-HTTP-Session-Id",this.G),o_(this,q),ke&&(this.R?U="headers="+Su(GU(ke))+"&"+U:this.u&&YN(q,this.u,ke)),it(this.h,Ce),this.Ra&&Ot(q,"TYPE","init"),this.S?(Ot(q,"$req",U),Ot(q,"SID","null"),Ce.U=!0,Au(Ce,q,null)):Au(Ce,q,U),this.I=2}}else this.I==3&&(C?QU(this,C):this.i.length==0||Ie(this.h)||QU(this))};function QU(C,U){var q;U?q=U.l:q=C.V++;const he=xt(C.J);Ot(he,"SID",C.M),Ot(he,"RID",q),Ot(he,"AID",C.K),o_(C,he),C.u&&C.o&&YN(he,C.u,C.o),q=new $i(C,C.j,q,C.D+1),C.u===null&&(q.J=C.o),U&&(C.i=U.G.concat(C.i)),U=ZU(C,q,1e3),q.H=Math.round(C.va*.5)+Math.round(C.va*.5*Math.random()),it(C.h,q),Au(q,he,U)}function o_(C,U){C.H&&H(C.H,function(q,he){Ot(U,he,q)}),C.l&&H({},function(q,he){Ot(U,he,q)})}function ZU(C,U,q){q=Math.min(C.i.length,q);const he=C.l?u(C.l.Ka,C.l,C):null;e:{var Ce=C.i;let ln=-1;for(;;){const wi=["count="+q];ln==-1?q>0?(ln=Ce[0].g,wi.push("ofs="+ln)):ln=0:wi.push("ofs="+ln);let or=!0;for(let Gi=0;Gi<q;Gi++){var ke=Ce[Gi].g;const Mu=Ce[Gi].map;if(ke-=ln,ke<0)ln=Math.max(0,Ce[Gi].g-100),or=!1;else try{ke="req"+ke+"_"||"";try{var rt=Mu instanceof Map?Mu:Object.entries(Mu);for(const[pm,Pd]of rt){let Fd=Pd;o(Pd)&&(Fd=ce(Pd)),wi.push(ke+pm+"="+encodeURIComponent(Fd))}}catch(pm){throw wi.push(ke+"type="+encodeURIComponent("_badmap")),pm}}catch{he&&he(Mu)}}if(or){rt=wi.join("&");break e}}rt=void 0}return C=C.i.splice(0,q),U.G=C,rt}function JU(C){if(!C.g&&!C.v){C.Y=1;var U=C.Da;_||T(),E||(_(),E=!0),A.add(U,C),C.A=0}}function ZN(C){return C.g||C.v||C.A>=3?!1:(C.Y++,C.v=Ue(u(C.Da,C),n5(C,C.A)),C.A++,!0)}n.Da=function(){if(this.v=null,e5(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var C=4*this.T;this.j.info("BP detection timer enabled: "+C),this.B=Ue(u(this.Wa,this),C)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Fe(10),bA(this),e5(this))};function JN(C){C.B!=null&&(a.clearTimeout(C.B),C.B=null)}function e5(C){C.g=new $i(C,C.j,"rpc",C.Y),C.u===null&&(C.g.J=C.o),C.g.P=0;var U=xt(C.na);Ot(U,"RID","rpc"),Ot(U,"SID",C.M),Ot(U,"AID",C.K),Ot(U,"CI",C.F?"0":"1"),!C.F&&C.ia&&Ot(U,"TO",C.ia),Ot(U,"TYPE","xmlhttp"),o_(C,U),C.u&&C.o&&YN(U,C.u,C.o),C.O&&(C.g.H=C.O);var q=C.g;C=C.ba,q.M=1,q.A=kn(xt(U)),q.u=null,q.R=!0,um(q,C)}n.Va=function(){this.C!=null&&(this.C=null,bA(this),ZN(this),Fe(19))};function wA(C){C.C!=null&&(a.clearTimeout(C.C),C.C=null)}function t5(C,U){var q=null;if(C.g==U){wA(C),JN(C),C.g=null;var he=2}else if(Me(C.h,U))q=U.G,ht(C.h,U),he=1;else return;if(C.I!=0){if(U.o)if(he==1){q=U.u?U.u.length:0,U=Date.now()-U.F;var Ce=C.D;he=V(),Ke(he,new Le(he,q)),_A(C)}else JU(C);else if(Ce=U.m,Ce==3||Ce==0&&U.X>0||!(he==1&&hie(C,U)||he==2&&ZN(C)))switch(q&&q.length>0&&(U=C.h,U.i=U.i.concat(q)),Ce){case 1:fm(C,5);break;case 4:fm(C,10);break;case 3:fm(C,6);break;default:fm(C,2)}}}function n5(C,U){let q=C.Qa+Math.floor(Math.random()*C.Za);return C.isActive()||(q*=2),q*U}function fm(C,U){if(C.j.info("Error code "+U),U==2){var q=u(C.bb,C),he=C.Ua;const Ce=!he;he=new At(he||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Wt(he,"https"),kn(he),Ce?sie(he.toString(),q):aie(he.toString(),q)}else Fe(2);C.I=0,C.l&&C.l.pa(U),r5(C),YU(C)}n.bb=function(C){C?(this.j.info("Successfully pinged google.com"),Fe(2)):(this.j.info("Failed to ping google.com"),Fe(1))};function r5(C){if(C.I=0,C.ja=[],C.l){const U=at(C.h);(U.length!=0||C.i.length!=0)&&(p(C.ja,U),p(C.ja,C.i),C.h.i.length=0,f(C.i),C.i.length=0),C.l.oa()}}function i5(C,U,q){var he=q instanceof At?xt(q):new At(q);if(he.g!="")U&&(he.g=U+"."+he.g),Cn(he,he.u);else{var Ce=a.location;he=Ce.protocol,U=U?U+"."+Ce.hostname:Ce.hostname,Ce=+Ce.port;const ke=new At(null);he&&Wt(ke,he),U&&(ke.g=U),Ce&&Cn(ke,Ce),q&&(ke.h=q),he=ke}return q=C.G,U=C.wa,q&&U&&Ot(he,q,U),Ot(he,"VER",C.ka),o_(C,he),he}function s5(C,U,q){if(U&&!C.L)throw Error("Can't create secondary domain capable XhrIo object.");return U=C.Aa&&!C.ma?new $r(new KN({ab:q})):new $r(C.ma),U.Fa(C.L),U}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function a5(){}n=a5.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function EA(){}EA.prototype.g=function(C,U){return new so(C,U)};function so(C,U){Xe.call(this),this.g=new KU(U),this.l=C,this.h=U&&U.messageUrlParams||null,C=U&&U.messageHeaders||null,U&&U.clientProtocolHeaderRequired&&(C?C["X-Client-Protocol"]="webchannel":C={"X-Client-Protocol":"webchannel"}),this.g.o=C,C=U&&U.initMessageHeaders||null,U&&U.messageContentType&&(C?C["X-WebChannel-Content-Type"]=U.messageContentType:C={"X-WebChannel-Content-Type":U.messageContentType}),U&&U.sa&&(C?C["X-WebChannel-Client-Profile"]=U.sa:C={"X-WebChannel-Client-Profile":U.sa}),this.g.U=C,(C=U&&U.Qb)&&!R(C)&&(this.g.u=C),this.A=U&&U.supportsCrossDomainXhr||!1,this.v=U&&U.sendRawJson||!1,(U=U&&U.httpSessionIdParam)&&!R(U)&&(this.g.G=U,C=this.h,C!==null&&U in C&&(C=this.h,U in C&&delete C[U])),this.j=new r0(this)}h(so,Xe),so.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},so.prototype.close=function(){QN(this.g)},so.prototype.o=function(C){var U=this.g;if(typeof C=="string"){var q={};q.__data__=C,C=q}else this.v&&(q={},q.__data__=ce(C),C=q);U.i.push(new ne(U.Ya++,C)),U.I==3&&_A(U)},so.prototype.N=function(){this.g.l=null,delete this.j,QN(this.g),delete this.g,so.Z.N.call(this)};function o5(C){$e.call(this),C.__headers__&&(this.headers=C.__headers__,this.statusCode=C.__status__,delete C.__headers__,delete C.__status__);var U=C.__sm__;if(U){e:{for(const q in U){C=q;break e}C=void 0}(this.i=C)&&(C=this.i,U=U!==null&&C in U?U[C]:void 0),this.data=U}else this.data=C}h(o5,$e);function l5(){Ye.call(this),this.status=1}h(l5,Ye);function r0(C){this.g=C}h(r0,a5),r0.prototype.ra=function(){Ke(this.g,"a")},r0.prototype.qa=function(C){Ke(this.g,new o5(C))},r0.prototype.pa=function(C){Ke(this.g,new l5)},r0.prototype.oa=function(){Ke(this.g,"b")},EA.prototype.createWebChannel=EA.prototype.g,so.prototype.send=so.prototype.o,so.prototype.open=so.prototype.m,so.prototype.close=so.prototype.close,QK=function(){return new EA},YK=function(){return V()},KK=Ge,T3={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Sd.NO_ERROR=0,Sd.TIMEOUT=8,Sd.HTTP_ERROR=6,gM=Sd,am.COMPLETE="complete",XK=am,Te.EventType=Ne,Ne.OPEN="a",Ne.CLOSE="b",Ne.ERROR="c",Ne.MESSAGE="d",Xe.prototype.listen=Xe.prototype.J,V_=Te,$r.prototype.listenOnce=$r.prototype.K,$r.prototype.getLastError=$r.prototype.Ha,$r.prototype.getLastErrorCode=$r.prototype.ya,$r.prototype.getStatus=$r.prototype.ca,$r.prototype.getResponseJson=$r.prototype.La,$r.prototype.getResponseText=$r.prototype.la,$r.prototype.send=$r.prototype.ea,$r.prototype.setWithCredentials=$r.prototype.Fa,WK=$r}).apply(typeof jA<"u"?jA:typeof self<"u"?self:typeof window<"u"?window:{});const Z6="@firebase/firestore",J6="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}qs.UNAUTHENTICATED=new qs(null),qs.GOOGLE_CREDENTIALS=new qs("google-credentials-uid"),qs.FIRST_PARTY=new qs("first-party-uid"),qs.MOCK_USER=new qs("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bb="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ev=new bB("@firebase/firestore");function M0(){return Ev.logLevel}function dt(n,...e){if(Ev.logLevel<=vn.DEBUG){const t=e.map(EB);Ev.debug(`Firestore (${Bb}): ${n}`,...t)}}function ud(n,...e){if(Ev.logLevel<=vn.ERROR){const t=e.map(EB);Ev.error(`Firestore (${Bb}): ${n}`,...t)}}function ub(n,...e){if(Ev.logLevel<=vn.WARN){const t=e.map(EB);Ev.warn(`Firestore (${Bb}): ${n}`,...t)}}function EB(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lt(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,ZK(n,r,t)}function ZK(n,e,t){let r=`FIRESTORE (${Bb}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw ud(r),new Error(r)}function $n(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||ZK(e,i,r)}function Yt(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const He={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ut extends Ic{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JK{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class _pe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(qs.UNAUTHENTICATED))}shutdown(){}}class wpe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Epe{constructor(e){this.t=e,this.currentUser=qs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){$n(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let s=new qh;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new qh,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{dt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(dt("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new qh)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(dt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?($n(typeof r.accessToken=="string",31837,{l:r}),new JK(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return $n(e===null||typeof e=="string",2055,{h:e}),new qs(e)}}class Spe{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=qs.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Ape{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Spe(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(qs.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ez{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Tpe{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Fo(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){$n(this.o===void 0,3512);const r=s=>{s.error!=null&&dt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,dt("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{dt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):dt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new ez(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?($n(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new ez(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mpe(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SB{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=Mpe(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function yn(n,e){return n<e?-1:n>e?1:0}function M3(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),s=e.charAt(r);if(i!==s)return YR(i)===YR(s)?yn(i,s):YR(i)?1:-1}return yn(n.length,e.length)}const Cpe=55296,Dpe=57343;function YR(n){const e=n.charCodeAt(0);return e>=Cpe&&e<=Dpe}function cb(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tz="__name__";class Ou{constructor(e,t,r){t===void 0?t=0:t>e.length&&Lt(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Lt(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ou.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ou?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=Ou.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return yn(e.length,t.length)}static compareSegments(e,t){const r=Ou.isNumericId(e),i=Ou.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Ou.extractNumericId(e).compare(Ou.extractNumericId(t)):M3(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return mp.fromString(e.substring(4,e.length-2))}}class yr extends Ou{construct(e,t,r){return new yr(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ut(He.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new yr(t)}static emptyPath(){return new yr([])}}const Npe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bs extends Ou{construct(e,t,r){return new bs(e,t,r)}static isValidIdentifier(e){return Npe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bs.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===tz}static keyField(){return new bs([tz])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ut(He.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new ut(He.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ut(He.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(r+=o,i++):(s(),i++)}if(s(),a)throw new ut(He.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new bs(t)}static emptyPath(){return new bs([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e){this.path=e}static fromPath(e){return new Ct(yr.fromString(e))}static fromName(e){return new Ct(yr.fromString(e).popFirst(5))}static empty(){return new Ct(yr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&yr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return yr.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ct(new yr(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eY(n,e,t){if(!t)throw new ut(He.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Rpe(n,e,t,r){if(e===!0&&r===!0)throw new ut(He.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function nz(n){if(!Ct.isDocumentKey(n))throw new ut(He.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function rz(n){if(Ct.isDocumentKey(n))throw new ut(He.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function tY(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function j2(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Lt(12329,{type:typeof n})}function eo(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ut(He.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=j2(n);throw new ut(He.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xi(n,e){const t={typeString:n};return e&&(t.value=e),t}function FS(n,e){if(!tY(n))throw new ut(He.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new ut(He.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iz=-62135596800,sz=1e6;class Er{static now(){return Er.fromMillis(Date.now())}static fromDate(e){return Er.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*sz);return new Er(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ut(He.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ut(He.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<iz)throw new ut(He.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ut(He.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/sz}_compareTo(e){return this.seconds===e.seconds?yn(this.nanoseconds,e.nanoseconds):yn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Er._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(FS(e,Er._jsonSchema))return new Er(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-iz;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Er._jsonSchemaVersion="firestore/timestamp/1.0",Er._jsonSchema={type:xi("string",Er._jsonSchemaVersion),seconds:xi("number"),nanoseconds:xi("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{static fromTimestamp(e){return new Gt(e)}static min(){return new Gt(new Er(0,0))}static max(){return new Gt(new Er(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uw=-1;function Ipe(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Gt.fromTimestamp(r===1e9?new Er(t+1,0):new Er(t,r));return new Sp(i,Ct.empty(),e)}function Ppe(n){return new Sp(n.readTime,n.key,uw)}class Sp{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Sp(Gt.min(),Ct.empty(),uw)}static max(){return new Sp(Gt.max(),Ct.empty(),uw)}}function Fpe(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ct.comparator(n.documentKey,e.documentKey),t!==0?t:yn(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lpe="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ope{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ub(n){if(n.code!==He.FAILED_PRECONDITION||n.message!==Lpe)throw n;dt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Lt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new je((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof je?t:je.resolve(t)}catch(t){return je.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):je.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):je.reject(t)}static resolve(e){return new je((t,r)=>{t(e)})}static reject(e){return new je((t,r)=>{r(e)})}static waitFor(e){return new je((t,r)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&t()},l=>r(l))}),a=!0,s===i&&t()})}static or(e){let t=je.resolve(!1);for(const r of e)t=t.next(i=>i?je.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new je((r,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const u=l;t(e[u]).next(c=>{a[u]=c,++o,o===s&&r(a)},c=>i(c))}})}static doWhile(e,t){return new je((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}function kpe(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Vb(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q2{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}q2.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AB=-1;function W2(n){return n==null}function qC(n){return n===0&&1/n==-1/0}function Bpe(n){return typeof n=="number"&&Number.isInteger(n)&&!qC(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nY="";function Upe(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=az(e)),e=Vpe(n.get(t),e);return az(e)}function Vpe(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case nY:t+="";break;default:t+=s}}return t}function az(n){return n+nY+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oz(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Gp(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function rY(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(e,t){this.comparator=e,this.root=t||vs.EMPTY}insert(e,t){return new zr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,vs.BLACK,null,null))}remove(e){return new zr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,vs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new qA(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new qA(this.root,e,this.comparator,!1)}getReverseIterator(){return new qA(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new qA(this.root,e,this.comparator,!0)}}class qA{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class vs{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??vs.RED,this.left=i??vs.EMPTY,this.right=s??vs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new vs(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return vs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return vs.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,vs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,vs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Lt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Lt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Lt(27949);return e+(this.isRed()?0:1)}}vs.EMPTY=null,vs.RED=!0,vs.BLACK=!1;vs.EMPTY=new class{constructor(){this.size=0}get key(){throw Lt(57766)}get value(){throw Lt(16141)}get color(){throw Lt(16727)}get left(){throw Lt(29726)}get right(){throw Lt(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new vs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(e){this.comparator=e,this.data=new zr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new lz(this.data.getIterator())}getIteratorFrom(e){return new lz(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Ii)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ii(this.comparator);return t.data=e,t}}class lz{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(e){this.fields=e,e.sort(bs.comparator)}static empty(){return new ko([])}unionWith(e){let t=new Ii(bs.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new ko(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return cb(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iY extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new iY("Invalid base64 string: "+s):s}}(e);return new Ds(t)}static fromUint8Array(e){const t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Ds(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return yn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ds.EMPTY_BYTE_STRING=new Ds("");const zpe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ap(n){if($n(!!n,39018),typeof n=="string"){let e=0;const t=zpe.exec(n);if($n(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:si(n.seconds),nanos:si(n.nanos)}}function si(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Tp(n){return typeof n=="string"?Ds.fromBase64String(n):Ds.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sY="server_timestamp",aY="__type__",oY="__previous_value__",lY="__local_write_time__";function TB(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[aY])==null?void 0:r.stringValue)===sY}function X2(n){const e=n.mapValue.fields[oY];return TB(e)?X2(e):e}function cw(n){const e=Ap(n.mapValue.fields[lY].timestampValue);return new Er(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $pe{constructor(e,t,r,i,s,a,o,l,u,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=c}}const WC="(default)";class hw{constructor(e,t){this.projectId=e,this.database=t||WC}static empty(){return new hw("","")}get isDefaultDatabase(){return this.database===WC}isEqual(e){return e instanceof hw&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uY="__type__",Hpe="__max__",WA={mapValue:{}},cY="__vector__",XC="value";function Mp(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?TB(n)?4:jpe(n)?9007199254740991:Gpe(n)?10:11:Lt(28295,{value:n})}function Sc(n,e){if(n===e)return!0;const t=Mp(n);if(t!==Mp(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return cw(n).isEqual(cw(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Ap(i.timestampValue),o=Ap(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Tp(i.bytesValue).isEqual(Tp(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return si(i.geoPointValue.latitude)===si(s.geoPointValue.latitude)&&si(i.geoPointValue.longitude)===si(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return si(i.integerValue)===si(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=si(i.doubleValue),o=si(s.doubleValue);return a===o?qC(a)===qC(o):isNaN(a)&&isNaN(o)}return!1}(n,e);case 9:return cb(n.arrayValue.values||[],e.arrayValue.values||[],Sc);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(oz(a)!==oz(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Sc(a[l],o[l])))return!1;return!0}(n,e);default:return Lt(52216,{left:n})}}function dw(n,e){return(n.values||[]).find(t=>Sc(t,e))!==void 0}function hb(n,e){if(n===e)return 0;const t=Mp(n),r=Mp(e);if(t!==r)return yn(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return yn(n.booleanValue,e.booleanValue);case 2:return function(s,a){const o=si(s.integerValue||s.doubleValue),l=si(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(n,e);case 3:return uz(n.timestampValue,e.timestampValue);case 4:return uz(cw(n),cw(e));case 5:return M3(n.stringValue,e.stringValue);case 6:return function(s,a){const o=Tp(s),l=Tp(a);return o.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const c=yn(o[u],l[u]);if(c!==0)return c}return yn(o.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){const o=yn(si(s.latitude),si(a.latitude));return o!==0?o:yn(si(s.longitude),si(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return cz(n.arrayValue,e.arrayValue);case 10:return function(s,a){var d,f,p,m;const o=s.fields||{},l=a.fields||{},u=(d=o[XC])==null?void 0:d.arrayValue,c=(f=l[XC])==null?void 0:f.arrayValue,h=yn(((p=u==null?void 0:u.values)==null?void 0:p.length)||0,((m=c==null?void 0:c.values)==null?void 0:m.length)||0);return h!==0?h:cz(u,c)}(n.mapValue,e.mapValue);case 11:return function(s,a){if(s===WA.mapValue&&a===WA.mapValue)return 0;if(s===WA.mapValue)return 1;if(a===WA.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),u=a.fields||{},c=Object.keys(u);l.sort(),c.sort();for(let h=0;h<l.length&&h<c.length;++h){const d=M3(l[h],c[h]);if(d!==0)return d;const f=hb(o[l[h]],u[c[h]]);if(f!==0)return f}return yn(l.length,c.length)}(n.mapValue,e.mapValue);default:throw Lt(23264,{he:t})}}function uz(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return yn(n,e);const t=Ap(n),r=Ap(e),i=yn(t.seconds,r.seconds);return i!==0?i:yn(t.nanos,r.nanos)}function cz(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=hb(t[i],r[i]);if(s)return s}return yn(t.length,r.length)}function db(n){return C3(n)}function C3(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Ap(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Tp(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Ct.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=C3(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${C3(t.fields[a])}`;return i+"}"}(n.mapValue):Lt(61005,{value:n})}function vM(n){switch(Mp(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=X2(n);return e?16+vM(e):16;case 5:return 2*n.stringValue.length;case 6:return Tp(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+vM(s),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return Gp(r.fields,(s,a)=>{i+=s.length+vM(a)}),i}(n.mapValue);default:throw Lt(13486,{value:n})}}function hz(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function D3(n){return!!n&&"integerValue"in n}function MB(n){return!!n&&"arrayValue"in n}function dz(n){return!!n&&"nullValue"in n}function fz(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function yM(n){return!!n&&"mapValue"in n}function Gpe(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[uY])==null?void 0:r.stringValue)===cY}function N1(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Gp(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=N1(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=N1(n.arrayValue.values[t]);return e}return{...n}}function jpe(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Hpe}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e){this.value=e}static empty(){return new Wa({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!yM(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=N1(t)}setAll(e){let t=bs.emptyPath(),r={},i=[];e.forEach((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=o.popLast()}a?r[o.lastSegment()]=N1(a):i.push(o.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());yM(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Sc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];yM(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Gp(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Wa(N1(this.value))}}function hY(n){const e=[];return Gp(n.fields,(t,r)=>{const i=new bs([t]);if(yM(r)){const s=hY(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new ko(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(e,t,r,i,s,a,o){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Xs(e,0,Gt.min(),Gt.min(),Gt.min(),Wa.empty(),0)}static newFoundDocument(e,t,r,i){return new Xs(e,1,t,Gt.min(),r,i,0)}static newNoDocument(e,t){return new Xs(e,2,t,Gt.min(),Gt.min(),Wa.empty(),0)}static newUnknownDocument(e,t){return new Xs(e,3,t,Gt.min(),Gt.min(),Wa.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Gt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Wa.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Wa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Gt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Xs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Xs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(e,t){this.position=e,this.inclusive=t}}function pz(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(s.field.isKeyField()?r=Ct.comparator(Ct.fromName(a.referenceValue),t.key):r=hb(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function mz(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Sc(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(e,t="asc"){this.field=e,this.dir=t}}function qpe(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dY{}class yi extends dY{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Xpe(e,t,r):t==="array-contains"?new Qpe(e,r):t==="in"?new Zpe(e,r):t==="not-in"?new Jpe(e,r):t==="array-contains-any"?new eme(e,r):new yi(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Kpe(e,r):new Ype(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(hb(t,this.value)):t!==null&&Mp(this.value)===Mp(t)&&this.matchesComparison(hb(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Lt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class pu extends dY{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new pu(e,t)}matches(e){return fY(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function fY(n){return n.op==="and"}function pY(n){return Wpe(n)&&fY(n)}function Wpe(n){for(const e of n.filters)if(e instanceof pu)return!1;return!0}function N3(n){if(n instanceof yi)return n.field.canonicalString()+n.op.toString()+db(n.value);if(pY(n))return n.filters.map(e=>N3(e)).join(",");{const e=n.filters.map(t=>N3(t)).join(",");return`${n.op}(${e})`}}function mY(n,e){return n instanceof yi?function(r,i){return i instanceof yi&&r.op===i.op&&r.field.isEqual(i.field)&&Sc(r.value,i.value)}(n,e):n instanceof pu?function(r,i){return i instanceof pu&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,o)=>s&&mY(a,i.filters[o]),!0):!1}(n,e):void Lt(19439)}function gY(n){return n instanceof yi?function(t){return`${t.field.canonicalString()} ${t.op} ${db(t.value)}`}(n):n instanceof pu?function(t){return t.op.toString()+" {"+t.getFilters().map(gY).join(" ,")+"}"}(n):"Filter"}class Xpe extends yi{constructor(e,t,r){super(e,t,r),this.key=Ct.fromName(r.referenceValue)}matches(e){const t=Ct.comparator(e.key,this.key);return this.matchesComparison(t)}}class Kpe extends yi{constructor(e,t){super(e,"in",t),this.keys=vY("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Ype extends yi{constructor(e,t){super(e,"not-in",t),this.keys=vY("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function vY(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map(r=>Ct.fromName(r.referenceValue))}class Qpe extends yi{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return MB(t)&&dw(t.arrayValue,this.value)}}class Zpe extends yi{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&dw(this.value.arrayValue,t)}}class Jpe extends yi{constructor(e,t){super(e,"not-in",t)}matches(e){if(dw(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!dw(this.value.arrayValue,t)}}class eme extends yi{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!MB(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>dw(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tme{constructor(e,t=null,r=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.Te=null}}function gz(n,e=null,t=[],r=[],i=null,s=null,a=null){return new tme(n,e,t,r,i,s,a)}function CB(n){const e=Yt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>N3(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),W2(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>db(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>db(r)).join(",")),e.Te=t}return e.Te}function DB(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!qpe(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!mY(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!mz(n.startAt,e.startAt)&&mz(n.endAt,e.endAt)}function R3(n){return Ct.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zb{constructor(e,t=null,r=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function nme(n,e,t,r,i,s,a,o){return new zb(n,e,t,r,i,s,a,o)}function K2(n){return new zb(n)}function vz(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function yY(n){return n.collectionGroup!==null}function R1(n){const e=Yt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Ii(bs.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(o=o.add(u.field))})}),o})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new fw(s,r))}),t.has(bs.keyField().canonicalString())||e.Ie.push(new fw(bs.keyField(),r))}return e.Ie}function gc(n){const e=Yt(n);return e.Ee||(e.Ee=rme(e,R1(n))),e.Ee}function rme(n,e){if(n.limitType==="F")return gz(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new fw(i.field,s)});const t=n.endAt?new KC(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new KC(n.startAt.position,n.startAt.inclusive):null;return gz(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function I3(n,e){const t=n.filters.concat([e]);return new zb(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function YC(n,e,t){return new zb(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Y2(n,e){return DB(gc(n),gc(e))&&n.limitType===e.limitType}function xY(n){return`${CB(gc(n))}|lt:${n.limitType}`}function C0(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>gY(i)).join(", ")}]`),W2(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>db(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>db(i)).join(",")),`Target(${r})`}(gc(n))}; limitType=${n.limitType})`}function Q2(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Ct.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of R1(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,o,l){const u=pz(a,o,l);return a.inclusive?u<=0:u<0}(r.startAt,R1(r),i)||r.endAt&&!function(a,o,l){const u=pz(a,o,l);return a.inclusive?u>=0:u>0}(r.endAt,R1(r),i))}(n,e)}function ime(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function bY(n){return(e,t)=>{let r=!1;for(const i of R1(n)){const s=sme(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function sme(n,e,t){const r=n.field.isKeyField()?Ct.comparator(e.key,t.key):function(s,a,o){const l=a.data.field(s),u=o.data.field(s);return l!==null&&u!==null?hb(l,u):Lt(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Lt(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kv{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Gp(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return rY(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ame=new zr(Ct.comparator);function cd(){return ame}const _Y=new zr(Ct.comparator);function z_(...n){let e=_Y;for(const t of n)e=e.insert(t.key,t);return e}function wY(n){let e=_Y;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function $m(){return I1()}function EY(){return I1()}function I1(){return new kv(n=>n.toString(),(n,e)=>n.isEqual(e))}const ome=new zr(Ct.comparator),lme=new Ii(Ct.comparator);function xn(...n){let e=lme;for(const t of n)e=e.add(t);return e}const ume=new Ii(yn);function cme(){return ume}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NB(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qC(e)?"-0":e}}function SY(n){return{integerValue:""+n}}function AY(n,e){return Bpe(e)?SY(e):NB(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z2{constructor(){this._=void 0}}function hme(n,e,t){return n instanceof pw?function(i,s){const a={fields:{[aY]:{stringValue:sY},[lY]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&TB(s)&&(s=X2(s)),s&&(a.fields[oY]=s),{mapValue:a}}(t,e):n instanceof mw?MY(n,e):n instanceof gw?CY(n,e):function(i,s){const a=TY(i,s),o=yz(a)+yz(i.Ae);return D3(a)&&D3(i.Ae)?SY(o):NB(i.serializer,o)}(n,e)}function dme(n,e,t){return n instanceof mw?MY(n,e):n instanceof gw?CY(n,e):t}function TY(n,e){return n instanceof vw?function(r){return D3(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class pw extends Z2{}class mw extends Z2{constructor(e){super(),this.elements=e}}function MY(n,e){const t=DY(e);for(const r of n.elements)t.some(i=>Sc(i,r))||t.push(r);return{arrayValue:{values:t}}}class gw extends Z2{constructor(e){super(),this.elements=e}}function CY(n,e){let t=DY(e);for(const r of n.elements)t=t.filter(i=>!Sc(i,r));return{arrayValue:{values:t}}}class vw extends Z2{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function yz(n){return si(n.integerValue||n.doubleValue)}function DY(n){return MB(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NY{constructor(e,t){this.field=e,this.transform=t}}function fme(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof mw&&i instanceof mw||r instanceof gw&&i instanceof gw?cb(r.elements,i.elements,Sc):r instanceof vw&&i instanceof vw?Sc(r.Ae,i.Ae):r instanceof pw&&i instanceof pw}(n.transform,e.transform)}class pme{constructor(e,t){this.version=e,this.transformResults=t}}class El{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new El}static exists(e){return new El(void 0,e)}static updateTime(e){return new El(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xM(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class J2{}function RY(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new RB(n.key,El.none()):new LS(n.key,n.data,El.none());{const t=n.data,r=Wa.empty();let i=new Ii(bs.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new jp(n.key,r,new ko(i.toArray()),El.none())}}function mme(n,e,t){n instanceof LS?function(i,s,a){const o=i.value.clone(),l=bz(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(n,e,t):n instanceof jp?function(i,s,a){if(!xM(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=bz(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(IY(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function P1(n,e,t,r){return n instanceof LS?function(s,a,o,l){if(!xM(s.precondition,a))return o;const u=s.value.clone(),c=_z(s.fieldTransforms,l,a);return u.setAll(c),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof jp?function(s,a,o,l){if(!xM(s.precondition,a))return o;const u=_z(s.fieldTransforms,l,a),c=a.data;return c.setAll(IY(s)),c.setAll(u),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(s,a,o){return xM(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(n,e,t)}function gme(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=TY(r.transform,i||null);s!=null&&(t===null&&(t=Wa.empty()),t.set(r.field,s))}return t||null}function xz(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&cb(r,i,(s,a)=>fme(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class LS extends J2{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class jp extends J2{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function IY(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function bz(n,e,t){const r=new Map;$n(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,o=e.data.field(s.field);r.set(s.field,dme(a,o,t[i]))}return r}function _z(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,hme(s,a,e))}return r}class RB extends J2{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class vme extends J2{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yme{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&mme(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=P1(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=P1(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=EY();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=t.has(i.key)?null:o;const l=RY(a,o);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Gt.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),xn())}isEqual(e){return this.batchId===e.batchId&&cb(this.mutations,e.mutations,(t,r)=>xz(t,r))&&cb(this.baseMutations,e.baseMutations,(t,r)=>xz(t,r))}}class IB{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){$n(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=function(){return ome}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new IB(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xme{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bme{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pi,Nn;function _me(n){switch(n){case He.OK:return Lt(64938);case He.CANCELLED:case He.UNKNOWN:case He.DEADLINE_EXCEEDED:case He.RESOURCE_EXHAUSTED:case He.INTERNAL:case He.UNAVAILABLE:case He.UNAUTHENTICATED:return!1;case He.INVALID_ARGUMENT:case He.NOT_FOUND:case He.ALREADY_EXISTS:case He.PERMISSION_DENIED:case He.FAILED_PRECONDITION:case He.ABORTED:case He.OUT_OF_RANGE:case He.UNIMPLEMENTED:case He.DATA_LOSS:return!0;default:return Lt(15467,{code:n})}}function PY(n){if(n===void 0)return ud("GRPC error has no .code"),He.UNKNOWN;switch(n){case pi.OK:return He.OK;case pi.CANCELLED:return He.CANCELLED;case pi.UNKNOWN:return He.UNKNOWN;case pi.DEADLINE_EXCEEDED:return He.DEADLINE_EXCEEDED;case pi.RESOURCE_EXHAUSTED:return He.RESOURCE_EXHAUSTED;case pi.INTERNAL:return He.INTERNAL;case pi.UNAVAILABLE:return He.UNAVAILABLE;case pi.UNAUTHENTICATED:return He.UNAUTHENTICATED;case pi.INVALID_ARGUMENT:return He.INVALID_ARGUMENT;case pi.NOT_FOUND:return He.NOT_FOUND;case pi.ALREADY_EXISTS:return He.ALREADY_EXISTS;case pi.PERMISSION_DENIED:return He.PERMISSION_DENIED;case pi.FAILED_PRECONDITION:return He.FAILED_PRECONDITION;case pi.ABORTED:return He.ABORTED;case pi.OUT_OF_RANGE:return He.OUT_OF_RANGE;case pi.UNIMPLEMENTED:return He.UNIMPLEMENTED;case pi.DATA_LOSS:return He.DATA_LOSS;default:return Lt(39323,{code:n})}}(Nn=pi||(pi={}))[Nn.OK=0]="OK",Nn[Nn.CANCELLED=1]="CANCELLED",Nn[Nn.UNKNOWN=2]="UNKNOWN",Nn[Nn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Nn[Nn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Nn[Nn.NOT_FOUND=5]="NOT_FOUND",Nn[Nn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Nn[Nn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Nn[Nn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Nn[Nn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Nn[Nn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Nn[Nn.ABORTED=10]="ABORTED",Nn[Nn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Nn[Nn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Nn[Nn.INTERNAL=13]="INTERNAL",Nn[Nn.UNAVAILABLE=14]="UNAVAILABLE",Nn[Nn.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wme(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eme=new mp([4294967295,4294967295],0);function wz(n){const e=wme().encode(n),t=new qK;return t.update(e),new Uint8Array(t.digest())}function Ez(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new mp([t,r],0),new mp([i,s],0)]}class PB{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new $_(`Invalid padding: ${t}`);if(r<0)throw new $_(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new $_(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new $_(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=mp.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(mp.fromNumber(r)));return i.compare(Eme)===1&&(i=new mp([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=wz(e),[r,i]=Ez(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);if(!this.we(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new PB(s,i,t);return r.forEach(o=>a.insert(o)),a}insert(e){if(this.ge===0)return;const t=wz(e),[r,i]=Ez(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(r,i,s);this.Se(a)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class $_ extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eN{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,OS.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new eN(Gt.min(),i,new zr(yn),cd(),xn())}}class OS{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new OS(r,t,xn(),xn(),xn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bM{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}}class FY{constructor(e,t){this.targetId=e,this.Ce=t}}class LY{constructor(e,t,r=Ds.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Sz{constructor(){this.ve=0,this.Fe=Az(),this.Me=Ds.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=xn(),t=xn(),r=xn();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Lt(38017,{changeType:s})}}),new OS(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=Az()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,$n(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Sme{constructor(e){this.Ge=e,this.ze=new Map,this.je=cd(),this.Je=XA(),this.He=XA(),this.Ye=new zr(yn)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Lt(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((r,i)=>{this.rt(i)&&t(i)})}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(R3(s))if(r===0){const a=new Ct(s.path);this.et(t,a,Xs.newNoDocument(a,Gt.min()))}else $n(r===1,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){const o=this.ut(e),l=o?this.ct(o,e,a):1;if(l!==0){this.it(t);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,u)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let a,o;try{a=Tp(r).toUint8Array()}catch(l){if(l instanceof iY)return ub("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new PB(a,i,s)}catch(l){return ub(l instanceof $_?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const a=this.Ge.ht(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.et(t,s,null),i++)}),i}Tt(e){const t=new Map;this.ze.forEach((s,a)=>{const o=this.ot(a);if(o){if(s.current&&R3(o.target)){const l=new Ct(o.target.path);this.It(l).has(a)||this.Et(a,l)||this.et(a,l,Xs.newNoDocument(l,e))}s.Be&&(t.set(a,s.ke()),s.qe())}});let r=xn();this.He.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(r=r.add(s))}),this.je.forEach((s,a)=>a.setReadTime(e));const i=new eN(e,t,this.Ye,this.je,r);return this.je=cd(),this.Je=XA(),this.He=XA(),this.Ye=new zr(yn),i}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Sz,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ii(yn),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ii(yn),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||dt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Sz),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function XA(){return new zr(Ct.comparator)}function Az(){return new zr(Ct.comparator)}const Ame={asc:"ASCENDING",desc:"DESCENDING"},Tme={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Mme={and:"AND",or:"OR"};class Cme{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function P3(n,e){return n.useProto3Json||W2(e)?e:{value:e}}function QC(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function OY(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Dme(n,e){return QC(n,e.toTimestamp())}function vc(n){return $n(!!n,49232),Gt.fromTimestamp(function(t){const r=Ap(t);return new Er(r.seconds,r.nanos)}(n))}function FB(n,e){return F3(n,e).canonicalString()}function F3(n,e){const t=function(i){return new yr(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function kY(n){const e=yr.fromString(n);return $n($Y(e),10190,{key:e.toString()}),e}function L3(n,e){return FB(n.databaseId,e.path)}function QR(n,e){const t=kY(e);if(t.get(1)!==n.databaseId.projectId)throw new ut(He.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ut(He.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ct(UY(t))}function BY(n,e){return FB(n.databaseId,e)}function Nme(n){const e=kY(n);return e.length===4?yr.emptyPath():UY(e)}function O3(n){return new yr(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function UY(n){return $n(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Tz(n,e,t){return{name:L3(n,e),fields:t.value.mapValue.fields}}function Rme(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Lt(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,c){return u.useProto3Json?($n(c===void 0||typeof c=="string",58123),Ds.fromBase64String(c||"")):($n(c===void 0||c instanceof Buffer||c instanceof Uint8Array,16193),Ds.fromUint8Array(c||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(u){const c=u.code===void 0?He.UNKNOWN:PY(u.code);return new ut(c,u.message||"")}(a);t=new LY(r,i,s,o||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=QR(n,r.document.name),s=vc(r.document.updateTime),a=r.document.createTime?vc(r.document.createTime):Gt.min(),o=new Wa({mapValue:{fields:r.document.fields}}),l=Xs.newFoundDocument(i,s,a,o),u=r.targetIds||[],c=r.removedTargetIds||[];t=new bM(u,c,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=QR(n,r.document),s=r.readTime?vc(r.readTime):Gt.min(),a=Xs.newNoDocument(i,s),o=r.removedTargetIds||[];t=new bM([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=QR(n,r.document),s=r.removedTargetIds||[];t=new bM([],s,i,null)}else{if(!("filter"in e))return Lt(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new bme(i,s),o=r.targetId;t=new FY(o,a)}}return t}function Ime(n,e){let t;if(e instanceof LS)t={update:Tz(n,e.key,e.value)};else if(e instanceof RB)t={delete:L3(n,e.key)};else if(e instanceof jp)t={update:Tz(n,e.key,e.data),updateMask:zme(e.fieldMask)};else{if(!(e instanceof vme))return Lt(16599,{Vt:e.type});t={verify:L3(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){const o=a.transform;if(o instanceof pw)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof mw)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof gw)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof vw)return{fieldPath:a.field.canonicalString(),increment:o.Ae};throw Lt(20930,{transform:a.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:Dme(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Lt(27497)}(n,e.precondition)),t}function Pme(n,e){return n&&n.length>0?($n(e!==void 0,14353),n.map(t=>function(i,s){let a=i.updateTime?vc(i.updateTime):vc(s);return a.isEqual(Gt.min())&&(a=vc(s)),new pme(a,i.transformResults||[])}(t,e))):[]}function Fme(n,e){return{documents:[BY(n,e.path)]}}function Lme(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=BY(n,i);const s=function(u){if(u.length!==0)return zY(pu.create(u,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const a=function(u){if(u.length!==0)return u.map(c=>function(d){return{field:D0(d.field),direction:Bme(d.dir)}}(c))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=P3(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:t,parent:i}}function Ome(n){let e=Nme(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){$n(r===1,65062);const c=t.from[0];c.allDescendants?i=c.collectionId:e=e.child(c.collectionId)}let s=[];t.where&&(s=function(h){const d=VY(h);return d instanceof pu&&pY(d)?d.getFilters():[d]}(t.where));let a=[];t.orderBy&&(a=function(h){return h.map(d=>function(p){return new fw(N0(p.field),function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(d))}(t.orderBy));let o=null;t.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,W2(d)?null:d}(t.limit));let l=null;t.startAt&&(l=function(h){const d=!!h.before,f=h.values||[];return new KC(f,d)}(t.startAt));let u=null;return t.endAt&&(u=function(h){const d=!h.before,f=h.values||[];return new KC(f,d)}(t.endAt)),nme(e,i,a,s,o,"F",l,u)}function kme(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Lt(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function VY(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=N0(t.unaryFilter.field);return yi.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=N0(t.unaryFilter.field);return yi.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=N0(t.unaryFilter.field);return yi.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=N0(t.unaryFilter.field);return yi.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Lt(61313);default:return Lt(60726)}}(n):n.fieldFilter!==void 0?function(t){return yi.create(N0(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Lt(58110);default:return Lt(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return pu.create(t.compositeFilter.filters.map(r=>VY(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Lt(1026)}}(t.compositeFilter.op))}(n):Lt(30097,{filter:n})}function Bme(n){return Ame[n]}function Ume(n){return Tme[n]}function Vme(n){return Mme[n]}function D0(n){return{fieldPath:n.canonicalString()}}function N0(n){return bs.fromServerFormat(n.fieldPath)}function zY(n){return n instanceof yi?function(t){if(t.op==="=="){if(fz(t.value))return{unaryFilter:{field:D0(t.field),op:"IS_NAN"}};if(dz(t.value))return{unaryFilter:{field:D0(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(fz(t.value))return{unaryFilter:{field:D0(t.field),op:"IS_NOT_NAN"}};if(dz(t.value))return{unaryFilter:{field:D0(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:D0(t.field),op:Ume(t.op),value:t.value}}}(n):n instanceof pu?function(t){const r=t.getFilters().map(i=>zY(i));return r.length===1?r[0]:{compositeFilter:{op:Vme(t.op),filters:r}}}(n):Lt(54877,{filter:n})}function zme(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function $Y(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep{constructor(e,t,r,i,s=Gt.min(),a=Gt.min(),o=Ds.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new ep(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ep(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ep(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ep(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $me{constructor(e){this.yt=e}}function Hme(n){const e=Ome({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?YC(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gme{constructor(){this.Cn=new jme}addToCollectionParentIndex(e,t){return this.Cn.add(t),je.resolve()}getCollectionParents(e,t){return je.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return je.resolve()}deleteFieldIndex(e,t){return je.resolve()}deleteAllFieldIndexes(e){return je.resolve()}createTargetIndexes(e,t){return je.resolve()}getDocumentsMatchingTarget(e,t){return je.resolve(null)}getIndexType(e,t){return je.resolve(0)}getFieldIndexes(e,t){return je.resolve([])}getNextCollectionGroupToUpdate(e){return je.resolve(null)}getMinOffset(e,t){return je.resolve(Sp.min())}getMinOffsetFromCollectionGroup(e,t){return je.resolve(Sp.min())}updateCollectionGroup(e,t,r){return je.resolve()}updateIndexEntries(e,t){return je.resolve()}}class jme{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ii(yr.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ii(yr.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mz={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},HY=41943040;class Ga{static withCacheSize(e){return new Ga(e,Ga.DEFAULT_COLLECTION_PERCENTILE,Ga.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ga.DEFAULT_COLLECTION_PERCENTILE=10,Ga.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ga.DEFAULT=new Ga(HY,Ga.DEFAULT_COLLECTION_PERCENTILE,Ga.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ga.DISABLED=new Ga(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new fb(0)}static cr(){return new fb(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cz="LruGarbageCollector",qme=1048576;function Dz([n,e],[t,r]){const i=yn(n,t);return i===0?yn(e,r):i}class Wme{constructor(e){this.Ir=e,this.buffer=new Ii(Dz),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Dz(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Xme{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){dt(Cz,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Vb(t)?dt(Cz,"Ignoring IndexedDB error during garbage collection: ",t):await Ub(t)}await this.Vr(3e5)})}}class Kme{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return je.resolve(q2.ce);const r=new Wme(t);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(dt("LruGarbageCollector","Garbage collection skipped; disabled"),je.resolve(Mz)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(dt("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Mz):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,a,o,l,u;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(dt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,a=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,o=Date.now(),this.removeTargets(e,r,t))).next(h=>(s=h,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(u=Date.now(),M0()<=vn.DEBUG&&dt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-c}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(l-o)+`ms
	Removed ${h} documents in `+(u-l)+`ms
Total Duration: ${u-c}ms`),je.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}}function Yme(n,e){return new Kme(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qme{constructor(){this.changes=new kv(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Xs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?je.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zme{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jme{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&P1(r.mutation,i,ko.empty(),Er.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,xn()).next(()=>r))}getLocalViewOfDocuments(e,t,r=xn()){const i=$m();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=z_();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const r=$m();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,xn()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{t.set(a,o)})})}computeViews(e,t,r,i){let s=cd();const a=I1(),o=function(){return I1()}();return t.forEach((l,u)=>{const c=r.get(u.key);i.has(u.key)&&(c===void 0||c.mutation instanceof jp)?s=s.insert(u.key,u):c!==void 0?(a.set(u.key,c.mutation.getFieldMask()),P1(c.mutation,u,c.mutation.getFieldMask(),Er.now())):a.set(u.key,ko.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,c)=>a.set(u,c)),t.forEach((u,c)=>o.set(u,new Zme(c,a.get(u)??null))),o))}recalculateAndSaveOverlays(e,t){const r=I1();let i=new zr((a,o)=>a-o),s=xn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const o of a)o.keys().forEach(l=>{const u=t.get(l);if(u===null)return;let c=r.get(l)||ko.empty();c=o.applyToLocalView(u,c),r.set(l,c);const h=(i.get(o.batchId)||xn()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,c=l.value,h=EY();c.forEach(d=>{if(!s.has(d)){const f=RY(t.get(d),r.get(d));f!==null&&h.set(d,f),s=s.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,h))}return je.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return Ct.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):yY(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):je.resolve($m());let o=uw,l=s;return a.next(u=>je.forEach(u,(c,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(c)?je.resolve():this.remoteDocumentCache.getEntry(e,c).next(d=>{l=l.insert(c,d)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,xn())).next(c=>({batchId:o,changes:wY(c)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ct(t)).next(r=>{let i=z_();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let a=z_();return this.indexManager.getCollectionParents(e,s).next(o=>je.forEach(o,l=>{const u=function(h,d){return new zb(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(c=>{c.forEach((h,d)=>{a=a.insert(h,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((l,u)=>{const c=u.getKey();a.get(c)===null&&(a=a.insert(c,Xs.newInvalidDocument(c)))});let o=z_();return a.forEach((l,u)=>{const c=s.get(l);c!==void 0&&P1(c.mutation,u,ko.empty(),Er.now()),Q2(t,u)&&(o=o.insert(l,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ege{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return je.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:vc(i.createTime)}}(t)),je.resolve()}getNamedQuery(e,t){return je.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(i){return{name:i.name,query:Hme(i.bundledQuery),readTime:vc(i.readTime)}}(t)),je.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tge{constructor(){this.overlays=new zr(Ct.comparator),this.qr=new Map}getOverlay(e,t){return je.resolve(this.overlays.get(t))}getOverlays(e,t){const r=$m();return je.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.St(e,t,s)}),je.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),je.resolve()}getOverlaysForCollection(e,t,r){const i=$m(),s=t.length+1,a=new Ct(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return je.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new zr((u,c)=>u-c);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let c=s.get(u.largestBatchId);c===null&&(c=$m(),s=s.insert(u.largestBatchId,c)),c.set(u.getKey(),u)}}const o=$m(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,c)=>o.set(u,c)),!(o.size()>=i)););return je.resolve(o)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new xme(t,r));let s=this.qr.get(t);s===void 0&&(s=xn(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nge{constructor(){this.sessionToken=Ds.EMPTY_BYTE_STRING}getSessionToken(e){return je.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,je.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LB{constructor(){this.Qr=new Ii(ns.$r),this.Ur=new Ii(ns.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new ns(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Gr(new ns(e,t))}zr(e,t){e.forEach(r=>this.removeReference(r,t))}jr(e){const t=new Ct(new yr([])),r=new ns(t,e),i=new ns(t,e+1),s=[];return this.Ur.forEachInRange([r,i],a=>{this.Gr(a),s.push(a.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ct(new yr([])),r=new ns(t,e),i=new ns(t,e+1);let s=xn();return this.Ur.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const t=new ns(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class ns{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ct.comparator(e.key,t.key)||yn(e.Yr,t.Yr)}static Kr(e,t){return yn(e.Yr,t.Yr)||Ct.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rge{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ii(ns.$r)}checkEmpty(e){return je.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new yme(s,t,r,i);this.mutationQueue.push(a);for(const o of i)this.Zr=this.Zr.add(new ns(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return je.resolve(a)}lookupMutationBatch(e,t){return je.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ei(r),s=i<0?0:i;return je.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return je.resolve(this.mutationQueue.length===0?AB:this.tr-1)}getAllMutationBatches(e){return je.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new ns(t,0),i=new ns(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],a=>{const o=this.Xr(a.Yr);s.push(o)}),je.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ii(yn);return t.forEach(i=>{const s=new ns(i,0),a=new ns(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],o=>{r=r.add(o.Yr)})}),je.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;Ct.isDocumentKey(s)||(s=s.child(""));const a=new ns(new Ct(s),0);let o=new Ii(yn);return this.Zr.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(o=o.add(l.Yr)),!0)},a),je.resolve(this.ti(o))}ti(e){const t=[];return e.forEach(r=>{const i=this.Xr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){$n(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return je.forEach(t.mutations,i=>{const s=new ns(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,t){const r=new ns(t,0),i=this.Zr.firstAfterOrEqual(r);return je.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,je.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ige{constructor(e){this.ri=e,this.docs=function(){return new zr(Ct.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return je.resolve(r?r.document.mutableCopy():Xs.newInvalidDocument(t))}getEntries(e,t){let r=cd();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Xs.newInvalidDocument(i))}),je.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=cd();const a=t.path,o=new Ct(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:c}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||Fpe(Ppe(c),r)<=0||(i.has(c.key)||Q2(t,c))&&(s=s.insert(c.key,c.mutableCopy()))}return je.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Lt(9500)}ii(e,t){return je.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new sge(this)}getSize(e){return je.resolve(this.size)}}class sge extends Qme{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),je.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class age{constructor(e){this.persistence=e,this.si=new kv(t=>CB(t),DB),this.lastRemoteSnapshotVersion=Gt.min(),this.highestTargetId=0,this.oi=0,this._i=new LB,this.targetCount=0,this.ai=fb.ur()}forEachTarget(e,t){return this.si.forEach((r,i)=>t(i)),je.resolve()}getLastRemoteSnapshotVersion(e){return je.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return je.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),je.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),je.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new fb(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,je.resolve()}updateTargetData(e,t){return this.Pr(t),je.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,je.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.si.forEach((a,o)=>{o.sequenceNumber<=t&&r.get(o.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),je.waitFor(s).next(()=>i)}getTargetCount(e){return je.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return je.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),je.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),je.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),je.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return je.resolve(r)}containsKey(e,t){return je.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GY{constructor(e,t){this.ui={},this.overlays={},this.ci=new q2(0),this.li=!1,this.li=!0,this.hi=new nge,this.referenceDelegate=e(this),this.Pi=new age(this),this.indexManager=new Gme,this.remoteDocumentCache=function(i){return new ige(i)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new $me(t),this.Ii=new ege(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new tge,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new rge(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){dt("MemoryPersistence","Starting transaction:",e);const i=new oge(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,t){return je.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,t)))}}class oge extends Ope{constructor(e){super(),this.currentSequenceNumber=e}}class OB{constructor(e){this.persistence=e,this.Ri=new LB,this.Vi=null}static mi(e){return new OB(e)}get fi(){if(this.Vi)return this.Vi;throw Lt(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),je.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),je.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),je.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(i=>this.fi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return je.forEach(this.fi,r=>{const i=Ct.fromPath(r);return this.gi(e,i).next(s=>{s||t.removeEntry(i,Gt.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return je.or([()=>je.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class ZC{constructor(e,t){this.persistence=e,this.pi=new kv(r=>Upe(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=Yme(this,t)}static mi(e,t){return new ZC(e,t)}Ei(){}di(e){return je.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}wr(e){let t=0;return this.pr(e,r=>{t++}).next(()=>t)}pr(e,t){return je.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?je.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,a=>this.br(e,a,t).next(o=>{o||(r++,s.removeEntry(a,Gt.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),je.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),je.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),je.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),je.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=vM(e.data.value)),t}br(e,t,r){return je.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return je.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kB{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=xn(),i=xn();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new kB(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lge{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uge{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return rfe()?8:kpe(ta())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ys(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ws(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new lge;return this.Ss(e,t,a).next(o=>{if(s.result=o,this.Vs)return this.bs(e,t,a,o.size)})}).next(()=>s.result)}bs(e,t,r,i){return r.documentReadCount<this.fs?(M0()<=vn.DEBUG&&dt("QueryEngine","SDK will not create cache indexes for query:",C0(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),je.resolve()):(M0()<=vn.DEBUG&&dt("QueryEngine","Query:",C0(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(M0()<=vn.DEBUG&&dt("QueryEngine","The SDK decides to create cache indexes for query:",C0(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,gc(t))):je.resolve())}ys(e,t){if(vz(t))return je.resolve(null);let r=gc(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=YC(t,null,"F"),r=gc(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=xn(...s);return this.ps.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.Ds(t,o);return this.Cs(t,u,a,l.readTime)?this.ys(e,YC(t,null,"F")):this.vs(e,u,t,l)}))})))}ws(e,t,r,i){return vz(t)||i.isEqual(Gt.min())?je.resolve(null):this.ps.getDocuments(e,r).next(s=>{const a=this.Ds(t,s);return this.Cs(t,a,r,i)?je.resolve(null):(M0()<=vn.DEBUG&&dt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),C0(t)),this.vs(e,a,t,Ipe(i,uw)).next(o=>o))})}Ds(e,t){let r=new Ii(bY(e));return t.forEach((i,s)=>{Q2(e,s)&&(r=r.add(s))}),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return M0()<=vn.DEBUG&&dt("QueryEngine","Using full collection scan to execute query:",C0(t)),this.ps.getDocumentsMatchingQuery(e,t,Sp.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BB="LocalStore",cge=3e8;class hge{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new zr(yn),this.xs=new kv(s=>CB(s),DB),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Jme(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function dge(n,e,t,r){return new hge(n,e,t,r)}async function jY(n,e){const t=Yt(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],o=[];let l=xn();for(const u of i){a.push(u.batchId);for(const c of u.mutations)l=l.add(c.key)}for(const u of s){o.push(u.batchId);for(const c of u.mutations)l=l.add(c.key)}return t.localDocuments.getDocuments(r,l).next(u=>({Ls:u,removedBatchIds:a,addedBatchIds:o}))})})}function fge(n,e){const t=Yt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return function(o,l,u,c){const h=u.batch,d=h.keys();let f=je.resolve();return d.forEach(p=>{f=f.next(()=>c.getEntry(l,p)).next(m=>{const y=u.docVersions.get(p);$n(y!==null,48541),m.version.compareTo(y)<0&&(h.applyToRemoteDocument(m,u),m.isValidDocument()&&(m.setReadTime(u.commitVersion),c.addEntry(m)))})}),f.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let l=xn();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function qY(n){const e=Yt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function pge(n,e){const t=Yt(n),r=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const o=[];e.targetChanges.forEach((c,h)=>{const d=i.get(h);if(!d)return;o.push(t.Pi.removeMatchingKeys(s,c.removedDocuments,h).next(()=>t.Pi.addMatchingKeys(s,c.addedDocuments,h)));let f=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?f=f.withResumeToken(Ds.EMPTY_BYTE_STRING,Gt.min()).withLastLimboFreeSnapshotVersion(Gt.min()):c.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(c.resumeToken,r)),i=i.insert(h,f),function(m,y,v){return m.resumeToken.approximateByteSize()===0||y.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=cge?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(d,f,c)&&o.push(t.Pi.updateTargetData(s,f))});let l=cd(),u=xn();if(e.documentUpdates.forEach(c=>{e.resolvedLimboDocuments.has(c)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,c))}),o.push(mge(s,a,e.documentUpdates).next(c=>{l=c.ks,u=c.qs})),!r.isEqual(Gt.min())){const c=t.Pi.getLastRemoteSnapshotVersion(s).next(h=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));o.push(c)}return je.waitFor(o).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(t.Ms=i,s))}function mge(n,e,t){let r=xn(),i=xn();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=cd();return t.forEach((o,l)=>{const u=s.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Gt.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):dt(BB,"Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)}),{ks:a,qs:i}})}function gge(n,e){const t=Yt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=AB),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function vge(n,e){const t=Yt(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Pi.getTargetData(r,e).next(s=>s?(i=s,je.resolve(i)):t.Pi.allocateTargetId(r).next(a=>(i=new ep(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r})}async function k3(n,e,t){const r=Yt(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Vb(a))throw a;dt(BB,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function Nz(n,e,t){const r=Yt(n);let i=Gt.min(),s=xn();return r.persistence.runTransaction("Execute query","readwrite",a=>function(l,u,c){const h=Yt(l),d=h.xs.get(c);return d!==void 0?je.resolve(h.Ms.get(d)):h.Pi.getTargetData(u,c)}(r,a,gc(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>r.Fs.getDocumentsMatchingQuery(a,e,t?i:Gt.min(),t?s:xn())).next(o=>(yge(r,ime(e),o),{documents:o,Qs:s})))}function yge(n,e,t){let r=n.Os.get(e)||Gt.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.Os.set(e,r)}class Rz{constructor(){this.activeTargetIds=cme()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class xge{constructor(){this.Mo=new Rz,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Rz,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bge{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iz="ConnectivityMonitor";class Pz{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){dt(Iz,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){dt(Iz,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let KA=null;function B3(){return KA===null?KA=function(){return 268435456+Math.round(2147483648*Math.random())}():KA++,"0x"+KA.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR="RestConnection",_ge={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class wge{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===WC?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){const a=B3(),o=this.zo(e,t.toUriEncodedString());dt(ZR,`Sending RPC '${e}' ${a}:`,o,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:u}=new URL(o),c=Lv(u);return this.Jo(e,o,l,r,c).then(h=>(dt(ZR,`Received RPC '${e}' ${a}: `,h),h),h=>{throw ub(ZR,`RPC '${e}' ${a} failed with error: `,h,"url: ",o,"request:",r),h})}Ho(e,t,r,i,s,a){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Bb}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,t){const r=_ge[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ege{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ls="WebChannelConnection";class Sge extends wge{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){const a=B3();return new Promise((o,l)=>{const u=new WK;u.setWithCredentials(!0),u.listenOnce(XK.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case gM.NO_ERROR:const h=u.getResponseJson();dt(Ls,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(h)),o(h);break;case gM.TIMEOUT:dt(Ls,`RPC '${e}' ${a} timed out`),l(new ut(He.DEADLINE_EXCEEDED,"Request time out"));break;case gM.HTTP_ERROR:const d=u.getStatus();if(dt(Ls,`RPC '${e}' ${a} failed with status:`,d,"response text:",u.getResponseText()),d>0){let f=u.getResponseJson();Array.isArray(f)&&(f=f[0]);const p=f==null?void 0:f.error;if(p&&p.status&&p.message){const m=function(v){const b=v.toLowerCase().replace(/_/g,"-");return Object.values(He).indexOf(b)>=0?b:He.UNKNOWN}(p.status);l(new ut(m,p.message))}else l(new ut(He.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new ut(He.UNAVAILABLE,"Connection failed."));break;default:Lt(9055,{l_:e,streamId:a,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{dt(Ls,`RPC '${e}' ${a} completed.`)}});const c=JSON.stringify(i);dt(Ls,`RPC '${e}' ${a} sending request:`,i),u.send(t,"POST",c,r,15)})}T_(e,t,r){const i=B3(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=QK(),o=YK(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const c=s.join("");dt(Ls,`Creating RPC '${e}' stream ${i}: ${c}`,l);const h=a.createWebChannel(c,l);this.I_(h);let d=!1,f=!1;const p=new Ege({Yo:y=>{f?dt(Ls,`Not sending because RPC '${e}' stream ${i} is closed:`,y):(d||(dt(Ls,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),dt(Ls,`RPC '${e}' stream ${i} sending:`,y),h.send(y))},Zo:()=>h.close()}),m=(y,v,b)=>{y.listen(v,x=>{try{b(x)}catch(w){setTimeout(()=>{throw w},0)}})};return m(h,V_.EventType.OPEN,()=>{f||(dt(Ls,`RPC '${e}' stream ${i} transport opened.`),p.o_())}),m(h,V_.EventType.CLOSE,()=>{f||(f=!0,dt(Ls,`RPC '${e}' stream ${i} transport closed`),p.a_(),this.E_(h))}),m(h,V_.EventType.ERROR,y=>{f||(f=!0,ub(Ls,`RPC '${e}' stream ${i} transport errored. Name:`,y.name,"Message:",y.message),p.a_(new ut(He.UNAVAILABLE,"The operation could not be completed")))}),m(h,V_.EventType.MESSAGE,y=>{var v;if(!f){const b=y.data[0];$n(!!b,16349);const x=b,w=(x==null?void 0:x.error)||((v=x[0])==null?void 0:v.error);if(w){dt(Ls,`RPC '${e}' stream ${i} received error:`,w);const _=w.status;let E=function(S){const M=pi[S];if(M!==void 0)return PY(M)}(_),A=w.message;E===void 0&&(E=He.INTERNAL,A="Unknown error status: "+_+" with message "+w.message),f=!0,p.a_(new ut(E,A)),h.close()}else dt(Ls,`RPC '${e}' stream ${i} received:`,b),p.u_(b)}}),m(o,KK.STAT_EVENT,y=>{y.stat===T3.PROXY?dt(Ls,`RPC '${e}' stream ${i} detected buffering proxy`):y.stat===T3.NOPROXY&&dt(Ls,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.__()},0),p}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function JR(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tN(n){return new Cme(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WY{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&dt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fz="PersistentStream";class XY{constructor(e,t,r,i,s,a,o,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new WY(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===He.RESOURCE_EXHAUSTED?(ud(t.toString()),ud("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===He.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===t&&this.G_(r,i)},r=>{e(()=>{const i=new ut(He.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return dt(Fz,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(dt(Fz,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Age extends XY{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=Rme(this.serializer,e),r=function(s){if(!("targetChange"in s))return Gt.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Gt.min():a.readTime?vc(a.readTime):Gt.min()}(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=O3(this.serializer),t.addTarget=function(s,a){let o;const l=a.target;if(o=R3(l)?{documents:Fme(s,l)}:{query:Lme(s,l).ft},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=OY(s,a.resumeToken);const u=P3(s,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(Gt.min())>0){o.readTime=QC(s,a.snapshotVersion.toTimestamp());const u=P3(s,a.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const r=kme(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=O3(this.serializer),t.removeTarget=e,this.q_(t)}}class Tge extends XY{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return $n(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,$n(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){$n(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=Pme(e.writeResults,e.commitTime),r=vc(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=O3(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Ime(this.serializer,r))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mge{}class Cge extends Mge{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new ut(He.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Go(e,F3(t,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===He.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ut(He.UNKNOWN,s.toString())})}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Ho(e,F3(t,r),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===He.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ut(He.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Dge{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ud(t),this.aa=!1):dt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sv="RemoteStore";class Nge{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(a=>{r.enqueueAndForget(async()=>{Bv(this)&&(dt(Sv,"Restarting streams for network reachability change."),await async function(l){const u=Yt(l);u.Ea.add(4),await kS(u),u.Ra.set("Unknown"),u.Ea.delete(4),await nN(u)}(this))})}),this.Ra=new Dge(r,i)}}async function nN(n){if(Bv(n))for(const e of n.da)await e(!0)}async function kS(n){for(const e of n.da)await e(!1)}function KY(n,e){const t=Yt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),$B(t)?zB(t):$b(t).O_()&&VB(t,e))}function UB(n,e){const t=Yt(n),r=$b(t);t.Ia.delete(e),r.O_()&&YY(t,e),t.Ia.size===0&&(r.O_()?r.L_():Bv(t)&&t.Ra.set("Unknown"))}function VB(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Gt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}$b(n).Y_(e)}function YY(n,e){n.Va.Ue(e),$b(n).Z_(e)}function zB(n){n.Va=new Sme({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),$b(n).start(),n.Ra.ua()}function $B(n){return Bv(n)&&!$b(n).x_()&&n.Ia.size>0}function Bv(n){return Yt(n).Ea.size===0}function QY(n){n.Va=void 0}async function Rge(n){n.Ra.set("Online")}async function Ige(n){n.Ia.forEach((e,t)=>{VB(n,e)})}async function Pge(n,e){QY(n),$B(n)?(n.Ra.ha(e),zB(n)):n.Ra.set("Unknown")}async function Fge(n,e,t){if(n.Ra.set("Online"),e instanceof LY&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.Ia.delete(o),i.Va.removeTarget(o))}(n,e)}catch(r){dt(Sv,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await JC(n,r)}else if(e instanceof bM?n.Va.Ze(e):e instanceof FY?n.Va.st(e):n.Va.tt(e),!t.isEqual(Gt.min()))try{const r=await qY(n.localStore);t.compareTo(r)>=0&&await function(s,a){const o=s.Va.Tt(a);return o.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const c=s.Ia.get(u);c&&s.Ia.set(u,c.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,u)=>{const c=s.Ia.get(l);if(!c)return;s.Ia.set(l,c.withResumeToken(Ds.EMPTY_BYTE_STRING,c.snapshotVersion)),YY(s,l);const h=new ep(c.target,l,u,c.sequenceNumber);VB(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(n,t)}catch(r){dt(Sv,"Failed to raise snapshot:",r),await JC(n,r)}}async function JC(n,e,t){if(!Vb(e))throw e;n.Ea.add(1),await kS(n),n.Ra.set("Offline"),t||(t=()=>qY(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{dt(Sv,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await nN(n)})}function ZY(n,e){return e().catch(t=>JC(n,t,e))}async function rN(n){const e=Yt(n),t=Cp(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:AB;for(;Lge(e);)try{const i=await gge(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,Oge(e,i)}catch(i){await JC(e,i)}JY(e)&&eQ(e)}function Lge(n){return Bv(n)&&n.Ta.length<10}function Oge(n,e){n.Ta.push(e);const t=Cp(n);t.O_()&&t.X_&&t.ea(e.mutations)}function JY(n){return Bv(n)&&!Cp(n).x_()&&n.Ta.length>0}function eQ(n){Cp(n).start()}async function kge(n){Cp(n).ra()}async function Bge(n){const e=Cp(n);for(const t of n.Ta)e.ea(t.mutations)}async function Uge(n,e,t){const r=n.Ta.shift(),i=IB.from(r,e,t);await ZY(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await rN(n)}async function Vge(n,e){e&&Cp(n).X_&&await async function(r,i){if(function(a){return _me(a)&&a!==He.ABORTED}(i.code)){const s=r.Ta.shift();Cp(r).B_(),await ZY(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await rN(r)}}(n,e),JY(n)&&eQ(n)}async function Lz(n,e){const t=Yt(n);t.asyncQueue.verifyOperationInProgress(),dt(Sv,"RemoteStore received new credentials");const r=Bv(t);t.Ea.add(3),await kS(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await nN(t)}async function zge(n,e){const t=Yt(n);e?(t.Ea.delete(2),await nN(t)):e||(t.Ea.add(2),await kS(t),t.Ra.set("Unknown"))}function $b(n){return n.ma||(n.ma=function(t,r,i){const s=Yt(t);return s.sa(),new Age(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Xo:Rge.bind(null,n),t_:Ige.bind(null,n),r_:Pge.bind(null,n),H_:Fge.bind(null,n)}),n.da.push(async e=>{e?(n.ma.B_(),$B(n)?zB(n):n.Ra.set("Unknown")):(await n.ma.stop(),QY(n))})),n.ma}function Cp(n){return n.fa||(n.fa=function(t,r,i){const s=Yt(t);return s.sa(),new Tge(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:kge.bind(null,n),r_:Vge.bind(null,n),ta:Bge.bind(null,n),na:Uge.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await rN(n)):(await n.fa.stop(),n.Ta.length>0&&(dt(Sv,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HB{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new qh,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,o=new HB(e,t,a,i,s);return o.start(r),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ut(He.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function GB(n,e){if(ud("AsyncQueue",`${e}: ${n}`),Vb(n))return new ut(He.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{static emptySet(e){return new xy(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Ct.comparator(t.key,r.key):(t,r)=>Ct.comparator(t.key,r.key),this.keyedMap=z_(),this.sortedSet=new zr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof xy)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new xy;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oz{constructor(){this.ga=new zr(Ct.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Lt(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}}class pb{constructor(e,t,r,i,s,a,o,l,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach(o=>{a.push({type:0,doc:o})}),new pb(e,t,xy.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Y2(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $ge{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Hge{constructor(){this.queries=kz(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=Yt(t),s=i.queries;i.queries=kz(),s.forEach((a,o)=>{for(const l of o.Sa)l.onError(r)})})(this,new ut(He.ABORTED,"Firestore shutting down"))}}function kz(){return new kv(n=>xY(n),Y2)}async function jB(n,e){const t=Yt(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new $ge,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const o=GB(a,`Initialization of query '${C0(e.query)}' failed`);return void e.onError(o)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&WB(t)}async function qB(n,e){const t=Yt(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Gge(n,e){const t=Yt(n);let r=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const o of a.Sa)o.Fa(i)&&(r=!0);a.wa=i}}r&&WB(t)}function jge(n,e,t){const r=Yt(n),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);r.queries.delete(e)}function WB(n){n.Ca.forEach(e=>{e.next()})}var U3,Bz;(Bz=U3||(U3={})).Ma="default",Bz.Cache="cache";class XB{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new pb(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=pb.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==U3.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tQ{constructor(e){this.key=e}}class nQ{constructor(e){this.key=e}}class qge{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=xn(),this.mutatedKeys=xn(),this.eu=bY(e),this.tu=new xy(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new Oz,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((c,h)=>{const d=i.get(c),f=Q2(this.query,h)?h:null,p=!!d&&this.mutatedKeys.has(d.key),m=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let y=!1;d&&f?d.data.isEqual(f.data)?p!==m&&(r.track({type:3,doc:f}),y=!0):this.su(d,f)||(r.track({type:2,doc:f}),y=!0,(l&&this.eu(f,l)>0||u&&this.eu(f,u)<0)&&(o=!0)):!d&&f?(r.track({type:0,doc:f}),y=!0):d&&!f&&(r.track({type:1,doc:d}),y=!0,(l||u)&&(o=!0)),y&&(f?(a=a.add(f),s=m?s.add(c):s.delete(c)):(a=a.delete(c),s=s.delete(c)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const c=this.query.limitType==="F"?a.last():a.first();a=a.delete(c.key),s=s.delete(c.key),r.track({type:1,doc:c})}return{tu:a,iu:r,Cs:o,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((c,h)=>function(f,p){const m=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Lt(20277,{Rt:y})}};return m(f)-m(p)}(c.type,h.type)||this.eu(c.doc,h.doc)),this.ou(r),i=i??!1;const o=t&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,u=l!==this.Za;return this.Za=l,a.length!==0||u?{snapshot:new pb(this.query,e.tu,s,a,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Oz,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=xn(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const t=[];return e.forEach(r=>{this.Xa.has(r)||t.push(new nQ(r))}),this.Xa.forEach(r=>{e.has(r)||t.push(new tQ(r))}),t}cu(e){this.Ya=e.Qs,this.Xa=xn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return pb.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const KB="SyncEngine";class Wge{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Xge{constructor(e){this.key=e,this.hu=!1}}class Kge{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new kv(o=>xY(o),Y2),this.Iu=new Map,this.Eu=new Set,this.du=new zr(Ct.comparator),this.Au=new Map,this.Ru=new LB,this.Vu={},this.mu=new Map,this.fu=fb.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Yge(n,e,t=!0){const r=lQ(n);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await rQ(r,e,t,!0),i}async function Qge(n,e){const t=lQ(n);await rQ(t,e,!0,!1)}async function rQ(n,e,t,r){const i=await vge(n.localStore,gc(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t);let o;return r&&(o=await Zge(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&KY(n.remoteStore,i),o}async function Zge(n,e,t,r,i){n.pu=(h,d,f)=>async function(m,y,v,b){let x=y.view.ru(v);x.Cs&&(x=await Nz(m.localStore,y.query,!1).then(({documents:A})=>y.view.ru(A,x)));const w=b&&b.targetChanges.get(y.targetId),_=b&&b.targetMismatches.get(y.targetId)!=null,E=y.view.applyChanges(x,m.isPrimaryClient,w,_);return Vz(m,y.targetId,E.au),E.snapshot}(n,h,d,f);const s=await Nz(n.localStore,e,!0),a=new qge(e,s.Qs),o=a.ru(s.documents),l=OS.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=a.applyChanges(o,n.isPrimaryClient,l);Vz(n,t,u.au);const c=new Wge(e,t,a);return n.Tu.set(e,c),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),u.snapshot}async function Jge(n,e,t){const r=Yt(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(a=>!Y2(a,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await k3(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&UB(r.remoteStore,i.targetId),V3(r,i.targetId)}).catch(Ub)):(V3(r,i.targetId),await k3(r.localStore,i.targetId,!0))}async function eve(n,e){const t=Yt(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),UB(t.remoteStore,r.targetId))}async function tve(n,e,t){const r=lve(n);try{const i=await function(a,o){const l=Yt(a),u=Er.now(),c=o.reduce((f,p)=>f.add(p.key),xn());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=cd(),m=xn();return l.Ns.getEntries(f,c).next(y=>{p=y,p.forEach((v,b)=>{b.isValidDocument()||(m=m.add(v))})}).next(()=>l.localDocuments.getOverlayedDocuments(f,p)).next(y=>{h=y;const v=[];for(const b of o){const x=gme(b,h.get(b.key).overlayedDocument);x!=null&&v.push(new jp(b.key,x,hY(x.value.mapValue),El.exists(!0)))}return l.mutationQueue.addMutationBatch(f,u,v,o)}).next(y=>{d=y;const v=y.applyToLocalDocumentSet(h,m);return l.documentOverlayCache.saveOverlays(f,y.batchId,v)})}).then(()=>({batchId:d.batchId,changes:wY(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let u=a.Vu[a.currentUser.toKey()];u||(u=new zr(yn)),u=u.insert(o,l),a.Vu[a.currentUser.toKey()]=u}(r,i.batchId,t),await BS(r,i.changes),await rN(r.remoteStore)}catch(i){const s=GB(i,"Failed to persist write");t.reject(s)}}async function iQ(n,e){const t=Yt(n);try{const r=await pge(t.localStore,e);e.targetChanges.forEach((i,s)=>{const a=t.Au.get(s);a&&($n(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?$n(a.hu,14607):i.removedDocuments.size>0&&($n(a.hu,42227),a.hu=!1))}),await BS(t,r,e)}catch(r){await Ub(r)}}function Uz(n,e,t){const r=Yt(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach((s,a)=>{const o=a.view.va(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=Yt(a);l.onlineState=o;let u=!1;l.queries.forEach((c,h)=>{for(const d of h.Sa)d.va(o)&&(u=!0)}),u&&WB(l)}(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function nve(n,e,t){const r=Yt(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),s=i&&i.key;if(s){let a=new zr(Ct.comparator);a=a.insert(s,Xs.newNoDocument(s,Gt.min()));const o=xn().add(s),l=new eN(Gt.min(),new Map,new zr(yn),a,o);await iQ(r,l),r.du=r.du.remove(s),r.Au.delete(e),YB(r)}else await k3(r.localStore,e,!1).then(()=>V3(r,e,t)).catch(Ub)}async function rve(n,e){const t=Yt(n),r=e.batch.batchId;try{const i=await fge(t.localStore,e);aQ(t,r,null),sQ(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await BS(t,i)}catch(i){await Ub(i)}}async function ive(n,e,t){const r=Yt(n);try{const i=await function(a,o){const l=Yt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let c;return l.mutationQueue.lookupMutationBatch(u,o).next(h=>($n(h!==null,37113),c=h.keys(),l.mutationQueue.removeMutationBatch(u,h))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,c,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,c)).next(()=>l.localDocuments.getDocuments(u,c))})}(r.localStore,e);aQ(r,e,t),sQ(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await BS(r,i)}catch(i){await Ub(i)}}function sQ(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function aQ(n,e,t){const r=Yt(n);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function V3(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach(r=>{n.Ru.containsKey(r)||oQ(n,r)})}function oQ(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(UB(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),YB(n))}function Vz(n,e,t){for(const r of t)r instanceof tQ?(n.Ru.addReference(r.key,e),sve(n,r)):r instanceof nQ?(dt(KB,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||oQ(n,r.key)):Lt(19791,{wu:r})}function sve(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(dt(KB,"New document in limbo: "+t),n.Eu.add(r),YB(n))}function YB(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Ct(yr.fromString(e)),r=n.fu.next();n.Au.set(r,new Xge(t)),n.du=n.du.insert(t,r),KY(n.remoteStore,new ep(gc(K2(t.path)),r,"TargetPurposeLimboResolution",q2.ce))}}async function BS(n,e,t){const r=Yt(n),i=[],s=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach((o,l)=>{a.push(r.pu(l,e,t).then(u=>{var c;if((u||t)&&r.isPrimaryClient){const h=u?!u.fromCache:(c=t==null?void 0:t.targetChanges.get(l.targetId))==null?void 0:c.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(u){i.push(u);const h=kB.As(l.targetId,u);s.push(h)}}))}),await Promise.all(a),r.Pu.H_(i),await async function(l,u){const c=Yt(l);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>je.forEach(u,d=>je.forEach(d.Es,f=>c.persistence.referenceDelegate.addReference(h,d.targetId,f)).next(()=>je.forEach(d.ds,f=>c.persistence.referenceDelegate.removeReference(h,d.targetId,f)))))}catch(h){if(!Vb(h))throw h;dt(BB,"Failed to update sequence numbers: "+h)}for(const h of u){const d=h.targetId;if(!h.fromCache){const f=c.Ms.get(d),p=f.snapshotVersion,m=f.withLastLimboFreeSnapshotVersion(p);c.Ms=c.Ms.insert(d,m)}}}(r.localStore,s))}async function ave(n,e){const t=Yt(n);if(!t.currentUser.isEqual(e)){dt(KB,"User change. New user:",e.toKey());const r=await jY(t.localStore,e);t.currentUser=e,function(s,a){s.mu.forEach(o=>{o.forEach(l=>{l.reject(new ut(He.CANCELLED,a))})}),s.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await BS(t,r.Ls)}}function ove(n,e){const t=Yt(n),r=t.Au.get(e);if(r&&r.hu)return xn().add(r.key);{let i=xn();const s=t.Iu.get(e);if(!s)return i;for(const a of s){const o=t.Tu.get(a);i=i.unionWith(o.view.nu)}return i}}function lQ(n){const e=Yt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=iQ.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ove.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nve.bind(null,e),e.Pu.H_=Gge.bind(null,e.eventManager),e.Pu.yu=jge.bind(null,e.eventManager),e}function lve(n){const e=Yt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=rve.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ive.bind(null,e),e}class eD{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=tN(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return dge(this.persistence,new uge,e.initialUser,this.serializer)}Cu(e){return new GY(OB.mi,this.serializer)}Du(e){return new xge}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}eD.provider={build:()=>new eD};class uve extends eD{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){$n(this.persistence.referenceDelegate instanceof ZC,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new Xme(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Ga.withCacheSize(this.cacheSizeBytes):Ga.DEFAULT;return new GY(r=>ZC.mi(r,t),this.serializer)}}class z3{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Uz(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=ave.bind(null,this.syncEngine),await zge(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Hge}()}createDatastore(e){const t=tN(e.databaseInfo.databaseId),r=function(s){return new Sge(s)}(e.databaseInfo);return function(s,a,o,l){return new Cge(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,a,o){return new Nge(r,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,t=>Uz(this.syncEngine,t,0),function(){return Pz.v()?new Pz:new bge}())}createSyncEngine(e,t){return function(i,s,a,o,l,u,c){const h=new Kge(i,s,a,o,l,u);return c&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=Yt(i);dt(Sv,"RemoteStore shutting down."),s.Ea.add(5),await kS(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}z3.provider={build:()=>new z3};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QB{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ud("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dp="FirestoreClient";class cve{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=qs.UNAUTHENTICATED,this.clientId=SB.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async a=>{dt(Dp,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(dt(Dp,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new qh;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=GB(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function eI(n,e){n.asyncQueue.verifyOperationInProgress(),dt(Dp,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await jY(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function zz(n,e){n.asyncQueue.verifyOperationInProgress();const t=await hve(n);dt(Dp,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Lz(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Lz(e.remoteStore,i)),n._onlineComponents=e}async function hve(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){dt(Dp,"Using user provided OfflineComponentProvider");try{await eI(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===He.FAILED_PRECONDITION||i.code===He.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;ub("Error using user provided cache. Falling back to memory cache: "+t),await eI(n,new eD)}}else dt(Dp,"Using default OfflineComponentProvider"),await eI(n,new uve(void 0));return n._offlineComponents}async function uQ(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(dt(Dp,"Using user provided OnlineComponentProvider"),await zz(n,n._uninitializedComponentsProvider._online)):(dt(Dp,"Using default OnlineComponentProvider"),await zz(n,new z3))),n._onlineComponents}function dve(n){return uQ(n).then(e=>e.syncEngine)}async function tD(n){const e=await uQ(n),t=e.eventManager;return t.onListen=Yge.bind(null,e.syncEngine),t.onUnlisten=Jge.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Qge.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=eve.bind(null,e.syncEngine),t}function fve(n,e,t={}){const r=new qh;return n.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,u){const c=new QB({next:d=>{c.Nu(),a.enqueueAndForget(()=>qB(s,h));const f=d.docs.has(o);!f&&d.fromCache?u.reject(new ut(He.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&d.fromCache&&l&&l.source==="server"?u.reject(new ut(He.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(d)},error:d=>u.reject(d)}),h=new XB(K2(o.path),c,{includeMetadataChanges:!0,qa:!0});return jB(s,h)}(await tD(n),n.asyncQueue,e,t,r)),r.promise}function pve(n,e,t={}){const r=new qh;return n.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,u){const c=new QB({next:d=>{c.Nu(),a.enqueueAndForget(()=>qB(s,h)),d.fromCache&&l.source==="server"?u.reject(new ut(He.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(d)},error:d=>u.reject(d)}),h=new XB(o,c,{includeMetadataChanges:!0,qa:!0});return jB(s,h)}(await tD(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cQ(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $z=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hQ="firestore.googleapis.com",Hz=!0;class Gz{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ut(He.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=hQ,this.ssl=Hz}else this.host=e.host,this.ssl=e.ssl??Hz;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=HY;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<qme)throw new ut(He.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Rpe("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=cQ(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ut(He.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ut(He.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ut(He.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class iN{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Gz({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ut(He.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ut(He.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Gz(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new _pe;switch(r.type){case"firstParty":return new Ape(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ut(He.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=$z.get(t);r&&(dt("ComponentProvider","Removing Datastore"),$z.delete(t),r.terminate())}(this),Promise.resolve()}}function mve(n,e,t,r={}){var u;n=eo(n,iN);const i=Lv(e),s=n._getSettings(),a={...s,emulatorOptions:n._getEmulatorOptions()},o=`${e}:${t}`;i&&(yB(`https://${o}`),xB("Firestore",!0)),s.host!==hQ&&s.host!==o&&ub("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:o,ssl:i,emulatorOptions:r};if(!_v(l,a)&&(n._setSettings(l),r.mockUserToken)){let c,h;if(typeof r.mockUserToken=="string")c=r.mockUserToken,h=qs.MOCK_USER;else{c=VK(r.mockUserToken,(u=n._app)==null?void 0:u.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new ut(He.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new qs(d)}n._authCredentials=new wpe(new JK(c,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new wd(this.firestore,e,this._query)}}class Jr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new gp(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Jr(this.firestore,e,this._key)}toJSON(){return{type:Jr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(FS(t,Jr._jsonSchema))return new Jr(e,r||null,new Ct(yr.fromString(t.referencePath)))}}Jr._jsonSchemaVersion="firestore/documentReference/1.0",Jr._jsonSchema={type:xi("string",Jr._jsonSchemaVersion),referencePath:xi("string")};class gp extends wd{constructor(e,t,r){super(e,t,K2(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Jr(this.firestore,null,new Ct(e))}withConverter(e){return new gp(this.firestore,e,this._path)}}function hd(n,e,...t){if(n=Li(n),eY("collection","path",e),n instanceof iN){const r=yr.fromString(e,...t);return rz(r),new gp(n,null,r)}{if(!(n instanceof Jr||n instanceof gp))throw new ut(He.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(yr.fromString(e,...t));return rz(r),new gp(n.firestore,null,r)}}function Np(n,e,...t){if(n=Li(n),arguments.length===1&&(e=SB.newId()),eY("doc","path",e),n instanceof iN){const r=yr.fromString(e,...t);return nz(r),new Jr(n,null,new Ct(r))}{if(!(n instanceof Jr||n instanceof gp))throw new ut(He.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(yr.fromString(e,...t));return nz(r),new Jr(n.firestore,n instanceof gp?n.converter:null,new Ct(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jz="AsyncQueue";class qz{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new WY(this,"async_queue_retry"),this._c=()=>{const r=JR();r&&dt(jz,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=JR();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=JR();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new qh;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Vb(e))throw e;dt(jz,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,ud("INTERNAL UNHANDLED ERROR: ",Wz(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=HB.createAndSchedule(this,e,t,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&Lt(47125,{Pc:Wz(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Wz(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xz(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}class dd extends iN{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new qz,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new qz(e),this._firestoreClient=void 0,await e}}}function gve(n,e){const t=typeof n=="object"?n:wB(),r=typeof n=="string"?n:WC,i=G2(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=kK("firestore");s&&mve(i,...s)}return i}function sN(n){if(n._terminated)throw new ut(He.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||vve(n),n._firestoreClient}function vve(n){var r,i,s;const e=n._freezeSettings(),t=function(o,l,u,c){return new $pe(o,l,u,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,cQ(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(n._databaseId,((r=n._app)==null?void 0:r.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new cve(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new gl(Ds.fromBase64String(e))}catch(t){throw new ut(He.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new gl(Ds.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:gl._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(FS(e,gl._jsonSchema))return gl.fromBase64String(e.bytes)}}gl._jsonSchemaVersion="firestore/bytes/1.0",gl._jsonSchema={type:xi("string",gl._jsonSchemaVersion),bytes:xi("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ut(He.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ut(He.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ut(He.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return yn(this._lat,e._lat)||yn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:yc._jsonSchemaVersion}}static fromJSON(e){if(FS(e,yc._jsonSchema))return new yc(e.latitude,e.longitude)}}yc._jsonSchemaVersion="firestore/geoPoint/1.0",yc._jsonSchema={type:xi("string",yc._jsonSchemaVersion),latitude:xi("number"),longitude:xi("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:xc._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(FS(e,xc._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new xc(e.vectorValues);throw new ut(He.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}xc._jsonSchemaVersion="firestore/vectorValue/1.0",xc._jsonSchema={type:xi("string",xc._jsonSchemaVersion),vectorValues:xi("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yve=/^__.*__$/;class xve{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new jp(e,this.data,this.fieldMask,t,this.fieldTransforms):new LS(e,this.data,t,this.fieldTransforms)}}class dQ{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new jp(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function fQ(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Lt(40011,{Ac:n})}}class ZB{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new ZB({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var i;const t=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){var i;const t=(i=this.path)==null?void 0:i.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return nD(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(fQ(this.Ac)&&yve.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class bve{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||tN(e)}Cc(e,t,r,i=!1){return new ZB({Ac:e,methodName:t,Dc:r,path:bs.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function oN(n){const e=n._freezeSettings(),t=tN(n._databaseId);return new bve(n._databaseId,!!e.ignoreUndefinedProperties,t)}function pQ(n,e,t,r,i,s={}){const a=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);t4("Data must be an object, but it was:",a,r);const o=mQ(r,a);let l,u;if(s.merge)l=new ko(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const c=[];for(const h of s.mergeFields){const d=$3(e,h,t);if(!a.contains(d))throw new ut(He.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);vQ(c,d)||c.push(d)}l=new ko(c),u=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,u=a.fieldTransforms;return new xve(new Wa(o),l,u)}class lN extends US{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof lN}}class JB extends US{_toFieldTransform(e){return new NY(e.path,new pw)}isEqual(e){return e instanceof JB}}class e4 extends US{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new vw(e.serializer,AY(e.serializer,this.Fc));return new NY(e.path,t)}isEqual(e){return e instanceof e4&&this.Fc===e.Fc}}function _ve(n,e,t,r){const i=n.Cc(1,e,t);t4("Data must be an object, but it was:",i,r);const s=[],a=Wa.empty();Gp(r,(l,u)=>{const c=n4(e,l,t);u=Li(u);const h=i.yc(c);if(u instanceof lN)s.push(c);else{const d=VS(u,h);d!=null&&(s.push(c),a.set(c,d))}});const o=new ko(s);return new dQ(a,o,i.fieldTransforms)}function wve(n,e,t,r,i,s){const a=n.Cc(1,e,t),o=[$3(e,r,t)],l=[i];if(s.length%2!=0)throw new ut(He.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)o.push($3(e,s[d])),l.push(s[d+1]);const u=[],c=Wa.empty();for(let d=o.length-1;d>=0;--d)if(!vQ(u,o[d])){const f=o[d];let p=l[d];p=Li(p);const m=a.yc(f);if(p instanceof lN)u.push(f);else{const y=VS(p,m);y!=null&&(u.push(f),c.set(f,y))}}const h=new ko(u);return new dQ(c,h,a.fieldTransforms)}function Eve(n,e,t,r=!1){return VS(t,n.Cc(r?4:3,e))}function VS(n,e){if(gQ(n=Li(n)))return t4("Unsupported field value:",e,n),mQ(n,e);if(n instanceof US)return function(r,i){if(!fQ(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,i){const s=[];let a=0;for(const o of r){let l=VS(o,i.wc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Li(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return AY(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Er.fromDate(r);return{timestampValue:QC(i.serializer,s)}}if(r instanceof Er){const s=new Er(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:QC(i.serializer,s)}}if(r instanceof yc)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof gl)return{bytesValue:OY(i.serializer,r._byteString)};if(r instanceof Jr){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:FB(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof xc)return function(a,o){return{mapValue:{fields:{[uY]:{stringValue:cY},[XC]:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw o.Sc("VectorValues must only contain numeric values.");return NB(o.serializer,u)})}}}}}}(r,i);throw i.Sc(`Unsupported field value: ${j2(r)}`)}(n,e)}function mQ(n,e){const t={};return rY(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Gp(n,(r,i)=>{const s=VS(i,e.mc(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function gQ(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Er||n instanceof yc||n instanceof gl||n instanceof Jr||n instanceof US||n instanceof xc)}function t4(n,e,t){if(!gQ(t)||!tY(t)){const r=j2(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function $3(n,e,t){if((e=Li(e))instanceof aN)return e._internalPath;if(typeof e=="string")return n4(n,e);throw nD("Field path arguments must be of type string or ",n,!1,void 0,t)}const Sve=new RegExp("[~\\*/\\[\\]]");function n4(n,e,t){if(e.search(Sve)>=0)throw nD(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new aN(...e.split("."))._internalPath}catch{throw nD(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function nD(n,e,t,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new ut(He.INVALID_ARGUMENT,o+n+l)}function vQ(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yQ{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Jr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Ave(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(uN("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Ave extends yQ{data(){return super.data()}}function uN(n,e){return typeof e=="string"?n4(n,e):e instanceof aN?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xQ(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ut(He.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class r4{}class i4 extends r4{}function zS(n,e,...t){let r=[];e instanceof r4&&r.push(e),r=r.concat(t),function(s){const a=s.filter(l=>l instanceof s4).length,o=s.filter(l=>l instanceof cN).length;if(a>1||a>0&&o>0)throw new ut(He.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class cN extends i4{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new cN(e,t,r)}_apply(e){const t=this._parse(e);return _Q(e._query,t),new wd(e.firestore,e.converter,I3(e._query,t))}_parse(e){const t=oN(e.firestore);return function(s,a,o,l,u,c,h){let d;if(u.isKeyField()){if(c==="array-contains"||c==="array-contains-any")throw new ut(He.INVALID_ARGUMENT,`Invalid Query. You can't perform '${c}' queries on documentId().`);if(c==="in"||c==="not-in"){Yz(h,c);const p=[];for(const m of h)p.push(Kz(l,s,m));d={arrayValue:{values:p}}}else d=Kz(l,s,h)}else c!=="in"&&c!=="not-in"&&c!=="array-contains-any"||Yz(h,c),d=Eve(o,a,h,c==="in"||c==="not-in");return yi.create(u,c,d)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function bQ(n,e,t){const r=e,i=uN("where",n);return cN._create(i,r,t)}class s4 extends r4{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new s4(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:pu.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)_Q(a,l),a=I3(a,l)}(e._query,t),new wd(e.firestore,e.converter,I3(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class a4 extends i4{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new a4(e,t)}_apply(e){const t=function(i,s,a){if(i.startAt!==null)throw new ut(He.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new ut(He.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new fw(s,a)}(e._query,this._field,this._direction);return new wd(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new zb(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function o4(n,e="asc"){const t=e,r=uN("orderBy",n);return a4._create(r,t)}class l4 extends i4{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new l4(e,t,r)}_apply(e){return new wd(e.firestore,e.converter,YC(e._query,this._limit,this._limitType))}}function Tve(n){return l4._create("limit",n,"F")}function Kz(n,e,t){if(typeof(t=Li(t))=="string"){if(t==="")throw new ut(He.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!yY(e)&&t.indexOf("/")!==-1)throw new ut(He.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(yr.fromString(t));if(!Ct.isDocumentKey(r))throw new ut(He.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return hz(n,new Ct(r))}if(t instanceof Jr)return hz(n,t._key);throw new ut(He.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${j2(t)}.`)}function Yz(n,e){if(!Array.isArray(n)||n.length===0)throw new ut(He.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function _Q(n,e){const t=function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new ut(He.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ut(He.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Mve{convertValue(e,t="none"){switch(Mp(e)){case 0:return null;case 1:return e.booleanValue;case 2:return si(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Tp(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Lt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Gp(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var r,i,s;const t=(s=(i=(r=e.fields)==null?void 0:r[XC].arrayValue)==null?void 0:i.values)==null?void 0:s.map(a=>si(a.doubleValue));return new xc(t)}convertGeoPoint(e){return new yc(si(e.latitude),si(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=X2(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(cw(e));default:return null}}convertTimestamp(e){const t=Ap(e);return new Er(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=yr.fromString(e);$n($Y(r),9688,{name:e});const i=new hw(r.get(1),r.get(3)),s=new Ct(r.popFirst(5));return i.isEqual(t)||ud(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wQ(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class H_{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class dv extends yQ{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new _M(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(uN("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ut(He.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=dv._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}dv._jsonSchemaVersion="firestore/documentSnapshot/1.0",dv._jsonSchema={type:xi("string",dv._jsonSchemaVersion),bundleSource:xi("string","DocumentSnapshot"),bundleName:xi("string"),bundle:xi("string")};class _M extends dv{data(e={}){return super.data(e)}}class fv{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new H_(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new _M(this._firestore,this._userDataWriter,r.key,r,new H_(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ut(He.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new _M(i._firestore,i._userDataWriter,o.doc.key,o.doc,new H_(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new _M(i._firestore,i._userDataWriter,o.doc.key,o.doc,new H_(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,c=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),c=a.indexOf(o.doc.key)),{type:Cve(o.type),doc:l,oldIndex:u,newIndex:c}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ut(He.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=fv._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=SB.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Cve(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Lt(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EQ(n){n=eo(n,Jr);const e=eo(n.firestore,dd);return fve(sN(e),n._key).then(t=>TQ(e,n,t))}fv._jsonSchemaVersion="firestore/querySnapshot/1.0",fv._jsonSchema={type:xi("string",fv._jsonSchemaVersion),bundleSource:xi("string","QuerySnapshot"),bundleName:xi("string"),bundle:xi("string")};class u4 extends Mve{constructor(e){super(),this.firestore=e}convertBytes(e){return new gl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Jr(this.firestore,null,t)}}function hN(n){n=eo(n,wd);const e=eo(n.firestore,dd),t=sN(e),r=new u4(e);return xQ(n._query),pve(t,n._query).then(i=>new fv(e,r,n,i))}function Dve(n,e,t){n=eo(n,Jr);const r=eo(n.firestore,dd),i=wQ(n.converter,e);return fN(r,[pQ(oN(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,El.none())])}function SQ(n,e,t,...r){n=eo(n,Jr);const i=eo(n.firestore,dd),s=oN(i);let a;return a=typeof(e=Li(e))=="string"||e instanceof aN?wve(s,"updateDoc",n._key,e,t,r):_ve(s,"updateDoc",n._key,e),fN(i,[a.toMutation(n._key,El.exists(!0))])}function AQ(n){return fN(eo(n.firestore,dd),[new RB(n._key,El.none())])}function dN(n,e){const t=eo(n.firestore,dd),r=Np(n),i=wQ(n.converter,e);return fN(t,[pQ(oN(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,El.exists(!1))]).then(()=>r)}function Nve(n,...e){var l,u,c;n=Li(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Xz(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Xz(e[r])){const h=e[r];e[r]=(l=h.next)==null?void 0:l.bind(h),e[r+1]=(u=h.error)==null?void 0:u.bind(h),e[r+2]=(c=h.complete)==null?void 0:c.bind(h)}let s,a,o;if(n instanceof Jr)a=eo(n.firestore,dd),o=K2(n._key.path),s={next:h=>{e[r]&&e[r](TQ(a,n,h))},error:e[r+1],complete:e[r+2]};else{const h=eo(n,wd);a=eo(h.firestore,dd),o=h._query;const d=new u4(a);s={next:f=>{e[r]&&e[r](new fv(a,d,h,f))},error:e[r+1],complete:e[r+2]},xQ(n._query)}return function(d,f,p,m){const y=new QB(m),v=new XB(f,y,p);return d.asyncQueue.enqueueAndForget(async()=>jB(await tD(d),v)),()=>{y.Nu(),d.asyncQueue.enqueueAndForget(async()=>qB(await tD(d),v))}}(sN(a),o,i,s)}function fN(n,e){return function(r,i){const s=new qh;return r.asyncQueue.enqueueAndForget(async()=>tve(await dve(r),i,s)),s.promise}(sN(n),e)}function TQ(n,e,t){const r=t.docs.get(e._key),i=new u4(n);return new dv(n,i,e._key,r,new H_(t.hasPendingWrites,t.fromCache),e.converter)}function Wh(){return new JB("serverTimestamp")}function Rve(n){return new e4("increment",n)}(function(e,t=!0){(function(i){Bb=i})(Ov),wv(new Ep("firestore",(r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),o=new dd(new Epe(r.getProvider("auth-internal")),new Tpe(a,r.getProvider("app-check-internal")),function(u,c){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ut(He.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hw(u.options.projectId,c)}(a,i),a);return s={useFetchStreams:t,...s},o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),mc(Z6,J6,e),mc(Z6,J6,"esm2020")})();const ga=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),H3=[.001,0,0,.001,0,0],tI=1.35,Co={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Jd={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},yw="pdfjs_internal_editor_",Jt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},En={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Ive={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},G3={TRIANGLES:1,LATTICE:2},us={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},wM={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},fi={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},R0={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},pN={ERRORS:0,WARNINGS:1,INFOS:5},xw={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},v_={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},Pve={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let mN=pN.WARNINGS;function Fve(n){Number.isInteger(n)&&(mN=n)}function Lve(){return mN}function gN(n){mN>=pN.INFOS&&console.info(`Info: ${n}`)}function Xt(n){mN>=pN.WARNINGS&&console.warn(`Warning: ${n}`)}function fr(n){throw new Error(n)}function Sn(n,e){n||fr(e)}function Ove(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function MQ(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=zve(n)}catch{}}const r=e?URL.parse(n,e):URL.parse(n);return Ove(r)?r:null}function CQ(n,e,t=!1){const r=URL.parse(n);return r?(r.hash=e,r.href):t&&MQ(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Kt(n,e,t,r=!1){return Object.defineProperty(n,e,{value:t,enumerable:!r,configurable:!0,writable:!1}),t}const Uv=function(){function e(t,r){this.message=t,this.name=r}return e.prototype=new Error,e.constructor=e,e}();class Qz extends Uv{constructor(e,t){super(e,"PasswordException"),this.code=t}}class nI extends Uv{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class j3 extends Uv{constructor(e){super(e,"InvalidPDFException")}}class rD extends Uv{constructor(e,t,r){super(e,"ResponseException"),this.status=t,this.missing=r}}class kve extends Uv{constructor(e){super(e,"FormatError")}}class Rp extends Uv{constructor(e){super(e,"AbortException")}}function DQ(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&fr("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const r=[];for(let i=0;i<e;i+=t){const s=Math.min(i+t,e),a=n.subarray(i,s);r.push(String.fromCharCode.apply(null,a))}return r.join("")}function $S(n){typeof n!="string"&&fr("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let r=0;r<e;++r)t[r]=n.charCodeAt(r)&255;return t}function Bve(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function Uve(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function Vve(){try{return new Function(""),!0}catch{return!1}}class Ts{static get isLittleEndian(){return Kt(this,"isLittleEndian",Uve())}static get isEvalSupported(){return Kt(this,"isEvalSupported",Vve())}static get isOffscreenCanvasSupported(){return Kt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Kt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return Kt(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return Kt(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Kt(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return Kt(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const rI=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var Jh,EM,q3;class yt{static makeHexColor(e,t,r){return`#${rI[e]}${rI[t]}${rI[r]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let r;e[0]?(e[0]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[3],t[3]*=e[3]):(r=t[0],t[0]=t[1],t[1]=r,r=t[2],t[2]=t[3],t[3]=r,e[1]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,r=0){const i=e[r],s=e[r+1];e[r]=i*t[0]+s*t[2]+t[4],e[r+1]=i*t[1]+s*t[3]+t[5]}static applyTransformToBezier(e,t,r=0){const i=t[0],s=t[1],a=t[2],o=t[3],l=t[4],u=t[5];for(let c=0;c<6;c+=2){const h=e[r+c],d=e[r+c+1];e[r+c]=h*i+d*a+l,e[r+c+1]=h*s+d*o+u}}static applyInverseTransform(e,t){const r=e[0],i=e[1],s=t[0]*t[3]-t[1]*t[2];e[0]=(r*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/s,e[1]=(-r*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/s}static axialAlignedBoundingBox(e,t,r){const i=t[0],s=t[1],a=t[2],o=t[3],l=t[4],u=t[5],c=e[0],h=e[1],d=e[2],f=e[3];let p=i*c+l,m=p,y=i*d+l,v=y,b=o*h+u,x=b,w=o*f+u,_=w;if(s!==0||a!==0){const E=s*c,A=s*d,T=a*h,S=a*f;p+=T,v+=T,y+=S,m+=S,b+=E,_+=E,w+=A,x+=A}r[0]=Math.min(r[0],p,y,m,v),r[1]=Math.min(r[1],b,w,x,_),r[2]=Math.max(r[2],p,y,m,v),r[3]=Math.max(r[3],b,w,x,_)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const r=e[0],i=e[1],s=e[2],a=e[3],o=r**2+i**2,l=r*s+i*a,u=s**2+a**2,c=(o+u)/2,h=Math.sqrt(c**2-(o*u-l**2));t[0]=Math.sqrt(c+h||1),t[1]=Math.sqrt(c-h||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const r=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(r>i)return null;const s=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return s>a?null:[r,s,i,a]}static pointBoundingBox(e,t,r){r[0]=Math.min(r[0],e),r[1]=Math.min(r[1],t),r[2]=Math.max(r[2],e),r[3]=Math.max(r[3],t)}static rectBoundingBox(e,t,r,i,s){s[0]=Math.min(s[0],e,r),s[1]=Math.min(s[1],t,i),s[2]=Math.max(s[2],e,r),s[3]=Math.max(s[3],t,i)}static bezierBoundingBox(e,t,r,i,s,a,o,l,u){u[0]=Math.min(u[0],e,o),u[1]=Math.min(u[1],t,l),u[2]=Math.max(u[2],e,o),u[3]=Math.max(u[3],t,l),X(this,Jh,q3).call(this,e,r,s,o,t,i,a,l,3*(-e+3*(r-s)+o),6*(e-2*r+s),3*(r-e),u),X(this,Jh,q3).call(this,e,r,s,o,t,i,a,l,3*(-t+3*(i-a)+l),6*(t-2*i+a),3*(i-t),u)}}Jh=new WeakSet,EM=function(e,t,r,i,s,a,o,l,u,c){if(u<=0||u>=1)return;const h=1-u,d=u*u,f=d*u,p=h*(h*(h*e+3*u*t)+3*d*r)+f*i,m=h*(h*(h*s+3*u*a)+3*d*o)+f*l;c[0]=Math.min(c[0],p),c[1]=Math.min(c[1],m),c[2]=Math.max(c[2],p),c[3]=Math.max(c[3],m)},q3=function(e,t,r,i,s,a,o,l,u,c,h,d){if(Math.abs(u)<1e-12){Math.abs(c)>=1e-12&&X(this,Jh,EM).call(this,e,t,r,i,s,a,o,l,-h/c,d);return}const f=c**2-4*h*u;if(f<0)return;const p=Math.sqrt(f),m=2*u;X(this,Jh,EM).call(this,e,t,r,i,s,a,o,l,(-c+p)/m,d),X(this,Jh,EM).call(this,e,t,r,i,s,a,o,l,(-c-p)/m,d)},G(yt,Jh);function zve(n){return decodeURIComponent(escape(n))}let iI=null,Zz=null;function $ve(n){return iI||(iI=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Zz=new Map([["","t"]])),n.replaceAll(iI,(e,t,r)=>t?t.normalize("NFKC"):Zz.get(r))}function NQ(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),DQ(n)}const ny="pdfjs_internal_id_";function Hve(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[r,i,...s]=t;if(!n(r)&&!Number.isInteger(r)||!e(i))return!1;const a=s.length;let o=!0;switch(i.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const l of s)if(!(typeof l=="number"||o&&l===null))return!1;return!0}function va(n,e,t){return Math.min(Math.max(n,e),t)}function RQ(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(DQ(n))}function Gve(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):$S(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});class bw{static textContent(e){const t=[],r={items:t,styles:Object.create(null)};function i(s){var l;if(!s)return;let a=null;const o=s.name;if(o==="#text")a=s.value;else if(bw.shouldBuildText(o))(l=s==null?void 0:s.attributes)!=null&&l.textContent?a=s.attributes.textContent:s.value&&(a=s.value);else return;if(a!==null&&t.push({str:a}),!!s.children)for(const u of s.children)i(u)}return i(e),r}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class IQ{static setupStorage(e,t,r,i,s){const a=i.getValue(t,{value:null});switch(r.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),s==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})});break;case"input":if(r.attributes.type==="radio"||r.attributes.type==="checkbox"){if(a.value===r.attributes.xfaOn?e.setAttribute("checked",!0):a.value===r.attributes.xfaOff&&e.removeAttribute("checked"),s==="print")break;e.addEventListener("change",o=>{i.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),s==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of r.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,u=l.selectedIndex===-1?"":l[l.selectedIndex].value;i.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:r=null,intent:i,linkService:s}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${i}`);for(const[l,u]of Object.entries(a))if(u!=null)switch(l){case"class":u.length&&e.setAttribute(l,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,u)}o&&s.addLinkAttributes(e,a.href,a.newWindow),r&&a.dataId&&this.setupStorage(e,a.dataId,t,r)}static render(e){var h,d;const t=e.annotationStorage,r=e.linkService,i=e.xfaHtml,s=e.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:s,linkService:r});const o=s!=="richText",l=e.div;if(l.append(a),e.viewport){const f=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=f}o&&l.setAttribute("class","xfaLayer xfaFont");const u=[];if(i.children.length===0){if(i.value){const f=document.createTextNode(i.value);a.append(f),o&&bw.shouldBuildText(i.name)&&u.push(f)}return{textDivs:u}}const c=[[i,-1,a]];for(;c.length>0;){const[f,p,m]=c.at(-1);if(p+1===f.children.length){c.pop();continue}const y=f.children[++c.at(-1)[1]];if(y===null)continue;const{name:v}=y;if(v==="#text"){const x=document.createTextNode(y.value);u.push(x),m.append(x);continue}const b=(h=y==null?void 0:y.attributes)!=null&&h.xmlns?document.createElementNS(y.attributes.xmlns,v):document.createElement(v);if(m.append(b),y.attributes&&this.setAttributes({html:b,element:y,storage:t,intent:s,linkService:r}),((d=y.children)==null?void 0:d.length)>0)c.push([y,-1,b]);else if(y.value){const x=document.createTextNode(y.value);o&&bw.shouldBuildText(v)&&u.push(x),b.append(x)}}for(const f of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Xc="http://www.w3.org/2000/svg",Fm=class Fm{};Qe(Fm,"CSS",96),Qe(Fm,"PDF",72),Qe(Fm,"PDF_TO_CSS_UNITS",Fm.CSS/Fm.PDF);let Ip=Fm;async function HS(n,e="text"){if(G_(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,r)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}r(new Error(i.statusText))}},i.send(null)})}class GS{constructor({viewBox:e,userUnit:t,scale:r,rotation:i,offsetX:s=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=r,this.rotation=i,this.offsetX=s,this.offsetY=a,r*=t;const l=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let c,h,d,f;switch(i%=360,i<0&&(i+=360),i){case 180:c=-1,h=0,d=0,f=1;break;case 90:c=0,h=1,d=1,f=0;break;case 270:c=0,h=-1,d=-1,f=0;break;case 0:c=1,h=0,d=0,f=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(d=-d,f=-f);let p,m,y,v;c===0?(p=Math.abs(u-e[1])*r+s,m=Math.abs(l-e[0])*r+a,y=(e[3]-e[1])*r,v=(e[2]-e[0])*r):(p=Math.abs(l-e[0])*r+s,m=Math.abs(u-e[1])*r+a,y=(e[2]-e[0])*r,v=(e[3]-e[1])*r),this.transform=[c*r,h*r,d*r,f*r,p-c*r*l-d*r*u,m-h*r*l-f*r*u],this.width=y,this.height=v}get rawDims(){const e=this.viewBox;return Kt(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:r=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}={}){return new GS({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:r,offsetY:i,dontFlip:s})}convertToViewportPoint(e,t){const r=[e,t];return yt.applyTransform(r,this.transform),r}convertToViewportRectangle(e){const t=[e[0],e[1]];yt.applyTransform(t,this.transform);const r=[e[2],e[3]];return yt.applyTransform(r,this.transform),[t[0],t[1],r[0],r[1]]}convertToPdfPoint(e,t){const r=[e,t];return yt.applyInverseTransform(r,this.transform),r}}class c4 extends Uv{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function vN(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function h4(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function jve(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function qve(n,e="document.pdf"){if(typeof n!="string")return e;if(vN(n))return Xt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const r=(o=>{try{return new URL(o)}catch{try{return new URL(decodeURIComponent(o))}catch{try{return new URL(o,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(o),"https://foo.bar")}catch{return null}}}}})(n);if(!r)return e;const i=o=>{try{let l=decodeURIComponent(o);return l.includes("/")?(l=l.split("/").at(-1),l.test(/^\.pdf$/i)?l:o):l}catch{return o}},s=/\.pdf$/i,a=r.pathname.split("/").at(-1);if(s.test(a))return i(a);if(r.searchParams.size>0){const o=Array.from(r.searchParams.values()).reverse();for(const u of o)if(s.test(u))return i(u);const l=Array.from(r.searchParams.keys()).reverse();for(const u of l)if(s.test(u))return i(u)}if(r.hash){const l=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(r.hash);if(l)return i(l[0])}return e}class Jz{constructor(){Qe(this,"started",Object.create(null));Qe(this,"times",[])}time(e){e in this.started&&Xt(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Xt(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:r}of this.times)t=Math.max(r.length,t);for(const{name:r,start:i,end:s}of this.times)e.push(`${r.padEnd(t)} ${s-i}ms
`);return e.join("")}}function G_(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function Cl(n){n.preventDefault()}function Yr(n){n.preventDefault(),n.stopPropagation()}function Wve(n){console.log("Deprecated API usage: "+n)}var Fw;class iD{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;g(this,Fw)||B(this,Fw,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=g(this,Fw).exec(e);if(!t)return null;const r=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const u=t[7]||"Z";let c=parseInt(t[8],10);c=c>=0&&c<=23?c:0;let h=parseInt(t[9],10)||0;return h=h>=0&&h<=59?h:0,u==="-"?(a+=c,o+=h):u==="+"&&(a-=c,o-=h),new Date(Date.UTC(r,i,s,a,o,l))}}Fw=new WeakMap,G(iD,Fw);function Xve(n,{scale:e=1,rotation:t=0}){const{width:r,height:i}=n.attributes.style,s=[0,0,parseInt(r),parseInt(i)];return new GS({viewBox:s,userUnit:1,scale:e,rotation:t})}function jS(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Xt(`Not a valid color format: "${n}"`),[0,0,0])}function Kve(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const r=window.getComputedStyle(e).color;n.set(t,jS(r))}e.remove()}function Fr(n){const{a:e,b:t,c:r,d:i,e:s,f:a}=n.getTransform();return[e,t,r,i,s,a]}function Du(n){const{a:e,b:t,c:r,d:i,e:s,f:a}=n.getTransform().invertSelf();return[e,t,r,i,s,a]}function Av(n,e,t=!1,r=!0){if(e instanceof GS){const{pageWidth:i,pageHeight:s}=e.rawDims,{style:a}=n,o=Ts.isCSSRoundSupported,l=`var(--total-scale-factor) * ${i}px`,u=`var(--total-scale-factor) * ${s}px`,c=o?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,h=o?`round(down, ${u}, var(--scale-round-y))`:`calc(${u})`;!t||e.rotation%180===0?(a.width=c,a.height=h):(a.width=h,a.height=c)}r&&n.setAttribute("data-main-rotation",e.rotation)}class Ac{constructor(){const{pixelRatio:e}=Ac;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,r,i,s=-1){let a=1/0,o=1/0,l=1/0;r=Ac.capPixels(r,s),r>0&&(a=Math.sqrt(r/(e*t))),i!==-1&&(o=i/e,l=i/t);const u=Math.min(a,o,l);return this.sx>u||this.sy>u?(this.sx=u,this.sy=u,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const r=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,r):r}return e}}const W3=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class Yve{static get isDarkMode(){var e;return Kt(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class Qve{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:r}=window.getComputedStyle(e);return e.remove(),Kt(this,"commentForegroundColor",jS(r))}}function Zve(n,e,t,r){r=Math.min(Math.max(r??1,0),1);const i=255*(1-r);return n=Math.round(n*r+i),e=Math.round(e*r+i),t=Math.round(t*r+i),[n,e,t]}function e8(n,e){const t=n[0]/255,r=n[1]/255,i=n[2]/255,s=Math.max(t,r,i),a=Math.min(t,r,i),o=(s+a)/2;if(s===a)e[0]=e[1]=0;else{const l=s-a;switch(e[1]=o<.5?l/(s+a):l/(2-s-a),s){case t:e[0]=((r-i)/l+(r<i?6:0))*60;break;case r:e[0]=((i-t)/l+2)*60;break;case i:e[0]=((t-r)/l+4)*60;break}}e[2]=o}function X3(n,e){const t=n[0],r=n[1],i=n[2],s=(1-Math.abs(2*i-1))*r,a=s*(1-Math.abs(t/60%2-1)),o=i-s/2;switch(Math.floor(t/60)){case 0:e[0]=s+o,e[1]=a+o,e[2]=o;break;case 1:e[0]=a+o,e[1]=s+o,e[2]=o;break;case 2:e[0]=o,e[1]=s+o,e[2]=a+o;break;case 3:e[0]=o,e[1]=a+o,e[2]=s+o;break;case 4:e[0]=a+o,e[1]=o,e[2]=s+o;break;case 5:case 6:e[0]=s+o,e[1]=o,e[2]=a+o;break}}function t8(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function n8(n,e,t){X3(n,t),t.map(t8);const r=.2126*t[0]+.7152*t[1]+.0722*t[2];X3(e,t),t.map(t8);const i=.2126*t[0]+.7152*t[1]+.0722*t[2];return r>i?(r+.05)/(i+.05):(i+.05)/(r+.05)}const r8=new Map;function Jve(n,e){const t=n[0]+n[1]*256+n[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let r=r8.get(t);if(r)return r;const i=new Float32Array(9),s=i.subarray(0,3),a=i.subarray(3,6);e8(n,a);const o=i.subarray(6,9);e8(e,o);const l=o[2]<.5,u=l?12:4.5;if(a[2]=l?Math.sqrt(a[2]):1-Math.sqrt(1-a[2]),n8(a,o,s)<u){let c,h;l?(c=a[2],h=1):(c=0,h=a[2]);const d=.005;for(;h-c>d;){const f=a[2]=(c+h)/2;l===n8(a,o,s)<u?c=f:h=f}a[2]=l?h:c}return X3(a,s),r=yt.makeHexColor(Math.round(s[0]*255),Math.round(s[1]*255),Math.round(s[2]*255)),r8.set(t,r),r}function PQ({html:n,dir:e,className:t},r){const i=document.createDocumentFragment();if(typeof n=="string"){const s=document.createElement("p");s.dir=e||"auto";const a=n.split(/(?:\r\n?|\n)/);for(let o=0,l=a.length;o<l;++o){const u=a[o];s.append(document.createTextNode(u)),o<l-1&&s.append(document.createElement("br"))}i.append(s)}else IQ.render({xfaHtml:n,div:i,intent:"richText"});i.firstElementChild.classList.add("richText",t),r.append(i)}function FQ(n){const e=new Path2D;if(!n)return e;for(let t=0,r=n.length;t<r;)switch(n[t++]){case v_.moveTo:e.moveTo(n[t++],n[t++]);break;case v_.lineTo:e.lineTo(n[t++],n[t++]);break;case v_.curveTo:e.bezierCurveTo(n[t++],n[t++],n[t++],n[t++],n[t++],n[t++]);break;case v_.quadraticCurveTo:e.quadraticCurveTo(n[t++],n[t++],n[t++],n[t++]);break;case v_.closePath:e.closePath();break;default:Xt(`Unrecognized drawing path operator: ${n[t-1]}`);break}return e}var af,of,el,tl,Lw,lf,Dy,Ny,Ow,r2,LQ,_s,OQ,kQ,I0,j_;const Jc=class Jc{constructor(e){G(this,_s);G(this,af,null);G(this,of,null);G(this,el);G(this,tl,null);G(this,Lw,null);G(this,lf,null);G(this,Dy,null);G(this,Ny,null);B(this,el,e),g(Jc,Ow)||B(Jc,Ow,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=B(this,af,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=g(this,el)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",Cl,{signal:t}),e.addEventListener("pointerdown",X(Jc,r2,LQ),{signal:t}));const r=B(this,tl,document.createElement("div"));r.className="buttons",e.append(r);const i=g(this,el).toolbarPosition;if(i){const{style:s}=e,a=g(this,el)._uiManager.direction==="ltr"?1-i[0]:i[0];s.insetInlineEnd=`${100*a}%`,s.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return g(this,af)}hide(){var e;g(this,af).classList.add("hidden"),(e=g(this,of))==null||e.hideDropdown()}show(){var e,t;g(this,af).classList.remove("hidden"),(e=g(this,Lw))==null||e.shown(),(t=g(this,lf))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=g(this,el),r=document.createElement("button");r.classList.add("basic","deleteButton"),r.tabIndex=0,r.setAttribute("data-l10n-id",g(Jc,Ow)[e]),X(this,_s,I0).call(this,r)&&r.addEventListener("click",i=>{t.delete()},{signal:t._signal}),g(this,tl).append(r)}async addAltText(e){const t=await e.render();X(this,_s,I0).call(this,t),g(this,tl).append(t,g(this,_s,j_)),B(this,Lw,e)}addComment(e,t=null){if(g(this,lf))return;const r=e.renderForToolbar();if(!r)return;X(this,_s,I0).call(this,r);const i=B(this,Dy,g(this,_s,j_));t?(g(this,tl).insertBefore(r,t),g(this,tl).insertBefore(i,t)):g(this,tl).append(r,i),B(this,lf,e),e.toolbar=this}addColorPicker(e){if(g(this,of))return;B(this,of,e);const t=e.renderButton();X(this,_s,I0).call(this,t),g(this,tl).append(t,g(this,_s,j_))}async addEditSignatureButton(e){const t=B(this,Ny,await e.renderEditButton(g(this,el)));X(this,_s,I0).call(this,t),g(this,tl).append(t,g(this,_s,j_))}removeButton(e){var t,r;switch(e){case"comment":(t=g(this,lf))==null||t.removeToolbarCommentButton(),B(this,lf,null),(r=g(this,Dy))==null||r.remove(),B(this,Dy,null);break}}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,r){if(!t&&e==="comment")return;const i=g(this,tl).querySelector(r);i&&e==="comment"&&this.addComment(t,i)}updateEditSignatureButton(e){g(this,Ny)&&(g(this,Ny).title=e)}remove(){var e;g(this,af).remove(),(e=g(this,of))==null||e.destroy(),B(this,of,null)}};af=new WeakMap,of=new WeakMap,el=new WeakMap,tl=new WeakMap,Lw=new WeakMap,lf=new WeakMap,Dy=new WeakMap,Ny=new WeakMap,Ow=new WeakMap,r2=new WeakSet,LQ=function(e){e.stopPropagation()},_s=new WeakSet,OQ=function(e){g(this,el)._focusEventsAllowed=!1,Yr(e)},kQ=function(e){g(this,el)._focusEventsAllowed=!0,Yr(e)},I0=function(e){const t=g(this,el)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",X(this,_s,OQ).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",X(this,_s,kQ).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Cl,{signal:t}),!0)},j_=function(){const e=document.createElement("div");return e.className="divider",e},G(Jc,r2),G(Jc,Ow,null);let K3=Jc;var kw,Wm,nh,xd,BQ,UQ,Y3;class e0e{constructor(e){G(this,xd);G(this,kw,null);G(this,Wm,null);G(this,nh);B(this,nh,e)}show(e,t,r){const[i,s]=X(this,xd,UQ).call(this,t,r),{style:a}=g(this,Wm)||B(this,Wm,X(this,xd,BQ).call(this));e.append(g(this,Wm)),a.insetInlineEnd=`${100*i}%`,a.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){g(this,Wm).remove()}}kw=new WeakMap,Wm=new WeakMap,nh=new WeakMap,xd=new WeakSet,BQ=function(){const e=B(this,Wm,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=g(this,nh)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",Cl,{signal:t});const r=B(this,kw,document.createElement("div"));return r.className="buttons",e.append(r),g(this,nh).hasCommentManager()&&X(this,xd,Y3).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{g(this,nh).commentSelection("floating_button")}),X(this,xd,Y3).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{g(this,nh).highlightSelection("floating_button")}),e},UQ=function(e,t){let r=0,i=0;for(const s of e){const a=s.y+s.height;if(a<r)continue;const o=s.x+(t?s.width:0);if(a>r){i=o,r=a;continue}t?o>i&&(i=o):o<i&&(i=o)}return[t?1-i:i,r]},Y3=function(e,t,r,i){const s=document.createElement("button");s.classList.add("basic",e),s.tabIndex=0,s.setAttribute("data-l10n-id",t);const a=document.createElement("span");s.append(a),a.className="visuallyHidden",a.setAttribute("data-l10n-id",r);const o=g(this,nh)._signal;o instanceof AbortSignal&&!o.aborted&&(s.addEventListener("contextmenu",Cl,{signal:o}),s.addEventListener("click",i,{signal:o})),g(this,kw).append(s)};function VQ(n,e,t){for(const r of t)e.addEventListener(r,n[r].bind(n))}var Xm,Km,Ry,Ym;const Jn=class Jn{static initializeAndAddPointerId(e){(g(Jn,Km)||B(Jn,Km,new Set)).add(e)}static setPointer(e,t){g(Jn,Xm)||B(Jn,Xm,t),g(Jn,Ym)??B(Jn,Ym,e)}static setTimeStamp(e){B(Jn,Ry,e)}static isSamePointerId(e){return g(Jn,Xm)===e}static isSamePointerIdOrRemove(e){var t;return g(Jn,Xm)===e?!0:((t=g(Jn,Km))==null||t.delete(e),!1)}static isSamePointerType(e){return g(Jn,Ym)===e}static isInitializedAndDifferentPointerType(e){return g(Jn,Ym)!==null&&!Jn.isSamePointerType(e)}static isSameTimeStamp(e){return g(Jn,Ry)===e}static isUsingMultiplePointers(){var e;return((e=g(Jn,Km))==null?void 0:e.size)>=1}static clearPointerType(){B(Jn,Ym,null)}static clearPointerIds(){B(Jn,Xm,NaN),B(Jn,Km,null)}static clearTimeStamp(){B(Jn,Ry,NaN)}};Xm=new WeakMap,Km=new WeakMap,Ry=new WeakMap,Ym=new WeakMap,G(Jn,Xm,NaN),G(Jn,Km,null),G(Jn,Ry,NaN),G(Jn,Ym,null);let Vs=Jn;var i2;class t0e{constructor(){G(this,i2,0)}get id(){return`${yw}${Ei(this,i2)._++}`}}i2=new WeakMap;var Iy,Bw,zs,Py,SM;const OU=class OU{constructor(){G(this,Py);G(this,Iy,NQ());G(this,Bw,0);G(this,zs,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',r=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const s=i.decode().then(()=>(r.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(r.getImageData(0,0,1,1).data.buffer)[0]===0));return Kt(this,"_isSVGFittingCanvas",s)}async getFromFile(e){const{lastModified:t,name:r,size:i,type:s}=e;return X(this,Py,SM).call(this,`${t}_${r}_${i}_${s}`,e)}async getFromUrl(e){return X(this,Py,SM).call(this,e,e)}async getFromBlob(e,t){const r=await t;return X(this,Py,SM).call(this,e,r)}async getFromId(e){g(this,zs)||B(this,zs,new Map);const t=g(this,zs).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:r}=t;return delete t.blobPromise,this.getFromBlob(t.id,r)}return this.getFromUrl(t.url)}getFromCanvas(e,t){g(this,zs)||B(this,zs,new Map);let r=g(this,zs).get(e);if(r!=null&&r.bitmap)return r.refCounter+=1,r;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),r={bitmap:i.transferToImageBitmap(),id:`image_${g(this,Iy)}_${Ei(this,Bw)._++}`,refCounter:1,isSvg:!1},g(this,zs).set(e,r),g(this,zs).set(r.id,r),r}getSvgUrl(e){const t=g(this,zs).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;g(this,zs)||B(this,zs,new Map);const t=g(this,zs).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:r}=t;if(!t.url&&!t.file){const s=new OffscreenCanvas(r.width,r.height);s.getContext("bitmaprenderer").transferFromImageBitmap(r),t.blobPromise=s.convertToBlob()}(i=r.close)==null||i.call(r),t.bitmap=null}isValidId(e){return e.startsWith(`image_${g(this,Iy)}_`)}};Iy=new WeakMap,Bw=new WeakMap,zs=new WeakMap,Py=new WeakSet,SM=async function(e,t){g(this,zs)||B(this,zs,new Map);let r=g(this,zs).get(e);if(r===null)return null;if(r!=null&&r.bitmap)return r.refCounter+=1,r;try{r||(r={bitmap:null,id:`image_${g(this,Iy)}_${Ei(this,Bw)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(r.url=t,i=await HS(t,"blob")):t instanceof File?i=r.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const s=OU._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((u,c)=>{o.onload=()=>{r.bitmap=o,r.isSvg=!0,u()},a.onload=async()=>{const h=r.svgUrl=a.result;o.src=await s?`${h}#svgView(preserveAspectRatio(none))`:h},o.onerror=a.onerror=c});a.readAsDataURL(i),await l}else r.bitmap=await createImageBitmap(i);r.refCounter=1}catch(i){Xt(i),r=null}return g(this,zs).set(e,r),r&&g(this,zs).set(r.id,r),r};let Q3=OU;var ti,uf,Uw,Pr;class n0e{constructor(e=128){G(this,ti,[]);G(this,uf,!1);G(this,Uw);G(this,Pr,-1);B(this,Uw,e)}add({cmd:e,undo:t,post:r,mustExec:i,type:s=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(i&&e(),g(this,uf))return;const l={cmd:e,undo:t,post:r,type:s};if(g(this,Pr)===-1){g(this,ti).length>0&&(g(this,ti).length=0),B(this,Pr,0),g(this,ti).push(l);return}if(a&&g(this,ti)[g(this,Pr)].type===s){o&&(l.undo=g(this,ti)[g(this,Pr)].undo),g(this,ti)[g(this,Pr)]=l;return}const u=g(this,Pr)+1;u===g(this,Uw)?g(this,ti).splice(0,1):(B(this,Pr,u),u<g(this,ti).length&&g(this,ti).splice(u)),g(this,ti).push(l)}undo(){if(g(this,Pr)===-1)return;B(this,uf,!0);const{undo:e,post:t}=g(this,ti)[g(this,Pr)];e(),t==null||t(),B(this,uf,!1),B(this,Pr,g(this,Pr)-1)}redo(){if(g(this,Pr)<g(this,ti).length-1){B(this,Pr,g(this,Pr)+1),B(this,uf,!0);const{cmd:e,post:t}=g(this,ti)[g(this,Pr)];e(),t==null||t(),B(this,uf,!1)}}hasSomethingToUndo(){return g(this,Pr)!==-1}hasSomethingToRedo(){return g(this,Pr)<g(this,ti).length-1}cleanType(e){if(g(this,Pr)!==-1){for(let t=g(this,Pr);t>=0;t--)if(g(this,ti)[t].type!==e){g(this,ti).splice(t+1,g(this,Pr)-t),B(this,Pr,t);return}g(this,ti).length=0,B(this,Pr,-1)}}destroy(){B(this,ti,null)}}ti=new WeakMap,uf=new WeakMap,Uw=new WeakMap,Pr=new WeakMap;var s2,zQ;class qS{constructor(e){G(this,s2);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Ts.platform;for(const[r,i,s={}]of e)for(const a of r){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:i,options:s}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:i,options:s}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const r=this.callbacks.get(X(this,s2,zQ).call(this,t));if(!r)return;const{callback:i,options:{bubbles:s=!1,args:a=[],checker:o=null}}=r;o&&!o(e,t)||(i.bind(e,...a,t)(),s||Yr(t))}}s2=new WeakSet,zQ=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const a2=class a2{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return Kve(e),Kt(this,"_colors",e)}convert(e){const t=jS(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[r,i]of this._colors)if(i.every((s,a)=>s===t[a]))return a2._colorsMapping.get(r);return t}getHexCode(e){const t=this._colors.get(e);return t?yt.makeHexColor(...t):e}};Qe(a2,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Z3=a2;var Fy,uo,Ly,Hr,Ti,Oy,nl,ky,rl,$s,cf,hf,By,df,ku,il,Qm,Vw,zw,Uy,$w,Bu,ff,Vy,pf,Uu,o2,mf,zy,Hw,gf,Zm,$y,vf,Gw,mi,Gn,rh,yf,xf,jw,Hy,qw,bf,Vu,ih,Ww,Xw,sl,ot,AM,J3,$Q,HQ,q_,GQ,jQ,qQ,eF,WQ,XQ,KQ,YQ,ca,Kc,QQ,ZQ,tF,JQ,W_,nF;const ly=class ly{constructor(e,t,r,i,s,a,o,l,u,c,h,d,f,p,m,y){G(this,ot);G(this,Fy,new AbortController);G(this,uo,null);G(this,Ly,null);G(this,Hr,new Map);G(this,Ti,new Map);G(this,Oy,null);G(this,nl,null);G(this,ky,null);G(this,rl,new n0e);G(this,$s,null);G(this,cf,null);G(this,hf,null);G(this,By,0);G(this,df,new Set);G(this,ku,null);G(this,il,null);G(this,Qm,new Set);Qe(this,"_editorUndoBar",null);G(this,Vw,!1);G(this,zw,!1);G(this,Uy,!1);G(this,$w,null);G(this,Bu,null);G(this,ff,null);G(this,Vy,null);G(this,pf,!1);G(this,Uu,null);G(this,o2,new t0e);G(this,mf,!1);G(this,zy,!1);G(this,Hw,!1);G(this,gf,null);G(this,Zm,null);G(this,$y,null);G(this,vf,null);G(this,Gw,null);G(this,mi,Jt.NONE);G(this,Gn,new Set);G(this,rh,null);G(this,yf,null);G(this,xf,null);G(this,jw,null);G(this,Hy,null);G(this,qw,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});G(this,bf,[0,0]);G(this,Vu,null);G(this,ih,null);G(this,Ww,null);G(this,Xw,null);G(this,sl,null);const v=this._signal=g(this,Fy).signal;B(this,ih,e),B(this,Ww,t),B(this,Xw,r),B(this,Oy,i),B(this,$s,s),B(this,yf,a),B(this,Hy,l),this._eventBus=o,o._on("editingaction",this.onEditingAction.bind(this),{signal:v}),o._on("pagechanging",this.onPageChanging.bind(this),{signal:v}),o._on("scalechanging",this.onScaleChanging.bind(this),{signal:v}),o._on("rotationchanging",this.onRotationChanging.bind(this),{signal:v}),o._on("setpreference",this.onSetPreference.bind(this),{signal:v}),o._on("switchannotationeditorparams",b=>this.updateParams(b.type,b.value),{signal:v}),window.addEventListener("pointerdown",()=>{B(this,zy,!0)},{capture:!0,signal:v}),window.addEventListener("pointerup",()=>{B(this,zy,!1)},{capture:!0,signal:v}),X(this,ot,GQ).call(this),X(this,ot,YQ).call(this),X(this,ot,eF).call(this),B(this,nl,l.annotationStorage),B(this,$w,l.filterFactory),B(this,xf,u),B(this,Vy,c||null),B(this,Vw,h),B(this,zw,d),B(this,Uy,f),B(this,Gw,p||null),this.viewParameters={realScale:Ip.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=m||null,this._supportsPinchToZoom=y!==!1,s==null||s.setSidebarUiManager(this)}static get _keyboardManager(){const e=ly.prototype,t=a=>g(a,ih).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),r=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},i=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Kt(this,"_keyboardManager",new qS([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:r}],[["ctrl+z","mac+meta+z"],e.undo,{checker:r}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:r}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:r}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&g(a,ih).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&g(a,ih).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}]]))}destroy(){var e,t,r,i,s,a,o,l,u;(e=g(this,sl))==null||e.resolve(),B(this,sl,null),(t=g(this,Fy))==null||t.abort(),B(this,Fy,null),this._signal=null;for(const c of g(this,Ti).values())c.destroy();g(this,Ti).clear(),g(this,Hr).clear(),g(this,Qm).clear(),(r=g(this,vf))==null||r.clear(),B(this,uo,null),g(this,Gn).clear(),g(this,rl).destroy(),(i=g(this,Oy))==null||i.destroy(),(s=g(this,$s))==null||s.destroy(),(a=g(this,yf))==null||a.destroy(),(o=g(this,Uu))==null||o.hide(),B(this,Uu,null),(l=g(this,$y))==null||l.destroy(),B(this,$y,null),B(this,Ly,null),g(this,Bu)&&(clearTimeout(g(this,Bu)),B(this,Bu,null)),g(this,Vu)&&(clearTimeout(g(this,Vu)),B(this,Vu,null)),(u=this._editorUndoBar)==null||u.destroy(),B(this,Hy,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return g(this,Gw)}get useNewAltTextFlow(){return g(this,zw)}get useNewAltTextWhenAddingImage(){return g(this,Uy)}get hcmFilter(){return Kt(this,"hcmFilter",g(this,xf)?g(this,$w).addHCMFilter(g(this,xf).foreground,g(this,xf).background):"none")}get direction(){return Kt(this,"direction",getComputedStyle(g(this,ih)).direction)}get _highlightColors(){return Kt(this,"_highlightColors",g(this,Vy)?new Map(g(this,Vy).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Kt(this,"highlightColors",null);const t=new Map,r=!!g(this,xf);for(const[i,s]of e){const a=i.endsWith("_HCM");if(r&&a){t.set(i.replace("_HCM",""),s);continue}!r&&!a&&t.set(i,s)}return Kt(this,"highlightColors",t)}get highlightColorNames(){return Kt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),B(this,hf,e)}setMainHighlightColorPicker(e){B(this,$y,e)}editAltText(e,t=!1){var r;(r=g(this,Oy))==null||r.editAltText(this,e,t)}hasCommentManager(){return!!g(this,$s)}editComment(e,t,r,i){var s;(s=g(this,$s))==null||s.showDialog(this,e,t,r,i)}selectComment(e,t){const r=g(this,Ti).get(e),i=r==null?void 0:r.getEditorByUID(t);i==null||i.toggleComment(!0,!0)}updateComment(e){var t;(t=g(this,$s))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=g(this,$s))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=g(this,$s))==null||t.removeComments([e.uid])}toggleComment(e,t,r=void 0){var i;(i=g(this,$s))==null||i.toggleCommentPopup(e,t,r)}makeCommentColor(e,t){var r;return e&&((r=g(this,$s))==null?void 0:r.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=g(this,$s))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(g(this,Ti).has(e-1))return;const{resolve:t,promise:r}=Promise.withResolvers(),i=s=>{s.pageNumber===e&&(this._eventBus._off("editorsrendered",i),t())};this._eventBus.on("editorsrendered",i),await r}getSignature(e){var t;(t=g(this,yf))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return g(this,yf)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":B(this,Uy,t);break}}onPageChanging({pageNumber:e}){B(this,By,e-1)}focusMainContainer(){g(this,ih).focus()}findParent(e,t){for(const r of g(this,Ti).values()){const{x:i,y:s,width:a,height:o}=r.div.getBoundingClientRect();if(e>=i&&e<=i+a&&t>=s&&t<=s+o)return r}return null}disableUserSelect(e=!1){g(this,Ww).classList.toggle("noUserSelect",e)}addShouldRescale(e){g(this,Qm).add(e)}removeShouldRescale(e){g(this,Qm).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Ip.PDF_TO_CSS_UNITS;for(const r of g(this,Qm))r.onScaleChanging();(t=g(this,hf))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const r=document.getSelection();if(!r||r.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:a,focusOffset:o}=r,l=r.toString(),c=X(this,ot,AM).call(this,r).closest(".textLayer"),h=this.getSelectionBoxes(c);if(!h)return;r.empty();const d=X(this,ot,J3).call(this,c),f=g(this,mi)===Jt.NONE,p=()=>{const m=d==null?void 0:d.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:i,anchorOffset:s,focusNode:a,focusOffset:o,text:l});f&&this.showAllEditors("highlight",!0,!0),t&&(m==null||m.editComment())};if(f){this.switchToMode(Jt.HIGHLIGHT,p);return}p()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!g(this,nl))return null;const t=`${yw}${e}`,r=g(this,nl).getRawValue(t);return r&&g(this,nl).remove(t),r}addToAnnotationStorage(e){!e.isEmpty()&&g(this,nl)&&!g(this,nl).has(e.id)&&g(this,nl).setValue(e.id,e)}a11yAlert(e,t=null){const r=g(this,Xw);r&&(r.setAttribute("data-l10n-id",e),t?r.setAttribute("data-l10n-args",JSON.stringify(t)):r.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,g(this,pf)&&(B(this,pf,!1),X(this,ot,q_).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of g(this,Gn))if(t.div.contains(e)){B(this,Zm,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!g(this,Zm))return;const[e,t]=g(this,Zm);B(this,Zm,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){X(this,ot,eF).call(this),this.setEditingState(!0)}removeEditListeners(){X(this,ot,WQ).call(this),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const r of g(this,il))if(r.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const r of g(this,il))if(r.isHandlingMimeForPasting(t.type)){r.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var r;if(e.preventDefault(),(r=g(this,uo))==null||r.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of g(this,Gn)){const s=i.serialize(!0);s&&t.push(s)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const s of t.items)for(const a of g(this,il))if(a.isHandlingMimeForPasting(s.type)){a.paste(s,this.currentLayer);return}let r=t.getData("application/pdfjs");if(!r)return;try{r=JSON.parse(r)}catch(s){Xt(`paste: "${s.message}".`);return}if(!Array.isArray(r))return;this.unselectAll();const i=this.currentLayer;try{const s=[];for(const l of r){const u=await i.deserialize(l);if(!u)return;s.push(u)}const a=()=>{for(const l of s)X(this,ot,tF).call(this,l);X(this,ot,nF).call(this,s)},o=()=>{for(const l of s)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(s){Xt(`paste: "${s.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),g(this,mi)!==Jt.NONE&&!this.isEditorHandlingKeyboard&&ly._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,g(this,pf)&&(B(this,pf,!1),X(this,ot,q_).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(X(this,ot,jQ).call(this),X(this,ot,XQ).call(this),X(this,ot,ca).call(this,{isEditing:g(this,mi)!==Jt.NONE,isEmpty:X(this,ot,W_).call(this),hasSomethingToUndo:g(this,rl).hasSomethingToUndo(),hasSomethingToRedo:g(this,rl).hasSomethingToRedo(),hasSelectedEditor:!1})):(X(this,ot,qQ).call(this),X(this,ot,KQ).call(this),X(this,ot,ca).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!g(this,il)){B(this,il,e);for(const t of g(this,il))X(this,ot,Kc).call(this,t.defaultPropertiesToUpdate)}}getId(){return g(this,o2).id}get currentLayer(){return g(this,Ti).get(g(this,By))}getLayer(e){return g(this,Ti).get(e)}get currentPageIndex(){return g(this,By)}addLayer(e){g(this,Ti).set(e.pageIndex,e),g(this,mf)?e.enable():e.disable()}removeLayer(e){g(this,Ti).delete(e.pageIndex)}async updateMode(e,t=null,r=!1,i=!1,s=!1){var a,o,l,u,c,h;if(g(this,mi)!==e&&!(g(this,sl)&&(await g(this,sl).promise,!g(this,sl)))){if(B(this,sl,Promise.withResolvers()),(a=g(this,hf))==null||a.commitOrRemove(),g(this,mi)===Jt.POPUP&&((o=g(this,$s))==null||o.hideSidebar()),(l=g(this,$s))==null||l.destroyPopup(),B(this,mi,e),e===Jt.NONE){this.setEditingState(!1),X(this,ot,ZQ).call(this);for(const d of g(this,Hr).values())d.hideStandaloneCommentButton();(u=this._editorUndoBar)==null||u.hide(),this.toggleComment(null),g(this,sl).resolve();return}for(const d of g(this,Hr).values())d.addStandaloneCommentButton();e===Jt.SIGNATURE&&await((c=g(this,yf))==null?void 0:c.loadSignatures()),this.setEditingState(!0),await X(this,ot,QQ).call(this),this.unselectAll();for(const d of g(this,Ti).values())d.updateMode(e);if(e===Jt.POPUP){g(this,Ly)||B(this,Ly,await g(this,Hy).getAnnotationsByType(new Set(g(this,il).map(p=>p._editorType))));const d=new Set,f=[];for(const p of g(this,Hr).values()){const{annotationElementId:m,hasComment:y,deleted:v}=p;m&&d.add(m),y&&!v&&f.push(p.getData())}for(const p of g(this,Ly)){const{id:m,popupRef:y,contentsObj:v}=p;y&&(v!=null&&v.str)&&!d.has(m)&&!g(this,df).has(m)&&f.push(p)}(h=g(this,$s))==null||h.showSidebar(f)}if(!t){r&&this.addNewEditorFromKeyboard(),g(this,sl).resolve();return}for(const d of g(this,Hr).values())d.uid===t?(this.setSelected(d),s?d.editComment():i?d.enterInEditMode():d.focus()):d.unselect();g(this,sl).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==g(this,mi)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(g(this,il)){switch(e){case En.CREATE:this.currentLayer.addNewEditor(t);return;case En.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(g(this,jw)||B(this,jw,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const r of g(this,Gn))r.updateParams(e,t);else for(const r of g(this,il))r.updateDefaultParams(e,t)}}showAllEditors(e,t,r=!1){var s;for(const a of g(this,Hr).values())a.editorType===e&&a.show(t);(((s=g(this,jw))==null?void 0:s.get(En.HIGHLIGHT_SHOW_ALL))??!0)!==t&&X(this,ot,Kc).call(this,[[En.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(g(this,Hw)!==e){B(this,Hw,e);for(const t of g(this,Ti).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of g(this,Hr).values())t.pageIndex===e&&(yield t)}getEditor(e){return g(this,Hr).get(e)}addEditor(e){g(this,Hr).set(e.id,e)}removeEditor(e){var t,r;e.div.contains(document.activeElement)&&(g(this,Bu)&&clearTimeout(g(this,Bu)),B(this,Bu,setTimeout(()=>{this.focusMainContainer(),B(this,Bu,null)},0))),g(this,Hr).delete(e.id),e.annotationElementId&&((t=g(this,vf))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!g(this,df).has(e.annotationElementId))&&((r=g(this,nl))==null||r.remove(e.id))}addDeletedAnnotationElement(e){g(this,df).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return g(this,df).has(e)}removeDeletedAnnotationElement(e){g(this,df).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){g(this,uo)!==e&&(B(this,uo,e),e&&X(this,ot,Kc).call(this,e.propertiesToUpdate))}updateUI(e){g(this,ot,JQ)===e&&X(this,ot,Kc).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){X(this,ot,Kc).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(g(this,Gn).has(e)){g(this,Gn).delete(e),e.unselect(),X(this,ot,ca).call(this,{hasSelectedEditor:this.hasSelection});return}g(this,Gn).add(e),e.select(),X(this,ot,Kc).call(this,e.propertiesToUpdate),X(this,ot,ca).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.uid}),(t=g(this,hf))==null||t.commitOrRemove();for(const r of g(this,Gn))r!==e&&r.unselect();g(this,Gn).clear(),g(this,Gn).add(e),e.select(),X(this,ot,Kc).call(this,e.propertiesToUpdate),X(this,ot,ca).call(this,{hasSelectedEditor:!0})}isSelected(e){return g(this,Gn).has(e)}get firstSelectedEditor(){return g(this,Gn).values().next().value}unselect(e){e.unselect(),g(this,Gn).delete(e),X(this,ot,ca).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return g(this,Gn).size!==0}get isEnterHandled(){return g(this,Gn).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;g(this,rl).undo(),X(this,ot,ca).call(this,{hasSomethingToUndo:g(this,rl).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:X(this,ot,W_).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){g(this,rl).redo(),X(this,ot,ca).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:g(this,rl).hasSomethingToRedo(),isEmpty:X(this,ot,W_).call(this)})}addCommands(e){g(this,rl).add(e),X(this,ot,ca).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:X(this,ot,W_).call(this)})}cleanUndoStack(e){g(this,rl).cleanType(e)}delete(){var s;this.commitOrRemove();const e=(s=this.currentLayer)==null?void 0:s.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...g(this,Gn)],r=()=>{var a;(a=this._editorUndoBar)==null||a.show(i,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},i=()=>{for(const a of t)X(this,ot,tF).call(this,a)};this.addCommands({cmd:r,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=g(this,uo))==null||e.commitOrRemove()}hasSomethingToControl(){return g(this,uo)||this.hasSelection}selectAll(){for(const e of g(this,Gn))e.commit();X(this,ot,nF).call(this,g(this,Hr).values())}unselectAll(){var e;if(!(g(this,uo)&&(g(this,uo).commitOrRemove(),g(this,mi)!==Jt.NONE))&&!((e=g(this,hf))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of g(this,Gn))t.unselect();g(this,Gn).clear(),X(this,ot,ca).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,r=!1){if(r||this.commitOrRemove(),!this.hasSelection)return;g(this,bf)[0]+=e,g(this,bf)[1]+=t;const[i,s]=g(this,bf),a=[...g(this,Gn)],o=1e3;g(this,Vu)&&clearTimeout(g(this,Vu)),B(this,Vu,setTimeout(()=>{B(this,Vu,null),g(this,bf)[0]=g(this,bf)[1]=0,this.addCommands({cmd:()=>{for(const l of a)g(this,Hr).has(l.id)&&(l.translateInPage(i,s),l.translationDone())},undo:()=>{for(const l of a)g(this,Hr).has(l.id)&&(l.translateInPage(-i,-s),l.translationDone())},mustExec:!1})},o));for(const l of a)l.translateInPage(e,t),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),B(this,ku,new Map);for(const e of g(this,Gn))g(this,ku).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!g(this,ku))return!1;this.disableUserSelect(!1);const e=g(this,ku);B(this,ku,null);let t=!1;for(const[{x:i,y:s,pageIndex:a},o]of e)o.newX=i,o.newY=s,o.newPageIndex=a,t||(t=i!==o.savedX||s!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const r=(i,s,a,o)=>{if(g(this,Hr).has(i.id)){const l=g(this,Ti).get(o);l?i._setParentAndPosition(l,s,a):(i.pageIndex=o,i.x=s,i.y=a)}};return this.addCommands({cmd:()=>{for(const[i,{newX:s,newY:a,newPageIndex:o}]of e)r(i,s,a,o)},undo:()=>{for(const[i,{savedX:s,savedY:a,savedPageIndex:o}]of e)r(i,s,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(g(this,ku))for(const r of g(this,ku).keys())r.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||g(this,Gn).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return g(this,uo)===e}getActive(){return g(this,uo)}getMode(){return g(this,mi)}isEditingMode(){return g(this,mi)!==Jt.NONE}get imageManager(){return Kt(this,"imageManager",new Q3)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,c=t.rangeCount;u<c;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:r,y:i,width:s,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(u,c,h,d)=>({x:(c-i)/a,y:1-(u+h-r)/s,width:d/a,height:h/s});break;case"180":o=(u,c,h,d)=>({x:1-(u+h-r)/s,y:1-(c+d-i)/a,width:h/s,height:d/a});break;case"270":o=(u,c,h,d)=>({x:1-(c+d-i)/a,y:(u-r)/s,width:d/a,height:h/s});break;default:o=(u,c,h,d)=>({x:(u-r)/s,y:(c-i)/a,width:h/s,height:d/a});break}const l=[];for(let u=0,c=t.rangeCount;u<c;u++){const h=t.getRangeAt(u);if(!h.collapsed)for(const{x:d,y:f,width:p,height:m}of h.getClientRects())p===0||m===0||l.push(o(d,f,p,m))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(g(this,ky)||B(this,ky,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=g(this,ky))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=g(this,ky))==null?void 0:i.get(e.data.id);if(!t)return;const r=g(this,nl).getRawValue(t);r&&(g(this,mi)===Jt.NONE&&!r.hasBeenModified||r.renderAnnotationElement(e))}setMissingCanvas(e,t,r){var s;const i=(s=g(this,vf))==null?void 0:s.get(e);i&&(i.setCanvas(t,r),g(this,vf).delete(e))}addMissingCanvas(e,t){(g(this,vf)||B(this,vf,new Map)).set(e,t)}};Fy=new WeakMap,uo=new WeakMap,Ly=new WeakMap,Hr=new WeakMap,Ti=new WeakMap,Oy=new WeakMap,nl=new WeakMap,ky=new WeakMap,rl=new WeakMap,$s=new WeakMap,cf=new WeakMap,hf=new WeakMap,By=new WeakMap,df=new WeakMap,ku=new WeakMap,il=new WeakMap,Qm=new WeakMap,Vw=new WeakMap,zw=new WeakMap,Uy=new WeakMap,$w=new WeakMap,Bu=new WeakMap,ff=new WeakMap,Vy=new WeakMap,pf=new WeakMap,Uu=new WeakMap,o2=new WeakMap,mf=new WeakMap,zy=new WeakMap,Hw=new WeakMap,gf=new WeakMap,Zm=new WeakMap,$y=new WeakMap,vf=new WeakMap,Gw=new WeakMap,mi=new WeakMap,Gn=new WeakMap,rh=new WeakMap,yf=new WeakMap,xf=new WeakMap,jw=new WeakMap,Hy=new WeakMap,qw=new WeakMap,bf=new WeakMap,Vu=new WeakMap,ih=new WeakMap,Ww=new WeakMap,Xw=new WeakMap,sl=new WeakMap,ot=new WeakSet,AM=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},J3=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const r of g(this,Ti).values())if(r.hasTextLayer(e))return r;return null},$Q=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const r=X(this,ot,AM).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(r);i&&(g(this,Uu)||B(this,Uu,new e0e(this)),g(this,Uu).show(r,i,this.direction==="ltr"))},HQ=function(){var s,a,o;const e=document.getSelection();if(!e||e.isCollapsed){g(this,rh)&&((s=g(this,Uu))==null||s.hide(),B(this,rh,null),X(this,ot,ca).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===g(this,rh))return;const i=X(this,ot,AM).call(this,e).closest(".textLayer");if(!i){g(this,rh)&&((a=g(this,Uu))==null||a.hide(),B(this,rh,null),X(this,ot,ca).call(this,{hasSelectedText:!1}));return}if((o=g(this,Uu))==null||o.hide(),B(this,rh,t),X(this,ot,ca).call(this,{hasSelectedText:!0}),!(g(this,mi)!==Jt.HIGHLIGHT&&g(this,mi)!==Jt.NONE)&&(g(this,mi)===Jt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),B(this,pf,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=g(this,mi)===Jt.HIGHLIGHT?X(this,ot,J3).call(this,i):null;if(l==null||l.toggleDrawing(),g(this,zy)){const u=new AbortController,c=this.combinedSignal(u),h=d=>{d.type==="pointerup"&&d.button!==0||(u.abort(),l==null||l.toggleDrawing(!0),d.type==="pointerup"&&X(this,ot,q_).call(this,"main_toolbar"))};window.addEventListener("pointerup",h,{signal:c}),window.addEventListener("blur",h,{signal:c})}else l==null||l.toggleDrawing(!0),X(this,ot,q_).call(this,"main_toolbar")}},q_=function(e=""){g(this,mi)===Jt.HIGHLIGHT?this.highlightSelection(e):g(this,Vw)&&X(this,ot,$Q).call(this)},GQ=function(){document.addEventListener("selectionchange",X(this,ot,HQ).bind(this),{signal:this._signal})},jQ=function(){if(g(this,ff))return;B(this,ff,new AbortController);const e=this.combinedSignal(g(this,ff));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},qQ=function(){var e;(e=g(this,ff))==null||e.abort(),B(this,ff,null)},eF=function(){if(g(this,gf))return;B(this,gf,new AbortController);const e=this.combinedSignal(g(this,gf));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},WQ=function(){var e;(e=g(this,gf))==null||e.abort(),B(this,gf,null)},XQ=function(){if(g(this,cf))return;B(this,cf,new AbortController);const e=this.combinedSignal(g(this,cf));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},KQ=function(){var e;(e=g(this,cf))==null||e.abort(),B(this,cf,null)},YQ=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},ca=function(e){Object.entries(e).some(([r,i])=>g(this,qw)[r]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(g(this,qw),e)}),g(this,mi)===Jt.HIGHLIGHT&&e.hasSelectedEditor===!1&&X(this,ot,Kc).call(this,[[En.HIGHLIGHT_FREE,!0]]))},Kc=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},QQ=async function(){if(!g(this,mf)){B(this,mf,!0);const e=[];for(const t of g(this,Ti).values())e.push(t.enable());await Promise.all(e);for(const t of g(this,Hr).values())t.enable()}},ZQ=function(){if(this.unselectAll(),g(this,mf)){B(this,mf,!1);for(const e of g(this,Ti).values())e.disable();for(const e of g(this,Hr).values())e.disable()}},tF=function(e){const t=g(this,Ti).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},JQ=function(){let e=null;for(e of g(this,Gn));return e},W_=function(){if(g(this,Hr).size===0)return!0;if(g(this,Hr).size===1)for(const e of g(this,Hr).values())return e.isEmpty();return!1},nF=function(e){for(const t of g(this,Gn))t.unselect();g(this,Gn).clear();for(const t of e)t.isEmpty()||(g(this,Gn).add(t),t.select());X(this,ot,ca).call(this,{hasSelectedEditor:this.hasSelection})},Qe(ly,"TRANSLATE_SMALL",1),Qe(ly,"TRANSLATE_BIG",10);let Tv=ly;var Xi,zu,Gl,Gy,$u,co,jy,Hu,Oa,sh,Jm,Gu,_f,uu,X_,TM;const da=class da{constructor(e){G(this,uu);G(this,Xi,null);G(this,zu,!1);G(this,Gl,null);G(this,Gy,null);G(this,$u,null);G(this,co,null);G(this,jy,!1);G(this,Hu,null);G(this,Oa,null);G(this,sh,null);G(this,Jm,null);G(this,Gu,!1);B(this,Oa,e),B(this,Gu,e._uiManager.useNewAltTextFlow),g(da,_f)||B(da,_f,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){da._l10n??(da._l10n=e)}async render(){const e=B(this,Gl,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=B(this,Gy,document.createElement("span"));e.append(t),g(this,Gu)?(e.classList.add("new"),e.setAttribute("data-l10n-id",g(da,_f).missing),t.setAttribute("data-l10n-id",g(da,_f)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const r=g(this,Oa)._uiManager._signal;e.addEventListener("contextmenu",Cl,{signal:r}),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:r});const i=s=>{s.preventDefault(),g(this,Oa)._uiManager.editAltText(g(this,Oa)),g(this,Gu)&&g(this,Oa)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:g(this,uu,X_)}})};return e.addEventListener("click",i,{capture:!0,signal:r}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(B(this,jy,!0),i(s))},{signal:r}),await X(this,uu,TM).call(this),e}finish(){g(this,Gl)&&(g(this,Gl).focus({focusVisible:g(this,jy)}),B(this,jy,!1))}isEmpty(){return g(this,Gu)?g(this,Xi)===null:!g(this,Xi)&&!g(this,zu)}hasData(){return g(this,Gu)?g(this,Xi)!==null||!!g(this,sh):this.isEmpty()}get guessedText(){return g(this,sh)}async setGuessedText(e){g(this,Xi)===null&&(B(this,sh,e),B(this,Jm,await da._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),X(this,uu,TM).call(this))}toggleAltTextBadge(e=!1){var t;if(!g(this,Gu)||g(this,Xi)){(t=g(this,Hu))==null||t.remove(),B(this,Hu,null);return}if(!g(this,Hu)){const r=B(this,Hu,document.createElement("div"));r.className="noAltTextBadge",g(this,Oa).div.append(r)}g(this,Hu).classList.toggle("hidden",!e)}serialize(e){let t=g(this,Xi);return!e&&g(this,sh)===t&&(t=g(this,Jm)),{altText:t,decorative:g(this,zu),guessedText:g(this,sh),textWithDisclaimer:g(this,Jm)}}get data(){return{altText:g(this,Xi),decorative:g(this,zu)}}set data({altText:e,decorative:t,guessedText:r,textWithDisclaimer:i,cancel:s=!1}){r&&(B(this,sh,r),B(this,Jm,i)),!(g(this,Xi)===e&&g(this,zu)===t)&&(s||(B(this,Xi,e),B(this,zu,t)),X(this,uu,TM).call(this))}toggle(e=!1){g(this,Gl)&&(!e&&g(this,co)&&(clearTimeout(g(this,co)),B(this,co,null)),g(this,Gl).disabled=!e)}shown(){g(this,Oa)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:g(this,uu,X_)}})}destroy(){var e,t;(e=g(this,Gl))==null||e.remove(),B(this,Gl,null),B(this,Gy,null),B(this,$u,null),(t=g(this,Hu))==null||t.remove(),B(this,Hu,null)}};Xi=new WeakMap,zu=new WeakMap,Gl=new WeakMap,Gy=new WeakMap,$u=new WeakMap,co=new WeakMap,jy=new WeakMap,Hu=new WeakMap,Oa=new WeakMap,sh=new WeakMap,Jm=new WeakMap,Gu=new WeakMap,_f=new WeakMap,uu=new WeakSet,X_=function(){return g(this,Xi)&&"added"||g(this,Xi)===null&&this.guessedText&&"review"||"missing"},TM=async function(){var i,s,a;const e=g(this,Gl);if(!e)return;if(g(this,Gu)){if(e.classList.toggle("done",!!g(this,Xi)),e.setAttribute("data-l10n-id",g(da,_f)[g(this,uu,X_)]),(i=g(this,Gy))==null||i.setAttribute("data-l10n-id",g(da,_f)[`${g(this,uu,X_)}-label`]),!g(this,Xi)){(s=g(this,$u))==null||s.remove();return}}else{if(!g(this,Xi)&&!g(this,zu)){e.classList.remove("done"),(a=g(this,$u))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=g(this,$u);if(!t){B(this,$u,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${g(this,Oa).id}`;const o=100,l=g(this,Oa)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(g(this,co)),B(this,co,null)},{once:!0}),e.addEventListener("mouseenter",()=>{B(this,co,setTimeout(()=>{B(this,co,null),g(this,$u).classList.add("show"),g(this,Oa)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),e.addEventListener("mouseleave",()=>{var u;g(this,co)&&(clearTimeout(g(this,co)),B(this,co,null)),(u=g(this,$u))==null||u.classList.remove("show")},{signal:l})}g(this,zu)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=g(this,Xi)),t.parentNode||e.append(t);const r=g(this,Oa).getElementForAltText();r==null||r.setAttribute("aria-describedby",t.id)},G(da,_f,null),Qe(da,"_l10n",null);let sD=da;var cs,al,eg,vr,Kw,tg,jl,ng,rg,ig,Yw,rF;class YA{constructor(e){G(this,Yw);G(this,cs,null);G(this,al,null);G(this,eg,!1);G(this,vr,null);G(this,Kw,null);G(this,tg,null);G(this,jl,null);G(this,ng,null);G(this,rg,!1);G(this,ig,null);B(this,vr,e)}renderForToolbar(){const e=B(this,al,document.createElement("button"));return e.className="comment",X(this,Yw,rF).call(this,e,!1)}renderForStandalone(){const e=B(this,cs,document.createElement("button"));e.className="annotationCommentButton";const t=g(this,vr).commentButtonPosition;if(t){const{style:r}=e;r.insetInlineEnd=`calc(${100*(g(this,vr)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,r.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const i=g(this,vr).commentButtonColor;i&&(r.backgroundColor=i)}return X(this,Yw,rF).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=g(this,cs)??g(this,al))==null||e.focus()},0)}onUpdatedColor(){if(!g(this,cs))return;const e=g(this,vr).commentButtonColor;e&&(g(this,cs).style.backgroundColor=e),g(this,vr)._uiManager.updatePopupColor(g(this,vr))}get commentButtonWidth(){var e;return(((e=g(this,cs))==null?void 0:e.getBoundingClientRect().width)??0)/g(this,vr).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(g(this,ig))return g(this,ig);if(!g(this,cs))return null;const{x:e,y:t,height:r}=g(this,cs).getBoundingClientRect(),{x:i,y:s,width:a,height:o}=g(this,vr).parent.boundingClientRect;return[(e-i)/a,(t+r-s)/o]}set commentPopupPositionInLayer(e){B(this,ig,e)}hasDefaultPopupPosition(){return g(this,ig)===null}removeStandaloneCommentButton(){var e;(e=g(this,cs))==null||e.remove(),B(this,cs,null)}removeToolbarCommentButton(){var e;(e=g(this,al))==null||e.remove(),B(this,al,null)}setCommentButtonStates({selected:e,hasPopup:t}){g(this,cs)&&(g(this,cs).classList.toggle("selected",e),g(this,cs).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let r,i;if(t)[r,i]=t;else{[r,i]=g(this,vr).commentButtonPosition;const{width:c,height:h,x:d,y:f}=g(this,vr);r=d+r*c,i=f+i*h}const s=g(this,vr).parent.boundingClientRect,{x:a,y:o,width:l,height:u}=s;g(this,vr)._uiManager.editComment(g(this,vr),a+r*l,o+i*u,{...e,parentDimensions:s})}finish(){g(this,al)&&(g(this,al).focus({focusVisible:g(this,eg)}),B(this,eg,!1))}isDeleted(){return g(this,rg)||g(this,jl)===""}isEmpty(){return g(this,jl)===null}hasBeenEdited(){return this.isDeleted()||g(this,jl)!==g(this,Kw)}serialize(){return this.data}get data(){return{text:g(this,jl),richText:g(this,tg),date:g(this,ng),deleted:this.isDeleted()}}set data(e){if(e!==g(this,jl)&&B(this,tg,null),e===null){B(this,jl,""),B(this,rg,!0);return}B(this,jl,e),B(this,ng,new Date),B(this,rg,!1)}setInitialText(e,t=null){B(this,Kw,e),this.data=e,B(this,ng,null),B(this,tg,t)}shown(){}destroy(){var e,t;(e=g(this,al))==null||e.remove(),B(this,al,null),(t=g(this,cs))==null||t.remove(),B(this,cs,null),B(this,jl,""),B(this,tg,null),B(this,ng,null),B(this,vr,null),B(this,eg,!1),B(this,rg,!1)}}cs=new WeakMap,al=new WeakMap,eg=new WeakMap,vr=new WeakMap,Kw=new WeakMap,tg=new WeakMap,jl=new WeakMap,ng=new WeakMap,rg=new WeakMap,ig=new WeakMap,Yw=new WeakSet,rF=function(e,t){if(!g(this,vr)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[g(this,vr)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const r=g(this,vr)._uiManager._signal;if(!(r instanceof AbortSignal)||r.aborted)return e;e.addEventListener("contextmenu",Cl,{signal:r}),t&&(e.addEventListener("focusin",s=>{g(this,vr)._focusEventsAllowed=!1,Yr(s)},{capture:!0,signal:r}),e.addEventListener("focusout",s=>{g(this,vr)._focusEventsAllowed=!0,Yr(s)},{capture:!0,signal:r})),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:r});const i=s=>{s.preventDefault(),e===g(this,al)?this.edit():g(this,vr).toggleComment(!0)};return e.addEventListener("click",i,{capture:!0,signal:r}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(B(this,eg,!0),i(s))},{signal:r}),e.addEventListener("pointerenter",()=>{g(this,vr).toggleComment(!1,!0)},{signal:r}),e.addEventListener("pointerleave",()=>{g(this,vr).toggleComment(!1,!1)},{signal:r}),e};var qy,sg,Qw,Zw,Jw,eE,tE,ah,ag,oh,og,lh,Bp,eZ,tZ,nZ;const kU=class kU{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:r=null,onPinchStart:i=null,onPinching:s=null,onPinchEnd:a=null,signal:o}){G(this,Bp);G(this,qy);G(this,sg,!1);G(this,Qw,null);G(this,Zw);G(this,Jw);G(this,eE);G(this,tE);G(this,ah,null);G(this,ag);G(this,oh,null);G(this,og);G(this,lh,null);B(this,qy,e),B(this,Qw,r),B(this,Zw,t),B(this,Jw,i),B(this,eE,s),B(this,tE,a),B(this,og,new AbortController),B(this,ag,AbortSignal.any([o,g(this,og).signal])),e.addEventListener("touchstart",X(this,Bp,eZ).bind(this),{passive:!1,signal:g(this,ag)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ac.pixelRatio}destroy(){var e,t;(e=g(this,og))==null||e.abort(),B(this,og,null),(t=g(this,ah))==null||t.abort(),B(this,ah,null)}};qy=new WeakMap,sg=new WeakMap,Qw=new WeakMap,Zw=new WeakMap,Jw=new WeakMap,eE=new WeakMap,tE=new WeakMap,ah=new WeakMap,ag=new WeakMap,oh=new WeakMap,og=new WeakMap,lh=new WeakMap,Bp=new WeakSet,eZ=function(e){var i,s,a;if((i=g(this,Zw))!=null&&i.call(this))return;if(e.touches.length===1){if(g(this,ah))return;const o=B(this,ah,new AbortController),l=AbortSignal.any([g(this,ag),o.signal]),u=g(this,qy),c={capture:!0,signal:l,passive:!1},h=d=>{var f;d.pointerType==="touch"&&((f=g(this,ah))==null||f.abort(),B(this,ah,null))};u.addEventListener("pointerdown",d=>{d.pointerType==="touch"&&(Yr(d),h(d))},c),u.addEventListener("pointerup",h,c),u.addEventListener("pointercancel",h,c);return}if(!g(this,lh)){B(this,lh,new AbortController);const o=AbortSignal.any([g(this,ag),g(this,lh).signal]),l=g(this,qy),u={signal:o,capture:!1,passive:!1};l.addEventListener("touchmove",X(this,Bp,tZ).bind(this),u);const c=X(this,Bp,nZ).bind(this);l.addEventListener("touchend",c,u),l.addEventListener("touchcancel",c,u),u.capture=!0,l.addEventListener("pointerdown",Yr,u),l.addEventListener("pointermove",Yr,u),l.addEventListener("pointercancel",Yr,u),l.addEventListener("pointerup",Yr,u),(s=g(this,Jw))==null||s.call(this)}if(Yr(e),e.touches.length!==2||(a=g(this,Qw))!=null&&a.call(this)){B(this,oh,null);return}let[t,r]=e.touches;t.identifier>r.identifier&&([t,r]=[r,t]),B(this,oh,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:r.screenX,touch1Y:r.screenY})},tZ=function(e){var w;if(!g(this,oh)||e.touches.length!==2)return;Yr(e);let[t,r]=e.touches;t.identifier>r.identifier&&([t,r]=[r,t]);const{screenX:i,screenY:s}=t,{screenX:a,screenY:o}=r,l=g(this,oh),{touch0X:u,touch0Y:c,touch1X:h,touch1Y:d}=l,f=h-u,p=d-c,m=a-i,y=o-s,v=Math.hypot(m,y)||1,b=Math.hypot(f,p)||1;if(!g(this,sg)&&Math.abs(b-v)<=kU.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=i,l.touch0Y=s,l.touch1X=a,l.touch1Y=o,!g(this,sg)){B(this,sg,!0);return}const x=[(i+a)/2,(s+o)/2];(w=g(this,eE))==null||w.call(this,x,b,v)},nZ=function(e){var t;e.touches.length>=2||(g(this,lh)&&(g(this,lh).abort(),B(this,lh,null),(t=g(this,tE))==null||t.call(this)),g(this,oh)&&(Yr(e),B(this,oh,null),B(this,sg,!1)))};let aD=kU;var lg,ql,Mr,lr,uh,Wy,wf,nE,hs,ug,ch,ol,Ef,rE,cg,ho,iE,hg,hh,ju,Xy,Ky,ll,dg,sE,l2,Rt,iF,aE,sF,MM,rZ,iZ,aF,CM,oF,sZ,aZ,oZ,lF,lZ,uF,uZ,cZ,hZ,cF,K_;const Zt=class Zt{constructor(e){G(this,Rt);G(this,lg,null);G(this,ql,null);G(this,Mr,null);G(this,lr,null);G(this,uh,null);G(this,Wy,!1);G(this,wf,null);G(this,nE,"");G(this,hs,null);G(this,ug,null);G(this,ch,null);G(this,ol,null);G(this,Ef,null);G(this,rE,"");G(this,cg,!1);G(this,ho,null);G(this,iE,!1);G(this,hg,!1);G(this,hh,!1);G(this,ju,null);G(this,Xy,0);G(this,Ky,0);G(this,ll,null);G(this,dg,null);Qe(this,"isSelected",!1);Qe(this,"_isCopy",!1);Qe(this,"_editToolbar",null);Qe(this,"_initialOptions",Object.create(null));Qe(this,"_initialData",null);Qe(this,"_isVisible",!0);Qe(this,"_uiManager",null);Qe(this,"_focusEventsAllowed",!0);G(this,sE,!1);G(this,l2,Zt._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:r,pageHeight:i,pageX:s,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[r,i],this.pageTranslation=[s,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Zt.prototype._resizeWithKeyboard,t=Tv.TRANSLATE_SMALL,r=Tv.TRANSLATE_BIG;return Kt(this,"_resizerKeyboardManager",new qS([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-r,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[r,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-r]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,r]}],[["Escape","mac+Escape"],Zt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Kt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new r0e({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Zt._l10n??(Zt._l10n=e),Zt._l10nResizer||(Zt._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Zt._borderLineWidth!==-1)return;const r=getComputedStyle(document.documentElement);Zt._borderLineWidth=parseFloat(r.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){fr("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return g(this,sE)}set _isDraggable(e){var t;B(this,sE,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=g(this,l2)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(X(this,Rt,K_).call(this),(t=g(this,ol))==null||t.remove(),B(this,ol,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(g(this,cg)?B(this,cg,!1):this.parent.setSelected(this))}focusout(e){var r;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(r=this.parent)!=null&&r.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,r,i){const[s,a]=this.parentDimensions;[r,i]=this.screenToPageTranslation(r,i),this.x=(e+r)/s,this.y=(t+i)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[r,i]=this.parentDimensions;this.setAt(e*r,t*i,this.width*r,this.height*i),this._onTranslated()}translate(e,t){X(this,Rt,iF).call(this,this.parentDimensions,e,t)}translateInPage(e,t){g(this,ho)||B(this,ho,[this.x,this.y,this.width,this.height]),X(this,Rt,iF).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){g(this,ho)||B(this,ho,[this.x,this.y,this.width,this.height]);const{div:r,parentDimensions:[i,s]}=this;if(this.x+=e/i,this.y+=t/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:h,y:d}=this.div.getBoundingClientRect();this.parent.findNewParent(this,h,d)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,u]=this.getBaseTranslation();a+=l,o+=u;const{style:c}=r;c.left=`${(100*a).toFixed(2)}%`,c.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),r.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!g(this,ho)&&(g(this,ho)[0]!==this.x||g(this,ho)[1]!==this.y)}get _hasBeenResized(){return!!g(this,ho)&&(g(this,ho)[2]!==this.width||g(this,ho)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:r}=Zt,i=r/e,s=r/t;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[r,i]}=this;let{x:s,y:a,width:o,height:l}=this;if(o*=r,l*=i,s*=r,a*=i,this._mustFixPosition)switch(e){case 0:s=va(s,0,r-o),a=va(a,0,i-l);break;case 90:s=va(s,0,r-l),a=va(a,o,i);break;case 180:s=va(s,o,r),a=va(a,l,i);break;case 270:s=va(s,l,r),a=va(a,0,i-o);break}this.x=s/=r,this.y=a/=i;const[u,c]=this.getBaseTranslation();s+=u,a+=c,t.left=`${(100*s).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var r;return X(r=Zt,aE,sF).call(r,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var r;return X(r=Zt,aE,sF).call(r,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,r]}=this;return[t*e,r*e]}setDims(){const{div:{style:e},width:t,height:r}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*r).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=g(this,Mr))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||g(this,hg))return this._editToolbar;this._editToolbar=new K3(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,r]of e)await this._editToolbar.addButton(t,r);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=g(this,Mr))==null||t.destroy()}addContainer(e){var r;const t=(r=this._editToolbar)==null?void 0:r.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return g(this,Mr)||(sD.initialize(Zt._l10n),B(this,Mr,new sD(this)),g(this,lg)&&(g(this,Mr).data=g(this,lg),B(this,lg,null))),g(this,Mr)}get altTextData(){var e;return(e=g(this,Mr))==null?void 0:e.data}set altTextData(e){g(this,Mr)&&(g(this,Mr).data=e)}get guessedAltText(){var e;return(e=g(this,Mr))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=g(this,Mr))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=g(this,Mr))==null?void 0:t.serialize(e)}hasAltText(){return!!g(this,Mr)&&!g(this,Mr).isEmpty()}hasAltTextData(){var e;return((e=g(this,Mr))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=g(this,lr))==null||e.focusButton()}addCommentButton(){return this.canAddComment?g(this,lr)||B(this,lr,new YA(this)):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(g(this,uh)){this._uiManager.isEditingMode()&&g(this,uh).classList.remove("hidden");return}this.hasComment&&(B(this,uh,g(this,lr).renderForStandalone()),this.div.append(g(this,uh)))}}removeStandaloneCommentButton(){g(this,lr).removeStandaloneCommentButton(),B(this,uh,null)}hideStandaloneCommentButton(){var e;(e=g(this,uh))==null||e.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:r,deleted:i}}=g(this,lr);return{text:t,richText:e,date:r,deleted:i,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){g(this,lr)||B(this,lr,new YA(this)),g(this,lr).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:r}){if(!t||(g(this,lr)||B(this,lr,new YA(this)),g(this,lr).setInitialText(e,r),!this.annotationElementId))return;const i=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);i&&this.updateFromAnnotationLayer(i)}get hasEditedComment(){var e;return(e=g(this,lr))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=g(this,lr))==null?void 0:e.isDeleted()}get hasComment(){return!!g(this,lr)&&!g(this,lr).isEmpty()&&!g(this,lr).isDeleted()}async editComment(e){g(this,lr)||B(this,lr,new YA(this)),g(this,lr).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){g(this,lr).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,i]=e.rect,[s]=this.pageDimensions,[a]=this.pageTranslation,o=a+s+1,l=i-100,u=o+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[o,l,u,i]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){g(this,lr).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var a;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=g(this,Wy)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),X(this,Rt,uF).call(this);const[t,r]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*r/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/r).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),VQ(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(g(this,dg)||B(this,dg,new aD({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:X(this,Rt,sZ).bind(this),onPinching:X(this,Rt,aZ).bind(this),onPinchEnd:X(this,Rt,oZ).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(a=this._uiManager._editorUndoBar)==null||a.hide(),e}pointerdown(e){const{isMac:t}=Ts.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(B(this,cg,!0),this._isDraggable){X(this,Rt,lZ).call(this,e);return}X(this,Rt,lF).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){g(this,ju)&&clearTimeout(g(this,ju)),B(this,ju,setTimeout(()=>{var e;B(this,ju,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,r){e.changeParent(this),this.x=t,this.y=r,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,r=this.rotation){const i=this.parentScale,[s,a]=this.pageDimensions,[o,l]=this.pageTranslation,u=e/i,c=t/i,h=this.x*s,d=this.y*a,f=this.width*s,p=this.height*a;switch(r){case 0:return[h+u+o,a-d-c-p+l,h+u+f+o,a-d-c+l];case 90:return[h+c+o,a-d+u+l,h+c+p+o,a-d+u+f+l];case 180:return[h-u-f+o,a-d+c+l,h-u+o,a-d+c+p+l];case 270:return[h-c-p+o,a-d-u-f+l,h-c+o,a-d-u+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[r,i,s,a]=e,o=s-r,l=a-i;switch(this.rotation){case 0:return[r,t-a,o,l];case 90:return[r,t-i,l,o];case 180:return[s,t-i,o,l];case 270:return[s,t-a,l,o];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Zt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=g(this,lr))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:r,opacity:i,deleted:s,richText:a},uid:o,pageIndex:l,creationDate:u,modificationDate:c}=this;return{id:o,pageIndex:l,rect:this.getPDFRect(),richText:a,contentsObj:{str:e},creationDate:u,modificationDate:r||c,popupRef:!s,color:t,opacity:i}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),B(this,hg,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),B(this,hg,!1),!0):!1}isInEditMode(){return g(this,hg)}shouldGetKeyboardEvents(){return g(this,hh)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:r,right:i}=this.getClientDimensions(),{innerHeight:s,innerWidth:a}=window;return t<a&&i>0&&e<s&&r>0}rebuild(){X(this,Rt,uF).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var r;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((r=this._initialData)==null?void 0:r.popupRef)||""}}static async deserialize(e,t,r){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:r,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});i.rotation=e.rotation,B(i,lg,e.accessibilityData),i._isCopy=e.isCopy||!1;const[s,a]=i.pageDimensions,[o,l,u,c]=i.getRectInCurrentCoords(e.rect,a);return i.x=o/s,i.y=l/a,i.width=u/s,i.height=c/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t,r;if((e=g(this,Ef))==null||e.abort(),B(this,Ef,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),g(this,ju)&&(clearTimeout(g(this,ju)),B(this,ju,null)),X(this,Rt,K_).call(this),this.removeEditToolbar(),g(this,ll)){for(const i of g(this,ll).values())clearTimeout(i);B(this,ll,null)}this.parent=null,(t=g(this,dg))==null||t.destroy(),B(this,dg,null),(r=g(this,ol))==null||r.remove(),B(this,ol,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(X(this,Rt,rZ).call(this),g(this,hs).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[r,i,s,a]=this.getPDFRect();return[Zt._round(r+(s-r)*e),Zt._round(i+(a-i)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return g(this,lr).commentPopupPositionInLayer}set commentPopupPosition(e){g(this,lr).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return g(this,lr).hasDefaultPopupPosition()}get commentButtonWidth(){return g(this,lr).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){var t;(t=g(this,lr))==null||t.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),B(this,ch,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=g(this,hs).children;if(!g(this,ql)){B(this,ql,Array.from(t));const a=X(this,Rt,uZ).bind(this),o=X(this,Rt,cZ).bind(this),l=this._uiManager._signal;for(const u of g(this,ql)){const c=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",a,{signal:l}),u.addEventListener("blur",o,{signal:l}),u.addEventListener("focus",X(this,Rt,hZ).bind(this,c),{signal:l}),u.setAttribute("data-l10n-id",Zt._l10nResizer[c])}}const r=g(this,ql)[0];let i=0;for(const a of t){if(a===r)break;i++}const s=(360-this.rotation+this.parentRotation)%360/90*(g(this,ql).length/4);if(s!==i){if(s<i)for(let o=0;o<i-s;o++)g(this,hs).append(g(this,hs).firstElementChild);else if(s>i)for(let o=0;o<s-i;o++)g(this,hs).firstElementChild.before(g(this,hs).lastElementChild);let a=0;for(const o of t){const u=g(this,ql)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",Zt._l10nResizer[u])}}X(this,Rt,cF).call(this,0),B(this,hh,!0),g(this,hs).firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){g(this,hh)&&X(this,Rt,oF).call(this,g(this,rE),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){X(this,Rt,K_).call(this),this.div.focus()}select(){var e,t,r;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,s;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((s=this._editToolbar)==null||s.show())});return}(t=this._editToolbar)==null||t.show(),(r=g(this,Mr))==null||r.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,r,i,s;this.isSelected&&(this.isSelected=!1,(e=g(this,hs))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(r=this.div)!=null&&r.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(s=g(this,Mr))==null||s.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return g(this,iE)}set isEditing(e){B(this,iE,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){g(this,ll)||B(this,ll,new Map);const{action:r}=e;let i=g(this,ll).get(r);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),g(this,ll).delete(r),g(this,ll).size===0&&B(this,ll,null)},Zt._telemetryTimeout),g(this,ll).set(r,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),B(this,Wy,!1)}disable(){this.div&&(this.div.tabIndex=-1),B(this,Wy,!0)}updateFakeAnnotationElement(e){if(!g(this,ol)&&!this.deleted){B(this,ol,e.addFakeAnnotation(this));return}if(this.deleted){g(this,ol).remove(),B(this,ol,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&g(this,ol).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const r=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),r.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};lg=new WeakMap,ql=new WeakMap,Mr=new WeakMap,lr=new WeakMap,uh=new WeakMap,Wy=new WeakMap,wf=new WeakMap,nE=new WeakMap,hs=new WeakMap,ug=new WeakMap,ch=new WeakMap,ol=new WeakMap,Ef=new WeakMap,rE=new WeakMap,cg=new WeakMap,ho=new WeakMap,iE=new WeakMap,hg=new WeakMap,hh=new WeakMap,ju=new WeakMap,Xy=new WeakMap,Ky=new WeakMap,ll=new WeakMap,dg=new WeakMap,sE=new WeakMap,l2=new WeakMap,Rt=new WeakSet,iF=function([e,t],r,i){[r,i]=this.screenToPageTranslation(r,i),this.x+=r/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},aE=new WeakSet,sF=function(e,t,r){switch(r){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},MM=function(e){switch(e){case 90:{const[t,r]=this.pageDimensions;return[0,-t/r,r/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,r]=this.pageDimensions;return[0,t/r,-r/t,0]}default:return[1,0,0,1]}},rZ=function(){if(g(this,hs))return;B(this,hs,document.createElement("div")),g(this,hs).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const r of e){const i=document.createElement("div");g(this,hs).append(i),i.classList.add("resizer",r),i.setAttribute("data-resizer-name",r),i.addEventListener("pointerdown",X(this,Rt,iZ).bind(this,r),{signal:t}),i.addEventListener("contextmenu",Cl,{signal:t}),i.tabIndex=-1}this.div.prepend(g(this,hs))},iZ=function(e,t){var c;t.preventDefault();const{isMac:r}=Ts.platform;if(t.button!==0||t.ctrlKey&&r)return;(c=g(this,Mr))==null||c.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,B(this,ug,[t.screenX,t.screenY]);const s=new AbortController,a=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",X(this,Rt,oF).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",Yr,{passive:!1,signal:a}),window.addEventListener("contextmenu",Cl,{signal:a}),B(this,ch,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var h;s.abort(),this.parent.togglePointerEvents(!0),(h=g(this,Mr))==null||h.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=o,this.div.style.cursor=l,X(this,Rt,CM).call(this)};window.addEventListener("pointerup",u,{signal:a}),window.addEventListener("blur",u,{signal:a})},aF=function(e,t,r,i){this.width=r,this.height=i,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},CM=function(){if(!g(this,ch))return;const{savedX:e,savedY:t,savedWidth:r,savedHeight:i}=g(this,ch);B(this,ch,null);const s=this.x,a=this.y,o=this.width,l=this.height;s===e&&a===t&&o===r&&l===i||this.addCommands({cmd:X(this,Rt,aF).bind(this,s,a,o,l),undo:X(this,Rt,aF).bind(this,e,t,r,i),mustExec:!0})},oF=function(e,t){const[r,i]=this.parentDimensions,s=this.x,a=this.y,o=this.width,l=this.height,u=Zt.MIN_SIZE/r,c=Zt.MIN_SIZE/i,h=X(this,Rt,MM).call(this,this.rotation),d=(I,F)=>[h[0]*I+h[2]*F,h[1]*I+h[3]*F],f=X(this,Rt,MM).call(this,360-this.rotation),p=(I,F)=>[f[0]*I+f[2]*F,f[1]*I+f[3]*F];let m,y,v=!1,b=!1;switch(e){case"topLeft":v=!0,m=(I,F)=>[0,0],y=(I,F)=>[I,F];break;case"topMiddle":m=(I,F)=>[I/2,0],y=(I,F)=>[I/2,F];break;case"topRight":v=!0,m=(I,F)=>[I,0],y=(I,F)=>[0,F];break;case"middleRight":b=!0,m=(I,F)=>[I,F/2],y=(I,F)=>[0,F/2];break;case"bottomRight":v=!0,m=(I,F)=>[I,F],y=(I,F)=>[0,0];break;case"bottomMiddle":m=(I,F)=>[I/2,F],y=(I,F)=>[I/2,0];break;case"bottomLeft":v=!0,m=(I,F)=>[0,F],y=(I,F)=>[I,0];break;case"middleLeft":b=!0,m=(I,F)=>[0,F/2],y=(I,F)=>[I,F/2];break}const x=m(o,l),w=y(o,l);let _=d(...w);const E=Zt._round(s+_[0]),A=Zt._round(a+_[1]);let T=1,S=1,M,D;if(t.fromKeyboard)({deltaX:M,deltaY:D}=t);else{const{screenX:I,screenY:F}=t,[$,H]=g(this,ug);[M,D]=this.screenToPageTranslation(I-$,F-H),g(this,ug)[0]=I,g(this,ug)[1]=F}if([M,D]=p(M/r,D/i),v){const I=Math.hypot(o,l);T=S=Math.max(Math.min(Math.hypot(w[0]-x[0]-M,w[1]-x[1]-D)/I,1/o,1/l),u/o,c/l)}else b?T=va(Math.abs(w[0]-x[0]-M),u,1)/o:S=va(Math.abs(w[1]-x[1]-D),c,1)/l;const N=Zt._round(o*T),R=Zt._round(l*S);_=d(...y(N,R));const z=E-_[0],j=A-_[1];g(this,ho)||B(this,ho,[this.x,this.y,this.width,this.height]),this.width=N,this.height=R,this.x=z,this.y=j,this.setDims(),this.fixAndSetPosition(),this._onResizing()},sZ=function(){var e;B(this,ch,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=g(this,Mr))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},aZ=function(e,t,r){let s=.7*(r/t)+1-.7;if(s===1)return;const a=X(this,Rt,MM).call(this,this.rotation),o=(E,A)=>[a[0]*E+a[2]*A,a[1]*E+a[3]*A],[l,u]=this.parentDimensions,c=this.x,h=this.y,d=this.width,f=this.height,p=Zt.MIN_SIZE/l,m=Zt.MIN_SIZE/u;s=Math.max(Math.min(s,1/d,1/f),p/d,m/f);const y=Zt._round(d*s),v=Zt._round(f*s);if(y===d&&v===f)return;g(this,ho)||B(this,ho,[c,h,d,f]);const b=o(d/2,f/2),x=Zt._round(c+b[0]),w=Zt._round(h+b[1]),_=o(y/2,v/2);this.x=x-_[0],this.y=w-_[1],this.width=y,this.height=v,this.setDims(),this.fixAndSetPosition(),this._onResizing()},oZ=function(){var e;(e=g(this,Mr))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),X(this,Rt,CM).call(this)},lF=function(e){const{isMac:t}=Ts.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},lZ=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let r=!1;const i=new AbortController,s=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:s},o=u=>{i.abort(),B(this,wf,null),B(this,cg,!1),this._uiManager.endDragSession()||X(this,Rt,lF).call(this,u),r&&this._onStopDragging()};t&&(B(this,Xy,e.clientX),B(this,Ky,e.clientY),B(this,wf,e.pointerId),B(this,nE,e.pointerType),window.addEventListener("pointermove",u=>{r||(r=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:c,clientY:h,pointerId:d}=u;if(d!==g(this,wf)){Yr(u);return}const[f,p]=this.screenToPageTranslation(c-g(this,Xy),h-g(this,Ky));B(this,Xy,c),B(this,Ky,h),this._uiManager.dragSelectedEditors(f,p)},a),window.addEventListener("touchmove",Yr,a),window.addEventListener("pointerdown",u=>{u.pointerType===g(this,nE)&&(g(this,dg)||u.isPrimary)&&o(u),Yr(u)},a));const l=u=>{if(!g(this,wf)||g(this,wf)===u.pointerId){o(u);return}Yr(u)};window.addEventListener("pointerup",l,{signal:s}),window.addEventListener("blur",l,{signal:s})},uF=function(){if(g(this,Ef)||!this.div)return;B(this,Ef,new AbortController);const e=this._uiManager.combinedSignal(g(this,Ef));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},uZ=function(e){Zt._resizerKeyboardManager.exec(this,e)},cZ=function(e){var t;g(this,hh)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==g(this,hs)&&X(this,Rt,K_).call(this)},hZ=function(e){B(this,rE,g(this,hh)?e:"")},cF=function(e){if(g(this,ql))for(const t of g(this,ql))t.tabIndex=e},K_=function(){B(this,hh,!1),X(this,Rt,cF).call(this,-1),X(this,Rt,CM).call(this)},G(Zt,aE),Qe(Zt,"_l10n",null),Qe(Zt,"_l10nResizer",null),Qe(Zt,"_borderLineWidth",-1),Qe(Zt,"_colorManager",new Z3),Qe(Zt,"_zIndex",1),Qe(Zt,"_telemetryTimeout",1e3);let br=Zt;class r0e extends br{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const i8=3285377520,Wo=4294901760,Nu=65535;class dZ{constructor(e){this.h1=e?e&4294967295:i8,this.h2=e?e&4294967295:i8}update(e){let t,r;if(typeof e=="string"){t=new Uint8Array(e.length*2),r=0;for(let m=0,y=e.length;m<y;m++){const v=e.charCodeAt(m);v<=255?t[r++]=v:(t[r++]=v>>>8,t[r++]=v&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),r=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=r>>2,s=r-i*4,a=new Uint32Array(t.buffer,0,i);let o=0,l=0,u=this.h1,c=this.h2;const h=3432918353,d=461845907,f=h&Nu,p=d&Nu;for(let m=0;m<i;m++)m&1?(o=a[m],o=o*h&Wo|o*f&Nu,o=o<<15|o>>>17,o=o*d&Wo|o*p&Nu,u^=o,u=u<<13|u>>>19,u=u*5+3864292196):(l=a[m],l=l*h&Wo|l*f&Nu,l=l<<15|l>>>17,l=l*d&Wo|l*p&Nu,c^=l,c=c<<13|c>>>19,c=c*5+3864292196);switch(o=0,s){case 3:o^=t[i*4+2]<<16;case 2:o^=t[i*4+1]<<8;case 1:o^=t[i*4],o=o*h&Wo|o*f&Nu,o=o<<15|o>>>17,o=o*d&Wo|o*p&Nu,i&1?u^=o:c^=o}this.h1=u,this.h2=c}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Wo|e*36045&Nu,t=t*4283543511&Wo|((t<<16|e>>>16)*2950163797&Wo)>>>16,e^=t>>>1,e=e*444984403&Wo|e*60499&Nu,t=t*3301882366&Wo|((t<<16|e>>>16)*3120437893&Wo)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const hF=Object.freeze({map:null,hash:"",transfer:void 0});var fg,pg,dh,ds,u2,fZ;class d4{constructor(){G(this,u2);G(this,fg,!1);G(this,pg,null);G(this,dh,null);G(this,ds,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const r=g(this,ds).get(e);return r===void 0?t:Object.assign(t,r)}getRawValue(e){return g(this,ds).get(e)}remove(e){const t=g(this,ds).get(e);if(t!==void 0&&(t instanceof br&&g(this,dh).delete(t.annotationElementId),g(this,ds).delete(e),g(this,ds).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const r of g(this,ds).values())if(r instanceof br)return;this.onAnnotationEditor(null)}}setValue(e,t){const r=g(this,ds).get(e);let i=!1;if(r!==void 0)for(const[s,a]of Object.entries(t))r[s]!==a&&(i=!0,r[s]=a);else i=!0,g(this,ds).set(e,t);i&&X(this,u2,fZ).call(this),t instanceof br&&((g(this,dh)||B(this,dh,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return g(this,ds).has(e)}get size(){return g(this,ds).size}resetModified(){g(this,fg)&&(B(this,fg,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new pZ(this)}get serializable(){if(g(this,ds).size===0)return hF;const e=new Map,t=new dZ,r=[],i=Object.create(null);let s=!1;for(const[a,o]of g(this,ds)){const l=o instanceof br?o.serialize(!1,i):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),s||(s=!!l.bitmap))}if(s)for(const a of e.values())a.bitmap&&r.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:r}:hF}get editorStats(){let e=null;const t=new Map;let r=0,i=0;for(const s of g(this,ds).values()){if(!(s instanceof br)){s.popup&&(s.popup.deleted?i+=1:r+=1);continue}s.isCommentDeleted?i+=1:s.hasEditedComment&&(r+=1);const a=s.telemetryFinalData;if(!a)continue;const{type:o}=a;t.has(o)||t.set(o,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const l=e[o]||(e[o]=new Map);for(const[u,c]of Object.entries(a)){if(u==="type")continue;let h=l.get(u);h||(h=new Map,l.set(u,h));const d=h.get(c)??0;h.set(c,d+1)}}if((i>0||r>0)&&(e||(e=Object.create(null)),e.comments={deleted:i,edited:r}),!e)return null;for(const[s,a]of t)e[s]=a.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){B(this,pg,null)}updateEditor(e,t){var i;const r=(i=g(this,dh))==null?void 0:i.get(e);return r?(r.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=g(this,dh))==null?void 0:t.get(e))||null}get modifiedIds(){if(g(this,pg))return g(this,pg);const e=[];if(g(this,dh))for(const t of g(this,dh).values())t.serialize()&&e.push(t.annotationElementId);return B(this,pg,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return g(this,ds).entries()}}fg=new WeakMap,pg=new WeakMap,dh=new WeakMap,ds=new WeakMap,u2=new WeakSet,fZ=function(){g(this,fg)||(B(this,fg,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var oE;class pZ extends d4{constructor(t){super();G(this,oE);const{map:r,hash:i,transfer:s}=t.serializable,a=structuredClone(r,s?{transfer:s}:null);B(this,oE,{map:a,hash:i,transfer:s})}get print(){fr("Should not call PrintAnnotationStorage.print")}get serializable(){return g(this,oE)}get modifiedIds(){return Kt(this,"modifiedIds",{ids:new Set,hash:""})}}oE=new WeakMap;var Yy;class i0e{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){G(this,Yy,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),g(this,Yy).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:r}){if(!(!e||g(this,Yy).has(e.loadedName))){if(Sn(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:s,style:a}=e,o=new FontFace(i,s,a);this.addNativeFontFace(o);try{await o.load(),g(this,Yy).add(i),r==null||r(e)}catch{Xt(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}fr("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const r=e.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(i){throw Xt(`Failed to load font '${r.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(r=>{const i=this._queueLoadingCallback(r);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return Kt(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Kt(this,"isSyncFontLoadingSupported",ga||Ts.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(Sn(!i.done,"completeRequest() cannot be called twice."),i.done=!0;r.length>0&&r[0].done;){const s=r.shift();setTimeout(s.callback,0)}}const{loadingRequests:r}=this,i={done:!1,complete:t,callback:e};return r.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Kt(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function r(w,_){return w.charCodeAt(_)<<24|w.charCodeAt(_+1)<<16|w.charCodeAt(_+2)<<8|w.charCodeAt(_+3)&255}function i(w,_,E,A){const T=w.substring(0,_),S=w.substring(_+E);return T+A+S}let s,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let u=0;function c(w,_){if(++u>30){Xt("Load test font never loaded."),_();return}if(l.font="30px "+w,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){_();return}setTimeout(c.bind(null,w,_))}const h=`lt${Date.now()}${this.loadTestFontId++}`;let d=this._loadTestFont;d=i(d,976,h.length,h);const p=16,m=1482184792;let y=r(d,p);for(s=0,a=h.length-3;s<a;s+=4)y=y-m+r(h,s)|0;s<h.length&&(y=y-m+r(h+"XXX",s)|0),d=i(d,p,4,Bve(y));const v=`url(data:font/opentype;base64,${btoa(d)});`,b=`@font-face {font-family:"${h}";src:${v}}`;this.insertRule(b);const x=this._document.createElement("div");x.style.visibility="hidden",x.style.width=x.style.height="10px",x.style.position="absolute",x.style.top=x.style.left="0px";for(const w of[e.loadedName,h]){const _=this._document.createElement("span");_.textContent="Hi",_.style.fontFamily=w,x.append(_)}this._document.body.append(x),c(h,()=>{x.remove(),t.complete()})}}Yy=new WeakMap;var er;class s0e{constructor(e,t=null,r,i){G(this,er);this.compiledGlyphs=Object.create(null),B(this,er,e),this._inspectFont=t,r&&Object.assign(this,r),i&&(this.charProcOperatorList=i)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const r={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(r.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,r)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var r;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${RQ(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(r=this._inspectFont)==null||r.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const r=this.loadedName+"_path_"+t;let i;try{i=e.get(r)}catch(a){Xt(`getPathGenerator - ignoring character: "${a}".`)}const s=FQ(i);return this.fontExtraProperties||e.delete(r),this.compiledGlyphs[t]=s}get black(){return g(this,er).black}get bold(){return g(this,er).bold}get disableFontFace(){return g(this,er).disableFontFace??!1}set disableFontFace(e){Kt(this,"disableFontFace",!!e)}get fontExtraProperties(){return g(this,er).fontExtraProperties??!1}get isInvalidPDFjsFont(){return g(this,er).isInvalidPDFjsFont}get isType3Font(){return g(this,er).isType3Font}get italic(){return g(this,er).italic}get missingFile(){return g(this,er).missingFile}get remeasure(){return g(this,er).remeasure}get vertical(){return g(this,er).vertical}get ascent(){return g(this,er).ascent}get defaultWidth(){return g(this,er).defaultWidth}get descent(){return g(this,er).descent}get bbox(){return g(this,er).bbox}set bbox(e){Kt(this,"bbox",e)}get fontMatrix(){return g(this,er).fontMatrix}get fallbackName(){return g(this,er).fallbackName}get loadedName(){return g(this,er).loadedName}get mimetype(){return g(this,er).mimetype}get name(){return g(this,er).name}get data(){return g(this,er).data}clearData(){g(this,er).clearData()}get cssFontInfo(){return g(this,er).cssFontInfo}get systemFontInfo(){return g(this,er).systemFontInfo}get defaultVMetrics(){return g(this,er).defaultVMetrics}}er=new WeakMap;var Qy,Zy,lE,Jy,DM;const uy=class uy{constructor(e){G(this,Jy);G(this,Qy);G(this,Zy);G(this,lE);B(this,Qy,e),B(this,Zy,new DataView(g(this,Qy))),B(this,lE,new TextDecoder)}static write(e){const t=new TextEncoder,r={};let i=0;for(const u of uy.strings){const c=t.encode(e[u]);r[u]=c,i+=4+c.length}const s=new ArrayBuffer(i),a=new Uint8Array(s),o=new DataView(s);let l=0;for(const u of uy.strings){const c=r[u],h=c.length;o.setUint32(l,h),a.set(c,l+4),l+=4+h}return Sn(l===s.byteLength,"CssFontInfo.write: Buffer overflow"),s}get fontFamily(){return X(this,Jy,DM).call(this,0)}get fontWeight(){return X(this,Jy,DM).call(this,1)}get italicAngle(){return X(this,Jy,DM).call(this,2)}};Qy=new WeakMap,Zy=new WeakMap,lE=new WeakMap,Jy=new WeakSet,DM=function(e){Sn(e<uy.strings.length,"Invalid string index");let t=0;for(let i=0;i<e;i++)t+=g(this,Zy).getUint32(t)+4;const r=g(this,Zy).getUint32(t);return g(this,lE).decode(new Uint8Array(g(this,Qy),t+4,r))},Qe(uy,"strings",["fontFamily","fontWeight","italicAngle"]);let oD=uy;var Sf,qu,mg,gg,Y_;const cy=class cy{constructor(e){G(this,gg);G(this,Sf);G(this,qu);G(this,mg);B(this,Sf,e),B(this,qu,new DataView(g(this,Sf))),B(this,mg,new TextDecoder)}static write(e){const t=new TextEncoder,r={};let i=0;for(const d of cy.strings){const f=t.encode(e[d]);r[d]=f,i+=4+f.length}i+=4;let s,a,o=1+i;e.style&&(s=t.encode(e.style.style),a=t.encode(e.style.weight),o+=4+s.length+4+a.length);const l=new ArrayBuffer(o),u=new Uint8Array(l),c=new DataView(l);let h=0;c.setUint8(h++,e.guessFallback?1:0),c.setUint32(h,0),h+=4,i=0;for(const d of cy.strings){const f=r[d],p=f.length;i+=4+p,c.setUint32(h,p),u.set(f,h+4),h+=4+p}return c.setUint32(h-i-4,i),e.style&&(c.setUint32(h,s.length),u.set(s,h+4),h+=4+s.length,c.setUint32(h,a.length),u.set(a,h+4),h+=4+a.length),Sn(h<=l.byteLength,"SubstitionInfo.write: Buffer overflow"),l.transferToFixedLength(h)}get guessFallback(){return g(this,qu).getUint8(0)!==0}get css(){return X(this,gg,Y_).call(this,0)}get loadedName(){return X(this,gg,Y_).call(this,1)}get baseFontName(){return X(this,gg,Y_).call(this,2)}get src(){return X(this,gg,Y_).call(this,3)}get style(){let e=1;e+=4+g(this,qu).getUint32(e);const t=g(this,qu).getUint32(e),r=g(this,mg).decode(new Uint8Array(g(this,Sf),e+4,t));e+=4+t;const i=g(this,qu).getUint32(e),s=g(this,mg).decode(new Uint8Array(g(this,Sf),e+4,i));return{style:r,weight:s}}};Sf=new WeakMap,qu=new WeakMap,mg=new WeakMap,gg=new WeakSet,Y_=function(e){Sn(e<cy.strings.length,"Invalid string index");let t=5;for(let i=0;i<e;i++)t+=g(this,qu).getUint32(t)+4;const r=g(this,qu).getUint32(t);return g(this,mg).decode(new Uint8Array(g(this,Sf),t+4,r))},Qe(cy,"strings",["css","loadedName","baseFontName","src"]);let lD=cy;var ex,tx,nx,rx,fo,Wu,uE,tr,Xr,Ul,NM,Q_;const tn=class tn{constructor({data:e,extra:t}){G(this,Xr);G(this,Wu);G(this,uE);G(this,tr);B(this,Wu,e),B(this,uE,new TextDecoder),B(this,tr,new DataView(g(this,Wu))),t&&Object.assign(this,t)}get black(){return X(this,Xr,Ul).call(this,0)}get bold(){return X(this,Xr,Ul).call(this,1)}get disableFontFace(){return X(this,Xr,Ul).call(this,2)}get fontExtraProperties(){return X(this,Xr,Ul).call(this,3)}get isInvalidPDFjsFont(){return X(this,Xr,Ul).call(this,4)}get isType3Font(){return X(this,Xr,Ul).call(this,5)}get italic(){return X(this,Xr,Ul).call(this,6)}get missingFile(){return X(this,Xr,Ul).call(this,7)}get remeasure(){return X(this,Xr,Ul).call(this,8)}get vertical(){return X(this,Xr,Ul).call(this,9)}get ascent(){return X(this,Xr,NM).call(this,0)}get defaultWidth(){return X(this,Xr,NM).call(this,1)}get descent(){return X(this,Xr,NM).call(this,2)}get bbox(){let e=g(tn,tx);if(g(this,tr).getUint8(e)===0)return;e+=1;const r=[];for(let i=0;i<4;i++)r.push(g(this,tr).getInt16(e,!0)),e+=2;return r}get fontMatrix(){let e=g(tn,nx);if(g(this,tr).getUint8(e)===0)return;e+=1;const r=[];for(let i=0;i<6;i++)r.push(g(this,tr).getFloat64(e,!0)),e+=8;return r}get defaultVMetrics(){let e=g(tn,rx);if(g(this,tr).getUint8(e)===0)return;e+=1;const r=[];for(let i=0;i<3;i++)r.push(g(this,tr).getInt16(e,!0)),e+=2;return r}get fallbackName(){return X(this,Xr,Q_).call(this,0)}get loadedName(){return X(this,Xr,Q_).call(this,1)}get mimetype(){return X(this,Xr,Q_).call(this,2)}get name(){return X(this,Xr,Q_).call(this,3)}get data(){let e=g(tn,fo);const t=g(this,tr).getUint32(e);e+=4+t;const r=g(this,tr).getUint32(e);e+=4+r;const i=g(this,tr).getUint32(e);e+=4+i;const s=g(this,tr).getUint32(e);if(s!==0)return new Uint8Array(g(this,Wu),e+4,s)}clearData(){let e=g(tn,fo);const t=g(this,tr).getUint32(e);e+=4+t;const r=g(this,tr).getUint32(e);e+=4+r;const i=g(this,tr).getUint32(e);e+=4+i;const s=g(this,tr).getUint32(e);new Uint8Array(g(this,Wu),e+4,s).fill(0),g(this,tr).setUint32(e,0)}get cssFontInfo(){let e=g(tn,fo);const t=g(this,tr).getUint32(e);e+=4+t;const r=g(this,tr).getUint32(e);e+=4+r;const i=g(this,tr).getUint32(e);if(i===0)return null;const s=new Uint8Array(i);return s.set(new Uint8Array(g(this,Wu),e+4,i)),new oD(s.buffer)}get systemFontInfo(){let e=g(tn,fo);const t=g(this,tr).getUint32(e);e+=4+t;const r=g(this,tr).getUint32(e);if(r===0)return null;const i=new Uint8Array(r);return i.set(new Uint8Array(g(this,Wu),e+4,r)),new lD(i.buffer)}static write(e){const t=e.systemFontInfo?lD.write(e.systemFontInfo):null,r=e.cssFontInfo?oD.write(e.cssFontInfo):null,i=new TextEncoder,s={};let a=0;for(const m of tn.strings)s[m]=i.encode(e[m]),a+=4+s[m].length;const o=g(tn,fo)+4+a+4+(t?t.byteLength:0)+4+(r?r.byteLength:0)+4+(e.data?e.data.length:0),l=new ArrayBuffer(o),u=new Uint8Array(l),c=new DataView(l);let h=0;const d=tn.bools.length;let f=0,p=0;for(let m=0;m<d;m++){const y=e[tn.bools[m]];f|=(y===void 0?0:y?2:1)<<p,p+=2,(p===8||m===d-1)&&(c.setUint8(h++,f),f=0,p=0)}Sn(h===g(tn,ex),"FontInfo.write: Boolean properties offset mismatch");for(const m of tn.numbers)c.setFloat64(h,e[m]),h+=8;if(Sn(h===g(tn,tx),"FontInfo.write: Number properties offset mismatch"),e.bbox){c.setUint8(h++,4);for(const m of e.bbox)c.setInt16(h,m,!0),h+=2}else c.setUint8(h++,0),h+=2*4;if(Sn(h===g(tn,nx),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){c.setUint8(h++,6);for(const m of e.fontMatrix)c.setFloat64(h,m,!0),h+=8}else c.setUint8(h++,0),h+=8*6;if(Sn(h===g(tn,rx),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){c.setUint8(h++,1);for(const m of e.defaultVMetrics)c.setInt16(h,m,!0),h+=2}else c.setUint8(h++,0),h+=3*2;Sn(h===g(tn,fo),"FontInfo.write: DefaultVMetrics properties offset mismatch"),c.setUint32(g(tn,fo),0),h+=4;for(const m of tn.strings){const y=s[m],v=y.length;c.setUint32(h,v),u.set(y,h+4),h+=4+v}if(c.setUint32(g(tn,fo),h-g(tn,fo)-4),!t)c.setUint32(h,0),h+=4;else{const m=t.byteLength;c.setUint32(h,m),Sn(h+4+m<=l.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),u.set(new Uint8Array(t),h+4),h+=4+m}if(!r)c.setUint32(h,0),h+=4;else{const m=r.byteLength;c.setUint32(h,m),Sn(h+4+m<=l.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),u.set(new Uint8Array(r),h+4),h+=4+m}return e.data===void 0?(c.setUint32(h,0),h+=4):(c.setUint32(h,e.data.length),u.set(e.data,h+4),h+=4+e.data.length),Sn(h<=l.byteLength,"FontInfo.write: Buffer overflow"),l.transferToFixedLength(h)}};ex=new WeakMap,tx=new WeakMap,nx=new WeakMap,rx=new WeakMap,fo=new WeakMap,Wu=new WeakMap,uE=new WeakMap,tr=new WeakMap,Xr=new WeakSet,Ul=function(e){Sn(e<tn.bools.length,"Invalid boolean index");const t=Math.floor(e/4),r=e*2%8,i=g(this,tr).getUint8(t)>>r&3;return i===0?void 0:i===2},NM=function(e){return Sn(e<tn.numbers.length,"Invalid number index"),g(this,tr).getFloat64(g(tn,ex)+e*8)},Q_=function(e){Sn(e<tn.strings.length,"Invalid string index");let t=g(tn,fo)+4;for(let s=0;s<e;s++)t+=g(this,tr).getUint32(t)+4;const r=g(this,tr).getUint32(t),i=new Uint8Array(r);return i.set(new Uint8Array(g(this,Wu),t+4,r)),g(this,uE).decode(i)},Qe(tn,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),Qe(tn,"numbers",["ascent","defaultWidth","descent"]),Qe(tn,"strings",["fallbackName","loadedName","mimetype","name"]),G(tn,ex,Math.ceil(tn.bools.length*2/8)),G(tn,tx,g(tn,ex)+tn.numbers.length*8),G(tn,nx,g(tn,tx)+1+2*4),G(tn,rx,g(tn,nx)+1+8*6),G(tn,fo,g(tn,rx)+1+2*3);let dF=tn;var cE,hE,dE,fE,pE,mE,gE,vE;const gr=class gr{constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,r=null,i=[],s=[],a=[],o=[],l=null,u=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,r=e[2],a=e[3],t===1?i.push(...e[4],...e[5]):i.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,l=e[1],i=e[2],s=e[3],o=e[4]||[],r=e[6],u=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const c=Math.floor(i.length/2),h=Math.floor(s.length/3),d=a.length,f=o.length;let p=0;for(const _ of o)p+=1,p=Math.ceil(p/4)*4,p+=4+_.coords.length*4,p+=4+_.colors.length*4,_.verticesPerRow!==void 0&&(p+=4);const m=20+c*8+h*3+d*8+(r?16:0)+(u?3:0)+p,y=new ArrayBuffer(m),v=new DataView(y),b=new Uint8Array(y);v.setUint8(g(gr,cE),t),v.setUint8(g(gr,hE),r?1:0),v.setUint8(g(gr,dE),u?1:0),v.setUint8(g(gr,fE),l),v.setUint32(g(gr,pE),c,!0),v.setUint32(g(gr,mE),h,!0),v.setUint32(g(gr,gE),d,!0),v.setUint32(g(gr,vE),f,!0);let x=20;new Float32Array(y,x,c*2).set(i),x+=c*8,b.set(s,x),x+=h*3;for(const[_,E]of a)v.setFloat32(x,_,!0),x+=4,v.setUint32(x,parseInt(E.slice(1),16),!0),x+=4;if(r)for(const _ of r)v.setFloat32(x,_,!0),x+=4;u&&(b.set(u,x),x+=3);for(let _=0;_<o.length;_++){const E=o[_];v.setUint8(x,E.type),x+=1,x=Math.ceil(x/4)*4,v.setUint32(x,E.coords.length,!0),x+=4,new Int32Array(y,x,E.coords.length).set(E.coords),x+=E.coords.length*4,v.setUint32(x,E.colors.length,!0),x+=4,new Int32Array(y,x,E.colors.length).set(E.colors),x+=E.colors.length*4,E.verticesPerRow!==void 0&&(v.setUint32(x,E.verticesPerRow,!0),x+=4)}return y}getIR(){const e=this.view,t=this.data[g(gr,cE)],r=!!this.data[g(gr,hE)],i=!!this.data[g(gr,dE)],s=e.getUint32(g(gr,pE),!0),a=e.getUint32(g(gr,mE),!0),o=e.getUint32(g(gr,gE),!0),l=e.getUint32(g(gr,vE),!0);let u=20;const c=new Float32Array(this.buffer,u,s*2);u+=s*8;const h=new Uint8Array(this.buffer,u,a*3);u+=a*3;const d=[];for(let y=0;y<o;++y){const v=e.getFloat32(u,!0);u+=4;const b=e.getUint32(u,!0);u+=4,d.push([v,`#${b.toString(16).padStart(6,"0")}`])}let f=null;if(r){f=[];for(let y=0;y<4;++y)f.push(e.getFloat32(u,!0)),u+=4}let p=null;i&&(p=new Uint8Array(this.buffer,u,3),u+=3);const m=[];for(let y=0;y<l;++y){const v=e.getUint8(u);u+=1,u=Math.ceil(u/4)*4;const b=e.getUint32(u,!0);u+=4;const x=new Int32Array(this.buffer,u,b);u+=b*4;const w=e.getUint32(u,!0);u+=4;const _=new Int32Array(this.buffer,u,w);u+=w*4;const E={type:v,coords:x,colors:_};v===G3.LATTICE&&(E.verticesPerRow=e.getUint32(u,!0),u+=4),m.push(E)}if(t===1)return["RadialAxial","axial",f,d,Array.from(c.slice(0,2)),Array.from(c.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",f,d,[c[0],c[1]],[c[3],c[4]],c[2],c[5]];if(t===3){const y=this.data[g(gr,fE)];let v=null;if(c.length>0){let b=c[0],x=c[0],w=c[1],_=c[1];for(let E=0;E<c.length;E+=2){const A=c[E],T=c[E+1];b=b>A?A:b,w=w>T?T:w,x=x<A?A:x,_=_<T?T:_}v=[b,w,x,_]}return["Mesh",y,c,h,m,v,f,p]}throw new Error(`Unsupported pattern kind: ${t}`)}};cE=new WeakMap,hE=new WeakMap,dE=new WeakMap,fE=new WeakMap,pE=new WeakMap,mE=new WeakMap,gE=new WeakMap,vE=new WeakMap,G(gr,cE,0),G(gr,hE,1),G(gr,dE,2),G(gr,fE,3),G(gr,pE,4),G(gr,mE,8),G(gr,gE,12),G(gr,vE,16);let fF=gr;function a0e(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(ga)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function o0e(n){if(ga&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return $S(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function QA(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const pF=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,l0e=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",u0e=Hve.bind(null,pF,l0e);var fh,c2;class c0e{constructor(){G(this,fh,new Map);G(this,c2,Promise.resolve())}postMessage(e,t){const r={data:structuredClone(e,t?{transfer:t}:null)};g(this,c2).then(()=>{for(const[i]of g(this,fh))i.call(this,r)})}addEventListener(e,t,r=null){let i=null;if((r==null?void 0:r.signal)instanceof AbortSignal){const{signal:s}=r;if(s.aborted){Xt("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);i=()=>s.removeEventListener("abort",a),s.addEventListener("abort",a)}g(this,fh).set(t,i)}removeEventListener(e,t){const r=g(this,fh).get(t);r==null||r(),g(this,fh).delete(t)}terminate(){for(const[,e]of g(this,fh))e==null||e();g(this,fh).clear()}}fh=new WeakMap,c2=new WeakMap;const ZA={DATA:1,ERROR:2},hi={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function s8(){}function Fa(n){if(n instanceof Rp||n instanceof j3||n instanceof Qz||n instanceof rD||n instanceof nI)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||fr('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Rp(n.message);case"InvalidPDFException":return new j3(n.message);case"PasswordException":return new Qz(n.message,n.code);case"ResponseException":return new rD(n.message,n.status,n.missing);case"UnknownErrorException":return new nI(n.message,n.details)}return new nI(n.message,n.toString())}var ix,Al,mZ,gZ,vZ,RM;class Z_{constructor(e,t,r){G(this,Al);G(this,ix,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=r,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),r.addEventListener("message",X(this,Al,mZ).bind(this),{signal:g(this,ix).signal})}on(e,t){const r=this.actionHandler;if(r[e])throw new Error(`There is already an actionName called "${e}"`);r[e]=t}send(e,t,r){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},r)}sendWithPromise(e,t,r){const i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},r)}catch(a){s.reject(a)}return s.promise}sendWithStream(e,t,r,i){const s=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:u=>{const c=Promise.withResolvers();return this.streamControllers[s]={controller:u,startCall:c,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:s,data:t,desiredSize:u.desiredSize},i),c.promise},pull:u=>{const c=Promise.withResolvers();return this.streamControllers[s].pullCall=c,l.postMessage({sourceName:a,targetName:o,stream:hi.PULL,streamId:s,desiredSize:u.desiredSize}),c.promise},cancel:u=>{Sn(u instanceof Error,"cancel must have a valid reason");const c=Promise.withResolvers();return this.streamControllers[s].cancelCall=c,this.streamControllers[s].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:hi.CANCEL,streamId:s,reason:Fa(u)}),c.promise}},r)}destroy(){var e;(e=g(this,ix))==null||e.abort(),B(this,ix,null)}}ix=new WeakMap,Al=new WeakSet,mZ=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){X(this,Al,vZ).call(this,e);return}if(e.callback){const r=e.callbackId,i=this.callbackCapabilities[r];if(!i)throw new Error(`Cannot resolve callback ${r}`);if(delete this.callbackCapabilities[r],e.callback===ZA.DATA)i.resolve(e.data);else if(e.callback===ZA.ERROR)i.reject(Fa(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const r=this.sourceName,i=e.sourceName,s=this.comObj;Promise.try(t,e.data).then(function(a){s.postMessage({sourceName:r,targetName:i,callback:ZA.DATA,callbackId:e.callbackId,data:a})},function(a){s.postMessage({sourceName:r,targetName:i,callback:ZA.ERROR,callbackId:e.callbackId,reason:Fa(a)})});return}if(e.streamId){X(this,Al,gZ).call(this,e);return}t(e.data)},gZ=function(e){const t=e.streamId,r=this.sourceName,i=e.sourceName,s=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(u,c=1,h){if(this.isCancelled)return;const d=this.desiredSize;this.desiredSize-=c,d>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:r,targetName:i,stream:hi.ENQUEUE,streamId:t,chunk:u},h)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:hi.CLOSE,streamId:t}),delete a.streamSinks[t])},error(u){Sn(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:hi.ERROR,streamId:t,reason:Fa(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){s.postMessage({sourceName:r,targetName:i,stream:hi.START_COMPLETE,streamId:t,success:!0})},function(u){s.postMessage({sourceName:r,targetName:i,stream:hi.START_COMPLETE,streamId:t,reason:Fa(u)})})},vZ=function(e){const t=e.streamId,r=this.sourceName,i=e.sourceName,s=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case hi.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(Fa(e.reason));break;case hi.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(Fa(e.reason));break;case hi.PULL:if(!o){s.postMessage({sourceName:r,targetName:i,stream:hi.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||s8).then(function(){s.postMessage({sourceName:r,targetName:i,stream:hi.PULL_COMPLETE,streamId:t,success:!0})},function(u){s.postMessage({sourceName:r,targetName:i,stream:hi.PULL_COMPLETE,streamId:t,reason:Fa(u)})});break;case hi.ENQUEUE:if(Sn(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case hi.CLOSE:if(Sn(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),X(this,Al,RM).call(this,a,t);break;case hi.ERROR:Sn(a,"error should have stream controller"),a.controller.error(Fa(e.reason)),X(this,Al,RM).call(this,a,t);break;case hi.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(Fa(e.reason)),X(this,Al,RM).call(this,a,t);break;case hi.CANCEL:if(!o)break;const l=Fa(e.reason);Promise.try(o.onCancel||s8,l).then(function(){s.postMessage({sourceName:r,targetName:i,stream:hi.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){s.postMessage({sourceName:r,targetName:i,stream:hi.CANCEL_COMPLETE,streamId:t,reason:Fa(u)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},RM=async function(e,t){var r,i,s;await Promise.allSettled([(r=e.startCall)==null?void 0:r.promise,(i=e.pullCall)==null?void 0:i.promise,(s=e.cancelCall)==null?void 0:s.promise]),delete this.streamControllers[t]};var yE;class yZ{constructor({enableHWA:e=!1}){G(this,yE,!1);B(this,yE,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const r=this._createCanvas(e,t);return{canvas:r,context:r.getContext("2d",{willReadFrequently:!g(this,yE)})}}reset(e,t,r){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||r<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=r}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){fr("Abstract method `_createCanvas` called.")}}yE=new WeakMap;class h0e extends yZ{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const r=this._document.createElement("canvas");return r.width=e,r.height=t,r}}class xZ{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(r=>({cMapData:r,isCompressed:this.isCompressed})).catch(r=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){fr("Abstract method `_fetch` called.")}}class a8 extends xZ{async _fetch(e){const t=await HS(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):$S(t)}}class bZ{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,r,i,s){return"none"}destroy(e=!1){}}var vg,sx,ph,mh,Hs,yg,xg,ft,Us,J_,P0,IM,F0,_Z,mF,L0,e1,t1,gF,n1;class d0e extends bZ{constructor({docId:t,ownerDocument:r=globalThis.document}){super();G(this,ft);G(this,vg);G(this,sx);G(this,ph);G(this,mh);G(this,Hs);G(this,yg);G(this,xg,0);B(this,mh,t),B(this,Hs,r)}addFilter(t){if(!t)return"none";let r=g(this,ft,Us).get(t);if(r)return r;const[i,s,a]=X(this,ft,IM).call(this,t),o=t.length===1?i:`${i}${s}${a}`;if(r=g(this,ft,Us).get(o),r)return g(this,ft,Us).set(t,r),r;const l=`g_${g(this,mh)}_transfer_map_${Ei(this,xg)._++}`,u=X(this,ft,F0).call(this,l);g(this,ft,Us).set(t,u),g(this,ft,Us).set(o,u);const c=X(this,ft,L0).call(this,l);return X(this,ft,t1).call(this,i,s,a,c),u}addHCMFilter(t,r){var p;const i=`${t}-${r}`,s="base";let a=g(this,ft,J_).get(s);if((a==null?void 0:a.key)===i||(a?((p=a.filter)==null||p.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},g(this,ft,J_).set(s,a)),!t||!r))return a.url;const o=X(this,ft,n1).call(this,t);t=yt.makeHexColor(...o);const l=X(this,ft,n1).call(this,r);if(r=yt.makeHexColor(...l),g(this,ft,P0).style.color="",t==="#000000"&&r==="#ffffff"||t===r)return a.url;const u=new Array(256);for(let m=0;m<=255;m++){const y=m/255;u[m]=y<=.03928?y/12.92:((y+.055)/1.055)**2.4}const c=u.join(","),h=`g_${g(this,mh)}_hcm_filter`,d=a.filter=X(this,ft,L0).call(this,h);X(this,ft,t1).call(this,c,c,c,d),X(this,ft,mF).call(this,d);const f=(m,y)=>{const v=o[m]/255,b=l[m]/255,x=new Array(y+1);for(let w=0;w<=y;w++)x[w]=v+w/y*(b-v);return x.join(",")};return X(this,ft,t1).call(this,f(0,5),f(1,5),f(2,5),d),a.url=X(this,ft,F0).call(this,h),a.url}addAlphaFilter(t){let r=g(this,ft,Us).get(t);if(r)return r;const[i]=X(this,ft,IM).call(this,[t]),s=`alpha_${i}`;if(r=g(this,ft,Us).get(s),r)return g(this,ft,Us).set(t,r),r;const a=`g_${g(this,mh)}_alpha_map_${Ei(this,xg)._++}`,o=X(this,ft,F0).call(this,a);g(this,ft,Us).set(t,o),g(this,ft,Us).set(s,o);const l=X(this,ft,L0).call(this,a);return X(this,ft,gF).call(this,i,l),o}addLuminosityFilter(t){let r=g(this,ft,Us).get(t||"luminosity");if(r)return r;let i,s;if(t?([i]=X(this,ft,IM).call(this,[t]),s=`luminosity_${i}`):s="luminosity",r=g(this,ft,Us).get(s),r)return g(this,ft,Us).set(t,r),r;const a=`g_${g(this,mh)}_luminosity_map_${Ei(this,xg)._++}`,o=X(this,ft,F0).call(this,a);g(this,ft,Us).set(t,o),g(this,ft,Us).set(s,o);const l=X(this,ft,L0).call(this,a);return X(this,ft,_Z).call(this,l),t&&X(this,ft,gF).call(this,i,l),o}addHighlightHCMFilter(t,r,i,s,a){var b;const o=`${r}-${i}-${s}-${a}`;let l=g(this,ft,J_).get(t);if((l==null?void 0:l.key)===o||(l?((b=l.filter)==null||b.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},g(this,ft,J_).set(t,l)),!r||!i))return l.url;const[u,c]=[r,i].map(X(this,ft,n1).bind(this));let h=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),d=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),[f,p]=[s,a].map(X(this,ft,n1).bind(this));d<h&&([h,d,f,p]=[d,h,p,f]),g(this,ft,P0).style.color="";const m=(x,w,_)=>{const E=new Array(256),A=(d-h)/_,T=x/255,S=(w-x)/(255*_);let M=0;for(let D=0;D<=_;D++){const N=Math.round(h+D*A),R=T+D*S;for(let z=M;z<=N;z++)E[z]=R;M=N+1}for(let D=M;D<256;D++)E[D]=E[M-1];return E.join(",")},y=`g_${g(this,mh)}_hcm_${t}_filter`,v=l.filter=X(this,ft,L0).call(this,y);return X(this,ft,mF).call(this,v),X(this,ft,t1).call(this,m(f[0],p[0],5),m(f[1],p[1],5),m(f[2],p[2],5),v),l.url=X(this,ft,F0).call(this,y),l.url}destroy(t=!1){var r,i,s,a;t&&((r=g(this,yg))!=null&&r.size)||((i=g(this,ph))==null||i.parentNode.parentNode.remove(),B(this,ph,null),(s=g(this,sx))==null||s.clear(),B(this,sx,null),(a=g(this,yg))==null||a.clear(),B(this,yg,null),B(this,xg,0))}}vg=new WeakMap,sx=new WeakMap,ph=new WeakMap,mh=new WeakMap,Hs=new WeakMap,yg=new WeakMap,xg=new WeakMap,ft=new WeakSet,Us=function(){return g(this,sx)||B(this,sx,new Map)},J_=function(){return g(this,yg)||B(this,yg,new Map)},P0=function(){if(!g(this,ph)){const t=g(this,Hs).createElement("div"),{style:r}=t;r.visibility="hidden",r.contain="strict",r.width=r.height=0,r.position="absolute",r.top=r.left=0,r.zIndex=-1;const i=g(this,Hs).createElementNS(Xc,"svg");i.setAttribute("width",0),i.setAttribute("height",0),B(this,ph,g(this,Hs).createElementNS(Xc,"defs")),t.append(i),i.append(g(this,ph)),g(this,Hs).body.append(t)}return g(this,ph)},IM=function(t){if(t.length===1){const u=t[0],c=new Array(256);for(let d=0;d<256;d++)c[d]=u[d]/255;const h=c.join(",");return[h,h,h]}const[r,i,s]=t,a=new Array(256),o=new Array(256),l=new Array(256);for(let u=0;u<256;u++)a[u]=r[u]/255,o[u]=i[u]/255,l[u]=s[u]/255;return[a.join(","),o.join(","),l.join(",")]},F0=function(t){if(g(this,vg)===void 0){B(this,vg,"");const r=g(this,Hs).URL;r!==g(this,Hs).baseURI&&(vN(r)?Xt('#createUrl: ignore "data:"-URL for performance reasons.'):B(this,vg,CQ(r,"")))}return`url(${g(this,vg)}#${t})`},_Z=function(t){const r=g(this,Hs).createElementNS(Xc,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(r)},mF=function(t){const r=g(this,Hs).createElementNS(Xc,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(r)},L0=function(t){const r=g(this,Hs).createElementNS(Xc,"filter");return r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("id",t),g(this,ft,P0).append(r),r},e1=function(t,r,i){const s=g(this,Hs).createElementNS(Xc,r);s.setAttribute("type","discrete"),s.setAttribute("tableValues",i),t.append(s)},t1=function(t,r,i,s){const a=g(this,Hs).createElementNS(Xc,"feComponentTransfer");s.append(a),X(this,ft,e1).call(this,a,"feFuncR",t),X(this,ft,e1).call(this,a,"feFuncG",r),X(this,ft,e1).call(this,a,"feFuncB",i)},gF=function(t,r){const i=g(this,Hs).createElementNS(Xc,"feComponentTransfer");r.append(i),X(this,ft,e1).call(this,i,"feFuncA",t)},n1=function(t){return g(this,ft,P0).style.color=t,jS(getComputedStyle(g(this,ft,P0)).getPropertyValue("color"))};class wZ{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(r=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){fr("Abstract method `_fetch` called.")}}class o8 extends wZ{async _fetch(e){const t=await HS(e,"arraybuffer");return new Uint8Array(t)}}class EZ{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(r=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){fr("Abstract method `_fetch` called.")}}class l8 extends EZ{async _fetch(e){const t=await HS(e,"arraybuffer");return new Uint8Array(t)}}ga&&Xt("Please use the `legacy` build in Node.js environments.");async function f4(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class f0e extends bZ{}class p0e extends yZ{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class m0e extends xZ{async _fetch(e){return f4(e)}}class g0e extends wZ{async _fetch(e){return f4(e)}}class v0e extends EZ{async _fetch(e){return f4(e)}}const s0="__forcedDependency",{floor:u8,ceil:c8}=Math;function JA(n,e,t,r,i,s){n[e*4+0]=Math.min(n[e*4+0],t),n[e*4+1]=Math.min(n[e*4+1],r),n[e*4+2]=Math.max(n[e*4+2],i),n[e*4+3]=Math.max(n[e*4+3],s)}const vF=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var ax,Af;class y0e{constructor(e,t){G(this,ax);G(this,Af);B(this,ax,e),B(this,Af,t)}get length(){return g(this,ax).length}isEmpty(e){return g(this,ax)[e]===vF}minX(e){return g(this,Af)[e*4+0]/256}minY(e){return g(this,Af)[e*4+1]/256}maxX(e){return(g(this,Af)[e*4+2]+1)/256}maxY(e){return(g(this,Af)[e*4+3]+1)/256}}ax=new WeakMap,Af=new WeakMap;const eT=(n,e)=>{if(!n)return;let t=n.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},n.set(e,t)),t};var ka,Ba,bg,Wl,_g,gh,jn,nr,vh,Ua,xE,ox,wg,Eg,yh,Gs,Xu,bE,yF;class x0e{constructor(e,t,r=!1){G(this,bE);G(this,ka,{__proto__:null});G(this,Ba,{__proto__:null,transform:[],moveText:[],sameLineText:[],[s0]:[]});G(this,bg,new Map);G(this,Wl,[]);G(this,_g,[]);G(this,gh,[[1,0,0,1,0,0]]);G(this,jn,[-1/0,-1/0,1/0,1/0]);G(this,nr,new Float64Array([1/0,1/0,-1/0,-1/0]));G(this,vh,-1);G(this,Ua,new Set);G(this,xE,new Map);G(this,ox,new Map);G(this,wg);G(this,Eg);G(this,yh);G(this,Gs);G(this,Xu);B(this,wg,e.width),B(this,Eg,e.height),X(this,bE,yF).call(this,t),r&&B(this,Xu,new Map)}growOperationsCount(e){e>=g(this,Gs).length&&X(this,bE,yF).call(this,e,g(this,Gs))}save(e){return B(this,ka,{__proto__:g(this,ka)}),B(this,Ba,{__proto__:g(this,Ba),transform:{__proto__:g(this,Ba).transform},moveText:{__proto__:g(this,Ba).moveText},sameLineText:{__proto__:g(this,Ba).sameLineText},[s0]:{__proto__:g(this,Ba)[s0]}}),B(this,jn,{__proto__:g(this,jn)}),g(this,Wl).push(e),this}restore(e){var i;const t=Object.getPrototypeOf(g(this,ka));if(t===null)return this;B(this,ka,t),B(this,Ba,Object.getPrototypeOf(g(this,Ba))),B(this,jn,Object.getPrototypeOf(g(this,jn)));const r=g(this,Wl).pop();return r!==void 0&&((i=eT(g(this,Xu),e))==null||i.dependencies.add(r),g(this,Gs)[e]=g(this,Gs)[r]),this}recordOpenMarker(e){return g(this,Wl).push(e),this}getOpenMarker(){return g(this,Wl).length===0?null:g(this,Wl).at(-1)}recordCloseMarker(e){var r;const t=g(this,Wl).pop();return t!==void 0&&((r=eT(g(this,Xu),e))==null||r.dependencies.add(t),g(this,Gs)[e]=g(this,Gs)[t]),this}beginMarkedContent(e){return g(this,_g).push(e),this}endMarkedContent(e){var r;const t=g(this,_g).pop();return t!==void 0&&((r=eT(g(this,Xu),e))==null||r.dependencies.add(t),g(this,Gs)[e]=g(this,Gs)[t]),this}pushBaseTransform(e){return g(this,gh).push(yt.multiplyByDOMMatrix(g(this,gh).at(-1),e.getTransform())),this}popBaseTransform(){return g(this,gh).length>1&&g(this,gh).pop(),this}recordSimpleData(e,t){return g(this,ka)[e]=t,this}recordIncrementalData(e,t){return g(this,Ba)[e].push(t),this}resetIncrementalData(e,t){return g(this,Ba)[e].length=0,this}recordNamedData(e,t){return g(this,bg).set(e,t),this}recordSimpleDataFromNamed(e,t,r){g(this,ka)[e]=g(this,bg).get(t)??r}recordFutureForcedDependency(e,t){return this.recordIncrementalData(s0,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in g(this,ka)&&this.recordFutureForcedDependency(t,g(this,ka)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of g(this,Ua))this.recordFutureForcedDependency(s0,e);return this}resetBBox(e){return g(this,vh)!==e&&(B(this,vh,e),g(this,nr)[0]=1/0,g(this,nr)[1]=1/0,g(this,nr)[2]=-1/0,g(this,nr)[3]=-1/0),this}recordClipBox(e,t,r,i,s,a){const o=yt.multiplyByDOMMatrix(g(this,gh).at(-1),t.getTransform()),l=[1/0,1/0,-1/0,-1/0];yt.axialAlignedBoundingBox([r,s,i,a],o,l);const u=yt.intersect(g(this,jn),l);return u?(g(this,jn)[0]=u[0],g(this,jn)[1]=u[1],g(this,jn)[2]=u[2],g(this,jn)[3]=u[3]):(g(this,jn)[0]=g(this,jn)[1]=1/0,g(this,jn)[2]=g(this,jn)[3]=-1/0),this}recordBBox(e,t,r,i,s,a){const o=g(this,jn);if(o[0]===1/0)return this;const l=yt.multiplyByDOMMatrix(g(this,gh).at(-1),t.getTransform());if(o[0]===-1/0)return yt.axialAlignedBoundingBox([r,s,i,a],l,g(this,nr)),this;const u=[1/0,1/0,-1/0,-1/0];return yt.axialAlignedBoundingBox([r,s,i,a],l,u),g(this,nr)[0]=Math.min(g(this,nr)[0],Math.max(u[0],o[0])),g(this,nr)[1]=Math.min(g(this,nr)[1],Math.max(u[1],o[1])),g(this,nr)[2]=Math.max(g(this,nr)[2],Math.min(u[2],o[2])),g(this,nr)[3]=Math.max(g(this,nr)[3],Math.min(u[3],o[3])),this}recordCharacterBBox(e,t,r,i=1,s=0,a=0,o){const l=r.bbox;let u,c;if(l&&(u=l[2]!==l[0]&&l[3]!==l[1]&&g(this,ox).get(r),u!==!1&&(c=[0,0,0,0],yt.axialAlignedBoundingBox(l,r.fontMatrix,c),(i!==1||s!==0||a!==0)&&yt.scaleMinMax([i,0,0,-i,s,a],c),u)))return this.recordBBox(e,t,c[0],c[2],c[1],c[3]);if(!o)return this.recordFullPageBBox(e);const h=o();return l&&c&&u===void 0&&(u=c[0]<=s-h.actualBoundingBoxLeft&&c[2]>=s+h.actualBoundingBoxRight&&c[1]<=a-h.actualBoundingBoxAscent&&c[3]>=a+h.actualBoundingBoxDescent,g(this,ox).set(r,u),u)?this.recordBBox(e,t,c[0],c[2],c[1],c[3]):this.recordBBox(e,t,s-h.actualBoundingBoxLeft,s+h.actualBoundingBoxRight,a-h.actualBoundingBoxAscent,a+h.actualBoundingBoxDescent)}recordFullPageBBox(e){return g(this,nr)[0]=Math.max(0,g(this,jn)[0]),g(this,nr)[1]=Math.max(0,g(this,jn)[1]),g(this,nr)[2]=Math.min(g(this,wg),g(this,jn)[2]),g(this,nr)[3]=Math.min(g(this,Eg),g(this,jn)[3]),this}getSimpleIndex(e){return g(this,ka)[e]}recordDependencies(e,t){const r=g(this,Ua),i=g(this,ka),s=g(this,Ba);for(const a of t)a in g(this,ka)?r.add(i[a]):a in s&&s[a].forEach(r.add,r);return this}recordNamedDependency(e,t){return g(this,bg).has(t)&&g(this,Ua).add(g(this,bg).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[s0]),g(this,Xu)){const r=eT(g(this,Xu),e),{dependencies:i}=r;g(this,Ua).forEach(i.add,i),g(this,Wl).forEach(i.add,i),g(this,_g).forEach(i.add,i),i.delete(e),r.isRenderingOperation=!0}if(g(this,vh)===e){const r=u8(g(this,nr)[0]*256/g(this,wg)),i=u8(g(this,nr)[1]*256/g(this,Eg)),s=c8(g(this,nr)[2]*256/g(this,wg)),a=c8(g(this,nr)[3]*256/g(this,Eg));JA(g(this,yh),e,r,i,s,a);for(const o of g(this,Ua))o!==e&&JA(g(this,yh),o,r,i,s,a);for(const o of g(this,Wl))o!==e&&JA(g(this,yh),o,r,i,s,a);for(const o of g(this,_g))o!==e&&JA(g(this,yh),o,r,i,s,a);t||(g(this,Ua).clear(),B(this,vh,-1))}return this}recordShowTextOperation(e,t=!1){const r=Array.from(g(this,Ua));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const i of r)this.recordIncrementalData("sameLineText",i);return this}bboxToClipBoxDropOperation(e,t=!1){return g(this,vh)===e&&(B(this,vh,-1),g(this,jn)[0]=Math.max(g(this,jn)[0],g(this,nr)[0]),g(this,jn)[1]=Math.max(g(this,jn)[1],g(this,nr)[1]),g(this,jn)[2]=Math.min(g(this,jn)[2],g(this,nr)[2]),g(this,jn)[3]=Math.min(g(this,jn)[3],g(this,nr)[3]),t||g(this,Ua).clear()),this}_takePendingDependencies(){const e=g(this,Ua);return B(this,Ua,new Set),e}_extractOperation(e){const t=g(this,xE).get(e);return g(this,xE).delete(e),t}_pushPendingDependencies(e){for(const t of e)g(this,Ua).add(t)}take(){return g(this,ox).clear(),new y0e(g(this,Gs),g(this,yh))}takeDebugMetadata(){return g(this,Xu)}}ka=new WeakMap,Ba=new WeakMap,bg=new WeakMap,Wl=new WeakMap,_g=new WeakMap,gh=new WeakMap,jn=new WeakMap,nr=new WeakMap,vh=new WeakMap,Ua=new WeakMap,xE=new WeakMap,ox=new WeakMap,wg=new WeakMap,Eg=new WeakMap,yh=new WeakMap,Gs=new WeakMap,Xu=new WeakMap,bE=new WeakSet,yF=function(e,t){const r=new ArrayBuffer(e*4);B(this,yh,new Uint8ClampedArray(r)),B(this,Gs,new Uint32Array(r)),t&&t.length>0?(g(this,Gs).set(t),g(this,Gs).fill(vF,t.length)):g(this,Gs).fill(vF)};var ur,Gr,Xl,lx,ux;const BU=class BU{constructor(e,t,r){G(this,ur);G(this,Gr);G(this,Xl);G(this,lx,0);G(this,ux,0);if(e instanceof BU&&g(e,Xl)===!!r)return e;B(this,ur,e),B(this,Gr,t),B(this,Xl,!!r)}growOperationsCount(){throw new Error("Unreachable")}save(e){return Ei(this,ux)._++,g(this,ur).save(g(this,Gr)),this}restore(e){return g(this,ux)>0&&(g(this,ur).restore(g(this,Gr)),Ei(this,ux)._--),this}recordOpenMarker(e){return Ei(this,lx)._++,this}getOpenMarker(){return g(this,lx)>0?g(this,Gr):g(this,ur).getOpenMarker()}recordCloseMarker(e){return Ei(this,lx)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return g(this,ur).pushBaseTransform(e),this}popBaseTransform(){return g(this,ur).popBaseTransform(),this}recordSimpleData(e,t){return g(this,ur).recordSimpleData(e,g(this,Gr)),this}recordIncrementalData(e,t){return g(this,ur).recordIncrementalData(e,g(this,Gr)),this}resetIncrementalData(e,t){return g(this,ur).resetIncrementalData(e,g(this,Gr)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,r){return g(this,ur).recordSimpleDataFromNamed(e,t,g(this,Gr)),this}recordFutureForcedDependency(e,t){return g(this,ur).recordFutureForcedDependency(e,g(this,Gr)),this}inheritSimpleDataAsFutureForcedDependencies(e){return g(this,ur).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return g(this,ur).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return g(this,Xl)||g(this,ur).resetBBox(g(this,Gr)),this}recordClipBox(e,t,r,i,s,a){return g(this,Xl)||g(this,ur).recordClipBox(g(this,Gr),t,r,i,s,a),this}recordBBox(e,t,r,i,s,a){return g(this,Xl)||g(this,ur).recordBBox(g(this,Gr),t,r,i,s,a),this}recordCharacterBBox(e,t,r,i,s,a,o){return g(this,Xl)||g(this,ur).recordCharacterBBox(g(this,Gr),t,r,i,s,a,o),this}recordFullPageBBox(e){return g(this,Xl)||g(this,ur).recordFullPageBBox(g(this,Gr)),this}getSimpleIndex(e){return g(this,ur).getSimpleIndex(e)}recordDependencies(e,t){return g(this,ur).recordDependencies(g(this,Gr),t),this}recordNamedDependency(e,t){return g(this,ur).recordNamedDependency(g(this,Gr),t),this}recordOperation(e){return g(this,ur).recordOperation(g(this,Gr),!0),this}recordShowTextOperation(e){return g(this,ur).recordShowTextOperation(g(this,Gr),!0),this}bboxToClipBoxDropOperation(e){return g(this,Xl)||g(this,ur).bboxToClipBoxDropOperation(g(this,Gr),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};ur=new WeakMap,Gr=new WeakMap,Xl=new WeakMap,lx=new WeakMap,ux=new WeakMap;let uD=BU;const Xo={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},ys={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function xF(n,e){if(!e)return;const t=e[2]-e[0],r=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,r),n.clip(i)}class p4{isModifyingCurrentTransform(){return!1}getPattern(){fr("Abstract method `getPattern` called.")}}class b0e extends p4{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const r of this._colorStops)t.addColorStop(r[0],r[1]);return t}getPattern(e,t,r,i){let s;if(i===ys.STROKE||i===ys.FILL){const a=t.current.getClippedPathBoundingBox(i,Fr(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,u=t.cachedCanvases.getCanvas("pattern",o,l),c=u.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-a[0],-a[1]),r=yt.transform(r,[1,0,0,1,a[0],a[1]]),c.transform(...t.baseTransform),this.matrix&&c.transform(...this.matrix),xF(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),s=e.createPattern(u.canvas,"no-repeat");const h=new DOMMatrix(r);s.setTransform(h)}else xF(e,this._bbox),s=this._createGradient(e);return s}}function sI(n,e,t,r,i,s,a,o){const l=e.coords,u=e.colors,c=n.data,h=n.width*4;let d;l[t+1]>l[r+1]&&(d=t,t=r,r=d,d=s,s=a,a=d),l[r+1]>l[i+1]&&(d=r,r=i,i=d,d=a,a=o,o=d),l[t+1]>l[r+1]&&(d=t,t=r,r=d,d=s,s=a,a=d);const f=(l[t]+e.offsetX)*e.scaleX,p=(l[t+1]+e.offsetY)*e.scaleY,m=(l[r]+e.offsetX)*e.scaleX,y=(l[r+1]+e.offsetY)*e.scaleY,v=(l[i]+e.offsetX)*e.scaleX,b=(l[i+1]+e.offsetY)*e.scaleY;if(p>=b)return;const x=u[s],w=u[s+1],_=u[s+2],E=u[a],A=u[a+1],T=u[a+2],S=u[o],M=u[o+1],D=u[o+2],N=Math.round(p),R=Math.round(b);let z,j,I,F,$,H,Z,J;for(let ee=N;ee<=R;ee++){if(ee<y){const le=ee<p?0:(p-ee)/(p-y);z=f-(f-m)*le,j=x-(x-E)*le,I=w-(w-A)*le,F=_-(_-T)*le}else{let le;ee>b?le=1:y===b?le=0:le=(y-ee)/(y-b),z=m-(m-v)*le,j=E-(E-S)*le,I=A-(A-M)*le,F=T-(T-D)*le}let O;ee<p?O=0:ee>b?O=1:O=(p-ee)/(p-b),$=f-(f-v)*O,H=x-(x-S)*O,Z=w-(w-M)*O,J=_-(_-D)*O;const ue=Math.round(Math.min(z,$)),Q=Math.round(Math.max(z,$));let re=h*ee+ue*4;for(let le=ue;le<=Q;le++)O=(z-le)/(z-$),O<0?O=0:O>1&&(O=1),c[re++]=j-(j-H)*O|0,c[re++]=I-(I-Z)*O|0,c[re++]=F-(F-J)*O|0,c[re++]=255}}function _0e(n,e,t){const r=e.coords,i=e.colors;let s,a;switch(e.type){case G3.LATTICE:const o=e.verticesPerRow,l=Math.floor(r.length/o)-1,u=o-1;for(s=0;s<l;s++){let c=s*o;for(let h=0;h<u;h++,c++)sI(n,t,r[c],r[c+1],r[c+o],i[c],i[c+1],i[c+o]),sI(n,t,r[c+o+1],r[c+1],r[c+o],i[c+o+1],i[c+1],i[c+o])}break;case G3.TRIANGLES:for(s=0,a=r.length;s<a;s+=3)sI(n,t,r[s],r[s+1],r[s+2],i[s],i[s+1],i[s+2]);break;default:throw new Error("illegal figure")}}class w0e extends p4{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,r){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-o,c=Math.ceil(this._bounds[3])-l,h=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),d=Math.min(Math.ceil(Math.abs(c*e[1]*1.1)),3e3),f=u/h,p=c/d,m={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/f,scaleY:1/p},y=h+2*2,v=d+2*2,b=r.getCanvas("mesh",y,v),x=b.context,w=x.createImageData(h,d);if(t){const E=w.data;for(let A=0,T=E.length;A<T;A+=4)E[A]=t[0],E[A+1]=t[1],E[A+2]=t[2],E[A+3]=255}for(const E of this._figures)_0e(w,E,m);return x.putImageData(w,2,2),{canvas:b.canvas,offsetX:o-2*f,offsetY:l-2*p,scaleX:f,scaleY:p}}isModifyingCurrentTransform(){return!0}getPattern(e,t,r,i){xF(e,this._bbox);const s=new Float32Array(2);if(i===ys.SHADING)yt.singularValueDecompose2dScale(Fr(e),s);else if(this.matrix){yt.singularValueDecompose2dScale(this.matrix,s);const[o,l]=s;yt.singularValueDecompose2dScale(t.baseTransform,s),s[0]*=o,s[1]*=l}else yt.singularValueDecompose2dScale(t.baseTransform,s);const a=this._createMeshCanvas(s,i===ys.SHADING?null:this._background,t.cachedCanvases);return i!==ys.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class E0e extends p4{getPattern(){return"hotpink"}}function S0e(n){switch(n[0]){case"RadialAxial":return new b0e(n);case"Mesh":return new w0e(n);case"Dummy":return new E0e}throw new Error(`Unknown IR type: ${n[0]}`)}const h8={COLORED:1,UNCOLORED:2},h2=class h2{constructor(e,t,r,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=r,this.baseTransform=i}createPatternCanvas(e,t){var H,Z;const{bbox:r,operatorList:i,paintType:s,tilingType:a,color:o,canvasGraphicsFactory:l}=this;let{xstep:u,ystep:c}=this;u=Math.abs(u),c=Math.abs(c),gN("TilingType: "+a);const h=r[0],d=r[1],f=r[2],p=r[3],m=f-h,y=p-d,v=new Float32Array(2);yt.singularValueDecompose2dScale(this.matrix,v);const[b,x]=v;yt.singularValueDecompose2dScale(this.baseTransform,v);const w=b*v[0],_=x*v[1];let E=m,A=y,T=!1,S=!1;const M=Math.ceil(u*w),D=Math.ceil(c*_),N=Math.ceil(m*w),R=Math.ceil(y*_);M>=N?E=u:T=!0,D>=R?A=c:S=!0;const z=this.getSizeAndScale(E,this.ctx.canvas.width,w),j=this.getSizeAndScale(A,this.ctx.canvas.height,_),I=e.cachedCanvases.getCanvas("pattern",z.size,j.size),F=I.context,$=l.createCanvasGraphics(F,t);if($.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext($,s,o),F.translate(-z.scale*h,-j.scale*d),$.transform(0,z.scale,0,0,j.scale,0,0),F.save(),(H=$.dependencyTracker)==null||H.save(),this.clipBbox($,h,d,f,p),$.baseTransform=Fr($.ctx),$.executeOperatorList(i),$.endDrawing(),(Z=$.dependencyTracker)==null||Z.restore(),F.restore(),T||S){const J=I.canvas;T&&(E=u),S&&(A=c);const ee=this.getSizeAndScale(E,this.ctx.canvas.width,w),O=this.getSizeAndScale(A,this.ctx.canvas.height,_),ue=ee.size,Q=O.size,re=e.cachedCanvases.getCanvas("pattern-workaround",ue,Q),le=re.context,te=T?Math.floor(m/u):0,Y=S?Math.floor(y/c):0;for(let oe=0;oe<=te;oe++)for(let ve=0;ve<=Y;ve++)le.drawImage(J,ue*oe,Q*ve,ue,Q,0,0,ue,Q);return{canvas:re.canvas,scaleX:ee.scale,scaleY:O.scale,offsetX:h,offsetY:d}}return{canvas:I.canvas,scaleX:z.scale,scaleY:j.scale,offsetX:h,offsetY:d}}getSizeAndScale(e,t,r){const i=Math.max(h2.MAX_PATTERN_SIZE,t);let s=Math.ceil(e*r);return s>=i?s=i:r=s/e,{scale:r,size:s}}clipBbox(e,t,r,i,s){const a=i-t,o=s-r;e.ctx.rect(t,r,a,o),yt.axialAlignedBoundingBox([t,r,i,s],Fr(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,r){const i=e.ctx,s=e.current;switch(t){case h8.COLORED:const{fillStyle:a,strokeStyle:o}=this.ctx;i.fillStyle=s.fillColor=a,i.strokeStyle=s.strokeColor=o;break;case h8.UNCOLORED:i.fillStyle=i.strokeStyle=r,s.fillColor=s.strokeColor=r;break;default:throw new kve(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,r,i,s){let a=r;i!==ys.SHADING&&(a=yt.transform(a,t.baseTransform),this.matrix&&(a=yt.transform(a,this.matrix)));const o=this.createPatternCanvas(t,s);let l=new DOMMatrix(a);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const u=e.createPattern(o.canvas,"repeat");return u.setTransform(l),u}};Qe(h2,"MAX_PATTERN_SIZE",3e3);let bF=h2;function A0e({src:n,srcPos:e=0,dest:t,width:r,height:i,nonBlackColor:s=4294967295,inverseDecode:a=!1}){const o=Ts.isLittleEndian?4278190080:255,[l,u]=a?[s,o]:[o,s],c=r>>3,h=r&7,d=n.length;t=new Uint32Array(t.buffer);let f=0;for(let p=0;p<i;p++){for(const y=e+c;e<y;e++){const v=e<d?n[e]:255;t[f++]=v&128?u:l,t[f++]=v&64?u:l,t[f++]=v&32?u:l,t[f++]=v&16?u:l,t[f++]=v&8?u:l,t[f++]=v&4?u:l,t[f++]=v&2?u:l,t[f++]=v&1?u:l}if(h===0)continue;const m=e<d?n[e++]:255;for(let y=0;y<h;y++)t[f++]=m&1<<7-y?u:l}return{srcPos:e,destPos:f}}const d8=16,f8=100,T0e=15,p8=10,Ha=16,aI=new DOMMatrix,No=new Float32Array(2),ry=new Float32Array([1/0,1/0,-1/0,-1/0]);function M0e(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,r){e.translate(t,r),this.__originalTranslate(t,r)},n.scale=function(t,r){e.scale(t,r),this.__originalScale(t,r)},n.transform=function(t,r,i,s,a,o){e.transform(t,r,i,s,a,o),this.__originalTransform(t,r,i,s,a,o)},n.setTransform=function(t,r,i,s,a,o){e.setTransform(t,r,i,s,a,o),this.__originalSetTransform(t,r,i,s,a,o)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,r){e.moveTo(t,r),this.__originalMoveTo(t,r)},n.lineTo=function(t,r){e.lineTo(t,r),this.__originalLineTo(t,r)},n.bezierCurveTo=function(t,r,i,s,a,o){e.bezierCurveTo(t,r,i,s,a,o),this.__originalBezierCurveTo(t,r,i,s,a,o)},n.rect=function(t,r,i,s){e.rect(t,r,i,s),this.__originalRect(t,r,i,s)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class C0e{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,r){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,r)):(i=this.canvasFactory.create(t,r),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function tT(n,e,t,r,i,s,a,o,l,u){const[c,h,d,f,p,m]=Fr(n);if(h===0&&d===0){const b=a*c+p,x=Math.round(b),w=o*f+m,_=Math.round(w),E=(a+l)*c+p,A=Math.abs(Math.round(E)-x)||1,T=(o+u)*f+m,S=Math.abs(Math.round(T)-_)||1;return n.setTransform(Math.sign(c),0,0,Math.sign(f),x,_),n.drawImage(e,t,r,i,s,0,0,A,S),n.setTransform(c,h,d,f,p,m),[A,S]}if(c===0&&f===0){const b=o*d+p,x=Math.round(b),w=a*h+m,_=Math.round(w),E=(o+u)*d+p,A=Math.abs(Math.round(E)-x)||1,T=(a+l)*h+m,S=Math.abs(Math.round(T)-_)||1;return n.setTransform(0,Math.sign(h),Math.sign(d),0,x,_),n.drawImage(e,t,r,i,s,0,0,S,A),n.setTransform(c,h,d,f,p,m),[S,A]}n.drawImage(e,t,r,i,s,a,o,l,u);const y=Math.hypot(c,h),v=Math.hypot(d,f);return[y*l,v*u]}class m8{constructor(e,t,r){Qe(this,"alphaIsShape",!1);Qe(this,"fontSize",0);Qe(this,"fontSizeScale",1);Qe(this,"textMatrix",null);Qe(this,"textMatrixScale",1);Qe(this,"fontMatrix",H3);Qe(this,"leading",0);Qe(this,"x",0);Qe(this,"y",0);Qe(this,"lineX",0);Qe(this,"lineY",0);Qe(this,"charSpacing",0);Qe(this,"wordSpacing",0);Qe(this,"textHScale",1);Qe(this,"textRenderingMode",us.FILL);Qe(this,"textRise",0);Qe(this,"fillColor","#000000");Qe(this,"strokeColor","#000000");Qe(this,"patternFill",!1);Qe(this,"patternStroke",!1);Qe(this,"fillAlpha",1);Qe(this,"strokeAlpha",1);Qe(this,"lineWidth",1);Qe(this,"activeSMask",null);Qe(this,"transferMaps","none");r==null||r(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=ry.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=ys.FILL,t=null){const r=this.minMax.slice();if(e===ys.STROKE){t||fr("Stroke bounding box must include transform."),yt.singularValueDecompose2dScale(t,No);const i=No[0]*this.lineWidth/2,s=No[1]*this.lineWidth/2;r[0]-=i,r[1]-=s,r[2]+=i,r[3]+=s}return r}updateClipFromPath(){const e=yt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(ry,0)}getClippedPathBoundingBox(e=ys.FILL,t=null){return yt.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function g8(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,r=e.width,i=t%Ha,s=(t-i)/Ha,a=i===0?s:s+1,o=n.createImageData(r,Ha);let l=0,u;const c=e.data,h=o.data;let d,f,p,m;if(e.kind===wM.GRAYSCALE_1BPP){const y=c.byteLength,v=new Uint32Array(h.buffer,0,h.byteLength>>2),b=v.length,x=r+7>>3,w=4294967295,_=Ts.isLittleEndian?4278190080:255;for(d=0;d<a;d++){for(p=d<s?Ha:i,u=0,f=0;f<p;f++){const E=y-l;let A=0;const T=E>x?r:E*8-7,S=T&-8;let M=0,D=0;for(;A<S;A+=8)D=c[l++],v[u++]=D&128?w:_,v[u++]=D&64?w:_,v[u++]=D&32?w:_,v[u++]=D&16?w:_,v[u++]=D&8?w:_,v[u++]=D&4?w:_,v[u++]=D&2?w:_,v[u++]=D&1?w:_;for(;A<T;A++)M===0&&(D=c[l++],M=128),v[u++]=D&M?w:_,M>>=1}for(;u<b;)v[u++]=0;n.putImageData(o,0,d*Ha)}}else if(e.kind===wM.RGBA_32BPP){for(f=0,m=r*Ha*4,d=0;d<s;d++)h.set(c.subarray(l,l+m)),l+=m,n.putImageData(o,0,f),f+=Ha;d<a&&(m=r*i*4,h.set(c.subarray(l,l+m)),n.putImageData(o,0,f))}else if(e.kind===wM.RGB_24BPP)for(p=Ha,m=r*p,d=0;d<a;d++){for(d>=s&&(p=i,m=r*p),u=0,f=m;f--;)h[u++]=c[l++],h[u++]=c[l++],h[u++]=c[l++],h[u++]=255;n.putImageData(o,0,d*Ha)}else throw new Error(`bad image kind: ${e.kind}`)}function v8(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,r=e.width,i=t%Ha,s=(t-i)/Ha,a=i===0?s:s+1,o=n.createImageData(r,Ha);let l=0;const u=e.data,c=o.data;for(let h=0;h<a;h++){const d=h<s?Ha:i;({srcPos:l}=A0e({src:u,srcPos:l,dest:c,width:r,height:d,nonBlackColor:0})),n.putImageData(o,0,h*Ha)}}function y_(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const r of t)n[r]!==void 0&&(e[r]=n[r]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function nT(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function y8(n,e){if(e)return!0;yt.singularValueDecompose2dScale(n,No);const t=Math.fround(Ac.pixelRatio*Ip.PDF_TO_CSS_UNITS);return No[0]<=t&&No[1]<=t}const D0e=["butt","round","square"],N0e=["miter","round","bevel"],R0e={},x8={};var vu,_F,wF,EF;const UU=class UU{constructor(e,t,r,i,s,{optionalContentConfig:a,markedContentStack:o=null},l,u,c){G(this,vu);this.ctx=e,this.current=new m8(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=r,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new C0e(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=c??null}getObject(e,t,r=null){var i;return typeof t=="string"?((i=this.dependencyTracker)==null||i.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):r}beginDrawing({transform:e,viewport:t,transparency:r=!1,background:i=null}){const s=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,a),this.ctx.fillStyle=o,r){const l=this.cachedCanvases.getCanvas("transparent",s,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Fr(this.compositeCtx))}this.ctx.save(),nT(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Fr(this.ctx)}executeOperatorList(e,t,r,i,s){var v;const a=e.argsArray,o=e.fnArray;let l=t||0;const u=a.length;if(u===l)return l;const c=u-l>p8&&typeof r=="function",h=c?Date.now()+T0e:0;let d=0;const f=this.commonObjs,p=this.objs;let m,y;for(;;){if(i!==void 0&&l===i.nextBreakPoint)return i.breakIt(l,r),l;if(!s||s(l))if(m=o[l],y=a[l]??null,m!==xw.dependency)y===null?this[m](l):this[m](l,...y);else for(const b of y){(v=this.dependencyTracker)==null||v.recordNamedData(b,l);const x=b.startsWith("g_")?f:p;if(!x.has(b))return x.get(b,r),l}if(l++,l===u)return l;if(c&&++d>p8){if(Date.now()>h)return r(),l;d=0}}}endDrawing(){X(this,vu,_F).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),X(this,vu,wF).call(this)}_scaleImage(e,t){const r=e.width??e.displayWidth,i=e.height??e.displayHeight;let s=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=r,l=i,u="prescale1",c,h;for(;s>2&&o>1||a>2&&l>1;){let d=o,f=l;s>2&&o>1&&(d=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),s/=o/d),a>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/f),c=this.cachedCanvases.getCanvas(u,d,f),h=c.context,h.clearRect(0,0,d,f),h.drawImage(e,0,0,o,l,0,0,d,f),e=c.canvas,o=d,l=f,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e,t){var M,D;const r=this.ctx,{width:i,height:s}=t,a=this.current.fillColor,o=this.current.patternFill,l=Fr(r);let u,c,h,d;if((t.bitmap||t.data)&&t.count>1){const N=t.bitmap||t.data.buffer;c=JSON.stringify(o?l:[l.slice(0,4),a]),u=this._cachedBitmapsMap.get(N),u||(u=new Map,this._cachedBitmapsMap.set(N,u));const R=u.get(c);if(R&&!o){const z=Math.round(Math.min(l[0],l[2])+l[4]),j=Math.round(Math.min(l[1],l[3])+l[5]);return(M=this.dependencyTracker)==null||M.recordDependencies(e,Xo.transformAndFill),{canvas:R,offsetX:z,offsetY:j}}h=R}h||(d=this.cachedCanvases.getCanvas("maskCanvas",i,s),v8(d.context,t));let f=yt.transform(l,[1/i,0,0,-1/s,0,0]);f=yt.transform(f,[1,0,0,1,0,-s]);const p=ry.slice();yt.axialAlignedBoundingBox([0,0,i,s],f,p);const[m,y,v,b]=p,x=Math.round(v-m)||1,w=Math.round(b-y)||1,_=this.cachedCanvases.getCanvas("fillCanvas",x,w),E=_.context,A=m,T=y;E.translate(-A,-T),E.transform(...f),h||(h=this._scaleImage(d.canvas,Du(E)),h=h.img,u&&o&&u.set(c,h)),E.imageSmoothingEnabled=y8(Fr(E),t.interpolate),tT(E,h,0,0,h.width,h.height,0,0,i,s),E.globalCompositeOperation="source-in";const S=yt.transform(Du(E),[1,0,0,1,-A,-T]);return E.fillStyle=o?a.getPattern(r,this,S,ys.FILL,e):a,E.fillRect(0,0,i,s),u&&!o&&(this.cachedCanvases.delete("fillCanvas"),u.set(c,_.canvas)),(D=this.dependencyTracker)==null||D.recordDependencies(e,Xo.transformAndFill),{canvas:_.canvas,offsetX:Math.round(A),offsetY:Math.round(T)}}setLineWidth(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("lineCap",e),this.ctx.lineCap=D0e[t]}setLineJoin(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("lineJoin",e),this.ctx.lineJoin=N0e[t]}setMiterLimit(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,r){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("dash",e);const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=r)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var r,i,s,a,o;for(const[l,u]of t)switch(l){case"LW":this.setLineWidth(e,u);break;case"LC":this.setLineCap(e,u);break;case"LJ":this.setLineJoin(e,u);break;case"ML":this.setMiterLimit(e,u);break;case"D":this.setDash(e,u[0],u[1]);break;case"RI":this.setRenderingIntent(e,u);break;case"FL":this.setFlatness(e,u);break;case"Font":this.setFont(e,u[0],u[1]);break;case"CA":(r=this.dependencyTracker)==null||r.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=u;break;case"ca":(i=this.dependencyTracker)==null||i.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=u;break;case"BM":(s=this.dependencyTracker)==null||s.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=u;break;case"SMask":(a=this.dependencyTracker)==null||a.recordSimpleData("SMask",e),this.current.activeSMask=u?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(o=this.dependencyTracker)==null||o.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(u);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,r=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,t,r);this.suspendedCtx=this.ctx;const a=this.ctx=s.context;a.setTransform(this.suspendedCtx.getTransform()),y_(this.suspendedCtx,a),M0e(a,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),y_(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,r=this.suspendedCtx;this.composeSMask(r,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,r,i){const s=i[0],a=i[1],o=i[2]-s,l=i[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,r,o,l,t.subtype,t.backdrop,t.transferMap,s,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(r.canvas,0,0),e.restore())}genericComposeSMask(e,t,r,i,s,a,o,l,u,c,h){let d=e.canvas,f=l-c,p=u-h;if(a)if(f<0||p<0||f+r>d.width||p+i>d.height){const y=this.cachedCanvases.getCanvas("maskExtension",r,i),v=y.context;v.drawImage(d,-f,-p),v.globalCompositeOperation="destination-atop",v.fillStyle=a,v.fillRect(0,0,r,i),v.globalCompositeOperation="source-over",d=y.canvas,f=p=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const y=new Path2D;y.rect(f,p,r,i),e.clip(y),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(f,p,r,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),s==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):s==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const m=new Path2D;m.rect(l,u,r,i),t.clip(m),t.globalCompositeOperation="destination-in",t.drawImage(d,f,p,r,i,l,u,r,i),t.restore()}save(e){var r;this.inSMaskMode&&y_(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(r=this.dependencyTracker)==null||r.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&y_(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,r,i,s,a,o){var l;(l=this.dependencyTracker)==null||l.recordIncrementalData("transform",e),this.ctx.transform(t,r,i,s,a,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,r,i){let[s]=r;if(!i){s||(s=r[0]=new Path2D),this[t](e,s);return}if(this.dependencyTracker!==null){const a=t===xw.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,i[0]-a,i[2]+a,i[1]-a,i[3]+a).recordDependencies(e,["transform"])}s instanceof Path2D||(s=r[0]=FQ(s)),yt.axialAlignedBoundingBox(i,Fr(this.ctx),this.current.minMax),this[t](e,s),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,r=!0){var a;const i=this.ctx,s=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof s=="object"&&(s!=null&&s.getPattern)){const o=s.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=s.getPattern(i,this,Du(i),ys.STROKE,e),o){const l=new Path2D;l.addPath(t,i.getTransform().invertSelf().multiplySelf(o)),t=l}this.rescaleAndStroke(t,!1),i.restore()}else this.rescaleAndStroke(t,!0);(a=this.dependencyTracker)==null||a.recordDependencies(e,Xo.stroke),r&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(ys.STROKE,Fr(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,r=!0){var u,c,h;const i=this.ctx,s=this.current.fillColor,a=this.current.patternFill;let o=!1;if(a){const d=s.isModifyingCurrentTransform()?i.getTransform():null;if((u=this.dependencyTracker)==null||u.save(e),i.save(),i.fillStyle=s.getPattern(i,this,Du(i),ys.FILL,e),d){const f=new Path2D;f.addPath(t,i.getTransform().invertSelf().multiplySelf(d)),t=f}o=!0}const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(i.fill(t,"evenodd"),this.pendingEOFill=!1):i.fill(t)),(c=this.dependencyTracker)==null||c.recordDependencies(e,Xo.fill),o&&(i.restore(),(h=this.dependencyTracker)==null||h.restore(e)),r&&this.consumePath(e,t,l)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var r;this.ctx.fill(t),(r=this.dependencyTracker)==null||r.recordDependencies(e,Xo.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=R0e}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=x8}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,r=this.ctx;if(this.dependencyTracker){const{dependencyTracker:i}=this;t!==void 0&&i.recordFutureForcedDependency("textClip",i.getOpenMarker()).recordFutureForcedDependency("textClip",e),i.recordCloseMarker(e)}if(t!==void 0){const i=new Path2D,s=r.getTransform().invertSelf();for(const{transform:a,x:o,y:l,fontSize:u,path:c}of t)c&&i.addPath(c,new DOMMatrix(a).preMultiplySelf(s).translate(o,l).scale(u,-u));r.clip(i)}delete this.pendingTextPaths}setCharSpacing(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,r){var h,d;(h=this.dependencyTracker)==null||h.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const i=this.commonObjs.get(t),s=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(s.fontMatrix=i.fontMatrix||H3,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&Xt("Invalid font matrix for font "+t),r<0?(r=-r,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=r,i.isType3Font)return;const a=i.loadedName||"sans-serif",o=((d=i.systemFontInfo)==null?void 0:d.css)||`"${a}", ${i.fallbackName}`;let l="normal";i.black?l="900":i.bold&&(l="bold");const u=i.italic?"italic":"normal";let c=r;r<d8?c=d8:r>f8&&(c=f8),this.current.fontSizeScale=r/c,this.ctx.font=`${u} ${l} ${c}px ${o}`}setTextRenderingMode(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,r){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=r}setLeadingMoveText(e,t,r){this.setLeading(e,-r),this.moveText(e,t,r)}setTextMatrix(e,t){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:r}=this;r.textMatrix=t,r.textMatrixScale=Math.hypot(t[0],t[1]),r.x=r.lineX=0,r.y=r.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,r,i,s,a){var v,b,x,w;const o=this.ctx,l=this.current,u=l.font,c=l.textRenderingMode,h=l.fontSize/l.fontSizeScale,d=c&us.FILL_STROKE_MASK,f=!!(c&us.ADD_TO_PATH_FLAG),p=l.patternFill&&!u.missingFile,m=l.patternStroke&&!u.missingFile;let y;if((u.disableFontFace||f||p||m)&&!u.missingFile&&(y=u.getPathGenerator(this.commonObjs,t)),y&&(u.disableFontFace||p||m)){o.save(),o.translate(r,i),o.scale(h,-h),(v=this.dependencyTracker)==null||v.recordCharacterBBox(e,o,u);let _;if(d===us.FILL||d===us.FILL_STROKE)if(s){_=o.getTransform(),o.setTransform(...s);const E=X(this,vu,EF).call(this,y,_,s);o.fill(E)}else o.fill(y);if(d===us.STROKE||d===us.FILL_STROKE)if(a){_||(_=o.getTransform()),o.setTransform(...a);const{a:E,b:A,c:T,d:S}=_,M=yt.inverseTransform(a),D=yt.transform([E,A,T,S,0,0],M);yt.singularValueDecompose2dScale(D,No),o.lineWidth*=Math.max(No[0],No[1])/h,o.stroke(X(this,vu,EF).call(this,y,_,a))}else o.lineWidth/=h,o.stroke(y);o.restore()}else(d===us.FILL||d===us.FILL_STROKE)&&(o.fillText(t,r,i),(b=this.dependencyTracker)==null||b.recordCharacterBBox(e,o,u,h,r,i,()=>o.measureText(t))),(d===us.STROKE||d===us.FILL_STROKE)&&(this.dependencyTracker&&((x=this.dependencyTracker)==null||x.recordCharacterBBox(e,o,u,h,r,i,()=>o.measureText(t)).recordDependencies(e,Xo.stroke)),o.strokeText(t,r,i));f&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Fr(o),x:r,y:i,fontSize:h,path:y}),(w=this.dependencyTracker)==null||w.recordCharacterBBox(e,o,u,h,r,i))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let r=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){r=!0;break}return Kt(this,"isFontSubpixelAAEnabled",r)}showText(e,t){var T,S,M,D;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,Xo.showText).resetBBox(e),this.current.textRenderingMode&us.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const r=this.current,i=r.font;if(i.isType3Font){this.showType3Text(e,t),(T=this.dependencyTracker)==null||T.recordShowTextOperation(e);return}const s=r.fontSize;if(s===0){(S=this.dependencyTracker)==null||S.recordOperation(e);return}const a=this.ctx,o=r.fontSizeScale,l=r.charSpacing,u=r.wordSpacing,c=r.fontDirection,h=r.textHScale*c,d=t.length,f=i.vertical,p=f?1:-1,m=i.defaultVMetrics,y=s*r.fontMatrix[0],v=r.textRenderingMode===us.FILL&&!i.disableFontFace&&!r.patternFill;a.save(),r.textMatrix&&a.transform(...r.textMatrix),a.translate(r.x,r.y+r.textRise),c>0?a.scale(h,-1):a.scale(h,1);let b,x;if(r.patternFill){a.save();const N=r.fillColor.getPattern(a,this,Du(a),ys.FILL,e);b=Fr(a),a.restore(),a.fillStyle=N}if(r.patternStroke){a.save();const N=r.strokeColor.getPattern(a,this,Du(a),ys.STROKE,e);x=Fr(a),a.restore(),a.strokeStyle=N}let w=r.lineWidth;const _=r.textMatrixScale;if(_===0||w===0){const N=r.textRenderingMode&us.FILL_STROKE_MASK;(N===us.STROKE||N===us.FILL_STROKE)&&(w=this.getSinglePixelWidth())}else w/=_;if(o!==1&&(a.scale(o,o),w/=o),a.lineWidth=w,i.isInvalidPDFjsFont){const N=[];let R=0;for(const j of t)N.push(j.unicode),R+=j.width;const z=N.join("");if(a.fillText(z,0,0),this.dependencyTracker!==null){const j=a.measureText(z);this.dependencyTracker.recordBBox(e,this.ctx,-j.actualBoundingBoxLeft,j.actualBoundingBoxRight,-j.actualBoundingBoxAscent,j.actualBoundingBoxDescent).recordShowTextOperation(e)}r.x+=R*y*h,a.restore(),this.compose();return}let E=0,A;for(A=0;A<d;++A){const N=t[A];if(typeof N=="number"){E+=p*N*s/1e3;continue}let R=!1;const z=(N.isSpace?u:0)+l,j=N.fontChar,I=N.accent;let F,$,H=N.width;if(f){const ee=N.vmetric||m,O=-(N.vmetric?ee[1]:H*.5)*y,ue=ee[2]*y;H=ee?-ee[0]:H,F=O/o,$=(E+ue)/o}else F=E/o,$=0;let Z;if(i.remeasure&&H>0){Z=a.measureText(j);const ee=Z.width*1e3/s*o;if(H<ee&&this.isFontSubpixelAAEnabled){const O=H/ee;R=!0,a.save(),a.scale(O,1),F/=O}else H!==ee&&(F+=(H-ee)/2e3*s/o)}if(this.contentVisible&&(N.isInFont||i.missingFile)){if(v&&!I)a.fillText(j,F,$),(M=this.dependencyTracker)==null||M.recordCharacterBBox(e,a,Z?{bbox:null}:i,s/o,F,$,()=>Z??a.measureText(j));else if(this.paintChar(e,j,F,$,b,x),I){const ee=F+s*I.offset.x/o,O=$-s*I.offset.y/o;this.paintChar(e,I.fontChar,ee,O,b,x)}}const J=f?H*y-z*c:H*y+z*c;E+=J,R&&a.restore()}f?r.y-=E:r.x+=E*h,a.restore(),this.compose(),(D=this.dependencyTracker)==null||D.recordShowTextOperation(e)}showType3Text(e,t){const r=this.ctx,i=this.current,s=i.font,a=i.fontSize,o=i.fontDirection,l=s.vertical?1:-1,u=i.charSpacing,c=i.wordSpacing,h=i.textHScale*o,d=i.fontMatrix||H3,f=t.length,p=i.textRenderingMode===us.INVISIBLE;let m,y,v,b;if(p||a===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,r.save(),i.textMatrix&&r.transform(...i.textMatrix),r.translate(i.x,i.y+i.textRise),r.scale(h,o);const x=this.dependencyTracker;for(this.dependencyTracker=x?new uD(x,e):null,m=0;m<f;++m){if(y=t[m],typeof y=="number"){b=l*y*a/1e3,this.ctx.translate(b,0),i.x+=b*h;continue}const w=(y.isSpace?c:0)+u,_=s.charProcOperatorList[y.operatorListId];_?this.contentVisible&&(this.save(),r.scale(a,a),r.transform(...d),this.executeOperatorList(_),this.restore()):Xt(`Type3 character "${y.operatorListId}" is not available.`);const E=[y.width,0];yt.applyTransform(E,d),v=E[0]*a+w,r.translate(v,0),i.x+=v*h}r.restore(),x&&(this.dependencyTracker=x)}setCharWidth(e,t,r){}setCharWidthAndBounds(e,t,r,i,s,a,o){var u;const l=new Path2D;l.rect(i,s,a-i,o-s),this.ctx.clip(l),(u=this.dependencyTracker)==null||u.recordBBox(e,this.ctx,i,a,s,o).recordClipBox(e,this.ctx,i,a,s,o),this.endPath(e)}getColorN_Pattern(e,t){let r;if(t[0]==="TilingPattern"){const i=this.baseTransform||Fr(this.ctx),s={createCanvasGraphics:(a,o)=>new UU(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new uD(this.dependencyTracker,o,!0):null)};r=new bF(t,this.ctx,s,i)}else r=this._getPattern(e,t[1],t[2]);return r}setStrokeColorN(e,...t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,r=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=S0e(this.getObject(e,t)),this.cachedPatterns.set(t,i)),r&&(i.matrix=r),i}shadingFill(e,t){var a;if(!this.contentVisible)return;const r=this.ctx;this.save(e);const i=this._getPattern(e,t);r.fillStyle=i.getPattern(r,this,Du(r),ys.SHADING,e);const s=Du(r);if(s){const{width:o,height:l}=r.canvas,u=ry.slice();yt.axialAlignedBoundingBox([0,0,o,l],s,u);const[c,h,d,f]=u;this.ctx.fillRect(c,h,d-c,f-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(a=this.dependencyTracker)==null||a.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,Xo.transform).recordDependencies(e,Xo.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){fr("Should not call beginInlineImage")}beginImageData(){fr("Should not call beginImageData")}paintFormXObjectBegin(e,t,r){var i;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Fr(this.ctx),r)){yt.axialAlignedBoundingBox(r,this.baseTransform,this.current.minMax);const[s,a,o,l]=r,u=new Path2D;u.rect(s,a,o-s,l-a),this.ctx.clip(u),(i=this.dependencyTracker)==null||i.recordClipBox(e,this.ctx,s,o,a,l),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var x;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const r=this.ctx;t.isolated||gN("TODO: Support non-isolated groups."),t.knockout&&Xt("Knockout groups not supported.");const i=Fr(r);if(t.matrix&&r.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let s=ry.slice();yt.axialAlignedBoundingBox(t.bbox,Fr(r),s);const a=[0,0,r.canvas.width,r.canvas.height];s=yt.intersect(s,a)||[0,0,0,0];const o=Math.floor(s[0]),l=Math.floor(s[1]),u=Math.max(Math.ceil(s[2])-o,1),c=Math.max(Math.ceil(s[3])-l,1);this.current.startNewPathAndClipBox([0,0,u,c]);let h="groupAt"+this.groupLevel;t.smask&&(h+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(h,u,c),f=d.context;f.translate(-o,-l),f.transform(...i);let p=new Path2D;const[m,y,v,b]=t.bbox;if(p.rect(m,y,v-m,b-y),t.matrix){const w=new Path2D;w.addPath(p,new DOMMatrix(t.matrix)),p=w}f.clip(p),t.smask&&this.smaskStack.push({canvas:d.canvas,context:f,offsetX:o,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(r.setTransform(1,0,0,1,0,0),r.translate(o,l),r.save()),y_(r,f),this.ctx=f,(x=this.dependencyTracker)==null||x.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(r),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(r),this.groupLevel++}endGroup(e,t){var s;if(!this.contentVisible)return;this.groupLevel--;const r=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,(s=this.dependencyTracker)==null||s.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=Fr(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...a);const o=ry.slice();yt.axialAlignedBoundingBox([0,0,r.canvas.width,r.canvas.height],a,o),this.ctx.drawImage(r.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(e,t,r,i,s,a){if(X(this,vu,_F).call(this),nT(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),r){const o=r[2]-r[0],l=r[3]-r[1];if(a&&this.annotationCanvasMap){i=i.slice(),i[4]-=r[0],i[5]-=r[1],r=r.slice(),r[0]=r[1]=0,r[2]=o,r[3]=l,yt.singularValueDecompose2dScale(Fr(this.ctx),No);const{viewportScale:u}=this,c=Math.ceil(o*this.outputScaleX*u),h=Math.ceil(l*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(c,h);const{canvas:d,context:f}=this.annotationCanvas;this.annotationCanvasMap.set(t,d),this.annotationCanvas.savedCtx=this.ctx,this.ctx=f,this.ctx.save(),this.ctx.setTransform(No[0],0,0,-No[1],0,l*No[1]),nT(this.ctx)}else{nT(this.ctx),this.endPath(e);const u=new Path2D;u.rect(r[0],r[1],o,l),this.ctx.clip(u)}}this.current=new m8(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...i),this.transform(e,...s)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),X(this,vu,wF).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var o;if(!this.contentVisible)return;const r=t.count;t=this.getObject(e,t.data,t),t.count=r;const i=this.ctx,s=this._createMaskCanvas(e,t),a=s.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,s.offsetX,s.offsetY),(o=this.dependencyTracker)==null||o.resetBBox(e).recordBBox(e,this.ctx,s.offsetX,s.offsetX+a.width,s.offsetY,s.offsetY+a.height).recordOperation(e),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,r,i=0,s=0,a,o){var h,d,f;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const l=this.ctx;l.save();const u=Fr(l);l.transform(r,i,s,a,0,0);const c=this._createMaskCanvas(e,t);l.setTransform(1,0,0,1,c.offsetX-u[4],c.offsetY-u[5]),(h=this.dependencyTracker)==null||h.resetBBox(e);for(let p=0,m=o.length;p<m;p+=2){const y=yt.transform(u,[r,i,s,a,o[p],o[p+1]]);l.drawImage(c.canvas,y[4],y[5]),(d=this.dependencyTracker)==null||d.recordBBox(e,this.ctx,y[4],y[4]+c.canvas.width,y[5],y[5]+c.canvas.height)}l.restore(),this.compose(),(f=this.dependencyTracker)==null||f.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var a,o,l;if(!this.contentVisible)return;const r=this.ctx,i=this.current.fillColor,s=this.current.patternFill;(a=this.dependencyTracker)==null||a.resetBBox(e).recordDependencies(e,Xo.transformAndFill);for(const u of t){const{data:c,width:h,height:d,transform:f}=u,p=this.cachedCanvases.getCanvas("maskCanvas",h,d),m=p.context;m.save();const y=this.getObject(e,c,u);v8(m,y),m.globalCompositeOperation="source-in",m.fillStyle=s?i.getPattern(m,this,Du(r),ys.FILL,e):i,m.fillRect(0,0,h,d),m.restore(),r.save(),r.transform(...f),r.scale(1,-1),tT(r,p.canvas,0,0,h,d,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(e,r,0,h,0,d),r.restore()}this.compose(),(l=this.dependencyTracker)==null||l.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const r=this.getObject(e,t);if(!r){Xt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,r)}paintImageXObjectRepeat(e,t,r,i,s){if(!this.contentVisible)return;const a=this.getObject(e,t);if(!a){Xt("Dependent image isn't ready yet");return}const o=a.width,l=a.height,u=[];for(let c=0,h=s.length;c<h;c+=2)u.push({transform:[r,0,0,i,s[c],s[c+1]],x:0,y:0,w:o,h:l});this.paintInlineImageXObjectGroup(e,a,u)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:r,height:i}=e,s=this.cachedCanvases.getCanvas("inlineImage",r,i),a=s.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",s.canvas}paintInlineImageXObject(e,t){var u;if(!this.contentVisible)return;const r=t.width,i=t.height,s=this.ctx;this.save(e);const{filter:a}=s;a!=="none"&&a!==""&&(s.filter="none"),s.scale(1/r,-1/i);let o;if(t.bitmap)o=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)o=t;else{const h=this.cachedCanvases.getCanvas("inlineImage",r,i).context;g8(h,t),o=this.applyTransferMapsToCanvas(h)}const l=this._scaleImage(o,Du(s));s.imageSmoothingEnabled=y8(Fr(s),t.interpolate),(u=this.dependencyTracker)==null||u.resetBBox(e).recordBBox(e,s,0,r,-i,0).recordDependencies(e,Xo.imageXObject).recordOperation(e),tT(s,l.img,0,0,l.paintWidth,l.paintHeight,0,-i,r,i),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,r){var a,o,l;if(!this.contentVisible)return;const i=this.ctx;let s;if(t.bitmap)s=t.bitmap;else{const u=t.width,c=t.height,d=this.cachedCanvases.getCanvas("inlineImage",u,c).context;g8(d,t),s=this.applyTransferMapsToCanvas(d)}(a=this.dependencyTracker)==null||a.resetBBox(e);for(const u of r)i.save(),i.transform(...u.transform),i.scale(1,-1),tT(i,s,u.x,u.y,u.w,u.h,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(e,i,0,1,-1,0),i.restore();(l=this.dependencyTracker)==null||l.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,Xo.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,r){}beginMarkedContent(e,t){var r;(r=this.dependencyTracker)==null||r.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,r){var i;(i=this.dependencyTracker)==null||i.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(r)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,r){var a,o;const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(r);const s=this.ctx;this.pendingClip?(i||(this.pendingClip===x8?s.clip(t,"evenodd"):s.clip(t)),this.pendingClip=null,(a=this.dependencyTracker)==null||a.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(o=this.dependencyTracker)==null||o.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Fr(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),r=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(r,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:r,c:i,d:s}=this.ctx.getTransform();let a,o;if(r===0&&i===0){const l=Math.abs(t),u=Math.abs(s);if(l===u)if(e===0)a=o=1/l;else{const c=l*e;a=o=c<1?1/c:1}else if(e===0)a=1/l,o=1/u;else{const c=l*e,h=u*e;a=c<1?1/c:1,o=h<1?1/h:1}}else{const l=Math.abs(t*s-r*i),u=Math.hypot(t,r),c=Math.hypot(i,s);if(e===0)a=c/l,o=u/l;else{const h=e*l;a=c>h?c/h:1,o=u>h?u/h:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:r,current:{lineWidth:i}}=this,[s,a]=this.getScaleForStroking();if(s===a){r.lineWidth=(i||1)*s,r.stroke(e);return}const o=r.getLineDash();t&&r.save(),r.scale(s,a),aI.a=1/s,aI.d=1/a;const l=new Path2D;if(l.addPath(e,aI),o.length>0){const u=Math.max(s,a);r.setLineDash(o.map(c=>c/u)),r.lineDashOffset/=u}r.lineWidth=i||1,r.stroke(l),t&&r.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};vu=new WeakSet,_F=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},wF=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},EF=function(e,t,r){const i=new Path2D;return i.addPath(e,new DOMMatrix(r).invertSelf().multiplySelf(t)),i};let by=UU;for(const n in xw)by.prototype[n]!==void 0&&(by.prototype[xw[n]]=by.prototype[n]);var _E,wE;class oc{static get workerPort(){return g(this,_E)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");B(this,_E,e)}static get workerSrc(){return g(this,wE)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");B(this,wE,e)}}_E=new WeakMap,wE=new WeakMap,G(oc,_E,null),G(oc,wE,"");var cx,EE;class I0e{constructor({parsedData:e,rawData:t}){G(this,cx);G(this,EE);B(this,cx,e),B(this,EE,t)}getRaw(){return g(this,EE)}get(e){return g(this,cx).get(e)??null}[Symbol.iterator](){return g(this,cx).entries()}}cx=new WeakMap,EE=new WeakMap;const O0=Symbol("INTERNAL");var SE,AE,TE,hx;class P0e{constructor(e,{name:t,intent:r,usage:i,rbGroups:s}){G(this,SE,!1);G(this,AE,!1);G(this,TE,!1);G(this,hx,!0);B(this,SE,!!(e&Co.DISPLAY)),B(this,AE,!!(e&Co.PRINT)),this.name=t,this.intent=r,this.usage=i,this.rbGroups=s}get visible(){if(g(this,TE))return g(this,hx);if(!g(this,hx))return!1;const{print:e,view:t}=this.usage;return g(this,SE)?(t==null?void 0:t.viewState)!=="OFF":g(this,AE)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,r=!1){e!==O0&&fr("Internal method `_setVisible` called."),B(this,TE,r),B(this,hx,t)}}SE=new WeakMap,AE=new WeakMap,TE=new WeakMap,hx=new WeakMap;var Tf,rr,dx,fx,ME,SF;class F0e{constructor(e,t=Co.DISPLAY){G(this,ME);G(this,Tf,null);G(this,rr,new Map);G(this,dx,null);G(this,fx,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,B(this,fx,e.order);for(const r of e.groups)g(this,rr).set(r.id,new P0e(t,r));if(e.baseState==="OFF")for(const r of g(this,rr).values())r._setVisible(O0,!1);for(const r of e.on)g(this,rr).get(r)._setVisible(O0,!0);for(const r of e.off)g(this,rr).get(r)._setVisible(O0,!1);B(this,dx,this.getHash())}}isVisible(e){if(g(this,rr).size===0)return!0;if(!e)return gN("Optional content group not defined."),!0;if(e.type==="OCG")return g(this,rr).has(e.id)?g(this,rr).get(e.id).visible:(Xt(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return X(this,ME,SF).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!g(this,rr).has(t))return Xt(`Optional content group not found: ${t}`),!0;if(g(this,rr).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!g(this,rr).has(t))return Xt(`Optional content group not found: ${t}`),!0;if(!g(this,rr).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!g(this,rr).has(t))return Xt(`Optional content group not found: ${t}`),!0;if(!g(this,rr).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!g(this,rr).has(t))return Xt(`Optional content group not found: ${t}`),!0;if(g(this,rr).get(t).visible)return!1}return!0}return Xt(`Unknown optional content policy ${e.policy}.`),!0}return Xt(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,r=!0){var s;const i=g(this,rr).get(e);if(!i){Xt(`Optional content group not found: ${e}`);return}if(r&&t&&i.rbGroups.length)for(const a of i.rbGroups)for(const o of a)o!==e&&((s=g(this,rr).get(o))==null||s._setVisible(O0,!1,!0));i._setVisible(O0,!!t,!0),B(this,Tf,null)}setOCGState({state:e,preserveRB:t}){let r;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":r=i;continue}const s=g(this,rr).get(i);if(s)switch(r){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!s.visible,t);break}}B(this,Tf,null)}get hasInitialVisibility(){return g(this,dx)===null||this.getHash()===g(this,dx)}getOrder(){return g(this,rr).size?g(this,fx)?g(this,fx).slice():[...g(this,rr).keys()]:null}getGroup(e){return g(this,rr).get(e)||null}getHash(){if(g(this,Tf)!==null)return g(this,Tf);const e=new dZ;for(const[t,r]of g(this,rr))e.update(`${t}:${r.visible}`);return B(this,Tf,e.hexdigest())}[Symbol.iterator](){return g(this,rr).entries()}}Tf=new WeakMap,rr=new WeakMap,dx=new WeakMap,fx=new WeakMap,ME=new WeakSet,SF=function(e){const t=e.length;if(t<2)return!0;const r=e[0];for(let i=1;i<t;i++){const s=e[i];let a;if(Array.isArray(s))a=X(this,ME,SF).call(this,s);else if(g(this,rr).has(s))a=g(this,rr).get(s).visible;else return Xt(`Optional content group not found: ${s}`),!0;switch(r){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return r==="And"};class L0e{constructor(e,{disableRange:t=!1,disableStream:r=!1}){Sn(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:s,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(s==null?void 0:s.length)>0){const l=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!r,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,u)=>{this._onReceiveData({begin:l,chunk:u})}),e.addProgressListener((l,u)=>{this._onProgress({loaded:l,total:u})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const r=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(r):this._queuedChunks.push(r);else{const i=this._rangeReaders.some(function(s){return s._begin!==e?!1:(s._enqueue(r),!0)});Sn(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,r,i,s;e.total===void 0?(r=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||r.call(t,{loaded:e.loaded}):(s=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||s.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Sn(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new O0e(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new k0e(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeReaders.slice(0))r.cancel(e);this._pdfDataRangeTransport.abort()}}class O0e{constructor(e,t,r=!1,i=null){this._stream=e,this._done=r||!1,this._filename=h4(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class k0e{constructor(e,t,r){this._stream=e,this._begin=t,this._end=r,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function B0e(n){let e=!0,t=r("filename\\*","i").exec(n);if(t){t=t[1];let c=o(t);return c=unescape(c),c=l(c),c=u(c),s(c)}if(t=a(n),t){const c=u(t);return s(c)}if(t=r("filename","i").exec(n),t){t=t[1];let c=o(t);return c=u(c),s(c)}function r(c,h){return new RegExp("(?:^|;)\\s*"+c+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',h)}function i(c,h){if(c){if(!/^[\x00-\xFF]+$/.test(h))return h;try{const d=new TextDecoder(c,{fatal:!0}),f=$S(h);h=d.decode(f),e=!1}catch{}}return h}function s(c){return e&&/[\x80-\xff]/.test(c)&&(c=i("utf-8",c),e&&(c=i("iso-8859-1",c))),c}function a(c){const h=[];let d;const f=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(d=f.exec(c))!==null;){let[,m,y,v]=d;if(m=parseInt(m,10),m in h){if(m===0)break;continue}h[m]=[y,v]}const p=[];for(let m=0;m<h.length&&m in h;++m){let[y,v]=h[m];v=o(v),y&&(v=unescape(v),m===0&&(v=l(v))),p.push(v)}return p.join("")}function o(c){if(c.startsWith('"')){const h=c.slice(1).split('\\"');for(let d=0;d<h.length;++d){const f=h[d].indexOf('"');f!==-1&&(h[d]=h[d].slice(0,f),h.length=d+1),h[d]=h[d].replaceAll(/\\(.)/g,"$1")}c=h.join('"')}return c}function l(c){const h=c.indexOf("'");if(h===-1)return c;const d=c.slice(0,h),p=c.slice(h+1).replace(/^[^']*'/,"");return i(d,p)}function u(c){return!c.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(c)?c:c.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(h,d,f,p){if(f==="q"||f==="Q")return p=p.replaceAll("_"," "),p=p.replaceAll(/=([0-9a-fA-F]{2})/g,function(m,y){return String.fromCharCode(parseInt(y,16))}),i(d,p);try{p=atob(p)}catch{}return i(d,p)})}return""}function SZ(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const r in e){const i=e[r];i!==void 0&&t.append(r,i)}return t}function yN(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function AZ({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:r}){const i={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(n.get("Content-Length"),10);return!Number.isInteger(s)||(i.suggestedLength=s,s<=2*t)||r||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function TZ(n){const e=n.get("Content-Disposition");if(e){let t=B0e(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(h4(t))return t}return null}function WS(n,e){return new rD(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function MZ(n){return n===200||n===206}function CZ(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function DZ(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(Xt(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class U0e{constructor(e){Qe(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=SZ(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Sn(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new V0e(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new z0e(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class V0e{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const r=new Headers(e.headers),i=t.url;fetch(i,CZ(r,this._withCredentials,this._abortController)).then(s=>{if(e._responseOrigin=yN(s.url),!MZ(s.status))throw WS(s.status,i);this._reader=s.body.getReader(),this._headersCapability.resolve();const a=s.headers,{allowRangeRequests:o,suggestedLength:l}=AZ({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=TZ(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Rp("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:DZ(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class z0e{constructor(e,t,r){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const s=new Headers(e.headers);s.append("Range",`bytes=${t}-${r-1}`);const a=i.url;fetch(a,CZ(s,this._withCredentials,this._abortController)).then(o=>{const l=yN(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!MZ(o.status))throw WS(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:DZ(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const oI=200,lI=206;function $0e(n){const e=n.response;return typeof e!="string"?e:$S(e).buffer}class H0e{constructor({url:e,httpHeaders:t,withCredentials:r}){Qe(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=SZ(this.isHttp,t),this.withCredentials=r||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,r=this.currXhrId++,i=this.pendingRequests[r]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[s,a]of this.headers)t.setRequestHeader(s,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=lI):i.expectedStatus=oI,t.responseType="arraybuffer",Sn(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,r),t.onprogress=this.onProgress.bind(this,r),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),r}onProgress(e,t){var i;const r=this.pendingRequests[e];r&&((i=r.onProgress)==null||i.call(r,t))}onStateChange(e,t){const r=this.pendingRequests[e];if(!r)return;const i=r.xhr;if(i.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){r.onError(i.status);return}const s=i.status||oI;if(!(s===oI&&r.expectedStatus===lI)&&s!==r.expectedStatus){r.onError(i.status);return}const o=$0e(i);if(s===lI){const l=i.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);u?r.onDone({begin:parseInt(u[1],10),chunk:o}):(Xt('Missing or invalid "Content-Range" header.'),r.onError(0))}else o?r.onDone({begin:0,chunk:o}):r.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class G0e{constructor(e){this._source=e,this._manager=new H0e(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Sn(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new j0e(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const r=new q0e(this._manager,e,t);return r.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class j0e{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=yN(t.responseURL);const r=t.getAllResponseHeaders(),i=new Headers(r?r.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...u]=o.split(": ");return[l,u.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:a}=AZ({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=TZ(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=WS(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class q0e{constructor(e,t,r){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:r,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=yN((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=WS(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const W0e=/^[a-z][a-z0-9\-+.]+:/i;function X0e(n){if(W0e.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class K0e{constructor(e){this.source=e,this.url=X0e(e.url),Sn(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Sn(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Y0e(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new Q0e(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class Y0e{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const r=process.getBuiltinModule("fs");r.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(r.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=WS(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Rp("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Q0e{constructor(e,t,r){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:t,end:r-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const x_=Symbol("INITIAL_DATA");var po,CE,AF;class NZ{constructor(){G(this,CE);G(this,po,Object.create(null))}get(e,t=null){if(t){const i=X(this,CE,AF).call(this,e);return i.promise.then(()=>t(i.data)),null}const r=g(this,po)[e];if(!r||r.data===x_)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return r.data}has(e){const t=g(this,po)[e];return!!t&&t.data!==x_}delete(e){const t=g(this,po)[e];return!t||t.data===x_?!1:(delete g(this,po)[e],!0)}resolve(e,t=null){const r=X(this,CE,AF).call(this,e);r.data=t,r.resolve()}clear(){var e;for(const t in g(this,po)){const{data:r}=g(this,po)[t];(e=r==null?void 0:r.bitmap)==null||e.close()}B(this,po,Object.create(null))}*[Symbol.iterator](){for(const e in g(this,po)){const{data:t}=g(this,po)[e];t!==x_&&(yield[e,t])}}}po=new WeakMap,CE=new WeakSet,AF=function(e){var t;return(t=g(this,po))[e]||(t[e]={...Promise.withResolvers(),data:x_})};const Z0e=1e5,b8=30;var Dj,Mf,Va,DE,NE,Sg,xh,RE,IE,Ag,px,mx,Cf,gx,PE,vx,Tg,FE,LE,yx,Mg,OE,Df,xx,bd,RZ,IZ,TF,Uo,PM,MF,PZ,FZ;const Si=class Si{constructor({textContentSource:e,container:t,viewport:r}){G(this,bd);G(this,Mf,Promise.withResolvers());G(this,Va,null);G(this,DE,!1);G(this,NE,!!((Dj=globalThis.FontInspector)!=null&&Dj.enabled));G(this,Sg,null);G(this,xh,null);G(this,RE,0);G(this,IE,0);G(this,Ag,null);G(this,px,null);G(this,mx,0);G(this,Cf,0);G(this,gx,Object.create(null));G(this,PE,[]);G(this,vx,null);G(this,Tg,[]);G(this,FE,new WeakMap);G(this,LE,null);var l;if(e instanceof ReadableStream)B(this,vx,e);else if(typeof e=="object")B(this,vx,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');B(this,Va,B(this,px,t)),B(this,Cf,r.scale*Ac.pixelRatio),B(this,mx,r.rotation),B(this,xh,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:s,pageX:a,pageY:o}=r.rawDims;B(this,LE,[1,0,0,-1,-a,o+s]),B(this,IE,i),B(this,RE,s),X(l=Si,Uo,PZ).call(l),Av(t,r),g(this,Mf).promise.finally(()=>{g(Si,xx).delete(this),B(this,xh,null),B(this,gx,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Ts.platform;return Kt(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{g(this,Ag).read().then(({value:t,done:r})=>{if(r){g(this,Mf).resolve();return}g(this,Sg)??B(this,Sg,t.lang),Object.assign(g(this,gx),t.styles),X(this,bd,RZ).call(this,t.items),e()},g(this,Mf).reject)};return B(this,Ag,g(this,vx).getReader()),g(Si,xx).add(this),e(),g(this,Mf).promise}update({viewport:e,onBefore:t=null}){var s;const r=e.scale*Ac.pixelRatio,i=e.rotation;if(i!==g(this,mx)&&(t==null||t(),B(this,mx,i),Av(g(this,px),{rotation:i})),r!==g(this,Cf)){t==null||t(),B(this,Cf,r);const a={div:null,properties:null,ctx:X(s=Si,Uo,PM).call(s,g(this,Sg))};for(const o of g(this,Tg))a.properties=g(this,FE).get(o),a.div=o,X(this,bd,TF).call(this,a)}}cancel(){var t;const e=new Rp("TextLayer task cancelled.");(t=g(this,Ag))==null||t.cancel(e).catch(()=>{}),B(this,Ag,null),g(this,Mf).reject(e)}get textDivs(){return g(this,Tg)}get textContentItemsStr(){return g(this,PE)}static cleanup(){if(!(g(this,xx).size>0)){g(this,yx).clear();for(const{canvas:e}of g(this,Mg).values())e.remove();g(this,Mg).clear()}}};Mf=new WeakMap,Va=new WeakMap,DE=new WeakMap,NE=new WeakMap,Sg=new WeakMap,xh=new WeakMap,RE=new WeakMap,IE=new WeakMap,Ag=new WeakMap,px=new WeakMap,mx=new WeakMap,Cf=new WeakMap,gx=new WeakMap,PE=new WeakMap,vx=new WeakMap,Tg=new WeakMap,FE=new WeakMap,LE=new WeakMap,yx=new WeakMap,Mg=new WeakMap,OE=new WeakMap,Df=new WeakMap,xx=new WeakMap,bd=new WeakSet,RZ=function(e){var i,s;if(g(this,DE))return;(s=g(this,xh)).ctx??(s.ctx=X(i=Si,Uo,PM).call(i,g(this,Sg)));const t=g(this,Tg),r=g(this,PE);for(const a of e){if(t.length>Z0e){Xt("Ignoring additional textDivs for performance reasons."),B(this,DE,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=g(this,Va);B(this,Va,document.createElement("span")),g(this,Va).classList.add("markedContent"),a.id&&g(this,Va).setAttribute("id",`${a.id}`),o.append(g(this,Va))}else a.type==="endMarkedContent"&&B(this,Va,g(this,Va).parentNode);continue}r.push(a.str),X(this,bd,IZ).call(this,a)}},IZ=function(e){var m;const t=document.createElement("span"),r={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};g(this,Tg).push(t);const i=yt.transform(g(this,LE),e.transform);let s=Math.atan2(i[1],i[0]);const a=g(this,gx)[e.fontName];a.vertical&&(s+=Math.PI/2);let o=g(this,NE)&&a.fontSubstitution||a.fontFamily;o=Si.fontFamilyMap.get(o)||o;const l=Math.hypot(i[2],i[3]),u=l*X(m=Si,Uo,FZ).call(m,o,a,g(this,Sg));let c,h;s===0?(c=i[4],h=i[5]-u):(c=i[4]+u*Math.sin(s),h=i[5]-u*Math.cos(s));const d="calc(var(--total-scale-factor) *",f=t.style;g(this,Va)===g(this,px)?(f.left=`${(100*c/g(this,IE)).toFixed(2)}%`,f.top=`${(100*h/g(this,RE)).toFixed(2)}%`):(f.left=`${d}${c.toFixed(2)}px)`,f.top=`${d}${h.toFixed(2)}px)`),f.fontSize=`${d}${(g(Si,Df)*l).toFixed(2)}px)`,f.fontFamily=o,r.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,g(this,NE)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),s!==0&&(r.angle=s*(180/Math.PI));let p=!1;if(e.str.length>1)p=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const y=Math.abs(e.transform[0]),v=Math.abs(e.transform[3]);y!==v&&Math.max(y,v)/Math.min(y,v)>1.5&&(p=!0)}if(p&&(r.canvasWidth=a.vertical?e.height:e.width),g(this,FE).set(t,r),g(this,xh).div=t,g(this,xh).properties=r,X(this,bd,TF).call(this,g(this,xh)),r.hasText&&g(this,Va).append(t),r.hasEOL){const y=document.createElement("br");y.setAttribute("role","presentation"),g(this,Va).append(y)}},TF=function(e){var o;const{div:t,properties:r,ctx:i}=e,{style:s}=t;let a="";if(g(Si,Df)>1&&(a=`scale(${1/g(Si,Df)})`),r.canvasWidth!==0&&r.hasText){const{fontFamily:l}=s,{canvasWidth:u,fontSize:c}=r;X(o=Si,Uo,MF).call(o,i,c*g(this,Cf),l);const{width:h}=i.measureText(t.textContent);h>0&&(a=`scaleX(${u*g(this,Cf)/h}) ${a}`)}r.angle!==0&&(a=`rotate(${r.angle}deg) ${a}`),a.length>0&&(s.transform=a)},Uo=new WeakSet,PM=function(e=null){let t=g(this,Mg).get(e||(e=""));if(!t){const r=document.createElement("canvas");r.className="hiddenCanvasElement",r.lang=e,document.body.append(r),t=r.getContext("2d",{alpha:!1,willReadFrequently:!0}),g(this,Mg).set(e,t),g(this,OE).set(t,{size:0,family:""})}return t},MF=function(e,t,r){const i=g(this,OE).get(e);t===i.size&&r===i.family||(e.font=`${t}px ${r}`,i.size=t,i.family=r)},PZ=function(){if(g(this,Df)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),B(this,Df,e.getBoundingClientRect().height),e.remove()},FZ=function(e,t,r){const i=g(this,yx).get(e);if(i)return i;const s=X(this,Uo,PM).call(this,r);s.canvas.width=s.canvas.height=b8,X(this,Uo,MF).call(this,s,b8,e);const a=s.measureText(""),o=a.fontBoundingBoxAscent,l=Math.abs(a.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let u=.8;return o?u=o/(o+l):(Ts.platform.isFirefox&&Xt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?u=t.ascent:t.descent&&(u=1+t.descent)),g(this,yx).set(e,u),u},G(Si,Uo),G(Si,yx,new Map),G(Si,Mg,new Map),G(Si,OE,new WeakMap),G(Si,Df,null),G(Si,xx,new Set);let _w=Si;const J0e=100;function LZ(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new CF,{docId:t}=e,r=n.url?a0e(n.url):null,i=n.data?o0e(n.data):null,s=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,l=n.range instanceof OZ?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let c=n.worker instanceof ww?n.worker:null;const h=n.verbosity,d=typeof n.docBaseUrl=="string"&&!vN(n.docBaseUrl)?n.docBaseUrl:null,f=QA(n.cMapUrl),p=n.cMapPacked!==!1,m=n.CMapReaderFactory||(ga?m0e:a8),y=QA(n.iccUrl),v=QA(n.standardFontDataUrl),b=n.StandardFontDataFactory||(ga?g0e:o8),x=QA(n.wasmUrl),w=n.WasmFactory||(ga?v0e:l8),_=n.stopAtErrors!==!0,E=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,A=n.isEvalSupported!==!1,T=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!ga,S=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!ga&&(Ts.platform.isFirefox||!globalThis.chrome),M=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,D=typeof n.disableFontFace=="boolean"?n.disableFontFace:ga,N=n.fontExtraProperties===!0,R=n.enableXfa===!0,z=n.ownerDocument||globalThis.document,j=n.disableRange===!0,I=n.disableStream===!0,F=n.disableAutoFetch===!0,$=n.pdfBug===!0,H=n.CanvasFactory||(ga?p0e:h0e),Z=n.FilterFactory||(ga?f0e:d0e),J=n.enableHWA===!0,ee=n.useWasm!==!1,O=l?l.length:n.length??NaN,ue=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!ga&&!D,Q=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(m===a8&&b===o8&&w===l8&&f&&v&&x&&G_(f,document.baseURI)&&G_(v,document.baseURI)&&G_(x,document.baseURI)),re=null;Fve(h);const le={canvasFactory:new H({ownerDocument:z,enableHWA:J}),filterFactory:new Z({docId:t,ownerDocument:z}),cMapReaderFactory:Q?null:new m({baseUrl:f,isCompressed:p}),standardFontDataFactory:Q?null:new b({baseUrl:v}),wasmFactory:Q?null:new w({baseUrl:x})};c||(c=ww.create({verbosity:h,port:oc.workerPort}),e._worker=c);const te={docId:t,apiVersion:"5.4.449",data:i,password:o,disableAutoFetch:F,rangeChunkSize:u,length:O,docBaseUrl:d,enableXfa:R,evaluatorOptions:{maxImageSize:E,disableFontFace:D,ignoreErrors:_,isEvalSupported:A,isOffscreenCanvasSupported:T,isImageDecoderSupported:S,canvasMaxAreaInBytes:M,fontExtraProperties:N,useSystemFonts:ue,useWasm:ee,useWorkerFetch:Q,cMapUrl:f,iccUrl:y,standardFontDataUrl:v,wasmUrl:x}},Y={ownerDocument:z,pdfBug:$,styleElement:re,loadingParams:{disableAutoFetch:F,enableXfa:R}};return c.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");const oe=c.messageHandler.sendWithPromise("GetDocRequest",te,i?[i.buffer]:null);let ve;if(l)ve=new L0e(l,{disableRange:j,disableStream:I});else if(!i){if(!r)throw new Error("getDocument - no `url` parameter provided.");const me=G_(r)?U0e:ga?K0e:G0e;ve=new me({url:r,length:O,httpHeaders:s,withCredentials:a,rangeChunkSize:u,disableRange:j,disableStream:I})}return oe.then(me=>{if(e.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");const be=new Z_(t,me,c.port),_e=new nye(be,e,ve,Y,le,J);e._transport=_e,be.send("Ready",null)})}).catch(e._capability.reject),e}var d2;const f2=class f2{constructor(){Qe(this,"_capability",Promise.withResolvers());Qe(this,"_transport",null);Qe(this,"_worker",null);Qe(this,"docId",`d${Ei(f2,d2)._++}`);Qe(this,"destroyed",!1);Qe(this,"onPassword",null);Qe(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,r,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(s){throw(r=this._worker)!=null&&r.port&&delete this._worker._pendingDestroy,s}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}async getData(){return this._transport.getData()}};d2=new WeakMap,G(f2,d2,0);let CF=f2;var Cg,kE,BE,UE,VE;class OZ{constructor(e,t,r=!1,i=null){G(this,Cg,Promise.withResolvers());G(this,kE,[]);G(this,BE,[]);G(this,UE,[]);G(this,VE,[]);this.length=e,this.initialData=t,this.progressiveDone=r,this.contentDispositionFilename=i}addRangeListener(e){g(this,VE).push(e)}addProgressListener(e){g(this,UE).push(e)}addProgressiveReadListener(e){g(this,BE).push(e)}addProgressiveDoneListener(e){g(this,kE).push(e)}onDataRange(e,t){for(const r of g(this,VE))r(e,t)}onDataProgress(e,t){g(this,Cg).promise.then(()=>{for(const r of g(this,UE))r(e,t)})}onDataProgressiveRead(e){g(this,Cg).promise.then(()=>{for(const t of g(this,BE))t(e)})}onDataProgressiveDone(){g(this,Cg).promise.then(()=>{for(const e of g(this,kE))e()})}transportReady(){g(this,Cg).resolve()}requestDataRange(e,t){fr("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}Cg=new WeakMap,kE=new WeakMap,BE=new WeakMap,UE=new WeakMap,VE=new WeakMap;class eye{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Kt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var bh,Dg,r1;class tye{constructor(e,t,r,i=!1){G(this,Dg);G(this,bh,!1);this._pageIndex=e,this._pageInfo=t,this._transport=r,this._stats=i?new Jz:null,this._pdfBug=i,this.commonObjs=r.commonObjs,this.objs=new NZ,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:r=0,offsetY:i=0,dontFlip:s=!1}={}){return new GS({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:r,offsetY:i,dontFlip:s})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Kt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:r,intent:i="display",annotationMode:s=Jd.ENABLE,transform:a=null,background:o=null,optionalContentConfigPromise:l=null,annotationCanvasMap:u=null,pageColors:c=null,printAnnotationStorage:h=null,isEditing:d=!1,recordOperations:f=!1,operationsFilter:p=null}){var S,M,D;(S=this._stats)==null||S.time("Overall");const m=this._transport.getRenderingIntent(i,s,h,d),{renderingIntent:y,cacheKey:v}=m;B(this,bh,!1),l||(l=this._transport.getOptionalContentConfig(y));let b=this._intentStates.get(v);b||(b=Object.create(null),this._intentStates.set(v,b)),b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null);const x=!!(y&Co.PRINT);b.displayReadyCapability||(b.displayReadyCapability=Promise.withResolvers(),b.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(M=this._stats)==null||M.time("Page Request"),this._pumpOperatorList(m));const w=!!(this._pdfBug&&((D=globalThis.StepperManager)!=null&&D.enabled)),_=!this.recordedBBoxes&&(f||w),E=N=>{var R,z;if(b.renderTasks.delete(A),_){const j=(R=A.gfx)==null?void 0:R.dependencyTracker.take();j&&(A.stepper&&A.stepper.setOperatorBBoxes(j,A.gfx.dependencyTracker.takeDebugMetadata()),f&&(this.recordedBBoxes=j))}x&&B(this,bh,!0),X(this,Dg,r1).call(this),N?(A.capability.reject(N),this._abortOperatorList({intentState:b,reason:N instanceof Error?N:new Error(N)})):A.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(z=globalThis.Stats)!=null&&z.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},A=new DF({callback:E,params:{canvas:t,canvasContext:e,dependencyTracker:_?new x0e(t,b.operatorList.length,w):null,viewport:r,transform:a,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:b.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!x,pdfBug:this._pdfBug,pageColors:c,enableHWA:this._transport.enableHWA,operationsFilter:p});(b.renderTasks||(b.renderTasks=new Set)).add(A);const T=A.task;return Promise.all([b.displayReadyCapability.promise,l]).then(([N,R])=>{var z;if(this.destroyed){E();return}if((z=this._stats)==null||z.time("Rendering"),!(R.renderingIntent&y))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");A.initializeGraphics({transparency:N,optionalContentConfig:R}),A.operatorListChanged()}).catch(E),T}getOperatorList({intent:e="display",annotationMode:t=Jd.ENABLE,printAnnotationStorage:r=null,isEditing:i=!1}={}){var u;function s(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,r,i,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=s,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>bw.textContent(r));const t=this.streamTextContent(e);return new Promise(function(r,i){function s(){a.read().then(function({value:l,done:u}){if(u){r(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),s()},i)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const r of t.renderTasks)e.push(r.completed),r.cancel();return this.objs.clear(),B(this,bh,!1),Promise.all(e)}cleanup(e=!1){B(this,bh,!0);const t=X(this,Dg,r1).call(this);return e&&t&&this._stats&&(this._stats=new Jz),t}_startRenderPage(e,t){var i,s;const r=this._intentStates.get(t);r&&((i=this._stats)==null||i.timeEnd("Page Request"),(s=r.displayReadyCapability)==null||s.resolve(e))}_renderPageChunk(e,t){for(let r=0,i=e.length;r<i;r++)t.operatorList.fnArray.push(e.fnArray[r]),t.operatorList.argsArray.push(e.argsArray[r]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const r of t.renderTasks)r.operatorListChanged();e.lastChunk&&X(this,Dg,r1).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:r,modifiedIds:i}){const{map:s,transfer:a}=r,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:s,modifiedIds:i},a).getReader(),u=this._intentStates.get(t);u.streamReader=l;const c=()=>{l.read().then(({value:h,done:d})=>{if(d){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,u),c())},h=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const d of u.renderTasks)d.operatorListChanged();X(this,Dg,r1).call(this)}if(u.displayReadyCapability)u.displayReadyCapability.reject(h);else if(u.opListReadCapability)u.opListReadCapability.reject(h);else throw h}})};c()}_abortOperatorList({intentState:e,reason:t,force:r=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!r){if(e.renderTasks.size>0)return;if(t instanceof c4){let i=J0e;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Rp(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,s]of this._intentStates)if(s===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}bh=new WeakMap,Dg=new WeakSet,r1=function(){if(!g(this,bh)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),B(this,bh,!1),!0};var Nf,Kl,_h,Ng,p2,Rg,Ig,ba,FM,kZ,BZ,i1,bx,LM;const Tr=class Tr{constructor({name:e=null,port:t=null,verbosity:r=Lve()}={}){G(this,ba);G(this,Nf,Promise.withResolvers());G(this,Kl,null);G(this,_h,null);G(this,Ng,null);if(this.name=e,this.destroyed=!1,this.verbosity=r,t){if(g(Tr,Ig).has(t))throw new Error("Cannot use more than one PDFWorker per port.");g(Tr,Ig).set(t,this),X(this,ba,kZ).call(this,t)}else X(this,ba,BZ).call(this)}get promise(){return g(this,Nf).promise}get port(){return g(this,_h)}get messageHandler(){return g(this,Kl)}destroy(){var e,t;this.destroyed=!0,(e=g(this,Ng))==null||e.terminate(),B(this,Ng,null),g(Tr,Ig).delete(g(this,_h)),B(this,_h,null),(t=g(this,Kl))==null||t.destroy(),B(this,Kl,null)}static create(e){const t=g(this,Ig).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Tr(e)}static get workerSrc(){if(oc.workerSrc)return oc.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Kt(this,"_setupFakeWorkerGlobal",(async()=>g(this,bx,LM)?g(this,bx,LM):(await import(this.workerSrc)).WorkerMessageHandler)())}};Nf=new WeakMap,Kl=new WeakMap,_h=new WeakMap,Ng=new WeakMap,p2=new WeakMap,Rg=new WeakMap,Ig=new WeakMap,ba=new WeakSet,FM=function(){g(this,Nf).resolve(),g(this,Kl).send("configure",{verbosity:this.verbosity})},kZ=function(e){B(this,_h,e),B(this,Kl,new Z_("main","worker",e)),g(this,Kl).on("ready",()=>{}),X(this,ba,FM).call(this)},BZ=function(){if(g(Tr,Rg)||g(Tr,bx,LM)){X(this,ba,i1).call(this);return}let{workerSrc:e}=Tr;try{Tr._isSameOrigin(window.location,e)||(e=Tr._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),r=new Z_("main","worker",t),i=()=>{s.abort(),r.destroy(),t.terminate(),this.destroyed?g(this,Nf).reject(new Error("Worker was destroyed")):X(this,ba,i1).call(this)},s=new AbortController;t.addEventListener("error",()=>{g(this,Ng)||i()},{signal:s.signal}),r.on("test",o=>{if(s.abort(),this.destroyed||!o){i();return}B(this,Kl,r),B(this,_h,t),B(this,Ng,t),X(this,ba,FM).call(this)}),r.on("ready",o=>{if(s.abort(),this.destroyed){i();return}try{a()}catch{X(this,ba,i1).call(this)}});const a=()=>{const o=new Uint8Array;r.send("test",o,[o.buffer])};a();return}catch{gN("The worker has been disabled.")}X(this,ba,i1).call(this)},i1=function(){g(Tr,Rg)||(Xt("Setting up fake worker."),B(Tr,Rg,!0)),Tr._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){g(this,Nf).reject(new Error("Worker was destroyed"));return}const t=new c0e;B(this,_h,t);const r=`fake${Ei(Tr,p2)._++}`,i=new Z_(r+"_worker",r,t);e.setup(i,t),B(this,Kl,new Z_(r,r+"_worker",t)),X(this,ba,FM).call(this)}).catch(e=>{g(this,Nf).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},bx=new WeakSet,LM=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},G(Tr,bx),G(Tr,p2,0),G(Tr,Rg,!1),G(Tr,Ig,new WeakMap),ga&&(B(Tr,Rg,!0),oc.workerSrc||(oc.workerSrc="./pdf.worker.mjs")),Tr._isSameOrigin=(e,t)=>{const r=URL.parse(e);if(!(r!=null&&r.origin)||r.origin==="null")return!1;const i=new URL(t,r);return r.origin===i.origin},Tr._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Tr.fromPort=e=>{if(Wve("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Tr.create(e)};let ww=Tr;var wh,Ku,_x,wx,Eh,Pg,s1;class nye{constructor(e,t,r,i,s,a){G(this,Pg);G(this,wh,new Map);G(this,Ku,new Map);G(this,_x,new Map);G(this,wx,new Map);G(this,Eh,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new NZ,this.fontLoader=new i0e({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=a,this.setupMessageHandler()}get annotationStorage(){return Kt(this,"annotationStorage",new d4)}getRenderingIntent(e,t=Jd.ENABLE,r=null,i=!1,s=!1){let a=Co.DISPLAY,o=hF;switch(e){case"any":a=Co.ANY;break;case"display":break;case"print":a=Co.PRINT;break;default:Xt(`getRenderingIntent - invalid intent: ${e}`)}const l=a&Co.PRINT&&r instanceof pZ?r:this.annotationStorage;switch(t){case Jd.DISABLE:a+=Co.ANNOTATIONS_DISABLE;break;case Jd.ENABLE:break;case Jd.ENABLE_FORMS:a+=Co.ANNOTATIONS_FORMS;break;case Jd.ENABLE_STORAGE:a+=Co.ANNOTATIONS_STORAGE,o=l.serializable;break;default:Xt(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(a+=Co.IS_EDITING),s&&(a+=Co.OPLIST);const{ids:u,hash:c}=l.modifiedIds,h=[a,o.hash,c];return{renderingIntent:a,cacheKey:h.join("_"),annotationStorageSerializable:o,modifiedIds:u}}destroy(){var r;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(r=g(this,Eh))==null||r.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of g(this,Ku).values())e.push(i._destroy());g(this,Ku).clear(),g(this,_x).clear(),g(this,wx).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,s;this.commonObjs.clear(),this.fontLoader.clear(),g(this,wh).clear(),this.filterFactory.destroy(),_w.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Rp("Worker was terminated.")),(s=this.messageHandler)==null||s.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(r,i)=>{Sn(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},i.onPull=()=>{this._fullReader.read().then(function({value:s,done:a}){if(a){i.close();return}Sn(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{this._fullReader.cancel(s),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async r=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:s,contentLength:a}=this._fullReader;return(!i||!s)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:i,isRangeSupported:s,contentLength:a}}),e.on("GetRangeReader",(r,i)=>{Sn(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(r.begin,r.end);if(!s){i.close();return}i.onPull=()=>{s.read().then(function({value:a,done:o}){if(o){i.close();return}Sn(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{s.cancel(a),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,t._capability.resolve(new eye(r,this))}),e.on("DocException",r=>{t._capability.reject(Fa(r))}),e.on("PasswordRequest",r=>{B(this,Eh,Promise.withResolvers());try{if(!t.onPassword)throw Fa(r);const i=s=>{s instanceof Error?g(this,Eh).reject(s):g(this,Eh).resolve({password:s})};t.onPassword(i,r.code)}catch(i){g(this,Eh).reject(i)}return g(this,Eh).promise}),e.on("DataLoaded",r=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),e.on("StartRenderPage",r=>{if(this.destroyed)return;g(this,Ku).get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),e.on("commonobj",([r,i,s])=>{var a;if(this.destroyed||this.commonObjs.has(r))return null;switch(i){case"Font":if("error"in s){const d=s.error;Xt(`Error during font loading: ${d}`),this.commonObjs.resolve(r,d);break}const o=new dF(s),l=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(d,f)=>globalThis.FontInspector.fontAdded(d,f):null,u=new s0e(o,l,s.extra,s.charProcOperatorList);this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:r})).finally(()=>{!u.fontExtraProperties&&u.data&&u.clearData(),this.commonObjs.resolve(r,u)});break;case"CopyLocalImage":const{imageRef:c}=s;Sn(c,"The imageRef must be defined.");for(const d of g(this,Ku).values())for(const[,f]of d.objs)if((f==null?void 0:f.ref)===c)return f.dataLen?(this.commonObjs.resolve(r,structuredClone(f)),f.dataLen):null;break;case"FontPath":case"Image":this.commonObjs.resolve(r,s);break;case"Pattern":const h=new fF(s);this.commonObjs.resolve(r,h.getIR());break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([r,i,s,a])=>{var l;if(this.destroyed)return;const o=g(this,Ku).get(i);if(!o.objs.has(r)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(s){case"Image":case"Pattern":o.objs.resolve(r,a);break;default:throw new Error(`Got unknown object type ${s}`)}}}),e.on("DocProgress",r=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:r.loaded,total:r.total})}),e.on("FetchBinaryData",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[r.type];if(!i)throw new Error(`${r.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(r)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var r;this.annotationStorage.size<=0&&Xt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((r=this._fullReader)==null?void 0:r.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,r=g(this,_x).get(t);if(r)return r;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&g(this,wx).set(s.refStr,e);const a=new tye(t,s,this,this._params.pdfBug);return g(this,Ku).set(t,a),a});return g(this,_x).set(t,i),i}getPageIndex(e){return pF(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return X(this,Pg,s1).call(this,"GetFieldObjects")}hasJSActions(){return X(this,Pg,s1).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return X(this,Pg,s1).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return X(this,Pg,s1).call(this,"GetOptionalContentConfig").then(t=>new F0e(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=g(this,wh).get(e);if(t)return t;const r=this.messageHandler.sendWithPromise(e,null).then(i=>{var s,a;return{info:i[0],metadata:i[1]?new I0e(i[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null,hasStructTree:i[2]}});return g(this,wh).set(e,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of g(this,Ku).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),g(this,wh).clear(),this.filterFactory.destroy(!0),_w.cleanup()}}cachedPageNumber(e){if(!pF(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return g(this,wx).get(t)??null}}wh=new WeakMap,Ku=new WeakMap,_x=new WeakMap,wx=new WeakMap,Eh=new WeakMap,Pg=new WeakSet,s1=function(e,t=null){const r=g(this,wh).get(e);if(r)return r;const i=this.messageHandler.sendWithPromise(e,t);return g(this,wh).set(e,i),i};var Rf;class rye{constructor(e){G(this,Rf,null);Qe(this,"onContinue",null);Qe(this,"onError",null);B(this,Rf,e)}get promise(){return g(this,Rf).capability.promise}cancel(e=0){g(this,Rf).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=g(this,Rf).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=g(this,Rf);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}Rf=new WeakMap;var If,Fg;const Lm=class Lm{constructor({callback:e,params:t,objs:r,commonObjs:i,annotationCanvasMap:s,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:u,useRequestAnimationFrame:c=!1,pdfBug:h=!1,pageColors:d=null,enableHWA:f=!1,operationsFilter:p=null}){G(this,If,null);this.callback=e,this.params=t,this.objs=r,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=u,this._pdfBug=h,this.pageColors=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=c===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new rye(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=f,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=p}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var l,u;if(this.cancelled)return;if(this._canvas){if(g(Lm,Fg).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");g(Lm,Fg).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)!=null&&l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:r,transform:i,background:s,dependencyTracker:a}=this.params,o=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new by(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,a),this.gfx.beginDrawing({transform:i,viewport:r,transparency:e,background:s}),this.operatorListIdx=0,this.graphicsReady=!0,(u=this.graphicsReadyCallback)==null||u.call(this)}cancel(e=null,t=0){var r,i,s;this.running=!1,this.cancelled=!0,(r=this.gfx)==null||r.endDrawing(),g(this,If)&&(window.cancelAnimationFrame(g(this,If)),B(this,If,null)),g(Lm,Fg).delete(this._canvas),e||(e=new c4(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(s=(i=this.task).onError)==null||s.call(i,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?B(this,If,window.requestAnimationFrame(()=>{B(this,If,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),g(Lm,Fg).delete(this._canvas),this.callback())))}};If=new WeakMap,Fg=new WeakMap,G(Lm,Fg,new WeakSet);let DF=Lm;const iye="5.4.449",sye="f44e5f0e6";var mo,Lg,Ex,Mi,zE,Sx,Sh,$E,Pf,Yl,HE,sr,NF,RF,IF,Tm,UZ,Gd;const La=class La{constructor({editor:e=null,uiManager:t=null}){G(this,sr);G(this,mo,null);G(this,Lg,null);G(this,Ex);G(this,Mi,null);G(this,zE,!1);G(this,Sx,!1);G(this,Sh,null);G(this,$E);G(this,Pf,null);G(this,Yl,null);var r,i;e?(B(this,Sx,!1),B(this,Sh,e)):B(this,Sx,!0),B(this,Yl,(e==null?void 0:e._uiManager)||t),B(this,$E,g(this,Yl)._eventBus),B(this,Ex,((r=e==null?void 0:e.color)==null?void 0:r.toUpperCase())||((i=g(this,Yl))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),g(La,HE)||B(La,HE,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Kt(this,"_keyboardManager",new qS([[["Escape","mac+Escape"],La.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],La.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],La.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],La.prototype._moveToPrevious],[["Home","mac+Home"],La.prototype._moveToBeginning],[["End","mac+End"],La.prototype._moveToEnd]]))}renderButton(){const e=B(this,mo,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",g(this,Sh)&&(e.ariaControls=`${g(this,Sh).id}_colorpicker_dropdown`);const t=g(this,Yl)._signal;e.addEventListener("click",X(this,sr,Tm).bind(this),{signal:t}),e.addEventListener("keydown",X(this,sr,IF).bind(this),{signal:t});const r=B(this,Lg,document.createElement("span"));return r.className="swatch",r.ariaHidden="true",r.style.backgroundColor=g(this,Ex),e.append(r),e}renderMainDropdown(){const e=B(this,Mi,X(this,sr,NF).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===g(this,mo)){X(this,sr,Tm).call(this,e);return}const t=e.target.getAttribute("data-color");t&&X(this,sr,RF).call(this,t,e)}_moveToNext(e){var t,r;if(!g(this,sr,Gd)){X(this,sr,Tm).call(this,e);return}if(e.target===g(this,mo)){(t=g(this,Mi).firstElementChild)==null||t.focus();return}(r=e.target.nextSibling)==null||r.focus()}_moveToPrevious(e){var t,r;if(e.target===((t=g(this,Mi))==null?void 0:t.firstElementChild)||e.target===g(this,mo)){g(this,sr,Gd)&&this._hideDropdownFromKeyboard();return}g(this,sr,Gd)||X(this,sr,Tm).call(this,e),(r=e.target.previousSibling)==null||r.focus()}_moveToBeginning(e){var t;if(!g(this,sr,Gd)){X(this,sr,Tm).call(this,e);return}(t=g(this,Mi).firstElementChild)==null||t.focus()}_moveToEnd(e){var t;if(!g(this,sr,Gd)){X(this,sr,Tm).call(this,e);return}(t=g(this,Mi).lastElementChild)==null||t.focus()}hideDropdown(){var e,t;(e=g(this,Mi))==null||e.classList.add("hidden"),g(this,mo).ariaExpanded="false",(t=g(this,Pf))==null||t.abort(),B(this,Pf,null)}_hideDropdownFromKeyboard(){var e;if(!g(this,Sx)){if(!g(this,sr,Gd)){(e=g(this,Sh))==null||e.unselect();return}this.hideDropdown(),g(this,mo).focus({preventScroll:!0,focusVisible:g(this,zE)})}}updateColor(e){if(g(this,Lg)&&(g(this,Lg).style.backgroundColor=e),!g(this,Mi))return;const t=g(this,Yl).highlightColors.values();for(const r of g(this,Mi).children)r.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=g(this,mo))==null||e.remove(),B(this,mo,null),B(this,Lg,null),(t=g(this,Mi))==null||t.remove(),B(this,Mi,null)}};mo=new WeakMap,Lg=new WeakMap,Ex=new WeakMap,Mi=new WeakMap,zE=new WeakMap,Sx=new WeakMap,Sh=new WeakMap,$E=new WeakMap,Pf=new WeakMap,Yl=new WeakMap,HE=new WeakMap,sr=new WeakSet,NF=function(){const e=document.createElement("div"),t=g(this,Yl)._signal;e.addEventListener("contextmenu",Cl,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),g(this,Sh)&&(e.id=`${g(this,Sh).id}_colorpicker_dropdown`);for(const[r,i]of g(this,Yl).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=r,s.setAttribute("data-l10n-id",g(La,HE)[r]);const a=document.createElement("span");s.append(a),a.className="swatch",a.style.backgroundColor=i,s.ariaSelected=i===g(this,Ex),s.addEventListener("click",X(this,sr,RF).bind(this,i),{signal:t}),e.append(s)}return e.addEventListener("keydown",X(this,sr,IF).bind(this),{signal:t}),e},RF=function(e,t){t.stopPropagation(),g(this,$E).dispatch("switchannotationeditorparams",{source:this,type:En.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},IF=function(e){La._keyboardManager.exec(this,e)},Tm=function(e){if(g(this,sr,Gd)){this.hideDropdown();return}if(B(this,zE,e.detail===0),g(this,Pf)||(B(this,Pf,new AbortController),window.addEventListener("pointerdown",X(this,sr,UZ).bind(this),{signal:g(this,Yl).combinedSignal(g(this,Pf))})),g(this,mo).ariaExpanded="true",g(this,Mi)){g(this,Mi).classList.remove("hidden");return}const t=B(this,Mi,X(this,sr,NF).call(this));g(this,mo).append(t)},UZ=function(e){var t;(t=g(this,Mi))!=null&&t.contains(e.target)||this.hideDropdown()},Gd=function(){return g(this,Mi)&&!g(this,Mi).classList.contains("hidden")},G(La,HE,null);let cD=La;var Yu,GE,Ax,jE;const Om=class Om{constructor(e){G(this,Yu,null);G(this,GE,null);G(this,Ax,null);B(this,GE,e),B(this,Ax,e._uiManager),g(Om,jE)||B(Om,jE,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(g(this,Yu))return g(this,Yu);const{editorType:e,colorType:t,color:r}=g(this,GE),i=B(this,Yu,document.createElement("input"));return i.type="color",i.value=r||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",g(Om,jE)[e]),i.addEventListener("input",()=>{g(this,Ax).updateParams(t,i.value)},{signal:g(this,Ax)._signal}),i}update(e){g(this,Yu)&&(g(this,Yu).value=e)}destroy(){var e;(e=g(this,Yu))==null||e.remove(),B(this,Yu,null)}hideDropdown(){}};Yu=new WeakMap,GE=new WeakMap,Ax=new WeakMap,jE=new WeakMap,G(Om,jE,null);let hD=Om;function _8(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function b_(n){return Math.max(0,Math.min(255,255*n))}class w8{static CMYK_G([e,t,r,i]){return["G",1-Math.min(1,.3*e+.59*r+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=b_(e),[e,e,e]}static G_HTML([e]){const t=_8(e);return`#${t}${t}${t}`}static RGB_G([e,t,r]){return["G",.3*e+.59*t+.11*r]}static RGB_rgb(e){return e.map(b_)}static RGB_HTML(e){return`#${e.map(_8).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,r,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,r+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,r,i]){return[b_(1-Math.min(1,e+i)),b_(1-Math.min(1,r+i)),b_(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,r]){const i=1-e,s=1-t,a=1-r,o=Math.min(i,s,a);return["CMYK",i,s,a,o]}}class aye{create(e,t,r=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),r||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){fr("Abstract method `_createSVG` called.")}}class dD extends aye{_createSVG(e){return document.createElementNS(Xc,e)}}const oye=9,Mv=new WeakSet,lye=new Date().getTimezoneOffset()*60*1e3;class uI{static create(e){switch(e.data.annotationType){case fi.LINK:return new m4(e);case fi.TEXT:return new cye(e);case fi.WIDGET:switch(e.data.fieldType){case"Tx":return new hye(e);case"Btn":return e.data.radioButton?new $Z(e):e.data.checkBox?new fye(e):new pye(e);case"Ch":return new mye(e);case"Sig":return new dye(e)}return new Vv(e);case fi.POPUP:return new FF(e);case fi.FREETEXT:return new WZ(e);case fi.LINE:return new vye(e);case fi.SQUARE:return new yye(e);case fi.CIRCLE:return new xye(e);case fi.POLYLINE:return new XZ(e);case fi.CARET:return new _ye(e);case fi.INK:return new g4(e);case fi.POLYGON:return new bye(e);case fi.HIGHLIGHT:return new KZ(e);case fi.UNDERLINE:return new wye(e);case fi.SQUIGGLY:return new Eye(e);case fi.STRIKEOUT:return new Sye(e);case fi.STAMP:return new YZ(e);case fi.FILEATTACHMENT:return new Aye(e);default:return new Br(e)}}}var Og,Tx,ul,qE,PF;const VU=class VU{constructor(e,{isRenderable:t=!1,ignoreBorder:r=!1,createQuadrilaterals:i=!1}={}){G(this,qE);G(this,Og,null);G(this,Tx,!1);G(this,ul,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(r)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return VU._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var r;const{data:e}=this,t=(r=this.annotationStorage)==null?void 0:r.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var o;const e=(o=this.annotationStorage)==null?void 0:o.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:r,rect:i}=this.data;let s=-1/0,a=-1/0;if((t==null?void 0:t.length)>=8){for(let l=0;l<t.length;l+=8)t[l+1]>a?(a=t[l+1],s=t[l+2]):t[l+1]===a&&(s=Math.max(s,t[l+2]));return[s,a]}if((r==null?void 0:r.length)>=1){for(const l of r)for(let u=0,c=l.length;u<c;u+=2)l[u+1]>a?(a=l[u+1],s=l[u]):l[u+1]===a&&(s=Math.max(s,l[u]));if(s!==1/0)return[s,a]}return i?[i[2],i[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:r,pageHeight:i,pageX:s,pageY:a}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-s)/r,e[1]=100*(e[1]-a)/i,e}get commentText(){var t,r,i;const{data:e}=this;return((r=(t=this.annotationStorage.getRawValue(`${yw}${e.id}`))==null?void 0:t.popup)==null?void 0:r.contents)||((i=e.contentsObj)==null?void 0:i.str)||""}set commentText(e){const{data:t}=this,r={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:r})||this.annotationStorage.setValue(`${yw}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:r,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=g(this,ul))==null?void 0:e.popup)||this.popup)==null||t.remove(),B(this,ul,this.popup=null)}updateEdited(e){var s;if(!this.container)return;e.rect&&(g(this,Og)||B(this,Og,{rect:this.data.rect.slice(0)}));const{rect:t,popup:r}=e;t&&X(this,qE,PF).call(this,t);let i=((s=g(this,ul))==null?void 0:s.popup)||this.popup;!i&&(r!=null&&r.text)&&(this._createPopup(r),i=g(this,ul).popup),i&&(i.updateEdited(e),r!=null&&r.deleted&&(i.remove(),B(this,ul,null),this.popup=null))}resetEdited(){var e;g(this,Og)&&(X(this,qE,PF).call(this,g(this,Og).rect),(e=g(this,ul))==null||e.popup.resetEdited(),B(this,Og,null))}_createContainer(e){const{data:t,parent:{page:r,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),!(this instanceof Vv)&&!(this instanceof m4)&&(s.tabIndex=0);const{style:a}=s;if(a.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(s.title=t.alternativeText),t.noRotate&&s.classList.add("norotate"),!t.rect||this instanceof FF){const{rotation:m}=t;return!t.hasOwnCanvas&&m!==0&&this.setRotation(m,s),s}const{width:o,height:l}=this;if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const m=t.borderStyle.horizontalCornerRadius,y=t.borderStyle.verticalCornerRadius;if(m>0||y>0){const b=`calc(${m}px * var(--total-scale-factor)) / calc(${y}px * var(--total-scale-factor))`;a.borderRadius=b}else if(this instanceof $Z){const b=`calc(${o}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;a.borderRadius=b}switch(t.borderStyle.style){case R0.SOLID:a.borderStyle="solid";break;case R0.DASHED:a.borderStyle="dashed";break;case R0.BEVELED:Xt("Unimplemented border style: beveled");break;case R0.INSET:Xt("Unimplemented border style: inset");break;case R0.UNDERLINE:a.borderBottomStyle="solid";break}const v=t.borderColor||null;v?(B(this,Tx,!0),a.borderColor=yt.makeHexColor(v[0]|0,v[1]|0,v[2]|0)):a.borderWidth=0}const u=yt.normalizeRect([t.rect[0],r.view[3]-t.rect[1]+r.view[1],t.rect[2],r.view[3]-t.rect[3]+r.view[1]]),{pageWidth:c,pageHeight:h,pageX:d,pageY:f}=i.rawDims;a.left=`${100*(u[0]-d)/c}%`,a.top=`${100*(u[1]-f)/h}%`;const{rotation:p}=t;return t.hasOwnCanvas||p===0?(a.width=`${100*o/c}%`,a.height=`${100*l/h}%`):this.setRotation(p,s),s}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:r,pageHeight:i}=this.parent.viewport.rawDims;let{width:s,height:a}=this;e%180!==0&&([s,a]=[a,s]),t.style.width=`${100*s/r}%`,t.style.height=`${100*a/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,r,i)=>{const s=i.detail[t],a=s[0],o=s.slice(1);i.target.style[r]=w8[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[r]:w8[`${a}_rgb`](o)})};return Kt(this,"_commonActions",{display:t=>{const{display:r}=t.detail,i=r%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:r===1||r===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:r}=t.detail;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:r,noView:r})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const r=t.detail.rotation;this.setRotation(r),this.annotationStorage.setValue(this.data.id,{rotation:r})}})}_dispatchEventFromSandbox(e,t){const r=this._commonActions;for(const i of Object.keys(t.detail)){const s=e[i]||r[i];s==null||s(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const r=this._commonActions;for(const[i,s]of Object.entries(t)){const a=r[i];if(a){const o={detail:{[i]:s},target:e};a(o),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,r,i,s]=this.data.rect.map(m=>Math.fround(m));if(e.length===8){const[m,y,v,b]=e.subarray(2,6);if(i===m&&s===y&&t===v&&r===b)return}const{style:a}=this.container;let o;if(g(this,Tx)){const{borderColor:m,borderWidth:y}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${m}" stroke-width="${y}">`],this.container.classList.add("hasBorder")}const l=i-t,u=s-r,{svgFactory:c}=this,h=c.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0),h.role="none";const d=c.createElement("defs");h.append(d);const f=c.createElement("clipPath"),p=`clippath_${this.data.id}`;f.setAttribute("id",p),f.setAttribute("clipPathUnits","objectBoundingBox"),d.append(f);for(let m=2,y=e.length;m<y;m+=8){const v=e[m],b=e[m+1],x=e[m+2],w=e[m+3],_=c.createElement("rect"),E=(x-t)/l,A=(s-b)/u,T=(v-x)/l,S=(b-w)/u;_.setAttribute("x",E),_.setAttribute("y",A),_.setAttribute("width",T),_.setAttribute("height",S),f.append(_),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${E}" y="${A}" width="${T}" height="${S}"/>`)}g(this,Tx)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(h),this.container.style.clipPath=`url(#${p})`}_createPopup(e=null){const{data:t}=this;let r,i;e?(r={str:e.text},i=e.date):(r=t.contentsObj,i=t.modificationDate),B(this,ul,new FF({data:{color:t.color,titleObj:t.titleObj,modificationDate:i,contentsObj:r,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(g(this,ul)||this.popup||this.data.popupRef)}get extraPopupElement(){return g(this,ul)}render(){fr("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const r=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:s,id:a,exportValues:o}of i){if(s===-1||a===t)continue;const l=typeof o=="string"?o:null,u=document.querySelector(`[data-element-id="${a}"]`);if(u&&!Mv.has(u)){Xt(`_getElementsByName - element not allowed: ${a}`);continue}r.push({id:a,exportValue:l,domElement:u})}return r}for(const i of document.getElementsByName(e)){const{exportValue:s}=i,a=i.getAttribute("data-element-id");a!==t&&Mv.has(i)&&r.push({id:a,exportValue:s,domElement:i})}return r}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var r;(r=this.linkService.eventBus)==null||r.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Og=new WeakMap,Tx=new WeakMap,ul=new WeakMap,qE=new WeakSet,PF=function(e){const{container:{style:t},data:{rect:r,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}}}=this;r==null||r.splice(0,4,...e),t.left=`${100*(e[0]-o)/s}%`,t.top=`${100*(a-e[3]+l)/a}%`,i===0?(t.width=`${100*(e[2]-e[0])/s}%`,t.height=`${100*(e[3]-e[1])/a}%`):this.setRotation(i)};let Br=VU;class uye extends Br{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var Po,Mm,VZ,zZ;class m4 extends Br{constructor(t,r=null){super(t,{isRenderable:!0,ignoreBorder:!!(r!=null&&r.ignoreBorder),createQuadrilaterals:!0});G(this,Po);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:r}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let s=!1;return t.url?(r.addLinkAttributes(i,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),s=!0):t.attachment?(X(this,Po,VZ).call(this,i,t.attachment,t.overlaidText,t.attachmentDest),s=!0):t.setOCGState?(X(this,Po,zZ).call(this,i,t.setOCGState,t.overlaidText),s=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),s=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&(this.contentElement=i,this.container.append(i)),this.container}_bindLink(t,r,i=""){t.href=this.linkService.getDestinationHash(r),t.onclick=()=>(r&&this.linkService.goToDestination(r),!1),(r||r==="")&&X(this,Po,Mm).call(this),i&&(t.title=i)}_bindNamedAction(t,r,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(r),!1),i&&(t.title=i),X(this,Po,Mm).call(this)}_bindJSAction(t,r){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(r.actions)){const a=i.get(s);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r.id,name:s}}),!1})}r.overlaidText&&(t.title=r.overlaidText),t.onclick||(t.onclick=()=>!1),X(this,Po,Mm).call(this)}_bindResetFormAction(t,r){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),X(this,Po,Mm).call(this),!this._fieldObjects){Xt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var h;i==null||i();const{fields:s,refs:a,include:o}=r,l=[];if(s.length!==0||a.length!==0){const d=new Set(a);for(const f of s){const p=this._fieldObjects[f]||[];for(const{id:m}of p)d.add(m)}for(const f of Object.values(this._fieldObjects))for(const p of f)d.has(p.id)===o&&l.push(p)}else for(const d of Object.values(this._fieldObjects))l.push(...d);const u=this.annotationStorage,c=[];for(const d of l){const{id:f}=d;switch(c.push(f),d.type){case"text":{const m=d.defaultValue||"";u.setValue(f,{value:m});break}case"checkbox":case"radiobutton":{const m=d.defaultValue===d.exportValues;u.setValue(f,{value:m});break}case"combobox":case"listbox":{const m=d.defaultValue||"";u.setValue(f,{value:m});break}default:continue}const p=document.querySelector(`[data-element-id="${f}"]`);if(p){if(!Mv.has(p)){Xt(`_bindResetFormAction - element not allowed: ${f}`);continue}}else continue;p.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((h=this.linkService.eventBus)==null||h.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:c,name:"ResetForm"}})),!1}}}Po=new WeakSet,Mm=function(){this.container.setAttribute("data-internal-link","")},VZ=function(t,r,i="",s=null){t.href=this.linkService.getAnchorUrl(""),r.description?t.title=r.description:i&&(t.title=i),t.onclick=()=>{var a;return(a=this.downloadManager)==null||a.openOrDownloadData(r.content,r.filename,s),!1},X(this,Po,Mm).call(this)},zZ=function(t,r,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(r),!1),i&&(t.title=i),X(this,Po,Mm).call(this)};class cye extends Br{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class Vv extends Br{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Ts.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,r,i,s){r.includes("mouse")?e.addEventListener(r,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(r,a=>{var o;if(r==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(r==="focus"){if(t.focused)return;t.focused=!0}s&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(a)}}))})}_setEventListeners(e,t,r,i){var s,a,o;for(const[l,u]of r)(u==="Action"||(s=this.data.actions)!=null&&s[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,u,i),u==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":yt.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:r}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||oye,s=e.style;let a;const o=2,l=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o),c=Math.round(u/(tI*i))||1,h=u/c;a=Math.min(i,l(h/tI))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(i,l(u/tI))}s.fontSize=`calc(${a}px * var(--total-scale-factor))`,s.color=yt.makeHexColor(r[0],r[1],r[2]),this.data.textAlignment!==null&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class hye extends Vv{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,r,i){const s=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=r),s.setValue(a.id,{[i]:r})}render(){var i,s;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let r=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let u=a.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const c={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=u??o,this.data.doNotScroll&&(r.style.overflowY="hidden")):(r=document.createElement("input"),r.type=this.data.password?"password":"text",r.setAttribute("value",u??o),this.data.doNotScroll&&(r.style.overflowX="hidden")),this.data.hasOwnCanvas&&(r.hidden=!0),Mv.add(r),this.contentElement=r,r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=0;const{datetimeFormat:h,datetimeType:d,timeStep:f}=this.data,p=!!d&&this.enableScripting;h&&(r.title=h),this._setRequired(r,this.data.required),l&&(r.maxLength=l),r.addEventListener("input",y=>{e.setValue(t,{value:y.target.value}),this.setPropertyOnSiblings(r,"value",y.target.value,"value"),c.formattedValue=null}),r.addEventListener("resetform",y=>{const v=this.data.defaultFieldValue??"";r.value=c.userValue=v,c.formattedValue=null});let m=y=>{const{formattedValue:v}=c;v!=null&&(y.target.value=v),y.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",v=>{var x;if(c.focused)return;const{target:b}=v;if(p&&(b.type=d,f&&(b.step=f)),c.userValue){const w=c.userValue;if(p)if(d==="time"){const _=new Date(w),E=[_.getHours(),_.getMinutes(),_.getSeconds()];b.value=E.map(A=>A.toString().padStart(2,"0")).join(":")}else b.value=new Date(w-lye).toISOString().split(d==="date"?"T":".",1)[0];else b.value=w}c.lastCommittedValue=b.value,c.commitKey=1,(x=this.data.actions)!=null&&x.Focus||(c.focused=!0)}),r.addEventListener("updatefromsandbox",v=>{this.showElementAndHideCanvas(v.target);const b={value(x){c.userValue=x.detail.value??"",p||e.setValue(t,{value:c.userValue.toString()}),x.target.value=c.userValue},formattedValue(x){const{formattedValue:w}=x.detail;c.formattedValue=w,w!=null&&x.target!==document.activeElement&&(x.target.value=w);const _={formattedValue:w};p&&(_.value=w),e.setValue(t,_)},selRange(x){x.target.setSelectionRange(...x.detail.selRange)},charLimit:x=>{var A;const{charLimit:w}=x.detail,{target:_}=x;if(w===0){_.removeAttribute("maxLength");return}_.setAttribute("maxLength",w);let E=c.userValue;!E||E.length<=w||(E=E.slice(0,w),_.value=c.userValue=E,e.setValue(t,{value:E}),(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:1,selStart:_.selectionStart,selEnd:_.selectionEnd}}))}};this._dispatchEventFromSandbox(b,v)}),r.addEventListener("keydown",v=>{var w;c.commitKey=1;let b=-1;if(v.key==="Escape"?b=0:v.key==="Enter"&&!this.data.multiLine?b=2:v.key==="Tab"&&(c.commitKey=3),b===-1)return;const{value:x}=v.target;c.lastCommittedValue!==x&&(c.lastCommittedValue=x,c.userValue=x,(w=this.linkService.eventBus)==null||w.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,willCommit:!0,commitKey:b,selStart:v.target.selectionStart,selEnd:v.target.selectionEnd}}))});const y=m;m=null,r.addEventListener("blur",v=>{var w,_;if(!c.focused||!v.relatedTarget)return;(w=this.data.actions)!=null&&w.Blur||(c.focused=!1);const{target:b}=v;let{value:x}=b;if(p){if(x&&d==="time"){const E=x.split(":").map(A=>parseInt(A,10));x=new Date(2e3,0,1,E[0],E[1],E[2]||0).valueOf(),b.step=""}else x.includes("T")||(x=`${x}T00:00`),x=new Date(x).valueOf();b.type="text"}c.userValue=x,c.lastCommittedValue!==x&&((_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,willCommit:!0,commitKey:c.commitKey,selStart:v.target.selectionStart,selEnd:v.target.selectionEnd}})),y(v)}),(s=this.data.actions)!=null&&s.Keystroke&&r.addEventListener("beforeinput",v=>{var S;c.lastCommittedValue=null;const{data:b,target:x}=v,{value:w,selectionStart:_,selectionEnd:E}=x;let A=_,T=E;switch(v.inputType){case"deleteWordBackward":{const M=w.substring(0,_).match(/\w*[^\w]*$/);M&&(A-=M[0].length);break}case"deleteWordForward":{const M=w.substring(_).match(/^[^\w]*\w*/);M&&(T+=M[0].length);break}case"deleteContentBackward":_===E&&(A-=1);break;case"deleteContentForward":_===E&&(T+=1);break}v.preventDefault(),(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,change:b||"",willCommit:!1,selStart:A,selEnd:T}})}),this._setEventListeners(r,c,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],v=>v.target.value)}if(m&&r.addEventListener("blur",m),this.data.comb){const v=(this.data.rect[2]-this.data.rect[0])/l;r.classList.add("comb"),r.style.letterSpacing=`calc(${v}px * var(--total-scale-factor) - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell",this.data.hasOwnCanvas&&(r.hidden=!0);return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class dye extends Vv{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class fye extends Vv{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,r=t.id;let i=e.getValue(r,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(r,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return Mv.add(s),s.setAttribute("data-element-id",r),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",t.exportValue),s.tabIndex=0,s.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const u of this._getElementsByName(o,r)){const c=l&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=c),e.setValue(u.id,{value:c})}e.setValue(r,{value:l})}),s.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(r,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class $Z extends Vv{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,r=t.id;let i=e.getValue(r,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(r,{value:i})),i)for(const a of this._getElementsByName(t.fieldName,r))e.setValue(a.id,{value:!1});const s=document.createElement("input");if(Mv.add(s),s.setAttribute("data-element-id",r),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=0,s.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const u of this._getElementsByName(o,r))e.setValue(u.id,{value:!1});e.setValue(r,{value:l})}),s.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;s.addEventListener("updatefromsandbox",o=>{const l={value:u=>{const c=a===u.detail.value;for(const h of this._getElementsByName(u.target.name)){const d=c&&h.id===r;h.domElement&&(h.domElement.checked=d),e.setValue(h.id,{value:d})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class pye extends m4{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",r=>{this._dispatchEventFromSandbox({},r)})),e}}class mye extends Vv{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,r=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");Mv.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",c=>{const h=this.data.defaultFieldValue;for(const d of i.options)d.selected=d.value===h});for(const c of this.data.options){const h=document.createElement("option");h.textContent=c.displayValue,h.value=c.exportValue,r.value.includes(c.exportValue)&&(h.setAttribute("selected",!0),s=!1),i.append(h)}let a=null;if(s){const c=document.createElement("option");c.value=" ",c.setAttribute("hidden",!0),c.setAttribute("selected",!0),i.prepend(c),a=()=>{c.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const o=c=>{const h=c?"value":"textContent",{options:d,multiple:f}=i;return f?Array.prototype.filter.call(d,p=>p.selected).map(p=>p[h]):d.selectedIndex===-1?null:d[d.selectedIndex][h]};let l=o(!1);const u=c=>{const h=c.target.options;return Array.prototype.map.call(h,d=>({displayValue:d.textContent,exportValue:d.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",c=>{const h={value(d){a==null||a();const f=d.detail.value,p=new Set(Array.isArray(f)?f:[f]);for(const m of i.options)m.selected=p.has(m.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(d){i.multiple=!0},remove(d){const f=i.options,p=d.detail.remove;f[p].selected=!1,i.remove(p),f.length>0&&Array.prototype.findIndex.call(f,y=>y.selected)===-1&&(f[0].selected=!0),e.setValue(t,{value:o(!0),items:u(d)}),l=o(!1)},clear(d){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(d){const{index:f,displayValue:p,exportValue:m}=d.detail.insert,y=i.children[f],v=document.createElement("option");v.textContent=p,v.value=m,y?y.before(v):i.append(v),e.setValue(t,{value:o(!0),items:u(d)}),l=o(!1)},items(d){const{items:f}=d.detail;for(;i.length!==0;)i.remove(0);for(const p of f){const{displayValue:m,exportValue:y}=p,v=document.createElement("option");v.textContent=m,v.value=y,i.append(v)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:o(!0),items:u(d)}),l=o(!1)},indices(d){const f=new Set(d.detail.indices);for(const p of d.target.options)p.selected=f.has(p.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(d){d.target.disabled=!d.detail.editable}};this._dispatchEventFromSandbox(h,c)}),i.addEventListener("input",c=>{var f;const h=o(!0),d=o(!1);e.setValue(t,{value:h}),c.preventDefault(),(f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:d,changeEx:h,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],c=>c.target.value)):i.addEventListener("input",function(c){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}var WE,LF;class FF extends Br{constructor(t){const{data:r,elements:i,parent:s}=t,a=!!s._commentManager;super(t,{isRenderable:!a&&Br._hasPopupData(r)});G(this,WE);if(this.elements=i,a&&Br._hasPopupData(r)){const o=this.popup=X(this,WE,LF).call(this);for(const l of i)l.popup=o}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const r=this.popup=X(this,WE,LF).call(this),i=[];for(const s of this.elements)s.popup=r,s.container.ariaHasPopup="dialog",i.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(s=>`${ny}${s}`).join(",")),this.container}}WE=new WeakSet,LF=function(){return new gye({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var go,Ff,m2,g2,Mx,Cx,jr,Qu,Lf,kg,Dx,Nx,Zu,vo,Ah,Th,qr,Mh,Of,XE,Ch,Rx,Bg,kf,Ki,Bf,on,OM,OF,kF,BF,kM,UF,HZ,GZ,jZ,qZ,BM,UM,VF;class gye{constructor({container:e,color:t,elements:r,titleObj:i,modificationDate:s,contentsObj:a,richText:o,parent:l,rect:u,parentRect:c,open:h,commentManager:d=null}){G(this,on);G(this,go,null);G(this,Ff,X(this,on,jZ).bind(this));G(this,m2,X(this,on,VF).bind(this));G(this,g2,X(this,on,UM).bind(this));G(this,Mx,X(this,on,BM).bind(this));G(this,Cx,null);G(this,jr,null);G(this,Qu,null);G(this,Lf,null);G(this,kg,null);G(this,Dx,null);G(this,Nx,null);G(this,Zu,!1);G(this,vo,null);G(this,Ah,null);G(this,Th,null);G(this,qr,null);G(this,Mh,null);G(this,Of,null);G(this,XE,null);G(this,Ch,null);G(this,Rx,null);G(this,Bg,null);G(this,kf,!1);G(this,Ki,null);G(this,Bf,null);B(this,jr,e),B(this,Rx,i),B(this,Qu,a),B(this,Ch,o),B(this,Dx,l),B(this,Cx,t),B(this,XE,u),B(this,Nx,c),B(this,kg,r),B(this,go,d),B(this,Ki,r[0]),B(this,Lf,iD.toDateObject(s)),this.trigger=r.flatMap(f=>f.getElementsToTriggerPopup()),d||(X(this,on,OM).call(this),g(this,jr).hidden=!0,h&&X(this,on,BM).call(this))}renderCommentButton(){if(g(this,qr)){g(this,qr).parentNode||g(this,Ki).container.after(g(this,qr));return}if(g(this,Mh)||X(this,on,OF).call(this),!g(this,Mh))return;const{signal:e}=B(this,Ah,new AbortController),t=g(this,Ki).hasOwnCommentButton,r=()=>{g(this,go).toggleCommentPopup(this,!0,void 0,!t)},i=()=>{g(this,go).toggleCommentPopup(this,!1,!0,!t)},s=()=>{g(this,go).toggleCommentPopup(this,!1,!1)};if(t){B(this,qr,g(this,Ki).container);for(const a of this.trigger)a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.addEventListener("keydown",g(this,Ff),{signal:e}),a.addEventListener("click",r,{signal:e}),a.addEventListener("pointerenter",i,{signal:e}),a.addEventListener("pointerleave",s,{signal:e}),a.classList.add("popupTriggerArea")}else{const a=B(this,qr,document.createElement("button"));a.className="annotationCommentButton";const o=g(this,Ki).container;a.style.zIndex=o.style.zIndex+1,a.tabIndex=0,a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.setAttribute("data-l10n-id","pdfjs-show-comment-button"),X(this,on,BF).call(this),X(this,on,kF).call(this),a.addEventListener("keydown",g(this,Ff),{signal:e}),a.addEventListener("click",r,{signal:e}),a.addEventListener("pointerenter",i,{signal:e}),a.addEventListener("pointerleave",s,{signal:e}),o.after(a)}}get commentButtonColor(){const{color:e,opacity:t}=g(this,Ki).commentData;return e?g(this,Dx)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=g(this,qr))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:r,creationDate:i,modificationDate:s}=g(this,Ki).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:r,creationDate:i,modificationDate:s}}get elementBeforePopup(){return g(this,qr)}get comment(){return g(this,Bf)||B(this,Bf,g(this,Ki).commentText),g(this,Bf)}set comment(e){e!==this.comment&&(g(this,Ki).commentText=B(this,Bf,e))}focus(){var e;(e=g(this,Ki).container)==null||e.focus()}get parentBoundingClientRect(){return g(this,Ki).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){g(this,qr)&&(g(this,qr).classList.toggle("selected",e),g(this,qr).ariaExpanded=t)}setSelectedCommentButton(e){g(this,qr).classList.toggle("selected",e)}get commentPopupPosition(){if(g(this,Of))return g(this,Of);const{x:e,y:t,height:r}=g(this,qr).getBoundingClientRect(),{x:i,y:s,width:a,height:o}=g(this,Ki).layer.getBoundingClientRect();return[(e-i)/a,(t+r-s)/o]}set commentPopupPosition(e){B(this,Of,e)}hasDefaultPopupPosition(){return g(this,Of)===null}get commentButtonPosition(){return g(this,Mh)}get commentButtonWidth(){return g(this,qr).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,r]=g(this,Of)||this.commentButtonPosition.map(u=>u/100),i=this.parentBoundingClientRect,{x:s,y:a,width:o,height:l}=i;g(this,go).showDialog(null,this,s+t*o,a+r*l,{...e,parentDimensions:i})}render(){var r,i;if(g(this,vo))return;const e=B(this,vo,document.createElement("div"));if(e.className="popup",g(this,Cx)){const s=e.style.outlineColor=yt.makeHexColor(...g(this,Cx));e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const t=document.createElement("span");if(t.className="header",(r=g(this,Rx))!=null&&r.str){const s=document.createElement("span");s.className="title",t.append(s),{dir:s.dir,str:s.textContent}=g(this,Rx)}if(e.append(t),g(this,Lf)){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:g(this,Lf).valueOf()})),s.dateTime=g(this,Lf).toISOString(),t.append(s)}PQ({html:g(this,on,kM)||g(this,Qu).str,dir:(i=g(this,Qu))==null?void 0:i.dir,className:"popupContent"},e),g(this,jr).append(e)}updateEdited({rect:e,popup:t,deleted:r}){var i;if(g(this,go)){r?(this.remove(),B(this,Bf,null)):t&&(t.deleted?this.remove():(X(this,on,BF).call(this),B(this,Bf,t.text))),e&&(B(this,Mh,null),X(this,on,OF).call(this),X(this,on,kF).call(this));return}if(r||t!=null&&t.deleted){this.remove();return}X(this,on,OM).call(this),g(this,Bg)||B(this,Bg,{contentsObj:g(this,Qu),richText:g(this,Ch)}),e&&B(this,Th,null),t&&t.text&&(B(this,Ch,X(this,on,GZ).call(this,t.text)),B(this,Lf,iD.toDateObject(t.date)),B(this,Qu,null)),(i=g(this,vo))==null||i.remove(),B(this,vo,null)}resetEdited(){var e;g(this,Bg)&&({contentsObj:Ei(this,Qu)._,richText:Ei(this,Ch)._}=g(this,Bg),B(this,Bg,null),(e=g(this,vo))==null||e.remove(),B(this,vo,null),B(this,Th,null))}remove(){var e,t,r;if((e=g(this,Ah))==null||e.abort(),B(this,Ah,null),(t=g(this,vo))==null||t.remove(),B(this,vo,null),B(this,kf,!1),B(this,Zu,!1),(r=g(this,qr))==null||r.remove(),B(this,qr,null),this.trigger)for(const i of this.trigger)i.classList.remove("popupTriggerArea")}forceHide(){B(this,kf,this.isVisible),g(this,kf)&&(g(this,jr).hidden=!0)}maybeShow(){g(this,go)||(X(this,on,OM).call(this),g(this,kf)&&(g(this,vo)||X(this,on,UM).call(this),B(this,kf,!1),g(this,jr).hidden=!1))}get isVisible(){return g(this,go)?!1:g(this,jr).hidden===!1}}go=new WeakMap,Ff=new WeakMap,m2=new WeakMap,g2=new WeakMap,Mx=new WeakMap,Cx=new WeakMap,jr=new WeakMap,Qu=new WeakMap,Lf=new WeakMap,kg=new WeakMap,Dx=new WeakMap,Nx=new WeakMap,Zu=new WeakMap,vo=new WeakMap,Ah=new WeakMap,Th=new WeakMap,qr=new WeakMap,Mh=new WeakMap,Of=new WeakMap,XE=new WeakMap,Ch=new WeakMap,Rx=new WeakMap,Bg=new WeakMap,kf=new WeakMap,Ki=new WeakMap,Bf=new WeakMap,on=new WeakSet,OM=function(){var t;if(g(this,Ah))return;B(this,Ah,new AbortController);const{signal:e}=g(this,Ah);for(const r of this.trigger)r.addEventListener("click",g(this,Mx),{signal:e}),r.addEventListener("pointerenter",g(this,g2),{signal:e}),r.addEventListener("pointerleave",g(this,m2),{signal:e}),r.classList.add("popupTriggerArea");for(const r of g(this,kg))(t=r.container)==null||t.addEventListener("keydown",g(this,Ff),{signal:e})},OF=function(){const e=g(this,kg).find(t=>t.hasCommentButton);e&&B(this,Mh,e._normalizePoint(e.commentButtonPosition))},kF=function(){if(g(this,Ki).extraPopupElement&&!g(this,Ki).editor)return;g(this,qr)||this.renderCommentButton();const[e,t]=g(this,Mh),{style:r}=g(this,qr);r.left=`calc(${e}%)`,r.top=`calc(${t}% - var(--comment-button-dim))`},BF=function(){g(this,Ki).extraPopupElement||(g(this,qr)||this.renderCommentButton(),g(this,qr).style.backgroundColor=this.commentButtonColor||"")},kM=function(){const e=g(this,Ch),t=g(this,Qu);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&g(this,Ch).html||null},UF=function(){var e,t,r;return((r=(t=(e=g(this,on,kM))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:r.fontSize)||0},HZ=function(){var e,t,r;return((r=(t=(e=g(this,on,kM))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:r.color)||null},GZ=function(e){const t=[],r={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:g(this,on,HZ),fontSize:g(this,on,UF)?`calc(${g(this,on,UF)}px * var(--total-scale-factor))`:""}};for(const s of e.split(`
`))t.push({name:"span",value:s,attributes:i});return r},jZ=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&g(this,Zu))&&X(this,on,BM).call(this)},qZ=function(){if(g(this,Th)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:r,pageX:i,pageY:s}}}=g(this,Dx);let a=!!g(this,Nx),o=a?g(this,Nx):g(this,XE);for(const p of g(this,kg))if(!o||yt.intersect(p.data.rect,o)!==null){o=p.data.rect,a=!0;break}const l=yt.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),c=a?o[2]-o[0]+5:0,h=l[0]+c,d=l[1];B(this,Th,[100*(h-i)/t,100*(d-s)/r]);const{style:f}=g(this,jr);f.left=`${g(this,Th)[0]}%`,f.top=`${g(this,Th)[1]}%`},BM=function(){if(g(this,go)){g(this,go).toggleCommentPopup(this,!1);return}B(this,Zu,!g(this,Zu)),g(this,Zu)?(X(this,on,UM).call(this),g(this,jr).addEventListener("click",g(this,Mx)),g(this,jr).addEventListener("keydown",g(this,Ff))):(X(this,on,VF).call(this),g(this,jr).removeEventListener("click",g(this,Mx)),g(this,jr).removeEventListener("keydown",g(this,Ff)))},UM=function(){g(this,vo)||this.render(),this.isVisible?g(this,Zu)&&g(this,jr).classList.add("focused"):(X(this,on,qZ).call(this),g(this,jr).hidden=!1,g(this,jr).style.zIndex=parseInt(g(this,jr).style.zIndex)+1e3)},VF=function(){g(this,jr).classList.remove("focused"),!(g(this,Zu)||!this.isVisible)&&(g(this,jr).hidden=!0,g(this,jr).style.zIndex=parseInt(g(this,jr).style.zIndex)-1e3)};class WZ extends Br{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Jt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const r=document.createElement("span");r.textContent=t,e.append(r)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var KE;class vye extends Br{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});G(this,KE,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:r,height:i}=this,s=this.svgFactory.create(r,i,!0),a=B(this,KE,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return g(this,KE)}addHighlightArea(){this.container.classList.add("highlightArea")}}KE=new WeakMap;var YE;class yye extends Br{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});G(this,YE,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:r,height:i}=this,s=this.svgFactory.create(r,i,!0),a=t.borderStyle.width,o=B(this,YE,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",r-a),o.setAttribute("height",i-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return g(this,YE)}addHighlightArea(){this.container.classList.add("highlightArea")}}YE=new WeakMap;var QE;class xye extends Br{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});G(this,QE,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:r,height:i}=this,s=this.svgFactory.create(r,i,!0),a=t.borderStyle.width,o=B(this,QE,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",r/2),o.setAttribute("cy",i/2),o.setAttribute("rx",r/2-a/2),o.setAttribute("ry",i/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return g(this,QE)}addHighlightArea(){this.container.classList.add("highlightArea")}}QE=new WeakMap;var ZE;class XZ extends Br{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});G(this,ZE,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:r,borderStyle:i,popupRef:s},width:a,height:o}=this;if(!r)return this.container;const l=this.svgFactory.create(a,o,!0);let u=[];for(let h=0,d=r.length;h<d;h+=2){const f=r[h]-t[0],p=t[3]-r[h+1];u.push(`${f},${p}`)}u=u.join(" ");const c=B(this,ZE,this.svgFactory.createElement(this.svgElementName));return c.setAttribute("points",u),c.setAttribute("stroke-width",i.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),l.append(c),this.container.append(l),!s&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return g(this,ZE)}addHighlightArea(){this.container.classList.add("highlightArea")}}ZE=new WeakMap;class bye extends XZ{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class _ye extends Br{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var JE,Ug,eS,zF;class g4 extends Br{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});G(this,eS);G(this,JE,null);G(this,Ug,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Jt.HIGHLIGHT:Jt.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:r,inkLists:i,borderStyle:s,popupRef:a}}=this,{transform:o,width:l,height:u}=X(this,eS,zF).call(this,r,t),c=this.svgFactory.create(l,u,!0),h=B(this,JE,this.svgFactory.createElement("svg:g"));c.append(h),h.setAttribute("stroke-width",s.width||1),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),h.setAttribute("stroke-miterlimit",10),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),h.setAttribute("transform",o);for(let d=0,f=i.length;d<f;d++){const p=this.svgFactory.createElement(this.svgElementName);g(this,Ug).push(p),p.setAttribute("points",i[d].join(",")),h.append(p)}return!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(c),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:r,points:i,rect:s}=t,a=g(this,JE);if(r>=0&&a.setAttribute("stroke-width",r||1),i)for(let o=0,l=g(this,Ug).length;o<l;o++)g(this,Ug)[o].setAttribute("points",i[o].join(","));if(s){const{transform:o,width:l,height:u}=X(this,eS,zF).call(this,this.data.rotation,s);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${u}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return g(this,Ug)}addHighlightArea(){this.container.classList.add("highlightArea")}}JE=new WeakMap,Ug=new WeakMap,eS=new WeakSet,zF=function(t,r){switch(t){case 90:return{transform:`rotate(90) translate(${-r[0]},${r[1]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};case 180:return{transform:`rotate(180) translate(${-r[2]},${r[1]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]};case 270:return{transform:`rotate(270) translate(${-r[2]},${r[3]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};default:return{transform:`translate(${-r[0]},${r[3]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]}}};class KZ extends Br{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Jt.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const r=document.createElement("mark");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class wye extends Br{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const r=document.createElement("u");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class Eye extends Br{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const r=document.createElement("u");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class Sye extends Br{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const r=document.createElement("s");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class YZ extends Br{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Jt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var tS,nS,$F;class Aye extends Br{constructor(t){var i;super(t,{isRenderable:!0});G(this,nS);G(this,tS,null);const{file:r}=this.data;this.filename=r.filename,this.content=r.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...r})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:r}=this;let i;r.hasAppearance||r.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(r.name)?"paperclip":"pushpin"}.svg`,r.fillAlpha&&r.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(r.fillAlpha*100)}%);`)),i.addEventListener("dblclick",X(this,nS,$F).bind(this)),B(this,tS,i);const{isMac:s}=Ts.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(s?a.metaKey:a.ctrlKey)&&X(this,nS,$F).call(this)}),!r.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return g(this,tS)}addHighlightArea(){this.container.classList.add("highlightArea")}}tS=new WeakMap,nS=new WeakSet,$F=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Vg,zg,Ix,Uf,rS,$g,yo,iS,ed,VM,GF;const zU=class zU{constructor({div:e,accessibilityManager:t,annotationCanvasMap:r,annotationEditorUIManager:i,page:s,viewport:a,structTreeLayer:o,commentManager:l,linkService:u,annotationStorage:c}){G(this,ed);G(this,Vg,null);G(this,zg,null);G(this,Ix,null);G(this,Uf,new Map);G(this,rS,null);G(this,$g,null);G(this,yo,[]);G(this,iS,!1);this.div=e,B(this,Vg,t),B(this,zg,r),B(this,rS,o||null),B(this,$g,u||null),B(this,Ix,c||new d4),this.page=s,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i,this._commentManager=l||null}hasEditableAnnotations(){return g(this,Uf).size>0}async render(e){var o;const{annotations:t}=e,r=this.div;Av(r,this.viewport);const i=new Map,s=[],a={data:null,layer:r,linkService:g(this,$g),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new dD,annotationStorage:g(this,Ix),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const l of t){if(l.noHTML)continue;const u=l.annotationType===fi.POPUP;if(u){const d=i.get(l.id);if(!d)continue;if(!this._commentManager){s.push(l);continue}a.elements=d}else if(l.rect[2]===l.rect[0]||l.rect[3]===l.rect[1])continue;a.data=l;const c=uI.create(a);if(!c.isRenderable)continue;if(!u&&(g(this,yo).push(c),l.popupRef)){const d=i.get(l.popupRef);d?d.push(c):i.set(l.popupRef,[c])}const h=c.render();l.hidden&&(h.style.visibility="hidden"),c._isEditable&&(g(this,Uf).set(c.data.id,c),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(c))}await X(this,ed,VM).call(this);for(const l of s){const u=a.elements=i.get(l.id);a.data=l;const c=uI.create(a);if(!c.isRenderable)continue;const h=c.render();c.contentElement.id=`${ny}${l.id}`,l.hidden&&(h.style.visibility="hidden"),u.at(-1).container.after(h)}X(this,ed,GF).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:g(this,$g),svgFactory:new dD,parent:this};for(const r of e){r.borderStyle||(r.borderStyle=zU._defaultBorderStyle),t.data=r;const i=uI.create(t);i.isRenderable&&(i.render(),i.contentElement.id=`${ny}${r.id}`,g(this,yo).push(i))}await X(this,ed,VM).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,Av(t,{rotation:e.rotation}),X(this,ed,GF).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(g(this,Uf).values())}getEditableAnnotation(e){return g(this,Uf).get(e)}addFakeAnnotation(e){const{div:t}=this,{id:r,rotation:i}=e,s=new uye({data:{id:r,rect:e.getPDFRect(),rotation:i},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:g(this,$g),annotationStorage:g(this,Ix)});return s.render(),s.contentElement.id=`${ny}${r}`,s.createOrUpdatePopup(),g(this,yo).push(s),s}removeAnnotation(e){var i;const t=g(this,yo).findIndex(s=>s.data.id===e);if(t<0)return;const[r]=g(this,yo).splice(t,1);(i=g(this,Vg))==null||i.removePointerInTextLayer(r.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);X(this,ed,VM).call(this)}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return Kt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:R0.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};Vg=new WeakMap,zg=new WeakMap,Ix=new WeakMap,Uf=new WeakMap,rS=new WeakMap,$g=new WeakMap,yo=new WeakMap,iS=new WeakMap,ed=new WeakSet,VM=async function(){var r,i,s;if(g(this,yo).length===0)return;this.div.replaceChildren();const e=[];if(!g(this,iS)){B(this,iS,!0);for(const{contentElement:a,data:{id:o}}of g(this,yo)){const l=a.id=`${ny}${o}`;e.push((r=g(this,rS))==null?void 0:r.getAriaAttributes(l).then(u=>{if(u)for(const[c,h]of u)a.setAttribute(c,h)}))}}g(this,yo).sort(({data:{rect:[a,o,l,u]}},{data:{rect:[c,h,d,f]}})=>{if(a===l&&o===u)return 1;if(c===d&&h===f)return-1;const p=u,m=o,y=(o+u)/2,v=f,b=h,x=(h+f)/2;if(y>=v&&x<=m)return-1;if(x>=p&&y<=b)return 1;const w=(a+l)/2,_=(c+d)/2;return w-_});const t=document.createDocumentFragment();for(const a of g(this,yo))t.append(a.container),this._commentManager?(s=((i=a.extraPopupElement)==null?void 0:i.popup)||a.popup)==null||s.renderCommentButton():a.extraPopupElement&&t.append(a.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),g(this,Vg))for(const a of g(this,yo))g(this,Vg).addPointerInTextLayer(a.contentElement,!1)},GF=function(){var t;if(!g(this,zg))return;const e=this.div;for(const[r,i]of g(this,zg)){const s=e.querySelector(`[data-annotation-id="${r}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:a}=s;a?a.nodeName==="CANVAS"?a.replaceWith(i):a.classList.contains("annotationContent")?a.after(i):a.before(i):s.append(i);const o=g(this,Uf).get(r);o&&(o._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(r,s.id,i),o._hasNoCanvas=!1):o.canvas=i)}g(this,zg).clear()};let HF=zU;const rT=/\r\n?|\n/g;var xo,sS,Hg,bo,_i,QZ,ZZ,JZ,zM,td,$M,HM,eJ,qF,tJ;const wr=class wr extends br{constructor(t){super({...t,name:"freeTextEditor"});G(this,_i);G(this,xo,"");G(this,sS,`${this.id}-editor`);G(this,Hg,null);G(this,bo);Qe(this,"_colorPicker",null);this.color=t.color||wr._defaultColor||br._defaultLineColor,B(this,bo,t.fontSize||wr._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static get _keyboardManager(){const t=wr.prototype,r=a=>a.isEmpty(),i=Tv.TRANSLATE_SMALL,s=Tv.TRANSLATE_BIG;return Kt(this,"_keyboardManager",new qS([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:r}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:r}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:r}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:r}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:r}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:r}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:r}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:r}]]))}static initialize(t,r){br.initialize(t,r);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,r){switch(t){case En.FREETEXT_SIZE:wr._defaultFontSize=r;break;case En.FREETEXT_COLOR:wr._defaultColor=r;break}}updateParams(t,r){switch(t){case En.FREETEXT_SIZE:X(this,_i,QZ).call(this,r);break;case En.FREETEXT_COLOR:X(this,_i,ZZ).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[En.FREETEXT_SIZE,wr._defaultFontSize],[En.FREETEXT_COLOR,wr._defaultColor||br._defaultLineColor]]}get propertiesToUpdate(){return[[En.FREETEXT_SIZE,g(this,bo)],[En.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new hD(this)),[["colorPicker",this._colorPicker]]}get colorType(){return En.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,r){this._uiManager.translateSelectedEditors(t,r,!0)}getInitialTranslation(){const t=this.parentScale;return[-wr._internalPadding*t,-(wr._internalPadding+g(this,bo))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),B(this,Hg,new AbortController);const t=this._uiManager.combinedSignal(g(this,Hg));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",g(this,sS)),this._isDraggable=!0,(t=g(this,Hg))==null||t.abort(),B(this,Hg,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var r;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(r=this._initialOptions)!=null&&r.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=g(this,xo),r=B(this,xo,X(this,_i,JZ).call(this).trimEnd());if(t===r)return;const i=s=>{if(B(this,xo,s),!s){this.remove();return}X(this,_i,HM).call(this),this._uiManager.rebuild(this),X(this,_i,zM).call(this)};this.addCommands({cmd:()=>{i(r)},undo:()=>{i(t)},mustExec:!1}),X(this,_i,zM).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){wr._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,r;(this._isCopy||this.annotationElementId)&&(t=this.x,r=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",g(this,sS)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${g(this,bo)}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,u]=this.getInitialTranslation();[l,u]=this.pageTranslationToScreen(l,u);const[c,h]=this.pageDimensions,[d,f]=this.pageTranslation;let p,m;switch(this.rotation){case 0:p=t+(o[0]-d)/c,m=r+this.height-(o[1]-f)/h;break;case 90:p=t+(o[0]-d)/c,m=r-(o[1]-f)/h,[l,u]=[u,-l];break;case 180:p=t-this.width+(o[0]-d)/c,m=r-(o[1]-f)/h,[l,u]=[-l,-u];break;case 270:p=t+(o[0]-d-this.height*h)/c,m=r+(o[1]-f-this.width*c)/h,[l,u]=[-u,l];break}this.setAt(p*s,m*a,l,u)}else this._moveAfterPaste(t,r);X(this,_i,HM).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var p,m,y;const r=t.clipboardData||window.clipboardData,{types:i}=r;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const s=X(p=wr,td,qF).call(p,r.getData("text")||"").replaceAll(rT,`
`);if(!s)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!s.includes(`
`)){o.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:u}=o,c=[],h=[];if(l.nodeType===Node.TEXT_NODE){const v=l.parentElement;if(h.push(l.nodeValue.slice(u).replaceAll(rT,"")),v!==this.editorDiv){let b=c;for(const x of this.editorDiv.childNodes){if(x===v){b=h;continue}b.push(X(m=wr,td,$M).call(m,x))}}c.push(l.nodeValue.slice(0,u).replaceAll(rT,""))}else if(l===this.editorDiv){let v=c,b=0;for(const x of this.editorDiv.childNodes)b++===u&&(v=h),v.push(X(y=wr,td,$M).call(y,x))}B(this,xo,`${c.join(`
`)}${s}${h.join(`
`)}`),X(this,_i,HM).call(this);const d=new Range;let f=Math.sumPrecise(c.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const b=v.nodeValue.length;if(f<=b){d.setStart(v,f),d.setEnd(v,f);break}f-=b}a.removeAllRanges(),a.addRange(d)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=wr._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,r,i){var o;let s=null;if(t instanceof WZ){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:c,rotation:h,id:d,popupRef:f,richText:p,contentsObj:m,creationDate:y,modificationDate:v},textContent:b,textPosition:x,parent:{page:{pageNumber:w}}}=t;if(!b||b.length===0)return null;s=t={annotationType:Jt.FREETEXT,color:Array.from(u),fontSize:l,value:b.join(`
`),position:x,pageIndex:w-1,rect:c.slice(0),rotation:h,annotationElementId:d,id:d,deleted:!1,popupRef:f,comment:(m==null?void 0:m.str)||null,richText:p,creationDate:y,modificationDate:v}}const a=await super.deserialize(t,r,i);return B(a,bo,t.fontSize),a.color=yt.makeHexColor(...t.color),B(a,xo,X(o=wr,td,qF).call(o,t.value)),a._initialData=s,t.comment&&a.setCommentData(t),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r=br._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:r,fontSize:g(this,bo),value:X(this,_i,eJ).call(this)});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!X(this,_i,tJ).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){const r=super.renderAnnotationElement(t);if(!r)return null;const{style:i}=r;i.fontSize=`calc(${g(this,bo)}px * var(--total-scale-factor))`,i.color=this.color,r.replaceChildren();for(const s of g(this,xo).split(`
`)){const a=document.createElement("div");a.append(s?document.createTextNode(s):document.createElement("br")),r.append(a)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:g(this,xo)}}),r}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};xo=new WeakMap,sS=new WeakMap,Hg=new WeakMap,bo=new WeakMap,_i=new WeakSet,QZ=function(t){const r=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-g(this,bo))*this.parentScale),B(this,bo,s),X(this,_i,zM).call(this)},i=g(this,bo);this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:En.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},ZZ=function(t){const r=s=>{this.color=s,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:En.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},JZ=function(){var i;const t=[];this.editorDiv.normalize();let r=null;for(const s of this.editorDiv.childNodes)(r==null?void 0:r.nodeType)===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(X(i=wr,td,$M).call(i,s)),r=s);return t.join(`
`)},zM=function(){const[t,r]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:s,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",s.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/r):(this.width=i.height/t,this.height=i.width/r),this.fixAndSetPosition()},td=new WeakSet,$M=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(rT,"")},HM=function(){if(this.editorDiv.replaceChildren(),!!g(this,xo))for(const t of g(this,xo).split(`
`)){const r=document.createElement("div");r.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(r)}},eJ=function(){return g(this,xo).replaceAll(""," ")},qF=function(t){return t.replaceAll(" ","")},tJ=function(t){const{value:r,fontSize:i,color:s,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==r||t.fontSize!==i||t.color.some((o,l)=>o!==s[l])||t.pageIndex!==a},G(wr,td),Qe(wr,"_freeTextDefaultContent",""),Qe(wr,"_internalPadding",0),Qe(wr,"_defaultColor",null),Qe(wr,"_defaultFontSize",10),Qe(wr,"_type","freetext"),Qe(wr,"_editorType",Jt.FREETEXT);let jF=wr;class pt{toSVGPath(){fr("Abstract method `toSVGPath` must be implemented.")}get box(){fr("Abstract getter `box` must be implemented.")}serialize(e,t){fr("Abstract method `serialize` must be implemented.")}static _rescale(e,t,r,i,s,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*i,a[o+1]=r+e[o+1]*s;return a}static _rescaleAndSwap(e,t,r,i,s,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*i,a[o+1]=r+e[o]*s;return a}static _translate(e,t,r,i){i||(i=new Float32Array(e.length));for(let s=0,a=e.length;s<a;s+=2)i[s]=t+e[s],i[s+1]=r+e[s+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,r,i,s){switch(s){case 90:return[1-t/r,e/i];case 180:return[1-e/r,1-t/i];case 270:return[t/r,1-e/i];default:return[e/r,t/i]}}static _normalizePagePoint(e,t,r){switch(r){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,r,i,s,a){return[(e+5*r)/6,(t+5*i)/6,(5*r+s)/6,(5*i+a)/6,(r+s)/2,(i+a)/2]}}Qe(pt,"PRECISION",1e-4);var _o,Ql,Px,Fx,Ju,fn,Gg,jg,aS,oS,Lx,Ox,Vf,lS,v2,y2,Ri,a1,nJ,rJ,iJ,sJ,aJ,oJ;const eh=class eh{constructor({x:e,y:t},r,i,s,a,o=0){G(this,Ri);G(this,_o);G(this,Ql,[]);G(this,Px);G(this,Fx);G(this,Ju,[]);G(this,fn,new Float32Array(18));G(this,Gg);G(this,jg);G(this,aS);G(this,oS);G(this,Lx);G(this,Ox);G(this,Vf,[]);B(this,_o,r),B(this,Ox,s*i),B(this,Fx,a),g(this,fn).set([NaN,NaN,NaN,NaN,e,t],6),B(this,Px,o),B(this,oS,g(eh,lS)*i),B(this,aS,g(eh,y2)*i),B(this,Lx,i),g(this,Vf).push(e,t)}isEmpty(){return isNaN(g(this,fn)[8])}add({x:e,y:t}){var S;B(this,Gg,e),B(this,jg,t);const[r,i,s,a]=g(this,_o);let[o,l,u,c]=g(this,fn).subarray(8,12);const h=e-u,d=t-c,f=Math.hypot(h,d);if(f<g(this,aS))return!1;const p=f-g(this,oS),m=p/f,y=m*h,v=m*d;let b=o,x=l;o=u,l=c,u+=y,c+=v,(S=g(this,Vf))==null||S.push(e,t);const w=-v/p,_=y/p,E=w*g(this,Ox),A=_*g(this,Ox);return g(this,fn).set(g(this,fn).subarray(2,8),0),g(this,fn).set([u+E,c+A],4),g(this,fn).set(g(this,fn).subarray(14,18),12),g(this,fn).set([u-E,c-A],16),isNaN(g(this,fn)[6])?(g(this,Ju).length===0&&(g(this,fn).set([o+E,l+A],2),g(this,Ju).push(NaN,NaN,NaN,NaN,(o+E-r)/s,(l+A-i)/a),g(this,fn).set([o-E,l-A],14),g(this,Ql).push(NaN,NaN,NaN,NaN,(o-E-r)/s,(l-A-i)/a)),g(this,fn).set([b,x,o,l,u,c],6),!this.isEmpty()):(g(this,fn).set([b,x,o,l,u,c],6),Math.abs(Math.atan2(x-l,b-o)-Math.atan2(v,y))<Math.PI/2?([o,l,u,c]=g(this,fn).subarray(2,6),g(this,Ju).push(NaN,NaN,NaN,NaN,((o+u)/2-r)/s,((l+c)/2-i)/a),[o,l,b,x]=g(this,fn).subarray(14,18),g(this,Ql).push(NaN,NaN,NaN,NaN,((b+o)/2-r)/s,((x+l)/2-i)/a),!0):([b,x,o,l,u,c]=g(this,fn).subarray(0,6),g(this,Ju).push(((b+5*o)/6-r)/s,((x+5*l)/6-i)/a,((5*o+u)/6-r)/s,((5*l+c)/6-i)/a,((o+u)/2-r)/s,((l+c)/2-i)/a),[u,c,o,l,b,x]=g(this,fn).subarray(12,18),g(this,Ql).push(((b+5*o)/6-r)/s,((x+5*l)/6-i)/a,((5*o+u)/6-r)/s,((5*l+c)/6-i)/a,((o+u)/2-r)/s,((l+c)/2-i)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=g(this,Ju),t=g(this,Ql);if(isNaN(g(this,fn)[6])&&!this.isEmpty())return X(this,Ri,nJ).call(this);const r=[];r.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?r.push(`L${e[i+4]} ${e[i+5]}`):r.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);X(this,Ri,iJ).call(this,r);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?r.push(`L${t[i+4]} ${t[i+5]}`):r.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return X(this,Ri,rJ).call(this,r),r.join(" ")}newFreeDrawOutline(e,t,r,i,s,a){return new lJ(e,t,r,i,s,a)}getOutlines(){var h;const e=g(this,Ju),t=g(this,Ql),r=g(this,fn),[i,s,a,o]=g(this,_o),l=new Float32Array((((h=g(this,Vf))==null?void 0:h.length)??0)+2);for(let d=0,f=l.length-2;d<f;d+=2)l[d]=(g(this,Vf)[d]-i)/a,l[d+1]=(g(this,Vf)[d+1]-s)/o;if(l[l.length-2]=(g(this,Gg)-i)/a,l[l.length-1]=(g(this,jg)-s)/o,isNaN(r[6])&&!this.isEmpty())return X(this,Ri,sJ).call(this,l);const u=new Float32Array(g(this,Ju).length+24+g(this,Ql).length);let c=e.length;for(let d=0;d<c;d+=2){if(isNaN(e[d])){u[d]=u[d+1]=NaN;continue}u[d]=e[d],u[d+1]=e[d+1]}c=X(this,Ri,oJ).call(this,u,c);for(let d=t.length-6;d>=6;d-=6)for(let f=0;f<6;f+=2){if(isNaN(t[d+f])){u[c]=u[c+1]=NaN,c+=2;continue}u[c]=t[d+f],u[c+1]=t[d+f+1],c+=2}return X(this,Ri,aJ).call(this,u,c),this.newFreeDrawOutline(u,l,g(this,_o),g(this,Lx),g(this,Px),g(this,Fx))}};_o=new WeakMap,Ql=new WeakMap,Px=new WeakMap,Fx=new WeakMap,Ju=new WeakMap,fn=new WeakMap,Gg=new WeakMap,jg=new WeakMap,aS=new WeakMap,oS=new WeakMap,Lx=new WeakMap,Ox=new WeakMap,Vf=new WeakMap,lS=new WeakMap,v2=new WeakMap,y2=new WeakMap,Ri=new WeakSet,a1=function(){const e=g(this,fn).subarray(4,6),t=g(this,fn).subarray(16,18),[r,i,s,a]=g(this,_o);return[(g(this,Gg)+(e[0]-t[0])/2-r)/s,(g(this,jg)+(e[1]-t[1])/2-i)/a,(g(this,Gg)+(t[0]-e[0])/2-r)/s,(g(this,jg)+(t[1]-e[1])/2-i)/a]},nJ=function(){const[e,t,r,i]=g(this,_o),[s,a,o,l]=X(this,Ri,a1).call(this);return`M${(g(this,fn)[2]-e)/r} ${(g(this,fn)[3]-t)/i} L${(g(this,fn)[4]-e)/r} ${(g(this,fn)[5]-t)/i} L${s} ${a} L${o} ${l} L${(g(this,fn)[16]-e)/r} ${(g(this,fn)[17]-t)/i} L${(g(this,fn)[14]-e)/r} ${(g(this,fn)[15]-t)/i} Z`},rJ=function(e){const t=g(this,Ql);e.push(`L${t[4]} ${t[5]} Z`)},iJ=function(e){const[t,r,i,s]=g(this,_o),a=g(this,fn).subarray(4,6),o=g(this,fn).subarray(16,18),[l,u,c,h]=X(this,Ri,a1).call(this);e.push(`L${(a[0]-t)/i} ${(a[1]-r)/s} L${l} ${u} L${c} ${h} L${(o[0]-t)/i} ${(o[1]-r)/s}`)},sJ=function(e){const t=g(this,fn),[r,i,s,a]=g(this,_o),[o,l,u,c]=X(this,Ri,a1).call(this),h=new Float32Array(36);return h.set([NaN,NaN,NaN,NaN,(t[2]-r)/s,(t[3]-i)/a,NaN,NaN,NaN,NaN,(t[4]-r)/s,(t[5]-i)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,u,c,NaN,NaN,NaN,NaN,(t[16]-r)/s,(t[17]-i)/a,NaN,NaN,NaN,NaN,(t[14]-r)/s,(t[15]-i)/a],0),this.newFreeDrawOutline(h,e,g(this,_o),g(this,Lx),g(this,Px),g(this,Fx))},aJ=function(e,t){const r=g(this,Ql);return e.set([NaN,NaN,NaN,NaN,r[4],r[5]],t),t+=6},oJ=function(e,t){const r=g(this,fn).subarray(4,6),i=g(this,fn).subarray(16,18),[s,a,o,l]=g(this,_o),[u,c,h,d]=X(this,Ri,a1).call(this);return e.set([NaN,NaN,NaN,NaN,(r[0]-s)/o,(r[1]-a)/l,NaN,NaN,NaN,NaN,u,c,NaN,NaN,NaN,NaN,h,d,NaN,NaN,NaN,NaN,(i[0]-s)/o,(i[1]-a)/l],t),t+=24},G(eh,lS,8),G(eh,v2,2),G(eh,y2,g(eh,lS)+g(eh,v2));let fD=eh;var kx,qg,Dh,uS,wo,cS,ni,x2,uJ;class lJ extends pt{constructor(t,r,i,s,a,o){super();G(this,x2);G(this,kx);G(this,qg,new Float32Array(4));G(this,Dh);G(this,uS);G(this,wo);G(this,cS);G(this,ni);B(this,ni,t),B(this,wo,r),B(this,kx,i),B(this,cS,s),B(this,Dh,a),B(this,uS,o),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],X(this,x2,uJ).call(this,o);const[l,u,c,h]=g(this,qg);for(let d=0,f=t.length;d<f;d+=2)t[d]=(t[d]-l)/c,t[d+1]=(t[d+1]-u)/h;for(let d=0,f=r.length;d<f;d+=2)r[d]=(r[d]-l)/c,r[d+1]=(r[d+1]-u)/h}toSVGPath(){const t=[`M${g(this,ni)[4]} ${g(this,ni)[5]}`];for(let r=6,i=g(this,ni).length;r<i;r+=6){if(isNaN(g(this,ni)[r])){t.push(`L${g(this,ni)[r+4]} ${g(this,ni)[r+5]}`);continue}t.push(`C${g(this,ni)[r]} ${g(this,ni)[r+1]} ${g(this,ni)[r+2]} ${g(this,ni)[r+3]} ${g(this,ni)[r+4]} ${g(this,ni)[r+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,r,i,s],a){const o=i-t,l=s-r;let u,c;switch(a){case 0:u=pt._rescale(g(this,ni),t,s,o,-l),c=pt._rescale(g(this,wo),t,s,o,-l);break;case 90:u=pt._rescaleAndSwap(g(this,ni),t,r,o,l),c=pt._rescaleAndSwap(g(this,wo),t,r,o,l);break;case 180:u=pt._rescale(g(this,ni),i,r,-o,l),c=pt._rescale(g(this,wo),i,r,-o,l);break;case 270:u=pt._rescaleAndSwap(g(this,ni),i,s,-o,-l),c=pt._rescaleAndSwap(g(this,wo),i,s,-o,-l);break}return{outline:Array.from(u),points:[Array.from(c)]}}get box(){return g(this,qg)}newOutliner(t,r,i,s,a,o=0){return new fD(t,r,i,s,a,o)}getNewOutline(t,r){const[i,s,a,o]=g(this,qg),[l,u,c,h]=g(this,kx),d=a*c,f=o*h,p=i*c+l,m=s*h+u,y=this.newOutliner({x:g(this,wo)[0]*d+p,y:g(this,wo)[1]*f+m},g(this,kx),g(this,cS),t,g(this,uS),r??g(this,Dh));for(let v=2;v<g(this,wo).length;v+=2)y.add({x:g(this,wo)[v]*d+p,y:g(this,wo)[v+1]*f+m});return y.getOutlines()}}kx=new WeakMap,qg=new WeakMap,Dh=new WeakMap,uS=new WeakMap,wo=new WeakMap,cS=new WeakMap,ni=new WeakMap,x2=new WeakSet,uJ=function(t){const r=g(this,ni);let i=r[4],s=r[5];const a=[i,s,i,s];let o=i,l=s,u=i,c=s;const h=t?Math.max:Math.min,d=new Float32Array(4);for(let p=6,m=r.length;p<m;p+=6){const y=r[p+4],v=r[p+5];isNaN(r[p])?(yt.pointBoundingBox(y,v,a),l>v?(o=y,l=v):l===v&&(o=h(o,y)),c<v?(u=y,c=v):c===v&&(u=h(u,y))):(d[0]=d[1]=1/0,d[2]=d[3]=-1/0,yt.bezierBoundingBox(i,s,...r.slice(p,p+6),d),yt.rectBoundingBox(d[0],d[1],d[2],d[3],a),l>d[1]?(o=d[0],l=d[1]):l===d[1]&&(o=h(o,d[0])),c<d[3]?(u=d[2],c=d[3]):c===d[3]&&(u=h(u,d[2]))),i=y,s=v}const f=g(this,qg);f[0]=a[0]-g(this,Dh),f[1]=a[1]-g(this,Dh),f[2]=a[2]-a[0]+2*g(this,Dh),f[3]=a[3]-a[1]+2*g(this,Dh),this.firstPoint=[o,l],this.lastPoint=[u,c]};var hS,dS,fS,zf,Zl,Ma,cJ,GM,hJ,dJ,XF;class WF{constructor(e,t=0,r=0,i=!0){G(this,Ma);G(this,hS);G(this,dS);G(this,fS);G(this,zf,[]);G(this,Zl,[]);const s=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:m,y,width:v,height:b}of e){const x=Math.floor((m-t)/a)*a,w=Math.ceil((m+v+t)/a)*a,_=Math.floor((y-t)/a)*a,E=Math.ceil((y+b+t)/a)*a,A=[x,_,E,!0],T=[w,_,E,!1];g(this,zf).push(A,T),yt.rectBoundingBox(x,_,w,E,s)}const o=s[2]-s[0]+2*r,l=s[3]-s[1]+2*r,u=s[0]-r,c=s[1]-r;let h=i?-1/0:1/0,d=1/0;const f=g(this,zf).at(i?-1:-2),p=[f[0],f[2]];for(const m of g(this,zf)){const[y,v,b,x]=m;!x&&i?v<d?(d=v,h=y):v===d&&(h=Math.max(h,y)):x&&!i&&(v<d?(d=v,h=y):v===d&&(h=Math.min(h,y))),m[0]=(y-u)/o,m[1]=(v-c)/l,m[2]=(b-c)/l}B(this,hS,new Float32Array([u,c,o,l])),B(this,dS,[h,d]),B(this,fS,p)}getOutlines(){g(this,zf).sort((t,r)=>t[0]-r[0]||t[1]-r[1]||t[2]-r[2]);const e=[];for(const t of g(this,zf))t[3]?(e.push(...X(this,Ma,XF).call(this,t)),X(this,Ma,hJ).call(this,t)):(X(this,Ma,dJ).call(this,t),e.push(...X(this,Ma,XF).call(this,t)));return X(this,Ma,cJ).call(this,e)}}hS=new WeakMap,dS=new WeakMap,fS=new WeakMap,zf=new WeakMap,Zl=new WeakMap,Ma=new WeakSet,cJ=function(e){const t=[],r=new Set;for(const a of e){const[o,l,u]=a;t.push([o,l,a],[o,u,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],u=t[a+1][2];l.push(u),u.push(l),r.add(l),r.add(u)}const i=[];let s;for(;r.size>0;){const a=r.values().next().value;let[o,l,u,c,h]=a;r.delete(a);let d=o,f=l;for(s=[o,u],i.push(s);;){let p;if(r.has(c))p=c;else if(r.has(h))p=h;else break;r.delete(p),[o,l,u,c,h]=p,d!==o&&(s.push(d,f,o,f===l?l:u),d=o),f=f===l?u:l}s.push(d,f)}return new Tye(i,g(this,hS),g(this,dS),g(this,fS))},GM=function(e){const t=g(this,Zl);let r=0,i=t.length-1;for(;r<=i;){const s=r+i>>1,a=t[s][0];if(a===e)return s;a<e?r=s+1:i=s-1}return i+1},hJ=function([,e,t]){const r=X(this,Ma,GM).call(this,e);g(this,Zl).splice(r,0,[e,t])},dJ=function([,e,t]){const r=X(this,Ma,GM).call(this,e);for(let i=r;i<g(this,Zl).length;i++){const[s,a]=g(this,Zl)[i];if(s!==e)break;if(s===e&&a===t){g(this,Zl).splice(i,1);return}}for(let i=r-1;i>=0;i--){const[s,a]=g(this,Zl)[i];if(s!==e)break;if(s===e&&a===t){g(this,Zl).splice(i,1);return}}},XF=function(e){const[t,r,i]=e,s=[[t,r,i]],a=X(this,Ma,GM).call(this,i);for(let o=0;o<a;o++){const[l,u]=g(this,Zl)[o];for(let c=0,h=s.length;c<h;c++){const[,d,f]=s[c];if(!(u<=d||f<=l)){if(d>=l){if(f>u)s[c][1]=u;else{if(h===1)return[];s.splice(c,1),c--,h--}continue}s[c][2]=l,f>u&&s.push([t,u,f])}}}return s};var pS,Bx;class Tye extends pt{constructor(t,r,i,s){super();G(this,pS);G(this,Bx);B(this,Bx,t),B(this,pS,r),this.firstPoint=i,this.lastPoint=s}toSVGPath(){const t=[];for(const r of g(this,Bx)){let[i,s]=r;t.push(`M${i} ${s}`);for(let a=2;a<r.length;a+=2){const o=r[a],l=r[a+1];o===i?(t.push(`V${l}`),s=l):l===s&&(t.push(`H${o}`),i=o)}t.push("Z")}return t.join(" ")}serialize([t,r,i,s],a){const o=[],l=i-t,u=s-r;for(const c of g(this,Bx)){const h=new Array(c.length);for(let d=0;d<c.length;d+=2)h[d]=t+c[d]*l,h[d+1]=s-c[d+1]*u;o.push(h)}return o}get box(){return g(this,pS)}get classNamesForOutlining(){return["highlightOutline"]}}pS=new WeakMap,Bx=new WeakMap;class KF extends fD{newFreeDrawOutline(e,t,r,i,s,a){return new Mye(e,t,r,i,s,a)}}class Mye extends lJ{newOutliner(e,t,r,i,s,a=0){return new KF(e,t,r,i,s,a)}}var Ux,mS,Nh,Wg,gS,za,vS,yS,Xg,Eo,So,fs,Vx,zx,js,$x,cl,xS,an,YF,jM,fJ,pJ,mJ,QF,Cm,yl,k0,gJ,qM,WM,vJ,yJ,xJ,bJ,_J;const Un=class Un extends br{constructor(t){super({...t,name:"highlightEditor"});G(this,an);G(this,Ux,null);G(this,mS,0);G(this,Nh);G(this,Wg,null);G(this,gS,null);G(this,za,null);G(this,vS,null);G(this,yS,0);G(this,Xg,null);G(this,Eo,null);G(this,So,null);G(this,fs,!1);G(this,Vx,null);G(this,zx,null);G(this,js,null);G(this,$x,"");G(this,cl);G(this,xS,"");this.color=t.color||Un._defaultColor,B(this,cl,t.thickness||Un._defaultThickness),this.opacity=t.opacity||Un._defaultOpacity,B(this,Nh,t.boxes||null),B(this,xS,t.methodOfCreation||""),B(this,$x,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(B(this,fs,!0),X(this,an,jM).call(this,t),X(this,an,Cm).call(this)):g(this,Nh)&&(B(this,Ux,t.anchorNode),B(this,mS,t.anchorOffset),B(this,vS,t.focusNode),B(this,yS,t.focusOffset),X(this,an,YF).call(this),X(this,an,Cm).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=Un.prototype;return Kt(this,"_keyboardManager",new qS([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:g(this,fs)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:g(this,cl),methodOfCreation:g(this,xS)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,r){var i;br.initialize(t,r),Un._defaultColor||(Un._defaultColor=((i=r.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,r){switch(t){case En.HIGHLIGHT_COLOR:Un._defaultColor=r;break;case En.HIGHLIGHT_THICKNESS:Un._defaultThickness=r;break}}translateInPage(t,r){}get toolbarPosition(){return g(this,zx)}get commentButtonPosition(){return g(this,Vx)}updateParams(t,r){switch(t){case En.HIGHLIGHT_COLOR:X(this,an,fJ).call(this,r);break;case En.HIGHLIGHT_THICKNESS:X(this,an,pJ).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[En.HIGHLIGHT_COLOR,Un._defaultColor],[En.HIGHLIGHT_THICKNESS,Un._defaultThickness]]}get propertiesToUpdate(){return[[En.HIGHLIGHT_COLOR,this.color||Un._defaultColor],[En.HIGHLIGHT_THICKNESS,g(this,cl)||Un._defaultThickness],[En.HIGHLIGHT_FREE,g(this,fs)]]}onUpdatedColor(){var t,r;(t=this.parent)==null||t.drawLayer.updateProperties(g(this,So),{root:{fill:this.color,"fill-opacity":this.opacity}}),(r=g(this,gS))==null||r.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",B(this,gS,new cD({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(X(this,an,WM).call(this))}getBaseTranslation(){return[0,0]}getRect(t,r){return super.getRect(t,r,X(this,an,WM).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){X(this,an,QF).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(X(this,an,Cm).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let r=!1;this.parent&&!t?X(this,an,QF).call(this):t&&(X(this,an,Cm).call(this,t),r=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),r&&this.select()}rotate(t){var s,a,o;const{drawLayer:r}=this.parent;let i;g(this,fs)?(t=(t-this.rotation+360)%360,i=X(s=Un,yl,k0).call(s,g(this,Eo).box,t)):i=X(a=Un,yl,k0).call(a,[this.x,this.y,this.width,this.height],t),r.updateProperties(g(this,So),{bbox:i,root:{"data-main-rotation":t}}),r.updateProperties(g(this,js),{bbox:X(o=Un,yl,k0).call(o,g(this,za).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();g(this,$x)&&(t.setAttribute("aria-label",g(this,$x)),t.setAttribute("role","mark")),g(this,fs)?t.classList.add("free"):this.div.addEventListener("keydown",X(this,an,gJ).bind(this),{signal:this._uiManager._signal});const r=B(this,Xg,document.createElement("div"));return t.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",r.style.clipPath=g(this,Wg),this.setDims(),VQ(this,g(this,Xg),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(g(this,js),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(g(this,js),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:X(this,an,qM).call(this,!0);break;case 1:case 3:X(this,an,qM).call(this,!1);break}}select(){var t;super.select(),g(this,js)&&((t=this.parent)==null||t.drawLayer.updateProperties(g(this,js),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),g(this,js)&&((t=this.parent)==null||t.drawLayer.updateProperties(g(this,js),{rootClass:{selected:!1}}),g(this,fs)||X(this,an,qM).call(this,!1))}get _mustFixPosition(){return!g(this,fs)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(g(this,So),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(g(this,js),{rootClass:{hidden:!t}}))}static startHighlighting(t,r,{target:i,x:s,y:a}){const{x:o,y:l,width:u,height:c}=i.getBoundingClientRect(),h=new AbortController,d=t.combinedSignal(h),f=p=>{h.abort(),X(this,yl,bJ).call(this,t,p)};window.addEventListener("blur",f,{signal:d}),window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("pointerdown",Yr,{capture:!0,passive:!1,signal:d}),window.addEventListener("contextmenu",Cl,{signal:d}),i.addEventListener("pointermove",X(this,yl,xJ).bind(this,t),{signal:d}),this._freeHighlight=new KF({x:s,y:a},[o,l,u,c],t.scale,this._defaultThickness/2,r,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,r,i){var m,y,v,b;let s=null;if(t instanceof KZ){const{data:{quadPoints:x,rect:w,rotation:_,id:E,color:A,opacity:T,popupRef:S,richText:M,contentsObj:D,creationDate:N,modificationDate:R},parent:{page:{pageNumber:z}}}=t;s=t={annotationType:Jt.HIGHLIGHT,color:Array.from(A),opacity:T,quadPoints:x,boxes:null,pageIndex:z-1,rect:w.slice(0),rotation:_,annotationElementId:E,id:E,deleted:!1,popupRef:S,richText:M,comment:(D==null?void 0:D.str)||null,creationDate:N,modificationDate:R}}else if(t instanceof g4){const{data:{inkLists:x,rect:w,rotation:_,id:E,color:A,borderStyle:{rawWidth:T},popupRef:S,richText:M,contentsObj:D,creationDate:N,modificationDate:R},parent:{page:{pageNumber:z}}}=t;s=t={annotationType:Jt.HIGHLIGHT,color:Array.from(A),thickness:T,inkLists:x,boxes:null,pageIndex:z-1,rect:w.slice(0),rotation:_,annotationElementId:E,id:E,deleted:!1,popupRef:S,richText:M,comment:(D==null?void 0:D.str)||null,creationDate:N,modificationDate:R}}const{color:a,quadPoints:o,inkLists:l,opacity:u}=t,c=await super.deserialize(t,r,i);c.color=yt.makeHexColor(...a),c.opacity=u||1,l&&B(c,cl,t.thickness),c._initialData=s,t.comment&&c.setCommentData(t);const[h,d]=c.pageDimensions,[f,p]=c.pageTranslation;if(o){const x=B(c,Nh,[]);for(let w=0;w<o.length;w+=8)x.push({x:(o[w]-f)/h,y:1-(o[w+1]-p)/d,width:(o[w+2]-o[w])/h,height:(o[w+1]-o[w+5])/d});X(m=c,an,YF).call(m),X(y=c,an,Cm).call(y),c.rotate(c.rotation)}else if(l){B(c,fs,!0);const x=l[0],w={x:x[0]-f,y:d-(x[1]-p)},_=new KF(w,[0,0,h,d],1,g(c,cl)/2,!0,.001);for(let T=0,S=x.length;T<S;T+=2)w.x=x[T]-f,w.y=d-(x[T+1]-p),_.add(w);const{id:E,clipPathId:A}=r.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:c.color,"fill-opacity":c._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:_.toSVGPath()}},!0,!0);X(v=c,an,jM).call(v,{highlightOutlines:_.getOutlines(),highlightId:E,clipPathId:A}),X(b=c,an,Cm).call(b),c.rotate(c.parentRotation)}return c}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const r=br._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:r,opacity:this.opacity,thickness:g(this,cl),quadPoints:X(this,an,vJ).call(this),outlines:X(this,an,yJ).call(this,i.rect)}),this.addComment(i),this.annotationElementId&&!X(this,an,_J).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};Ux=new WeakMap,mS=new WeakMap,Nh=new WeakMap,Wg=new WeakMap,gS=new WeakMap,za=new WeakMap,vS=new WeakMap,yS=new WeakMap,Xg=new WeakMap,Eo=new WeakMap,So=new WeakMap,fs=new WeakMap,Vx=new WeakMap,zx=new WeakMap,js=new WeakMap,$x=new WeakMap,cl=new WeakMap,xS=new WeakMap,an=new WeakSet,YF=function(){const t=new WF(g(this,Nh),.001);B(this,Eo,t.getOutlines()),[this.x,this.y,this.width,this.height]=g(this,Eo).box;const r=new WF(g(this,Nh),.0025,.001,this._uiManager.direction==="ltr");B(this,za,r.getOutlines());const{firstPoint:i}=g(this,Eo);B(this,Vx,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]);const{lastPoint:s}=g(this,za);B(this,zx,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},jM=function({highlightOutlines:t,highlightId:r,clipPathId:i}){var d,f;if(B(this,Eo,t),B(this,za,t.getNewOutline(g(this,cl)/2+1.5,.0025)),r>=0)B(this,So,r),B(this,Wg,i),this.parent.drawLayer.finalizeDraw(r,{bbox:t.box,path:{d:t.toSVGPath()}}),B(this,js,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:g(this,za).box,path:{d:g(this,za).toSVGPath()}},!0));else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(g(this,So),{bbox:X(d=Un,yl,k0).call(d,g(this,Eo).box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(g(this,js),{bbox:X(f=Un,yl,k0).call(f,g(this,za).box,p),path:{d:g(this,za).toSVGPath()}})}const[a,o,l,u]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=u;break;case 90:{const[p,m]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*m/p,this.height=u*p/m;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=u;break;case 270:{const[p,m]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*m/p,this.height=u*p/m;break}}const{firstPoint:c}=t;B(this,Vx,[(c[0]-a)/l,(c[1]-o)/u]);const{lastPoint:h}=g(this,za);B(this,zx,[(h[0]-a)/l,(h[1]-o)/u])},fJ=function(t){const r=(a,o)=>{this.color=a,this.opacity=o,this.onUpdatedColor()},i=this.color,s=this.opacity;this.addCommands({cmd:r.bind(this,t,Un._defaultOpacity),undo:r.bind(this,i,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:En.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},pJ=function(t){const r=g(this,cl),i=s=>{B(this,cl,s),X(this,an,mJ).call(this,s)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:En.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},mJ=function(t){g(this,fs)&&(X(this,an,jM).call(this,{highlightOutlines:g(this,Eo).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())},QF=function(){g(this,So)===null||!this.parent||(this.parent.drawLayer.remove(g(this,So)),B(this,So,null),this.parent.drawLayer.remove(g(this,js)),B(this,js,null))},Cm=function(t=this.parent){g(this,So)===null&&({id:Ei(this,So)._,clipPathId:Ei(this,Wg)._}=t.drawLayer.draw({bbox:g(this,Eo).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:g(this,fs)},path:{d:g(this,Eo).toSVGPath()}},!1,!0),B(this,js,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:g(this,fs)},bbox:g(this,za).box,path:{d:g(this,za).toSVGPath()}},g(this,fs))),g(this,Xg)&&(g(this,Xg).style.clipPath=g(this,Wg)))},yl=new WeakSet,k0=function([t,r,i,s],a){switch(a){case 90:return[1-r-s,t,s,i];case 180:return[1-t-i,1-r-s,i,s];case 270:return[r,1-t-i,s,i]}return[t,r,i,s]},gJ=function(t){Un._keyboardManager.exec(this,t)},qM=function(t){if(!g(this,Ux))return;const r=window.getSelection();t?r.setPosition(g(this,Ux),g(this,mS)):r.setPosition(g(this,vS),g(this,yS))},WM=function(){return g(this,fs)?this.rotation:0},vJ=function(){if(g(this,fs))return null;const[t,r]=this.pageDimensions,[i,s]=this.pageTranslation,a=g(this,Nh),o=new Float32Array(a.length*8);let l=0;for(const{x:u,y:c,width:h,height:d}of a){const f=u*t+i,p=(1-c)*r+s;o[l]=o[l+4]=f,o[l+1]=o[l+3]=p,o[l+2]=o[l+6]=f+h*t,o[l+5]=o[l+7]=p-d*r,l+=8}return o},yJ=function(t){return g(this,Eo).serialize(t,X(this,an,WM).call(this))},xJ=function(t,r){this._freeHighlight.add(r)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},bJ=function(t,r){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(r,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},_J=function(t){const{color:r}=this._initialData;return this.hasEditedComment||t.color.some((i,s)=>i!==r[s])},G(Un,yl),Qe(Un,"_defaultColor",null),Qe(Un,"_defaultOpacity",1),Qe(Un,"_defaultThickness",12),Qe(Un,"_type","highlight"),Qe(Un,"_editorType",Jt.HIGHLIGHT),Qe(Un,"_freeHighlightId",-1),Qe(Un,"_freeHighlight",null),Qe(Un,"_freeHighlightClipId","");let pD=Un;var Kg;class wJ{constructor(){G(this,Kg,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,r]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,r)}updateSVGProperty(e,t){g(this,Kg)[e]=t}toSVGProperties(){const e=g(this,Kg);return B(this,Kg,Object.create(null)),{root:e}}reset(){B(this,Kg,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){fr("Not implemented")}}Kg=new WeakMap;var Ao,Hx,Yi,Yg,Qg,Pn,ZF,JF,eL,o1,EJ,XM,l1,B0;const gn=class gn extends br{constructor(t){super(t);G(this,Pn);G(this,Ao,null);G(this,Hx);Qe(this,"_colorPicker",null);Qe(this,"_drawId",null);B(this,Hx,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(X(this,Pn,ZF).call(this,t),X(this,Pn,o1).call(this))}static _mergeSVGProperties(t,r){const i=new Set(Object.keys(t));for(const[s,a]of Object.entries(r))i.has(s)?Object.assign(t[s],a):t[s]=a;return t}static getDefaultDrawingOptions(t){fr("Not implemented")}static get typesMap(){fr("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,r){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,r),this._currentParent&&(g(gn,Yi).updateProperty(i,r),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,r){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,r)}static get defaultPropertiesToUpdate(){const t=[],r=this._defaultDrawingOptions;for(const[i,s]of this.typesMap)t.push([i,r[s]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:r}=this;for(const[i,s]of this.constructor.typesMap)t.push([i,r[s]]);return t}_updateProperty(t,r,i){const s=this._drawingOptions,a=s[r],o=l=>{var c;s.updateProperty(r,l);const u=g(this,Ao).updateProperty(r,l);u&&X(this,Pn,l1).call(this,u),(c=this.parent)==null||c.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,gn._mergeSVGProperties(g(this,Ao).getPathResizingSVGProperties(X(this,Pn,XM).call(this)),{bbox:X(this,Pn,B0).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,gn._mergeSVGProperties(g(this,Ao).getPathResizedSVGProperties(X(this,Pn,XM).call(this)),{bbox:X(this,Pn,B0).call(this)}))}_onTranslating(t,r){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:X(this,Pn,B0).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,gn._mergeSVGProperties(g(this,Ao).getPathTranslatedSVGProperties(X(this,Pn,XM).call(this),this.parentDimensions),{bbox:X(this,Pn,B0).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,g(this,Hx)&&(B(this,Hx,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){X(this,Pn,eL).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(X(this,Pn,o1).call(this),X(this,Pn,l1).call(this,g(this,Ao).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let r=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),X(this,Pn,eL).call(this)):t&&(this._uiManager.addShouldRescale(this),X(this,Pn,o1).call(this,t),r=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),r&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,gn._mergeSVGProperties({bbox:X(this,Pn,B0).call(this)},g(this,Ao).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&X(this,Pn,l1).call(this,g(this,Ao).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,r;this._isCopy&&(t=this.x,r=this.y);const i=super.render();i.classList.add("draw");const s=document.createElement("div");return i.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,r),i}static createDrawerInstance(t,r,i,s,a){fr("Not implemented")}static startDrawing(t,r,i,s){var y;const{target:a,offsetX:o,offsetY:l,pointerId:u,pointerType:c}=s;if(Vs.isInitializedAndDifferentPointerType(c))return;const{viewport:{rotation:h}}=t,{width:d,height:f}=a.getBoundingClientRect(),p=B(gn,Yg,new AbortController),m=t.combinedSignal(p);if(Vs.setPointer(c,u),window.addEventListener("pointerup",v=>{Vs.isSamePointerIdOrRemove(v.pointerId)&&this._endDraw(v)},{signal:m}),window.addEventListener("pointercancel",v=>{Vs.isSamePointerIdOrRemove(v.pointerId)&&this._currentParent.endDrawingSession()},{signal:m}),window.addEventListener("pointerdown",v=>{Vs.isSamePointerType(v.pointerType)&&(Vs.initializeAndAddPointerId(v.pointerId),g(gn,Yi).isCancellable()&&(g(gn,Yi).removeLastElement(),g(gn,Yi).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",Cl,{signal:m}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:m}),a.addEventListener("touchmove",v=>{Vs.isSameTimeStamp(v.timeStamp)&&Yr(v)},{signal:m}),t.toggleDrawing(),(y=r._editorUndoBar)==null||y.hide(),g(gn,Yi)){t.drawLayer.updateProperties(this._currentDrawId,g(gn,Yi).startNew(o,l,d,f,h));return}r.updateUIForDefaultProperties(this),B(gn,Yi,this.createDrawerInstance(o,l,d,f,h)),B(gn,Qg,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(g(gn,Qg).toSVGProperties(),g(gn,Yi).defaultSVGProperties),!0,!1)}static _drawMove(t){if(Vs.isSameTimeStamp(t.timeStamp),!g(gn,Yi))return;const{offsetX:r,offsetY:i,pointerId:s}=t;if(Vs.isSamePointerId(s)){if(Vs.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,g(gn,Yi).add(r,i)),Vs.setTimeStamp(t.timeStamp),Yr(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,B(gn,Yi,null),B(gn,Qg,null),Vs.clearPointerType(),Vs.clearTimeStamp()),g(gn,Yg)&&(g(gn,Yg).abort(),B(gn,Yg,null),Vs.clearPointerIds())}static _endDraw(t){const r=this._currentParent;if(r){if(r.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===r.div&&r.drawLayer.updateProperties(this._currentDrawId,g(gn,Yi).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=g(gn,Yi),s=this._currentDrawId,a=i.getLastElement();r.addCommands({cmd:()=>{r.drawLayer.updateProperties(s,i.setLastElement(a))},undo:()=>{r.drawLayer.updateProperties(s,i.removeLastElement())},mustExec:!1,type:En.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const r=this._currentParent;if(!r)return null;if(r.toggleDrawing(!0),r.cleanUndoStack(En.DRAW_STEP),!g(gn,Yi).isEmpty()){const{pageDimensions:[i,s],scale:a}=r,o=r.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:g(gn,Yi).getOutlines(i*a,s*a,a,this._INNER_MARGIN),drawingOptions:g(gn,Qg),mustBeCommitted:!t});return this._cleanup(!0),o}return r.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,r,i,s,a,o){fr("Not implemented")}static async deserialize(t,r,i){var h,d;const{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}=r.viewport,u=this.deserializeDraw(o,l,s,a,this._INNER_MARGIN,t),c=await super.deserialize(t,r,i);return c.createDrawingOptions(t),X(h=c,Pn,ZF).call(h,{drawOutlines:u}),X(d=c,Pn,o1).call(d),c.onScaleChanging(),c.rotate(),c}serializeDraw(t){const[r,i]=this.pageTranslation,[s,a]=this.pageDimensions;return g(this,Ao).serialize([r,i,s,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};Ao=new WeakMap,Hx=new WeakMap,Yi=new WeakMap,Yg=new WeakMap,Qg=new WeakMap,Pn=new WeakSet,ZF=function({drawOutlines:t,drawId:r,drawingOptions:i}){B(this,Ao,t),this._drawingOptions||(this._drawingOptions=i),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),r>=0?(this._drawId=r,this.parent.drawLayer.finalizeDraw(r,t.defaultProperties)):this._drawId=X(this,Pn,JF).call(this,t,this.parent),X(this,Pn,l1).call(this,t.box)},JF=function(t,r){const{id:i}=r.drawLayer.draw(gn._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},eL=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},o1=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=X(this,Pn,JF).call(this,g(this,Ao),t)}},EJ=function([t,r,i,s]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[r,1-t,i*(o/a),s*(a/o)];case 180:return[1-t,1-r,i,s];case 270:return[1-r,t,i*(o/a),s*(a/o)];default:return[t,r,i,s]}},XM=function(){const{x:t,y:r,width:i,height:s,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-r,t,i*(a/o),s*(o/a)];case 180:return[1-t,1-r,i,s];case 270:return[r,1-t,i*(a/o),s*(o/a)];default:return[t,r,i,s]}},l1=function(t){[this.x,this.y,this.width,this.height]=X(this,Pn,EJ).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},B0=function(){const{x:t,y:r,width:i,height:s,rotation:a,parentRotation:o,parentDimensions:[l,u]}=this;switch((a*4+o)/90){case 1:return[1-r-s,t,s,i];case 2:return[1-t-i,1-r-s,i,s];case 3:return[r,1-t-i,s,i];case 4:return[t,r-i*(l/u),s*(u/l),i*(l/u)];case 5:return[1-r,t,i*(l/u),s*(u/l)];case 6:return[1-t-s*(u/l),1-r,s*(u/l),i*(l/u)];case 7:return[r-i*(l/u),1-t-s*(u/l),i*(l/u),s*(u/l)];case 8:return[t-i,r-s,i,s];case 9:return[1-r,t-i,s,i];case 10:return[1-t,1-r,i,s];case 11:return[r-s,1-t,s,i];case 12:return[t-s*(u/l),r,s*(u/l),i*(l/u)];case 13:return[1-r-i*(l/u),t-s*(u/l),i*(l/u),s*(u/l)];case 14:return[1-t,1-r-i*(l/u),s*(u/l),i*(l/u)];case 15:return[r,1-t,i*(l/u),s*(u/l)];default:return[t,r,i,s]}},Qe(gn,"_currentDrawId",-1),Qe(gn,"_currentParent",null),G(gn,Yi,null),G(gn,Yg,null),G(gn,Qg,null),Qe(gn,"_INNER_MARGIN",3);let mD=gn;var ec,Qi,Zi,Zg,Gx,fa,ps,hl,Jg,ev,tv,jx,KM;class Cye{constructor(e,t,r,i,s,a){G(this,jx);G(this,ec,new Float64Array(6));G(this,Qi);G(this,Zi);G(this,Zg);G(this,Gx);G(this,fa);G(this,ps,"");G(this,hl,0);G(this,Jg,new XS);G(this,ev);G(this,tv);B(this,ev,r),B(this,tv,i),B(this,Zg,s),B(this,Gx,a),[e,t]=X(this,jx,KM).call(this,e,t);const o=B(this,Qi,[NaN,NaN,NaN,NaN,e,t]);B(this,fa,[e,t]),B(this,Zi,[{line:o,points:g(this,fa)}]),g(this,ec).set(o,0)}updateProperty(e,t){e==="stroke-width"&&B(this,Gx,t)}isEmpty(){return!g(this,Zi)||g(this,Zi).length===0}isCancellable(){return g(this,fa).length<=10}add(e,t){[e,t]=X(this,jx,KM).call(this,e,t);const[r,i,s,a]=g(this,ec).subarray(2,6),o=e-s,l=t-a;return Math.hypot(g(this,ev)*o,g(this,tv)*l)<=2?null:(g(this,fa).push(e,t),isNaN(r)?(g(this,ec).set([s,a,e,t],2),g(this,Qi).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(g(this,ec)[0])&&g(this,Qi).splice(6,6),g(this,ec).set([r,i,s,a,e,t],0),g(this,Qi).push(...pt.createBezierPoints(r,i,s,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const r=this.add(e,t);return r||(g(this,fa).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,r,i,s){B(this,ev,r),B(this,tv,i),B(this,Zg,s),[e,t]=X(this,jx,KM).call(this,e,t);const a=B(this,Qi,[NaN,NaN,NaN,NaN,e,t]);B(this,fa,[e,t]);const o=g(this,Zi).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),g(this,Zi).push({line:a,points:g(this,fa)}),g(this,ec).set(a,0),B(this,hl,0),this.toSVGPath(),null}getLastElement(){return g(this,Zi).at(-1)}setLastElement(e){return g(this,Zi)?(g(this,Zi).push(e),B(this,Qi,e.line),B(this,fa,e.points),B(this,hl,0),{path:{d:this.toSVGPath()}}):g(this,Jg).setLastElement(e)}removeLastElement(){if(!g(this,Zi))return g(this,Jg).removeLastElement();g(this,Zi).pop(),B(this,ps,"");for(let e=0,t=g(this,Zi).length;e<t;e++){const{line:r,points:i}=g(this,Zi)[e];B(this,Qi,r),B(this,fa,i),B(this,hl,0),this.toSVGPath()}return{path:{d:g(this,ps)}}}toSVGPath(){const e=pt.svgRound(g(this,Qi)[4]),t=pt.svgRound(g(this,Qi)[5]);if(g(this,fa).length===2)return B(this,ps,`${g(this,ps)} M ${e} ${t} Z`),g(this,ps);if(g(this,fa).length<=6){const i=g(this,ps).lastIndexOf("M");B(this,ps,`${g(this,ps).slice(0,i)} M ${e} ${t}`),B(this,hl,6)}if(g(this,fa).length===4){const i=pt.svgRound(g(this,Qi)[10]),s=pt.svgRound(g(this,Qi)[11]);return B(this,ps,`${g(this,ps)} L ${i} ${s}`),B(this,hl,12),g(this,ps)}const r=[];g(this,hl)===0&&(r.push(`M ${e} ${t}`),B(this,hl,6));for(let i=g(this,hl),s=g(this,Qi).length;i<s;i+=6){const[a,o,l,u,c,h]=g(this,Qi).slice(i,i+6).map(pt.svgRound);r.push(`C${a} ${o} ${l} ${u} ${c} ${h}`)}return B(this,ps,g(this,ps)+r.join(" ")),B(this,hl,g(this,Qi).length),g(this,ps)}getOutlines(e,t,r,i){const s=g(this,Zi).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),g(this,Jg).build(g(this,Zi),e,t,r,g(this,Zg),g(this,Gx),i),B(this,ec,null),B(this,Qi,null),B(this,Zi,null),B(this,ps,null),g(this,Jg)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}ec=new WeakMap,Qi=new WeakMap,Zi=new WeakMap,Zg=new WeakMap,Gx=new WeakMap,fa=new WeakMap,ps=new WeakMap,hl=new WeakMap,Jg=new WeakMap,ev=new WeakMap,tv=new WeakMap,jx=new WeakSet,KM=function(e,t){return pt._normalizePoint(e,t,g(this,ev),g(this,tv),g(this,Zg))};var pa,bS,_S,To,tc,nc,qx,Wx,nv,xs,Yc,SJ,AJ,TJ;class XS extends pt{constructor(){super(...arguments);G(this,xs);G(this,pa);G(this,bS,0);G(this,_S);G(this,To);G(this,tc);G(this,nc);G(this,qx);G(this,Wx);G(this,nv)}build(t,r,i,s,a,o,l){B(this,tc,r),B(this,nc,i),B(this,qx,s),B(this,Wx,a),B(this,nv,o),B(this,_S,l??0),B(this,To,t),X(this,xs,AJ).call(this)}get thickness(){return g(this,nv)}setLastElement(t){return g(this,To).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return g(this,To).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:r}of g(this,To)){if(t.push(`M${pt.svgRound(r[4])} ${pt.svgRound(r[5])}`),r.length===6){t.push("Z");continue}if(r.length===12&&isNaN(r[6])){t.push(`L${pt.svgRound(r[10])} ${pt.svgRound(r[11])}`);continue}for(let i=6,s=r.length;i<s;i+=6){const[a,o,l,u,c,h]=r.subarray(i,i+6).map(pt.svgRound);t.push(`C${a} ${o} ${l} ${u} ${c} ${h}`)}}return t.join("")}serialize([t,r,i,s],a){const o=[],l=[],[u,c,h,d]=X(this,xs,SJ).call(this);let f,p,m,y,v,b,x,w,_;switch(g(this,Wx)){case 0:_=pt._rescale,f=t,p=r+s,m=i,y=-s,v=t+u*i,b=r+(1-c-d)*s,x=t+(u+h)*i,w=r+(1-c)*s;break;case 90:_=pt._rescaleAndSwap,f=t,p=r,m=i,y=s,v=t+c*i,b=r+u*s,x=t+(c+d)*i,w=r+(u+h)*s;break;case 180:_=pt._rescale,f=t+i,p=r,m=-i,y=s,v=t+(1-u-h)*i,b=r+c*s,x=t+(1-u)*i,w=r+(c+d)*s;break;case 270:_=pt._rescaleAndSwap,f=t+i,p=r+s,m=-i,y=-s,v=t+(1-c-d)*i,b=r+(1-u-h)*s,x=t+(1-c)*i,w=r+(1-u)*s;break}for(const{line:E,points:A}of g(this,To))o.push(_(E,f,p,m,y,a?new Array(E.length):null)),l.push(_(A,f,p,m,y,a?new Array(A.length):null));return{lines:o,points:l,rect:[v,b,x,w]}}static deserialize(t,r,i,s,a,{paths:{lines:o,points:l},rotation:u,thickness:c}){const h=[];let d,f,p,m,y;switch(u){case 0:y=pt._rescale,d=-t/i,f=r/s+1,p=1/i,m=-1/s;break;case 90:y=pt._rescaleAndSwap,d=-r/s,f=-t/i,p=1/s,m=1/i;break;case 180:y=pt._rescale,d=t/i+1,f=-r/s,p=-1/i,m=1/s;break;case 270:y=pt._rescaleAndSwap,d=r/s+1,f=t/i+1,p=-1/s,m=-1/i;break}if(!o){o=[];for(const b of l){const x=b.length;if(x===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1]]));continue}if(x===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1],NaN,NaN,NaN,NaN,b[2],b[3]]));continue}const w=new Float32Array(3*(x-2));o.push(w);let[_,E,A,T]=b.subarray(0,4);w.set([NaN,NaN,NaN,NaN,_,E],0);for(let S=4;S<x;S+=2){const M=b[S],D=b[S+1];w.set(pt.createBezierPoints(_,E,A,T,M,D),(S-2)*3),[_,E,A,T]=[A,T,M,D]}}}for(let b=0,x=o.length;b<x;b++)h.push({line:y(o[b].map(w=>w??NaN),d,f,p,m),points:y(l[b].map(w=>w??NaN),d,f,p,m)});const v=new this.prototype.constructor;return v.build(h,i,s,1,u,c,a),v}get box(){return g(this,pa)}updateProperty(t,r){return t==="stroke-width"?X(this,xs,TJ).call(this,r):null}updateParentDimensions([t,r],i){const[s,a]=X(this,xs,Yc).call(this);B(this,tc,t),B(this,nc,r),B(this,qx,i);const[o,l]=X(this,xs,Yc).call(this),u=o-s,c=l-a,h=g(this,pa);return h[0]-=u,h[1]-=c,h[2]+=2*u,h[3]+=2*c,h}updateRotation(t){return B(this,bS,t),{path:{transform:this.rotationTransform}}}get viewBox(){return g(this,pa).map(pt.svgRound).join(" ")}get defaultProperties(){const[t,r]=g(this,pa);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${pt.svgRound(t)} ${pt.svgRound(r)}`}}}get rotationTransform(){const[,,t,r]=g(this,pa);let i=0,s=0,a=0,o=0,l=0,u=0;switch(g(this,bS)){case 90:s=r/t,a=-t/r,l=t;break;case 180:i=-1,o=-1,l=t,u=r;break;case 270:s=-r/t,a=t/r,u=r;break;default:return""}return`matrix(${i} ${s} ${a} ${o} ${pt.svgRound(l)} ${pt.svgRound(u)})`}getPathResizingSVGProperties([t,r,i,s]){const[a,o]=X(this,xs,Yc).call(this),[l,u,c,h]=g(this,pa);if(Math.abs(c-a)<=pt.PRECISION||Math.abs(h-o)<=pt.PRECISION){const y=t+i/2-(l+c/2),v=r+s/2-(u+h/2);return{path:{"transform-origin":`${pt.svgRound(t)} ${pt.svgRound(r)}`,transform:`${this.rotationTransform} translate(${y} ${v})`}}}const d=(i-2*a)/(c-2*a),f=(s-2*o)/(h-2*o),p=c/i,m=h/s;return{path:{"transform-origin":`${pt.svgRound(l)} ${pt.svgRound(u)}`,transform:`${this.rotationTransform} scale(${p} ${m}) translate(${pt.svgRound(a)} ${pt.svgRound(o)}) scale(${d} ${f}) translate(${pt.svgRound(-a)} ${pt.svgRound(-o)})`}}}getPathResizedSVGProperties([t,r,i,s]){const[a,o]=X(this,xs,Yc).call(this),l=g(this,pa),[u,c,h,d]=l;if(l[0]=t,l[1]=r,l[2]=i,l[3]=s,Math.abs(h-a)<=pt.PRECISION||Math.abs(d-o)<=pt.PRECISION){const v=t+i/2-(u+h/2),b=r+s/2-(c+d/2);for(const{line:x,points:w}of g(this,To))pt._translate(x,v,b,x),pt._translate(w,v,b,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${pt.svgRound(t)} ${pt.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const f=(i-2*a)/(h-2*a),p=(s-2*o)/(d-2*o),m=-f*(u+a)+t+a,y=-p*(c+o)+r+o;if(f!==1||p!==1||m!==0||y!==0)for(const{line:v,points:b}of g(this,To))pt._rescale(v,m,y,f,p,v),pt._rescale(b,m,y,f,p,b);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${pt.svgRound(t)} ${pt.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,r],i){const[s,a]=i,o=g(this,pa),l=t-o[0],u=r-o[1];if(g(this,tc)===s&&g(this,nc)===a)for(const{line:c,points:h}of g(this,To))pt._translate(c,l,u,c),pt._translate(h,l,u,h);else{const c=g(this,tc)/s,h=g(this,nc)/a;B(this,tc,s),B(this,nc,a);for(const{line:d,points:f}of g(this,To))pt._rescale(d,l,u,c,h,d),pt._rescale(f,l,u,c,h,f);o[2]*=c,o[3]*=h}return o[0]=t,o[1]=r,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${pt.svgRound(t)} ${pt.svgRound(r)}`}}}get defaultSVGProperties(){const t=g(this,pa);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${pt.svgRound(t[0])} ${pt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}pa=new WeakMap,bS=new WeakMap,_S=new WeakMap,To=new WeakMap,tc=new WeakMap,nc=new WeakMap,qx=new WeakMap,Wx=new WeakMap,nv=new WeakMap,xs=new WeakSet,Yc=function(t=g(this,nv)){const r=g(this,_S)+t/2*g(this,qx);return g(this,Wx)%180===0?[r/g(this,tc),r/g(this,nc)]:[r/g(this,nc),r/g(this,tc)]},SJ=function(){const[t,r,i,s]=g(this,pa),[a,o]=X(this,xs,Yc).call(this,0);return[t+a,r+o,i-2*a,s-2*o]},AJ=function(){const t=B(this,pa,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:s}of g(this,To)){if(s.length<=12){for(let l=4,u=s.length;l<u;l+=6)yt.pointBoundingBox(s[l],s[l+1],t);continue}let a=s[4],o=s[5];for(let l=6,u=s.length;l<u;l+=6){const[c,h,d,f,p,m]=s.subarray(l,l+6);yt.bezierBoundingBox(a,o,c,h,d,f,p,m,t),a=p,o=m}}const[r,i]=X(this,xs,Yc).call(this);t[0]=va(t[0]-r,0,1),t[1]=va(t[1]-i,0,1),t[2]=va(t[2]+r,0,1),t[3]=va(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]},TJ=function(t){const[r,i]=X(this,xs,Yc).call(this);B(this,nv,t);const[s,a]=X(this,xs,Yc).call(this),[o,l]=[s-r,a-i],u=g(this,pa);return u[0]-=o,u[1]-=l,u[2]+=2*o,u[3]+=2*l,u};class xN extends wJ{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:br._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new xN(this._viewParameters);return e.updateAll(this),e}}var b2,MJ;const hy=class hy extends mD{constructor(t){super({...t,name:"inkEditor"});G(this,b2);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,r){br.initialize(t,r),this._defaultDrawingOptions=new xN(r.viewParameters)}static getDefaultDrawingOptions(t){const r=this._defaultDrawingOptions.clone();return r.updateProperties(t),r}static get supportMultipleDrawings(){return!0}static get typesMap(){return Kt(this,"typesMap",new Map([[En.INK_THICKNESS,"stroke-width"],[En.INK_COLOR,"stroke"],[En.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,r,i,s,a){return new Cye(t,r,i,s,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,r,i,s,a,o){return XS.deserialize(t,r,i,s,a,o)}static async deserialize(t,r,i){let s=null;if(t instanceof g4){const{data:{inkLists:o,rect:l,rotation:u,id:c,color:h,opacity:d,borderStyle:{rawWidth:f},popupRef:p,richText:m,contentsObj:y,creationDate:v,modificationDate:b},parent:{page:{pageNumber:x}}}=t;s=t={annotationType:Jt.INK,color:Array.from(h),thickness:f,opacity:d,paths:{points:o},boxes:null,pageIndex:x-1,rect:l.slice(0),rotation:u,annotationElementId:c,id:c,deleted:!1,popupRef:p,richText:m,comment:(y==null?void 0:y.str)||null,creationDate:v,modificationDate:b}}const a=await super.deserialize(t,r,i);return a._initialData=s,t.comment&&a.setCommentData(t),a}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new hD(this)),[["colorPicker",this._colorPicker]]}get colorType(){return En.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:r,parent:i}=this;r.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,r.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:r,opacity:i}){this._drawingOptions=hy.getDefaultDrawingOptions({stroke:yt.makeHexColor(...t),"stroke-width":r,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:r,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:s,"stroke-opacity":a,"stroke-width":o}}=this,l=Object.assign(super.serialize(t),{color:br._colorManager.convert(s),opacity:a,thickness:o,paths:{lines:r,points:i}});return this.addComment(l),t?(l.isCopy=!0,l):this.annotationElementId&&!X(this,b2,MJ).call(this,l)?null:(l.id=this.annotationElementId,l)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:r,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:r,popup:this.comment}),null}};b2=new WeakSet,MJ=function(t){const{color:r,thickness:i,opacity:s,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==r[l])||t.thickness!==i||t.opacity!==s||t.pageIndex!==a},Qe(hy,"_type","ink"),Qe(hy,"_editorType",Jt.INK),Qe(hy,"_defaultDrawingOptions",null);let tL=hy;class nL extends XS{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const iT=8,__=3;var rv,Hn,rL,Jl,CJ,DJ,iL,YM,NJ,RJ,IJ,sL,aL,PJ;class Oh{static extractContoursFromText(e,{fontFamily:t,fontStyle:r,fontWeight:i},s,a,o,l){let u=new OffscreenCanvas(1,1),c=u.getContext("2d",{alpha:!1});const h=200,d=c.font=`${r} ${i} ${h}px ${t}`,{actualBoundingBoxLeft:f,actualBoundingBoxRight:p,actualBoundingBoxAscent:m,actualBoundingBoxDescent:y,fontBoundingBoxAscent:v,fontBoundingBoxDescent:b,width:x}=c.measureText(e),w=1.5,_=Math.ceil(Math.max(Math.abs(f)+Math.abs(p)||0,x)*w),E=Math.ceil(Math.max(Math.abs(m)+Math.abs(y)||h,Math.abs(v)+Math.abs(b)||h)*w);u=new OffscreenCanvas(_,E),c=u.getContext("2d",{alpha:!0,willReadFrequently:!0}),c.font=d,c.filter="grayscale(1)",c.fillStyle="white",c.fillRect(0,0,_,E),c.fillStyle="black",c.fillText(e,_*(w-1)/2,E*(3-w)/2);const A=X(this,Hn,sL).call(this,c.getImageData(0,0,_,E).data),T=X(this,Hn,IJ).call(this,A),S=X(this,Hn,aL).call(this,T),M=X(this,Hn,iL).call(this,A,_,E,S);return this.processDrawnLines({lines:{curves:M,width:_,height:E},pageWidth:s,pageHeight:a,rotation:o,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(e,t,r,i,s){const[a,o,l]=X(this,Hn,PJ).call(this,e),[u,c]=X(this,Hn,RJ).call(this,a,o,l,Math.hypot(o,l)*g(this,rv).sigmaSFactor,g(this,rv).sigmaR,g(this,rv).kernelSize),h=X(this,Hn,aL).call(this,c),d=X(this,Hn,iL).call(this,u,o,l,h);return this.processDrawnLines({lines:{curves:d,width:o,height:l},pageWidth:t,pageHeight:r,rotation:i,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:r,rotation:i,innerMargin:s,mustSmooth:a,areContours:o}){i%180!==0&&([t,r]=[r,t]);const{curves:l,width:u,height:c}=e,h=e.thickness??0,d=[],f=Math.min(t/u,r/c),p=f/t,m=f/r,y=[];for(const{points:b}of l){const x=a?X(this,Hn,NJ).call(this,b):b;if(!x)continue;y.push(x);const w=x.length,_=new Float32Array(w),E=new Float32Array(3*(w===2?2:w-2));if(d.push({line:E,points:_}),w===2){_[0]=x[0]*p,_[1]=x[1]*m,E.set([NaN,NaN,NaN,NaN,_[0],_[1]],0);continue}let[A,T,S,M]=x;A*=p,T*=m,S*=p,M*=m,_.set([A,T,S,M],0),E.set([NaN,NaN,NaN,NaN,A,T],0);for(let D=4;D<w;D+=2){const N=_[D]=x[D]*p,R=_[D+1]=x[D+1]*m;E.set(pt.createBezierPoints(A,T,S,M,N,R),(D-2)*3),[A,T,S,M]=[S,M,N,R]}}if(d.length===0)return null;const v=o?new nL:new XS;return v.build(d,t,r,1,i,o?0:h,s),{outline:v,newCurves:y,areContours:o,thickness:h,width:u,height:c}}static async compressSignature({outlines:e,areContours:t,thickness:r,width:i,height:s}){let a=1/0,o=-1/0,l=0;for(const x of e){l+=x.length;for(let w=2,_=x.length;w<_;w++){const E=x[w]-x[w-2];a=Math.min(a,E),o=Math.max(o,E)}}let u;a>=-128&&o<=127?u=Int8Array:a>=-32768&&o<=32767?u=Int16Array:u=Int32Array;const c=e.length,h=iT+__*c,d=new Uint32Array(h);let f=0;d[f++]=h*Uint32Array.BYTES_PER_ELEMENT+(l-2*c)*u.BYTES_PER_ELEMENT,d[f++]=0,d[f++]=i,d[f++]=s,d[f++]=t?0:1,d[f++]=Math.max(0,Math.floor(r??0)),d[f++]=c,d[f++]=u.BYTES_PER_ELEMENT;for(const x of e)d[f++]=x.length-2,d[f++]=x[0],d[f++]=x[1];const p=new CompressionStream("deflate-raw"),m=p.writable.getWriter();await m.ready,m.write(d);const y=u.prototype.constructor;for(const x of e){const w=new y(x.length-2);for(let _=2,E=x.length;_<E;_++)w[_-2]=x[_]-x[_-2];m.write(w)}m.close();const v=await new Response(p.readable).arrayBuffer(),b=new Uint8Array(v);return RQ(b)}static async decompressSignature(e){try{const t=Gve(e),{readable:r,writable:i}=new DecompressionStream("deflate-raw"),s=i.getWriter();await s.ready,s.write(t).then(async()=>{await s.ready,await s.close()}).catch(()=>{});let a=null,o=0;for await(const x of r)a||(a=new Uint8Array(new Uint32Array(x.buffer,0,4)[0])),a.set(x,o),o+=x.length;const l=new Uint32Array(a.buffer,0,a.length>>2),u=l[1];if(u!==0)throw new Error(`Invalid version: ${u}`);const c=l[2],h=l[3],d=l[4]===0,f=l[5],p=l[6],m=l[7],y=[],v=(iT+__*p)*Uint32Array.BYTES_PER_ELEMENT;let b;switch(m){case Int8Array.BYTES_PER_ELEMENT:b=new Int8Array(a.buffer,v);break;case Int16Array.BYTES_PER_ELEMENT:b=new Int16Array(a.buffer,v);break;case Int32Array.BYTES_PER_ELEMENT:b=new Int32Array(a.buffer,v);break}o=0;for(let x=0;x<p;x++){const w=l[__*x+iT],_=new Float32Array(w+2);y.push(_);for(let E=0;E<__-1;E++)_[E]=l[__*x+iT+E+1];for(let E=0;E<w;E++)_[E+2]=_[E]+b[o++]}return{areContours:d,thickness:f,outlines:y,width:c,height:h}}catch(t){return Xt(`decompressSignature: ${t}`),null}}}rv=new WeakMap,Hn=new WeakSet,rL=function(e,t,r,i){return r-=e,i-=t,r===0?i>0?0:4:r===1?i+6:2-i},Jl=new WeakMap,CJ=function(e,t,r,i,s,a,o){const l=X(this,Hn,rL).call(this,r,i,s,a);for(let u=0;u<8;u++){const c=(-u+l-o+16)%8,h=g(this,Jl)[2*c],d=g(this,Jl)[2*c+1];if(e[(r+h)*t+(i+d)]!==0)return c}return-1},DJ=function(e,t,r,i,s,a,o){const l=X(this,Hn,rL).call(this,r,i,s,a);for(let u=0;u<8;u++){const c=(u+l+o+16)%8,h=g(this,Jl)[2*c],d=g(this,Jl)[2*c+1];if(e[(r+h)*t+(i+d)]!==0)return c}return-1},iL=function(e,t,r,i){const s=e.length,a=new Int32Array(s);for(let c=0;c<s;c++)a[c]=e[c]<=i?1:0;for(let c=1;c<r-1;c++)a[c*t]=a[c*t+t-1]=0;for(let c=0;c<t;c++)a[c]=a[t*r-1-c]=0;let o=1,l;const u=[];for(let c=1;c<r-1;c++){l=1;for(let h=1;h<t-1;h++){const d=c*t+h,f=a[d];if(f===0)continue;let p=c,m=h;if(f===1&&a[d-1]===0)o+=1,m-=1;else if(f>=1&&a[d+1]===0)o+=1,m+=1,f>1&&(l=f);else{f!==1&&(l=Math.abs(f));continue}const y=[h,c],v=m===h+1,b={isHole:v,points:y,id:o,parent:0};u.push(b);let x;for(const D of u)if(D.id===l){x=D;break}x?x.isHole?b.parent=v?x.parent:l:b.parent=v?l:x.parent:b.parent=v?l:0;const w=X(this,Hn,CJ).call(this,a,t,c,h,p,m,0);if(w===-1){a[d]=-o,a[d]!==1&&(l=Math.abs(a[d]));continue}let _=g(this,Jl)[2*w],E=g(this,Jl)[2*w+1];const A=c+_,T=h+E;p=A,m=T;let S=c,M=h;for(;;){const D=X(this,Hn,DJ).call(this,a,t,S,M,p,m,1);_=g(this,Jl)[2*D],E=g(this,Jl)[2*D+1];const N=S+_,R=M+E;y.push(R,N);const z=S*t+M;if(a[z+1]===0?a[z]=-o:a[z]===1&&(a[z]=o),N===c&&R===h&&S===A&&M===T){a[d]!==1&&(l=Math.abs(a[d]));break}else p=S,m=M,S=N,M=R}}}return u},YM=function(e,t,r,i){if(r-t<=4){for(let A=t;A<r-2;A+=2)i.push(e[A],e[A+1]);return}const s=e[t],a=e[t+1],o=e[r-4]-s,l=e[r-3]-a,u=Math.hypot(o,l),c=o/u,h=l/u,d=c*a-h*s,f=l/o,p=1/u,m=Math.atan(f),y=Math.cos(m),v=Math.sin(m),b=p*(Math.abs(y)+Math.abs(v)),x=p*(1-b+b**2),w=Math.max(Math.atan(Math.abs(v+y)*x),Math.atan(Math.abs(v-y)*x));let _=0,E=t;for(let A=t+2;A<r-2;A+=2){const T=Math.abs(d-c*e[A+1]+h*e[A]);T>_&&(E=A,_=T)}_>(u*w)**2?(X(this,Hn,YM).call(this,e,t,E+2,i),X(this,Hn,YM).call(this,e,E,r,i)):i.push(s,a)},NJ=function(e){const t=[],r=e.length;return X(this,Hn,YM).call(this,e,0,r,t),t.push(e[r-2],e[r-1]),t.length<=4?null:t},RJ=function(e,t,r,i,s,a){const o=new Float32Array(a**2),l=-2*i**2,u=a>>1;for(let m=0;m<a;m++){const y=(m-u)**2;for(let v=0;v<a;v++)o[m*a+v]=Math.exp((y+(v-u)**2)/l)}const c=new Float32Array(256),h=-2*s**2;for(let m=0;m<256;m++)c[m]=Math.exp(m**2/h);const d=e.length,f=new Uint8Array(d),p=new Uint32Array(256);for(let m=0;m<r;m++)for(let y=0;y<t;y++){const v=m*t+y,b=e[v];let x=0,w=0;for(let E=0;E<a;E++){const A=m+E-u;if(!(A<0||A>=r))for(let T=0;T<a;T++){const S=y+T-u;if(S<0||S>=t)continue;const M=e[A*t+S],D=o[E*a+T]*c[Math.abs(M-b)];x+=M*D,w+=D}}const _=f[v]=Math.round(x/w);p[_]++}return[f,p]},IJ=function(e){const t=new Uint32Array(256);for(const r of e)t[r]++;return t},sL=function(e){const t=e.length,r=new Uint8ClampedArray(t>>2);let i=-1/0,s=1/0;for(let o=0,l=r.length;o<l;o++){const u=r[o]=e[o<<2];i=Math.max(i,u),s=Math.min(s,u)}const a=255/(i-s);for(let o=0,l=r.length;o<l;o++)r[o]=(r[o]-s)*a;return r},aL=function(e){let t,r=-1/0,i=-1/0;const s=e.findIndex(l=>l!==0);let a=s,o=s;for(t=s;t<256;t++){const l=e[t];l>r&&(t-a>i&&(i=t-a,o=t-1),r=l,a=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t},PJ=function(e){const t=e,{width:r,height:i}=e,{maxDim:s}=g(this,rv);let a=r,o=i;if(r>s||i>s){let d=r,f=i,p=Math.log2(Math.max(r,i)/s);const m=Math.floor(p);p=p===m?m-1:m;for(let v=0;v<p;v++){a=Math.ceil(d/2),o=Math.ceil(f/2);const b=new OffscreenCanvas(a,o);b.getContext("2d").drawImage(e,0,0,d,f,0,0,a,o),d=a,f=o,e!==t&&e.close(),e=b.transferToImageBitmap()}const y=Math.min(s/a,s/o);a=Math.round(a*y),o=Math.round(o*y)}const u=new OffscreenCanvas(a,o).getContext("2d",{willReadFrequently:!0});u.fillStyle="white",u.fillRect(0,0,a,o),u.filter="grayscale(1)",u.drawImage(e,0,0,e.width,e.height,0,0,a,o);const c=u.getImageData(0,0,a,o).data;return[X(this,Hn,sL).call(this,c),a,o]},G(Oh,Hn),G(Oh,rv,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),G(Oh,Jl,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class v4 extends wJ{constructor(){super(),super.updateProperties({fill:br._defaultLineColor,"stroke-width":0})}clone(){const e=new v4;return e.updateAll(this),e}}class y4 extends xN{constructor(e){super(e),super.updateProperties({stroke:br._defaultLineColor,"stroke-width":1})}clone(){const e=new y4(this._viewParameters);return e.updateAll(this),e}}var $f,rc,Hf,iv;const lo=class lo extends mD{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});G(this,$f,!1);G(this,rc,null);G(this,Hf,null);G(this,iv,null);this._willKeepAspectRatio=!0,B(this,Hf,t.signatureData||null),B(this,rc,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,r){br.initialize(t,r),this._defaultDrawingOptions=new v4,this._defaultDrawnSignatureOptions=new y4(r.viewParameters)}static getDefaultDrawingOptions(t){const r=this._defaultDrawingOptions.clone();return r.updateProperties(t),r}static get supportMultipleDrawings(){return!1}static get typesMap(){return Kt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!g(this,rc)}}static computeTelemetryFinalData(t){const r=t.get("hasDescription");return{hasAltText:r.get(!0)??0,hasNoAltText:r.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,r;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,r=this.y),super.render(),this._drawId===null)if(g(this,Hf)){const{lines:s,mustSmooth:a,areContours:o,description:l,uuid:u,heightInPage:c}=g(this,Hf),{rawDims:{pageWidth:h,pageHeight:d},rotation:f}=this.parent.viewport,p=Oh.processDrawnLines({lines:s,pageWidth:h,pageHeight:d,rotation:f,innerMargin:lo._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(p,c,l,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:g(this,rc)||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,r)),this.div}setUuid(t){B(this,iv,t),this.addEditToolbar()}getUuid(){return g(this,iv)}get description(){return g(this,rc)}set description(t){B(this,rc,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(r=>{r==null||r.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:r,thickness:i,width:s,height:a}=g(this,Hf),o=Math.max(s,a),l=Oh.processDrawnLines({lines:{curves:t.map(u=>({points:u})),thickness:i,width:s,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:r});return{areContours:r,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,r,i,s){const{x:a,y:o}=this,{outline:l}=B(this,Hf,t);B(this,$f,l instanceof nL),this.description=i;let u;g(this,$f)?u=lo.getDefaultDrawingOptions():(u=lo._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:u});const[,c]=this.pageDimensions;let h=r/c;h=h>=1?.5:h,this.width*=h/this.height,this.width>=1&&(h*=.9/this.width,this.width=.9),this.height=h,this.setDims(),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:r,pageHeight:i},rotation:s}=this.parent.viewport;return Oh.process(t,r,i,s,lo._INNER_MARGIN)}getFromText(t,r){const{rawDims:{pageWidth:i,pageHeight:s},rotation:a}=this.parent.viewport;return Oh.extractContoursFromText(t,r,i,s,a,lo._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:r,pageHeight:i},rotation:s}=this.parent.viewport;return Oh.processDrawnLines({lines:t,pageWidth:r,pageHeight:i,rotation:s,innerMargin:lo._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:r}){t?this._drawingOptions=lo.getDefaultDrawingOptions():(this._drawingOptions=lo._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":r}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:r,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":s}}=this,a=Object.assign(super.serialize(t),{isSignature:!0,areContours:g(this,$f),color:[0,0,0],thickness:g(this,$f)?0:s});return this.addComment(a),t?(a.paths={lines:r,points:i},a.uuid=g(this,iv),a.isCopy=!0):a.lines=r,g(this,rc)&&(a.accessibilityData={type:"Figure",alt:g(this,rc)}),a}static deserializeDraw(t,r,i,s,a,o){return o.areContours?nL.deserialize(t,r,i,s,a,o):XS.deserialize(t,r,i,s,a,o)}static async deserialize(t,r,i){var a;const s=await super.deserialize(t,r,i);return B(s,$f,t.areContours),s.description=((a=t.accessibilityData)==null?void 0:a.alt)||"",B(s,iv,t.uuid),s}};$f=new WeakMap,rc=new WeakMap,Hf=new WeakMap,iv=new WeakMap,Qe(lo,"_type","signature"),Qe(lo,"_editorType",Jt.SIGNATURE),Qe(lo,"_defaultDrawingOptions",null);let oL=lo;var Cr,Ji,Gf,Rh,jf,Xx,Ih,sv,ic,Mo,Kx,Fn,u1,c1,QM,ZM,JM,uL,eC,FJ;class lL extends br{constructor(t){super({...t,name:"stampEditor"});G(this,Fn);G(this,Cr,null);G(this,Ji,null);G(this,Gf,null);G(this,Rh,null);G(this,jf,null);G(this,Xx,"");G(this,Ih,null);G(this,sv,!1);G(this,ic,null);G(this,Mo,!1);G(this,Kx,!1);B(this,Rh,t.bitmapUrl),B(this,jf,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,r){br.initialize(t,r)}static isHandlingMimeForPasting(t){return W3.includes(t)}static paste(t,r){r.pasteEditor({mode:Jt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const r=t.get("hasAltText");return{hasAltText:r.get(!0)??0,hasNoAltText:r.get(!1)??0}}async mlGuessAltText(t=null,r=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await i.guess({name:"altText",request:{data:s,width:a,height:o,channels:s.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const u=l.output;return await this.setGuessedAltText(u),r&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;g(this,Ji)&&(B(this,Cr,null),this._uiManager.imageManager.deleteId(g(this,Ji)),(t=g(this,Ih))==null||t.remove(),B(this,Ih,null),g(this,ic)&&(clearTimeout(g(this,ic)),B(this,ic,null))),super.remove()}rebuild(){if(!this.parent){g(this,Ji)&&X(this,Fn,QM).call(this);return}super.rebuild(),this.div!==null&&(g(this,Ji)&&g(this,Ih)===null&&X(this,Fn,QM).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(g(this,Gf)||g(this,Cr)||g(this,Rh)||g(this,jf)||g(this,Ji)||g(this,sv))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,r;return this._isCopy&&(t=this.x,r=this.y),super.render(),this.div.hidden=!0,this.createAltText(),g(this,sv)||(g(this,Cr)?X(this,Fn,ZM).call(this):X(this,Fn,QM).call(this)),this._isCopy&&this._moveAfterPaste(t,r),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,r){const{id:i,bitmap:s}=this._uiManager.imageManager.getFromCanvas(t,r);r.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(B(this,Ji,i),s&&B(this,Cr,s),B(this,sv,!1),X(this,Fn,ZM).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;g(this,ic)!==null&&clearTimeout(g(this,ic)),B(this,ic,setTimeout(()=>{B(this,ic,null),X(this,Fn,uL).call(this)},200))}copyCanvas(t,r,i=!1){t||(t=224);const{width:s,height:a}=g(this,Cr),o=new Ac;let l=g(this,Cr),u=s,c=a,h=null;if(r){if(s>r||a>r){const A=Math.min(r/s,r/a);u=Math.floor(s*A),c=Math.floor(a*A)}h=document.createElement("canvas");const f=h.width=Math.ceil(u*o.sx),p=h.height=Math.ceil(c*o.sy);g(this,Mo)||(l=X(this,Fn,JM).call(this,f,p));const m=h.getContext("2d");m.filter=this._uiManager.hcmFilter;let y="white",v="#cfcfd8";this._uiManager.hcmFilter!=="none"?v="black":Yve.isDarkMode&&(y="#8f8f9d",v="#42414d");const b=15,x=b*o.sx,w=b*o.sy,_=new OffscreenCanvas(x*2,w*2),E=_.getContext("2d");E.fillStyle=y,E.fillRect(0,0,x*2,w*2),E.fillStyle=v,E.fillRect(0,0,x,w),E.fillRect(x,w,x,w),m.fillStyle=m.createPattern(_,"repeat"),m.fillRect(0,0,f,p),m.drawImage(l,0,0,l.width,l.height,0,0,f,p)}let d=null;if(i){let f,p;if(o.symmetric&&l.width<t&&l.height<t)f=l.width,p=l.height;else if(l=g(this,Cr),s>t||a>t){const v=Math.min(t/s,t/a);f=Math.floor(s*v),p=Math.floor(a*v),g(this,Mo)||(l=X(this,Fn,JM).call(this,f,p))}const y=new OffscreenCanvas(f,p).getContext("2d",{willReadFrequently:!0});y.drawImage(l,0,0,l.width,l.height,0,0,f,p),d={width:f,height:p,data:y.getImageData(0,0,f,p).data}}return{canvas:h,width:u,height:c,imageData:d}}static async deserialize(t,r,i){var y;let s=null,a=!1;if(t instanceof YZ){const{data:{rect:v,rotation:b,id:x,structParent:w,popupRef:_,richText:E,contentsObj:A,creationDate:T,modificationDate:S},container:M,parent:{page:{pageNumber:D}},canvas:N}=t;let R,z;N?(delete t.canvas,{id:R,bitmap:z}=i.imageManager.getFromCanvas(M.id,N),N.remove()):(a=!0,t._hasNoCanvas=!0);const j=((y=await r._structTree.getAriaAttributes(`${ny}${x}`))==null?void 0:y.get("aria-label"))||"";s=t={annotationType:Jt.STAMP,bitmapId:R,bitmap:z,pageIndex:D-1,rect:v.slice(0),rotation:b,annotationElementId:x,id:x,deleted:!1,accessibilityData:{decorative:!1,altText:j},isSvg:!1,structParent:w,popupRef:_,richText:E,comment:(A==null?void 0:A.str)||null,creationDate:T,modificationDate:S}}const o=await super.deserialize(t,r,i),{rect:l,bitmap:u,bitmapUrl:c,bitmapId:h,isSvg:d,accessibilityData:f}=t;a?(i.addMissingCanvas(t.id,o),B(o,sv,!0)):h&&i.imageManager.isValidId(h)?(B(o,Ji,h),u&&B(o,Cr,u)):B(o,Rh,c),B(o,Mo,d);const[p,m]=o.pageDimensions;return o.width=(l[2]-l[0])/p,o.height=(l[3]-l[1])/m,f&&(o.altTextData=f),o._initialData=s,t.comment&&o.setCommentData(t),B(o,Kx,!!s),o}serialize(t=!1,r=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:g(this,Ji),isSvg:g(this,Mo)});if(this.addComment(i),t)return i.bitmapUrl=X(this,Fn,eC).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:s,altText:a}=this.serializeAltText(!1);if(!s&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=X(this,Fn,FJ).call(this,i);return l.isSame?null:(l.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(r===null)return i;r.stamps||(r.stamps=new Map);const o=g(this,Mo)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!r.stamps.has(g(this,Ji)))r.stamps.set(g(this,Ji),{area:o,serialized:i}),i.bitmap=X(this,Fn,eC).call(this,!1);else if(g(this,Mo)){const l=r.stamps.get(g(this,Ji));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=X(this,Fn,eC).call(this,!1))}return i}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}Cr=new WeakMap,Ji=new WeakMap,Gf=new WeakMap,Rh=new WeakMap,jf=new WeakMap,Xx=new WeakMap,Ih=new WeakMap,sv=new WeakMap,ic=new WeakMap,Mo=new WeakMap,Kx=new WeakMap,Fn=new WeakSet,u1=function(t,r=!1){if(!t){this.remove();return}B(this,Cr,t.bitmap),r||(B(this,Ji,t.id),B(this,Mo,t.isSvg)),t.file&&B(this,Xx,t.file.name),X(this,Fn,ZM).call(this)},c1=function(){if(B(this,Gf,null),this._uiManager.enableWaiting(!1),!!g(this,Ih)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&g(this,Cr)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&g(this,Cr)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},QM=function(){if(g(this,Ji)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(g(this,Ji)).then(i=>X(this,Fn,u1).call(this,i,!0)).finally(()=>X(this,Fn,c1).call(this));return}if(g(this,Rh)){const i=g(this,Rh);B(this,Rh,null),this._uiManager.enableWaiting(!0),B(this,Gf,this._uiManager.imageManager.getFromUrl(i).then(s=>X(this,Fn,u1).call(this,s)).finally(()=>X(this,Fn,c1).call(this)));return}if(g(this,jf)){const i=g(this,jf);B(this,jf,null),this._uiManager.enableWaiting(!0),B(this,Gf,this._uiManager.imageManager.getFromFile(i).then(s=>X(this,Fn,u1).call(this,s)).finally(()=>X(this,Fn,c1).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=W3.join(",");const r=this._uiManager._signal;B(this,Gf,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),X(this,Fn,u1).call(this,s)}i()},{signal:r}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:r})}).finally(()=>X(this,Fn,c1).call(this))),t.click()},ZM=function(){var u;const{div:t}=this;let{width:r,height:i}=g(this,Cr);const[s,a]=this.pageDimensions,o=.75;if(this.width)r=this.width*s,i=this.height*a;else if(r>o*s||i>o*a){const c=Math.min(o*s/r,o*a/i);r*=c,i*=c}this._uiManager.enableWaiting(!1);const l=B(this,Ih,document.createElement("canvas"));l.setAttribute("role","img"),this.addContainer(l),this.width=r/s,this.height=i/a,this.setDims(),(u=this._initialOptions)!=null&&u.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),X(this,Fn,uL).call(this),g(this,Kx)||(this.parent.addUndoableEditor(this),B(this,Kx,!0)),this._reportTelemetry({action:"inserted_image"}),g(this,Xx)&&this.div.setAttribute("aria-description",g(this,Xx)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},JM=function(t,r){const{width:i,height:s}=g(this,Cr);let a=i,o=s,l=g(this,Cr);for(;a>2*t||o>2*r;){const u=a,c=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*r&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const h=new OffscreenCanvas(a,o);h.getContext("2d").drawImage(l,0,0,u,c,0,0,a,o),l=h.transferToImageBitmap()}return l},uL=function(){const[t,r]=this.parentDimensions,{width:i,height:s}=this,a=new Ac,o=Math.ceil(i*t*a.sx),l=Math.ceil(s*r*a.sy),u=g(this,Ih);if(!u||u.width===o&&u.height===l)return;u.width=o,u.height=l;const c=g(this,Mo)?g(this,Cr):X(this,Fn,JM).call(this,o,l),h=u.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(c,0,0,c.width,c.height,0,0,o,l)},eC=function(t){if(t){if(g(this,Mo)){const s=this._uiManager.imageManager.getSvgUrl(g(this,Ji));if(s)return s}const r=document.createElement("canvas");return{width:r.width,height:r.height}=g(this,Cr),r.getContext("2d").drawImage(g(this,Cr),0,0),r.toDataURL()}if(g(this,Mo)){const[r,i]=this.pageDimensions,s=Math.round(this.width*r*Ip.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*Ip.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(s,a);return o.getContext("2d").drawImage(g(this,Cr),0,0,g(this,Cr).width,g(this,Cr).height,0,0,s,a),o.transferToImageBitmap()}return structuredClone(g(this,Cr))},FJ=function(t){var o;const{pageIndex:r,accessibilityData:{altText:i}}=this._initialData,s=t.pageIndex===r,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&a,isSameAltText:a}},Qe(lL,"_type","stamp"),Qe(lL,"_editorType",Jt.STAMP);var av,Yx,qf,Wf,Ph,$a,Xf,Qx,Zx,eu,Fh,es,Lh,Kf,Jx,_t,Yf,dr,hL,LJ,Pu,dL,fL,tC;const $l=class $l{constructor({uiManager:e,pageIndex:t,div:r,structTreeLayer:i,accessibilityManager:s,annotationLayer:a,drawLayer:o,textLayer:l,viewport:u,l10n:c}){G(this,dr);G(this,av);G(this,Yx,!1);G(this,qf,null);G(this,Wf,null);G(this,Ph,null);G(this,$a,new Map);G(this,Xf,!1);G(this,Qx,!1);G(this,Zx,!1);G(this,eu,null);G(this,Fh,null);G(this,es,null);G(this,Lh,null);G(this,Kf,null);G(this,Jx,-1);G(this,_t);const h=[...g($l,Yf).values()];if(!$l._initialized){$l._initialized=!0;for(const d of h)d.initialize(c,e)}e.registerEditorTypes(h),B(this,_t,e),this.pageIndex=t,this.div=r,B(this,av,s),B(this,qf,a),this.viewport=u,B(this,es,l),this.drawLayer=o,this._structTree=i,g(this,_t).addLayer(this)}get isEmpty(){return g(this,$a).size===0}get isInvisible(){return this.isEmpty&&g(this,_t).getMode()===Jt.NONE}updateToolbar(e){g(this,_t).updateToolbar(e)}updateMode(e=g(this,_t).getMode()){switch(X(this,dr,tC).call(this),e){case Jt.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Jt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Jt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===Jt.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const r of g($l,Yf).values())t.toggle(`${r._type}Editing`,e===r._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=g(this,es))==null?void 0:t.div)}setEditingState(e){g(this,_t).setEditingState(e)}addCommands(e){g(this,_t).addCommands(e)}cleanUndoStack(e){g(this,_t).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=g(this,qf))==null||t.togglePointerEvents(e)}async enable(){var r;B(this,Zx,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(r=g(this,Kf))==null||r.abort(),B(this,Kf,null);const e=new Set;for(const i of g(this,dr,hL))i.enableEditing(),i.show(!0),i.annotationElementId&&(g(this,_t).removeChangedExistingAnnotation(i),e.add(i.annotationElementId));const t=g(this,qf);if(t)for(const i of t.getEditableAnnotations()){if(i.hide(),g(this,_t).isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}B(this,Zx,!1),g(this,_t)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var i;if(B(this,Qx,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),g(this,es)&&!g(this,Kf)){B(this,Kf,new AbortController);const s=g(this,_t).combinedSignal(g(this,Kf));g(this,es).div.addEventListener("pointerdown",a=>{const{clientX:l,clientY:u,timeStamp:c}=a,h=g(this,Jx);if(c-h>500){B(this,Jx,c);return}B(this,Jx,-1);const{classList:d}=this.div;d.toggle("getElements",!0);const f=document.elementsFromPoint(l,u);if(d.toggle("getElements",!1),!this.div.contains(f[0]))return;let p;const m=new RegExp(`^${yw}[0-9]+$`);for(const v of f)if(m.test(v.id)){p=v.id;break}if(!p)return;const y=g(this,$a).get(p);(y==null?void 0:y.annotationElementId)===null&&(a.stopPropagation(),a.preventDefault(),y.dblclick(a))},{signal:s,capture:!0})}const e=g(this,qf),t=[];if(e){const s=new Map,a=new Map;for(const l of g(this,dr,hL)){if(l.disableEditing(),!l.annotationElementId){t.push(l);continue}if(l.serialize()!==null){s.set(l.annotationElementId,l);continue}else a.set(l.annotationElementId,l);(i=this.getEditableAnnotation(l.annotationElementId))==null||i.show(),l.remove()}const o=e.getEditableAnnotations();for(const l of o){const{id:u}=l.data;if(g(this,_t).isDeletedAnnotationElement(u)){l.updateEdited({deleted:!0});continue}let c=a.get(u);if(c){c.resetAnnotationElement(l),c.show(!1),l.show();continue}c=s.get(u),c&&(g(this,_t).addChangedExistingAnnotation(c),c.renderAnnotationElement(l)&&c.show(!1)),l.show()}}X(this,dr,tC).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:r}=this.div;for(const s of g($l,Yf).values())r.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e==null||e.updateFakeAnnotations(t),B(this,Qx,!1)}getEditableAnnotation(e){var t;return((t=g(this,qf))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){g(this,_t).getActive()!==e&&g(this,_t).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=g(this,es))!=null&&e.div&&!g(this,Lh)){B(this,Lh,new AbortController);const t=g(this,_t).combinedSignal(g(this,Lh));g(this,es).div.addEventListener("pointerdown",X(this,dr,LJ).bind(this),{signal:t}),g(this,es).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=g(this,es))!=null&&e.div&&g(this,Lh)&&(g(this,Lh).abort(),B(this,Lh,null),g(this,es).div.classList.remove("highlighting"))}enableClick(){if(g(this,Wf))return;B(this,Wf,new AbortController);const e=g(this,_t).combinedSignal(g(this,Wf));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=g(this,Wf))==null||e.abort(),B(this,Wf,null)}attach(e){g(this,$a).set(e.id,e);const{annotationElementId:t}=e;t&&g(this,_t).isDeletedAnnotationElement(t)&&g(this,_t).removeDeletedAnnotationElement(e)}detach(e){var t;g(this,$a).delete(e.id),(t=g(this,av))==null||t.removePointerInTextLayer(e.contentDiv),!g(this,Qx)&&e.annotationElementId&&g(this,_t).addDeletedAnnotationElement(e)}remove(e){this.detach(e),g(this,_t).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(g(this,_t).addDeletedAnnotationElement(e),br.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),g(this,_t).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!g(this,Zx)),g(this,_t).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var r;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!g(this,Ph)&&(e._focusEventsAllowed=!1,B(this,Ph,setTimeout(()=>{B(this,Ph,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:g(this,_t)._signal}),t.focus())},0))),e._structTreeParentId=(r=g(this,av))==null?void 0:r.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),r=()=>{e.remove()};this.addCommands({cmd:t,undo:r,mustExec:!1})}getEditorByUID(e){for(const t of g(this,$a).values())if(t.uid===e)return t;return null}getNextId(){return g(this,_t).getId()}combinedSignal(e){return g(this,_t).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=g(this,dr,Pu))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await g(this,_t).updateMode(e.mode);const{offsetX:r,offsetY:i}=X(this,dr,fL).call(this),s=this.getNextId(),a=X(this,dr,dL).call(this,{parent:this,id:s,x:r,y:i,uiManager:g(this,_t),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=g($l,Yf).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,g(this,_t)))||null}createAndAddNewEditor(e,t,r={}){const i=this.getNextId(),s=X(this,dr,dL).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:g(this,_t),isCentered:t,...r});return s&&this.add(s),s}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(X(this,dr,fL).call(this),!0,e)}setSelected(e){g(this,_t).setSelected(e)}toggleSelected(e){g(this,_t).toggleSelected(e)}unselect(e){g(this,_t).unselect(e)}pointerup(e){var i;const{isMac:t}=Ts.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!g(this,Xf)||(B(this,Xf,!1),(i=g(this,dr,Pu))!=null&&i.isDrawer&&g(this,dr,Pu).supportMultipleDrawings))return;if(!g(this,Yx)){B(this,Yx,!0);return}const r=g(this,_t).getMode();if(r===Jt.STAMP||r===Jt.SIGNATURE){g(this,_t).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var i;if(g(this,_t).getMode()===Jt.HIGHLIGHT&&this.enableTextSelection(),g(this,Xf)){B(this,Xf,!1);return}const{isMac:t}=Ts.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(B(this,Xf,!0),(i=g(this,dr,Pu))!=null&&i.isDrawer){this.startDrawingSession(e);return}const r=g(this,_t).getActive();B(this,Yx,!r||r.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),g(this,eu)){g(this,dr,Pu).startDrawing(this,g(this,_t),!1,e);return}g(this,_t).setCurrentDrawingSession(this),B(this,eu,new AbortController);const t=g(this,_t).combinedSignal(g(this,eu));this.div.addEventListener("blur",({relatedTarget:r})=>{r&&!this.div.contains(r)&&(B(this,Fh,null),this.commitOrRemove())},{signal:t}),g(this,dr,Pu).startDrawing(this,g(this,_t),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&B(this,Fh,t);return}g(this,Fh)&&setTimeout(()=>{var t;(t=g(this,Fh))==null||t.focus(),B(this,Fh,null)},0)}endDrawingSession(e=!1){return g(this,eu)?(g(this,_t).setCurrentDrawingSession(null),g(this,eu).abort(),B(this,eu,null),B(this,Fh,null),g(this,dr,Pu).endDrawing(e)):null}findNewParent(e,t,r){const i=g(this,_t).findParent(t,r);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return g(this,eu)?(this.endDrawingSession(),!0):!1}onScaleChanging(){g(this,eu)&&g(this,dr,Pu).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=g(this,_t).getActive())==null?void 0:e.parent)===this&&(g(this,_t).commitOrRemove(),g(this,_t).setActiveEditor(null)),g(this,Ph)&&(clearTimeout(g(this,Ph)),B(this,Ph,null));for(const r of g(this,$a).values())(t=g(this,av))==null||t.removePointerInTextLayer(r.contentDiv),r.setParent(null),r.isAttachedToDOM=!1,r.div.remove();this.div=null,g(this,$a).clear(),g(this,_t).removeLayer(this)}render({viewport:e}){this.viewport=e,Av(this.div,e);for(const t of g(this,_t).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){g(this,_t).commitOrRemove(),X(this,dr,tC).call(this);const t=this.viewport.rotation,r=e.rotation;if(this.viewport=e,Av(this.div,{rotation:r}),t!==r)for(const i of g(this,$a).values())i.rotate(r)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return g(this,_t).viewParameters.realScale}};av=new WeakMap,Yx=new WeakMap,qf=new WeakMap,Wf=new WeakMap,Ph=new WeakMap,$a=new WeakMap,Xf=new WeakMap,Qx=new WeakMap,Zx=new WeakMap,eu=new WeakMap,Fh=new WeakMap,es=new WeakMap,Lh=new WeakMap,Kf=new WeakMap,Jx=new WeakMap,_t=new WeakMap,Yf=new WeakMap,dr=new WeakSet,hL=function(){return g(this,$a).size!==0?g(this,$a).values():g(this,_t).getEditors(this.pageIndex)},LJ=function(e){g(this,_t).unselectAll();const{target:t}=e;if(t===g(this,es).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&g(this,es).div.contains(t)){const{isMac:r}=Ts.platform;if(e.button!==0||e.ctrlKey&&r)return;g(this,_t).showAllEditors("highlight",!0,!0),g(this,es).div.classList.add("free"),this.toggleDrawing(),pD.startHighlighting(this,g(this,_t).direction==="ltr",{target:g(this,es).div,x:e.x,y:e.y}),g(this,es).div.addEventListener("pointerup",()=>{g(this,es).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:g(this,_t)._signal}),e.preventDefault()}},Pu=function(){return g($l,Yf).get(g(this,_t).getMode())},dL=function(e){const t=g(this,dr,Pu);return t?new t.prototype.constructor(e):null},fL=function(){const{x:e,y:t,width:r,height:i}=this.boundingClientRect,s=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+r),l=Math.min(window.innerHeight,t+i),u=(s+o)/2-e,c=(a+l)/2-t,[h,d]=this.viewport.rotation%180===0?[u,c]:[c,u];return{offsetX:h,offsetY:d}},tC=function(){for(const e of g(this,$a).values())e.isEmpty()&&e.remove()},Qe($l,"_initialized",!1),G($l,Yf,new Map([jF,tL,lL,pD,oL].map(e=>[e._editorType,e])));let cL=$l;var tu,ma,ov,wS,_2,OJ,Nc,mL,kJ,gL;const Ai=class Ai{constructor({pageIndex:e}){G(this,Nc);G(this,tu,null);G(this,ma,new Map);G(this,ov,new Map);this.pageIndex=e}setParent(e){if(!g(this,tu)){B(this,tu,e);return}if(g(this,tu)!==e){if(g(this,ma).size>0)for(const t of g(this,ma).values())t.remove(),e.append(t);B(this,tu,e)}}static get _svgFactory(){return Kt(this,"_svgFactory",new dD)}draw(e,t=!1,r=!1){const i=Ei(Ai,wS)._++,s=X(this,Nc,mL).call(this),a=Ai._svgFactory.createElement("defs");s.append(a);const o=Ai._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&g(this,ov).set(i,o);const u=r?X(this,Nc,kJ).call(this,a,l):null,c=Ai._svgFactory.createElement("use");return s.append(c),c.setAttribute("href",`#${l}`),this.updateProperties(s,e),g(this,ma).set(i,s),{id:i,clipPathId:`url(#${u})`}}drawOutline(e,t){const r=Ei(Ai,wS)._++,i=X(this,Nc,mL).call(this),s=Ai._svgFactory.createElement("defs");i.append(s);const a=Ai._svgFactory.createElement("path");s.append(a);const o=`path_p${this.pageIndex}_${r}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const h=Ai._svgFactory.createElement("mask");s.append(h),l=`mask_p${this.pageIndex}_${r}`,h.setAttribute("id",l),h.setAttribute("maskUnits","objectBoundingBox");const d=Ai._svgFactory.createElement("rect");h.append(d),d.setAttribute("width","1"),d.setAttribute("height","1"),d.setAttribute("fill","white");const f=Ai._svgFactory.createElement("use");h.append(f),f.setAttribute("href",`#${o}`),f.setAttribute("stroke","none"),f.setAttribute("fill","black"),f.setAttribute("fill-rule","nonzero"),f.classList.add("mask")}const u=Ai._svgFactory.createElement("use");i.append(u),u.setAttribute("href",`#${o}`),l&&u.setAttribute("mask",`url(#${l})`);const c=u.cloneNode();return i.append(c),u.classList.add("mainOutline"),c.classList.add("secondaryOutline"),this.updateProperties(i,e),g(this,ma).set(r,i),r}finalizeDraw(e,t){g(this,ov).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:r,bbox:i,rootClass:s,path:a}=t,o=typeof e=="number"?g(this,ma).get(e):e;if(o){if(r&&X(this,Nc,gL).call(this,o,r),i&&X(l=Ai,_2,OJ).call(l,o,i),s){const{classList:u}=o;for(const[c,h]of Object.entries(s))u.toggle(c,h)}if(a){const c=o.firstElementChild.firstElementChild;X(this,Nc,gL).call(this,c,a)}}}updateParent(e,t){if(t===this)return;const r=g(this,ma).get(e);r&&(g(t,tu).append(r),g(this,ma).delete(e),g(t,ma).set(e,r))}remove(e){g(this,ov).delete(e),g(this,tu)!==null&&(g(this,ma).get(e).remove(),g(this,ma).delete(e))}destroy(){B(this,tu,null);for(const e of g(this,ma).values())e.remove();g(this,ma).clear(),g(this,ov).clear()}};tu=new WeakMap,ma=new WeakMap,ov=new WeakMap,wS=new WeakMap,_2=new WeakSet,OJ=function(e,[t,r,i,s]){const{style:a}=e;a.top=`${100*r}%`,a.left=`${100*t}%`,a.width=`${100*i}%`,a.height=`${100*s}%`},Nc=new WeakSet,mL=function(){const e=Ai._svgFactory.create(1,1,!0);return g(this,tu).append(e),e.setAttribute("aria-hidden",!0),e},kJ=function(e,t){const r=Ai._svgFactory.createElement("clipPath");e.append(r);const i=`clip_${t}`;r.setAttribute("id",i),r.setAttribute("clipPathUnits","objectBoundingBox");const s=Ai._svgFactory.createElement("use");return r.append(s),s.setAttribute("href",`#${t}`),s.classList.add("clip"),i},gL=function(e,t){for(const[r,i]of Object.entries(t))i===null?e.removeAttribute(r):e.setAttribute(r,i)},G(Ai,_2),G(Ai,wS,0);let pL=Ai;globalThis._pdfjsTestingUtils={HighlightOutliner:WF};globalThis.pdfjsLib={AbortException:Rp,AnnotationEditorLayer:cL,AnnotationEditorParamsType:En,AnnotationEditorType:Jt,AnnotationEditorUIManager:Tv,AnnotationLayer:HF,AnnotationMode:Jd,AnnotationType:fi,applyOpacity:Zve,build:sye,ColorPicker:cD,createValidAbsoluteUrl:MQ,CSSConstants:Qve,DOMSVGFactory:dD,DrawLayer:pL,FeatureTest:Ts,fetchData:HS,findContrastColor:Jve,getDocument:LZ,getFilenameFromUrl:jve,getPdfFilenameFromUrl:qve,getRGB:jS,getUuid:NQ,getXfaPageViewport:Xve,GlobalWorkerOptions:oc,ImageKind:wM,InvalidPDFException:j3,isDataScheme:vN,isPdfFile:h4,isValidExplicitDest:u0e,MathClamp:va,noContextMenu:Cl,normalizeUnicode:$ve,OPS:xw,OutputScale:Ac,PasswordResponses:Pve,PDFDataRangeTransport:OZ,PDFDateString:iD,PDFWorker:ww,PermissionFlag:Ive,PixelsPerInch:Ip,RenderingCancelledException:c4,renderRichText:PQ,ResponseException:rD,setLayerDimensions:Av,shadow:Kt,SignatureExtractor:Oh,stopEvent:Yr,SupportedImageMimeTypes:W3,TextLayer:_w,TouchManager:aD,updateUrlHash:CQ,Util:yt,VerbosityLevel:pN,version:iye,XfaLayer:IQ};oc.workerSrc="/1201-project/pdf.worker.min.js";const Dye="",Nye="https://api-inference.huggingface.co/models/facebook/bart-large-cnn";async function Rye(n){try{const e=await n.arrayBuffer(),t=await LZ({data:e}).promise;let r="";const i=Math.min(t.numPages,15);console.log(`PDF  : ${t.numPages},  : ${i}`);for(let s=1;s<=i;s++)try{const o=await(await t.getPage(s)).getTextContent();let l="";for(const u of o.items)u.str&&u.str.trim()&&(l+=u.str+" ");l.trim()&&(r+=l+`
`,console.log(` ${s}   (${l.length})`))}catch(a){console.warn(` ${s}  :`,a);continue}if(!r.trim())throw new Error("PDF    .   PDF  .");return console.log(`  : ${r.length}`),r}catch(e){throw console.error("PDF   :",e),new Error("PDF   : "+e.message)}}async function Iye(n){var e;try{const r=n.substring(0,1024),i=await fetch(Nye,{headers:{Authorization:`Bearer ${Dye}`},method:"POST",body:JSON.stringify({inputs:r})});if(!i.ok)throw new Error(`API : ${i.status}`);const s=await i.json();if(Array.isArray(s)&&((e=s[0])!=null&&e.summary_text))return s[0].summary_text;throw new Error("  ")}catch(t){throw console.error("AI  :",t),t}}function Pye(n){const e=n.match(/[^.!?]+[.!?]+/g)||[],t=["","","","","","",""];return e.map((s,a)=>{let o=t.reduce((l,u)=>l+(s.toLowerCase().includes(u)?1:0),0);return o+=1/(a+1),{sentence:s.trim(),score:o}}).sort((s,a)=>a.score-s.score).slice(0,3).map(s=>s.sentence).join(" ")||"  "}async function Fye(n){try{return{summary:await Iye(n),method:"AI"}}catch(e){return console.warn("AI  ,    :",e),{summary:Pye(n),method:"Rule-based"}}}var Lye="firebase",Oye="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mc(Lye,Oye,"app");function BJ(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const kye=BJ,UJ=new IS("auth","Firebase",BJ());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gD=new bB("@firebase/auth");function Bye(n,...e){gD.logLevel<=vn.WARN&&gD.warn(`Auth (${Ov}): ${n}`,...e)}function nC(n,...e){gD.logLevel<=vn.ERROR&&gD.error(`Auth (${Ov}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mu(n,...e){throw x4(n,...e)}function bc(n,...e){return x4(n,...e)}function VJ(n,e,t){const r={...kye(),[e]:t};return new IS("auth","Firebase",r).create(e,{appName:n.name})}function Xh(n){return VJ(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function x4(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return UJ.create(n,...e)}function Ft(n,e,...t){if(!n)throw x4(e,...t)}function Vh(n){const e="INTERNAL ASSERTION FAILED: "+n;throw nC(e),new Error(e)}function fd(n,e){n||Vh(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vL(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function Uye(){return E8()==="http:"||E8()==="https:"}function E8(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vye(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Uye()||efe()||"connection"in navigator)?navigator.onLine:!0}function zye(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e,t){this.shortDelay=e,this.longDelay=t,fd(t>e,"Short delay should be less than long delay!"),this.isMobile=Qde()||tfe()}get(){return Vye()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b4(n,e){fd(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zJ{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vh("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vh("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vh("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $ye={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hye=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Gye=new KS(3e4,6e4);function qp(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Wp(n,e,t,r,i={}){return $J(n,i,async()=>{let s={},a={};r&&(e==="GET"?a=r:s={body:JSON.stringify(r)});const o=PS({key:n.config.apiKey,...a}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const u={method:e,headers:l,...s};return Jde()||(u.referrerPolicy="no-referrer"),n.emulatorConfig&&Lv(n.emulatorConfig.host)&&(u.credentials="include"),zJ.fetch()(await HJ(n,n.config.apiHost,t,o),u)})}async function $J(n,e,t){n._canInitEmulator=!1;const r={...$ye,...e};try{const i=new qye(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw sT(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw sT(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw sT(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw sT(n,"user-disabled",a);const c=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw VJ(n,c,u);mu(n,c)}}catch(i){if(i instanceof Ic)throw i;mu(n,"network-request-failed",{message:String(i)})}}async function YS(n,e,t,r,i={}){const s=await Wp(n,e,t,r,i);return"mfaPendingCredential"in s&&mu(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function HJ(n,e,t,r){const i=`${e}${t}?${r}`,s=n,a=s.config.emulator?b4(n.config,i):`${n.config.apiScheme}://${i}`;return Hye.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}function jye(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class qye{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(bc(this.auth,"network-request-failed")),Gye.get())})}}function sT(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=bc(n,e,r);return i.customData._tokenResponse=t,i}function S8(n){return n!==void 0&&n.enterprise!==void 0}class Wye{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return jye(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Xye(n,e){return Wp(n,"GET","/v2/recaptchaConfig",qp(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kye(n,e){return Wp(n,"POST","/v1/accounts:delete",e)}async function vD(n,e){return Wp(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F1(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Yye(n,e=!1){const t=Li(n),r=await t.getIdToken(e),i=_4(r);Ft(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:F1(cI(i.auth_time)),issuedAtTime:F1(cI(i.iat)),expirationTime:F1(cI(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function cI(n){return Number(n)*1e3}function _4(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return nC("JWT malformed, contained fewer than 3 sections"),null;try{const i=LK(t);return i?JSON.parse(i):(nC("Failed to decode base64 JWT payload"),null)}catch(i){return nC("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function A8(n){const e=_4(n);return Ft(e,"internal-error"),Ft(typeof e.exp<"u","internal-error"),Ft(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ew(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Ic&&Qye(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function Qye({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zye{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=F1(this.lastLoginAt),this.creationTime=F1(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yD(n){var h;const e=n.auth,t=await n.getIdToken(),r=await Ew(n,vD(e,{idToken:t}));Ft(r==null?void 0:r.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=(h=i.providerUserInfo)!=null&&h.length?GJ(i.providerUserInfo):[],a=exe(n.providerData,s),o=n.isAnonymous,l=!(n.email&&i.passwordHash)&&!(a!=null&&a.length),u=o?l:!1,c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new yL(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(n,c)}async function Jye(n){const e=Li(n);await yD(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function exe(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function GJ(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function txe(n,e){const t=await $J(n,{},async()=>{const r=PS({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=await HJ(n,i,"/v1/token",`key=${s}`),o=await n._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:r};return n.emulatorConfig&&Lv(n.emulatorConfig.host)&&(l.credentials="include"),zJ.fetch()(a,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function nxe(n,e){return Wp(n,"POST","/v2/accounts:revokeToken",qp(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ft(e.idToken,"internal-error"),Ft(typeof e.idToken<"u","internal-error"),Ft(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):A8(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ft(e.length!==0,"internal-error");const t=A8(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ft(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await txe(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new _y;return r&&(Ft(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Ft(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Ft(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new _y,this.toJSON())}_performRefresh(){return Vh("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Od(n,e){Ft(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class au{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new Zye(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new yL(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Ew(this,this.stsTokenManager.getToken(this.auth,e));return Ft(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Yye(this,e)}reload(){return Jye(this)}_assign(e){this!==e&&(Ft(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new au({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ft(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await yD(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Fo(this.auth.app))return Promise.reject(Xh(this.auth));const e=await this.getIdToken();return await Ew(this,Kye(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,a=t.photoURL??void 0,o=t.tenantId??void 0,l=t._redirectEventId??void 0,u=t.createdAt??void 0,c=t.lastLoginAt??void 0,{uid:h,emailVerified:d,isAnonymous:f,providerData:p,stsTokenManager:m}=t;Ft(h&&m,e,"internal-error");const y=_y.fromJSON(this.name,m);Ft(typeof h=="string",e,"internal-error"),Od(r,e.name),Od(i,e.name),Ft(typeof d=="boolean",e,"internal-error"),Ft(typeof f=="boolean",e,"internal-error"),Od(s,e.name),Od(a,e.name),Od(o,e.name),Od(l,e.name),Od(u,e.name),Od(c,e.name);const v=new au({uid:h,auth:e,email:i,emailVerified:d,displayName:r,isAnonymous:f,photoURL:a,phoneNumber:s,tenantId:o,stsTokenManager:y,createdAt:u,lastLoginAt:c});return p&&Array.isArray(p)&&(v.providerData=p.map(b=>({...b}))),l&&(v._redirectEventId=l),v}static async _fromIdTokenResponse(e,t,r=!1){const i=new _y;i.updateFromServerResponse(t);const s=new au({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await yD(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Ft(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?GJ(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new _y;o.updateFromIdToken(r);const l=new au({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new yL(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T8=new Map;function zh(n){fd(n instanceof Function,"Expected a class definition");let e=T8.get(n);return e?(fd(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,T8.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jJ{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}jJ.type="NONE";const M8=jJ;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rC(n,e,t){return`firebase:${n}:${e}:${t}`}class wy{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=rC(this.userKey,i.apiKey,s),this.fullPersistenceKey=rC("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await vD(this.auth,{idToken:e}).catch(()=>{});return t?au._fromGetAccountInfoResponse(this.auth,t,e):null}return au._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new wy(zh(M8),e,r);const i=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||zh(M8);const a=rC(r,e.config.apiKey,e.name);let o=null;for(const u of t)try{const c=await u._get(a);if(c){let h;if(typeof c=="string"){const d=await vD(e,{idToken:c}).catch(()=>{});if(!d)break;h=await au._fromGetAccountInfoResponse(e,d,c)}else h=au._fromJSON(e,c);u!==s&&(o=h),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new wy(s,e,r):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(t.map(async u=>{if(u!==s)try{await u._remove(a)}catch{}})),new wy(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C8(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(KJ(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(qJ(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(QJ(e))return"Blackberry";if(ZJ(e))return"Webos";if(WJ(e))return"Safari";if((e.includes("chrome/")||XJ(e))&&!e.includes("edge/"))return"Chrome";if(YJ(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function qJ(n=ta()){return/firefox\//i.test(n)}function WJ(n=ta()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function XJ(n=ta()){return/crios\//i.test(n)}function KJ(n=ta()){return/iemobile/i.test(n)}function YJ(n=ta()){return/android/i.test(n)}function QJ(n=ta()){return/blackberry/i.test(n)}function ZJ(n=ta()){return/webos/i.test(n)}function w4(n=ta()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function rxe(n=ta()){var e;return w4(n)&&!!((e=window.navigator)!=null&&e.standalone)}function ixe(){return nfe()&&document.documentMode===10}function JJ(n=ta()){return w4(n)||YJ(n)||ZJ(n)||QJ(n)||/windows phone/i.test(n)||KJ(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eee(n,e=[]){let t;switch(n){case"Browser":t=C8(ta());break;case"Worker":t=`${C8(ta())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ov}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sxe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function axe(n,e={}){return Wp(n,"GET","/v2/passwordPolicy",qp(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oxe=6;class lxe{constructor(e){var r;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??oxe,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uxe{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new D8(this),this.idTokenSubscription=new D8(this),this.beforeStateQueue=new sxe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=UJ,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=zh(t)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await wy.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await vD(this,{idToken:e}),r=await au._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(Fo(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(s=this.redirectUser)==null?void 0:s._redirectEventId,o=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ft(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await yD(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zye()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Fo(this.app))return Promise.reject(Xh(this));const t=e?Li(e):null;return t&&Ft(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ft(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Fo(this.app)?Promise.reject(Xh(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Fo(this.app)?Promise.reject(Xh(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zh(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await axe(this),t=new lxe(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new IS("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await nxe(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&zh(e)||this._popupRedirectResolver;Ft(t,this,"argument-error"),this.redirectPersistenceManager=await wy.create(this,[zh(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ft(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ft(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=eee(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(Fo(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&Bye(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function zv(n){return Li(n)}class D8{constructor(e){this.auth=e,this.observer=null,this.addObserver=cfe(t=>this.observer=t)}get next(){return Ft(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bN={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function cxe(n){bN=n}function tee(n){return bN.loadJS(n)}function hxe(){return bN.recaptchaEnterpriseScript}function dxe(){return bN.gapiScript}function fxe(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class pxe{constructor(){this.enterprise=new mxe}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class mxe{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const gxe="recaptcha-enterprise",nee="NO_RECAPTCHA";class vxe{constructor(e){this.type=gxe,this.auth=zv(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,o)=>{Xye(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const u=new Wye(l);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,a(u.siteKey)}}).catch(l=>{o(l)})})}function i(s,a,o){const l=window.grecaptcha;S8(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(u=>{a(u)}).catch(()=>{a(nee)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new pxe().execute("siteKey",{action:"verify"}):new Promise((s,a)=>{r(this.auth).then(o=>{if(!t&&S8(window.grecaptcha))i(o,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=hxe();l.length!==0&&(l+=o),tee(l).then(()=>{i(o,s,a)}).catch(u=>{a(u)})}}).catch(o=>{a(o)})})}}async function N8(n,e,t,r=!1,i=!1){const s=new vxe(n);let a;if(i)a=nee;else try{a=await s.verify(t)}catch{a=await s.verify(t,!0)}const o={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const l=o.phoneEnrollmentInfo.phoneNumber,u=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:u,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const l=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return r?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function xL(n,e,t,r,i){var s;if((s=n._getRecaptchaConfig())!=null&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await N8(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await N8(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yxe(n,e){const t=G2(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(_v(s,e??{}))return i;mu(i,"already-initialized")}return t.initialize({options:e})}function xxe(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(zh);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function bxe(n,e,t){const r=zv(n);Ft(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=ree(e),{host:a,port:o}=_xe(e),l=o===null?"":`:${o}`,u={url:`${s}//${a}${l}/`},c=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Ft(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ft(_v(u,r.config.emulator)&&_v(c,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=c,r.settings.appVerificationDisabledForTesting=!0,Lv(a)?(yB(`${s}//${a}${l}`),xB("Auth",!0)):wxe()}function ree(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function _xe(n){const e=ree(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:R8(r.substr(s.length+1))}}else{const[s,a]=r.split(":");return{host:s,port:R8(a)}}}function R8(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function wxe(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E4{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Vh("not implemented")}_getIdTokenResponse(e){return Vh("not implemented")}_linkToIdToken(e,t){return Vh("not implemented")}_getReauthenticationResolver(e){return Vh("not implemented")}}async function Exe(n,e){return Wp(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sxe(n,e){return YS(n,"POST","/v1/accounts:signInWithPassword",qp(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Axe(n,e){return YS(n,"POST","/v1/accounts:signInWithEmailLink",qp(n,e))}async function Txe(n,e){return YS(n,"POST","/v1/accounts:signInWithEmailLink",qp(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sw extends E4{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Sw(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Sw(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return xL(e,t,"signInWithPassword",Sxe);case"emailLink":return Axe(e,{email:this._email,oobCode:this._password});default:mu(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return xL(e,r,"signUpPassword",Exe);case"emailLink":return Txe(e,{idToken:t,email:this._email,oobCode:this._password});default:mu(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ey(n,e){return YS(n,"POST","/v1/accounts:signInWithIdp",qp(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mxe="http://localhost";class Cv extends E4{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Cv(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):mu("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;const a=new Cv(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return Ey(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Ey(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ey(e,t)}buildRequest(){const e={requestUri:Mxe,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=PS(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cxe(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Dxe(n){const e=B_(U_(n)).link,t=e?B_(U_(e)).deep_link_id:null,r=B_(U_(n)).deep_link_id;return(r?B_(U_(r)).link:null)||r||t||e||n}class S4{constructor(e){const t=B_(U_(e)),r=t.apiKey??null,i=t.oobCode??null,s=Cxe(t.mode??null);Ft(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=Dxe(e);try{return new S4(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hb{constructor(){this.providerId=Hb.PROVIDER_ID}static credential(e,t){return Sw._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=S4.parseLink(t);return Ft(r,"argument-error"),Sw._fromEmailAndCode(e,r.code,r.tenantId)}}Hb.PROVIDER_ID="password";Hb.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Hb.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iee{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS extends iee{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef extends QS{constructor(){super("facebook.com")}static credential(e){return Cv._fromParams({providerId:ef.PROVIDER_ID,signInMethod:ef.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ef.credentialFromTaggedObject(e)}static credentialFromError(e){return ef.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ef.credential(e.oauthAccessToken)}catch{return null}}}ef.FACEBOOK_SIGN_IN_METHOD="facebook.com";ef.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf extends QS{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Cv._fromParams({providerId:tf.PROVIDER_ID,signInMethod:tf.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return tf.credentialFromTaggedObject(e)}static credentialFromError(e){return tf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return tf.credential(t,r)}catch{return null}}}tf.GOOGLE_SIGN_IN_METHOD="google.com";tf.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf extends QS{constructor(){super("github.com")}static credential(e){return Cv._fromParams({providerId:nf.PROVIDER_ID,signInMethod:nf.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return nf.credentialFromTaggedObject(e)}static credentialFromError(e){return nf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return nf.credential(e.oauthAccessToken)}catch{return null}}}nf.GITHUB_SIGN_IN_METHOD="github.com";nf.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf extends QS{constructor(){super("twitter.com")}static credential(e,t){return Cv._fromParams({providerId:rf.PROVIDER_ID,signInMethod:rf.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return rf.credentialFromTaggedObject(e)}static credentialFromError(e){return rf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return rf.credential(t,r)}catch{return null}}}rf.TWITTER_SIGN_IN_METHOD="twitter.com";rf.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nxe(n,e){return YS(n,"POST","/v1/accounts:signUp",qp(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await au._fromIdTokenResponse(e,r,i),a=I8(r);return new Dv({user:s,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=I8(r);return new Dv({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function I8(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD extends Ic{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,xD.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new xD(e,t,r,i)}}function see(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?xD._fromErrorAndOperation(n,s,e,r):s})}async function Rxe(n,e,t=!1){const r=await Ew(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Dv._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ixe(n,e,t=!1){const{auth:r}=n;if(Fo(r.app))return Promise.reject(Xh(r));const i="reauthenticate";try{const s=await Ew(n,see(r,i,e,n),t);Ft(s.idToken,r,"internal-error");const a=_4(s.idToken);Ft(a,r,"internal-error");const{sub:o}=a;return Ft(n.uid===o,r,"user-mismatch"),Dv._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&mu(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aee(n,e,t=!1){if(Fo(n.app))return Promise.reject(Xh(n));const r="signIn",i=await see(n,r,e),s=await Dv._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function Pxe(n,e){return aee(zv(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oee(n){const e=zv(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Fxe(n,e,t){if(Fo(n.app))return Promise.reject(Xh(n));const r=zv(n),a=await xL(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Nxe).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&oee(n),l}),o=await Dv._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(o.user),o}function Lxe(n,e,t){return Fo(n.app)?Promise.reject(Xh(n)):Pxe(Li(n),Hb.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&oee(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lee(n,e){return Li(n).setPersistence(e)}function Oxe(n,e,t,r){return Li(n).onIdTokenChanged(e,t,r)}function kxe(n,e,t){return Li(n).beforeAuthStateChanged(e,t)}const bD="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uee{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(bD,"1"),this.storage.removeItem(bD),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bxe=1e3,Uxe=10;class cee extends uee{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=JJ(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},s=this.storage.getItem(r);ixe()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Uxe):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},Bxe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}cee.type="LOCAL";const A4=cee;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hee extends uee{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}hee.type="SESSION";const dee=hee;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vxe(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _N{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new _N(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const o=Array.from(a).map(async u=>u(t.origin,s)),l=await Vxe(o);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}_N.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T4(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zxe{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const u=T4("",20);i.port1.start();const c=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(h){const d=h;if(d.data.eventId===u)switch(d.data.status){case"ack":clearTimeout(c),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(d.data.response);break;default:clearTimeout(c),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _c(){return window}function $xe(n){_c().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fee(){return typeof _c().WorkerGlobalScope<"u"&&typeof _c().importScripts=="function"}async function Hxe(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Gxe(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function jxe(){return fee()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pee="firebaseLocalStorageDb",qxe=1,_D="firebaseLocalStorage",mee="fbase_key";class ZS{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function wN(n,e){return n.transaction([_D],e?"readwrite":"readonly").objectStore(_D)}function Wxe(){const n=indexedDB.deleteDatabase(pee);return new ZS(n).toPromise()}function bL(){const n=indexedDB.open(pee,qxe);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(_D,{keyPath:mee})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(_D)?e(r):(r.close(),await Wxe(),e(await bL()))})})}async function P8(n,e,t){const r=wN(n,!0).put({[mee]:e,value:t});return new ZS(r).toPromise()}async function Xxe(n,e){const t=wN(n,!1).get(e),r=await new ZS(t).toPromise();return r===void 0?null:r.value}function F8(n,e){const t=wN(n,!0).delete(e);return new ZS(t).toPromise()}const Kxe=800,Yxe=3;class gee{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await bL(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>Yxe)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return fee()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=_N._getInstance(jxe()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await Hxe(),!this.activeServiceWorker)return;this.sender=new zxe(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Gxe()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await bL();return await P8(e,bD,"1"),await F8(e,bD),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>P8(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>Xxe(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>F8(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=wN(i,!1).getAll();return new ZS(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Kxe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}gee.type="LOCAL";const Qxe=gee;new KS(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zxe(n,e){return e?zh(e):(Ft(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4 extends E4{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ey(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ey(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ey(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Jxe(n){return aee(n.auth,new M4(n),n.bypassAuthState)}function ebe(n){const{auth:e,user:t}=n;return Ft(t,e,"internal-error"),Ixe(t,new M4(n),n.bypassAuthState)}async function tbe(n){const{auth:e,user:t}=n;return Ft(t,e,"internal-error"),Rxe(t,new M4(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vee{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Jxe;case"linkViaPopup":case"linkViaRedirect":return tbe;case"reauthViaPopup":case"reauthViaRedirect":return ebe;default:mu(this.auth,"internal-error")}}resolve(e){fd(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){fd(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nbe=new KS(2e3,1e4);class iy extends vee{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,iy.currentPopupAction&&iy.currentPopupAction.cancel(),iy.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ft(e,this.auth,"internal-error"),e}async onExecution(){fd(this.filter.length===1,"Popup operations only handle one event");const e=T4();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(bc(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(bc(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,iy.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if((r=(t=this.authWindow)==null?void 0:t.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(bc(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,nbe.get())};e()}}iy.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rbe="pendingRedirect",iC=new Map;class ibe extends vee{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=iC.get(this.auth._key());if(!e){try{const r=await sbe(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}iC.set(this.auth._key(),e)}return this.bypassAuthState||iC.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function sbe(n,e){const t=lbe(e),r=obe(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function abe(n,e){iC.set(n._key(),e)}function obe(n){return zh(n._redirectPersistence)}function lbe(n){return rC(rbe,n.config.apiKey,n.name)}async function ube(n,e,t=!1){if(Fo(n.app))return Promise.reject(Xh(n));const r=zv(n),i=Zxe(r,e),a=await new ibe(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cbe=10*60*1e3;class hbe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!dbe(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!yee(e)){const i=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";t.onError(bc(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=cbe&&this.cachedEventUids.clear(),this.cachedEventUids.has(L8(e))}saveEventToCache(e){this.cachedEventUids.add(L8(e)),this.lastProcessedEventTime=Date.now()}}function L8(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function yee({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function dbe(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return yee(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fbe(n,e={}){return Wp(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pbe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,mbe=/^https?/;async function gbe(n){if(n.config.emulator)return;const{authorizedDomains:e}=await fbe(n);for(const t of e)try{if(vbe(t))return}catch{}mu(n,"unauthorized-domain")}function vbe(n){const e=vL(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!mbe.test(t))return!1;if(pbe.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ybe=new KS(3e4,6e4);function O8(){const n=_c().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function xbe(n){return new Promise((e,t)=>{var i,s,a;function r(){O8(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{O8(),t(bc(n,"network-request-failed"))},timeout:ybe.get()})}if((s=(i=_c().gapi)==null?void 0:i.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((a=_c().gapi)!=null&&a.load)r();else{const o=fxe("iframefcb");return _c()[o]=()=>{gapi.load?r():t(bc(n,"network-request-failed"))},tee(`${dxe()}?onload=${o}`).catch(l=>t(l))}}).catch(e=>{throw sC=null,e})}let sC=null;function bbe(n){return sC=sC||xbe(n),sC}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _be=new KS(5e3,15e3),wbe="__/auth/iframe",Ebe="emulator/auth/iframe",Sbe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Abe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Tbe(n){const e=n.config;Ft(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?b4(e,Ebe):`https://${n.config.authDomain}/${wbe}`,r={apiKey:e.apiKey,appName:n.name,v:Ov},i=Abe.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${PS(r).slice(1)}`}async function Mbe(n){const e=await bbe(n),t=_c().gapi;return Ft(t,n,"internal-error"),e.open({where:document.body,url:Tbe(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Sbe,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const a=bc(n,"network-request-failed"),o=_c().setTimeout(()=>{s(a)},_be.get());function l(){_c().clearTimeout(o),i(r)}r.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cbe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Dbe=500,Nbe=600,Rbe="_blank",Ibe="http://localhost";class k8{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Pbe(n,e,t,r=Dbe,i=Nbe){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l={...Cbe,width:r.toString(),height:i.toString(),top:s,left:a},u=ta().toLowerCase();t&&(o=XJ(u)?Rbe:t),qJ(u)&&(e=e||Ibe,l.scrollbars="yes");const c=Object.entries(l).reduce((d,[f,p])=>`${d}${f}=${p},`,"");if(rxe(u)&&o!=="_self")return Fbe(e||"",o),new k8(null);const h=window.open(e||"",o,c);Ft(h,n,"popup-blocked");try{h.focus()}catch{}return new k8(h)}function Fbe(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lbe="__/auth/handler",Obe="emulator/auth/handler",kbe=encodeURIComponent("fac");async function B8(n,e,t,r,i,s){Ft(n.config.authDomain,n,"auth-domain-config-required"),Ft(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Ov,eventId:i};if(e instanceof iee){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",ufe(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,h]of Object.entries({}))a[c]=h}if(e instanceof QS){const c=e.getScopes().filter(h=>h!=="");c.length>0&&(a.scopes=c.join(","))}n.tenantId&&(a.tid=n.tenantId);const o=a;for(const c of Object.keys(o))o[c]===void 0&&delete o[c];const l=await n._getAppCheckToken(),u=l?`#${kbe}=${encodeURIComponent(l)}`:"";return`${Bbe(n)}?${PS(o).slice(1)}${u}`}function Bbe({config:n}){return n.emulator?b4(n,Obe):`https://${n.authDomain}/${Lbe}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hI="webStorageSupport";class Ube{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=dee,this._completeRedirectFn=ube,this._overrideRedirectResult=abe}async _openPopup(e,t,r,i){var a;fd((a=this.eventManagers[e._key()])==null?void 0:a.manager,"_initialize() not called before _openPopup()");const s=await B8(e,t,r,vL(),i);return Pbe(e,s,T4())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await B8(e,t,r,vL(),i);return $xe(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(fd(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await Mbe(e),r=new hbe(e);return t.register("authEvent",i=>(Ft(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(hI,{type:hI},i=>{var a;const s=(a=i==null?void 0:i[0])==null?void 0:a[hI];s!==void 0&&t(!!s),mu(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=gbe(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return JJ()||WJ()||w4()}}const Vbe=Ube;var U8="@firebase/auth",V8="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zbe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ft(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $be(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Hbe(n){wv(new Ep("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;Ft(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:eee(n)},u=new uxe(r,i,s,l);return xxe(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),wv(new Ep("auth-internal",e=>{const t=zv(e.getProvider("auth").getImmediate());return(r=>new zbe(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),mc(U8,V8,$be(n)),mc(U8,V8,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gbe=5*60,jbe=UK("authIdTokenMaxAge")||Gbe;let z8=null;const qbe=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>jbe)return;const i=t==null?void 0:t.token;z8!==i&&(z8=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Wbe(n=wB()){const e=G2(n,"auth");if(e.isInitialized())return e.getImmediate();const t=yxe(n,{popupRedirectResolver:Vbe,persistence:[Qxe,A4,dee]}),r=UK("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const a=qbe(s.toString());kxe(t,a,()=>a(t.currentUser)),Oxe(t,o=>a(o))}}const i=OK("auth");return i&&bxe(t,`http://${i}`),t}function Xbe(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}cxe({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=bc("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",Xbe().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Hbe("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xee="firebasestorage.googleapis.com",Kbe="storageBucket",Ybe=2*60*1e3,Qbe=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc extends Ic{constructor(e,t,r=0){super(dI(e),`Firebase Storage: ${t} (${dI(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Pc.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return dI(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Tc;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Tc||(Tc={}));function dI(n){return"storage/"+n}function Zbe(){const n="An unknown error occurred, please check the error payload for server response.";return new Pc(Tc.UNKNOWN,n)}function Jbe(){return new Pc(Tc.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function e_e(){return new Pc(Tc.CANCELED,"User canceled the upload/download.")}function t_e(n){return new Pc(Tc.INVALID_URL,"Invalid URL '"+n+"'.")}function n_e(n){return new Pc(Tc.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function $8(n){return new Pc(Tc.INVALID_ARGUMENT,n)}function bee(){return new Pc(Tc.APP_DELETED,"The Firebase app was deleted.")}function r_e(n){return new Pc(Tc.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=ou.makeFromUrl(e,t)}catch{return new ou(e,"")}if(r.path==="")return r;throw n_e(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(w){w.path.charAt(w.path.length-1)==="/"&&(w.path_=w.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function u(w){w.path_=decodeURIComponent(w.path)}const c="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",f=new RegExp(`^https?://${h}/${c}/b/${i}/o${d}`,"i"),p={bucket:1,path:3},m=t===xee?"(?:storage.googleapis.com|storage.cloud.google.com)":t,y="([^?#]*)",v=new RegExp(`^https?://${m}/${i}/${y}`,"i"),x=[{regex:o,indices:l,postModify:s},{regex:f,indices:p,postModify:u},{regex:v,indices:{bucket:1,path:2},postModify:u}];for(let w=0;w<x.length;w++){const _=x[w],E=_.regex.exec(e);if(E){const A=E[_.indices.bucket];let T=E[_.indices.path];T||(T=""),r=new ou(A,T),_.postModify(r);break}}if(r==null)throw t_e(e);return r}}class i_e{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s_e(n,e,t){let r=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let u=!1;function c(...y){u||(u=!0,e.apply(null,y))}function h(y){i=setTimeout(()=>{i=null,n(f,l())},y)}function d(){s&&clearTimeout(s)}function f(y,...v){if(u){d();return}if(y){d(),c.call(null,y,...v);return}if(l()||a){d(),c.call(null,y,...v);return}r<64&&(r*=2);let x;o===1?(o=2,x=0):x=(r+Math.random())*1e3,h(x)}let p=!1;function m(y){p||(p=!0,d(),!u&&(i!==null?(y||(o=2),clearTimeout(i),h(0)):y||(o=1)))}return h(0),s=setTimeout(()=>{a=!0,m(!0)},t),m}function a_e(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o_e(n){return n!==void 0}function H8(n,e,t,r){if(r<e)throw $8(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw $8(`Invalid value for '${n}'. Expected ${t} or less.`)}function l_e(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var wD;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(wD||(wD={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u_e(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_e{constructor(e,t,r,i,s,a,o,l,u,c,h,d=!0,f=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=c,this.connectionFactory_=h,this.retry=d,this.isUsingEmulator=f,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,m)=>{this.resolve_=p,this.reject_=m,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new aT(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,u=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===wD.NO_ERROR,l=s.getStatus();if(!o||u_e(l,this.additionalRetryCodes_)&&this.retry){const c=s.getErrorCode()===wD.ABORT;r(!1,new aT(!1,null,c));return}const u=this.successCodes_.indexOf(l)!==-1;r(!0,new aT(u,s))})},t=(r,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());o_e(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=Zbe();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?bee():e_e();a(l)}else{const l=Jbe();a(l)}};this.canceled_?t(!1,new aT(!1,null,!0)):this.backoffId_=s_e(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&a_e(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class aT{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function h_e(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function d_e(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function f_e(n,e){e&&(n["X-Firebase-GMPID"]=e)}function p_e(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function m_e(n,e,t,r,i,s,a=!0,o=!1){const l=l_e(n.urlParams),u=n.url+l,c=Object.assign({},n.headers);return f_e(c,e),h_e(c,t),d_e(c,s),p_e(c,r),new c_e(u,n.method,c,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,a,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g_e(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function v_e(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ED{constructor(e,t){this._service=e,t instanceof ou?this._location=t:this._location=ou.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new ED(e,t)}get root(){const e=new ou(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return v_e(this._location.path)}get storage(){return this._service}get parent(){const e=g_e(this._location.path);if(e===null)return null;const t=new ou(this._location.bucket,e);return new ED(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw r_e(e)}}function G8(n,e){const t=e==null?void 0:e[Kbe];return t==null?null:ou.makeFromBucketSpec(t,n)}function y_e(n,e,t,r={}){n.host=`${e}:${t}`;const i=Lv(e);i&&(yB(`https://${n.host}/b`),xB("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:VK(s,n.app.options.projectId))}class x_e{constructor(e,t,r,i,s,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=a,this._bucket=null,this._host=xee,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Ybe,this._maxUploadRetryTime=Qbe,this._requests=new Set,i!=null?this._bucket=ou.makeFromBucketSpec(i,this._host):this._bucket=G8(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ou.makeFromBucketSpec(this._url,e):this._bucket=G8(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){H8("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){H8("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Fo(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ED(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new i_e(bee());{const a=m_e(e,this._appId,r,i,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const j8="@firebase/storage",q8="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _ee="storage";function b_e(n=wB(),e){n=Li(n);const r=G2(n,_ee).getImmediate({identifier:e}),i=kK("storage");return i&&__e(r,...i),r}function __e(n,e,t,r={}){y_e(n,e,t,r)}function w_e(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new x_e(t,r,i,e,Ov)}function E_e(){wv(new Ep(_ee,w_e,"PUBLIC").setMultipleInstances(!0)),mc(j8,q8,""),mc(j8,q8,"esm2020")}E_e();const S_e={apiKey:"AIzaSyCuCYH38ZqKbtPYPR2ED1nMdD6yBuo1ReA",authDomain:"shop-d542c.firebaseapp.com",projectId:"shop-d542c",storageBucket:"shop-d542c.firebasestorage.app",messagingSenderId:"592347281413",appId:"1:592347281413:web:ed7c8752b195dcbb02846c",measurementId:"G-DFV2PBV8X2"},C4=HK(S_e),SD=Wbe(C4),Ys=gve(C4);b_e(C4);const A_e={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},T_e=15;function M_e(){const[n,e]=xe.useState(null),[t,r]=xe.useState(!1),[i,s]=xe.useState(null),[a,o]=xe.useState(null),[l,u]=xe.useState(""),[c,h]=xe.useState(""),[d,f]=xe.useState("idle"),[p,m]=xe.useState([]),[y,v]=xe.useState(!0),b=bp();xe.useEffect(()=>{const A=hd(Ys,"paperSummaries"),T=zS(A,o4("createdAt","desc"),Tve(15)),S=Nve(T,M=>{const D=M.docs.map(N=>({id:N.id,...N.data()}));m(D),v(!1)},M=>{console.error("   :",M),v(!1)});return()=>S()},[]);const x=A=>A?A.toDate?A.toDate().toLocaleString("ko-KR",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):new Date(A).toLocaleString("ko-KR",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):" ",w=A=>{var S;const T=(S=A.target.files)==null?void 0:S[0];T&&(T.type==="application/pdf"?(e(T),u(T.name.replace(".pdf","")),o(null)):(o("PDF   ."),e(null)))},_=async()=>{if(!n){o("PDF  .");return}r(!0),o(null),s(null);try{const A=await Rye(n);if(!A||A.trim().length<100)throw new Error("   .  PDF .");const T=await Fye(A);s(T.summary),h(T.method)}catch(A){o(A.message||"    ."),console.error(" :",A)}finally{r(!1)}},E=async()=>{if(!i){o("  .");return}if(!(b!=null&&b.email)){o("  .");return}try{f("loading"),await dN(hd(Ys,"paperSummaries"),{title:l||"  ",summary:i,method:c,authorEmail:b.email,authorName:b.username||b.email.split("@")[0],createdAt:Wh(),publishedAt:new Date().toISOString()}),f("success"),setTimeout(()=>f("idle"),2500)}catch(A){console.error("  :",A),o("    ."),f("error"),setTimeout(()=>f("idle"),3e3)}};return k.jsx("div",{className:"min-h-screen bg-white dark:bg-dark-50 pt-24 pb-12",children:k.jsxs(ct.div,{className:"max-w-4xl mx-auto px-4",variants:A_e,initial:"hidden",animate:"visible",children:[k.jsx("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-2",children:"   AI"}),k.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:"PDF   AI   ."}),k.jsxs(ct.div,{className:"bg-gray-50 dark:bg-dark-100 rounded-lg p-8 mb-8 border-2 border-dashed border-blue-400",whileHover:{scale:1.02},children:[k.jsxs("div",{className:"text-center",children:[k.jsx("input",{type:"file",accept:".pdf",onChange:w,className:"hidden",id:"pdf-upload"}),k.jsxs("label",{htmlFor:"pdf-upload",className:"cursor-pointer block",children:[k.jsx("div",{className:"text-6xl mb-4",children:""}),k.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"PDF    "}),k.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["( ",T_e," )"]})]})]}),n&&k.jsx("div",{className:"mt-6 p-4 bg-blue-100 dark:bg-blue-900/30 rounded-lg border border-blue-400",children:k.jsxs("p",{className:"text-blue-900 dark:text-blue-100",children:[" : ",k.jsx("strong",{children:n.name})]})})]}),k.jsxs("div",{className:"flex gap-4 mb-8",children:[k.jsx(ct.button,{onClick:_,disabled:!n||t,whileHover:{scale:1.05},whileTap:{scale:.95},className:"flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-bold py-3 px-6 rounded-lg transition",children:t?"   ...":" AI "}),k.jsx(ct.button,{onClick:()=>{e(null),u(""),s(null),o(null)},whileHover:{scale:1.05},className:"bg-gray-400 hover:bg-gray-500 text-white font-bold py-3 px-6 rounded-lg transition",children:" "})]}),a&&k.jsxs(ct.div,{className:"bg-red-100 dark:bg-red-900/30 border border-red-400 text-red-700 dark:text-red-200 px-6 py-4 rounded-lg mb-8",initial:{opacity:0},animate:{opacity:1},children:[k.jsx("strong",{children:":"})," ",a]}),i&&k.jsxs(ct.div,{className:"bg-green-50 dark:bg-green-900/20 border-l-4 border-green-500 p-6 rounded-lg",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[k.jsxs("div",{className:"flex items-center mb-4",children:[k.jsx("span",{className:"text-2xl mr-3",children:""}),k.jsxs("div",{children:[k.jsx("h3",{className:"font-bold text-gray-900 dark:text-white",children:l}),k.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[": ",c==="AI"?" AI  (Hugging Face)":"   "]})]})]}),k.jsx("div",{className:"bg-white dark:bg-dark-100 p-4 rounded-lg",children:k.jsx("p",{className:"text-gray-800 dark:text-gray-200 leading-relaxed",children:i})}),k.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[k.jsx(ct.button,{onClick:()=>{const A=document.createElement("a");A.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(i)),A.setAttribute("download",`${l}_summary.txt`),A.style.display="none",document.body.appendChild(A),A.click(),document.body.removeChild(A)},whileHover:{scale:1.05},className:"bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded transition text-sm",children:"  "}),k.jsx(ct.button,{onClick:()=>{navigator.clipboard.writeText(i),alert(" !")},whileHover:{scale:1.05},className:"bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded transition text-sm",children:" "}),k.jsx(ct.button,{onClick:E,disabled:d==="loading"||!i,whileHover:{scale:i?1.05:1},className:`py-2 px-4 rounded transition text-sm font-semibold ${d==="success"?"bg-emerald-600 text-white":d==="loading"?"bg-gray-400 text-gray-100":"bg-purple-600 hover:bg-purple-700 text-white"}`,children:d==="success"?"  ":d==="loading"?" ...":"  "})]}),!b&&k.jsx("p",{className:"text-xs text-yellow-600 mt-2",children:"     ."})]}),k.jsxs(ct.div,{className:"mt-12 bg-gray-50 dark:bg-dark-100 rounded-lg p-6 border border-gray-200 dark:border-gray-800",initial:{opacity:0},animate:{opacity:1},children:[k.jsxs("div",{className:"flex items-center justify-between mb-4",children:[k.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"   "}),k.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:" 15 "})]}),y?k.jsx("p",{className:"text-sm text-gray-500",children:"  ..."}):p.length===0?k.jsx("p",{className:"text-sm text-gray-500",children:"   .   !"}):k.jsx("div",{className:"space-y-4",children:p.map(A=>k.jsxs("div",{className:"p-4 rounded-2xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-dark-200",children:[k.jsxs("div",{className:"flex items-start justify-between gap-4",children:[k.jsxs("div",{children:[k.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:A.title}),k.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[A.authorName||" ","  ",x(A.createdAt||A.publishedAt)]})]}),k.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-200",children:A.method==="AI"?"AI ":"Rule "})]}),k.jsx("p",{className:"mt-3 text-sm text-gray-700 dark:text-gray-200 leading-relaxed whitespace-pre-wrap",children:A.summary})]},A.id))})]}),k.jsxs(ct.div,{className:"mt-12 bg-blue-50 dark:bg-blue-900/20 p-6 rounded-lg border border-blue-200 dark:border-blue-800",initial:{opacity:0},whileInView:{opacity:1},children:[k.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"  "}),k.jsxs("ol",{className:"space-y-2 text-gray-700 dark:text-gray-300",children:[k.jsxs("li",{children:[k.jsx("strong",{children:"1."}),"   PDF  "]}),k.jsxs("li",{children:[k.jsx("strong",{children:"2."}),' "AI "  ']}),k.jsxs("li",{children:[k.jsx("strong",{children:"3."})," AI    "]}),k.jsxs("li",{children:[k.jsx("strong",{children:"4."}),"      "]})]}),k.jsx("div",{className:"mt-4 p-4 bg-yellow-50 dark:bg-yellow-900/30 rounded border border-yellow-200 dark:border-yellow-800",children:k.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:[" ",k.jsx("strong",{children:":"})," PDF   5 .       ."]})})]})]})})}function C_e(){var x;const[n,e]=xe.useState([]),[t,r]=xe.useState(!0),[i,s]=xe.useState(""),[a,o]=xe.useState(null),[l,u]=xe.useState({title:"",category:((x=T0[0])==null?void 0:x.id)??1,content:""}),[c,h]=xe.useState(!1),[d,f]=xe.useState(!1),p=bp(),m=w=>w?typeof w=="string"?w:w.toDate?w.toDate().toLocaleDateString("ko-KR"):w instanceof Date?w.toLocaleDateString("ko-KR"):new Date(w).toLocaleDateString("ko-KR"):"",y=xe.useCallback(async()=>{r(!0),s("");try{const w=zS(hd(Ys,"forumPosts"),o4("createdAt","desc")),E=(await hN(w)).docs.map(A=>{var S;const T=A.data();return{id:A.id,...T,createdAt:(S=T.createdAt)!=null&&S.toDate?T.createdAt.toDate():T.createdAt||new Date,replies:T.replies??0}});e(E)}catch(w){console.error("  :",w),s("  .    .")}finally{r(!1)}},[]);xe.useEffect(()=>{y()},[y]);const v=async w=>{var _;if(w.preventDefault(),!l.title.trim()||!l.content.trim()){alert("  .");return}f(!0);try{const E=(p==null?void 0:p.username)||(p==null?void 0:p.email)||" ",A={title:l.title.trim(),content:l.content.trim(),category:Number(l.category),author:E,authorEmail:(p==null?void 0:p.email)||null,replies:0,createdAt:Wh(),updatedAt:Wh()},T=await dN(hd(Ys,"forumPosts"),A);console.log("   :",T.id);const S={id:T.id,...A,createdAt:new Date};e(M=>[S,...M]),u({title:"",category:((_=T0[0])==null?void 0:_.id)??1,content:""}),h(!1),alert(" .")}catch(E){console.error("   :",E),console.error(" :",E.code),console.error(" :",E.message),alert("  : "+E.message)}finally{f(!1)}},b=a?n.filter(w=>w.category===a):n;return k.jsxs("div",{className:"space-y-8 sm:space-y-12",children:[k.jsxs("div",{children:[k.jsx("h1",{className:"text-3xl sm:text-4xl font-bold mb-4 text-gray-900 dark:text-white",children:" "}),k.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm sm:text-base",children:" ,  ,  ,        ."})]}),k.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[k.jsx("button",{onClick:()=>h(!c),className:"w-full sm:w-auto px-6 py-3 bg-blue-600 dark:bg-blue-600 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-700 transition font-medium text-sm sm:text-base",children:c?"":"  "}),k.jsx("button",{onClick:y,className:"w-full sm:w-auto px-6 py-3 border border-gray-300 dark:border-gray-600 rounded-lg text-sm sm:text-base font-medium hover:bg-gray-100 dark:hover:bg-gray-800",children:""})]}),c&&k.jsxs("form",{onSubmit:v,className:"bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 sm:p-6 rounded-lg space-y-4",children:[k.jsxs("div",{children:[k.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium",children:""}),k.jsx("input",{type:"text",value:l.title,onChange:w=>u({...l,title:w.target.value}),className:"w-full bg-gray-50 dark:bg-dark-200 border border-gray-300 dark:border-dark-300 px-4 py-2 rounded text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400",placeholder:" "})]}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium",children:""}),k.jsx("select",{value:l.category,onChange:w=>u({...l,category:parseInt(w.target.value)}),className:"w-full bg-gray-50 dark:bg-dark-200 border border-gray-300 dark:border-dark-300 px-4 py-2 rounded text-gray-900 dark:text-white",children:T0.map(w=>k.jsx("option",{value:w.id,children:w.name},w.id))})]}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-2 text-sm font-medium",children:""}),k.jsx("textarea",{rows:"6",value:l.content,onChange:w=>u({...l,content:w.target.value}),className:"w-full bg-gray-50 dark:bg-dark-200 border border-gray-300 dark:border-dark-300 px-4 py-2 rounded text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 resize-none",placeholder:" "})]}),k.jsx("button",{type:"submit",disabled:d,className:"w-full bg-green-600 dark:bg-green-600 hover:bg-green-700 dark:hover:bg-green-700 disabled:bg-gray-500 text-white px-6 py-2 rounded font-bold transition text-sm sm:text-base",children:d?" ...":""})]}),k.jsxs("div",{className:"flex flex-wrap gap-2",children:[k.jsx("button",{onClick:()=>o(null),className:`px-3 sm:px-4 py-2 rounded transition text-sm sm:text-base ${a===null?"bg-blue-600 text-white":"bg-gray-200 dark:bg-dark-300 text-gray-900 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-dark-200"}`,children:""}),T0.map(w=>k.jsx("button",{onClick:()=>o(w.id),className:`px-3 sm:px-4 py-2 rounded transition text-sm sm:text-base ${a===w.id?"bg-blue-600 text-white":"bg-gray-200 dark:bg-dark-300 text-gray-900 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-dark-200"}`,children:w.name},w.id))]}),k.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[t&&k.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"  ..."}),!t&&b.length===0&&k.jsx("div",{className:"text-center py-10 text-gray-500 dark:text-gray-400 border border-dashed rounded-lg",children:"   ."}),!t&&b.map(w=>{var _;return k.jsx(hr,{to:`/forum/${w.id}`,state:{post:w},children:k.jsx("div",{className:"bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 sm:p-6 rounded-lg hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-md transition cursor-pointer",children:k.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-2",children:[k.jsxs("div",{className:"flex-1 min-w-0",children:[k.jsx("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:k.jsx("span",{className:"text-xs bg-gray-200 dark:bg-dark-300 text-gray-700 dark:text-gray-300 px-2 py-1 rounded",children:((_=T0.find(E=>E.id===w.category))==null?void 0:_.name)||""})}),k.jsx("h3",{className:"text-base sm:text-lg font-bold text-blue-600 dark:text-blue-400 break-words",children:w.title}),k.jsx("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400 mt-2 line-clamp-2",children:w.content}),k.jsxs("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 mt-2",children:[w.author,"  ",m(w.createdAt)]})]}),k.jsxs("span",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 whitespace-nowrap",children:[" ",w.replies??0]})]})})},w.id)})]}),i&&k.jsx("p",{className:"text-sm text-red-500",children:i})]})}function D_e(){var x,w,_;const{postId:n}=XW();Fb();const e=Pb(),{isDark:t}=Nl(),r=bp(),[i,s]=xe.useState(((x=e.state)==null?void 0:x.post)||null),[a,o]=xe.useState(!((w=e.state)!=null&&w.post)),[l,u]=xe.useState([]),[c,h]=xe.useState(""),[d,f]=xe.useState(""),p=E=>E?typeof E=="string"?E:E.toDate?E.toDate().toLocaleDateString("ko-KR"):E instanceof Date?E.toLocaleDateString("ko-KR"):new Date(E).toLocaleDateString("ko-KR"):"",m=xe.useCallback(async()=>{var E;o(!0);try{const A=Np(Ys,"forumPosts",n),T=await EQ(A);if(T.exists()){const S=T.data();s({id:T.id,...S,createdAt:(E=S.createdAt)!=null&&E.toDate?S.createdAt.toDate():S.createdAt||new Date})}else s(null)}catch(A){console.error("  :",A),s(null)}finally{o(!1)}},[n]),y=xe.useCallback(async()=>{try{const E=hd(Ys,"forumPosts",n,"replies"),A=zS(E,o4("createdAt","asc")),S=(await hN(A)).docs.map(M=>{var N;const D=M.data();return{id:M.id,...D,createdAt:(N=D.createdAt)!=null&&N.toDate?D.createdAt.toDate():D.createdAt||new Date}});u(S)}catch(E){console.error("  :",E)}},[n]);xe.useEffect(()=>{var E;(E=e.state)!=null&&E.post||m()},[m,(_=e.state)==null?void 0:_.post]),xe.useEffect(()=>{y()},[y]);const v=async E=>{if(E.preventDefault(),f(""),!c.trim()){f(" .");return}try{const A=hd(Ys,"forumPosts",n,"replies"),S={author:(r==null?void 0:r.username)||(r==null?void 0:r.email)||" ",authorEmail:(r==null?void 0:r.email)||null,content:c.trim(),likes:0,createdAt:Wh()},D={id:(await dN(A,S)).id,...S,createdAt:new Date};u(R=>[...R,D]),h("");const N=Np(Ys,"forumPosts",n);await SQ(N,{replies:Rve(1),updatedAt:Wh()}),s(R=>R&&{...R,replies:(R.replies||0)+1})}catch(A){console.error("  :",A),f("  .    .")}};if(a)return k.jsx("div",{className:`text-center py-12 ${t?"text-gray-300":"text-gray-700"}`,children:"  ..."});if(!i)return k.jsxs("div",{className:"text-center py-12",children:[k.jsx("h1",{className:`text-2xl font-bold mb-4 ${t?"text-white":"text-gray-900"}`,children:"   ."}),k.jsx(hr,{to:"/forum",className:"text-blue-600 hover:text-blue-700 font-medium",children:" "})]});const b=T0.find(E=>E.id===(i==null?void 0:i.category));return k.jsxs("div",{className:"space-y-8",children:[k.jsxs(ct.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[k.jsx(hr,{to:"/forum",className:`inline-flex items-center gap-2 mb-4 transition ${t?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-700"}`,children:"  "}),k.jsxs("div",{className:`p-6 rounded-lg border ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[k.jsx("div",{className:"mb-3",children:k.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-medium ${t?"bg-blue-900 text-blue-300":"bg-blue-100 text-blue-700"}`,children:b==null?void 0:b.name})}),k.jsx("h1",{className:`text-3xl sm:text-4xl font-bold mb-4 ${t?"text-white":"text-gray-900"}`,children:i.title}),k.jsxs("div",{className:`flex flex-wrap gap-4 mb-6 pb-6 border-b ${t?"border-gray-700 text-gray-300":"border-gray-200 text-gray-600"} text-sm`,children:[k.jsxs("div",{children:[k.jsx("span",{className:"font-medium",children:":"})," ",i.author]}),k.jsxs("div",{children:[k.jsx("span",{className:"font-medium",children:":"})," ",p(i.createdAt)]}),k.jsxs("div",{children:[k.jsx("span",{className:"font-medium",children:":"})," ",i.replies||l.length,""]}),k.jsxs("div",{children:[k.jsx("span",{className:"font-medium",children:":"})," ",i.views||0,""]})]}),k.jsx("div",{className:`prose prose-sm ${t?"prose-invert":""} max-w-none mb-8`,children:k.jsx("div",{className:`${t?"text-gray-200":"text-gray-700"} leading-7 whitespace-pre-wrap`,children:i.content})})]})]}),k.jsxs(ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:`p-6 rounded-lg border ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[k.jsx("h2",{className:`text-xl font-bold mb-4 ${t?"text-white":"text-gray-900"}`,children:" "}),k.jsxs("form",{onSubmit:v,className:"space-y-4",children:[k.jsx("textarea",{value:c,onChange:E=>h(E.target.value),placeholder:" ...",rows:"4",className:`w-full px-4 py-3 rounded-lg border focus:outline-none focus:ring-2 focus:ring-blue-500 ${t?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`}),d&&k.jsx("p",{className:"text-sm text-red-400",children:d}),k.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium",children:" "})]})]}),k.jsxs(ct.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},className:"space-y-4",children:[k.jsxs("h2",{className:`text-2xl font-bold ${t?"text-white":"text-gray-900"}`,children:[" ",l.length,""]}),l.map(E=>k.jsxs(ct.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:`p-4 rounded-lg border ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[k.jsxs("div",{className:`flex justify-between items-start mb-2 ${t?"text-gray-300":"text-gray-600"} text-sm`,children:[k.jsxs("div",{children:[k.jsx("span",{className:"font-medium",children:E.author}),k.jsx("span",{className:"ml-4",children:p(E.createdAt)})]}),k.jsxs("button",{className:`transition ${t?"text-gray-400 hover:text-gray-200":"text-gray-400 hover:text-gray-600"}`,children:[" ",E.likes]})]}),k.jsx("p",{className:`${t?"text-gray-200":"text-gray-700"} leading-6`,children:E.content})]},E.id))]})]})}function N_e(){const[n,e]=xe.useState(""),t=U6.filter(r=>r.term.toLowerCase().includes(n.toLowerCase())||r.definition.toLowerCase().includes(n.toLowerCase()));return k.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[k.jsxs("div",{children:[k.jsx("h1",{className:"text-3xl sm:text-4xl font-bold mb-4 text-gray-900 dark:text-white",children:" "}),k.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm sm:text-base mb-6",children:"      ."}),k.jsx("input",{type:"search",placeholder:"   ...",value:n,onChange:r=>e(r.target.value),className:"w-full max-w-md bg-gray-50 dark:bg-dark-200 border border-gray-300 dark:border-dark-300 px-4 py-2 rounded text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 text-sm sm:text-base"})]}),k.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[t.map((r,i)=>k.jsxs("div",{className:"bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 sm:p-6 rounded-lg hover:shadow-md transition",children:[k.jsx("h3",{className:"text-base sm:text-lg font-bold text-blue-600 dark:text-blue-400 mb-2",children:r.term}),k.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm sm:text-base",children:r.definition})]},i)),t.length===0&&k.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400 py-8 text-sm sm:text-base",children:"  ."})]}),k.jsxs("div",{className:"bg-gray-100 dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 rounded-lg text-center text-gray-600 dark:text-gray-400 text-sm sm:text-base",children:[" ",U6.length,"   ",t.length,"  "]})]})}function R_e(){return k.jsxs("div",{className:"space-y-8 sm:space-y-12",children:[k.jsxs("div",{children:[k.jsx("h1",{className:"text-3xl sm:text-4xl font-bold mb-4 text-gray-900 dark:text-white",children:" "}),k.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm sm:text-base",children:"    , ,  ."})]}),k.jsxs("section",{children:[k.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-6 text-gray-900 dark:text-white",children:" "}),k.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:GR.textbooks.map((n,e)=>k.jsxs("div",{className:"bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 sm:p-6 rounded-lg hover:shadow-md transition",children:[k.jsx("h3",{className:"text-base sm:text-lg font-bold text-blue-600 dark:text-blue-400 mb-1",children:n.title}),k.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400",children:[n.authors," (",n.year,")"]})]},e))})]}),k.jsxs("section",{children:[k.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-6 text-gray-900 dark:text-white",children:"  "}),k.jsx("div",{className:"space-y-3 sm:space-y-4",children:GR.databases.map((n,e)=>k.jsxs("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",className:"block bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 sm:p-6 rounded-lg hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-md transition",children:[k.jsx("h3",{className:"text-base sm:text-lg font-bold text-blue-600 dark:text-blue-400",children:n.name}),k.jsx("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400",children:n.desc}),k.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-2 break-all",children:n.url})]},e))})]}),k.jsxs("section",{children:[k.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-6 text-gray-900 dark:text-white",children:"   "}),k.jsx("div",{className:"space-y-3 sm:space-y-4",children:GR.tools.map((n,e)=>k.jsxs("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",className:"block bg-white dark:bg-dark-100 border border-gray-200 dark:border-dark-300 p-4 sm:p-6 rounded-lg hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-md transition",children:[k.jsx("h3",{className:"text-base sm:text-lg font-bold text-blue-600 dark:text-blue-400",children:n.name}),k.jsx("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400",children:n.desc}),k.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-2 break-all",children:n.url})]},e))})]})]})}function I_e(){const{isDark:n}=Nl(),e=bp(),[t,r]=xe.useState({username:"",email:"",affiliation:"",bio:""}),[i,s]=xe.useState(!1),[a,o]=xe.useState(!0),[l,u]=xe.useState(!1),[c,h]=xe.useState("");xe.useEffect(()=>{if(!(e!=null&&e.email)){o(!1);return}(async()=>{try{const m=Np(Ys,"profiles",e.email),y=await EQ(m),v={username:e.username||"",email:e.email,affiliation:"",bio:""};y.exists()?(r({...v,...y.data()}),console.log(" Firestore  :",e.email)):(r(v),console.log("   (Firestore )"))}catch(m){console.error(" Firestore  :",m),r({username:e.username,email:e.email||"",affiliation:"",bio:""})}finally{o(!1)}})()},[e==null?void 0:e.email,e==null?void 0:e.username]);const d=p=>{const{name:m,value:y}=p.target;r(v=>({...v,[m]:y}))},f=async p=>{p.preventDefault(),u(!0);try{await Dve(Np(Ys,"profiles",e.email),{username:t.username,email:t.email,affiliation:t.affiliation,bio:t.bio,updatedAt:Wh()}),console.log(" Firestore :",e.email),h("  ."),s(!1),setTimeout(()=>h(""),3e3)}catch(m){console.error("  :",m.code,m.message),h("  : "+m.message)}finally{u(!1)}};return e?a?k.jsx("div",{className:`text-center py-12 ${n?"text-gray-400":"text-gray-600"}`,children:"   ..."}):k.jsxs("div",{className:"max-w-2xl mx-auto",children:[k.jsx("h1",{className:`text-3xl font-bold mb-8 ${n?"text-white":"text-gray-900"}`,children:""}),c&&k.jsx("div",{className:`mb-4 p-4 rounded-lg ${c.includes("")?"bg-red-50 text-red-700 dark:bg-red-900 dark:text-red-200":"bg-green-50 text-green-700 dark:bg-green-900 dark:text-green-200"}`,children:c}),k.jsxs("div",{className:`rounded-lg p-8 ${n?"bg-gray-800":"bg-white"} border ${n?"border-gray-700":"border-gray-200"}`,children:[k.jsxs("div",{className:"flex justify-between items-center mb-6",children:[k.jsx("h2",{className:`text-xl font-bold ${n?"text-white":"text-gray-900"}`,children:" "}),k.jsx("button",{onClick:()=>s(!i),className:`px-4 py-2 rounded-lg transition ${n?"bg-blue-600 hover:bg-blue-700":"bg-blue-500 hover:bg-blue-600"} text-white`,children:i?"":""})]}),i?k.jsxs("form",{onSubmit:f,className:"space-y-4",children:[k.jsxs("div",{children:[k.jsx("label",{className:`block text-sm font-medium mb-2 ${n?"text-gray-300":"text-gray-700"}`,children:""}),k.jsx("input",{type:"text",name:"username",value:t.username,onChange:d,className:`w-full px-4 py-2 border rounded-lg ${n?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),k.jsxs("div",{children:[k.jsx("label",{className:`block text-sm font-medium mb-2 ${n?"text-gray-300":"text-gray-700"}`,children:""}),k.jsx("input",{type:"email",name:"email",value:t.email,onChange:d,disabled:!0,className:`w-full px-4 py-2 border rounded-lg opacity-50 cursor-not-allowed ${n?"bg-gray-700 border-gray-600 text-gray-400":"bg-gray-100 border-gray-300 text-gray-600"}`})]}),k.jsxs("div",{children:[k.jsx("label",{className:`block text-sm font-medium mb-2 ${n?"text-gray-300":"text-gray-700"}`,children:" "}),k.jsx("input",{type:"text",name:"affiliation",value:t.affiliation,onChange:d,placeholder:",  ",className:`w-full px-4 py-2 border rounded-lg ${n?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),k.jsxs("div",{children:[k.jsx("label",{className:`block text-sm font-medium mb-2 ${n?"text-gray-300":"text-gray-700"}`,children:""}),k.jsx("textarea",{name:"bio",value:t.bio,onChange:d,placeholder:" ...",rows:"4",className:`w-full px-4 py-2 border rounded-lg ${n?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),k.jsx("button",{type:"submit",disabled:l,className:`w-full py-2 px-4 rounded-lg font-medium text-white transition ${l?"bg-blue-400 cursor-not-allowed opacity-50":"bg-blue-600 hover:bg-blue-700"}`,children:l?" ...":""})]}):k.jsxs("div",{className:"space-y-4",children:[k.jsxs("div",{children:[k.jsx("p",{className:`text-sm ${n?"text-gray-400":"text-gray-500"}`,children:""}),k.jsx("p",{className:`text-lg font-medium ${n?"text-white":"text-gray-900"}`,children:t.username})]}),k.jsxs("div",{children:[k.jsx("p",{className:`text-sm ${n?"text-gray-400":"text-gray-500"}`,children:""}),k.jsx("p",{className:`text-lg font-medium ${n?"text-white":"text-gray-900"}`,children:t.email})]}),k.jsxs("div",{children:[k.jsx("p",{className:`text-sm ${n?"text-gray-400":"text-gray-500"}`,children:" "}),k.jsx("p",{className:`text-lg font-medium ${n?"text-white":"text-gray-900"}`,children:t.affiliation||""})]}),k.jsxs("div",{children:[k.jsx("p",{className:`text-sm ${n?"text-gray-400":"text-gray-500"}`,children:""}),k.jsx("p",{className:`text-lg font-medium ${n?"text-white":"text-gray-900"}`,children:t.bio||""})]}),k.jsx("hr",{className:n?"border-gray-700":"border-gray-200"}),k.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4",children:[k.jsxs(hr,{to:"/bookmarks",className:`p-4 rounded-lg border text-center transition hover:shadow-md ${n?"bg-gray-700 border-gray-600 text-gray-200 hover:bg-gray-600":"bg-gray-50 border-gray-200 text-gray-700 hover:bg-gray-100"}`,children:[k.jsx("p",{className:"text-2xl mb-1",children:""}),k.jsx("p",{className:"font-semibold",children:""})]}),k.jsxs(hr,{to:"/notes",className:`p-4 rounded-lg border text-center transition hover:shadow-md ${n?"bg-gray-700 border-gray-600 text-gray-200 hover:bg-gray-600":"bg-gray-50 border-gray-200 text-gray-700 hover:bg-gray-100"}`,children:[k.jsx("p",{className:"text-2xl mb-1",children:""}),k.jsx("p",{className:"font-semibold",children:""})]})]})]})]})]}):k.jsx("div",{className:`text-center py-12 ${n?"text-gray-400":"text-gray-600"}`,children:"   ."})}function P_e(){const{isDark:n}=Nl(),e=bp(),[t,r]=xe.useState([]),[i,s]=xe.useState(!0),[a,o]=xe.useState("");xe.useEffect(()=>{if(!(e!=null&&e.email)){s(!1);return}l()},[e==null?void 0:e.email]);const l=async()=>{try{const c=zS(hd(Ys,"bookmarks"),bQ("userEmail","==",e.email)),d=(await hN(c)).docs.map(f=>({id:f.id,...f.data()}));r(d),console.log("  :",e.email,":",d.length)}catch(c){console.error("   :",c),o("   .")}finally{s(!1)}},u=async c=>{try{const h=Np(Ys,"bookmarks",c);await AQ(h),r(d=>d.filter(f=>f.id!==c)),console.log("  :",c)}catch(h){o(h.message)}};return k.jsxs("div",{className:"max-w-4xl mx-auto",children:[k.jsx("h1",{className:`text-3xl font-bold mb-8 ${n?"text-white":"text-gray-900"}`,children:""}),a&&k.jsx("div",{className:`mb-4 p-4 rounded-lg ${n?"bg-red-900 text-red-200 border border-red-700":"bg-red-50 text-red-700 border border-red-200"}`,children:a}),i?k.jsx("div",{className:`text-center py-12 ${n?"text-gray-400":"text-gray-600"}`,children:" ..."}):t.length===0?k.jsxs("div",{className:`text-center py-12 ${n?"text-gray-400":"text-gray-600"}`,children:[k.jsx("p",{className:"mb-4",children:"  ."}),k.jsx(hr,{to:"/concepts",className:`px-4 py-2 rounded-lg inline-block transition ${n?"bg-blue-600 hover:bg-blue-700":"bg-blue-500 hover:bg-blue-600"} text-white`,children:" "})]}):k.jsx("div",{className:"space-y-4",children:t.map(c=>k.jsxs("div",{className:`p-6 rounded-lg border transition ${n?"bg-gray-800 border-gray-700 hover:border-gray-600":"bg-white border-gray-200 hover:border-gray-300"}`,children:[k.jsxs("div",{className:"flex justify-between items-start gap-4",children:[k.jsxs("div",{className:"flex-1 min-w-0",children:[k.jsx("h2",{className:`text-xl font-bold mb-2 ${n?"text-white":"text-gray-900"}`,children:c.title}),k.jsxs("p",{className:`text-sm mb-3 ${n?"text-gray-400":"text-gray-600"}`,children:[": ",k.jsx("span",{className:"font-medium",children:c.type==="paper"?"":""})]}),k.jsx("p",{className:`line-clamp-2 ${n?"text-gray-300":"text-gray-700"}`,children:c.description})]}),k.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[k.jsx(hr,{to:c.type==="paper"?`/papers/${c.slug}`:`/concepts/${c.slug}`,className:`px-4 py-2 rounded-lg transition ${n?"bg-blue-600 hover:bg-blue-700":"bg-blue-500 hover:bg-blue-600"} text-white text-sm`,children:""}),k.jsx("button",{onClick:()=>u(c.id),className:`px-4 py-2 rounded-lg transition ${n?"bg-red-600 hover:bg-red-700":"bg-red-500 hover:bg-red-600"} text-white text-sm`,children:""})]})]}),k.jsxs("p",{className:`text-xs mt-4 ${n?"text-gray-500":"text-gray-400"}`,children:[" : ",new Date(c.created_at).toLocaleDateString("ko-KR")]})]},c.id))})]})}function F_e(){const{isDark:n}=Nl(),e=bp(),[t,r]=xe.useState([]),[i,s]=xe.useState(null),[a,o]=xe.useState(!1),[l,u]=xe.useState(""),[c,h]=xe.useState(""),[d,f]=xe.useState(""),[p,m]=xe.useState(!0),[y,v]=xe.useState("");xe.useEffect(()=>{if(!(e!=null&&e.email)){m(!1);return}(async()=>{try{const D=zS(hd(Ys,"notes"),bQ("userEmail","==",e.email)),R=(await hN(D)).docs.map(z=>({id:z.id,...z.data()}));r(R),console.log("   :",e.email,":",R.length)}catch(D){console.log(" Firestore  :",D)}finally{m(!1)}})()},[e==null?void 0:e.email]);const b=()=>{o(!0),s(null),u(""),h(""),f("")},x=M=>{s(M.id),o(!1),u(M.title),h(M.content),f(M.tags.join(", "))},w=async()=>{if(!l.trim()){alert(" .");return}try{if(a){const D={id:(await dN(hd(Ys,"notes"),{title:l,content:c,tags:d.split(",").map(R=>R.trim()).filter(R=>R),userEmail:e.email,createdAt:Wh(),updatedAt:Wh()})).id,title:l,content:c,tags:d.split(",").map(R=>R.trim()).filter(R=>R),userEmail:e.email,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},N=[D,...t];r(N),o(!1),s(D.id),v("  !"),setTimeout(()=>v(""),2e3),console.log("  :",e.email,l)}else if(i){const M=Np(Ys,"notes",i);await SQ(M,{title:l,content:c,tags:d.split(",").map(N=>N.trim()).filter(N=>N),userEmail:e.email,updatedAt:Wh()});const D=t.map(N=>N.id===i?{...N,title:l,content:c,tags:d.split(",").map(R=>R.trim()).filter(R=>R),updatedAt:new Date().toISOString()}:N);r(D),v("  !"),setTimeout(()=>v(""),2e3)}}catch(M){console.error("  :",M),v("  ."),setTimeout(()=>v(""),2e3)}},_=async M=>{if(confirm("  ?"))try{await AQ(Np(Ys,"notes",M));const D=t.filter(N=>N.id!==M);r(D),i===M&&(s(null),o(!1))}catch(D){console.error("  :",D),alert("  .")}},E=M=>new Date(M).toLocaleDateString("ko-KR",{year:"numeric",month:"short",day:"numeric"}),A=n?"bg-gray-800 border-gray-700":"bg-white border-gray-200",T=n?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300",S=n?"text-gray-300":"text-gray-700";return k.jsxs("div",{className:"min-h-screen space-y-8",children:[y&&k.jsx(ct.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`fixed top-20 right-4 px-6 py-3 rounded-lg shadow-lg font-semibold text-white z-50 ${y.includes("")?"bg-red-600":"bg-green-600"}`,children:y}),k.jsxs(ct.div,{initial:{opacity:0,y:-30},animate:{opacity:1,y:0},transition:{duration:.6},children:[k.jsx("h1",{className:"text-4xl sm:text-5xl font-bold mb-4 bg-gradient-to-r from-indigo-600 to-blue-600 dark:from-indigo-400 dark:to-blue-400 bg-clip-text text-transparent",children:" "}),k.jsx("p",{className:`text-sm sm:text-base ${n?"text-gray-300":"text-gray-600"}`,children:", ,    "})]}),k.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[k.jsxs(ct.div,{initial:{opacity:0,x:-30},animate:{opacity:1,x:0},transition:{duration:.6},className:`p-6 rounded-lg border ${A}`,children:[k.jsxs("div",{className:"flex justify-between items-center mb-4",children:[k.jsx("h2",{className:"text-xl font-bold",children:" "}),k.jsx("button",{onClick:b,className:"px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium",children:"+  "})]}),k.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:t.length===0?k.jsx("p",{className:`text-sm ${n?"text-gray-400":"text-gray-500"}`,children:" ."}):t.map(M=>k.jsxs("div",{onClick:()=>x(M),className:`p-3 rounded-lg cursor-pointer transition-all ${i===M.id?n?"bg-blue-900 border-blue-500":"bg-blue-100 border-blue-400":n?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} border`,children:[k.jsx("p",{className:"font-semibold text-sm truncate",children:M.title}),k.jsx("p",{className:`text-xs ${n?"text-gray-400":"text-gray-500"}`,children:E(M.updatedAt)})]},M.id))})]}),k.jsx(ct.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:`p-6 rounded-lg border lg:col-span-2 ${A}`,children:a||i?k.jsxs("div",{className:"space-y-4",children:[k.jsxs("div",{children:[k.jsx("label",{className:`block text-sm font-semibold mb-2 ${S}`,children:""}),k.jsx("input",{type:"text",value:l,onChange:M=>u(M.target.value),placeholder:"  ",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${T}`})]}),k.jsxs("div",{children:[k.jsx("label",{className:`block text-sm font-semibold mb-2 ${S}`,children:" ( )"}),k.jsx("input",{type:"text",value:d,onChange:M=>f(M.target.value),placeholder:": , Kerr metric, ",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${T}`})]}),k.jsxs("div",{children:[k.jsx("label",{className:`block text-sm font-semibold mb-2 ${S}`,children:""}),k.jsx("textarea",{value:c,onChange:M=>h(M.target.value),placeholder:"  ",rows:"12",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none ${T}`})]}),k.jsxs("div",{className:"flex gap-2 justify-end",children:[k.jsx("button",{onClick:()=>{o(!1),s(null)},className:`px-4 py-2 rounded-lg font-medium ${n?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-900"}`,children:""}),i&&k.jsx("button",{onClick:()=>_(i),className:"px-4 py-2 rounded-lg font-medium bg-red-600 hover:bg-red-700 text-white",children:""}),k.jsx("button",{onClick:w,className:"px-4 py-2 rounded-lg font-medium bg-blue-600 hover:bg-blue-700 text-white",children:""})]})]}):k.jsxs("div",{className:`text-center py-12 ${n?"text-gray-400":"text-gray-500"}`,children:[k.jsx("p",{className:"text-lg",children:"     "}),k.jsx("p",{className:"text-sm mt-2",children:" : ,  ,      !"})]})})]}),t.length>0&&k.jsxs(ct.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.2},className:`p-6 rounded-lg border ${A}`,children:[k.jsx("h3",{className:"text-lg font-bold mb-3",children:""}),k.jsx("div",{className:"flex flex-wrap gap-2",children:[...new Set(t.flatMap(M=>M.tags).sort())].map(M=>k.jsxs("button",{onClick:()=>{const D=t.filter(N=>N.tags.includes(M));D.length>0&&x(D[0])},className:`px-3 py-1 rounded-full text-sm font-medium transition-all ${n?"bg-gray-700 text-gray-200 hover:bg-blue-600":"bg-gray-200 text-gray-800 hover:bg-blue-500 hover:text-white"}`,children:["#",M]},M))})]})]})}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const D4="182",L_e=0,W8=1,O_e=2,aC=1,k_e=2,h1=3,Pp=0,to=1,kh=2,Kh=0,Sy=1,X8=2,K8=3,Y8=4,B_e=5,Rm=100,U_e=101,V_e=102,z_e=103,$_e=104,H_e=200,G_e=201,j_e=202,q_e=203,_L=204,wL=205,W_e=206,X_e=207,K_e=208,Y_e=209,Q_e=210,Z_e=211,J_e=212,e1e=213,t1e=214,EL=0,SL=1,AL=2,mb=3,TL=4,ML=5,CL=6,DL=7,N4=0,n1e=1,r1e=2,wc=0,wee=1,Eee=2,See=3,Aee=4,Tee=5,Mee=6,Cee=7,Dee=300,Nv=301,gb=302,NL=303,RL=304,EN=306,IL=1e3,$h=1001,PL=1002,ws=1003,i1e=1004,oT=1005,Qs=1006,fI=1007,Hm=1008,Lo=1009,Nee=1010,Ree=1011,Aw=1012,R4=1013,Mc=1014,lc=1015,pd=1016,I4=1017,P4=1018,Tw=1020,Iee=35902,Pee=35899,Fee=1021,Lee=1022,lu=1023,md=1026,Gm=1027,Oee=1028,F4=1029,vb=1030,L4=1031,O4=1033,oC=33776,lC=33777,uC=33778,cC=33779,FL=35840,LL=35841,OL=35842,kL=35843,BL=36196,UL=37492,VL=37496,zL=37488,$L=37489,HL=37490,GL=37491,jL=37808,qL=37809,WL=37810,XL=37811,KL=37812,YL=37813,QL=37814,ZL=37815,JL=37816,eO=37817,tO=37818,nO=37819,rO=37820,iO=37821,sO=36492,aO=36494,oO=36495,lO=36283,uO=36284,cO=36285,hO=36286,s1e=3200,k4=0,a1e=1,sf="",dl="srgb",yb="srgb-linear",AD="linear",qn="srgb",a0=7680,Q8=519,o1e=512,l1e=513,u1e=514,B4=515,c1e=516,h1e=517,U4=518,d1e=519,Z8=35044,J8="300 es",uc=2e3,TD=2001;function kee(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function MD(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function f1e(){const n=MD("canvas");return n.style.display="block",n}const e9={};function t9(...n){const e="THREE."+n.shift();console.log(e,...n)}function Ht(...n){const e="THREE."+n.shift();console.warn(e,...n)}function Bn(...n){const e="THREE."+n.shift();console.error(e,...n)}function Mw(...n){const e=n.join(" ");e in e9||(e9[e]=!0,Ht(...n))}function p1e(n,e,t){return new Promise(function(r,i){function s(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:i();break;case n.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:r()}}setTimeout(s,t)})}class Gb{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){const r=this._listeners;return r===void 0?!1:r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){const r=this._listeners;if(r===void 0)return;const i=r[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const r=t[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,a=i.length;s<a;s++)i[s].call(this,e);e.target=null}}}const Os=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],pI=Math.PI/180,dO=180/Math.PI;function JS(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Os[n&255]+Os[n>>8&255]+Os[n>>16&255]+Os[n>>24&255]+"-"+Os[e&255]+Os[e>>8&255]+"-"+Os[e>>16&15|64]+Os[e>>24&255]+"-"+Os[t&63|128]+Os[t>>8&255]+"-"+Os[t>>16&255]+Os[t>>24&255]+Os[r&255]+Os[r>>8&255]+Os[r>>16&255]+Os[r>>24&255]).toLowerCase()}function An(n,e,t){return Math.max(e,Math.min(t,n))}function m1e(n,e){return(n%e+e)%e}function mI(n,e,t){return(1-t)*n+t*e}function w_(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Pa(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}class Ln{constructor(e=0,t=0){Ln.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=An(this.x,e.x,t.x),this.y=An(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=An(this.x,e,t),this.y=An(this.y,e,t),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(An(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(An(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*r-a*i+e.x,this.y=s*i+a*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class eA{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,s,a,o){let l=r[i+0],u=r[i+1],c=r[i+2],h=r[i+3],d=s[a+0],f=s[a+1],p=s[a+2],m=s[a+3];if(o<=0){e[t+0]=l,e[t+1]=u,e[t+2]=c,e[t+3]=h;return}if(o>=1){e[t+0]=d,e[t+1]=f,e[t+2]=p,e[t+3]=m;return}if(h!==m||l!==d||u!==f||c!==p){let y=l*d+u*f+c*p+h*m;y<0&&(d=-d,f=-f,p=-p,m=-m,y=-y);let v=1-o;if(y<.9995){const b=Math.acos(y),x=Math.sin(b);v=Math.sin(v*b)/x,o=Math.sin(o*b)/x,l=l*v+d*o,u=u*v+f*o,c=c*v+p*o,h=h*v+m*o}else{l=l*v+d*o,u=u*v+f*o,c=c*v+p*o,h=h*v+m*o;const b=1/Math.sqrt(l*l+u*u+c*c+h*h);l*=b,u*=b,c*=b,h*=b}}e[t]=l,e[t+1]=u,e[t+2]=c,e[t+3]=h}static multiplyQuaternionsFlat(e,t,r,i,s,a){const o=r[i],l=r[i+1],u=r[i+2],c=r[i+3],h=s[a],d=s[a+1],f=s[a+2],p=s[a+3];return e[t]=o*p+c*h+l*f-u*d,e[t+1]=l*p+c*d+u*h-o*f,e[t+2]=u*p+c*f+o*d-l*h,e[t+3]=c*p-o*h-l*d-u*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,i=e._y,s=e._z,a=e._order,o=Math.cos,l=Math.sin,u=o(r/2),c=o(i/2),h=o(s/2),d=l(r/2),f=l(i/2),p=l(s/2);switch(a){case"XYZ":this._x=d*c*h+u*f*p,this._y=u*f*h-d*c*p,this._z=u*c*p+d*f*h,this._w=u*c*h-d*f*p;break;case"YXZ":this._x=d*c*h+u*f*p,this._y=u*f*h-d*c*p,this._z=u*c*p-d*f*h,this._w=u*c*h+d*f*p;break;case"ZXY":this._x=d*c*h-u*f*p,this._y=u*f*h+d*c*p,this._z=u*c*p+d*f*h,this._w=u*c*h-d*f*p;break;case"ZYX":this._x=d*c*h-u*f*p,this._y=u*f*h+d*c*p,this._z=u*c*p-d*f*h,this._w=u*c*h+d*f*p;break;case"YZX":this._x=d*c*h+u*f*p,this._y=u*f*h+d*c*p,this._z=u*c*p-d*f*h,this._w=u*c*h-d*f*p;break;case"XZY":this._x=d*c*h-u*f*p,this._y=u*f*h-d*c*p,this._z=u*c*p+d*f*h,this._w=u*c*h+d*f*p;break;default:Ht("Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],s=t[8],a=t[1],o=t[5],l=t[9],u=t[2],c=t[6],h=t[10],d=r+o+h;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(c-l)*f,this._y=(s-u)*f,this._z=(a-i)*f}else if(r>o&&r>h){const f=2*Math.sqrt(1+r-o-h);this._w=(c-l)/f,this._x=.25*f,this._y=(i+a)/f,this._z=(s+u)/f}else if(o>h){const f=2*Math.sqrt(1+o-r-h);this._w=(s-u)/f,this._x=(i+a)/f,this._y=.25*f,this._z=(l+c)/f}else{const f=2*Math.sqrt(1+h-r-o);this._w=(a-i)/f,this._x=(s+u)/f,this._y=(l+c)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<1e-8?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(An(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,s=e._z,a=e._w,o=t._x,l=t._y,u=t._z,c=t._w;return this._x=r*c+a*o+i*u-s*l,this._y=i*c+a*l+s*o-r*u,this._z=s*c+a*u+r*l-i*o,this._w=a*c-r*o-i*l-s*u,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let r=e._x,i=e._y,s=e._z,a=e._w,o=this.dot(e);o<0&&(r=-r,i=-i,s=-s,a=-a,o=-o);let l=1-t;if(o<.9995){const u=Math.acos(o),c=Math.sin(u);l=Math.sin(l*u)/c,t=Math.sin(t*u)/c,this._x=this._x*l+r*t,this._y=this._y*l+i*t,this._z=this._z*l+s*t,this._w=this._w*l+a*t,this._onChangeCallback()}else this._x=this._x*l+r*t,this._y=this._y*l+i*t,this._z=this._z*l+s*t,this._w=this._w*l+a*t,this.normalize();return this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),i=Math.sqrt(1-r),s=Math.sqrt(r);return this.set(i*Math.sin(e),i*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class De{constructor(e=0,t=0,r=0){De.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(n9.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(n9.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*i,this.y=s[1]*t+s[4]*r+s[7]*i,this.z=s[2]*t+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=e.elements,a=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*i+s[12])*a,this.y=(s[1]*t+s[5]*r+s[9]*i+s[13])*a,this.z=(s[2]*t+s[6]*r+s[10]*i+s[14])*a,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,s=e.x,a=e.y,o=e.z,l=e.w,u=2*(a*i-o*r),c=2*(o*t-s*i),h=2*(s*r-a*t);return this.x=t+l*u+a*h-o*c,this.y=r+l*c+o*u-s*h,this.z=i+l*h+s*c-a*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i,this.y=s[1]*t+s[5]*r+s[9]*i,this.z=s[2]*t+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=An(this.x,e.x,t.x),this.y=An(this.y,e.y,t.y),this.z=An(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=An(this.x,e,t),this.y=An(this.y,e,t),this.z=An(this.z,e,t),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(An(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,s=e.z,a=t.x,o=t.y,l=t.z;return this.x=i*l-s*o,this.y=s*a-r*l,this.z=r*o-i*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return gI.copy(this).projectOnVector(e),this.sub(gI)}reflect(e){return this.sub(gI.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(An(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const gI=new De,n9=new eA;class sn{constructor(e,t,r,i,s,a,o,l,u){sn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,a,o,l,u)}set(e,t,r,i,s,a,o,l,u){const c=this.elements;return c[0]=e,c[1]=i,c[2]=o,c[3]=t,c[4]=s,c[5]=l,c[6]=r,c[7]=a,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,a=r[0],o=r[3],l=r[6],u=r[1],c=r[4],h=r[7],d=r[2],f=r[5],p=r[8],m=i[0],y=i[3],v=i[6],b=i[1],x=i[4],w=i[7],_=i[2],E=i[5],A=i[8];return s[0]=a*m+o*b+l*_,s[3]=a*y+o*x+l*E,s[6]=a*v+o*w+l*A,s[1]=u*m+c*b+h*_,s[4]=u*y+c*x+h*E,s[7]=u*v+c*w+h*A,s[2]=d*m+f*b+p*_,s[5]=d*y+f*x+p*E,s[8]=d*v+f*w+p*A,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7],c=e[8];return t*a*c-t*o*u-r*s*c+r*o*l+i*s*u-i*a*l}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7],c=e[8],h=c*a-o*u,d=o*l-c*s,f=u*s-a*l,p=t*h+r*d+i*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=h*m,e[1]=(i*u-c*r)*m,e[2]=(o*r-i*a)*m,e[3]=d*m,e[4]=(c*t-i*l)*m,e[5]=(i*s-o*t)*m,e[6]=f*m,e[7]=(r*l-u*t)*m,e[8]=(a*t-r*s)*m,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,a,o){const l=Math.cos(s),u=Math.sin(s);return this.set(r*l,r*u,-r*(l*a+u*o)+a+e,-i*u,i*l,-i*(-u*a+l*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(vI.makeScale(e,t)),this}rotate(e){return this.premultiply(vI.makeRotation(-e)),this}translate(e,t){return this.premultiply(vI.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const vI=new sn,r9=new sn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),i9=new sn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function g1e(){const n={enabled:!0,workingColorSpace:yb,spaces:{},convert:function(i,s,a){return this.enabled===!1||s===a||!s||!a||(this.spaces[s].transfer===qn&&(i.r=Yh(i.r),i.g=Yh(i.g),i.b=Yh(i.b)),this.spaces[s].primaries!==this.spaces[a].primaries&&(i.applyMatrix3(this.spaces[s].toXYZ),i.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===qn&&(i.r=Ay(i.r),i.g=Ay(i.g),i.b=Ay(i.b))),i},workingToColorSpace:function(i,s){return this.convert(i,this.workingColorSpace,s)},colorSpaceToWorking:function(i,s){return this.convert(i,s,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===sf?AD:this.spaces[i].transfer},getToneMappingMode:function(i){return this.spaces[i].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(i,s=this.workingColorSpace){return i.fromArray(this.spaces[s].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,s,a){return i.copy(this.spaces[s].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(i,s){return Mw("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),n.workingToColorSpace(i,s)},toWorkingColorSpace:function(i,s){return Mw("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),n.colorSpaceToWorking(i,s)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],r=[.3127,.329];return n.define({[yb]:{primaries:e,whitePoint:r,transfer:AD,toXYZ:r9,fromXYZ:i9,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:dl},outputColorSpaceConfig:{drawingBufferColorSpace:dl}},[dl]:{primaries:e,whitePoint:r,transfer:qn,toXYZ:r9,fromXYZ:i9,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:dl}}}),n}const Rn=g1e();function Yh(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function Ay(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let o0;class v1e{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let r;if(e instanceof HTMLCanvasElement)r=e;else{o0===void 0&&(o0=MD("canvas")),o0.width=e.width,o0.height=e.height;const i=o0.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),r=o0}return r.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=MD("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let a=0;a<s.length;a++)s[a]=Yh(s[a]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(Yh(t[r]/255)*255):t[r]=Yh(t[r]);return{data:t,width:e.width,height:e.height}}else return Ht("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let y1e=0;class V4{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:y1e++}),this.uuid=JS(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):typeof VideoFrame<"u"&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let a=0,o=i.length;a<o;a++)i[a].isDataTexture?s.push(yI(i[a].image)):s.push(yI(i[a]))}else s=yI(i);r.url=s}return t||(e.images[this.uuid]=r),r}}function yI(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?v1e.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(Ht("Texture: Unable to serialize Texture."),{})}let x1e=0;const xI=new De;class wa extends Gb{constructor(e=wa.DEFAULT_IMAGE,t=wa.DEFAULT_MAPPING,r=$h,i=$h,s=Qs,a=Hm,o=lu,l=Lo,u=wa.DEFAULT_ANISOTROPY,c=sf){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:x1e++}),this.uuid=JS(),this.name="",this.source=new V4(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=a,this.anisotropy=u,this.format=o,this.internalFormat=null,this.type=l,this.offset=new Ln(0,0),this.repeat=new Ln(1,1),this.center=new Ln(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new sn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(xI).x}get height(){return this.source.getSize(xI).y}get depth(){return this.source.getSize(xI).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const r=e[t];if(r===void 0){Ht(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){Ht(`Texture.setValues(): property '${t}' does not exist.`);continue}i&&r&&i.isVector2&&r.isVector2||i&&r&&i.isVector3&&r.isVector3||i&&r&&i.isMatrix3&&r.isMatrix3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Dee)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case IL:e.x=e.x-Math.floor(e.x);break;case $h:e.x=e.x<0?0:1;break;case PL:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case IL:e.y=e.y-Math.floor(e.y);break;case $h:e.y=e.y<0?0:1;break;case PL:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}wa.DEFAULT_IMAGE=null;wa.DEFAULT_MAPPING=Dee;wa.DEFAULT_ANISOTROPY=1;class Zr{constructor(e=0,t=0,r=0,i=1){Zr.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*i+a[12]*s,this.y=a[1]*t+a[5]*r+a[9]*i+a[13]*s,this.z=a[2]*t+a[6]*r+a[10]*i+a[14]*s,this.w=a[3]*t+a[7]*r+a[11]*i+a[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,s;const l=e.elements,u=l[0],c=l[4],h=l[8],d=l[1],f=l[5],p=l[9],m=l[2],y=l[6],v=l[10];if(Math.abs(c-d)<.01&&Math.abs(h-m)<.01&&Math.abs(p-y)<.01){if(Math.abs(c+d)<.1&&Math.abs(h+m)<.1&&Math.abs(p+y)<.1&&Math.abs(u+f+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const x=(u+1)/2,w=(f+1)/2,_=(v+1)/2,E=(c+d)/4,A=(h+m)/4,T=(p+y)/4;return x>w&&x>_?x<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(x),i=E/r,s=A/r):w>_?w<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(w),r=E/i,s=T/i):_<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(_),r=A/s,i=T/s),this.set(r,i,s,t),this}let b=Math.sqrt((y-p)*(y-p)+(h-m)*(h-m)+(d-c)*(d-c));return Math.abs(b)<.001&&(b=1),this.x=(y-p)/b,this.y=(h-m)/b,this.z=(d-c)/b,this.w=Math.acos((u+f+v-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=An(this.x,e.x,t.x),this.y=An(this.y,e.y,t.y),this.z=An(this.z,e.z,t.z),this.w=An(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=An(this.x,e,t),this.y=An(this.y,e,t),this.z=An(this.z,e,t),this.w=An(this.w,e,t),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(An(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class b1e extends Gb{constructor(e=1,t=1,r={}){super(),r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Qs,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},r),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=r.depth,this.scissor=new Zr(0,0,e,t),this.scissorTest=!1,this.viewport=new Zr(0,0,e,t);const i={width:e,height:t,depth:r.depth},s=new wa(i);this.textures=[];const a=r.count;for(let o=0;o<a;o++)this.textures[o]=s.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this._setTextureOptions(r),this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=r.depthTexture,this.samples=r.samples,this.multiview=r.multiview}_setTextureOptions(e={}){const t={minFilter:Qs,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let r=0;r<this.textures.length;r++)this.textures[r].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,s=this.textures.length;i<s;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=r,this.textures[i].isData3DTexture!==!0&&(this.textures[i].isArrayTexture=this.textures[i].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,r=e.textures.length;t<r;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const i=Object.assign({},e.textures[t].image);this.textures[t].source=new V4(i)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Ec extends b1e{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class Bee extends wa{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=ws,this.minFilter=ws,this.wrapR=$h,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class _1e extends wa{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=ws,this.minFilter=ws,this.wrapR=$h,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class tA{constructor(e=new De(1/0,1/0,1/0),t=new De(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(Ll.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(Ll.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=Ll.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const s=r.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,o=s.count;a<o;a++)e.isMesh===!0?e.getVertexPosition(a,Ll):Ll.fromBufferAttribute(s,a),Ll.applyMatrix4(e.matrixWorld),this.expandByPoint(Ll);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),lT.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),lT.copy(r.boundingBox)),lT.applyMatrix4(e.matrixWorld),this.union(lT)}const i=e.children;for(let s=0,a=i.length;s<a;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Ll),Ll.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(E_),uT.subVectors(this.max,E_),l0.subVectors(e.a,E_),u0.subVectors(e.b,E_),c0.subVectors(e.c,E_),kd.subVectors(u0,l0),Bd.subVectors(c0,u0),gm.subVectors(l0,c0);let t=[0,-kd.z,kd.y,0,-Bd.z,Bd.y,0,-gm.z,gm.y,kd.z,0,-kd.x,Bd.z,0,-Bd.x,gm.z,0,-gm.x,-kd.y,kd.x,0,-Bd.y,Bd.x,0,-gm.y,gm.x,0];return!bI(t,l0,u0,c0,uT)||(t=[1,0,0,0,1,0,0,0,1],!bI(t,l0,u0,c0,uT))?!1:(cT.crossVectors(kd,Bd),t=[cT.x,cT.y,cT.z],bI(t,l0,u0,c0,uT))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ll).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Ll).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Uc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Uc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Uc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Uc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Uc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Uc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Uc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Uc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Uc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const Uc=[new De,new De,new De,new De,new De,new De,new De,new De],Ll=new De,lT=new tA,l0=new De,u0=new De,c0=new De,kd=new De,Bd=new De,gm=new De,E_=new De,uT=new De,cT=new De,vm=new De;function bI(n,e,t,r,i){for(let s=0,a=n.length-3;s<=a;s+=3){vm.fromArray(n,s);const o=i.x*Math.abs(vm.x)+i.y*Math.abs(vm.y)+i.z*Math.abs(vm.z),l=e.dot(vm),u=t.dot(vm),c=r.dot(vm);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>o)return!1}return!0}const w1e=new tA,S_=new De,_I=new De;class nA{constructor(e=new De,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):w1e.setFromPoints(e).getCenter(r);let i=0;for(let s=0,a=e.length;s<a;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;S_.subVectors(e,this.center);const t=S_.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(S_,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(_I.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(S_.copy(e.center).add(_I)),this.expandByPoint(S_.copy(e.center).sub(_I))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const Vc=new De,wI=new De,hT=new De,Ud=new De,EI=new De,dT=new De,SI=new De;class z4{constructor(e=new De,t=new De(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Vc)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Vc.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Vc.copy(this.origin).addScaledVector(this.direction,t),Vc.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){wI.copy(e).add(t).multiplyScalar(.5),hT.copy(t).sub(e).normalize(),Ud.copy(this.origin).sub(wI);const s=e.distanceTo(t)*.5,a=-this.direction.dot(hT),o=Ud.dot(this.direction),l=-Ud.dot(hT),u=Ud.lengthSq(),c=Math.abs(1-a*a);let h,d,f,p;if(c>0)if(h=a*l-o,d=a*o-l,p=s*c,h>=0)if(d>=-p)if(d<=p){const m=1/c;h*=m,d*=m,f=h*(h+a*d+2*o)+d*(a*h+d+2*l)+u}else d=s,h=Math.max(0,-(a*d+o)),f=-h*h+d*(d+2*l)+u;else d=-s,h=Math.max(0,-(a*d+o)),f=-h*h+d*(d+2*l)+u;else d<=-p?(h=Math.max(0,-(-a*s+o)),d=h>0?-s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+u):d<=p?(h=0,d=Math.min(Math.max(-s,-l),s),f=d*(d+2*l)+u):(h=Math.max(0,-(a*s+o)),d=h>0?s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+u);else d=a>0?-s:s,h=Math.max(0,-(a*d+o)),f=-h*h+d*(d+2*l)+u;return r&&r.copy(this.origin).addScaledVector(this.direction,h),i&&i.copy(wI).addScaledVector(hT,d),f}intersectSphere(e,t){Vc.subVectors(e.center,this.origin);const r=Vc.dot(this.direction),i=Vc.dot(Vc)-r*r,s=e.radius*e.radius;if(i>s)return null;const a=Math.sqrt(s-i),o=r-a,l=r+a;return l<0?null:o<0?this.at(l,t):this.at(o,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,s,a,o,l;const u=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,d=this.origin;return u>=0?(r=(e.min.x-d.x)*u,i=(e.max.x-d.x)*u):(r=(e.max.x-d.x)*u,i=(e.min.x-d.x)*u),c>=0?(s=(e.min.y-d.y)*c,a=(e.max.y-d.y)*c):(s=(e.max.y-d.y)*c,a=(e.min.y-d.y)*c),r>a||s>i||((s>r||isNaN(r))&&(r=s),(a<i||isNaN(i))&&(i=a),h>=0?(o=(e.min.z-d.z)*h,l=(e.max.z-d.z)*h):(o=(e.max.z-d.z)*h,l=(e.min.z-d.z)*h),r>l||o>i)||((o>r||r!==r)&&(r=o),(l<i||i!==i)&&(i=l),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,Vc)!==null}intersectTriangle(e,t,r,i,s){EI.subVectors(t,e),dT.subVectors(r,e),SI.crossVectors(EI,dT);let a=this.direction.dot(SI),o;if(a>0){if(i)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Ud.subVectors(this.origin,e);const l=o*this.direction.dot(dT.crossVectors(Ud,dT));if(l<0)return null;const u=o*this.direction.dot(EI.cross(Ud));if(u<0||l+u>a)return null;const c=-o*Ud.dot(SI);return c<0?null:this.at(c/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Rr{constructor(e,t,r,i,s,a,o,l,u,c,h,d,f,p,m,y){Rr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,a,o,l,u,c,h,d,f,p,m,y)}set(e,t,r,i,s,a,o,l,u,c,h,d,f,p,m,y){const v=this.elements;return v[0]=e,v[4]=t,v[8]=r,v[12]=i,v[1]=s,v[5]=a,v[9]=o,v[13]=l,v[2]=u,v[6]=c,v[10]=h,v[14]=d,v[3]=f,v[7]=p,v[11]=m,v[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Rr().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return this.determinant()===0?(e.set(1,0,0),t.set(0,1,0),r.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this)}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();const t=this.elements,r=e.elements,i=1/h0.setFromMatrixColumn(e,0).length(),s=1/h0.setFromMatrixColumn(e,1).length(),a=1/h0.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,s=e.z,a=Math.cos(r),o=Math.sin(r),l=Math.cos(i),u=Math.sin(i),c=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){const d=a*c,f=a*h,p=o*c,m=o*h;t[0]=l*c,t[4]=-l*h,t[8]=u,t[1]=f+p*u,t[5]=d-m*u,t[9]=-o*l,t[2]=m-d*u,t[6]=p+f*u,t[10]=a*l}else if(e.order==="YXZ"){const d=l*c,f=l*h,p=u*c,m=u*h;t[0]=d+m*o,t[4]=p*o-f,t[8]=a*u,t[1]=a*h,t[5]=a*c,t[9]=-o,t[2]=f*o-p,t[6]=m+d*o,t[10]=a*l}else if(e.order==="ZXY"){const d=l*c,f=l*h,p=u*c,m=u*h;t[0]=d-m*o,t[4]=-a*h,t[8]=p+f*o,t[1]=f+p*o,t[5]=a*c,t[9]=m-d*o,t[2]=-a*u,t[6]=o,t[10]=a*l}else if(e.order==="ZYX"){const d=a*c,f=a*h,p=o*c,m=o*h;t[0]=l*c,t[4]=p*u-f,t[8]=d*u+m,t[1]=l*h,t[5]=m*u+d,t[9]=f*u-p,t[2]=-u,t[6]=o*l,t[10]=a*l}else if(e.order==="YZX"){const d=a*l,f=a*u,p=o*l,m=o*u;t[0]=l*c,t[4]=m-d*h,t[8]=p*h+f,t[1]=h,t[5]=a*c,t[9]=-o*c,t[2]=-u*c,t[6]=f*h+p,t[10]=d-m*h}else if(e.order==="XZY"){const d=a*l,f=a*u,p=o*l,m=o*u;t[0]=l*c,t[4]=-h,t[8]=u*c,t[1]=d*h+m,t[5]=a*c,t[9]=f*h-p,t[2]=p*h-f,t[6]=o*c,t[10]=m*h+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(E1e,e,S1e)}lookAt(e,t,r){const i=this.elements;return ao.subVectors(e,t),ao.lengthSq()===0&&(ao.z=1),ao.normalize(),Vd.crossVectors(r,ao),Vd.lengthSq()===0&&(Math.abs(r.z)===1?ao.x+=1e-4:ao.z+=1e-4,ao.normalize(),Vd.crossVectors(r,ao)),Vd.normalize(),fT.crossVectors(ao,Vd),i[0]=Vd.x,i[4]=fT.x,i[8]=ao.x,i[1]=Vd.y,i[5]=fT.y,i[9]=ao.y,i[2]=Vd.z,i[6]=fT.z,i[10]=ao.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,a=r[0],o=r[4],l=r[8],u=r[12],c=r[1],h=r[5],d=r[9],f=r[13],p=r[2],m=r[6],y=r[10],v=r[14],b=r[3],x=r[7],w=r[11],_=r[15],E=i[0],A=i[4],T=i[8],S=i[12],M=i[1],D=i[5],N=i[9],R=i[13],z=i[2],j=i[6],I=i[10],F=i[14],$=i[3],H=i[7],Z=i[11],J=i[15];return s[0]=a*E+o*M+l*z+u*$,s[4]=a*A+o*D+l*j+u*H,s[8]=a*T+o*N+l*I+u*Z,s[12]=a*S+o*R+l*F+u*J,s[1]=c*E+h*M+d*z+f*$,s[5]=c*A+h*D+d*j+f*H,s[9]=c*T+h*N+d*I+f*Z,s[13]=c*S+h*R+d*F+f*J,s[2]=p*E+m*M+y*z+v*$,s[6]=p*A+m*D+y*j+v*H,s[10]=p*T+m*N+y*I+v*Z,s[14]=p*S+m*R+y*F+v*J,s[3]=b*E+x*M+w*z+_*$,s[7]=b*A+x*D+w*j+_*H,s[11]=b*T+x*N+w*I+_*Z,s[15]=b*S+x*R+w*F+_*J,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],s=e[12],a=e[1],o=e[5],l=e[9],u=e[13],c=e[2],h=e[6],d=e[10],f=e[14],p=e[3],m=e[7],y=e[11],v=e[15],b=l*f-u*d,x=o*f-u*h,w=o*d-l*h,_=a*f-u*c,E=a*d-l*c,A=a*h-o*c;return t*(m*b-y*x+v*w)-r*(p*b-y*_+v*E)+i*(p*x-m*_+v*A)-s*(p*w-m*E+y*A)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],y=e[14],v=e[15],b=h*y*u-m*d*u+m*l*f-o*y*f-h*l*v+o*d*v,x=p*d*u-c*y*u-p*l*f+a*y*f+c*l*v-a*d*v,w=c*m*u-p*h*u+p*o*f-a*m*f-c*o*v+a*h*v,_=p*h*l-c*m*l-p*o*d+a*m*d+c*o*y-a*h*y,E=t*b+r*x+i*w+s*_;if(E===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const A=1/E;return e[0]=b*A,e[1]=(m*d*s-h*y*s-m*i*f+r*y*f+h*i*v-r*d*v)*A,e[2]=(o*y*s-m*l*s+m*i*u-r*y*u-o*i*v+r*l*v)*A,e[3]=(h*l*s-o*d*s-h*i*u+r*d*u+o*i*f-r*l*f)*A,e[4]=x*A,e[5]=(c*y*s-p*d*s+p*i*f-t*y*f-c*i*v+t*d*v)*A,e[6]=(p*l*s-a*y*s-p*i*u+t*y*u+a*i*v-t*l*v)*A,e[7]=(a*d*s-c*l*s+c*i*u-t*d*u-a*i*f+t*l*f)*A,e[8]=w*A,e[9]=(p*h*s-c*m*s-p*r*f+t*m*f+c*r*v-t*h*v)*A,e[10]=(a*m*s-p*o*s+p*r*u-t*m*u-a*r*v+t*o*v)*A,e[11]=(c*o*s-a*h*s-c*r*u+t*h*u+a*r*f-t*o*f)*A,e[12]=_*A,e[13]=(c*m*i-p*h*i+p*r*d-t*m*d-c*r*y+t*h*y)*A,e[14]=(p*o*i-a*m*i-p*r*l+t*m*l+a*r*y-t*o*y)*A,e[15]=(a*h*i-c*o*i+c*r*l-t*h*l-a*r*d+t*o*d)*A,this}scale(e){const t=this.elements,r=e.x,i=e.y,s=e.z;return t[0]*=r,t[4]*=i,t[8]*=s,t[1]*=r,t[5]*=i,t[9]*=s,t[2]*=r,t[6]*=i,t[10]*=s,t[3]*=r,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),s=1-r,a=e.x,o=e.y,l=e.z,u=s*a,c=s*o;return this.set(u*a+r,u*o-i*l,u*l+i*o,0,u*o+i*l,c*o+r,c*l-i*a,0,u*l-i*o,c*l+i*a,s*l*l+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,s,a){return this.set(1,r,s,0,e,1,a,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,s=t._x,a=t._y,o=t._z,l=t._w,u=s+s,c=a+a,h=o+o,d=s*u,f=s*c,p=s*h,m=a*c,y=a*h,v=o*h,b=l*u,x=l*c,w=l*h,_=r.x,E=r.y,A=r.z;return i[0]=(1-(m+v))*_,i[1]=(f+w)*_,i[2]=(p-x)*_,i[3]=0,i[4]=(f-w)*E,i[5]=(1-(d+v))*E,i[6]=(y+b)*E,i[7]=0,i[8]=(p+x)*A,i[9]=(y-b)*A,i[10]=(1-(d+m))*A,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;if(e.x=i[12],e.y=i[13],e.z=i[14],this.determinant()===0)return r.set(1,1,1),t.identity(),this;let s=h0.set(i[0],i[1],i[2]).length();const a=h0.set(i[4],i[5],i[6]).length(),o=h0.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),Ol.copy(this);const u=1/s,c=1/a,h=1/o;return Ol.elements[0]*=u,Ol.elements[1]*=u,Ol.elements[2]*=u,Ol.elements[4]*=c,Ol.elements[5]*=c,Ol.elements[6]*=c,Ol.elements[8]*=h,Ol.elements[9]*=h,Ol.elements[10]*=h,t.setFromRotationMatrix(Ol),r.x=s,r.y=a,r.z=o,this}makePerspective(e,t,r,i,s,a,o=uc,l=!1){const u=this.elements,c=2*s/(t-e),h=2*s/(r-i),d=(t+e)/(t-e),f=(r+i)/(r-i);let p,m;if(l)p=s/(a-s),m=a*s/(a-s);else if(o===uc)p=-(a+s)/(a-s),m=-2*a*s/(a-s);else if(o===TD)p=-a/(a-s),m=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return u[0]=c,u[4]=0,u[8]=d,u[12]=0,u[1]=0,u[5]=h,u[9]=f,u[13]=0,u[2]=0,u[6]=0,u[10]=p,u[14]=m,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(e,t,r,i,s,a,o=uc,l=!1){const u=this.elements,c=2/(t-e),h=2/(r-i),d=-(t+e)/(t-e),f=-(r+i)/(r-i);let p,m;if(l)p=1/(a-s),m=a/(a-s);else if(o===uc)p=-2/(a-s),m=-(a+s)/(a-s);else if(o===TD)p=-1/(a-s),m=-s/(a-s);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return u[0]=c,u[4]=0,u[8]=0,u[12]=d,u[1]=0,u[5]=h,u[9]=0,u[13]=f,u[2]=0,u[6]=0,u[10]=p,u[14]=m,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const h0=new De,Ol=new Rr,E1e=new De(0,0,0),S1e=new De(1,1,1),Vd=new De,fT=new De,ao=new De,s9=new Rr,a9=new eA;class gu{constructor(e=0,t=0,r=0,i=gu.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,s=i[0],a=i[4],o=i[8],l=i[1],u=i[5],c=i[9],h=i[2],d=i[6],f=i[10];switch(t){case"XYZ":this._y=Math.asin(An(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-An(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,f),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(An(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-An(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(An(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(o,f));break;case"XZY":this._z=Math.asin(-An(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-c,f),this._y=0);break;default:Ht("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return s9.makeRotationFromQuaternion(e),this.setFromRotationMatrix(s9,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return a9.setFromEuler(this),this.setFromQuaternion(a9,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}gu.DEFAULT_ORDER="XYZ";class Uee{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let A1e=0;const o9=new De,d0=new eA,zc=new Rr,pT=new De,A_=new De,T1e=new De,M1e=new eA,l9=new De(1,0,0),u9=new De(0,1,0),c9=new De(0,0,1),h9={type:"added"},C1e={type:"removed"},f0={type:"childadded",child:null},AI={type:"childremoved",child:null};class Zs extends Gb{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:A1e++}),this.uuid=JS(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Zs.DEFAULT_UP.clone();const e=new De,t=new gu,r=new eA,i=new De(1,1,1);function s(){r.setFromEuler(t,!1)}function a(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Rr},normalMatrix:{value:new sn}}),this.matrix=new Rr,this.matrixWorld=new Rr,this.matrixAutoUpdate=Zs.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Zs.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Uee,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return d0.setFromAxisAngle(e,t),this.quaternion.multiply(d0),this}rotateOnWorldAxis(e,t){return d0.setFromAxisAngle(e,t),this.quaternion.premultiply(d0),this}rotateX(e){return this.rotateOnAxis(l9,e)}rotateY(e){return this.rotateOnAxis(u9,e)}rotateZ(e){return this.rotateOnAxis(c9,e)}translateOnAxis(e,t){return o9.copy(e).applyQuaternion(this.quaternion),this.position.add(o9.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(l9,e)}translateY(e){return this.translateOnAxis(u9,e)}translateZ(e){return this.translateOnAxis(c9,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(zc.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?pT.copy(e):pT.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),A_.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?zc.lookAt(A_,pT,this.up):zc.lookAt(pT,A_,this.up),this.quaternion.setFromRotationMatrix(zc),i&&(zc.extractRotation(i.matrixWorld),d0.setFromRotationMatrix(zc),this.quaternion.premultiply(d0.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(Bn("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(h9),f0.child=e,this.dispatchEvent(f0),f0.child=null):Bn("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(C1e),AI.child=e,this.dispatchEvent(AI),AI.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),zc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),zc.multiply(e.parent.matrixWorld)),e.applyMatrix4(zc),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(h9),f0.child=e,this.dispatchEvent(f0),f0.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const a=this.children[r].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(A_,e,T1e),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(A_,M1e,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.geometryInfo=this._geometryInfo.map(o=>({...o,boundingBox:o.boundingBox?o.boundingBox.toJSON():void 0,boundingSphere:o.boundingSphere?o.boundingSphere.toJSON():void 0})),i.instanceInfo=this._instanceInfo.map(o=>({...o})),i.availableInstanceIds=this._availableInstanceIds.slice(),i.availableGeometryIds=this._availableGeometryIds.slice(),i.nextIndexStart=this._nextIndexStart,i.nextVertexStart=this._nextVertexStart,i.geometryCount=this._geometryCount,i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.matricesTexture=this._matricesTexture.toJSON(e),i.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(i.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(i.boundingBox=this.boundingBox.toJSON()));function s(o,l){return o[l.uuid]===void 0&&(o[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const l=o.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){const h=l[u];s(e.shapes,h)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let l=0,u=this.material.length;l<u;l++)o.push(s(e.materials,this.material[l]));i.material=o}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let o=0;o<this.animations.length;o++){const l=this.animations[o];i.animations.push(s(e.animations,l))}}if(t){const o=a(e.geometries),l=a(e.materials),u=a(e.textures),c=a(e.images),h=a(e.shapes),d=a(e.skeletons),f=a(e.animations),p=a(e.nodes);o.length>0&&(r.geometries=o),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),c.length>0&&(r.images=c),h.length>0&&(r.shapes=h),d.length>0&&(r.skeletons=d),f.length>0&&(r.animations=f),p.length>0&&(r.nodes=p)}return r.object=i,r;function a(o){const l=[];for(const u in o){const c=o[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}Zs.DEFAULT_UP=new De(0,1,0);Zs.DEFAULT_MATRIX_AUTO_UPDATE=!0;Zs.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const kl=new De,$c=new De,TI=new De,Hc=new De,p0=new De,m0=new De,d9=new De,MI=new De,CI=new De,DI=new De,NI=new Zr,RI=new Zr,II=new Zr;class su{constructor(e=new De,t=new De,r=new De){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),kl.subVectors(e,t),i.cross(kl);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,r,i,s){kl.subVectors(i,t),$c.subVectors(r,t),TI.subVectors(e,t);const a=kl.dot(kl),o=kl.dot($c),l=kl.dot(TI),u=$c.dot($c),c=$c.dot(TI),h=a*u-o*o;if(h===0)return s.set(0,0,0),null;const d=1/h,f=(u*l-o*c)*d,p=(a*c-o*l)*d;return s.set(1-f-p,p,f)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,Hc)===null?!1:Hc.x>=0&&Hc.y>=0&&Hc.x+Hc.y<=1}static getInterpolation(e,t,r,i,s,a,o,l){return this.getBarycoord(e,t,r,i,Hc)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,Hc.x),l.addScaledVector(a,Hc.y),l.addScaledVector(o,Hc.z),l)}static getInterpolatedAttribute(e,t,r,i,s,a){return NI.setScalar(0),RI.setScalar(0),II.setScalar(0),NI.fromBufferAttribute(e,t),RI.fromBufferAttribute(e,r),II.fromBufferAttribute(e,i),a.setScalar(0),a.addScaledVector(NI,s.x),a.addScaledVector(RI,s.y),a.addScaledVector(II,s.z),a}static isFrontFacing(e,t,r,i){return kl.subVectors(r,t),$c.subVectors(e,t),kl.cross($c).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return kl.subVectors(this.c,this.b),$c.subVectors(this.a,this.b),kl.cross($c).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return su.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return su.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,r,i,s){return su.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}containsPoint(e){return su.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return su.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,i=this.b,s=this.c;let a,o;p0.subVectors(i,r),m0.subVectors(s,r),MI.subVectors(e,r);const l=p0.dot(MI),u=m0.dot(MI);if(l<=0&&u<=0)return t.copy(r);CI.subVectors(e,i);const c=p0.dot(CI),h=m0.dot(CI);if(c>=0&&h<=c)return t.copy(i);const d=l*h-c*u;if(d<=0&&l>=0&&c<=0)return a=l/(l-c),t.copy(r).addScaledVector(p0,a);DI.subVectors(e,s);const f=p0.dot(DI),p=m0.dot(DI);if(p>=0&&f<=p)return t.copy(s);const m=f*u-l*p;if(m<=0&&u>=0&&p<=0)return o=u/(u-p),t.copy(r).addScaledVector(m0,o);const y=c*p-f*h;if(y<=0&&h-c>=0&&f-p>=0)return d9.subVectors(s,i),o=(h-c)/(h-c+(f-p)),t.copy(i).addScaledVector(d9,o);const v=1/(y+m+d);return a=m*v,o=d*v,t.copy(r).addScaledVector(p0,a).addScaledVector(m0,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Vee={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},zd={h:0,s:0,l:0},mT={h:0,s:0,l:0};function PI(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class Bt{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=dl){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Rn.colorSpaceToWorking(this,t),this}setRGB(e,t,r,i=Rn.workingColorSpace){return this.r=e,this.g=t,this.b=r,Rn.colorSpaceToWorking(this,i),this}setHSL(e,t,r,i=Rn.workingColorSpace){if(e=m1e(e,1),t=An(t,0,1),r=An(r,0,1),t===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+t):r+t-r*t,a=2*r-s;this.r=PI(a,s,e+1/3),this.g=PI(a,s,e),this.b=PI(a,s,e-1/3)}return Rn.colorSpaceToWorking(this,i),this}setStyle(e,t=dl){function r(s){s!==void 0&&parseFloat(s)<1&&Ht("Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=i[1],o=i[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:Ht("Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(s,16),t);Ht("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=dl){const r=Vee[e.toLowerCase()];return r!==void 0?this.setHex(r,t):Ht("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Yh(e.r),this.g=Yh(e.g),this.b=Yh(e.b),this}copyLinearToSRGB(e){return this.r=Ay(e.r),this.g=Ay(e.g),this.b=Ay(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=dl){return Rn.workingToColorSpace(ks.copy(this),e),Math.round(An(ks.r*255,0,255))*65536+Math.round(An(ks.g*255,0,255))*256+Math.round(An(ks.b*255,0,255))}getHexString(e=dl){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Rn.workingColorSpace){Rn.workingToColorSpace(ks.copy(this),t);const r=ks.r,i=ks.g,s=ks.b,a=Math.max(r,i,s),o=Math.min(r,i,s);let l,u;const c=(o+a)/2;if(o===a)l=0,u=0;else{const h=a-o;switch(u=c<=.5?h/(a+o):h/(2-a-o),a){case r:l=(i-s)/h+(i<s?6:0);break;case i:l=(s-r)/h+2;break;case s:l=(r-i)/h+4;break}l/=6}return e.h=l,e.s=u,e.l=c,e}getRGB(e,t=Rn.workingColorSpace){return Rn.workingToColorSpace(ks.copy(this),t),e.r=ks.r,e.g=ks.g,e.b=ks.b,e}getStyle(e=dl){Rn.workingToColorSpace(ks.copy(this),e);const t=ks.r,r=ks.g,i=ks.b;return e!==dl?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,t,r){return this.getHSL(zd),this.setHSL(zd.h+e,zd.s+t,zd.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(zd),e.getHSL(mT);const r=mI(zd.h,mT.h,t),i=mI(zd.s,mT.s,t),s=mI(zd.l,mT.l,t);return this.setHSL(r,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,i=this.b,s=e.elements;return this.r=s[0]*t+s[3]*r+s[6]*i,this.g=s[1]*t+s[4]*r+s[7]*i,this.b=s[2]*t+s[5]*r+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ks=new Bt;Bt.NAMES=Vee;let D1e=0;class Xp extends Gb{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:D1e++}),this.uuid=JS(),this.name="",this.type="Material",this.blending=Sy,this.side=Pp,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=_L,this.blendDst=wL,this.blendEquation=Rm,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Bt(0,0,0),this.blendAlpha=0,this.depthFunc=mb,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Q8,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=a0,this.stencilZFail=a0,this.stencilZPass=a0,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){Ht(`Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){Ht(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(r.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(r.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Sy&&(r.blending=this.blending),this.side!==Pp&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==_L&&(r.blendSrc=this.blendSrc),this.blendDst!==wL&&(r.blendDst=this.blendDst),this.blendEquation!==Rm&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==mb&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Q8&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==a0&&(r.stencilFail=this.stencilFail),this.stencilZFail!==a0&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==a0&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.allowOverride===!1&&(r.allowOverride=!1),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const a=[];for(const o in s){const l=s[o];delete l.metadata,a.push(l)}return a}if(t){const s=i(e.textures),a=i(e.images);s.length>0&&(r.textures=s),a.length>0&&(r.images=a)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const i=t.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=t[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Xd extends Xp{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Bt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new gu,this.combine=N4,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const di=new De,gT=new Ln;let N1e=0;class Ya{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:N1e++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=Z8,this.updateRanges=[],this.gpuType=lc,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)gT.fromBufferAttribute(this,t),gT.applyMatrix3(e),this.setXY(t,gT.x,gT.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)di.fromBufferAttribute(this,t),di.applyMatrix3(e),this.setXYZ(t,di.x,di.y,di.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)di.fromBufferAttribute(this,t),di.applyMatrix4(e),this.setXYZ(t,di.x,di.y,di.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)di.fromBufferAttribute(this,t),di.applyNormalMatrix(e),this.setXYZ(t,di.x,di.y,di.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)di.fromBufferAttribute(this,t),di.transformDirection(e),this.setXYZ(t,di.x,di.y,di.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=w_(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=Pa(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=w_(t,this.array)),t}setX(e,t){return this.normalized&&(t=Pa(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=w_(t,this.array)),t}setY(e,t){return this.normalized&&(t=Pa(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=w_(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Pa(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=w_(t,this.array)),t}setW(e,t){return this.normalized&&(t=Pa(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Pa(t,this.array),r=Pa(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=Pa(t,this.array),r=Pa(r,this.array),i=Pa(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=Pa(t,this.array),r=Pa(r,this.array),i=Pa(i,this.array),s=Pa(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Z8&&(e.usage=this.usage),e}}class zee extends Ya{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class $ee extends Ya{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class Pi extends Ya{constructor(e,t,r){super(new Float32Array(e),t,r)}}let R1e=0;const Ko=new Rr,FI=new Zs,g0=new De,oo=new tA,T_=new tA,ji=new De;class Ms extends Gb{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:R1e++}),this.uuid=JS(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(kee(e)?$ee:zee)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new sn().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ko.makeRotationFromQuaternion(e),this.applyMatrix4(Ko),this}rotateX(e){return Ko.makeRotationX(e),this.applyMatrix4(Ko),this}rotateY(e){return Ko.makeRotationY(e),this.applyMatrix4(Ko),this}rotateZ(e){return Ko.makeRotationZ(e),this.applyMatrix4(Ko),this}translate(e,t,r){return Ko.makeTranslation(e,t,r),this.applyMatrix4(Ko),this}scale(e,t,r){return Ko.makeScale(e,t,r),this.applyMatrix4(Ko),this}lookAt(e){return FI.lookAt(e),FI.updateMatrix(),this.applyMatrix4(FI.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(g0).negate(),this.translate(g0.x,g0.y,g0.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const r=[];for(let i=0,s=e.length;i<s;i++){const a=e[i];r.push(a.x,a.y,a.z||0)}this.setAttribute("position",new Pi(r,3))}else{const r=Math.min(e.length,t.count);for(let i=0;i<r;i++){const s=e[i];t.setXYZ(i,s.x,s.y,s.z||0)}e.length>t.count&&Ht("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new tA);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Bn("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new De(-1/0,-1/0,-1/0),new De(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){const s=t[r];oo.setFromBufferAttribute(s),this.morphTargetsRelative?(ji.addVectors(this.boundingBox.min,oo.min),this.boundingBox.expandByPoint(ji),ji.addVectors(this.boundingBox.max,oo.max),this.boundingBox.expandByPoint(ji)):(this.boundingBox.expandByPoint(oo.min),this.boundingBox.expandByPoint(oo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&Bn('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new nA);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Bn("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new De,1/0);return}if(e){const r=this.boundingSphere.center;if(oo.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const o=t[s];T_.setFromBufferAttribute(o),this.morphTargetsRelative?(ji.addVectors(oo.min,T_.min),oo.expandByPoint(ji),ji.addVectors(oo.max,T_.max),oo.expandByPoint(ji)):(oo.expandByPoint(T_.min),oo.expandByPoint(T_.max))}oo.getCenter(r);let i=0;for(let s=0,a=e.count;s<a;s++)ji.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(ji));if(t)for(let s=0,a=t.length;s<a;s++){const o=t[s],l=this.morphTargetsRelative;for(let u=0,c=o.count;u<c;u++)ji.fromBufferAttribute(o,u),l&&(g0.fromBufferAttribute(e,u),ji.add(g0)),i=Math.max(i,r.distanceToSquared(ji))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&Bn('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){Bn("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=t.position,i=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ya(new Float32Array(4*r.count),4));const a=this.getAttribute("tangent"),o=[],l=[];for(let T=0;T<r.count;T++)o[T]=new De,l[T]=new De;const u=new De,c=new De,h=new De,d=new Ln,f=new Ln,p=new Ln,m=new De,y=new De;function v(T,S,M){u.fromBufferAttribute(r,T),c.fromBufferAttribute(r,S),h.fromBufferAttribute(r,M),d.fromBufferAttribute(s,T),f.fromBufferAttribute(s,S),p.fromBufferAttribute(s,M),c.sub(u),h.sub(u),f.sub(d),p.sub(d);const D=1/(f.x*p.y-p.x*f.y);isFinite(D)&&(m.copy(c).multiplyScalar(p.y).addScaledVector(h,-f.y).multiplyScalar(D),y.copy(h).multiplyScalar(f.x).addScaledVector(c,-p.x).multiplyScalar(D),o[T].add(m),o[S].add(m),o[M].add(m),l[T].add(y),l[S].add(y),l[M].add(y))}let b=this.groups;b.length===0&&(b=[{start:0,count:e.count}]);for(let T=0,S=b.length;T<S;++T){const M=b[T],D=M.start,N=M.count;for(let R=D,z=D+N;R<z;R+=3)v(e.getX(R+0),e.getX(R+1),e.getX(R+2))}const x=new De,w=new De,_=new De,E=new De;function A(T){_.fromBufferAttribute(i,T),E.copy(_);const S=o[T];x.copy(S),x.sub(_.multiplyScalar(_.dot(S))).normalize(),w.crossVectors(E,S);const D=w.dot(l[T])<0?-1:1;a.setXYZW(T,x.x,x.y,x.z,D)}for(let T=0,S=b.length;T<S;++T){const M=b[T],D=M.start,N=M.count;for(let R=D,z=D+N;R<z;R+=3)A(e.getX(R+0)),A(e.getX(R+1)),A(e.getX(R+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Ya(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let d=0,f=r.count;d<f;d++)r.setXYZ(d,0,0,0);const i=new De,s=new De,a=new De,o=new De,l=new De,u=new De,c=new De,h=new De;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),m=e.getX(d+1),y=e.getX(d+2);i.fromBufferAttribute(t,p),s.fromBufferAttribute(t,m),a.fromBufferAttribute(t,y),c.subVectors(a,s),h.subVectors(i,s),c.cross(h),o.fromBufferAttribute(r,p),l.fromBufferAttribute(r,m),u.fromBufferAttribute(r,y),o.add(c),l.add(c),u.add(c),r.setXYZ(p,o.x,o.y,o.z),r.setXYZ(m,l.x,l.y,l.z),r.setXYZ(y,u.x,u.y,u.z)}else for(let d=0,f=t.count;d<f;d+=3)i.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),a.fromBufferAttribute(t,d+2),c.subVectors(a,s),h.subVectors(i,s),c.cross(h),r.setXYZ(d+0,c.x,c.y,c.z),r.setXYZ(d+1,c.x,c.y,c.z),r.setXYZ(d+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)ji.fromBufferAttribute(e,t),ji.normalize(),e.setXYZ(t,ji.x,ji.y,ji.z)}toNonIndexed(){function e(o,l){const u=o.array,c=o.itemSize,h=o.normalized,d=new u.constructor(l.length*c);let f=0,p=0;for(let m=0,y=l.length;m<y;m++){o.isInterleavedBufferAttribute?f=l[m]*o.data.stride+o.offset:f=l[m]*c;for(let v=0;v<c;v++)d[p++]=u[f++]}return new Ya(d,c,h)}if(this.index===null)return Ht("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Ms,r=this.index.array,i=this.attributes;for(const o in i){const l=i[o],u=e(l,r);t.setAttribute(o,u)}const s=this.morphAttributes;for(const o in s){const l=[],u=s[o];for(let c=0,h=u.length;c<h;c++){const d=u[c],f=e(d,r);l.push(f)}t.morphAttributes[o]=l}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,l=a.length;o<l;o++){const u=a[o];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const l in r){const u=r[l];e.data.attributes[l]=u.toJSON(e.data)}const i={};let s=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],c=[];for(let h=0,d=u.length;h<d;h++){const f=u[h];c.push(f.toJSON(e.data))}c.length>0&&(i[l]=c,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere=o.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone());const i=e.attributes;for(const u in i){const c=i[u];this.setAttribute(u,c.clone(t))}const s=e.morphAttributes;for(const u in s){const c=[],h=s[u];for(let d=0,f=h.length;d<f;d++)c.push(h[d].clone(t));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let u=0,c=a.length;u<c;u++){const h=a[u];this.addGroup(h.start,h.count,h.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const f9=new Rr,ym=new z4,vT=new nA,p9=new De,yT=new De,xT=new De,bT=new De,LI=new De,_T=new De,m9=new De,wT=new De;class cr extends Zs{constructor(e=new Ms,t=new Xd){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(e,t){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,a=r.morphTargetsRelative;t.fromBufferAttribute(i,e);const o=this.morphTargetInfluences;if(s&&o){_T.set(0,0,0);for(let l=0,u=s.length;l<u;l++){const c=o[l],h=s[l];c!==0&&(LI.fromBufferAttribute(h,e),a?_T.addScaledVector(LI,c):_T.addScaledVector(LI.sub(t),c))}t.add(_T)}return t}raycast(e,t){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),vT.copy(r.boundingSphere),vT.applyMatrix4(s),ym.copy(e.ray).recast(e.near),!(vT.containsPoint(ym.origin)===!1&&(ym.intersectSphere(vT,p9)===null||ym.origin.distanceToSquared(p9)>(e.far-e.near)**2))&&(f9.copy(s).invert(),ym.copy(e.ray).applyMatrix4(f9),!(r.boundingBox!==null&&ym.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,t,ym)))}_computeIntersections(e,t,r){let i;const s=this.geometry,a=this.material,o=s.index,l=s.attributes.position,u=s.attributes.uv,c=s.attributes.uv1,h=s.attributes.normal,d=s.groups,f=s.drawRange;if(o!==null)if(Array.isArray(a))for(let p=0,m=d.length;p<m;p++){const y=d[p],v=a[y.materialIndex],b=Math.max(y.start,f.start),x=Math.min(o.count,Math.min(y.start+y.count,f.start+f.count));for(let w=b,_=x;w<_;w+=3){const E=o.getX(w),A=o.getX(w+1),T=o.getX(w+2);i=ET(this,v,e,r,u,c,h,E,A,T),i&&(i.faceIndex=Math.floor(w/3),i.face.materialIndex=y.materialIndex,t.push(i))}}else{const p=Math.max(0,f.start),m=Math.min(o.count,f.start+f.count);for(let y=p,v=m;y<v;y+=3){const b=o.getX(y),x=o.getX(y+1),w=o.getX(y+2);i=ET(this,a,e,r,u,c,h,b,x,w),i&&(i.faceIndex=Math.floor(y/3),t.push(i))}}else if(l!==void 0)if(Array.isArray(a))for(let p=0,m=d.length;p<m;p++){const y=d[p],v=a[y.materialIndex],b=Math.max(y.start,f.start),x=Math.min(l.count,Math.min(y.start+y.count,f.start+f.count));for(let w=b,_=x;w<_;w+=3){const E=w,A=w+1,T=w+2;i=ET(this,v,e,r,u,c,h,E,A,T),i&&(i.faceIndex=Math.floor(w/3),i.face.materialIndex=y.materialIndex,t.push(i))}}else{const p=Math.max(0,f.start),m=Math.min(l.count,f.start+f.count);for(let y=p,v=m;y<v;y+=3){const b=y,x=y+1,w=y+2;i=ET(this,a,e,r,u,c,h,b,x,w),i&&(i.faceIndex=Math.floor(y/3),t.push(i))}}}}function I1e(n,e,t,r,i,s,a,o){let l;if(e.side===to?l=r.intersectTriangle(a,s,i,!0,o):l=r.intersectTriangle(i,s,a,e.side===Pp,o),l===null)return null;wT.copy(o),wT.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(wT);return u<t.near||u>t.far?null:{distance:u,point:wT.clone(),object:n}}function ET(n,e,t,r,i,s,a,o,l,u){n.getVertexPosition(o,yT),n.getVertexPosition(l,xT),n.getVertexPosition(u,bT);const c=I1e(n,e,t,r,yT,xT,bT,m9);if(c){const h=new De;su.getBarycoord(m9,yT,xT,bT,h),i&&(c.uv=su.getInterpolatedAttribute(i,o,l,u,h,new Ln)),s&&(c.uv1=su.getInterpolatedAttribute(s,o,l,u,h,new Ln)),a&&(c.normal=su.getInterpolatedAttribute(a,o,l,u,h,new De),c.normal.dot(r.direction)>0&&c.normal.multiplyScalar(-1));const d={a:o,b:l,c:u,normal:new De,materialIndex:0};su.getNormal(yT,xT,bT,d.normal),c.face=d,c.barycoord=h}return c}class rA extends Ms{constructor(e=1,t=1,r=1,i=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:s,depthSegments:a};const o=this;i=Math.floor(i),s=Math.floor(s),a=Math.floor(a);const l=[],u=[],c=[],h=[];let d=0,f=0;p("z","y","x",-1,-1,r,t,e,a,s,0),p("z","y","x",1,-1,r,t,-e,a,s,1),p("x","z","y",1,1,e,r,t,i,a,2),p("x","z","y",1,-1,e,r,-t,i,a,3),p("x","y","z",1,-1,e,t,r,i,s,4),p("x","y","z",-1,-1,e,t,-r,i,s,5),this.setIndex(l),this.setAttribute("position",new Pi(u,3)),this.setAttribute("normal",new Pi(c,3)),this.setAttribute("uv",new Pi(h,2));function p(m,y,v,b,x,w,_,E,A,T,S){const M=w/A,D=_/T,N=w/2,R=_/2,z=E/2,j=A+1,I=T+1;let F=0,$=0;const H=new De;for(let Z=0;Z<I;Z++){const J=Z*D-R;for(let ee=0;ee<j;ee++){const O=ee*M-N;H[m]=O*b,H[y]=J*x,H[v]=z,u.push(H.x,H.y,H.z),H[m]=0,H[y]=0,H[v]=E>0?1:-1,c.push(H.x,H.y,H.z),h.push(ee/A),h.push(1-Z/T),F+=1}}for(let Z=0;Z<T;Z++)for(let J=0;J<A;J++){const ee=d+J+j*Z,O=d+J+j*(Z+1),ue=d+(J+1)+j*(Z+1),Q=d+(J+1)+j*Z;l.push(ee,O,Q),l.push(O,ue,Q),$+=6}o.addGroup(f,$,S),f+=$,d+=F}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new rA(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function xb(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const i=n[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(Ht("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=i.clone():Array.isArray(i)?e[t][r]=i.slice():e[t][r]=i}}return e}function ha(n){const e={};for(let t=0;t<n.length;t++){const r=xb(n[t]);for(const i in r)e[i]=r[i]}return e}function P1e(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function Hee(n){const e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Rn.workingColorSpace}const F1e={clone:xb,merge:ha};var L1e=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,O1e=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Cc extends Xp{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=L1e,this.fragmentShader=O1e,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=xb(e.uniforms),this.uniformsGroups=P1e(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const a=this.uniforms[i].value;a&&a.isTexture?t.uniforms[i]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[i]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[i]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[i]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[i]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[i]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[i]={type:"m4",value:a.toArray()}:t.uniforms[i]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class Gee extends Zs{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Rr,this.projectionMatrix=new Rr,this.projectionMatrixInverse=new Rr,this.coordinateSystem=uc,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const $d=new De,g9=new Ln,v9=new Ln;class Io extends Gee{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=dO*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(pI*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return dO*2*Math.atan(Math.tan(pI*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,r){$d.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set($d.x,$d.y).multiplyScalar(-e/$d.z),$d.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set($d.x,$d.y).multiplyScalar(-e/$d.z)}getViewSize(e,t){return this.getViewBounds(e,g9,v9),t.subVectors(v9,g9)}setViewOffset(e,t,r,i,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(pI*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,s=-.5*i;const a=this.view;if(this.view!==null&&this.view.enabled){const l=a.fullWidth,u=a.fullHeight;s+=a.offsetX*i/l,t-=a.offsetY*r/u,i*=a.width/l,r*=a.height/u}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-r,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const v0=-90,y0=1;class k1e extends Zs{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new Io(v0,y0,e,t);i.layers=this.layers,this.add(i);const s=new Io(v0,y0,e,t);s.layers=this.layers,this.add(s);const a=new Io(v0,y0,e,t);a.layers=this.layers,this.add(a);const o=new Io(v0,y0,e,t);o.layers=this.layers,this.add(o);const l=new Io(v0,y0,e,t);l.layers=this.layers,this.add(l);const u=new Io(v0,y0,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,i,s,a,o,l]=t;for(const u of t)this.remove(u);if(e===uc)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===TD)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of t)this.add(u),u.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,o,l,u,c]=this.children,h=e.getRenderTarget(),d=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const m=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(t,s),e.setRenderTarget(r,1,i),e.render(t,a),e.setRenderTarget(r,2,i),e.render(t,o),e.setRenderTarget(r,3,i),e.render(t,l),e.setRenderTarget(r,4,i),e.render(t,u),r.texture.generateMipmaps=m,e.setRenderTarget(r,5,i),e.render(t,c),e.setRenderTarget(h,d,f),e.xr.enabled=p,r.texture.needsPMREMUpdate=!0}}class jee extends wa{constructor(e=[],t=Nv,r,i,s,a,o,l,u,c){super(e,t,r,i,s,a,o,l,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class qee extends Ec{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new jee(i),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new rA(5,5,5),s=new Cc({name:"CubemapFromEquirect",uniforms:xb(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:to,blending:Kh});s.uniforms.tEquirect.value=t;const a=new cr(i,s),o=t.minFilter;return t.minFilter===Hm&&(t.minFilter=Qs),new k1e(1,10,this).update(e,a),t.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,t=!0,r=!0,i=!0){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,r,i);e.setRenderTarget(s)}}class ST extends Zs{constructor(){super(),this.isGroup=!0,this.type="Group"}}const B1e={type:"move"};class OI{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ST,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ST,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new De,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new De),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ST,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new De,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new De),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,s=null,a=null;const o=this._targetRay,l=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){a=!0;for(const m of e.hand.values()){const y=t.getJointPose(m,r),v=this._getHandJoint(u,m);y!==null&&(v.matrix.fromArray(y.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.matrixWorldNeedsUpdate=!0,v.jointRadius=y.radius),v.visible=y!==null}const c=u.joints["index-finger-tip"],h=u.joints["thumb-tip"],d=c.position.distanceTo(h.position),f=.02,p=.005;u.inputState.pinching&&d>f+p?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&d<=f-p&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,r),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));o!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(B1e)))}return o!==null&&(o.visible=i!==null),l!==null&&(l.visible=s!==null),u!==null&&(u.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const r=new ST;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}class Lu{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new Bt(e),this.near=t,this.far=r}clone(){return new Lu(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Gc extends Zs{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new gu,this.environmentIntensity=1,this.environmentRotation=new gu,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class U1e extends wa{constructor(e=null,t=1,r=1,i,s,a,o,l,u=ws,c=ws,h,d){super(null,a,o,l,u,c,i,s,h,d),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const kI=new De,V1e=new De,z1e=new sn;class Dm{constructor(e=new De(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const i=kI.subVectors(r,t).cross(V1e.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(kI),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(e.start).addScaledVector(r,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||z1e.getNormalMatrix(e),i=this.coplanarPoint(kI).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const xm=new nA,$1e=new Ln(.5,.5),AT=new De;class $4{constructor(e=new Dm,t=new Dm,r=new Dm,i=new Dm,s=new Dm,a=new Dm){this.planes=[e,t,r,i,s,a]}set(e,t,r,i,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(r),o[3].copy(i),o[4].copy(s),o[5].copy(a),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=uc,r=!1){const i=this.planes,s=e.elements,a=s[0],o=s[1],l=s[2],u=s[3],c=s[4],h=s[5],d=s[6],f=s[7],p=s[8],m=s[9],y=s[10],v=s[11],b=s[12],x=s[13],w=s[14],_=s[15];if(i[0].setComponents(u-a,f-c,v-p,_-b).normalize(),i[1].setComponents(u+a,f+c,v+p,_+b).normalize(),i[2].setComponents(u+o,f+h,v+m,_+x).normalize(),i[3].setComponents(u-o,f-h,v-m,_-x).normalize(),r)i[4].setComponents(l,d,y,w).normalize(),i[5].setComponents(u-l,f-d,v-y,_-w).normalize();else if(i[4].setComponents(u-l,f-d,v-y,_-w).normalize(),t===uc)i[5].setComponents(u+l,f+d,v+y,_+w).normalize();else if(t===TD)i[5].setComponents(l,d,y,w).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),xm.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),xm.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(xm)}intersectsSprite(e){xm.center.set(0,0,0);const t=$1e.distanceTo(e.center);return xm.radius=.7071067811865476+t,xm.applyMatrix4(e.matrixWorld),this.intersectsSphere(xm)}intersectsSphere(e){const t=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const i=t[r];if(AT.x=i.normal.x>0?e.max.x:e.min.x,AT.y=i.normal.y>0?e.max.y:e.min.y,AT.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(AT)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class Wee extends Xp{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Bt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const CD=new De,DD=new De,y9=new Rr,M_=new z4,TT=new nA,BI=new De,x9=new De;class H1e extends Zs{constructor(e=new Ms,t=new Wee){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[0];for(let i=1,s=t.count;i<s;i++)CD.fromBufferAttribute(t,i-1),DD.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=CD.distanceTo(DD);e.setAttribute("lineDistance",new Pi(r,1))}else Ht("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),TT.copy(r.boundingSphere),TT.applyMatrix4(i),TT.radius+=s,e.ray.intersectsSphere(TT)===!1)return;y9.copy(i).invert(),M_.copy(e.ray).applyMatrix4(y9);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,u=this.isLineSegments?2:1,c=r.index,d=r.attributes.position;if(c!==null){const f=Math.max(0,a.start),p=Math.min(c.count,a.start+a.count);for(let m=f,y=p-1;m<y;m+=u){const v=c.getX(m),b=c.getX(m+1),x=MT(this,e,M_,l,v,b,m);x&&t.push(x)}if(this.isLineLoop){const m=c.getX(p-1),y=c.getX(f),v=MT(this,e,M_,l,m,y,p-1);v&&t.push(v)}}else{const f=Math.max(0,a.start),p=Math.min(d.count,a.start+a.count);for(let m=f,y=p-1;m<y;m+=u){const v=MT(this,e,M_,l,m,m+1,m);v&&t.push(v)}if(this.isLineLoop){const m=MT(this,e,M_,l,p-1,f,p-1);m&&t.push(m)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function MT(n,e,t,r,i,s,a){const o=n.geometry.attributes.position;if(CD.fromBufferAttribute(o,i),DD.fromBufferAttribute(o,s),t.distanceSqToSegment(CD,DD,BI,x9)>r)return;BI.applyMatrix4(n.matrixWorld);const u=e.ray.origin.distanceTo(BI);if(!(u<e.near||u>e.far))return{distance:u,point:x9.clone().applyMatrix4(n.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:n}}class fO extends Xp{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Bt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const b9=new Rr,pO=new z4,CT=new nA,DT=new De;class _9 extends Zs{constructor(e=new Ms,t=new fO){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),CT.copy(r.boundingSphere),CT.applyMatrix4(i),CT.radius+=s,e.ray.intersectsSphere(CT)===!1)return;b9.copy(i).invert(),pO.copy(e.ray).applyMatrix4(b9);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,u=r.index,h=r.attributes.position;if(u!==null){const d=Math.max(0,a.start),f=Math.min(u.count,a.start+a.count);for(let p=d,m=f;p<m;p++){const y=u.getX(p);DT.fromBufferAttribute(h,y),w9(DT,y,l,i,e,t,this)}}else{const d=Math.max(0,a.start),f=Math.min(h.count,a.start+a.count);for(let p=d,m=f;p<m;p++)DT.fromBufferAttribute(h,p),w9(DT,p,l,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function w9(n,e,t,r,i,s,a){const o=pO.distanceSqToPoint(n);if(o<t){const l=new De;pO.closestPointToPoint(n,l),l.applyMatrix4(r);const u=i.ray.origin.distanceTo(l);if(u<i.near||u>i.far)return;s.push({distance:u,distanceToRay:Math.sqrt(o),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}class Cw extends wa{constructor(e,t,r=Mc,i,s,a,o=ws,l=ws,u,c=md,h=1){if(c!==md&&c!==Gm)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const d={width:e,height:t,depth:h};super(d,i,s,a,o,l,c,r,u),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new V4(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class G1e extends Cw{constructor(e,t=Mc,r=Nv,i,s,a=ws,o=ws,l,u=md){const c={width:e,height:e,depth:1},h=[c,c,c,c,c,c];super(e,e,t,r,i,s,a,o,l,u),this.image=h,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class Xee extends wa{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class H4 extends Ms{constructor(e=1,t=1,r=1,i=32,s=1,a=!1,o=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l};const u=this;i=Math.floor(i),s=Math.floor(s);const c=[],h=[],d=[],f=[];let p=0;const m=[],y=r/2;let v=0;b(),a===!1&&(e>0&&x(!0),t>0&&x(!1)),this.setIndex(c),this.setAttribute("position",new Pi(h,3)),this.setAttribute("normal",new Pi(d,3)),this.setAttribute("uv",new Pi(f,2));function b(){const w=new De,_=new De;let E=0;const A=(t-e)/r;for(let T=0;T<=s;T++){const S=[],M=T/s,D=M*(t-e)+e;for(let N=0;N<=i;N++){const R=N/i,z=R*l+o,j=Math.sin(z),I=Math.cos(z);_.x=D*j,_.y=-M*r+y,_.z=D*I,h.push(_.x,_.y,_.z),w.set(j,A,I).normalize(),d.push(w.x,w.y,w.z),f.push(R,1-M),S.push(p++)}m.push(S)}for(let T=0;T<i;T++)for(let S=0;S<s;S++){const M=m[S][T],D=m[S+1][T],N=m[S+1][T+1],R=m[S][T+1];(e>0||S!==0)&&(c.push(M,D,R),E+=3),(t>0||S!==s-1)&&(c.push(D,N,R),E+=3)}u.addGroup(v,E,0),v+=E}function x(w){const _=p,E=new Ln,A=new De;let T=0;const S=w===!0?e:t,M=w===!0?1:-1;for(let N=1;N<=i;N++)h.push(0,y*M,0),d.push(0,M,0),f.push(.5,.5),p++;const D=p;for(let N=0;N<=i;N++){const z=N/i*l+o,j=Math.cos(z),I=Math.sin(z);A.x=S*I,A.y=y*M,A.z=S*j,h.push(A.x,A.y,A.z),d.push(0,M,0),E.x=j*.5+.5,E.y=I*.5*M+.5,f.push(E.x,E.y),p++}for(let N=0;N<i;N++){const R=_+N,z=D+N;w===!0?c.push(z,z+1,R):c.push(z+1,z,R),T+=3}u.addGroup(v,T,w===!0?1:2),v+=T}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new H4(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class G4 extends H4{constructor(e=1,t=1,r=32,i=1,s=!1,a=0,o=Math.PI*2){super(0,e,t,r,i,s,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:s,thetaStart:a,thetaLength:o}}static fromJSON(e){return new G4(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class SN extends Ms{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};const s=e/2,a=t/2,o=Math.floor(r),l=Math.floor(i),u=o+1,c=l+1,h=e/o,d=t/l,f=[],p=[],m=[],y=[];for(let v=0;v<c;v++){const b=v*d-a;for(let x=0;x<u;x++){const w=x*h-s;p.push(w,-b,0),m.push(0,0,1),y.push(x/o),y.push(1-v/l)}}for(let v=0;v<l;v++)for(let b=0;b<o;b++){const x=b+u*v,w=b+u*(v+1),_=b+1+u*(v+1),E=b+1+u*v;f.push(x,w,E),f.push(w,_,E)}this.setIndex(f),this.setAttribute("position",new Pi(p,3)),this.setAttribute("normal",new Pi(m,3)),this.setAttribute("uv",new Pi(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new SN(e.width,e.height,e.widthSegments,e.heightSegments)}}class zl extends Ms{constructor(e=1,t=32,r=16,i=0,s=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:s,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const l=Math.min(a+o,Math.PI);let u=0;const c=[],h=new De,d=new De,f=[],p=[],m=[],y=[];for(let v=0;v<=r;v++){const b=[],x=v/r;let w=0;v===0&&a===0?w=.5/t:v===r&&l===Math.PI&&(w=-.5/t);for(let _=0;_<=t;_++){const E=_/t;h.x=-e*Math.cos(i+E*s)*Math.sin(a+x*o),h.y=e*Math.cos(a+x*o),h.z=e*Math.sin(i+E*s)*Math.sin(a+x*o),p.push(h.x,h.y,h.z),d.copy(h).normalize(),m.push(d.x,d.y,d.z),y.push(E+w,1-x),b.push(u++)}c.push(b)}for(let v=0;v<r;v++)for(let b=0;b<t;b++){const x=c[v][b+1],w=c[v][b],_=c[v+1][b],E=c[v+1][b+1];(v!==0||a>0)&&f.push(x,w,E),(v!==r-1||l<Math.PI)&&f.push(w,_,E)}this.setIndex(f),this.setAttribute("position",new Pi(p,3)),this.setAttribute("normal",new Pi(m,3)),this.setAttribute("uv",new Pi(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new zl(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Zc extends Ms{constructor(e=1,t=.4,r=12,i=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:s},r=Math.floor(r),i=Math.floor(i);const a=[],o=[],l=[],u=[],c=new De,h=new De,d=new De;for(let f=0;f<=r;f++)for(let p=0;p<=i;p++){const m=p/i*s,y=f/r*Math.PI*2;h.x=(e+t*Math.cos(y))*Math.cos(m),h.y=(e+t*Math.cos(y))*Math.sin(m),h.z=t*Math.sin(y),o.push(h.x,h.y,h.z),c.x=e*Math.cos(m),c.y=e*Math.sin(m),d.subVectors(h,c).normalize(),l.push(d.x,d.y,d.z),u.push(p/i),u.push(f/r)}for(let f=1;f<=r;f++)for(let p=1;p<=i;p++){const m=(i+1)*f+p-1,y=(i+1)*(f-1)+p-1,v=(i+1)*(f-1)+p,b=(i+1)*f+p;a.push(m,y,b),a.push(y,v,b)}this.setIndex(a),this.setAttribute("position",new Pi(o,3)),this.setAttribute("normal",new Pi(l,3)),this.setAttribute("uv",new Pi(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Zc(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class j1e extends Cc{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Ru extends Xp{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Bt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Bt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=k4,this.normalScale=new Ln(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new gu,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class q1e extends Xp{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Bt(16777215),this.specular=new Bt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Bt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=k4,this.normalScale=new Ln(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new gu,this.combine=N4,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class W1e extends Xp{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=s1e,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class X1e extends Xp{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class Kee extends Zs{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Bt(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}const UI=new Rr,E9=new De,S9=new De;class K1e{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ln(512,512),this.mapType=Lo,this.map=null,this.mapPass=null,this.matrix=new Rr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new $4,this._frameExtents=new Ln(1,1),this._viewportCount=1,this._viewports=[new Zr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;E9.setFromMatrixPosition(e.matrixWorld),t.position.copy(E9),S9.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(S9),t.updateMatrixWorld(),UI.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(UI,t.coordinateSystem,t.reversedDepth),t.reversedDepth?r.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(UI)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Y1e extends K1e{constructor(){super(new Io(90,1,.5,500)),this.isPointLightShadow=!0}}class ua extends Kee{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new Y1e}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class Yee extends Gee{constructor(e=-1,t=1,r=1,i=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,a=r+e,o=i+t,l=i-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,a=s+u*this.view.width,o-=c*this.view.offsetY,l=o-c*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,l,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class jc extends Kee{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Q1e extends Io{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}function A9(n,e,t,r){const i=Z1e(r);switch(t){case Fee:return n*e;case Oee:return n*e/i.components*i.byteLength;case F4:return n*e/i.components*i.byteLength;case vb:return n*e*2/i.components*i.byteLength;case L4:return n*e*2/i.components*i.byteLength;case Lee:return n*e*3/i.components*i.byteLength;case lu:return n*e*4/i.components*i.byteLength;case O4:return n*e*4/i.components*i.byteLength;case oC:case lC:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case uC:case cC:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case LL:case kL:return Math.max(n,16)*Math.max(e,8)/4;case FL:case OL:return Math.max(n,8)*Math.max(e,8)/2;case BL:case UL:case zL:case $L:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case VL:case HL:case GL:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case jL:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case qL:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case WL:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case XL:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case KL:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case YL:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case QL:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case ZL:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case JL:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case eO:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case tO:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case nO:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case rO:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case iO:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case sO:case aO:case oO:return Math.ceil(n/4)*Math.ceil(e/4)*16;case lO:case uO:return Math.ceil(n/4)*Math.ceil(e/4)*8;case cO:case hO:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function Z1e(n){switch(n){case Lo:case Nee:return{byteLength:1,components:1};case Aw:case Ree:case pd:return{byteLength:2,components:1};case I4:case P4:return{byteLength:2,components:4};case Mc:case R4:case lc:return{byteLength:4,components:1};case Iee:case Pee:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:D4}}));typeof window<"u"&&(window.__THREE__?Ht("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=D4);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function Qee(){let n=null,e=!1,t=null,r=null;function i(s,a){t(s,a),r=n.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(i),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function J1e(n){const e=new WeakMap;function t(o,l){const u=o.array,c=o.usage,h=u.byteLength,d=n.createBuffer();n.bindBuffer(l,d),n.bufferData(l,u,c),o.onUploadCallback();let f;if(u instanceof Float32Array)f=n.FLOAT;else if(typeof Float16Array<"u"&&u instanceof Float16Array)f=n.HALF_FLOAT;else if(u instanceof Uint16Array)o.isFloat16BufferAttribute?f=n.HALF_FLOAT:f=n.UNSIGNED_SHORT;else if(u instanceof Int16Array)f=n.SHORT;else if(u instanceof Uint32Array)f=n.UNSIGNED_INT;else if(u instanceof Int32Array)f=n.INT;else if(u instanceof Int8Array)f=n.BYTE;else if(u instanceof Uint8Array)f=n.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)f=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:d,type:f,bytesPerElement:u.BYTES_PER_ELEMENT,version:o.version,size:h}}function r(o,l,u){const c=l.array,h=l.updateRanges;if(n.bindBuffer(u,o),h.length===0)n.bufferSubData(u,0,c);else{h.sort((f,p)=>f.start-p.start);let d=0;for(let f=1;f<h.length;f++){const p=h[d],m=h[f];m.start<=p.start+p.count+1?p.count=Math.max(p.count,m.start+m.count-p.start):(++d,h[d]=m)}h.length=d+1;for(let f=0,p=h.length;f<p;f++){const m=h[f];n.bufferSubData(u,m.start*c.BYTES_PER_ELEMENT,c,m.start,m.count)}l.clearUpdateRanges()}l.onUploadCallback()}function i(o){return o.isInterleavedBufferAttribute&&(o=o.data),e.get(o)}function s(o){o.isInterleavedBufferAttribute&&(o=o.data);const l=e.get(o);l&&(n.deleteBuffer(l.buffer),e.delete(o))}function a(o,l){if(o.isInterleavedBufferAttribute&&(o=o.data),o.isGLBufferAttribute){const c=e.get(o);(!c||c.version<o.version)&&e.set(o,{buffer:o.buffer,type:o.type,bytesPerElement:o.elementSize,version:o.version});return}const u=e.get(o);if(u===void 0)e.set(o,t(o,l));else if(u.version<o.version){if(u.size!==o.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");r(u.buffer,o,l),u.version=o.version}}return{get:i,remove:s,update:a}}var ewe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,twe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,nwe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,rwe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,iwe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,swe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,awe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,owe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,lwe=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,uwe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,cwe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,hwe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,dwe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,fwe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,pwe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,mwe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,gwe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,vwe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,ywe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,xwe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,bwe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,_we=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,wwe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Ewe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Swe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Awe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Twe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Mwe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Cwe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Dwe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Nwe="gl_FragColor = linearToOutputTexel( gl_FragColor );",Rwe=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Iwe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Pwe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,Fwe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Lwe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Owe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,kwe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Bwe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Uwe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Vwe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,zwe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,$we=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Hwe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Gwe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,jwe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,qwe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Wwe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Xwe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Kwe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Ywe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Qwe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,Zwe=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Jwe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,eEe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,tEe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,nEe=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,rEe=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,iEe=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,sEe=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,aEe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,oEe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,lEe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,uEe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,cEe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,hEe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,dEe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,fEe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,pEe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,mEe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,gEe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,vEe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,yEe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,xEe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,bEe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,_Ee=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,wEe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,EEe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,SEe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,AEe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,TEe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,MEe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,CEe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,DEe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,NEe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,REe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,IEe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,PEe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,FEe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,LEe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadow = step( depth, dp );
			#else
				shadow = step( dp, depth );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,OEe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,kEe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,BEe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,UEe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,VEe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,zEe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,$Ee=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,HEe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,GEe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,jEe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,qEe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,WEe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,XEe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,KEe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,YEe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,QEe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,ZEe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const JEe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,eSe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,tSe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,nSe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,rSe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,iSe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,sSe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,aSe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,oSe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,lSe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,uSe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,cSe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,hSe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,dSe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,fSe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,pSe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,mSe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,gSe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vSe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,ySe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,xSe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,bSe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,_Se=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,wSe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ESe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,SSe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ASe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,TSe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,MSe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,CSe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,DSe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,NSe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,RSe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,ISe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,un={alphahash_fragment:ewe,alphahash_pars_fragment:twe,alphamap_fragment:nwe,alphamap_pars_fragment:rwe,alphatest_fragment:iwe,alphatest_pars_fragment:swe,aomap_fragment:awe,aomap_pars_fragment:owe,batching_pars_vertex:lwe,batching_vertex:uwe,begin_vertex:cwe,beginnormal_vertex:hwe,bsdfs:dwe,iridescence_fragment:fwe,bumpmap_pars_fragment:pwe,clipping_planes_fragment:mwe,clipping_planes_pars_fragment:gwe,clipping_planes_pars_vertex:vwe,clipping_planes_vertex:ywe,color_fragment:xwe,color_pars_fragment:bwe,color_pars_vertex:_we,color_vertex:wwe,common:Ewe,cube_uv_reflection_fragment:Swe,defaultnormal_vertex:Awe,displacementmap_pars_vertex:Twe,displacementmap_vertex:Mwe,emissivemap_fragment:Cwe,emissivemap_pars_fragment:Dwe,colorspace_fragment:Nwe,colorspace_pars_fragment:Rwe,envmap_fragment:Iwe,envmap_common_pars_fragment:Pwe,envmap_pars_fragment:Fwe,envmap_pars_vertex:Lwe,envmap_physical_pars_fragment:qwe,envmap_vertex:Owe,fog_vertex:kwe,fog_pars_vertex:Bwe,fog_fragment:Uwe,fog_pars_fragment:Vwe,gradientmap_pars_fragment:zwe,lightmap_pars_fragment:$we,lights_lambert_fragment:Hwe,lights_lambert_pars_fragment:Gwe,lights_pars_begin:jwe,lights_toon_fragment:Wwe,lights_toon_pars_fragment:Xwe,lights_phong_fragment:Kwe,lights_phong_pars_fragment:Ywe,lights_physical_fragment:Qwe,lights_physical_pars_fragment:Zwe,lights_fragment_begin:Jwe,lights_fragment_maps:eEe,lights_fragment_end:tEe,logdepthbuf_fragment:nEe,logdepthbuf_pars_fragment:rEe,logdepthbuf_pars_vertex:iEe,logdepthbuf_vertex:sEe,map_fragment:aEe,map_pars_fragment:oEe,map_particle_fragment:lEe,map_particle_pars_fragment:uEe,metalnessmap_fragment:cEe,metalnessmap_pars_fragment:hEe,morphinstance_vertex:dEe,morphcolor_vertex:fEe,morphnormal_vertex:pEe,morphtarget_pars_vertex:mEe,morphtarget_vertex:gEe,normal_fragment_begin:vEe,normal_fragment_maps:yEe,normal_pars_fragment:xEe,normal_pars_vertex:bEe,normal_vertex:_Ee,normalmap_pars_fragment:wEe,clearcoat_normal_fragment_begin:EEe,clearcoat_normal_fragment_maps:SEe,clearcoat_pars_fragment:AEe,iridescence_pars_fragment:TEe,opaque_fragment:MEe,packing:CEe,premultiplied_alpha_fragment:DEe,project_vertex:NEe,dithering_fragment:REe,dithering_pars_fragment:IEe,roughnessmap_fragment:PEe,roughnessmap_pars_fragment:FEe,shadowmap_pars_fragment:LEe,shadowmap_pars_vertex:OEe,shadowmap_vertex:kEe,shadowmask_pars_fragment:BEe,skinbase_vertex:UEe,skinning_pars_vertex:VEe,skinning_vertex:zEe,skinnormal_vertex:$Ee,specularmap_fragment:HEe,specularmap_pars_fragment:GEe,tonemapping_fragment:jEe,tonemapping_pars_fragment:qEe,transmission_fragment:WEe,transmission_pars_fragment:XEe,uv_pars_fragment:KEe,uv_pars_vertex:YEe,uv_vertex:QEe,worldpos_vertex:ZEe,background_vert:JEe,background_frag:eSe,backgroundCube_vert:tSe,backgroundCube_frag:nSe,cube_vert:rSe,cube_frag:iSe,depth_vert:sSe,depth_frag:aSe,distance_vert:oSe,distance_frag:lSe,equirect_vert:uSe,equirect_frag:cSe,linedashed_vert:hSe,linedashed_frag:dSe,meshbasic_vert:fSe,meshbasic_frag:pSe,meshlambert_vert:mSe,meshlambert_frag:gSe,meshmatcap_vert:vSe,meshmatcap_frag:ySe,meshnormal_vert:xSe,meshnormal_frag:bSe,meshphong_vert:_Se,meshphong_frag:wSe,meshphysical_vert:ESe,meshphysical_frag:SSe,meshtoon_vert:ASe,meshtoon_frag:TSe,points_vert:MSe,points_frag:CSe,shadow_vert:DSe,shadow_frag:NSe,sprite_vert:RSe,sprite_frag:ISe},lt={common:{diffuse:{value:new Bt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new sn},alphaMap:{value:null},alphaMapTransform:{value:new sn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new sn}},envmap:{envMap:{value:null},envMapRotation:{value:new sn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new sn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new sn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new sn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new sn},normalScale:{value:new Ln(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new sn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new sn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new sn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new sn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Bt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Bt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new sn},alphaTest:{value:0},uvTransform:{value:new sn}},sprite:{diffuse:{value:new Bt(16777215)},opacity:{value:1},center:{value:new Ln(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new sn},alphaMap:{value:null},alphaMapTransform:{value:new sn},alphaTest:{value:0}}},sc={basic:{uniforms:ha([lt.common,lt.specularmap,lt.envmap,lt.aomap,lt.lightmap,lt.fog]),vertexShader:un.meshbasic_vert,fragmentShader:un.meshbasic_frag},lambert:{uniforms:ha([lt.common,lt.specularmap,lt.envmap,lt.aomap,lt.lightmap,lt.emissivemap,lt.bumpmap,lt.normalmap,lt.displacementmap,lt.fog,lt.lights,{emissive:{value:new Bt(0)}}]),vertexShader:un.meshlambert_vert,fragmentShader:un.meshlambert_frag},phong:{uniforms:ha([lt.common,lt.specularmap,lt.envmap,lt.aomap,lt.lightmap,lt.emissivemap,lt.bumpmap,lt.normalmap,lt.displacementmap,lt.fog,lt.lights,{emissive:{value:new Bt(0)},specular:{value:new Bt(1118481)},shininess:{value:30}}]),vertexShader:un.meshphong_vert,fragmentShader:un.meshphong_frag},standard:{uniforms:ha([lt.common,lt.envmap,lt.aomap,lt.lightmap,lt.emissivemap,lt.bumpmap,lt.normalmap,lt.displacementmap,lt.roughnessmap,lt.metalnessmap,lt.fog,lt.lights,{emissive:{value:new Bt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:un.meshphysical_vert,fragmentShader:un.meshphysical_frag},toon:{uniforms:ha([lt.common,lt.aomap,lt.lightmap,lt.emissivemap,lt.bumpmap,lt.normalmap,lt.displacementmap,lt.gradientmap,lt.fog,lt.lights,{emissive:{value:new Bt(0)}}]),vertexShader:un.meshtoon_vert,fragmentShader:un.meshtoon_frag},matcap:{uniforms:ha([lt.common,lt.bumpmap,lt.normalmap,lt.displacementmap,lt.fog,{matcap:{value:null}}]),vertexShader:un.meshmatcap_vert,fragmentShader:un.meshmatcap_frag},points:{uniforms:ha([lt.points,lt.fog]),vertexShader:un.points_vert,fragmentShader:un.points_frag},dashed:{uniforms:ha([lt.common,lt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:un.linedashed_vert,fragmentShader:un.linedashed_frag},depth:{uniforms:ha([lt.common,lt.displacementmap]),vertexShader:un.depth_vert,fragmentShader:un.depth_frag},normal:{uniforms:ha([lt.common,lt.bumpmap,lt.normalmap,lt.displacementmap,{opacity:{value:1}}]),vertexShader:un.meshnormal_vert,fragmentShader:un.meshnormal_frag},sprite:{uniforms:ha([lt.sprite,lt.fog]),vertexShader:un.sprite_vert,fragmentShader:un.sprite_frag},background:{uniforms:{uvTransform:{value:new sn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:un.background_vert,fragmentShader:un.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new sn}},vertexShader:un.backgroundCube_vert,fragmentShader:un.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:un.cube_vert,fragmentShader:un.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:un.equirect_vert,fragmentShader:un.equirect_frag},distance:{uniforms:ha([lt.common,lt.displacementmap,{referencePosition:{value:new De},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:un.distance_vert,fragmentShader:un.distance_frag},shadow:{uniforms:ha([lt.lights,lt.fog,{color:{value:new Bt(0)},opacity:{value:1}}]),vertexShader:un.shadow_vert,fragmentShader:un.shadow_frag}};sc.physical={uniforms:ha([sc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new sn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new sn},clearcoatNormalScale:{value:new Ln(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new sn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new sn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new sn},sheen:{value:0},sheenColor:{value:new Bt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new sn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new sn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new sn},transmissionSamplerSize:{value:new Ln},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new sn},attenuationDistance:{value:0},attenuationColor:{value:new Bt(0)},specularColor:{value:new Bt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new sn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new sn},anisotropyVector:{value:new Ln},anisotropyMap:{value:null},anisotropyMapTransform:{value:new sn}}]),vertexShader:un.meshphysical_vert,fragmentShader:un.meshphysical_frag};const NT={r:0,b:0,g:0},bm=new gu,PSe=new Rr;function FSe(n,e,t,r,i,s,a){const o=new Bt(0);let l=s===!0?0:1,u,c,h=null,d=0,f=null;function p(x){let w=x.isScene===!0?x.background:null;return w&&w.isTexture&&(w=(x.backgroundBlurriness>0?t:e).get(w)),w}function m(x){let w=!1;const _=p(x);_===null?v(o,l):_&&_.isColor&&(v(_,1),w=!0);const E=n.xr.getEnvironmentBlendMode();E==="additive"?r.buffers.color.setClear(0,0,0,1,a):E==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,a),(n.autoClear||w)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function y(x,w){const _=p(w);_&&(_.isCubeTexture||_.mapping===EN)?(c===void 0&&(c=new cr(new rA(1,1,1),new Cc({name:"BackgroundCubeMaterial",uniforms:xb(sc.backgroundCube.uniforms),vertexShader:sc.backgroundCube.vertexShader,fragmentShader:sc.backgroundCube.fragmentShader,side:to,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(E,A,T){this.matrixWorld.copyPosition(T.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),bm.copy(w.backgroundRotation),bm.x*=-1,bm.y*=-1,bm.z*=-1,_.isCubeTexture&&_.isRenderTargetTexture===!1&&(bm.y*=-1,bm.z*=-1),c.material.uniforms.envMap.value=_,c.material.uniforms.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,c.material.uniforms.backgroundBlurriness.value=w.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(PSe.makeRotationFromEuler(bm)),c.material.toneMapped=Rn.getTransfer(_.colorSpace)!==qn,(h!==_||d!==_.version||f!==n.toneMapping)&&(c.material.needsUpdate=!0,h=_,d=_.version,f=n.toneMapping),c.layers.enableAll(),x.unshift(c,c.geometry,c.material,0,0,null)):_&&_.isTexture&&(u===void 0&&(u=new cr(new SN(2,2),new Cc({name:"BackgroundMaterial",uniforms:xb(sc.background.uniforms),vertexShader:sc.background.vertexShader,fragmentShader:sc.background.fragmentShader,side:Pp,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(u)),u.material.uniforms.t2D.value=_,u.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,u.material.toneMapped=Rn.getTransfer(_.colorSpace)!==qn,_.matrixAutoUpdate===!0&&_.updateMatrix(),u.material.uniforms.uvTransform.value.copy(_.matrix),(h!==_||d!==_.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,h=_,d=_.version,f=n.toneMapping),u.layers.enableAll(),x.unshift(u,u.geometry,u.material,0,0,null))}function v(x,w){x.getRGB(NT,Hee(n)),r.buffers.color.setClear(NT.r,NT.g,NT.b,w,a)}function b(){c!==void 0&&(c.geometry.dispose(),c.material.dispose(),c=void 0),u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0)}return{getClearColor:function(){return o},setClearColor:function(x,w=1){o.set(x),l=w,v(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(x){l=x,v(o,l)},render:m,addToRenderList:y,dispose:b}}function LSe(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),r={},i=d(null);let s=i,a=!1;function o(M,D,N,R,z){let j=!1;const I=h(R,N,D);s!==I&&(s=I,u(s.object)),j=f(M,R,N,z),j&&p(M,R,N,z),z!==null&&e.update(z,n.ELEMENT_ARRAY_BUFFER),(j||a)&&(a=!1,w(M,D,N,R),z!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(z).buffer))}function l(){return n.createVertexArray()}function u(M){return n.bindVertexArray(M)}function c(M){return n.deleteVertexArray(M)}function h(M,D,N){const R=N.wireframe===!0;let z=r[M.id];z===void 0&&(z={},r[M.id]=z);let j=z[D.id];j===void 0&&(j={},z[D.id]=j);let I=j[R];return I===void 0&&(I=d(l()),j[R]=I),I}function d(M){const D=[],N=[],R=[];for(let z=0;z<t;z++)D[z]=0,N[z]=0,R[z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:D,enabledAttributes:N,attributeDivisors:R,object:M,attributes:{},index:null}}function f(M,D,N,R){const z=s.attributes,j=D.attributes;let I=0;const F=N.getAttributes();for(const $ in F)if(F[$].location>=0){const Z=z[$];let J=j[$];if(J===void 0&&($==="instanceMatrix"&&M.instanceMatrix&&(J=M.instanceMatrix),$==="instanceColor"&&M.instanceColor&&(J=M.instanceColor)),Z===void 0||Z.attribute!==J||J&&Z.data!==J.data)return!0;I++}return s.attributesNum!==I||s.index!==R}function p(M,D,N,R){const z={},j=D.attributes;let I=0;const F=N.getAttributes();for(const $ in F)if(F[$].location>=0){let Z=j[$];Z===void 0&&($==="instanceMatrix"&&M.instanceMatrix&&(Z=M.instanceMatrix),$==="instanceColor"&&M.instanceColor&&(Z=M.instanceColor));const J={};J.attribute=Z,Z&&Z.data&&(J.data=Z.data),z[$]=J,I++}s.attributes=z,s.attributesNum=I,s.index=R}function m(){const M=s.newAttributes;for(let D=0,N=M.length;D<N;D++)M[D]=0}function y(M){v(M,0)}function v(M,D){const N=s.newAttributes,R=s.enabledAttributes,z=s.attributeDivisors;N[M]=1,R[M]===0&&(n.enableVertexAttribArray(M),R[M]=1),z[M]!==D&&(n.vertexAttribDivisor(M,D),z[M]=D)}function b(){const M=s.newAttributes,D=s.enabledAttributes;for(let N=0,R=D.length;N<R;N++)D[N]!==M[N]&&(n.disableVertexAttribArray(N),D[N]=0)}function x(M,D,N,R,z,j,I){I===!0?n.vertexAttribIPointer(M,D,N,z,j):n.vertexAttribPointer(M,D,N,R,z,j)}function w(M,D,N,R){m();const z=R.attributes,j=N.getAttributes(),I=D.defaultAttributeValues;for(const F in j){const $=j[F];if($.location>=0){let H=z[F];if(H===void 0&&(F==="instanceMatrix"&&M.instanceMatrix&&(H=M.instanceMatrix),F==="instanceColor"&&M.instanceColor&&(H=M.instanceColor)),H!==void 0){const Z=H.normalized,J=H.itemSize,ee=e.get(H);if(ee===void 0)continue;const O=ee.buffer,ue=ee.type,Q=ee.bytesPerElement,re=ue===n.INT||ue===n.UNSIGNED_INT||H.gpuType===R4;if(H.isInterleavedBufferAttribute){const le=H.data,te=le.stride,Y=H.offset;if(le.isInstancedInterleavedBuffer){for(let oe=0;oe<$.locationSize;oe++)v($.location+oe,le.meshPerAttribute);M.isInstancedMesh!==!0&&R._maxInstanceCount===void 0&&(R._maxInstanceCount=le.meshPerAttribute*le.count)}else for(let oe=0;oe<$.locationSize;oe++)y($.location+oe);n.bindBuffer(n.ARRAY_BUFFER,O);for(let oe=0;oe<$.locationSize;oe++)x($.location+oe,J/$.locationSize,ue,Z,te*Q,(Y+J/$.locationSize*oe)*Q,re)}else{if(H.isInstancedBufferAttribute){for(let le=0;le<$.locationSize;le++)v($.location+le,H.meshPerAttribute);M.isInstancedMesh!==!0&&R._maxInstanceCount===void 0&&(R._maxInstanceCount=H.meshPerAttribute*H.count)}else for(let le=0;le<$.locationSize;le++)y($.location+le);n.bindBuffer(n.ARRAY_BUFFER,O);for(let le=0;le<$.locationSize;le++)x($.location+le,J/$.locationSize,ue,Z,J*Q,J/$.locationSize*le*Q,re)}}else if(I!==void 0){const Z=I[F];if(Z!==void 0)switch(Z.length){case 2:n.vertexAttrib2fv($.location,Z);break;case 3:n.vertexAttrib3fv($.location,Z);break;case 4:n.vertexAttrib4fv($.location,Z);break;default:n.vertexAttrib1fv($.location,Z)}}}}b()}function _(){T();for(const M in r){const D=r[M];for(const N in D){const R=D[N];for(const z in R)c(R[z].object),delete R[z];delete D[N]}delete r[M]}}function E(M){if(r[M.id]===void 0)return;const D=r[M.id];for(const N in D){const R=D[N];for(const z in R)c(R[z].object),delete R[z];delete D[N]}delete r[M.id]}function A(M){for(const D in r){const N=r[D];if(N[M.id]===void 0)continue;const R=N[M.id];for(const z in R)c(R[z].object),delete R[z];delete N[M.id]}}function T(){S(),a=!0,s!==i&&(s=i,u(s.object))}function S(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:o,reset:T,resetDefaultState:S,dispose:_,releaseStatesOfGeometry:E,releaseStatesOfProgram:A,initAttributes:m,enableAttribute:y,disableUnusedAttributes:b}}function OSe(n,e,t){let r;function i(u){r=u}function s(u,c){n.drawArrays(r,u,c),t.update(c,r,1)}function a(u,c,h){h!==0&&(n.drawArraysInstanced(r,u,c,h),t.update(c,r,h))}function o(u,c,h){if(h===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,u,0,c,0,h);let f=0;for(let p=0;p<h;p++)f+=c[p];t.update(f,r,1)}function l(u,c,h,d){if(h===0)return;const f=e.get("WEBGL_multi_draw");if(f===null)for(let p=0;p<u.length;p++)a(u[p],c[p],d[p]);else{f.multiDrawArraysInstancedWEBGL(r,u,0,c,0,d,0,h);let p=0;for(let m=0;m<h;m++)p+=c[m]*d[m];t.update(p,r,1)}}this.setMode=i,this.render=s,this.renderInstances=a,this.renderMultiDraw=o,this.renderMultiDrawInstances=l}function kSe(n,e,t,r){let i;function s(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const A=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(A.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function a(A){return!(A!==lu&&r.convert(A)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function o(A){const T=A===pd&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(A!==Lo&&r.convert(A)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&A!==lc&&!T)}function l(A){if(A==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";A="mediump"}return A==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u=t.precision!==void 0?t.precision:"highp";const c=l(u);c!==u&&(Ht("WebGLRenderer:",u,"not supported, using",c,"instead."),u=c);const h=t.logarithmicDepthBuffer===!0,d=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),f=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),p=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m=n.getParameter(n.MAX_TEXTURE_SIZE),y=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),v=n.getParameter(n.MAX_VERTEX_ATTRIBS),b=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),x=n.getParameter(n.MAX_VARYING_VECTORS),w=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),_=n.getParameter(n.MAX_SAMPLES),E=n.getParameter(n.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:a,textureTypeReadable:o,precision:u,logarithmicDepthBuffer:h,reversedDepthBuffer:d,maxTextures:f,maxVertexTextures:p,maxTextureSize:m,maxCubemapSize:y,maxAttributes:v,maxVertexUniforms:b,maxVaryings:x,maxFragmentUniforms:w,maxSamples:_,samples:E}}function BSe(n){const e=this;let t=null,r=0,i=!1,s=!1;const a=new Dm,o=new sn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){const f=h.length!==0||d||r!==0||i;return i=d,r=h.length,f},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){t=c(h,d,0)},this.setState=function(h,d,f){const p=h.clippingPlanes,m=h.clipIntersection,y=h.clipShadows,v=n.get(h);if(!i||p===null||p.length===0||s&&!y)s?c(null):u();else{const b=s?0:r,x=b*4;let w=v.clippingState||null;l.value=w,w=c(p,d,x,f);for(let _=0;_!==x;++_)w[_]=t[_];v.clippingState=w,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=b}};function u(){l.value!==t&&(l.value=t,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function c(h,d,f,p){const m=h!==null?h.length:0;let y=null;if(m!==0){if(y=l.value,p!==!0||y===null){const v=f+m*4,b=d.matrixWorldInverse;o.getNormalMatrix(b),(y===null||y.length<v)&&(y=new Float32Array(v));for(let x=0,w=f;x!==m;++x,w+=4)a.copy(h[x]).applyMatrix4(b,o),a.normal.toArray(y,w),y[w+3]=a.constant}l.value=y,l.needsUpdate=!0}return e.numPlanes=m,e.numIntersection=0,y}}function USe(n){let e=new WeakMap;function t(a,o){return o===NL?a.mapping=Nv:o===RL&&(a.mapping=gb),a}function r(a){if(a&&a.isTexture){const o=a.mapping;if(o===NL||o===RL)if(e.has(a)){const l=e.get(a).texture;return t(l,a.mapping)}else{const l=a.image;if(l&&l.height>0){const u=new qee(l.height);return u.fromEquirectangularTexture(n,a),e.set(a,u),a.addEventListener("dispose",i),t(u.texture,a.mapping)}else return null}}return a}function i(a){const o=a.target;o.removeEventListener("dispose",i);const l=e.get(o);l!==void 0&&(e.delete(o),l.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}const tp=4,T9=[.125,.215,.35,.446,.526,.582],Im=20,VSe=256,C_=new Yee,M9=new Bt;let VI=null,zI=0,$I=0,HI=!1;const zSe=new De;class C9{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,r=.1,i=100,s={}){const{size:a=256,position:o=zSe}=s;VI=this._renderer.getRenderTarget(),zI=this._renderer.getActiveCubeFace(),$I=this._renderer.getActiveMipmapLevel(),HI=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,r,i,l,o),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=R9(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=N9(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(VI,zI,$I),this._renderer.xr.enabled=HI,e.scissorTest=!1,x0(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Nv||e.mapping===gb?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),VI=this._renderer.getRenderTarget(),zI=this._renderer.getActiveCubeFace(),$I=this._renderer.getActiveMipmapLevel(),HI=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:Qs,minFilter:Qs,generateMipmaps:!1,type:pd,format:lu,colorSpace:yb,depthBuffer:!1},i=D9(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=D9(e,t,r);const{_lodMax:s}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=$Se(s)),this._blurMaterial=GSe(s,e,t),this._ggxMaterial=HSe(s,e,t)}return i}_compileMaterial(e){const t=new cr(new Ms,e);this._renderer.compile(t,C_)}_sceneToCubeUV(e,t,r,i,s){const l=new Io(90,1,t,r),u=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],h=this._renderer,d=h.autoClear,f=h.toneMapping;h.getClearColor(M9),h.toneMapping=wc,h.autoClear=!1,h.state.buffers.depth.getReversed()&&(h.setRenderTarget(i),h.clearDepth(),h.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new cr(new rA,new Xd({name:"PMREM.Background",side:to,depthWrite:!1,depthTest:!1})));const m=this._backgroundBox,y=m.material;let v=!1;const b=e.background;b?b.isColor&&(y.color.copy(b),e.background=null,v=!0):(y.color.copy(M9),v=!0);for(let x=0;x<6;x++){const w=x%3;w===0?(l.up.set(0,u[x],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x+c[x],s.y,s.z)):w===1?(l.up.set(0,0,u[x]),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y+c[x],s.z)):(l.up.set(0,u[x],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y,s.z+c[x]));const _=this._cubeSize;x0(i,w*_,x>2?_:0,_,_),h.setRenderTarget(i),v&&h.render(m,l),h.render(e,l)}h.toneMapping=f,h.autoClear=d,e.background=b}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===Nv||e.mapping===gb;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=R9()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=N9());const s=i?this._cubemapMaterial:this._equirectMaterial,a=this._lodMeshes[0];a.material=s;const o=s.uniforms;o.envMap.value=e;const l=this._cubeSize;x0(t,0,0,3*l,2*l),r.setRenderTarget(t),r.render(a,C_)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;const i=this._lodMeshes.length;for(let s=1;s<i;s++)this._applyGGXFilter(e,s-1,s);t.autoClear=r}_applyGGXFilter(e,t,r){const i=this._renderer,s=this._pingPongRenderTarget,a=this._ggxMaterial,o=this._lodMeshes[r];o.material=a;const l=a.uniforms,u=r/(this._lodMeshes.length-1),c=t/(this._lodMeshes.length-1),h=Math.sqrt(u*u-c*c),d=0+u*1.25,f=h*d,{_lodMax:p}=this,m=this._sizeLods[r],y=3*m*(r>p-tp?r-p+tp:0),v=4*(this._cubeSize-m);l.envMap.value=e.texture,l.roughness.value=f,l.mipInt.value=p-t,x0(s,y,v,3*m,2*m),i.setRenderTarget(s),i.render(o,C_),l.envMap.value=s.texture,l.roughness.value=0,l.mipInt.value=p-r,x0(e,y,v,3*m,2*m),i.setRenderTarget(e),i.render(o,C_)}_blur(e,t,r,i,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,r,i,"latitudinal",s),this._halfBlur(a,e,r,r,i,"longitudinal",s)}_halfBlur(e,t,r,i,s,a,o){const l=this._renderer,u=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&Bn("blur direction must be either latitudinal or longitudinal!");const c=3,h=this._lodMeshes[i];h.material=u;const d=u.uniforms,f=this._sizeLods[r]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*Im-1),m=s/p,y=isFinite(s)?1+Math.floor(c*m):Im;y>Im&&Ht(`sigmaRadians, ${s}, is too large and will clip, as it requested ${y} samples when the maximum is set to ${Im}`);const v=[];let b=0;for(let A=0;A<Im;++A){const T=A/m,S=Math.exp(-T*T/2);v.push(S),A===0?b+=S:A<y&&(b+=2*S)}for(let A=0;A<v.length;A++)v[A]=v[A]/b;d.envMap.value=e.texture,d.samples.value=y,d.weights.value=v,d.latitudinal.value=a==="latitudinal",o&&(d.poleAxis.value=o);const{_lodMax:x}=this;d.dTheta.value=p,d.mipInt.value=x-r;const w=this._sizeLods[i],_=3*w*(i>x-tp?i-x+tp:0),E=4*(this._cubeSize-w);x0(t,_,E,3*w,2*w),l.setRenderTarget(t),l.render(h,C_)}}function $Se(n){const e=[],t=[],r=[];let i=n;const s=n-tp+1+T9.length;for(let a=0;a<s;a++){const o=Math.pow(2,i);e.push(o);let l=1/o;a>n-tp?l=T9[a-n+tp-1]:a===0&&(l=0),t.push(l);const u=1/(o-2),c=-u,h=1+u,d=[c,c,h,c,h,h,c,c,h,h,c,h],f=6,p=6,m=3,y=2,v=1,b=new Float32Array(m*p*f),x=new Float32Array(y*p*f),w=new Float32Array(v*p*f);for(let E=0;E<f;E++){const A=E%3*2/3-1,T=E>2?0:-1,S=[A,T,0,A+2/3,T,0,A+2/3,T+1,0,A,T,0,A+2/3,T+1,0,A,T+1,0];b.set(S,m*p*E),x.set(d,y*p*E);const M=[E,E,E,E,E,E];w.set(M,v*p*E)}const _=new Ms;_.setAttribute("position",new Ya(b,m)),_.setAttribute("uv",new Ya(x,y)),_.setAttribute("faceIndex",new Ya(w,v)),r.push(new cr(_,null)),i>tp&&i--}return{lodMeshes:r,sizeLods:e,sigmas:t}}function D9(n,e,t){const r=new Ec(n,e,t);return r.texture.mapping=EN,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function x0(n,e,t,r,i){n.viewport.set(e,t,r,i),n.scissor.set(e,t,r,i)}function HSe(n,e,t){return new Cc({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:VSe,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:AN(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:Kh,depthTest:!1,depthWrite:!1})}function GSe(n,e,t){const r=new Float32Array(Im),i=new De(0,1,0);return new Cc({name:"SphericalGaussianBlur",defines:{n:Im,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:AN(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Kh,depthTest:!1,depthWrite:!1})}function N9(){return new Cc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:AN(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Kh,depthTest:!1,depthWrite:!1})}function R9(){return new Cc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:AN(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Kh,depthTest:!1,depthWrite:!1})}function AN(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function jSe(n){let e=new WeakMap,t=null;function r(o){if(o&&o.isTexture){const l=o.mapping,u=l===NL||l===RL,c=l===Nv||l===gb;if(u||c){let h=e.get(o);const d=h!==void 0?h.texture.pmremVersion:0;if(o.isRenderTargetTexture&&o.pmremVersion!==d)return t===null&&(t=new C9(n)),h=u?t.fromEquirectangular(o,h):t.fromCubemap(o,h),h.texture.pmremVersion=o.pmremVersion,e.set(o,h),h.texture;if(h!==void 0)return h.texture;{const f=o.image;return u&&f&&f.height>0||c&&f&&i(f)?(t===null&&(t=new C9(n)),h=u?t.fromEquirectangular(o):t.fromCubemap(o),h.texture.pmremVersion=o.pmremVersion,e.set(o,h),o.addEventListener("dispose",s),h.texture):null}}}return o}function i(o){let l=0;const u=6;for(let c=0;c<u;c++)o[c]!==void 0&&l++;return l===u}function s(o){const l=o.target;l.removeEventListener("dispose",s);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:a}}function qSe(n){const e={};function t(r){if(e[r]!==void 0)return e[r];const i=n.getExtension(r);return e[r]=i,i}return{has:function(r){return t(r)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(r){const i=t(r);return i===null&&Mw("WebGLRenderer: "+r+" extension not supported."),i}}}function WSe(n,e,t,r){const i={},s=new WeakMap;function a(h){const d=h.target;d.index!==null&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);d.removeEventListener("dispose",a),delete i[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),r.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,t.memory.geometries--}function o(h,d){return i[d.id]===!0||(d.addEventListener("dispose",a),i[d.id]=!0,t.memory.geometries++),d}function l(h){const d=h.attributes;for(const f in d)e.update(d[f],n.ARRAY_BUFFER)}function u(h){const d=[],f=h.index,p=h.attributes.position;let m=0;if(f!==null){const b=f.array;m=f.version;for(let x=0,w=b.length;x<w;x+=3){const _=b[x+0],E=b[x+1],A=b[x+2];d.push(_,E,E,A,A,_)}}else if(p!==void 0){const b=p.array;m=p.version;for(let x=0,w=b.length/3-1;x<w;x+=3){const _=x+0,E=x+1,A=x+2;d.push(_,E,E,A,A,_)}}else return;const y=new(kee(d)?$ee:zee)(d,1);y.version=m;const v=s.get(h);v&&e.remove(v),s.set(h,y)}function c(h){const d=s.get(h);if(d){const f=h.index;f!==null&&d.version<f.version&&u(h)}else u(h);return s.get(h)}return{get:o,update:l,getWireframeAttribute:c}}function XSe(n,e,t){let r;function i(d){r=d}let s,a;function o(d){s=d.type,a=d.bytesPerElement}function l(d,f){n.drawElements(r,f,s,d*a),t.update(f,r,1)}function u(d,f,p){p!==0&&(n.drawElementsInstanced(r,f,s,d*a,p),t.update(f,r,p))}function c(d,f,p){if(p===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,f,0,s,d,0,p);let y=0;for(let v=0;v<p;v++)y+=f[v];t.update(y,r,1)}function h(d,f,p,m){if(p===0)return;const y=e.get("WEBGL_multi_draw");if(y===null)for(let v=0;v<d.length;v++)u(d[v]/a,f[v],m[v]);else{y.multiDrawElementsInstancedWEBGL(r,f,0,s,d,0,m,0,p);let v=0;for(let b=0;b<p;b++)v+=f[b]*m[b];t.update(v,r,1)}}this.setMode=i,this.setIndex=o,this.render=l,this.renderInstances=u,this.renderMultiDraw=c,this.renderMultiDrawInstances=h}function KSe(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,a,o){switch(t.calls++,a){case n.TRIANGLES:t.triangles+=o*(s/3);break;case n.LINES:t.lines+=o*(s/2);break;case n.LINE_STRIP:t.lines+=o*(s-1);break;case n.LINE_LOOP:t.lines+=o*s;break;case n.POINTS:t.points+=o*s;break;default:Bn("WebGLInfo: Unknown draw mode:",a);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:r}}function YSe(n,e,t){const r=new WeakMap,i=new Zr;function s(a,o,l){const u=a.morphTargetInfluences,c=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,h=c!==void 0?c.length:0;let d=r.get(o);if(d===void 0||d.count!==h){let S=function(){A.dispose(),r.delete(o),o.removeEventListener("dispose",S)};d!==void 0&&d.texture.dispose();const f=o.morphAttributes.position!==void 0,p=o.morphAttributes.normal!==void 0,m=o.morphAttributes.color!==void 0,y=o.morphAttributes.position||[],v=o.morphAttributes.normal||[],b=o.morphAttributes.color||[];let x=0;f===!0&&(x=1),p===!0&&(x=2),m===!0&&(x=3);let w=o.attributes.position.count*x,_=1;w>e.maxTextureSize&&(_=Math.ceil(w/e.maxTextureSize),w=e.maxTextureSize);const E=new Float32Array(w*_*4*h),A=new Bee(E,w,_,h);A.type=lc,A.needsUpdate=!0;const T=x*4;for(let M=0;M<h;M++){const D=y[M],N=v[M],R=b[M],z=w*_*4*M;for(let j=0;j<D.count;j++){const I=j*T;f===!0&&(i.fromBufferAttribute(D,j),E[z+I+0]=i.x,E[z+I+1]=i.y,E[z+I+2]=i.z,E[z+I+3]=0),p===!0&&(i.fromBufferAttribute(N,j),E[z+I+4]=i.x,E[z+I+5]=i.y,E[z+I+6]=i.z,E[z+I+7]=0),m===!0&&(i.fromBufferAttribute(R,j),E[z+I+8]=i.x,E[z+I+9]=i.y,E[z+I+10]=i.z,E[z+I+11]=R.itemSize===4?i.w:1)}}d={count:h,texture:A,size:new Ln(w,_)},r.set(o,d),o.addEventListener("dispose",S)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)l.getUniforms().setValue(n,"morphTexture",a.morphTexture,t);else{let f=0;for(let m=0;m<u.length;m++)f+=u[m];const p=o.morphTargetsRelative?1:1-f;l.getUniforms().setValue(n,"morphTargetBaseInfluence",p),l.getUniforms().setValue(n,"morphTargetInfluences",u)}l.getUniforms().setValue(n,"morphTargetsTexture",d.texture,t),l.getUniforms().setValue(n,"morphTargetsTextureSize",d.size)}return{update:s}}function QSe(n,e,t,r){let i=new WeakMap;function s(l){const u=r.render.frame,c=l.geometry,h=e.get(l,c);if(i.get(h)!==u&&(e.update(h),i.set(h,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),i.get(l)!==u&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),i.set(l,u))),l.isSkinnedMesh){const d=l.skeleton;i.get(d)!==u&&(d.update(),i.set(d,u))}return h}function a(){i=new WeakMap}function o(l){const u=l.target;u.removeEventListener("dispose",o),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return{update:s,dispose:a}}const ZSe={[wee]:"LINEAR_TONE_MAPPING",[Eee]:"REINHARD_TONE_MAPPING",[See]:"CINEON_TONE_MAPPING",[Aee]:"ACES_FILMIC_TONE_MAPPING",[Mee]:"AGX_TONE_MAPPING",[Cee]:"NEUTRAL_TONE_MAPPING",[Tee]:"CUSTOM_TONE_MAPPING"};function JSe(n,e,t,r,i){const s=new Ec(e,t,{type:n,depthBuffer:r,stencilBuffer:i}),a=new Ec(e,t,{type:pd,depthBuffer:!1,stencilBuffer:!1}),o=new Ms;o.setAttribute("position",new Pi([-1,3,0,-1,-1,0,3,-1,0],3)),o.setAttribute("uv",new Pi([0,2,0,0,2,0],2));const l=new j1e({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),u=new cr(o,l),c=new Yee(-1,1,1,-1,0,1);let h=null,d=null,f=!1,p,m=null,y=[],v=!1;this.setSize=function(b,x){s.setSize(b,x),a.setSize(b,x);for(let w=0;w<y.length;w++){const _=y[w];_.setSize&&_.setSize(b,x)}},this.setEffects=function(b){y=b,v=y.length>0&&y[0].isRenderPass===!0;const x=s.width,w=s.height;for(let _=0;_<y.length;_++){const E=y[_];E.setSize&&E.setSize(x,w)}},this.begin=function(b,x){if(f||b.toneMapping===wc&&y.length===0)return!1;if(m=x,x!==null){const w=x.width,_=x.height;(s.width!==w||s.height!==_)&&this.setSize(w,_)}return v===!1&&b.setRenderTarget(s),p=b.toneMapping,b.toneMapping=wc,!0},this.hasRenderPass=function(){return v},this.end=function(b,x){b.toneMapping=p,f=!0;let w=s,_=a;for(let E=0;E<y.length;E++){const A=y[E];if(A.enabled!==!1&&(A.render(b,_,w,x),A.needsSwap!==!1)){const T=w;w=_,_=T}}if(h!==b.outputColorSpace||d!==b.toneMapping){h=b.outputColorSpace,d=b.toneMapping,l.defines={},Rn.getTransfer(h)===qn&&(l.defines.SRGB_TRANSFER="");const E=ZSe[d];E&&(l.defines[E]=""),l.needsUpdate=!0}l.uniforms.tDiffuse.value=w.texture,b.setRenderTarget(m),b.render(u,c),m=null,f=!1},this.isCompositing=function(){return f},this.dispose=function(){s.dispose(),a.dispose(),o.dispose(),l.dispose()}}const Zee=new wa,mO=new Cw(1,1),Jee=new Bee,ete=new _1e,tte=new jee,I9=[],P9=[],F9=new Float32Array(16),L9=new Float32Array(9),O9=new Float32Array(4);function jb(n,e,t){const r=n[0];if(r<=0||r>0)return n;const i=e*t;let s=I9[i];if(s===void 0&&(s=new Float32Array(i),I9[i]=s),e!==0){r.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=t,n[a].toArray(s,o)}return s}function Oi(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function ki(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function TN(n,e){let t=P9[e];t===void 0&&(t=new Int32Array(e),P9[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function eAe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function tAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Oi(t,e))return;n.uniform2fv(this.addr,e),ki(t,e)}}function nAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Oi(t,e))return;n.uniform3fv(this.addr,e),ki(t,e)}}function rAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Oi(t,e))return;n.uniform4fv(this.addr,e),ki(t,e)}}function iAe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Oi(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),ki(t,e)}else{if(Oi(t,r))return;O9.set(r),n.uniformMatrix2fv(this.addr,!1,O9),ki(t,r)}}function sAe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Oi(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),ki(t,e)}else{if(Oi(t,r))return;L9.set(r),n.uniformMatrix3fv(this.addr,!1,L9),ki(t,r)}}function aAe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Oi(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),ki(t,e)}else{if(Oi(t,r))return;F9.set(r),n.uniformMatrix4fv(this.addr,!1,F9),ki(t,r)}}function oAe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function lAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Oi(t,e))return;n.uniform2iv(this.addr,e),ki(t,e)}}function uAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Oi(t,e))return;n.uniform3iv(this.addr,e),ki(t,e)}}function cAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Oi(t,e))return;n.uniform4iv(this.addr,e),ki(t,e)}}function hAe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function dAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Oi(t,e))return;n.uniform2uiv(this.addr,e),ki(t,e)}}function fAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Oi(t,e))return;n.uniform3uiv(this.addr,e),ki(t,e)}}function pAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Oi(t,e))return;n.uniform4uiv(this.addr,e),ki(t,e)}}function mAe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i);let s;this.type===n.SAMPLER_2D_SHADOW?(mO.compareFunction=t.isReversedDepthBuffer()?U4:B4,s=mO):s=Zee,t.setTexture2D(e||s,i)}function gAe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture3D(e||ete,i)}function vAe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTextureCube(e||tte,i)}function yAe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2DArray(e||Jee,i)}function xAe(n){switch(n){case 5126:return eAe;case 35664:return tAe;case 35665:return nAe;case 35666:return rAe;case 35674:return iAe;case 35675:return sAe;case 35676:return aAe;case 5124:case 35670:return oAe;case 35667:case 35671:return lAe;case 35668:case 35672:return uAe;case 35669:case 35673:return cAe;case 5125:return hAe;case 36294:return dAe;case 36295:return fAe;case 36296:return pAe;case 35678:case 36198:case 36298:case 36306:case 35682:return mAe;case 35679:case 36299:case 36307:return gAe;case 35680:case 36300:case 36308:case 36293:return vAe;case 36289:case 36303:case 36311:case 36292:return yAe}}function bAe(n,e){n.uniform1fv(this.addr,e)}function _Ae(n,e){const t=jb(e,this.size,2);n.uniform2fv(this.addr,t)}function wAe(n,e){const t=jb(e,this.size,3);n.uniform3fv(this.addr,t)}function EAe(n,e){const t=jb(e,this.size,4);n.uniform4fv(this.addr,t)}function SAe(n,e){const t=jb(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function AAe(n,e){const t=jb(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function TAe(n,e){const t=jb(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function MAe(n,e){n.uniform1iv(this.addr,e)}function CAe(n,e){n.uniform2iv(this.addr,e)}function DAe(n,e){n.uniform3iv(this.addr,e)}function NAe(n,e){n.uniform4iv(this.addr,e)}function RAe(n,e){n.uniform1uiv(this.addr,e)}function IAe(n,e){n.uniform2uiv(this.addr,e)}function PAe(n,e){n.uniform3uiv(this.addr,e)}function FAe(n,e){n.uniform4uiv(this.addr,e)}function LAe(n,e,t){const r=this.cache,i=e.length,s=TN(t,i);Oi(r,s)||(n.uniform1iv(this.addr,s),ki(r,s));let a;this.type===n.SAMPLER_2D_SHADOW?a=mO:a=Zee;for(let o=0;o!==i;++o)t.setTexture2D(e[o]||a,s[o])}function OAe(n,e,t){const r=this.cache,i=e.length,s=TN(t,i);Oi(r,s)||(n.uniform1iv(this.addr,s),ki(r,s));for(let a=0;a!==i;++a)t.setTexture3D(e[a]||ete,s[a])}function kAe(n,e,t){const r=this.cache,i=e.length,s=TN(t,i);Oi(r,s)||(n.uniform1iv(this.addr,s),ki(r,s));for(let a=0;a!==i;++a)t.setTextureCube(e[a]||tte,s[a])}function BAe(n,e,t){const r=this.cache,i=e.length,s=TN(t,i);Oi(r,s)||(n.uniform1iv(this.addr,s),ki(r,s));for(let a=0;a!==i;++a)t.setTexture2DArray(e[a]||Jee,s[a])}function UAe(n){switch(n){case 5126:return bAe;case 35664:return _Ae;case 35665:return wAe;case 35666:return EAe;case 35674:return SAe;case 35675:return AAe;case 35676:return TAe;case 5124:case 35670:return MAe;case 35667:case 35671:return CAe;case 35668:case 35672:return DAe;case 35669:case 35673:return NAe;case 5125:return RAe;case 36294:return IAe;case 36295:return PAe;case 36296:return FAe;case 35678:case 36198:case 36298:case 36306:case 35682:return LAe;case 35679:case 36299:case 36307:return OAe;case 35680:case 36300:case 36308:case 36293:return kAe;case 36289:case 36303:case 36311:case 36292:return BAe}}class VAe{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=xAe(t.type)}}class zAe{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=UAe(t.type)}}class $Ae{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const i=this.seq;for(let s=0,a=i.length;s!==a;++s){const o=i[s];o.setValue(e,t[o.id],r)}}}const GI=/(\w+)(\])?(\[|\.)?/g;function k9(n,e){n.seq.push(e),n.map[e.id]=e}function HAe(n,e,t){const r=n.name,i=r.length;for(GI.lastIndex=0;;){const s=GI.exec(r),a=GI.lastIndex;let o=s[1];const l=s[2]==="]",u=s[3];if(l&&(o=o|0),u===void 0||u==="["&&a+2===i){k9(t,u===void 0?new VAe(o,n,e):new zAe(o,n,e));break}else{let h=t.map[o];h===void 0&&(h=new $Ae(o),k9(t,h)),t=h}}}class hC{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let a=0;a<r;++a){const o=e.getActiveUniform(t,a),l=e.getUniformLocation(t,o.name);HAe(o,l,this)}const i=[],s=[];for(const a of this.seq)a.type===e.SAMPLER_2D_SHADOW||a.type===e.SAMPLER_CUBE_SHADOW||a.type===e.SAMPLER_2D_ARRAY_SHADOW?i.push(a):s.push(a);i.length>0&&(this.seq=i.concat(s))}setValue(e,t,r,i){const s=this.map[t];s!==void 0&&s.setValue(e,r,i)}setOptional(e,t,r){const i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let s=0,a=t.length;s!==a;++s){const o=t[s],l=r[o.id];l.needsUpdate!==!1&&o.setValue(e,l.value,i)}}static seqWithValue(e,t){const r=[];for(let i=0,s=e.length;i!==s;++i){const a=e[i];a.id in t&&r.push(a)}return r}}function B9(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}const GAe=37297;let jAe=0;function qAe(n,e){const t=n.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=i;a<s;a++){const o=a+1;r.push(`${o===e?">":" "} ${o}: ${t[a]}`)}return r.join(`
`)}const U9=new sn;function WAe(n){Rn._getMatrix(U9,Rn.workingColorSpace,n);const e=`mat3( ${U9.elements.map(t=>t.toFixed(4))} )`;switch(Rn.getTransfer(n)){case AD:return[e,"LinearTransferOETF"];case qn:return[e,"sRGBTransferOETF"];default:return Ht("WebGLProgram: Unsupported color space: ",n),[e,"LinearTransferOETF"]}}function V9(n,e,t){const r=n.getShaderParameter(e,n.COMPILE_STATUS),s=(n.getShaderInfoLog(e)||"").trim();if(r&&s==="")return"";const a=/ERROR: 0:(\d+)/.exec(s);if(a){const o=parseInt(a[1]);return t.toUpperCase()+`

`+s+`

`+qAe(n.getShaderSource(e),o)}else return s}function XAe(n,e){const t=WAe(e);return[`vec4 ${n}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}const KAe={[wee]:"Linear",[Eee]:"Reinhard",[See]:"Cineon",[Aee]:"ACESFilmic",[Mee]:"AgX",[Cee]:"Neutral",[Tee]:"Custom"};function YAe(n,e){const t=KAe[e];return t===void 0?(Ht("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+n+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const RT=new De;function QAe(){Rn.getLuminanceCoefficients(RT);const n=RT.x.toFixed(4),e=RT.y.toFixed(4),t=RT.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${n}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function ZAe(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(d1).join(`
`)}function JAe(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function eTe(n,e){const t={},r=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=n.getActiveAttrib(e,i),a=s.name;let o=1;s.type===n.FLOAT_MAT2&&(o=2),s.type===n.FLOAT_MAT3&&(o=3),s.type===n.FLOAT_MAT4&&(o=4),t[a]={type:s.type,location:n.getAttribLocation(e,a),locationSize:o}}return t}function d1(n){return n!==""}function z9(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function $9(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const tTe=/^[ \t]*#include +<([\w\d./]+)>/gm;function gO(n){return n.replace(tTe,rTe)}const nTe=new Map;function rTe(n,e){let t=un[e];if(t===void 0){const r=nTe.get(e);if(r!==void 0)t=un[r],Ht('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return gO(t)}const iTe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function H9(n){return n.replace(iTe,sTe)}function sTe(n,e,t,r){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function G9(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}const aTe={[aC]:"SHADOWMAP_TYPE_PCF",[h1]:"SHADOWMAP_TYPE_VSM"};function oTe(n){return aTe[n.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}const lTe={[Nv]:"ENVMAP_TYPE_CUBE",[gb]:"ENVMAP_TYPE_CUBE",[EN]:"ENVMAP_TYPE_CUBE_UV"};function uTe(n){return n.envMap===!1?"ENVMAP_TYPE_CUBE":lTe[n.envMapMode]||"ENVMAP_TYPE_CUBE"}const cTe={[gb]:"ENVMAP_MODE_REFRACTION"};function hTe(n){return n.envMap===!1?"ENVMAP_MODE_REFLECTION":cTe[n.envMapMode]||"ENVMAP_MODE_REFLECTION"}const dTe={[N4]:"ENVMAP_BLENDING_MULTIPLY",[n1e]:"ENVMAP_BLENDING_MIX",[r1e]:"ENVMAP_BLENDING_ADD"};function fTe(n){return n.envMap===!1?"ENVMAP_BLENDING_NONE":dTe[n.combine]||"ENVMAP_BLENDING_NONE"}function pTe(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}function mTe(n,e,t,r){const i=n.getContext(),s=t.defines;let a=t.vertexShader,o=t.fragmentShader;const l=oTe(t),u=uTe(t),c=hTe(t),h=fTe(t),d=pTe(t),f=ZAe(t),p=JAe(s),m=i.createProgram();let y,v,b=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(y=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(d1).join(`
`),y.length>0&&(y+=`
`),v=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(d1).join(`
`),v.length>0&&(v+=`
`)):(y=[G9(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(d1).join(`
`),v=[G9(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+c:"",t.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==wc?"#define TONE_MAPPING":"",t.toneMapping!==wc?un.tonemapping_pars_fragment:"",t.toneMapping!==wc?YAe("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",un.colorspace_pars_fragment,XAe("linearToOutputTexel",t.outputColorSpace),QAe(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(d1).join(`
`)),a=gO(a),a=z9(a,t),a=$9(a,t),o=gO(o),o=z9(o,t),o=$9(o,t),a=H9(a),o=H9(o),t.isRawShaderMaterial!==!0&&(b=`#version 300 es
`,y=[f,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+y,v=["#define varying in",t.glslVersion===J8?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===J8?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);const x=b+y+a,w=b+v+o,_=B9(i,i.VERTEX_SHADER,x),E=B9(i,i.FRAGMENT_SHADER,w);i.attachShader(m,_),i.attachShader(m,E),t.index0AttributeName!==void 0?i.bindAttribLocation(m,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(m,0,"position"),i.linkProgram(m);function A(D){if(n.debug.checkShaderErrors){const N=i.getProgramInfoLog(m)||"",R=i.getShaderInfoLog(_)||"",z=i.getShaderInfoLog(E)||"",j=N.trim(),I=R.trim(),F=z.trim();let $=!0,H=!0;if(i.getProgramParameter(m,i.LINK_STATUS)===!1)if($=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(i,m,_,E);else{const Z=V9(i,_,"vertex"),J=V9(i,E,"fragment");Bn("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(m,i.VALIDATE_STATUS)+`

Material Name: `+D.name+`
Material Type: `+D.type+`

Program Info Log: `+j+`
`+Z+`
`+J)}else j!==""?Ht("WebGLProgram: Program Info Log:",j):(I===""||F==="")&&(H=!1);H&&(D.diagnostics={runnable:$,programLog:j,vertexShader:{log:I,prefix:y},fragmentShader:{log:F,prefix:v}})}i.deleteShader(_),i.deleteShader(E),T=new hC(i,m),S=eTe(i,m)}let T;this.getUniforms=function(){return T===void 0&&A(this),T};let S;this.getAttributes=function(){return S===void 0&&A(this),S};let M=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return M===!1&&(M=i.getProgramParameter(m,GAe)),M},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(m),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=jAe++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=_,this.fragmentShader=E,this}let gTe=0;class vTe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(r),a=this._getShaderCacheForMaterial(e);return a.has(i)===!1&&(a.add(i),i.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new yTe(e),t.set(e,r)),r}}class yTe{constructor(e){this.id=gTe++,this.code=e,this.usedTimes=0}}function xTe(n,e,t,r,i,s,a){const o=new Uee,l=new vTe,u=new Set,c=[],h=new Map,d=i.logarithmicDepthBuffer;let f=i.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(S){return u.add(S),S===0?"uv":`uv${S}`}function y(S,M,D,N,R){const z=N.fog,j=R.geometry,I=S.isMeshStandardMaterial?N.environment:null,F=(S.isMeshStandardMaterial?t:e).get(S.envMap||I),$=F&&F.mapping===EN?F.image.height:null,H=p[S.type];S.precision!==null&&(f=i.getMaxPrecision(S.precision),f!==S.precision&&Ht("WebGLProgram.getParameters:",S.precision,"not supported, using",f,"instead."));const Z=j.morphAttributes.position||j.morphAttributes.normal||j.morphAttributes.color,J=Z!==void 0?Z.length:0;let ee=0;j.morphAttributes.position!==void 0&&(ee=1),j.morphAttributes.normal!==void 0&&(ee=2),j.morphAttributes.color!==void 0&&(ee=3);let O,ue,Q,re;if(H){const dn=sc[H];O=dn.vertexShader,ue=dn.fragmentShader}else O=S.vertexShader,ue=S.fragmentShader,l.update(S),Q=l.getVertexShaderID(S),re=l.getFragmentShaderID(S);const le=n.getRenderTarget(),te=n.state.buffers.depth.getReversed(),Y=R.isInstancedMesh===!0,oe=R.isBatchedMesh===!0,ve=!!S.map,me=!!S.matcap,be=!!F,_e=!!S.aoMap,Be=!!S.lightMap,ze=!!S.bumpMap,tt=!!S.normalMap,de=!!S.displacementMap,Xe=!!S.emissiveMap,Ke=!!S.metalnessMap,se=!!S.roughnessMap,fe=S.anisotropy>0,L=S.clearcoat>0,P=S.dispersion>0,K=S.iridescence>0,ae=S.sheen>0,pe=S.transmission>0,ce=fe&&!!S.anisotropyMap,Ae=L&&!!S.clearcoatMap,we=L&&!!S.clearcoatNormalMap,Pe=L&&!!S.clearcoatRoughnessMap,Te=K&&!!S.iridescenceMap,Ne=K&&!!S.iridescenceThicknessMap,$e=ae&&!!S.sheenColorMap,Ye=ae&&!!S.sheenRoughnessMap,Ge=!!S.specularMap,qe=!!S.specularColorMap,V=!!S.specularIntensityMap,W=pe&&!!S.transmissionMap,ye=pe&&!!S.thicknessMap,Ee=!!S.gradientMap,Fe=!!S.alphaMap,Le=S.alphaTest>0,Ue=!!S.alphaHash,nt=!!S.extensions;let Pt=wc;S.toneMapped&&(le===null||le.isXRRenderTarget===!0)&&(Pt=n.toneMapping);const Vn={shaderID:H,shaderType:S.type,shaderName:S.name,vertexShader:O,fragmentShader:ue,defines:S.defines,customVertexShaderID:Q,customFragmentShaderID:re,isRawShaderMaterial:S.isRawShaderMaterial===!0,glslVersion:S.glslVersion,precision:f,batching:oe,batchingColor:oe&&R._colorsTexture!==null,instancing:Y,instancingColor:Y&&R.instanceColor!==null,instancingMorph:Y&&R.morphTexture!==null,outputColorSpace:le===null?n.outputColorSpace:le.isXRRenderTarget===!0?le.texture.colorSpace:yb,alphaToCoverage:!!S.alphaToCoverage,map:ve,matcap:me,envMap:be,envMapMode:be&&F.mapping,envMapCubeUVHeight:$,aoMap:_e,lightMap:Be,bumpMap:ze,normalMap:tt,displacementMap:de,emissiveMap:Xe,normalMapObjectSpace:tt&&S.normalMapType===a1e,normalMapTangentSpace:tt&&S.normalMapType===k4,metalnessMap:Ke,roughnessMap:se,anisotropy:fe,anisotropyMap:ce,clearcoat:L,clearcoatMap:Ae,clearcoatNormalMap:we,clearcoatRoughnessMap:Pe,dispersion:P,iridescence:K,iridescenceMap:Te,iridescenceThicknessMap:Ne,sheen:ae,sheenColorMap:$e,sheenRoughnessMap:Ye,specularMap:Ge,specularColorMap:qe,specularIntensityMap:V,transmission:pe,transmissionMap:W,thicknessMap:ye,gradientMap:Ee,opaque:S.transparent===!1&&S.blending===Sy&&S.alphaToCoverage===!1,alphaMap:Fe,alphaTest:Le,alphaHash:Ue,combine:S.combine,mapUv:ve&&m(S.map.channel),aoMapUv:_e&&m(S.aoMap.channel),lightMapUv:Be&&m(S.lightMap.channel),bumpMapUv:ze&&m(S.bumpMap.channel),normalMapUv:tt&&m(S.normalMap.channel),displacementMapUv:de&&m(S.displacementMap.channel),emissiveMapUv:Xe&&m(S.emissiveMap.channel),metalnessMapUv:Ke&&m(S.metalnessMap.channel),roughnessMapUv:se&&m(S.roughnessMap.channel),anisotropyMapUv:ce&&m(S.anisotropyMap.channel),clearcoatMapUv:Ae&&m(S.clearcoatMap.channel),clearcoatNormalMapUv:we&&m(S.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Pe&&m(S.clearcoatRoughnessMap.channel),iridescenceMapUv:Te&&m(S.iridescenceMap.channel),iridescenceThicknessMapUv:Ne&&m(S.iridescenceThicknessMap.channel),sheenColorMapUv:$e&&m(S.sheenColorMap.channel),sheenRoughnessMapUv:Ye&&m(S.sheenRoughnessMap.channel),specularMapUv:Ge&&m(S.specularMap.channel),specularColorMapUv:qe&&m(S.specularColorMap.channel),specularIntensityMapUv:V&&m(S.specularIntensityMap.channel),transmissionMapUv:W&&m(S.transmissionMap.channel),thicknessMapUv:ye&&m(S.thicknessMap.channel),alphaMapUv:Fe&&m(S.alphaMap.channel),vertexTangents:!!j.attributes.tangent&&(tt||fe),vertexColors:S.vertexColors,vertexAlphas:S.vertexColors===!0&&!!j.attributes.color&&j.attributes.color.itemSize===4,pointsUvs:R.isPoints===!0&&!!j.attributes.uv&&(ve||Fe),fog:!!z,useFog:S.fog===!0,fogExp2:!!z&&z.isFogExp2,flatShading:S.flatShading===!0&&S.wireframe===!1,sizeAttenuation:S.sizeAttenuation===!0,logarithmicDepthBuffer:d,reversedDepthBuffer:te,skinning:R.isSkinnedMesh===!0,morphTargets:j.morphAttributes.position!==void 0,morphNormals:j.morphAttributes.normal!==void 0,morphColors:j.morphAttributes.color!==void 0,morphTargetsCount:J,morphTextureStride:ee,numDirLights:M.directional.length,numPointLights:M.point.length,numSpotLights:M.spot.length,numSpotLightMaps:M.spotLightMap.length,numRectAreaLights:M.rectArea.length,numHemiLights:M.hemi.length,numDirLightShadows:M.directionalShadowMap.length,numPointLightShadows:M.pointShadowMap.length,numSpotLightShadows:M.spotShadowMap.length,numSpotLightShadowsWithMaps:M.numSpotLightShadowsWithMaps,numLightProbes:M.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:S.dithering,shadowMapEnabled:n.shadowMap.enabled&&D.length>0,shadowMapType:n.shadowMap.type,toneMapping:Pt,decodeVideoTexture:ve&&S.map.isVideoTexture===!0&&Rn.getTransfer(S.map.colorSpace)===qn,decodeVideoTextureEmissive:Xe&&S.emissiveMap.isVideoTexture===!0&&Rn.getTransfer(S.emissiveMap.colorSpace)===qn,premultipliedAlpha:S.premultipliedAlpha,doubleSided:S.side===kh,flipSided:S.side===to,useDepthPacking:S.depthPacking>=0,depthPacking:S.depthPacking||0,index0AttributeName:S.index0AttributeName,extensionClipCullDistance:nt&&S.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(nt&&S.extensions.multiDraw===!0||oe)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:S.customProgramCacheKey()};return Vn.vertexUv1s=u.has(1),Vn.vertexUv2s=u.has(2),Vn.vertexUv3s=u.has(3),u.clear(),Vn}function v(S){const M=[];if(S.shaderID?M.push(S.shaderID):(M.push(S.customVertexShaderID),M.push(S.customFragmentShaderID)),S.defines!==void 0)for(const D in S.defines)M.push(D),M.push(S.defines[D]);return S.isRawShaderMaterial===!1&&(b(M,S),x(M,S),M.push(n.outputColorSpace)),M.push(S.customProgramCacheKey),M.join()}function b(S,M){S.push(M.precision),S.push(M.outputColorSpace),S.push(M.envMapMode),S.push(M.envMapCubeUVHeight),S.push(M.mapUv),S.push(M.alphaMapUv),S.push(M.lightMapUv),S.push(M.aoMapUv),S.push(M.bumpMapUv),S.push(M.normalMapUv),S.push(M.displacementMapUv),S.push(M.emissiveMapUv),S.push(M.metalnessMapUv),S.push(M.roughnessMapUv),S.push(M.anisotropyMapUv),S.push(M.clearcoatMapUv),S.push(M.clearcoatNormalMapUv),S.push(M.clearcoatRoughnessMapUv),S.push(M.iridescenceMapUv),S.push(M.iridescenceThicknessMapUv),S.push(M.sheenColorMapUv),S.push(M.sheenRoughnessMapUv),S.push(M.specularMapUv),S.push(M.specularColorMapUv),S.push(M.specularIntensityMapUv),S.push(M.transmissionMapUv),S.push(M.thicknessMapUv),S.push(M.combine),S.push(M.fogExp2),S.push(M.sizeAttenuation),S.push(M.morphTargetsCount),S.push(M.morphAttributeCount),S.push(M.numDirLights),S.push(M.numPointLights),S.push(M.numSpotLights),S.push(M.numSpotLightMaps),S.push(M.numHemiLights),S.push(M.numRectAreaLights),S.push(M.numDirLightShadows),S.push(M.numPointLightShadows),S.push(M.numSpotLightShadows),S.push(M.numSpotLightShadowsWithMaps),S.push(M.numLightProbes),S.push(M.shadowMapType),S.push(M.toneMapping),S.push(M.numClippingPlanes),S.push(M.numClipIntersection),S.push(M.depthPacking)}function x(S,M){o.disableAll(),M.instancing&&o.enable(0),M.instancingColor&&o.enable(1),M.instancingMorph&&o.enable(2),M.matcap&&o.enable(3),M.envMap&&o.enable(4),M.normalMapObjectSpace&&o.enable(5),M.normalMapTangentSpace&&o.enable(6),M.clearcoat&&o.enable(7),M.iridescence&&o.enable(8),M.alphaTest&&o.enable(9),M.vertexColors&&o.enable(10),M.vertexAlphas&&o.enable(11),M.vertexUv1s&&o.enable(12),M.vertexUv2s&&o.enable(13),M.vertexUv3s&&o.enable(14),M.vertexTangents&&o.enable(15),M.anisotropy&&o.enable(16),M.alphaHash&&o.enable(17),M.batching&&o.enable(18),M.dispersion&&o.enable(19),M.batchingColor&&o.enable(20),M.gradientMap&&o.enable(21),S.push(o.mask),o.disableAll(),M.fog&&o.enable(0),M.useFog&&o.enable(1),M.flatShading&&o.enable(2),M.logarithmicDepthBuffer&&o.enable(3),M.reversedDepthBuffer&&o.enable(4),M.skinning&&o.enable(5),M.morphTargets&&o.enable(6),M.morphNormals&&o.enable(7),M.morphColors&&o.enable(8),M.premultipliedAlpha&&o.enable(9),M.shadowMapEnabled&&o.enable(10),M.doubleSided&&o.enable(11),M.flipSided&&o.enable(12),M.useDepthPacking&&o.enable(13),M.dithering&&o.enable(14),M.transmission&&o.enable(15),M.sheen&&o.enable(16),M.opaque&&o.enable(17),M.pointsUvs&&o.enable(18),M.decodeVideoTexture&&o.enable(19),M.decodeVideoTextureEmissive&&o.enable(20),M.alphaToCoverage&&o.enable(21),S.push(o.mask)}function w(S){const M=p[S.type];let D;if(M){const N=sc[M];D=F1e.clone(N.uniforms)}else D=S.uniforms;return D}function _(S,M){let D=h.get(M);return D!==void 0?++D.usedTimes:(D=new mTe(n,M,S,s),c.push(D),h.set(M,D)),D}function E(S){if(--S.usedTimes===0){const M=c.indexOf(S);c[M]=c[c.length-1],c.pop(),h.delete(S.cacheKey),S.destroy()}}function A(S){l.remove(S)}function T(){l.dispose()}return{getParameters:y,getProgramCacheKey:v,getUniforms:w,acquireProgram:_,releaseProgram:E,releaseShaderCache:A,programs:c,dispose:T}}function bTe(){let n=new WeakMap;function e(a){return n.has(a)}function t(a){let o=n.get(a);return o===void 0&&(o={},n.set(a,o)),o}function r(a){n.delete(a)}function i(a,o,l){n.get(a)[o]=l}function s(){n=new WeakMap}return{has:e,get:t,remove:r,update:i,dispose:s}}function _Te(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function j9(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function q9(){const n=[];let e=0;const t=[],r=[],i=[];function s(){e=0,t.length=0,r.length=0,i.length=0}function a(h,d,f,p,m,y){let v=n[e];return v===void 0?(v={id:h.id,object:h,geometry:d,material:f,groupOrder:p,renderOrder:h.renderOrder,z:m,group:y},n[e]=v):(v.id=h.id,v.object=h,v.geometry=d,v.material=f,v.groupOrder=p,v.renderOrder=h.renderOrder,v.z=m,v.group=y),e++,v}function o(h,d,f,p,m,y){const v=a(h,d,f,p,m,y);f.transmission>0?r.push(v):f.transparent===!0?i.push(v):t.push(v)}function l(h,d,f,p,m,y){const v=a(h,d,f,p,m,y);f.transmission>0?r.unshift(v):f.transparent===!0?i.unshift(v):t.unshift(v)}function u(h,d){t.length>1&&t.sort(h||_Te),r.length>1&&r.sort(d||j9),i.length>1&&i.sort(d||j9)}function c(){for(let h=e,d=n.length;h<d;h++){const f=n[h];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:t,transmissive:r,transparent:i,init:s,push:o,unshift:l,finish:c,sort:u}}function wTe(){let n=new WeakMap;function e(r,i){const s=n.get(r);let a;return s===void 0?(a=new q9,n.set(r,[a])):i>=s.length?(a=new q9,s.push(a)):a=s[i],a}function t(){n=new WeakMap}return{get:e,dispose:t}}function ETe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new De,color:new Bt};break;case"SpotLight":t={position:new De,direction:new De,color:new Bt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new De,color:new Bt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new De,skyColor:new Bt,groundColor:new Bt};break;case"RectAreaLight":t={color:new Bt,position:new De,halfWidth:new De,halfHeight:new De};break}return n[e.id]=t,t}}}function STe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ln};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ln};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ln,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let ATe=0;function TTe(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function MTe(n){const e=new ETe,t=STe(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)r.probe.push(new De);const i=new De,s=new Rr,a=new Rr;function o(u){let c=0,h=0,d=0;for(let S=0;S<9;S++)r.probe[S].set(0,0,0);let f=0,p=0,m=0,y=0,v=0,b=0,x=0,w=0,_=0,E=0,A=0;u.sort(TTe);for(let S=0,M=u.length;S<M;S++){const D=u[S],N=D.color,R=D.intensity,z=D.distance;let j=null;if(D.shadow&&D.shadow.map&&(D.shadow.map.texture.format===vb?j=D.shadow.map.texture:j=D.shadow.map.depthTexture||D.shadow.map.texture),D.isAmbientLight)c+=N.r*R,h+=N.g*R,d+=N.b*R;else if(D.isLightProbe){for(let I=0;I<9;I++)r.probe[I].addScaledVector(D.sh.coefficients[I],R);A++}else if(D.isDirectionalLight){const I=e.get(D);if(I.color.copy(D.color).multiplyScalar(D.intensity),D.castShadow){const F=D.shadow,$=t.get(D);$.shadowIntensity=F.intensity,$.shadowBias=F.bias,$.shadowNormalBias=F.normalBias,$.shadowRadius=F.radius,$.shadowMapSize=F.mapSize,r.directionalShadow[f]=$,r.directionalShadowMap[f]=j,r.directionalShadowMatrix[f]=D.shadow.matrix,b++}r.directional[f]=I,f++}else if(D.isSpotLight){const I=e.get(D);I.position.setFromMatrixPosition(D.matrixWorld),I.color.copy(N).multiplyScalar(R),I.distance=z,I.coneCos=Math.cos(D.angle),I.penumbraCos=Math.cos(D.angle*(1-D.penumbra)),I.decay=D.decay,r.spot[m]=I;const F=D.shadow;if(D.map&&(r.spotLightMap[_]=D.map,_++,F.updateMatrices(D),D.castShadow&&E++),r.spotLightMatrix[m]=F.matrix,D.castShadow){const $=t.get(D);$.shadowIntensity=F.intensity,$.shadowBias=F.bias,$.shadowNormalBias=F.normalBias,$.shadowRadius=F.radius,$.shadowMapSize=F.mapSize,r.spotShadow[m]=$,r.spotShadowMap[m]=j,w++}m++}else if(D.isRectAreaLight){const I=e.get(D);I.color.copy(N).multiplyScalar(R),I.halfWidth.set(D.width*.5,0,0),I.halfHeight.set(0,D.height*.5,0),r.rectArea[y]=I,y++}else if(D.isPointLight){const I=e.get(D);if(I.color.copy(D.color).multiplyScalar(D.intensity),I.distance=D.distance,I.decay=D.decay,D.castShadow){const F=D.shadow,$=t.get(D);$.shadowIntensity=F.intensity,$.shadowBias=F.bias,$.shadowNormalBias=F.normalBias,$.shadowRadius=F.radius,$.shadowMapSize=F.mapSize,$.shadowCameraNear=F.camera.near,$.shadowCameraFar=F.camera.far,r.pointShadow[p]=$,r.pointShadowMap[p]=j,r.pointShadowMatrix[p]=D.shadow.matrix,x++}r.point[p]=I,p++}else if(D.isHemisphereLight){const I=e.get(D);I.skyColor.copy(D.color).multiplyScalar(R),I.groundColor.copy(D.groundColor).multiplyScalar(R),r.hemi[v]=I,v++}}y>0&&(n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=lt.LTC_FLOAT_1,r.rectAreaLTC2=lt.LTC_FLOAT_2):(r.rectAreaLTC1=lt.LTC_HALF_1,r.rectAreaLTC2=lt.LTC_HALF_2)),r.ambient[0]=c,r.ambient[1]=h,r.ambient[2]=d;const T=r.hash;(T.directionalLength!==f||T.pointLength!==p||T.spotLength!==m||T.rectAreaLength!==y||T.hemiLength!==v||T.numDirectionalShadows!==b||T.numPointShadows!==x||T.numSpotShadows!==w||T.numSpotMaps!==_||T.numLightProbes!==A)&&(r.directional.length=f,r.spot.length=m,r.rectArea.length=y,r.point.length=p,r.hemi.length=v,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=x,r.pointShadowMap.length=x,r.spotShadow.length=w,r.spotShadowMap.length=w,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=x,r.spotLightMatrix.length=w+_-E,r.spotLightMap.length=_,r.numSpotLightShadowsWithMaps=E,r.numLightProbes=A,T.directionalLength=f,T.pointLength=p,T.spotLength=m,T.rectAreaLength=y,T.hemiLength=v,T.numDirectionalShadows=b,T.numPointShadows=x,T.numSpotShadows=w,T.numSpotMaps=_,T.numLightProbes=A,r.version=ATe++)}function l(u,c){let h=0,d=0,f=0,p=0,m=0;const y=c.matrixWorldInverse;for(let v=0,b=u.length;v<b;v++){const x=u[v];if(x.isDirectionalLight){const w=r.directional[h];w.direction.setFromMatrixPosition(x.matrixWorld),i.setFromMatrixPosition(x.target.matrixWorld),w.direction.sub(i),w.direction.transformDirection(y),h++}else if(x.isSpotLight){const w=r.spot[f];w.position.setFromMatrixPosition(x.matrixWorld),w.position.applyMatrix4(y),w.direction.setFromMatrixPosition(x.matrixWorld),i.setFromMatrixPosition(x.target.matrixWorld),w.direction.sub(i),w.direction.transformDirection(y),f++}else if(x.isRectAreaLight){const w=r.rectArea[p];w.position.setFromMatrixPosition(x.matrixWorld),w.position.applyMatrix4(y),a.identity(),s.copy(x.matrixWorld),s.premultiply(y),a.extractRotation(s),w.halfWidth.set(x.width*.5,0,0),w.halfHeight.set(0,x.height*.5,0),w.halfWidth.applyMatrix4(a),w.halfHeight.applyMatrix4(a),p++}else if(x.isPointLight){const w=r.point[d];w.position.setFromMatrixPosition(x.matrixWorld),w.position.applyMatrix4(y),d++}else if(x.isHemisphereLight){const w=r.hemi[m];w.direction.setFromMatrixPosition(x.matrixWorld),w.direction.transformDirection(y),m++}}}return{setup:o,setupView:l,state:r}}function W9(n){const e=new MTe(n),t=[],r=[];function i(c){u.camera=c,t.length=0,r.length=0}function s(c){t.push(c)}function a(c){r.push(c)}function o(){e.setup(t)}function l(c){e.setupView(t,c)}const u={lightsArray:t,shadowsArray:r,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:u,setupLights:o,setupLightsView:l,pushLight:s,pushShadow:a}}function CTe(n){let e=new WeakMap;function t(i,s=0){const a=e.get(i);let o;return a===void 0?(o=new W9(n),e.set(i,[o])):s>=a.length?(o=new W9(n),a.push(o)):o=a[s],o}function r(){e=new WeakMap}return{get:t,dispose:r}}const DTe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,NTe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,RTe=[new De(1,0,0),new De(-1,0,0),new De(0,1,0),new De(0,-1,0),new De(0,0,1),new De(0,0,-1)],ITe=[new De(0,-1,0),new De(0,-1,0),new De(0,0,1),new De(0,0,-1),new De(0,-1,0),new De(0,-1,0)],X9=new Rr,D_=new De,jI=new De;function PTe(n,e,t){let r=new $4;const i=new Ln,s=new Ln,a=new Zr,o=new W1e,l=new X1e,u={},c=t.maxTextureSize,h={[Pp]:to,[to]:Pp,[kh]:kh},d=new Cc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ln},radius:{value:4}},vertexShader:DTe,fragmentShader:NTe}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new Ms;p.setAttribute("position",new Ya(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new cr(p,d),y=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=aC;let v=this.type;this.render=function(E,A,T){if(y.enabled===!1||y.autoUpdate===!1&&y.needsUpdate===!1||E.length===0)return;E.type===k_e&&(Ht("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),E.type=aC);const S=n.getRenderTarget(),M=n.getActiveCubeFace(),D=n.getActiveMipmapLevel(),N=n.state;N.setBlending(Kh),N.buffers.depth.getReversed()===!0?N.buffers.color.setClear(0,0,0,0):N.buffers.color.setClear(1,1,1,1),N.buffers.depth.setTest(!0),N.setScissorTest(!1);const R=v!==this.type;R&&A.traverse(function(z){z.material&&(Array.isArray(z.material)?z.material.forEach(j=>j.needsUpdate=!0):z.material.needsUpdate=!0)});for(let z=0,j=E.length;z<j;z++){const I=E[z],F=I.shadow;if(F===void 0){Ht("WebGLShadowMap:",I,"has no shadow.");continue}if(F.autoUpdate===!1&&F.needsUpdate===!1)continue;i.copy(F.mapSize);const $=F.getFrameExtents();if(i.multiply($),s.copy(F.mapSize),(i.x>c||i.y>c)&&(i.x>c&&(s.x=Math.floor(c/$.x),i.x=s.x*$.x,F.mapSize.x=s.x),i.y>c&&(s.y=Math.floor(c/$.y),i.y=s.y*$.y,F.mapSize.y=s.y)),F.map===null||R===!0){if(F.map!==null&&(F.map.depthTexture!==null&&(F.map.depthTexture.dispose(),F.map.depthTexture=null),F.map.dispose()),this.type===h1){if(I.isPointLight){Ht("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}F.map=new Ec(i.x,i.y,{format:vb,type:pd,minFilter:Qs,magFilter:Qs,generateMipmaps:!1}),F.map.texture.name=I.name+".shadowMap",F.map.depthTexture=new Cw(i.x,i.y,lc),F.map.depthTexture.name=I.name+".shadowMapDepth",F.map.depthTexture.format=md,F.map.depthTexture.compareFunction=null,F.map.depthTexture.minFilter=ws,F.map.depthTexture.magFilter=ws}else{I.isPointLight?(F.map=new qee(i.x),F.map.depthTexture=new G1e(i.x,Mc)):(F.map=new Ec(i.x,i.y),F.map.depthTexture=new Cw(i.x,i.y,Mc)),F.map.depthTexture.name=I.name+".shadowMap",F.map.depthTexture.format=md;const Z=n.state.buffers.depth.getReversed();this.type===aC?(F.map.depthTexture.compareFunction=Z?U4:B4,F.map.depthTexture.minFilter=Qs,F.map.depthTexture.magFilter=Qs):(F.map.depthTexture.compareFunction=null,F.map.depthTexture.minFilter=ws,F.map.depthTexture.magFilter=ws)}F.camera.updateProjectionMatrix()}const H=F.map.isWebGLCubeRenderTarget?6:1;for(let Z=0;Z<H;Z++){if(F.map.isWebGLCubeRenderTarget)n.setRenderTarget(F.map,Z),n.clear();else{Z===0&&(n.setRenderTarget(F.map),n.clear());const J=F.getViewport(Z);a.set(s.x*J.x,s.y*J.y,s.x*J.z,s.y*J.w),N.viewport(a)}if(I.isPointLight){const J=F.camera,ee=F.matrix,O=I.distance||J.far;O!==J.far&&(J.far=O,J.updateProjectionMatrix()),D_.setFromMatrixPosition(I.matrixWorld),J.position.copy(D_),jI.copy(J.position),jI.add(RTe[Z]),J.up.copy(ITe[Z]),J.lookAt(jI),J.updateMatrixWorld(),ee.makeTranslation(-D_.x,-D_.y,-D_.z),X9.multiplyMatrices(J.projectionMatrix,J.matrixWorldInverse),F._frustum.setFromProjectionMatrix(X9,J.coordinateSystem,J.reversedDepth)}else F.updateMatrices(I);r=F.getFrustum(),w(A,T,F.camera,I,this.type)}F.isPointLightShadow!==!0&&this.type===h1&&b(F,T),F.needsUpdate=!1}v=this.type,y.needsUpdate=!1,n.setRenderTarget(S,M,D)};function b(E,A){const T=e.update(m);d.defines.VSM_SAMPLES!==E.blurSamples&&(d.defines.VSM_SAMPLES=E.blurSamples,f.defines.VSM_SAMPLES=E.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),E.mapPass===null&&(E.mapPass=new Ec(i.x,i.y,{format:vb,type:pd})),d.uniforms.shadow_pass.value=E.map.depthTexture,d.uniforms.resolution.value=E.mapSize,d.uniforms.radius.value=E.radius,n.setRenderTarget(E.mapPass),n.clear(),n.renderBufferDirect(A,null,T,d,m,null),f.uniforms.shadow_pass.value=E.mapPass.texture,f.uniforms.resolution.value=E.mapSize,f.uniforms.radius.value=E.radius,n.setRenderTarget(E.map),n.clear(),n.renderBufferDirect(A,null,T,f,m,null)}function x(E,A,T,S){let M=null;const D=T.isPointLight===!0?E.customDistanceMaterial:E.customDepthMaterial;if(D!==void 0)M=D;else if(M=T.isPointLight===!0?l:o,n.localClippingEnabled&&A.clipShadows===!0&&Array.isArray(A.clippingPlanes)&&A.clippingPlanes.length!==0||A.displacementMap&&A.displacementScale!==0||A.alphaMap&&A.alphaTest>0||A.map&&A.alphaTest>0||A.alphaToCoverage===!0){const N=M.uuid,R=A.uuid;let z=u[N];z===void 0&&(z={},u[N]=z);let j=z[R];j===void 0&&(j=M.clone(),z[R]=j,A.addEventListener("dispose",_)),M=j}if(M.visible=A.visible,M.wireframe=A.wireframe,S===h1?M.side=A.shadowSide!==null?A.shadowSide:A.side:M.side=A.shadowSide!==null?A.shadowSide:h[A.side],M.alphaMap=A.alphaMap,M.alphaTest=A.alphaToCoverage===!0?.5:A.alphaTest,M.map=A.map,M.clipShadows=A.clipShadows,M.clippingPlanes=A.clippingPlanes,M.clipIntersection=A.clipIntersection,M.displacementMap=A.displacementMap,M.displacementScale=A.displacementScale,M.displacementBias=A.displacementBias,M.wireframeLinewidth=A.wireframeLinewidth,M.linewidth=A.linewidth,T.isPointLight===!0&&M.isMeshDistanceMaterial===!0){const N=n.properties.get(M);N.light=T}return M}function w(E,A,T,S,M){if(E.visible===!1)return;if(E.layers.test(A.layers)&&(E.isMesh||E.isLine||E.isPoints)&&(E.castShadow||E.receiveShadow&&M===h1)&&(!E.frustumCulled||r.intersectsObject(E))){E.modelViewMatrix.multiplyMatrices(T.matrixWorldInverse,E.matrixWorld);const R=e.update(E),z=E.material;if(Array.isArray(z)){const j=R.groups;for(let I=0,F=j.length;I<F;I++){const $=j[I],H=z[$.materialIndex];if(H&&H.visible){const Z=x(E,H,S,M);E.onBeforeShadow(n,E,A,T,R,Z,$),n.renderBufferDirect(T,null,R,Z,E,$),E.onAfterShadow(n,E,A,T,R,Z,$)}}}else if(z.visible){const j=x(E,z,S,M);E.onBeforeShadow(n,E,A,T,R,j,null),n.renderBufferDirect(T,null,R,j,E,null),E.onAfterShadow(n,E,A,T,R,j,null)}}const N=E.children;for(let R=0,z=N.length;R<z;R++)w(N[R],A,T,S,M)}function _(E){E.target.removeEventListener("dispose",_);for(const T in u){const S=u[T],M=E.target.uuid;M in S&&(S[M].dispose(),delete S[M])}}}const FTe={[EL]:SL,[AL]:CL,[TL]:DL,[mb]:ML,[SL]:EL,[CL]:AL,[DL]:TL,[ML]:mb};function LTe(n,e){function t(){let W=!1;const ye=new Zr;let Ee=null;const Fe=new Zr(0,0,0,0);return{setMask:function(Le){Ee!==Le&&!W&&(n.colorMask(Le,Le,Le,Le),Ee=Le)},setLocked:function(Le){W=Le},setClear:function(Le,Ue,nt,Pt,Vn){Vn===!0&&(Le*=Pt,Ue*=Pt,nt*=Pt),ye.set(Le,Ue,nt,Pt),Fe.equals(ye)===!1&&(n.clearColor(Le,Ue,nt,Pt),Fe.copy(ye))},reset:function(){W=!1,Ee=null,Fe.set(-1,0,0,0)}}}function r(){let W=!1,ye=!1,Ee=null,Fe=null,Le=null;return{setReversed:function(Ue){if(ye!==Ue){const nt=e.get("EXT_clip_control");Ue?nt.clipControlEXT(nt.LOWER_LEFT_EXT,nt.ZERO_TO_ONE_EXT):nt.clipControlEXT(nt.LOWER_LEFT_EXT,nt.NEGATIVE_ONE_TO_ONE_EXT),ye=Ue;const Pt=Le;Le=null,this.setClear(Pt)}},getReversed:function(){return ye},setTest:function(Ue){Ue?le(n.DEPTH_TEST):te(n.DEPTH_TEST)},setMask:function(Ue){Ee!==Ue&&!W&&(n.depthMask(Ue),Ee=Ue)},setFunc:function(Ue){if(ye&&(Ue=FTe[Ue]),Fe!==Ue){switch(Ue){case EL:n.depthFunc(n.NEVER);break;case SL:n.depthFunc(n.ALWAYS);break;case AL:n.depthFunc(n.LESS);break;case mb:n.depthFunc(n.LEQUAL);break;case TL:n.depthFunc(n.EQUAL);break;case ML:n.depthFunc(n.GEQUAL);break;case CL:n.depthFunc(n.GREATER);break;case DL:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Fe=Ue}},setLocked:function(Ue){W=Ue},setClear:function(Ue){Le!==Ue&&(ye&&(Ue=1-Ue),n.clearDepth(Ue),Le=Ue)},reset:function(){W=!1,Ee=null,Fe=null,Le=null,ye=!1}}}function i(){let W=!1,ye=null,Ee=null,Fe=null,Le=null,Ue=null,nt=null,Pt=null,Vn=null;return{setTest:function(dn){W||(dn?le(n.STENCIL_TEST):te(n.STENCIL_TEST))},setMask:function(dn){ye!==dn&&!W&&(n.stencilMask(dn),ye=dn)},setFunc:function(dn,Ia,io){(Ee!==dn||Fe!==Ia||Le!==io)&&(n.stencilFunc(dn,Ia,io),Ee=dn,Fe=Ia,Le=io)},setOp:function(dn,Ia,io){(Ue!==dn||nt!==Ia||Pt!==io)&&(n.stencilOp(dn,Ia,io),Ue=dn,nt=Ia,Pt=io)},setLocked:function(dn){W=dn},setClear:function(dn){Vn!==dn&&(n.clearStencil(dn),Vn=dn)},reset:function(){W=!1,ye=null,Ee=null,Fe=null,Le=null,Ue=null,nt=null,Pt=null,Vn=null}}}const s=new t,a=new r,o=new i,l=new WeakMap,u=new WeakMap;let c={},h={},d=new WeakMap,f=[],p=null,m=!1,y=null,v=null,b=null,x=null,w=null,_=null,E=null,A=new Bt(0,0,0),T=0,S=!1,M=null,D=null,N=null,R=null,z=null;const j=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let I=!1,F=0;const $=n.getParameter(n.VERSION);$.indexOf("WebGL")!==-1?(F=parseFloat(/^WebGL (\d)/.exec($)[1]),I=F>=1):$.indexOf("OpenGL ES")!==-1&&(F=parseFloat(/^OpenGL ES (\d)/.exec($)[1]),I=F>=2);let H=null,Z={};const J=n.getParameter(n.SCISSOR_BOX),ee=n.getParameter(n.VIEWPORT),O=new Zr().fromArray(J),ue=new Zr().fromArray(ee);function Q(W,ye,Ee,Fe){const Le=new Uint8Array(4),Ue=n.createTexture();n.bindTexture(W,Ue),n.texParameteri(W,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(W,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let nt=0;nt<Ee;nt++)W===n.TEXTURE_3D||W===n.TEXTURE_2D_ARRAY?n.texImage3D(ye,0,n.RGBA,1,1,Fe,0,n.RGBA,n.UNSIGNED_BYTE,Le):n.texImage2D(ye+nt,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Le);return Ue}const re={};re[n.TEXTURE_2D]=Q(n.TEXTURE_2D,n.TEXTURE_2D,1),re[n.TEXTURE_CUBE_MAP]=Q(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),re[n.TEXTURE_2D_ARRAY]=Q(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),re[n.TEXTURE_3D]=Q(n.TEXTURE_3D,n.TEXTURE_3D,1,1),s.setClear(0,0,0,1),a.setClear(1),o.setClear(0),le(n.DEPTH_TEST),a.setFunc(mb),ze(!1),tt(W8),le(n.CULL_FACE),_e(Kh);function le(W){c[W]!==!0&&(n.enable(W),c[W]=!0)}function te(W){c[W]!==!1&&(n.disable(W),c[W]=!1)}function Y(W,ye){return h[W]!==ye?(n.bindFramebuffer(W,ye),h[W]=ye,W===n.DRAW_FRAMEBUFFER&&(h[n.FRAMEBUFFER]=ye),W===n.FRAMEBUFFER&&(h[n.DRAW_FRAMEBUFFER]=ye),!0):!1}function oe(W,ye){let Ee=f,Fe=!1;if(W){Ee=d.get(ye),Ee===void 0&&(Ee=[],d.set(ye,Ee));const Le=W.textures;if(Ee.length!==Le.length||Ee[0]!==n.COLOR_ATTACHMENT0){for(let Ue=0,nt=Le.length;Ue<nt;Ue++)Ee[Ue]=n.COLOR_ATTACHMENT0+Ue;Ee.length=Le.length,Fe=!0}}else Ee[0]!==n.BACK&&(Ee[0]=n.BACK,Fe=!0);Fe&&n.drawBuffers(Ee)}function ve(W){return p!==W?(n.useProgram(W),p=W,!0):!1}const me={[Rm]:n.FUNC_ADD,[U_e]:n.FUNC_SUBTRACT,[V_e]:n.FUNC_REVERSE_SUBTRACT};me[z_e]=n.MIN,me[$_e]=n.MAX;const be={[H_e]:n.ZERO,[G_e]:n.ONE,[j_e]:n.SRC_COLOR,[_L]:n.SRC_ALPHA,[Q_e]:n.SRC_ALPHA_SATURATE,[K_e]:n.DST_COLOR,[W_e]:n.DST_ALPHA,[q_e]:n.ONE_MINUS_SRC_COLOR,[wL]:n.ONE_MINUS_SRC_ALPHA,[Y_e]:n.ONE_MINUS_DST_COLOR,[X_e]:n.ONE_MINUS_DST_ALPHA,[Z_e]:n.CONSTANT_COLOR,[J_e]:n.ONE_MINUS_CONSTANT_COLOR,[e1e]:n.CONSTANT_ALPHA,[t1e]:n.ONE_MINUS_CONSTANT_ALPHA};function _e(W,ye,Ee,Fe,Le,Ue,nt,Pt,Vn,dn){if(W===Kh){m===!0&&(te(n.BLEND),m=!1);return}if(m===!1&&(le(n.BLEND),m=!0),W!==B_e){if(W!==y||dn!==S){if((v!==Rm||w!==Rm)&&(n.blendEquation(n.FUNC_ADD),v=Rm,w=Rm),dn)switch(W){case Sy:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case X8:n.blendFunc(n.ONE,n.ONE);break;case K8:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case Y8:n.blendFuncSeparate(n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ZERO,n.ONE);break;default:Bn("WebGLState: Invalid blending: ",W);break}else switch(W){case Sy:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case X8:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE,n.ONE,n.ONE);break;case K8:Bn("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case Y8:Bn("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Bn("WebGLState: Invalid blending: ",W);break}b=null,x=null,_=null,E=null,A.set(0,0,0),T=0,y=W,S=dn}return}Le=Le||ye,Ue=Ue||Ee,nt=nt||Fe,(ye!==v||Le!==w)&&(n.blendEquationSeparate(me[ye],me[Le]),v=ye,w=Le),(Ee!==b||Fe!==x||Ue!==_||nt!==E)&&(n.blendFuncSeparate(be[Ee],be[Fe],be[Ue],be[nt]),b=Ee,x=Fe,_=Ue,E=nt),(Pt.equals(A)===!1||Vn!==T)&&(n.blendColor(Pt.r,Pt.g,Pt.b,Vn),A.copy(Pt),T=Vn),y=W,S=!1}function Be(W,ye){W.side===kh?te(n.CULL_FACE):le(n.CULL_FACE);let Ee=W.side===to;ye&&(Ee=!Ee),ze(Ee),W.blending===Sy&&W.transparent===!1?_e(Kh):_e(W.blending,W.blendEquation,W.blendSrc,W.blendDst,W.blendEquationAlpha,W.blendSrcAlpha,W.blendDstAlpha,W.blendColor,W.blendAlpha,W.premultipliedAlpha),a.setFunc(W.depthFunc),a.setTest(W.depthTest),a.setMask(W.depthWrite),s.setMask(W.colorWrite);const Fe=W.stencilWrite;o.setTest(Fe),Fe&&(o.setMask(W.stencilWriteMask),o.setFunc(W.stencilFunc,W.stencilRef,W.stencilFuncMask),o.setOp(W.stencilFail,W.stencilZFail,W.stencilZPass)),Xe(W.polygonOffset,W.polygonOffsetFactor,W.polygonOffsetUnits),W.alphaToCoverage===!0?le(n.SAMPLE_ALPHA_TO_COVERAGE):te(n.SAMPLE_ALPHA_TO_COVERAGE)}function ze(W){M!==W&&(W?n.frontFace(n.CW):n.frontFace(n.CCW),M=W)}function tt(W){W!==L_e?(le(n.CULL_FACE),W!==D&&(W===W8?n.cullFace(n.BACK):W===O_e?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):te(n.CULL_FACE),D=W}function de(W){W!==N&&(I&&n.lineWidth(W),N=W)}function Xe(W,ye,Ee){W?(le(n.POLYGON_OFFSET_FILL),(R!==ye||z!==Ee)&&(n.polygonOffset(ye,Ee),R=ye,z=Ee)):te(n.POLYGON_OFFSET_FILL)}function Ke(W){W?le(n.SCISSOR_TEST):te(n.SCISSOR_TEST)}function se(W){W===void 0&&(W=n.TEXTURE0+j-1),H!==W&&(n.activeTexture(W),H=W)}function fe(W,ye,Ee){Ee===void 0&&(H===null?Ee=n.TEXTURE0+j-1:Ee=H);let Fe=Z[Ee];Fe===void 0&&(Fe={type:void 0,texture:void 0},Z[Ee]=Fe),(Fe.type!==W||Fe.texture!==ye)&&(H!==Ee&&(n.activeTexture(Ee),H=Ee),n.bindTexture(W,ye||re[W]),Fe.type=W,Fe.texture=ye)}function L(){const W=Z[H];W!==void 0&&W.type!==void 0&&(n.bindTexture(W.type,null),W.type=void 0,W.texture=void 0)}function P(){try{n.compressedTexImage2D(...arguments)}catch(W){Bn("WebGLState:",W)}}function K(){try{n.compressedTexImage3D(...arguments)}catch(W){Bn("WebGLState:",W)}}function ae(){try{n.texSubImage2D(...arguments)}catch(W){Bn("WebGLState:",W)}}function pe(){try{n.texSubImage3D(...arguments)}catch(W){Bn("WebGLState:",W)}}function ce(){try{n.compressedTexSubImage2D(...arguments)}catch(W){Bn("WebGLState:",W)}}function Ae(){try{n.compressedTexSubImage3D(...arguments)}catch(W){Bn("WebGLState:",W)}}function we(){try{n.texStorage2D(...arguments)}catch(W){Bn("WebGLState:",W)}}function Pe(){try{n.texStorage3D(...arguments)}catch(W){Bn("WebGLState:",W)}}function Te(){try{n.texImage2D(...arguments)}catch(W){Bn("WebGLState:",W)}}function Ne(){try{n.texImage3D(...arguments)}catch(W){Bn("WebGLState:",W)}}function $e(W){O.equals(W)===!1&&(n.scissor(W.x,W.y,W.z,W.w),O.copy(W))}function Ye(W){ue.equals(W)===!1&&(n.viewport(W.x,W.y,W.z,W.w),ue.copy(W))}function Ge(W,ye){let Ee=u.get(ye);Ee===void 0&&(Ee=new WeakMap,u.set(ye,Ee));let Fe=Ee.get(W);Fe===void 0&&(Fe=n.getUniformBlockIndex(ye,W.name),Ee.set(W,Fe))}function qe(W,ye){const Fe=u.get(ye).get(W);l.get(ye)!==Fe&&(n.uniformBlockBinding(ye,Fe,W.__bindingPointIndex),l.set(ye,Fe))}function V(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),a.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),c={},H=null,Z={},h={},d=new WeakMap,f=[],p=null,m=!1,y=null,v=null,b=null,x=null,w=null,_=null,E=null,A=new Bt(0,0,0),T=0,S=!1,M=null,D=null,N=null,R=null,z=null,O.set(0,0,n.canvas.width,n.canvas.height),ue.set(0,0,n.canvas.width,n.canvas.height),s.reset(),a.reset(),o.reset()}return{buffers:{color:s,depth:a,stencil:o},enable:le,disable:te,bindFramebuffer:Y,drawBuffers:oe,useProgram:ve,setBlending:_e,setMaterial:Be,setFlipSided:ze,setCullFace:tt,setLineWidth:de,setPolygonOffset:Xe,setScissorTest:Ke,activeTexture:se,bindTexture:fe,unbindTexture:L,compressedTexImage2D:P,compressedTexImage3D:K,texImage2D:Te,texImage3D:Ne,updateUBOMapping:Ge,uniformBlockBinding:qe,texStorage2D:we,texStorage3D:Pe,texSubImage2D:ae,texSubImage3D:pe,compressedTexSubImage2D:ce,compressedTexSubImage3D:Ae,scissor:$e,viewport:Ye,reset:V}}function OTe(n,e,t,r,i,s,a){const o=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new Ln,c=new WeakMap;let h;const d=new WeakMap;let f=!1;try{f=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function p(L,P){return f?new OffscreenCanvas(L,P):MD("canvas")}function m(L,P,K){let ae=1;const pe=fe(L);if((pe.width>K||pe.height>K)&&(ae=K/Math.max(pe.width,pe.height)),ae<1)if(typeof HTMLImageElement<"u"&&L instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&L instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&L instanceof ImageBitmap||typeof VideoFrame<"u"&&L instanceof VideoFrame){const ce=Math.floor(ae*pe.width),Ae=Math.floor(ae*pe.height);h===void 0&&(h=p(ce,Ae));const we=P?p(ce,Ae):h;return we.width=ce,we.height=Ae,we.getContext("2d").drawImage(L,0,0,ce,Ae),Ht("WebGLRenderer: Texture has been resized from ("+pe.width+"x"+pe.height+") to ("+ce+"x"+Ae+")."),we}else return"data"in L&&Ht("WebGLRenderer: Image in DataTexture is too big ("+pe.width+"x"+pe.height+")."),L;return L}function y(L){return L.generateMipmaps}function v(L){n.generateMipmap(L)}function b(L){return L.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:L.isWebGL3DRenderTarget?n.TEXTURE_3D:L.isWebGLArrayRenderTarget||L.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function x(L,P,K,ae,pe=!1){if(L!==null){if(n[L]!==void 0)return n[L];Ht("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+L+"'")}let ce=P;if(P===n.RED&&(K===n.FLOAT&&(ce=n.R32F),K===n.HALF_FLOAT&&(ce=n.R16F),K===n.UNSIGNED_BYTE&&(ce=n.R8)),P===n.RED_INTEGER&&(K===n.UNSIGNED_BYTE&&(ce=n.R8UI),K===n.UNSIGNED_SHORT&&(ce=n.R16UI),K===n.UNSIGNED_INT&&(ce=n.R32UI),K===n.BYTE&&(ce=n.R8I),K===n.SHORT&&(ce=n.R16I),K===n.INT&&(ce=n.R32I)),P===n.RG&&(K===n.FLOAT&&(ce=n.RG32F),K===n.HALF_FLOAT&&(ce=n.RG16F),K===n.UNSIGNED_BYTE&&(ce=n.RG8)),P===n.RG_INTEGER&&(K===n.UNSIGNED_BYTE&&(ce=n.RG8UI),K===n.UNSIGNED_SHORT&&(ce=n.RG16UI),K===n.UNSIGNED_INT&&(ce=n.RG32UI),K===n.BYTE&&(ce=n.RG8I),K===n.SHORT&&(ce=n.RG16I),K===n.INT&&(ce=n.RG32I)),P===n.RGB_INTEGER&&(K===n.UNSIGNED_BYTE&&(ce=n.RGB8UI),K===n.UNSIGNED_SHORT&&(ce=n.RGB16UI),K===n.UNSIGNED_INT&&(ce=n.RGB32UI),K===n.BYTE&&(ce=n.RGB8I),K===n.SHORT&&(ce=n.RGB16I),K===n.INT&&(ce=n.RGB32I)),P===n.RGBA_INTEGER&&(K===n.UNSIGNED_BYTE&&(ce=n.RGBA8UI),K===n.UNSIGNED_SHORT&&(ce=n.RGBA16UI),K===n.UNSIGNED_INT&&(ce=n.RGBA32UI),K===n.BYTE&&(ce=n.RGBA8I),K===n.SHORT&&(ce=n.RGBA16I),K===n.INT&&(ce=n.RGBA32I)),P===n.RGB&&(K===n.UNSIGNED_INT_5_9_9_9_REV&&(ce=n.RGB9_E5),K===n.UNSIGNED_INT_10F_11F_11F_REV&&(ce=n.R11F_G11F_B10F)),P===n.RGBA){const Ae=pe?AD:Rn.getTransfer(ae);K===n.FLOAT&&(ce=n.RGBA32F),K===n.HALF_FLOAT&&(ce=n.RGBA16F),K===n.UNSIGNED_BYTE&&(ce=Ae===qn?n.SRGB8_ALPHA8:n.RGBA8),K===n.UNSIGNED_SHORT_4_4_4_4&&(ce=n.RGBA4),K===n.UNSIGNED_SHORT_5_5_5_1&&(ce=n.RGB5_A1)}return(ce===n.R16F||ce===n.R32F||ce===n.RG16F||ce===n.RG32F||ce===n.RGBA16F||ce===n.RGBA32F)&&e.get("EXT_color_buffer_float"),ce}function w(L,P){let K;return L?P===null||P===Mc||P===Tw?K=n.DEPTH24_STENCIL8:P===lc?K=n.DEPTH32F_STENCIL8:P===Aw&&(K=n.DEPTH24_STENCIL8,Ht("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):P===null||P===Mc||P===Tw?K=n.DEPTH_COMPONENT24:P===lc?K=n.DEPTH_COMPONENT32F:P===Aw&&(K=n.DEPTH_COMPONENT16),K}function _(L,P){return y(L)===!0||L.isFramebufferTexture&&L.minFilter!==ws&&L.minFilter!==Qs?Math.log2(Math.max(P.width,P.height))+1:L.mipmaps!==void 0&&L.mipmaps.length>0?L.mipmaps.length:L.isCompressedTexture&&Array.isArray(L.image)?P.mipmaps.length:1}function E(L){const P=L.target;P.removeEventListener("dispose",E),T(P),P.isVideoTexture&&c.delete(P)}function A(L){const P=L.target;P.removeEventListener("dispose",A),M(P)}function T(L){const P=r.get(L);if(P.__webglInit===void 0)return;const K=L.source,ae=d.get(K);if(ae){const pe=ae[P.__cacheKey];pe.usedTimes--,pe.usedTimes===0&&S(L),Object.keys(ae).length===0&&d.delete(K)}r.remove(L)}function S(L){const P=r.get(L);n.deleteTexture(P.__webglTexture);const K=L.source,ae=d.get(K);delete ae[P.__cacheKey],a.memory.textures--}function M(L){const P=r.get(L);if(L.depthTexture&&(L.depthTexture.dispose(),r.remove(L.depthTexture)),L.isWebGLCubeRenderTarget)for(let ae=0;ae<6;ae++){if(Array.isArray(P.__webglFramebuffer[ae]))for(let pe=0;pe<P.__webglFramebuffer[ae].length;pe++)n.deleteFramebuffer(P.__webglFramebuffer[ae][pe]);else n.deleteFramebuffer(P.__webglFramebuffer[ae]);P.__webglDepthbuffer&&n.deleteRenderbuffer(P.__webglDepthbuffer[ae])}else{if(Array.isArray(P.__webglFramebuffer))for(let ae=0;ae<P.__webglFramebuffer.length;ae++)n.deleteFramebuffer(P.__webglFramebuffer[ae]);else n.deleteFramebuffer(P.__webglFramebuffer);if(P.__webglDepthbuffer&&n.deleteRenderbuffer(P.__webglDepthbuffer),P.__webglMultisampledFramebuffer&&n.deleteFramebuffer(P.__webglMultisampledFramebuffer),P.__webglColorRenderbuffer)for(let ae=0;ae<P.__webglColorRenderbuffer.length;ae++)P.__webglColorRenderbuffer[ae]&&n.deleteRenderbuffer(P.__webglColorRenderbuffer[ae]);P.__webglDepthRenderbuffer&&n.deleteRenderbuffer(P.__webglDepthRenderbuffer)}const K=L.textures;for(let ae=0,pe=K.length;ae<pe;ae++){const ce=r.get(K[ae]);ce.__webglTexture&&(n.deleteTexture(ce.__webglTexture),a.memory.textures--),r.remove(K[ae])}r.remove(L)}let D=0;function N(){D=0}function R(){const L=D;return L>=i.maxTextures&&Ht("WebGLTextures: Trying to use "+L+" texture units while this GPU supports only "+i.maxTextures),D+=1,L}function z(L){const P=[];return P.push(L.wrapS),P.push(L.wrapT),P.push(L.wrapR||0),P.push(L.magFilter),P.push(L.minFilter),P.push(L.anisotropy),P.push(L.internalFormat),P.push(L.format),P.push(L.type),P.push(L.generateMipmaps),P.push(L.premultiplyAlpha),P.push(L.flipY),P.push(L.unpackAlignment),P.push(L.colorSpace),P.join()}function j(L,P){const K=r.get(L);if(L.isVideoTexture&&Ke(L),L.isRenderTargetTexture===!1&&L.isExternalTexture!==!0&&L.version>0&&K.__version!==L.version){const ae=L.image;if(ae===null)Ht("WebGLRenderer: Texture marked for update but no image data found.");else if(ae.complete===!1)Ht("WebGLRenderer: Texture marked for update but image is incomplete");else{re(K,L,P);return}}else L.isExternalTexture&&(K.__webglTexture=L.sourceTexture?L.sourceTexture:null);t.bindTexture(n.TEXTURE_2D,K.__webglTexture,n.TEXTURE0+P)}function I(L,P){const K=r.get(L);if(L.isRenderTargetTexture===!1&&L.version>0&&K.__version!==L.version){re(K,L,P);return}else L.isExternalTexture&&(K.__webglTexture=L.sourceTexture?L.sourceTexture:null);t.bindTexture(n.TEXTURE_2D_ARRAY,K.__webglTexture,n.TEXTURE0+P)}function F(L,P){const K=r.get(L);if(L.isRenderTargetTexture===!1&&L.version>0&&K.__version!==L.version){re(K,L,P);return}t.bindTexture(n.TEXTURE_3D,K.__webglTexture,n.TEXTURE0+P)}function $(L,P){const K=r.get(L);if(L.isCubeDepthTexture!==!0&&L.version>0&&K.__version!==L.version){le(K,L,P);return}t.bindTexture(n.TEXTURE_CUBE_MAP,K.__webglTexture,n.TEXTURE0+P)}const H={[IL]:n.REPEAT,[$h]:n.CLAMP_TO_EDGE,[PL]:n.MIRRORED_REPEAT},Z={[ws]:n.NEAREST,[i1e]:n.NEAREST_MIPMAP_NEAREST,[oT]:n.NEAREST_MIPMAP_LINEAR,[Qs]:n.LINEAR,[fI]:n.LINEAR_MIPMAP_NEAREST,[Hm]:n.LINEAR_MIPMAP_LINEAR},J={[o1e]:n.NEVER,[d1e]:n.ALWAYS,[l1e]:n.LESS,[B4]:n.LEQUAL,[u1e]:n.EQUAL,[U4]:n.GEQUAL,[c1e]:n.GREATER,[h1e]:n.NOTEQUAL};function ee(L,P){if(P.type===lc&&e.has("OES_texture_float_linear")===!1&&(P.magFilter===Qs||P.magFilter===fI||P.magFilter===oT||P.magFilter===Hm||P.minFilter===Qs||P.minFilter===fI||P.minFilter===oT||P.minFilter===Hm)&&Ht("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(L,n.TEXTURE_WRAP_S,H[P.wrapS]),n.texParameteri(L,n.TEXTURE_WRAP_T,H[P.wrapT]),(L===n.TEXTURE_3D||L===n.TEXTURE_2D_ARRAY)&&n.texParameteri(L,n.TEXTURE_WRAP_R,H[P.wrapR]),n.texParameteri(L,n.TEXTURE_MAG_FILTER,Z[P.magFilter]),n.texParameteri(L,n.TEXTURE_MIN_FILTER,Z[P.minFilter]),P.compareFunction&&(n.texParameteri(L,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(L,n.TEXTURE_COMPARE_FUNC,J[P.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(P.magFilter===ws||P.minFilter!==oT&&P.minFilter!==Hm||P.type===lc&&e.has("OES_texture_float_linear")===!1)return;if(P.anisotropy>1||r.get(P).__currentAnisotropy){const K=e.get("EXT_texture_filter_anisotropic");n.texParameterf(L,K.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(P.anisotropy,i.getMaxAnisotropy())),r.get(P).__currentAnisotropy=P.anisotropy}}}function O(L,P){let K=!1;L.__webglInit===void 0&&(L.__webglInit=!0,P.addEventListener("dispose",E));const ae=P.source;let pe=d.get(ae);pe===void 0&&(pe={},d.set(ae,pe));const ce=z(P);if(ce!==L.__cacheKey){pe[ce]===void 0&&(pe[ce]={texture:n.createTexture(),usedTimes:0},a.memory.textures++,K=!0),pe[ce].usedTimes++;const Ae=pe[L.__cacheKey];Ae!==void 0&&(pe[L.__cacheKey].usedTimes--,Ae.usedTimes===0&&S(P)),L.__cacheKey=ce,L.__webglTexture=pe[ce].texture}return K}function ue(L,P,K){return Math.floor(Math.floor(L/K)/P)}function Q(L,P,K,ae){const ce=L.updateRanges;if(ce.length===0)t.texSubImage2D(n.TEXTURE_2D,0,0,0,P.width,P.height,K,ae,P.data);else{ce.sort((Ne,$e)=>Ne.start-$e.start);let Ae=0;for(let Ne=1;Ne<ce.length;Ne++){const $e=ce[Ae],Ye=ce[Ne],Ge=$e.start+$e.count,qe=ue(Ye.start,P.width,4),V=ue($e.start,P.width,4);Ye.start<=Ge+1&&qe===V&&ue(Ye.start+Ye.count-1,P.width,4)===qe?$e.count=Math.max($e.count,Ye.start+Ye.count-$e.start):(++Ae,ce[Ae]=Ye)}ce.length=Ae+1;const we=n.getParameter(n.UNPACK_ROW_LENGTH),Pe=n.getParameter(n.UNPACK_SKIP_PIXELS),Te=n.getParameter(n.UNPACK_SKIP_ROWS);n.pixelStorei(n.UNPACK_ROW_LENGTH,P.width);for(let Ne=0,$e=ce.length;Ne<$e;Ne++){const Ye=ce[Ne],Ge=Math.floor(Ye.start/4),qe=Math.ceil(Ye.count/4),V=Ge%P.width,W=Math.floor(Ge/P.width),ye=qe,Ee=1;n.pixelStorei(n.UNPACK_SKIP_PIXELS,V),n.pixelStorei(n.UNPACK_SKIP_ROWS,W),t.texSubImage2D(n.TEXTURE_2D,0,V,W,ye,Ee,K,ae,P.data)}L.clearUpdateRanges(),n.pixelStorei(n.UNPACK_ROW_LENGTH,we),n.pixelStorei(n.UNPACK_SKIP_PIXELS,Pe),n.pixelStorei(n.UNPACK_SKIP_ROWS,Te)}}function re(L,P,K){let ae=n.TEXTURE_2D;(P.isDataArrayTexture||P.isCompressedArrayTexture)&&(ae=n.TEXTURE_2D_ARRAY),P.isData3DTexture&&(ae=n.TEXTURE_3D);const pe=O(L,P),ce=P.source;t.bindTexture(ae,L.__webglTexture,n.TEXTURE0+K);const Ae=r.get(ce);if(ce.version!==Ae.__version||pe===!0){t.activeTexture(n.TEXTURE0+K);const we=Rn.getPrimaries(Rn.workingColorSpace),Pe=P.colorSpace===sf?null:Rn.getPrimaries(P.colorSpace),Te=P.colorSpace===sf||we===Pe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,P.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,P.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,P.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Te);let Ne=m(P.image,!1,i.maxTextureSize);Ne=se(P,Ne);const $e=s.convert(P.format,P.colorSpace),Ye=s.convert(P.type);let Ge=x(P.internalFormat,$e,Ye,P.colorSpace,P.isVideoTexture);ee(ae,P);let qe;const V=P.mipmaps,W=P.isVideoTexture!==!0,ye=Ae.__version===void 0||pe===!0,Ee=ce.dataReady,Fe=_(P,Ne);if(P.isDepthTexture)Ge=w(P.format===Gm,P.type),ye&&(W?t.texStorage2D(n.TEXTURE_2D,1,Ge,Ne.width,Ne.height):t.texImage2D(n.TEXTURE_2D,0,Ge,Ne.width,Ne.height,0,$e,Ye,null));else if(P.isDataTexture)if(V.length>0){W&&ye&&t.texStorage2D(n.TEXTURE_2D,Fe,Ge,V[0].width,V[0].height);for(let Le=0,Ue=V.length;Le<Ue;Le++)qe=V[Le],W?Ee&&t.texSubImage2D(n.TEXTURE_2D,Le,0,0,qe.width,qe.height,$e,Ye,qe.data):t.texImage2D(n.TEXTURE_2D,Le,Ge,qe.width,qe.height,0,$e,Ye,qe.data);P.generateMipmaps=!1}else W?(ye&&t.texStorage2D(n.TEXTURE_2D,Fe,Ge,Ne.width,Ne.height),Ee&&Q(P,Ne,$e,Ye)):t.texImage2D(n.TEXTURE_2D,0,Ge,Ne.width,Ne.height,0,$e,Ye,Ne.data);else if(P.isCompressedTexture)if(P.isCompressedArrayTexture){W&&ye&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Fe,Ge,V[0].width,V[0].height,Ne.depth);for(let Le=0,Ue=V.length;Le<Ue;Le++)if(qe=V[Le],P.format!==lu)if($e!==null)if(W){if(Ee)if(P.layerUpdates.size>0){const nt=A9(qe.width,qe.height,P.format,P.type);for(const Pt of P.layerUpdates){const Vn=qe.data.subarray(Pt*nt/qe.data.BYTES_PER_ELEMENT,(Pt+1)*nt/qe.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Le,0,0,Pt,qe.width,qe.height,1,$e,Vn)}P.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Le,0,0,0,qe.width,qe.height,Ne.depth,$e,qe.data)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Le,Ge,qe.width,qe.height,Ne.depth,0,qe.data,0,0);else Ht("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else W?Ee&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,Le,0,0,0,qe.width,qe.height,Ne.depth,$e,Ye,qe.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Le,Ge,qe.width,qe.height,Ne.depth,0,$e,Ye,qe.data)}else{W&&ye&&t.texStorage2D(n.TEXTURE_2D,Fe,Ge,V[0].width,V[0].height);for(let Le=0,Ue=V.length;Le<Ue;Le++)qe=V[Le],P.format!==lu?$e!==null?W?Ee&&t.compressedTexSubImage2D(n.TEXTURE_2D,Le,0,0,qe.width,qe.height,$e,qe.data):t.compressedTexImage2D(n.TEXTURE_2D,Le,Ge,qe.width,qe.height,0,qe.data):Ht("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):W?Ee&&t.texSubImage2D(n.TEXTURE_2D,Le,0,0,qe.width,qe.height,$e,Ye,qe.data):t.texImage2D(n.TEXTURE_2D,Le,Ge,qe.width,qe.height,0,$e,Ye,qe.data)}else if(P.isDataArrayTexture)if(W){if(ye&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Fe,Ge,Ne.width,Ne.height,Ne.depth),Ee)if(P.layerUpdates.size>0){const Le=A9(Ne.width,Ne.height,P.format,P.type);for(const Ue of P.layerUpdates){const nt=Ne.data.subarray(Ue*Le/Ne.data.BYTES_PER_ELEMENT,(Ue+1)*Le/Ne.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,Ue,Ne.width,Ne.height,1,$e,Ye,nt)}P.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Ne.width,Ne.height,Ne.depth,$e,Ye,Ne.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,Ge,Ne.width,Ne.height,Ne.depth,0,$e,Ye,Ne.data);else if(P.isData3DTexture)W?(ye&&t.texStorage3D(n.TEXTURE_3D,Fe,Ge,Ne.width,Ne.height,Ne.depth),Ee&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Ne.width,Ne.height,Ne.depth,$e,Ye,Ne.data)):t.texImage3D(n.TEXTURE_3D,0,Ge,Ne.width,Ne.height,Ne.depth,0,$e,Ye,Ne.data);else if(P.isFramebufferTexture){if(ye)if(W)t.texStorage2D(n.TEXTURE_2D,Fe,Ge,Ne.width,Ne.height);else{let Le=Ne.width,Ue=Ne.height;for(let nt=0;nt<Fe;nt++)t.texImage2D(n.TEXTURE_2D,nt,Ge,Le,Ue,0,$e,Ye,null),Le>>=1,Ue>>=1}}else if(V.length>0){if(W&&ye){const Le=fe(V[0]);t.texStorage2D(n.TEXTURE_2D,Fe,Ge,Le.width,Le.height)}for(let Le=0,Ue=V.length;Le<Ue;Le++)qe=V[Le],W?Ee&&t.texSubImage2D(n.TEXTURE_2D,Le,0,0,$e,Ye,qe):t.texImage2D(n.TEXTURE_2D,Le,Ge,$e,Ye,qe);P.generateMipmaps=!1}else if(W){if(ye){const Le=fe(Ne);t.texStorage2D(n.TEXTURE_2D,Fe,Ge,Le.width,Le.height)}Ee&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,$e,Ye,Ne)}else t.texImage2D(n.TEXTURE_2D,0,Ge,$e,Ye,Ne);y(P)&&v(ae),Ae.__version=ce.version,P.onUpdate&&P.onUpdate(P)}L.__version=P.version}function le(L,P,K){if(P.image.length!==6)return;const ae=O(L,P),pe=P.source;t.bindTexture(n.TEXTURE_CUBE_MAP,L.__webglTexture,n.TEXTURE0+K);const ce=r.get(pe);if(pe.version!==ce.__version||ae===!0){t.activeTexture(n.TEXTURE0+K);const Ae=Rn.getPrimaries(Rn.workingColorSpace),we=P.colorSpace===sf?null:Rn.getPrimaries(P.colorSpace),Pe=P.colorSpace===sf||Ae===we?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,P.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,P.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,P.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Pe);const Te=P.isCompressedTexture||P.image[0].isCompressedTexture,Ne=P.image[0]&&P.image[0].isDataTexture,$e=[];for(let Ue=0;Ue<6;Ue++)!Te&&!Ne?$e[Ue]=m(P.image[Ue],!0,i.maxCubemapSize):$e[Ue]=Ne?P.image[Ue].image:P.image[Ue],$e[Ue]=se(P,$e[Ue]);const Ye=$e[0],Ge=s.convert(P.format,P.colorSpace),qe=s.convert(P.type),V=x(P.internalFormat,Ge,qe,P.colorSpace),W=P.isVideoTexture!==!0,ye=ce.__version===void 0||ae===!0,Ee=pe.dataReady;let Fe=_(P,Ye);ee(n.TEXTURE_CUBE_MAP,P);let Le;if(Te){W&&ye&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Fe,V,Ye.width,Ye.height);for(let Ue=0;Ue<6;Ue++){Le=$e[Ue].mipmaps;for(let nt=0;nt<Le.length;nt++){const Pt=Le[nt];P.format!==lu?Ge!==null?W?Ee&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,nt,0,0,Pt.width,Pt.height,Ge,Pt.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,nt,V,Pt.width,Pt.height,0,Pt.data):Ht("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):W?Ee&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,nt,0,0,Pt.width,Pt.height,Ge,qe,Pt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,nt,V,Pt.width,Pt.height,0,Ge,qe,Pt.data)}}}else{if(Le=P.mipmaps,W&&ye){Le.length>0&&Fe++;const Ue=fe($e[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,Fe,V,Ue.width,Ue.height)}for(let Ue=0;Ue<6;Ue++)if(Ne){W?Ee&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,0,0,$e[Ue].width,$e[Ue].height,Ge,qe,$e[Ue].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,V,$e[Ue].width,$e[Ue].height,0,Ge,qe,$e[Ue].data);for(let nt=0;nt<Le.length;nt++){const Vn=Le[nt].image[Ue].image;W?Ee&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,nt+1,0,0,Vn.width,Vn.height,Ge,qe,Vn.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,nt+1,V,Vn.width,Vn.height,0,Ge,qe,Vn.data)}}else{W?Ee&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,0,0,Ge,qe,$e[Ue]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,V,Ge,qe,$e[Ue]);for(let nt=0;nt<Le.length;nt++){const Pt=Le[nt];W?Ee&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,nt+1,0,0,Ge,qe,Pt.image[Ue]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,nt+1,V,Ge,qe,Pt.image[Ue])}}}y(P)&&v(n.TEXTURE_CUBE_MAP),ce.__version=pe.version,P.onUpdate&&P.onUpdate(P)}L.__version=P.version}function te(L,P,K,ae,pe,ce){const Ae=s.convert(K.format,K.colorSpace),we=s.convert(K.type),Pe=x(K.internalFormat,Ae,we,K.colorSpace),Te=r.get(P),Ne=r.get(K);if(Ne.__renderTarget=P,!Te.__hasExternalTextures){const $e=Math.max(1,P.width>>ce),Ye=Math.max(1,P.height>>ce);pe===n.TEXTURE_3D||pe===n.TEXTURE_2D_ARRAY?t.texImage3D(pe,ce,Pe,$e,Ye,P.depth,0,Ae,we,null):t.texImage2D(pe,ce,Pe,$e,Ye,0,Ae,we,null)}t.bindFramebuffer(n.FRAMEBUFFER,L),Xe(P)?o.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,ae,pe,Ne.__webglTexture,0,de(P)):(pe===n.TEXTURE_2D||pe>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&pe<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,ae,pe,Ne.__webglTexture,ce),t.bindFramebuffer(n.FRAMEBUFFER,null)}function Y(L,P,K){if(n.bindRenderbuffer(n.RENDERBUFFER,L),P.depthBuffer){const ae=P.depthTexture,pe=ae&&ae.isDepthTexture?ae.type:null,ce=w(P.stencilBuffer,pe),Ae=P.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;Xe(P)?o.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,de(P),ce,P.width,P.height):K?n.renderbufferStorageMultisample(n.RENDERBUFFER,de(P),ce,P.width,P.height):n.renderbufferStorage(n.RENDERBUFFER,ce,P.width,P.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,Ae,n.RENDERBUFFER,L)}else{const ae=P.textures;for(let pe=0;pe<ae.length;pe++){const ce=ae[pe],Ae=s.convert(ce.format,ce.colorSpace),we=s.convert(ce.type),Pe=x(ce.internalFormat,Ae,we,ce.colorSpace);Xe(P)?o.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,de(P),Pe,P.width,P.height):K?n.renderbufferStorageMultisample(n.RENDERBUFFER,de(P),Pe,P.width,P.height):n.renderbufferStorage(n.RENDERBUFFER,Pe,P.width,P.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function oe(L,P,K){const ae=P.isWebGLCubeRenderTarget===!0;if(t.bindFramebuffer(n.FRAMEBUFFER,L),!(P.depthTexture&&P.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const pe=r.get(P.depthTexture);if(pe.__renderTarget=P,(!pe.__webglTexture||P.depthTexture.image.width!==P.width||P.depthTexture.image.height!==P.height)&&(P.depthTexture.image.width=P.width,P.depthTexture.image.height=P.height,P.depthTexture.needsUpdate=!0),ae){if(pe.__webglInit===void 0&&(pe.__webglInit=!0,P.depthTexture.addEventListener("dispose",E)),pe.__webglTexture===void 0){pe.__webglTexture=n.createTexture(),t.bindTexture(n.TEXTURE_CUBE_MAP,pe.__webglTexture),ee(n.TEXTURE_CUBE_MAP,P.depthTexture);const Te=s.convert(P.depthTexture.format),Ne=s.convert(P.depthTexture.type);let $e;P.depthTexture.format===md?$e=n.DEPTH_COMPONENT24:P.depthTexture.format===Gm&&($e=n.DEPTH24_STENCIL8);for(let Ye=0;Ye<6;Ye++)n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ye,0,$e,P.width,P.height,0,Te,Ne,null)}}else j(P.depthTexture,0);const ce=pe.__webglTexture,Ae=de(P),we=ae?n.TEXTURE_CUBE_MAP_POSITIVE_X+K:n.TEXTURE_2D,Pe=P.depthTexture.format===Gm?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;if(P.depthTexture.format===md)Xe(P)?o.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Pe,we,ce,0,Ae):n.framebufferTexture2D(n.FRAMEBUFFER,Pe,we,ce,0);else if(P.depthTexture.format===Gm)Xe(P)?o.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Pe,we,ce,0,Ae):n.framebufferTexture2D(n.FRAMEBUFFER,Pe,we,ce,0);else throw new Error("Unknown depthTexture format")}function ve(L){const P=r.get(L),K=L.isWebGLCubeRenderTarget===!0;if(P.__boundDepthTexture!==L.depthTexture){const ae=L.depthTexture;if(P.__depthDisposeCallback&&P.__depthDisposeCallback(),ae){const pe=()=>{delete P.__boundDepthTexture,delete P.__depthDisposeCallback,ae.removeEventListener("dispose",pe)};ae.addEventListener("dispose",pe),P.__depthDisposeCallback=pe}P.__boundDepthTexture=ae}if(L.depthTexture&&!P.__autoAllocateDepthBuffer)if(K)for(let ae=0;ae<6;ae++)oe(P.__webglFramebuffer[ae],L,ae);else{const ae=L.texture.mipmaps;ae&&ae.length>0?oe(P.__webglFramebuffer[0],L,0):oe(P.__webglFramebuffer,L,0)}else if(K){P.__webglDepthbuffer=[];for(let ae=0;ae<6;ae++)if(t.bindFramebuffer(n.FRAMEBUFFER,P.__webglFramebuffer[ae]),P.__webglDepthbuffer[ae]===void 0)P.__webglDepthbuffer[ae]=n.createRenderbuffer(),Y(P.__webglDepthbuffer[ae],L,!1);else{const pe=L.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ce=P.__webglDepthbuffer[ae];n.bindRenderbuffer(n.RENDERBUFFER,ce),n.framebufferRenderbuffer(n.FRAMEBUFFER,pe,n.RENDERBUFFER,ce)}}else{const ae=L.texture.mipmaps;if(ae&&ae.length>0?t.bindFramebuffer(n.FRAMEBUFFER,P.__webglFramebuffer[0]):t.bindFramebuffer(n.FRAMEBUFFER,P.__webglFramebuffer),P.__webglDepthbuffer===void 0)P.__webglDepthbuffer=n.createRenderbuffer(),Y(P.__webglDepthbuffer,L,!1);else{const pe=L.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ce=P.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,ce),n.framebufferRenderbuffer(n.FRAMEBUFFER,pe,n.RENDERBUFFER,ce)}}t.bindFramebuffer(n.FRAMEBUFFER,null)}function me(L,P,K){const ae=r.get(L);P!==void 0&&te(ae.__webglFramebuffer,L,L.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),K!==void 0&&ve(L)}function be(L){const P=L.texture,K=r.get(L),ae=r.get(P);L.addEventListener("dispose",A);const pe=L.textures,ce=L.isWebGLCubeRenderTarget===!0,Ae=pe.length>1;if(Ae||(ae.__webglTexture===void 0&&(ae.__webglTexture=n.createTexture()),ae.__version=P.version,a.memory.textures++),ce){K.__webglFramebuffer=[];for(let we=0;we<6;we++)if(P.mipmaps&&P.mipmaps.length>0){K.__webglFramebuffer[we]=[];for(let Pe=0;Pe<P.mipmaps.length;Pe++)K.__webglFramebuffer[we][Pe]=n.createFramebuffer()}else K.__webglFramebuffer[we]=n.createFramebuffer()}else{if(P.mipmaps&&P.mipmaps.length>0){K.__webglFramebuffer=[];for(let we=0;we<P.mipmaps.length;we++)K.__webglFramebuffer[we]=n.createFramebuffer()}else K.__webglFramebuffer=n.createFramebuffer();if(Ae)for(let we=0,Pe=pe.length;we<Pe;we++){const Te=r.get(pe[we]);Te.__webglTexture===void 0&&(Te.__webglTexture=n.createTexture(),a.memory.textures++)}if(L.samples>0&&Xe(L)===!1){K.__webglMultisampledFramebuffer=n.createFramebuffer(),K.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,K.__webglMultisampledFramebuffer);for(let we=0;we<pe.length;we++){const Pe=pe[we];K.__webglColorRenderbuffer[we]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,K.__webglColorRenderbuffer[we]);const Te=s.convert(Pe.format,Pe.colorSpace),Ne=s.convert(Pe.type),$e=x(Pe.internalFormat,Te,Ne,Pe.colorSpace,L.isXRRenderTarget===!0),Ye=de(L);n.renderbufferStorageMultisample(n.RENDERBUFFER,Ye,$e,L.width,L.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+we,n.RENDERBUFFER,K.__webglColorRenderbuffer[we])}n.bindRenderbuffer(n.RENDERBUFFER,null),L.depthBuffer&&(K.__webglDepthRenderbuffer=n.createRenderbuffer(),Y(K.__webglDepthRenderbuffer,L,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(ce){t.bindTexture(n.TEXTURE_CUBE_MAP,ae.__webglTexture),ee(n.TEXTURE_CUBE_MAP,P);for(let we=0;we<6;we++)if(P.mipmaps&&P.mipmaps.length>0)for(let Pe=0;Pe<P.mipmaps.length;Pe++)te(K.__webglFramebuffer[we][Pe],L,P,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+we,Pe);else te(K.__webglFramebuffer[we],L,P,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+we,0);y(P)&&v(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ae){for(let we=0,Pe=pe.length;we<Pe;we++){const Te=pe[we],Ne=r.get(Te);let $e=n.TEXTURE_2D;(L.isWebGL3DRenderTarget||L.isWebGLArrayRenderTarget)&&($e=L.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture($e,Ne.__webglTexture),ee($e,Te),te(K.__webglFramebuffer,L,Te,n.COLOR_ATTACHMENT0+we,$e,0),y(Te)&&v($e)}t.unbindTexture()}else{let we=n.TEXTURE_2D;if((L.isWebGL3DRenderTarget||L.isWebGLArrayRenderTarget)&&(we=L.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(we,ae.__webglTexture),ee(we,P),P.mipmaps&&P.mipmaps.length>0)for(let Pe=0;Pe<P.mipmaps.length;Pe++)te(K.__webglFramebuffer[Pe],L,P,n.COLOR_ATTACHMENT0,we,Pe);else te(K.__webglFramebuffer,L,P,n.COLOR_ATTACHMENT0,we,0);y(P)&&v(we),t.unbindTexture()}L.depthBuffer&&ve(L)}function _e(L){const P=L.textures;for(let K=0,ae=P.length;K<ae;K++){const pe=P[K];if(y(pe)){const ce=b(L),Ae=r.get(pe).__webglTexture;t.bindTexture(ce,Ae),v(ce),t.unbindTexture()}}}const Be=[],ze=[];function tt(L){if(L.samples>0){if(Xe(L)===!1){const P=L.textures,K=L.width,ae=L.height;let pe=n.COLOR_BUFFER_BIT;const ce=L.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ae=r.get(L),we=P.length>1;if(we)for(let Te=0;Te<P.length;Te++)t.bindFramebuffer(n.FRAMEBUFFER,Ae.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Te,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Ae.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Te,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Ae.__webglMultisampledFramebuffer);const Pe=L.texture.mipmaps;Pe&&Pe.length>0?t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ae.__webglFramebuffer[0]):t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ae.__webglFramebuffer);for(let Te=0;Te<P.length;Te++){if(L.resolveDepthBuffer&&(L.depthBuffer&&(pe|=n.DEPTH_BUFFER_BIT),L.stencilBuffer&&L.resolveStencilBuffer&&(pe|=n.STENCIL_BUFFER_BIT)),we){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Ae.__webglColorRenderbuffer[Te]);const Ne=r.get(P[Te]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Ne,0)}n.blitFramebuffer(0,0,K,ae,0,0,K,ae,pe,n.NEAREST),l===!0&&(Be.length=0,ze.length=0,Be.push(n.COLOR_ATTACHMENT0+Te),L.depthBuffer&&L.resolveDepthBuffer===!1&&(Be.push(ce),ze.push(ce),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,ze)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,Be))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),we)for(let Te=0;Te<P.length;Te++){t.bindFramebuffer(n.FRAMEBUFFER,Ae.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Te,n.RENDERBUFFER,Ae.__webglColorRenderbuffer[Te]);const Ne=r.get(P[Te]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Ae.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Te,n.TEXTURE_2D,Ne,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ae.__webglMultisampledFramebuffer)}else if(L.depthBuffer&&L.resolveDepthBuffer===!1&&l){const P=L.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[P])}}}function de(L){return Math.min(i.maxSamples,L.samples)}function Xe(L){const P=r.get(L);return L.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&P.__useRenderToTexture!==!1}function Ke(L){const P=a.render.frame;c.get(L)!==P&&(c.set(L,P),L.update())}function se(L,P){const K=L.colorSpace,ae=L.format,pe=L.type;return L.isCompressedTexture===!0||L.isVideoTexture===!0||K!==yb&&K!==sf&&(Rn.getTransfer(K)===qn?(ae!==lu||pe!==Lo)&&Ht("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):Bn("WebGLTextures: Unsupported texture color space:",K)),P}function fe(L){return typeof HTMLImageElement<"u"&&L instanceof HTMLImageElement?(u.width=L.naturalWidth||L.width,u.height=L.naturalHeight||L.height):typeof VideoFrame<"u"&&L instanceof VideoFrame?(u.width=L.displayWidth,u.height=L.displayHeight):(u.width=L.width,u.height=L.height),u}this.allocateTextureUnit=R,this.resetTextureUnits=N,this.setTexture2D=j,this.setTexture2DArray=I,this.setTexture3D=F,this.setTextureCube=$,this.rebindTextures=me,this.setupRenderTarget=be,this.updateRenderTargetMipmap=_e,this.updateMultisampleRenderTarget=tt,this.setupDepthRenderbuffer=ve,this.setupFrameBufferTexture=te,this.useMultisampledRTT=Xe,this.isReversedDepthBuffer=function(){return t.buffers.depth.getReversed()}}function kTe(n,e){function t(r,i=sf){let s;const a=Rn.getTransfer(i);if(r===Lo)return n.UNSIGNED_BYTE;if(r===I4)return n.UNSIGNED_SHORT_4_4_4_4;if(r===P4)return n.UNSIGNED_SHORT_5_5_5_1;if(r===Iee)return n.UNSIGNED_INT_5_9_9_9_REV;if(r===Pee)return n.UNSIGNED_INT_10F_11F_11F_REV;if(r===Nee)return n.BYTE;if(r===Ree)return n.SHORT;if(r===Aw)return n.UNSIGNED_SHORT;if(r===R4)return n.INT;if(r===Mc)return n.UNSIGNED_INT;if(r===lc)return n.FLOAT;if(r===pd)return n.HALF_FLOAT;if(r===Fee)return n.ALPHA;if(r===Lee)return n.RGB;if(r===lu)return n.RGBA;if(r===md)return n.DEPTH_COMPONENT;if(r===Gm)return n.DEPTH_STENCIL;if(r===Oee)return n.RED;if(r===F4)return n.RED_INTEGER;if(r===vb)return n.RG;if(r===L4)return n.RG_INTEGER;if(r===O4)return n.RGBA_INTEGER;if(r===oC||r===lC||r===uC||r===cC)if(a===qn)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(r===oC)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===lC)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===uC)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===cC)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(r===oC)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===lC)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===uC)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===cC)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(r===FL||r===LL||r===OL||r===kL)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(r===FL)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===LL)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===OL)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===kL)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(r===BL||r===UL||r===VL||r===zL||r===$L||r===HL||r===GL)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(r===BL||r===UL)return a===qn?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(r===VL)return a===qn?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC;if(r===zL)return s.COMPRESSED_R11_EAC;if(r===$L)return s.COMPRESSED_SIGNED_R11_EAC;if(r===HL)return s.COMPRESSED_RG11_EAC;if(r===GL)return s.COMPRESSED_SIGNED_RG11_EAC}else return null;if(r===jL||r===qL||r===WL||r===XL||r===KL||r===YL||r===QL||r===ZL||r===JL||r===eO||r===tO||r===nO||r===rO||r===iO)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(r===jL)return a===qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===qL)return a===qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===WL)return a===qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===XL)return a===qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===KL)return a===qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===YL)return a===qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===QL)return a===qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===ZL)return a===qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===JL)return a===qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===eO)return a===qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===tO)return a===qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===nO)return a===qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===rO)return a===qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===iO)return a===qn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(r===sO||r===aO||r===oO)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(r===sO)return a===qn?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===aO)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===oO)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(r===lO||r===uO||r===cO||r===hO)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(r===lO)return s.COMPRESSED_RED_RGTC1_EXT;if(r===uO)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===cO)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===hO)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return r===Tw?n.UNSIGNED_INT_24_8:n[r]!==void 0?n[r]:null}return{convert:t}}const BTe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,UTe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class VTe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const r=new Xee(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,r=new Cc({vertexShader:BTe,fragmentShader:UTe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new cr(new SN(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class zTe extends Gb{constructor(e,t){super();const r=this;let i=null,s=1,a=null,o="local-floor",l=1,u=null,c=null,h=null,d=null,f=null,p=null;const m=typeof XRWebGLBinding<"u",y=new VTe,v={},b=t.getContextAttributes();let x=null,w=null;const _=[],E=[],A=new Ln;let T=null;const S=new Io;S.viewport=new Zr;const M=new Io;M.viewport=new Zr;const D=[S,M],N=new Q1e;let R=null,z=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(re){let le=_[re];return le===void 0&&(le=new OI,_[re]=le),le.getTargetRaySpace()},this.getControllerGrip=function(re){let le=_[re];return le===void 0&&(le=new OI,_[re]=le),le.getGripSpace()},this.getHand=function(re){let le=_[re];return le===void 0&&(le=new OI,_[re]=le),le.getHandSpace()};function j(re){const le=E.indexOf(re.inputSource);if(le===-1)return;const te=_[le];te!==void 0&&(te.update(re.inputSource,re.frame,u||a),te.dispatchEvent({type:re.type,data:re.inputSource}))}function I(){i.removeEventListener("select",j),i.removeEventListener("selectstart",j),i.removeEventListener("selectend",j),i.removeEventListener("squeeze",j),i.removeEventListener("squeezestart",j),i.removeEventListener("squeezeend",j),i.removeEventListener("end",I),i.removeEventListener("inputsourceschange",F);for(let re=0;re<_.length;re++){const le=E[re];le!==null&&(E[re]=null,_[re].disconnect(le))}R=null,z=null,y.reset();for(const re in v)delete v[re];e.setRenderTarget(x),f=null,d=null,h=null,i=null,w=null,Q.stop(),r.isPresenting=!1,e.setPixelRatio(T),e.setSize(A.width,A.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(re){s=re,r.isPresenting===!0&&Ht("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(re){o=re,r.isPresenting===!0&&Ht("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||a},this.setReferenceSpace=function(re){u=re},this.getBaseLayer=function(){return d!==null?d:f},this.getBinding=function(){return h===null&&m&&(h=new XRWebGLBinding(i,t)),h},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(re){if(i=re,i!==null){if(x=e.getRenderTarget(),i.addEventListener("select",j),i.addEventListener("selectstart",j),i.addEventListener("selectend",j),i.addEventListener("squeeze",j),i.addEventListener("squeezestart",j),i.addEventListener("squeezeend",j),i.addEventListener("end",I),i.addEventListener("inputsourceschange",F),b.xrCompatible!==!0&&await t.makeXRCompatible(),T=e.getPixelRatio(),e.getSize(A),m&&"createProjectionLayer"in XRWebGLBinding.prototype){let te=null,Y=null,oe=null;b.depth&&(oe=b.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,te=b.stencil?Gm:md,Y=b.stencil?Tw:Mc);const ve={colorFormat:t.RGBA8,depthFormat:oe,scaleFactor:s};h=this.getBinding(),d=h.createProjectionLayer(ve),i.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),w=new Ec(d.textureWidth,d.textureHeight,{format:lu,type:Lo,depthTexture:new Cw(d.textureWidth,d.textureHeight,Y,void 0,void 0,void 0,void 0,void 0,void 0,te),stencilBuffer:b.stencil,colorSpace:e.outputColorSpace,samples:b.antialias?4:0,resolveDepthBuffer:d.ignoreDepthValues===!1,resolveStencilBuffer:d.ignoreDepthValues===!1})}else{const te={antialias:b.antialias,alpha:!0,depth:b.depth,stencil:b.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(i,t,te),i.updateRenderState({baseLayer:f}),e.setPixelRatio(1),e.setSize(f.framebufferWidth,f.framebufferHeight,!1),w=new Ec(f.framebufferWidth,f.framebufferHeight,{format:lu,type:Lo,colorSpace:e.outputColorSpace,stencilBuffer:b.stencil,resolveDepthBuffer:f.ignoreDepthValues===!1,resolveStencilBuffer:f.ignoreDepthValues===!1})}w.isXRRenderTarget=!0,this.setFoveation(l),u=null,a=await i.requestReferenceSpace(o),Q.setContext(i),Q.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return y.getDepthTexture()};function F(re){for(let le=0;le<re.removed.length;le++){const te=re.removed[le],Y=E.indexOf(te);Y>=0&&(E[Y]=null,_[Y].disconnect(te))}for(let le=0;le<re.added.length;le++){const te=re.added[le];let Y=E.indexOf(te);if(Y===-1){for(let ve=0;ve<_.length;ve++)if(ve>=E.length){E.push(te),Y=ve;break}else if(E[ve]===null){E[ve]=te,Y=ve;break}if(Y===-1)break}const oe=_[Y];oe&&oe.connect(te)}}const $=new De,H=new De;function Z(re,le,te){$.setFromMatrixPosition(le.matrixWorld),H.setFromMatrixPosition(te.matrixWorld);const Y=$.distanceTo(H),oe=le.projectionMatrix.elements,ve=te.projectionMatrix.elements,me=oe[14]/(oe[10]-1),be=oe[14]/(oe[10]+1),_e=(oe[9]+1)/oe[5],Be=(oe[9]-1)/oe[5],ze=(oe[8]-1)/oe[0],tt=(ve[8]+1)/ve[0],de=me*ze,Xe=me*tt,Ke=Y/(-ze+tt),se=Ke*-ze;if(le.matrixWorld.decompose(re.position,re.quaternion,re.scale),re.translateX(se),re.translateZ(Ke),re.matrixWorld.compose(re.position,re.quaternion,re.scale),re.matrixWorldInverse.copy(re.matrixWorld).invert(),oe[10]===-1)re.projectionMatrix.copy(le.projectionMatrix),re.projectionMatrixInverse.copy(le.projectionMatrixInverse);else{const fe=me+Ke,L=be+Ke,P=de-se,K=Xe+(Y-se),ae=_e*be/L*fe,pe=Be*be/L*fe;re.projectionMatrix.makePerspective(P,K,ae,pe,fe,L),re.projectionMatrixInverse.copy(re.projectionMatrix).invert()}}function J(re,le){le===null?re.matrixWorld.copy(re.matrix):re.matrixWorld.multiplyMatrices(le.matrixWorld,re.matrix),re.matrixWorldInverse.copy(re.matrixWorld).invert()}this.updateCamera=function(re){if(i===null)return;let le=re.near,te=re.far;y.texture!==null&&(y.depthNear>0&&(le=y.depthNear),y.depthFar>0&&(te=y.depthFar)),N.near=M.near=S.near=le,N.far=M.far=S.far=te,(R!==N.near||z!==N.far)&&(i.updateRenderState({depthNear:N.near,depthFar:N.far}),R=N.near,z=N.far),N.layers.mask=re.layers.mask|6,S.layers.mask=N.layers.mask&3,M.layers.mask=N.layers.mask&5;const Y=re.parent,oe=N.cameras;J(N,Y);for(let ve=0;ve<oe.length;ve++)J(oe[ve],Y);oe.length===2?Z(N,S,M):N.projectionMatrix.copy(S.projectionMatrix),ee(re,N,Y)};function ee(re,le,te){te===null?re.matrix.copy(le.matrixWorld):(re.matrix.copy(te.matrixWorld),re.matrix.invert(),re.matrix.multiply(le.matrixWorld)),re.matrix.decompose(re.position,re.quaternion,re.scale),re.updateMatrixWorld(!0),re.projectionMatrix.copy(le.projectionMatrix),re.projectionMatrixInverse.copy(le.projectionMatrixInverse),re.isPerspectiveCamera&&(re.fov=dO*2*Math.atan(1/re.projectionMatrix.elements[5]),re.zoom=1)}this.getCamera=function(){return N},this.getFoveation=function(){if(!(d===null&&f===null))return l},this.setFoveation=function(re){l=re,d!==null&&(d.fixedFoveation=re),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=re)},this.hasDepthSensing=function(){return y.texture!==null},this.getDepthSensingMesh=function(){return y.getMesh(N)},this.getCameraTexture=function(re){return v[re]};let O=null;function ue(re,le){if(c=le.getViewerPose(u||a),p=le,c!==null){const te=c.views;f!==null&&(e.setRenderTargetFramebuffer(w,f.framebuffer),e.setRenderTarget(w));let Y=!1;te.length!==N.cameras.length&&(N.cameras.length=0,Y=!0);for(let be=0;be<te.length;be++){const _e=te[be];let Be=null;if(f!==null)Be=f.getViewport(_e);else{const tt=h.getViewSubImage(d,_e);Be=tt.viewport,be===0&&(e.setRenderTargetTextures(w,tt.colorTexture,tt.depthStencilTexture),e.setRenderTarget(w))}let ze=D[be];ze===void 0&&(ze=new Io,ze.layers.enable(be),ze.viewport=new Zr,D[be]=ze),ze.matrix.fromArray(_e.transform.matrix),ze.matrix.decompose(ze.position,ze.quaternion,ze.scale),ze.projectionMatrix.fromArray(_e.projectionMatrix),ze.projectionMatrixInverse.copy(ze.projectionMatrix).invert(),ze.viewport.set(Be.x,Be.y,Be.width,Be.height),be===0&&(N.matrix.copy(ze.matrix),N.matrix.decompose(N.position,N.quaternion,N.scale)),Y===!0&&N.cameras.push(ze)}const oe=i.enabledFeatures;if(oe&&oe.includes("depth-sensing")&&i.depthUsage=="gpu-optimized"&&m){h=r.getBinding();const be=h.getDepthInformation(te[0]);be&&be.isValid&&be.texture&&y.init(be,i.renderState)}if(oe&&oe.includes("camera-access")&&m){e.state.unbindTexture(),h=r.getBinding();for(let be=0;be<te.length;be++){const _e=te[be].camera;if(_e){let Be=v[_e];Be||(Be=new Xee,v[_e]=Be);const ze=h.getCameraImage(_e);Be.sourceTexture=ze}}}}for(let te=0;te<_.length;te++){const Y=E[te],oe=_[te];Y!==null&&oe!==void 0&&oe.update(Y,le,u||a)}O&&O(re,le),le.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:le}),p=null}const Q=new Qee;Q.setAnimationLoop(ue),this.setAnimationLoop=function(re){O=re},this.dispose=function(){}}}const _m=new gu,$Te=new Rr;function HTe(n,e){function t(y,v){y.matrixAutoUpdate===!0&&y.updateMatrix(),v.value.copy(y.matrix)}function r(y,v){v.color.getRGB(y.fogColor.value,Hee(n)),v.isFog?(y.fogNear.value=v.near,y.fogFar.value=v.far):v.isFogExp2&&(y.fogDensity.value=v.density)}function i(y,v,b,x,w){v.isMeshBasicMaterial||v.isMeshLambertMaterial?s(y,v):v.isMeshToonMaterial?(s(y,v),h(y,v)):v.isMeshPhongMaterial?(s(y,v),c(y,v)):v.isMeshStandardMaterial?(s(y,v),d(y,v),v.isMeshPhysicalMaterial&&f(y,v,w)):v.isMeshMatcapMaterial?(s(y,v),p(y,v)):v.isMeshDepthMaterial?s(y,v):v.isMeshDistanceMaterial?(s(y,v),m(y,v)):v.isMeshNormalMaterial?s(y,v):v.isLineBasicMaterial?(a(y,v),v.isLineDashedMaterial&&o(y,v)):v.isPointsMaterial?l(y,v,b,x):v.isSpriteMaterial?u(y,v):v.isShadowMaterial?(y.color.value.copy(v.color),y.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function s(y,v){y.opacity.value=v.opacity,v.color&&y.diffuse.value.copy(v.color),v.emissive&&y.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(y.map.value=v.map,t(v.map,y.mapTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,t(v.alphaMap,y.alphaMapTransform)),v.bumpMap&&(y.bumpMap.value=v.bumpMap,t(v.bumpMap,y.bumpMapTransform),y.bumpScale.value=v.bumpScale,v.side===to&&(y.bumpScale.value*=-1)),v.normalMap&&(y.normalMap.value=v.normalMap,t(v.normalMap,y.normalMapTransform),y.normalScale.value.copy(v.normalScale),v.side===to&&y.normalScale.value.negate()),v.displacementMap&&(y.displacementMap.value=v.displacementMap,t(v.displacementMap,y.displacementMapTransform),y.displacementScale.value=v.displacementScale,y.displacementBias.value=v.displacementBias),v.emissiveMap&&(y.emissiveMap.value=v.emissiveMap,t(v.emissiveMap,y.emissiveMapTransform)),v.specularMap&&(y.specularMap.value=v.specularMap,t(v.specularMap,y.specularMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest);const b=e.get(v),x=b.envMap,w=b.envMapRotation;x&&(y.envMap.value=x,_m.copy(w),_m.x*=-1,_m.y*=-1,_m.z*=-1,x.isCubeTexture&&x.isRenderTargetTexture===!1&&(_m.y*=-1,_m.z*=-1),y.envMapRotation.value.setFromMatrix4($Te.makeRotationFromEuler(_m)),y.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=v.reflectivity,y.ior.value=v.ior,y.refractionRatio.value=v.refractionRatio),v.lightMap&&(y.lightMap.value=v.lightMap,y.lightMapIntensity.value=v.lightMapIntensity,t(v.lightMap,y.lightMapTransform)),v.aoMap&&(y.aoMap.value=v.aoMap,y.aoMapIntensity.value=v.aoMapIntensity,t(v.aoMap,y.aoMapTransform))}function a(y,v){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,v.map&&(y.map.value=v.map,t(v.map,y.mapTransform))}function o(y,v){y.dashSize.value=v.dashSize,y.totalSize.value=v.dashSize+v.gapSize,y.scale.value=v.scale}function l(y,v,b,x){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,y.size.value=v.size*b,y.scale.value=x*.5,v.map&&(y.map.value=v.map,t(v.map,y.uvTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,t(v.alphaMap,y.alphaMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest)}function u(y,v){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,y.rotation.value=v.rotation,v.map&&(y.map.value=v.map,t(v.map,y.mapTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,t(v.alphaMap,y.alphaMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest)}function c(y,v){y.specular.value.copy(v.specular),y.shininess.value=Math.max(v.shininess,1e-4)}function h(y,v){v.gradientMap&&(y.gradientMap.value=v.gradientMap)}function d(y,v){y.metalness.value=v.metalness,v.metalnessMap&&(y.metalnessMap.value=v.metalnessMap,t(v.metalnessMap,y.metalnessMapTransform)),y.roughness.value=v.roughness,v.roughnessMap&&(y.roughnessMap.value=v.roughnessMap,t(v.roughnessMap,y.roughnessMapTransform)),v.envMap&&(y.envMapIntensity.value=v.envMapIntensity)}function f(y,v,b){y.ior.value=v.ior,v.sheen>0&&(y.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),y.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(y.sheenColorMap.value=v.sheenColorMap,t(v.sheenColorMap,y.sheenColorMapTransform)),v.sheenRoughnessMap&&(y.sheenRoughnessMap.value=v.sheenRoughnessMap,t(v.sheenRoughnessMap,y.sheenRoughnessMapTransform))),v.clearcoat>0&&(y.clearcoat.value=v.clearcoat,y.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(y.clearcoatMap.value=v.clearcoatMap,t(v.clearcoatMap,y.clearcoatMapTransform)),v.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap,t(v.clearcoatRoughnessMap,y.clearcoatRoughnessMapTransform)),v.clearcoatNormalMap&&(y.clearcoatNormalMap.value=v.clearcoatNormalMap,t(v.clearcoatNormalMap,y.clearcoatNormalMapTransform),y.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),v.side===to&&y.clearcoatNormalScale.value.negate())),v.dispersion>0&&(y.dispersion.value=v.dispersion),v.iridescence>0&&(y.iridescence.value=v.iridescence,y.iridescenceIOR.value=v.iridescenceIOR,y.iridescenceThicknessMinimum.value=v.iridescenceThicknessRange[0],y.iridescenceThicknessMaximum.value=v.iridescenceThicknessRange[1],v.iridescenceMap&&(y.iridescenceMap.value=v.iridescenceMap,t(v.iridescenceMap,y.iridescenceMapTransform)),v.iridescenceThicknessMap&&(y.iridescenceThicknessMap.value=v.iridescenceThicknessMap,t(v.iridescenceThicknessMap,y.iridescenceThicknessMapTransform))),v.transmission>0&&(y.transmission.value=v.transmission,y.transmissionSamplerMap.value=b.texture,y.transmissionSamplerSize.value.set(b.width,b.height),v.transmissionMap&&(y.transmissionMap.value=v.transmissionMap,t(v.transmissionMap,y.transmissionMapTransform)),y.thickness.value=v.thickness,v.thicknessMap&&(y.thicknessMap.value=v.thicknessMap,t(v.thicknessMap,y.thicknessMapTransform)),y.attenuationDistance.value=v.attenuationDistance,y.attenuationColor.value.copy(v.attenuationColor)),v.anisotropy>0&&(y.anisotropyVector.value.set(v.anisotropy*Math.cos(v.anisotropyRotation),v.anisotropy*Math.sin(v.anisotropyRotation)),v.anisotropyMap&&(y.anisotropyMap.value=v.anisotropyMap,t(v.anisotropyMap,y.anisotropyMapTransform))),y.specularIntensity.value=v.specularIntensity,y.specularColor.value.copy(v.specularColor),v.specularColorMap&&(y.specularColorMap.value=v.specularColorMap,t(v.specularColorMap,y.specularColorMapTransform)),v.specularIntensityMap&&(y.specularIntensityMap.value=v.specularIntensityMap,t(v.specularIntensityMap,y.specularIntensityMapTransform))}function p(y,v){v.matcap&&(y.matcap.value=v.matcap)}function m(y,v){const b=e.get(v).light;y.referencePosition.value.setFromMatrixPosition(b.matrixWorld),y.nearDistance.value=b.shadow.camera.near,y.farDistance.value=b.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function GTe(n,e,t,r){let i={},s={},a=[];const o=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function l(b,x){const w=x.program;r.uniformBlockBinding(b,w)}function u(b,x){let w=i[b.id];w===void 0&&(p(b),w=c(b),i[b.id]=w,b.addEventListener("dispose",y));const _=x.program;r.updateUBOMapping(b,_);const E=e.render.frame;s[b.id]!==E&&(d(b),s[b.id]=E)}function c(b){const x=h();b.__bindingPointIndex=x;const w=n.createBuffer(),_=b.__size,E=b.usage;return n.bindBuffer(n.UNIFORM_BUFFER,w),n.bufferData(n.UNIFORM_BUFFER,_,E),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,x,w),w}function h(){for(let b=0;b<o;b++)if(a.indexOf(b)===-1)return a.push(b),b;return Bn("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(b){const x=i[b.id],w=b.uniforms,_=b.__cache;n.bindBuffer(n.UNIFORM_BUFFER,x);for(let E=0,A=w.length;E<A;E++){const T=Array.isArray(w[E])?w[E]:[w[E]];for(let S=0,M=T.length;S<M;S++){const D=T[S];if(f(D,E,S,_)===!0){const N=D.__offset,R=Array.isArray(D.value)?D.value:[D.value];let z=0;for(let j=0;j<R.length;j++){const I=R[j],F=m(I);typeof I=="number"||typeof I=="boolean"?(D.__data[0]=I,n.bufferSubData(n.UNIFORM_BUFFER,N+z,D.__data)):I.isMatrix3?(D.__data[0]=I.elements[0],D.__data[1]=I.elements[1],D.__data[2]=I.elements[2],D.__data[3]=0,D.__data[4]=I.elements[3],D.__data[5]=I.elements[4],D.__data[6]=I.elements[5],D.__data[7]=0,D.__data[8]=I.elements[6],D.__data[9]=I.elements[7],D.__data[10]=I.elements[8],D.__data[11]=0):(I.toArray(D.__data,z),z+=F.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,N,D.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function f(b,x,w,_){const E=b.value,A=x+"_"+w;if(_[A]===void 0)return typeof E=="number"||typeof E=="boolean"?_[A]=E:_[A]=E.clone(),!0;{const T=_[A];if(typeof E=="number"||typeof E=="boolean"){if(T!==E)return _[A]=E,!0}else if(T.equals(E)===!1)return T.copy(E),!0}return!1}function p(b){const x=b.uniforms;let w=0;const _=16;for(let A=0,T=x.length;A<T;A++){const S=Array.isArray(x[A])?x[A]:[x[A]];for(let M=0,D=S.length;M<D;M++){const N=S[M],R=Array.isArray(N.value)?N.value:[N.value];for(let z=0,j=R.length;z<j;z++){const I=R[z],F=m(I),$=w%_,H=$%F.boundary,Z=$+H;w+=H,Z!==0&&_-Z<F.storage&&(w+=_-Z),N.__data=new Float32Array(F.storage/Float32Array.BYTES_PER_ELEMENT),N.__offset=w,w+=F.storage}}}const E=w%_;return E>0&&(w+=_-E),b.__size=w,b.__cache={},this}function m(b){const x={boundary:0,storage:0};return typeof b=="number"||typeof b=="boolean"?(x.boundary=4,x.storage=4):b.isVector2?(x.boundary=8,x.storage=8):b.isVector3||b.isColor?(x.boundary=16,x.storage=12):b.isVector4?(x.boundary=16,x.storage=16):b.isMatrix3?(x.boundary=48,x.storage=48):b.isMatrix4?(x.boundary=64,x.storage=64):b.isTexture?Ht("WebGLRenderer: Texture samplers can not be part of an uniforms group."):Ht("WebGLRenderer: Unsupported uniform value type.",b),x}function y(b){const x=b.target;x.removeEventListener("dispose",y);const w=a.indexOf(x.__bindingPointIndex);a.splice(w,1),n.deleteBuffer(i[x.id]),delete i[x.id],delete s[x.id]}function v(){for(const b in i)n.deleteBuffer(i[b]);a=[],i={},s={}}return{bind:l,update:u,dispose:v}}const jTe=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let Iu=null;function qTe(){return Iu===null&&(Iu=new U1e(jTe,16,16,vb,pd),Iu.name="DFG_LUT",Iu.minFilter=Qs,Iu.magFilter=Qs,Iu.wrapS=$h,Iu.wrapT=$h,Iu.generateMipmaps=!1,Iu.needsUpdate=!0),Iu}class WTe{constructor(e={}){const{canvas:t=f1e(),context:r=null,depth:i=!0,stencil:s=!1,alpha:a=!1,antialias:o=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:h=!1,reversedDepthBuffer:d=!1,outputBufferType:f=Lo}=e;this.isWebGLRenderer=!0;let p;if(r!==null){if(typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");p=r.getContextAttributes().alpha}else p=a;const m=f,y=new Set([O4,L4,F4]),v=new Set([Lo,Mc,Aw,Tw,I4,P4]),b=new Uint32Array(4),x=new Int32Array(4);let w=null,_=null;const E=[],A=[];let T=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=wc,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const S=this;let M=!1;this._outputColorSpace=dl;let D=0,N=0,R=null,z=-1,j=null;const I=new Zr,F=new Zr;let $=null;const H=new Bt(0);let Z=0,J=t.width,ee=t.height,O=1,ue=null,Q=null;const re=new Zr(0,0,J,ee),le=new Zr(0,0,J,ee);let te=!1;const Y=new $4;let oe=!1,ve=!1;const me=new Rr,be=new De,_e=new Zr,Be={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let ze=!1;function tt(){return R===null?O:1}let de=r;function Xe(ne,Se){return t.getContext(ne,Se)}try{const ne={alpha:!0,depth:i,stencil:s,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${D4}`),t.addEventListener("webglcontextlost",Pt,!1),t.addEventListener("webglcontextrestored",Vn,!1),t.addEventListener("webglcontextcreationerror",dn,!1),de===null){const Se="webgl2";if(de=Xe(Se,ne),de===null)throw Xe(Se)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(ne){throw Bn("WebGLRenderer: "+ne.message),ne}let Ke,se,fe,L,P,K,ae,pe,ce,Ae,we,Pe,Te,Ne,$e,Ye,Ge,qe,V,W,ye,Ee,Fe,Le;function Ue(){Ke=new qSe(de),Ke.init(),Ee=new kTe(de,Ke),se=new kSe(de,Ke,e,Ee),fe=new LTe(de,Ke),se.reversedDepthBuffer&&d&&fe.buffers.depth.setReversed(!0),L=new KSe(de),P=new bTe,K=new OTe(de,Ke,fe,P,se,Ee,L),ae=new USe(S),pe=new jSe(S),ce=new J1e(de),Fe=new LSe(de,ce),Ae=new WSe(de,ce,L,Fe),we=new QSe(de,Ae,ce,L),V=new YSe(de,se,K),Ye=new BSe(P),Pe=new xTe(S,ae,pe,Ke,se,Fe,Ye),Te=new HTe(S,P),Ne=new wTe,$e=new CTe(Ke),qe=new FSe(S,ae,pe,fe,we,p,l),Ge=new PTe(S,we,se),Le=new GTe(de,L,se,fe),W=new OSe(de,Ke,L),ye=new XSe(de,Ke,L),L.programs=Pe.programs,S.capabilities=se,S.extensions=Ke,S.properties=P,S.renderLists=Ne,S.shadowMap=Ge,S.state=fe,S.info=L}Ue(),m!==Lo&&(T=new JSe(m,t.width,t.height,i,s));const nt=new zTe(S,de);this.xr=nt,this.getContext=function(){return de},this.getContextAttributes=function(){return de.getContextAttributes()},this.forceContextLoss=function(){const ne=Ke.get("WEBGL_lose_context");ne&&ne.loseContext()},this.forceContextRestore=function(){const ne=Ke.get("WEBGL_lose_context");ne&&ne.restoreContext()},this.getPixelRatio=function(){return O},this.setPixelRatio=function(ne){ne!==void 0&&(O=ne,this.setSize(J,ee,!1))},this.getSize=function(ne){return ne.set(J,ee)},this.setSize=function(ne,Se,Ie=!0){if(nt.isPresenting){Ht("WebGLRenderer: Can't change size while VR device is presenting.");return}J=ne,ee=Se,t.width=Math.floor(ne*O),t.height=Math.floor(Se*O),Ie===!0&&(t.style.width=ne+"px",t.style.height=Se+"px"),T!==null&&T.setSize(t.width,t.height),this.setViewport(0,0,ne,Se)},this.getDrawingBufferSize=function(ne){return ne.set(J*O,ee*O).floor()},this.setDrawingBufferSize=function(ne,Se,Ie){J=ne,ee=Se,O=Ie,t.width=Math.floor(ne*Ie),t.height=Math.floor(Se*Ie),this.setViewport(0,0,ne,Se)},this.setEffects=function(ne){if(m===Lo){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(ne){for(let Se=0;Se<ne.length;Se++)if(ne[Se].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}T.setEffects(ne||[])},this.getCurrentViewport=function(ne){return ne.copy(I)},this.getViewport=function(ne){return ne.copy(re)},this.setViewport=function(ne,Se,Ie,Re){ne.isVector4?re.set(ne.x,ne.y,ne.z,ne.w):re.set(ne,Se,Ie,Re),fe.viewport(I.copy(re).multiplyScalar(O).round())},this.getScissor=function(ne){return ne.copy(le)},this.setScissor=function(ne,Se,Ie,Re){ne.isVector4?le.set(ne.x,ne.y,ne.z,ne.w):le.set(ne,Se,Ie,Re),fe.scissor(F.copy(le).multiplyScalar(O).round())},this.getScissorTest=function(){return te},this.setScissorTest=function(ne){fe.setScissorTest(te=ne)},this.setOpaqueSort=function(ne){ue=ne},this.setTransparentSort=function(ne){Q=ne},this.getClearColor=function(ne){return ne.copy(qe.getClearColor())},this.setClearColor=function(){qe.setClearColor(...arguments)},this.getClearAlpha=function(){return qe.getClearAlpha()},this.setClearAlpha=function(){qe.setClearAlpha(...arguments)},this.clear=function(ne=!0,Se=!0,Ie=!0){let Re=0;if(ne){let Me=!1;if(R!==null){const it=R.texture.format;Me=y.has(it)}if(Me){const it=R.texture.type,ht=v.has(it),at=qe.getClearColor(),mt=qe.getClearAlpha(),wt=at.r,At=at.g,xt=at.b;ht?(b[0]=wt,b[1]=At,b[2]=xt,b[3]=mt,de.clearBufferuiv(de.COLOR,0,b)):(x[0]=wt,x[1]=At,x[2]=xt,x[3]=mt,de.clearBufferiv(de.COLOR,0,x))}else Re|=de.COLOR_BUFFER_BIT}Se&&(Re|=de.DEPTH_BUFFER_BIT),Ie&&(Re|=de.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),de.clear(Re)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Pt,!1),t.removeEventListener("webglcontextrestored",Vn,!1),t.removeEventListener("webglcontextcreationerror",dn,!1),qe.dispose(),Ne.dispose(),$e.dispose(),P.dispose(),ae.dispose(),pe.dispose(),we.dispose(),Fe.dispose(),Le.dispose(),Pe.dispose(),nt.dispose(),nt.removeEventListener("sessionstart",Su),nt.removeEventListener("sessionend",Zv),$i.stop()};function Pt(ne){ne.preventDefault(),t9("WebGLRenderer: Context Lost."),M=!0}function Vn(){t9("WebGLRenderer: Context Restored."),M=!1;const ne=L.autoReset,Se=Ge.enabled,Ie=Ge.autoUpdate,Re=Ge.needsUpdate,Me=Ge.type;Ue(),L.autoReset=ne,Ge.enabled=Se,Ge.autoUpdate=Ie,Ge.needsUpdate=Re,Ge.type=Me}function dn(ne){Bn("WebGLRenderer: A WebGL context could not be created. Reason: ",ne.statusMessage)}function Ia(ne){const Se=ne.target;Se.removeEventListener("dispose",Ia),io(Se)}function io(ne){Sd(ne),P.remove(ne)}function Sd(ne){const Se=P.get(ne).programs;Se!==void 0&&(Se.forEach(function(Ie){Pe.releaseProgram(Ie)}),ne.isShaderMaterial&&Pe.releaseShaderCache(ne))}this.renderBufferDirect=function(ne,Se,Ie,Re,Me,it){Se===null&&(Se=Be);const ht=Me.isMesh&&Me.matrixWorld.determinant()<0,at=Dd(ne,Se,Ie,Re,Me);fe.setMaterial(Re,ht);let mt=Ie.index,wt=1;if(Re.wireframe===!0){if(mt=Ae.getWireframeAttribute(Ie),mt===void 0)return;wt=2}const At=Ie.drawRange,xt=Ie.attributes.position;let Wt=At.start*wt,Cn=(At.start+At.count)*wt;it!==null&&(Wt=Math.max(Wt,it.start*wt),Cn=Math.min(Cn,(it.start+it.count)*wt)),mt!==null?(Wt=Math.max(Wt,0),Cn=Math.min(Cn,mt.count)):xt!=null&&(Wt=Math.max(Wt,0),Cn=Math.min(Cn,xt.count));const mr=Cn-Wt;if(mr<0||mr===1/0)return;Fe.setup(Me,Re,at,Ie,mt);let Ot,kn=W;if(mt!==null&&(Ot=ce.get(mt),kn=ye,kn.setIndex(Ot)),Me.isMesh)Re.wireframe===!0?(fe.setLineWidth(Re.wireframeLinewidth*tt()),kn.setMode(de.LINES)):kn.setMode(de.TRIANGLES);else if(Me.isLine){let St=Re.linewidth;St===void 0&&(St=1),fe.setLineWidth(St*tt()),Me.isLineSegments?kn.setMode(de.LINES):Me.isLineLoop?kn.setMode(de.LINE_LOOP):kn.setMode(de.LINE_STRIP)}else Me.isPoints?kn.setMode(de.POINTS):Me.isSprite&&kn.setMode(de.TRIANGLES);if(Me.isBatchedMesh)if(Me._multiDrawInstances!==null)Mw("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),kn.renderMultiDrawInstances(Me._multiDrawStarts,Me._multiDrawCounts,Me._multiDrawCount,Me._multiDrawInstances);else if(Ke.get("WEBGL_multi_draw"))kn.renderMultiDraw(Me._multiDrawStarts,Me._multiDrawCounts,Me._multiDrawCount);else{const St=Me._multiDrawStarts,_n=Me._multiDrawCounts,Dn=Me._multiDrawCount,Is=mt?ce.get(mt).bytesPerElement:1,Nd=P.get(Re).currentProgram.getUniforms();for(let la=0;la<Dn;la++)Nd.setValue(de,"_gl_DrawID",la),kn.render(St[la]/Is,_n[la])}else if(Me.isInstancedMesh)kn.renderInstances(Wt,mr,Me.count);else if(Ie.isInstancedBufferGeometry){const St=Ie._maxInstanceCount!==void 0?Ie._maxInstanceCount:1/0,_n=Math.min(Ie.instanceCount,St);kn.renderInstances(Wt,mr,_n)}else kn.render(Wt,mr)};function am(ne,Se,Ie){ne.transparent===!0&&ne.side===kh&&ne.forceSinglePass===!1?(ne.side=to,ne.needsUpdate=!0,Cd(ne,Se,Ie),ne.side=Pp,ne.needsUpdate=!0,Cd(ne,Se,Ie),ne.side=kh):Cd(ne,Se,Ie)}this.compile=function(ne,Se,Ie=null){Ie===null&&(Ie=ne),_=$e.get(Ie),_.init(Se),A.push(_),Ie.traverseVisible(function(Me){Me.isLight&&Me.layers.test(Se.layers)&&(_.pushLight(Me),Me.castShadow&&_.pushShadow(Me))}),ne!==Ie&&ne.traverseVisible(function(Me){Me.isLight&&Me.layers.test(Se.layers)&&(_.pushLight(Me),Me.castShadow&&_.pushShadow(Me))}),_.setupLights();const Re=new Set;return ne.traverse(function(Me){if(!(Me.isMesh||Me.isPoints||Me.isLine||Me.isSprite))return;const it=Me.material;if(it)if(Array.isArray(it))for(let ht=0;ht<it.length;ht++){const at=it[ht];am(at,Ie,Me),Re.add(at)}else am(it,Ie,Me),Re.add(it)}),_=A.pop(),Re},this.compileAsync=function(ne,Se,Ie=null){const Re=this.compile(ne,Se,Ie);return new Promise(Me=>{function it(){if(Re.forEach(function(ht){P.get(ht).currentProgram.isReady()&&Re.delete(ht)}),Re.size===0){Me(ne);return}setTimeout(it,10)}Ke.get("KHR_parallel_shader_compile")!==null?it():setTimeout(it,10)})};let Ad=null;function om(ne){Ad&&Ad(ne)}function Su(){$i.stop()}function Zv(){$i.start()}const $i=new Qee;$i.setAnimationLoop(om),typeof self<"u"&&$i.setContext(self),this.setAnimationLoop=function(ne){Ad=ne,nt.setAnimationLoop(ne),ne===null?$i.stop():$i.start()},nt.addEventListener("sessionstart",Su),nt.addEventListener("sessionend",Zv),this.render=function(ne,Se){if(Se!==void 0&&Se.isCamera!==!0){Bn("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(M===!0)return;const Ie=nt.enabled===!0&&nt.isPresenting===!0,Re=T!==null&&(R===null||Ie)&&T.begin(S,R);if(ne.matrixWorldAutoUpdate===!0&&ne.updateMatrixWorld(),Se.parent===null&&Se.matrixWorldAutoUpdate===!0&&Se.updateMatrixWorld(),nt.enabled===!0&&nt.isPresenting===!0&&(T===null||T.isCompositing()===!1)&&(nt.cameraAutoUpdate===!0&&nt.updateCamera(Se),Se=nt.getCamera()),ne.isScene===!0&&ne.onBeforeRender(S,ne,Se,R),_=$e.get(ne,A.length),_.init(Se),A.push(_),me.multiplyMatrices(Se.projectionMatrix,Se.matrixWorldInverse),Y.setFromProjectionMatrix(me,uc,Se.reversedDepth),ve=this.localClippingEnabled,oe=Ye.init(this.clippingPlanes,ve),w=Ne.get(ne,E.length),w.init(),E.push(w),nt.enabled===!0&&nt.isPresenting===!0){const ht=S.xr.getDepthSensingMesh();ht!==null&&Td(ht,Se,-1/0,S.sortObjects)}Td(ne,Se,0,S.sortObjects),w.finish(),S.sortObjects===!0&&w.sort(ue,Q),ze=nt.enabled===!1||nt.isPresenting===!1||nt.hasDepthSensing()===!1,ze&&qe.addToRenderList(w,ne),this.info.render.frame++,oe===!0&&Ye.beginShadows();const Me=_.state.shadowsArray;if(Ge.render(Me,ne,Se),oe===!0&&Ye.endShadows(),this.info.autoReset===!0&&this.info.reset(),(Re&&T.hasRenderPass())===!1){const ht=w.opaque,at=w.transmissive;if(_.setupLights(),Se.isArrayCamera){const mt=Se.cameras;if(at.length>0)for(let wt=0,At=mt.length;wt<At;wt++){const xt=mt[wt];Md(ht,at,ne,xt)}ze&&qe.render(ne);for(let wt=0,At=mt.length;wt<At;wt++){const xt=mt[wt];lm(w,ne,xt,xt.viewport)}}else at.length>0&&Md(ht,at,ne,Se),ze&&qe.render(ne),lm(w,ne,Se)}R!==null&&N===0&&(K.updateMultisampleRenderTarget(R),K.updateRenderTargetMipmap(R)),Re&&T.end(S),ne.isScene===!0&&ne.onAfterRender(S,ne,Se),Fe.resetDefaultState(),z=-1,j=null,A.pop(),A.length>0?(_=A[A.length-1],oe===!0&&Ye.setGlobalState(S.clippingPlanes,_.state.camera)):_=null,E.pop(),E.length>0?w=E[E.length-1]:w=null};function Td(ne,Se,Ie,Re){if(ne.visible===!1)return;if(ne.layers.test(Se.layers)){if(ne.isGroup)Ie=ne.renderOrder;else if(ne.isLOD)ne.autoUpdate===!0&&ne.update(Se);else if(ne.isLight)_.pushLight(ne),ne.castShadow&&_.pushShadow(ne);else if(ne.isSprite){if(!ne.frustumCulled||Y.intersectsSprite(ne)){Re&&_e.setFromMatrixPosition(ne.matrixWorld).applyMatrix4(me);const ht=we.update(ne),at=ne.material;at.visible&&w.push(ne,ht,at,Ie,_e.z,null)}}else if((ne.isMesh||ne.isLine||ne.isPoints)&&(!ne.frustumCulled||Y.intersectsObject(ne))){const ht=we.update(ne),at=ne.material;if(Re&&(ne.boundingSphere!==void 0?(ne.boundingSphere===null&&ne.computeBoundingSphere(),_e.copy(ne.boundingSphere.center)):(ht.boundingSphere===null&&ht.computeBoundingSphere(),_e.copy(ht.boundingSphere.center)),_e.applyMatrix4(ne.matrixWorld).applyMatrix4(me)),Array.isArray(at)){const mt=ht.groups;for(let wt=0,At=mt.length;wt<At;wt++){const xt=mt[wt],Wt=at[xt.materialIndex];Wt&&Wt.visible&&w.push(ne,ht,Wt,Ie,_e.z,xt)}}else at.visible&&w.push(ne,ht,at,Ie,_e.z,null)}}const it=ne.children;for(let ht=0,at=it.length;ht<at;ht++)Td(it[ht],Se,Ie,Re)}function lm(ne,Se,Ie,Re){const{opaque:Me,transmissive:it,transparent:ht}=ne;_.setupLightsView(Ie),oe===!0&&Ye.setGlobalState(S.clippingPlanes,Ie),Re&&fe.viewport(I.copy(Re)),Me.length>0&&Au(Me,Se,Ie),it.length>0&&Au(it,Se,Ie),ht.length>0&&Au(ht,Se,Ie),fe.buffers.depth.setTest(!0),fe.buffers.depth.setMask(!0),fe.buffers.color.setMask(!0),fe.setPolygonOffset(!1)}function Md(ne,Se,Ie,Re){if((Ie.isScene===!0?Ie.overrideMaterial:null)!==null)return;if(_.state.transmissionRenderTarget[Re.id]===void 0){const Wt=Ke.has("EXT_color_buffer_half_float")||Ke.has("EXT_color_buffer_float");_.state.transmissionRenderTarget[Re.id]=new Ec(1,1,{generateMipmaps:!0,type:Wt?pd:Lo,minFilter:Hm,samples:se.samples,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Rn.workingColorSpace})}const it=_.state.transmissionRenderTarget[Re.id],ht=Re.viewport||I;it.setSize(ht.z*S.transmissionResolutionScale,ht.w*S.transmissionResolutionScale);const at=S.getRenderTarget(),mt=S.getActiveCubeFace(),wt=S.getActiveMipmapLevel();S.setRenderTarget(it),S.getClearColor(H),Z=S.getClearAlpha(),Z<1&&S.setClearColor(16777215,.5),S.clear(),ze&&qe.render(Ie);const At=S.toneMapping;S.toneMapping=wc;const xt=Re.viewport;if(Re.viewport!==void 0&&(Re.viewport=void 0),_.setupLightsView(Re),oe===!0&&Ye.setGlobalState(S.clippingPlanes,Re),Au(ne,Ie,Re),K.updateMultisampleRenderTarget(it),K.updateRenderTargetMipmap(it),Ke.has("WEBGL_multisampled_render_to_texture")===!1){let Wt=!1;for(let Cn=0,mr=Se.length;Cn<mr;Cn++){const Ot=Se[Cn],{object:kn,geometry:St,material:_n,group:Dn}=Ot;if(_n.side===kh&&kn.layers.test(Re.layers)){const Is=_n.side;_n.side=to,_n.needsUpdate=!0,um(kn,Ie,Re,St,_n,Dn),_n.side=Is,_n.needsUpdate=!0,Wt=!0}}Wt===!0&&(K.updateMultisampleRenderTarget(it),K.updateRenderTargetMipmap(it))}S.setRenderTarget(at,mt,wt),S.setClearColor(H,Z),xt!==void 0&&(Re.viewport=xt),S.toneMapping=At}function Au(ne,Se,Ie){const Re=Se.isScene===!0?Se.overrideMaterial:null;for(let Me=0,it=ne.length;Me<it;Me++){const ht=ne[Me],{object:at,geometry:mt,group:wt}=ht;let At=ht.material;At.allowOverride===!0&&Re!==null&&(At=Re),at.layers.test(Ie.layers)&&um(at,Se,Ie,mt,At,wt)}}function um(ne,Se,Ie,Re,Me,it){ne.onBeforeRender(S,Se,Ie,Re,Me,it),ne.modelViewMatrix.multiplyMatrices(Ie.matrixWorldInverse,ne.matrixWorld),ne.normalMatrix.getNormalMatrix(ne.modelViewMatrix),Me.onBeforeRender(S,Se,Ie,Re,ne,it),Me.transparent===!0&&Me.side===kh&&Me.forceSinglePass===!1?(Me.side=to,Me.needsUpdate=!0,S.renderBufferDirect(Ie,Se,Re,Me,ne,it),Me.side=Pp,Me.needsUpdate=!0,S.renderBufferDirect(Ie,Se,Re,Me,ne,it),Me.side=kh):S.renderBufferDirect(Ie,Se,Re,Me,ne,it),ne.onAfterRender(S,Se,Ie,Re,Me,it)}function Cd(ne,Se,Ie){Se.isScene!==!0&&(Se=Be);const Re=P.get(ne),Me=_.state.lights,it=_.state.shadowsArray,ht=Me.state.version,at=Pe.getParameters(ne,Me.state,it,Se,Ie),mt=Pe.getProgramCacheKey(at);let wt=Re.programs;Re.environment=ne.isMeshStandardMaterial?Se.environment:null,Re.fog=Se.fog,Re.envMap=(ne.isMeshStandardMaterial?pe:ae).get(ne.envMap||Re.environment),Re.envMapRotation=Re.environment!==null&&ne.envMap===null?Se.environmentRotation:ne.envMapRotation,wt===void 0&&(ne.addEventListener("dispose",Ia),wt=new Map,Re.programs=wt);let At=wt.get(mt);if(At!==void 0){if(Re.currentProgram===At&&Re.lightsStateVersion===ht)return Jv(ne,at),At}else at.uniforms=Pe.getUniforms(ne),ne.onBeforeCompile(at,S),At=Pe.acquireProgram(at,mt),wt.set(mt,At),Re.uniforms=at.uniforms;const xt=Re.uniforms;return(!ne.isShaderMaterial&&!ne.isRawShaderMaterial||ne.clipping===!0)&&(xt.clippingPlanes=Ye.uniform),Jv(ne,at),Re.needsLights=hm(ne),Re.lightsStateVersion=ht,Re.needsLights&&(xt.ambientLightColor.value=Me.state.ambient,xt.lightProbe.value=Me.state.probe,xt.directionalLights.value=Me.state.directional,xt.directionalLightShadows.value=Me.state.directionalShadow,xt.spotLights.value=Me.state.spot,xt.spotLightShadows.value=Me.state.spotShadow,xt.rectAreaLights.value=Me.state.rectArea,xt.ltc_1.value=Me.state.rectAreaLTC1,xt.ltc_2.value=Me.state.rectAreaLTC2,xt.pointLights.value=Me.state.point,xt.pointLightShadows.value=Me.state.pointShadow,xt.hemisphereLights.value=Me.state.hemi,xt.directionalShadowMap.value=Me.state.directionalShadowMap,xt.directionalShadowMatrix.value=Me.state.directionalShadowMatrix,xt.spotShadowMap.value=Me.state.spotShadowMap,xt.spotLightMatrix.value=Me.state.spotLightMatrix,xt.spotLightMap.value=Me.state.spotLightMap,xt.pointShadowMap.value=Me.state.pointShadowMap,xt.pointShadowMatrix.value=Me.state.pointShadowMatrix),Re.currentProgram=At,Re.uniformsList=null,At}function cm(ne){if(ne.uniformsList===null){const Se=ne.currentProgram.getUniforms();ne.uniformsList=hC.seqWithValue(Se.seq,ne.uniforms)}return ne.uniformsList}function Jv(ne,Se){const Ie=P.get(ne);Ie.outputColorSpace=Se.outputColorSpace,Ie.batching=Se.batching,Ie.batchingColor=Se.batchingColor,Ie.instancing=Se.instancing,Ie.instancingColor=Se.instancingColor,Ie.instancingMorph=Se.instancingMorph,Ie.skinning=Se.skinning,Ie.morphTargets=Se.morphTargets,Ie.morphNormals=Se.morphNormals,Ie.morphColors=Se.morphColors,Ie.morphTargetsCount=Se.morphTargetsCount,Ie.numClippingPlanes=Se.numClippingPlanes,Ie.numIntersection=Se.numClipIntersection,Ie.vertexAlphas=Se.vertexAlphas,Ie.vertexTangents=Se.vertexTangents,Ie.toneMapping=Se.toneMapping}function Dd(ne,Se,Ie,Re,Me){Se.isScene!==!0&&(Se=Be),K.resetTextureUnits();const it=Se.fog,ht=Re.isMeshStandardMaterial?Se.environment:null,at=R===null?S.outputColorSpace:R.isXRRenderTarget===!0?R.texture.colorSpace:yb,mt=(Re.isMeshStandardMaterial?pe:ae).get(Re.envMap||ht),wt=Re.vertexColors===!0&&!!Ie.attributes.color&&Ie.attributes.color.itemSize===4,At=!!Ie.attributes.tangent&&(!!Re.normalMap||Re.anisotropy>0),xt=!!Ie.morphAttributes.position,Wt=!!Ie.morphAttributes.normal,Cn=!!Ie.morphAttributes.color;let mr=wc;Re.toneMapped&&(R===null||R.isXRRenderTarget===!0)&&(mr=S.toneMapping);const Ot=Ie.morphAttributes.position||Ie.morphAttributes.normal||Ie.morphAttributes.color,kn=Ot!==void 0?Ot.length:0,St=P.get(Re),_n=_.state.lights;if(oe===!0&&(ve===!0||ne!==j)){const Hi=ne===j&&Re.id===z;Ye.setState(Re,ne,Hi)}let Dn=!1;Re.version===St.__version?(St.needsLights&&St.lightsStateVersion!==_n.state.version||St.outputColorSpace!==at||Me.isBatchedMesh&&St.batching===!1||!Me.isBatchedMesh&&St.batching===!0||Me.isBatchedMesh&&St.batchingColor===!0&&Me.colorTexture===null||Me.isBatchedMesh&&St.batchingColor===!1&&Me.colorTexture!==null||Me.isInstancedMesh&&St.instancing===!1||!Me.isInstancedMesh&&St.instancing===!0||Me.isSkinnedMesh&&St.skinning===!1||!Me.isSkinnedMesh&&St.skinning===!0||Me.isInstancedMesh&&St.instancingColor===!0&&Me.instanceColor===null||Me.isInstancedMesh&&St.instancingColor===!1&&Me.instanceColor!==null||Me.isInstancedMesh&&St.instancingMorph===!0&&Me.morphTexture===null||Me.isInstancedMesh&&St.instancingMorph===!1&&Me.morphTexture!==null||St.envMap!==mt||Re.fog===!0&&St.fog!==it||St.numClippingPlanes!==void 0&&(St.numClippingPlanes!==Ye.numPlanes||St.numIntersection!==Ye.numIntersection)||St.vertexAlphas!==wt||St.vertexTangents!==At||St.morphTargets!==xt||St.morphNormals!==Wt||St.morphColors!==Cn||St.toneMapping!==mr||St.morphTargetsCount!==kn)&&(Dn=!0):(Dn=!0,St.__version=Re.version);let Is=St.currentProgram;Dn===!0&&(Is=Cd(Re,Se,Me));let Nd=!1,la=!1,dm=!1;const Zn=Is.getUniforms(),ui=St.uniforms;if(fe.useProgram(Is.program)&&(Nd=!0,la=!0,dm=!0),Re.id!==z&&(z=Re.id,la=!0),Nd||j!==ne){fe.buffers.depth.getReversed()&&ne.reversedDepth!==!0&&(ne._reversedDepth=!0,ne.updateProjectionMatrix()),Zn.setValue(de,"projectionMatrix",ne.projectionMatrix),Zn.setValue(de,"viewMatrix",ne.matrixWorldInverse);const os=Zn.map.cameraPosition;os!==void 0&&os.setValue(de,be.setFromMatrixPosition(ne.matrixWorld)),se.logarithmicDepthBuffer&&Zn.setValue(de,"logDepthBufFC",2/(Math.log(ne.far+1)/Math.LN2)),(Re.isMeshPhongMaterial||Re.isMeshToonMaterial||Re.isMeshLambertMaterial||Re.isMeshBasicMaterial||Re.isMeshStandardMaterial||Re.isShaderMaterial)&&Zn.setValue(de,"isOrthographic",ne.isOrthographicCamera===!0),j!==ne&&(j=ne,la=!0,dm=!0)}if(St.needsLights&&(_n.state.directionalShadowMap.length>0&&Zn.setValue(de,"directionalShadowMap",_n.state.directionalShadowMap,K),_n.state.spotShadowMap.length>0&&Zn.setValue(de,"spotShadowMap",_n.state.spotShadowMap,K),_n.state.pointShadowMap.length>0&&Zn.setValue(de,"pointShadowMap",_n.state.pointShadowMap,K)),Me.isSkinnedMesh){Zn.setOptional(de,Me,"bindMatrix"),Zn.setOptional(de,Me,"bindMatrixInverse");const Hi=Me.skeleton;Hi&&(Hi.boneTexture===null&&Hi.computeBoneTexture(),Zn.setValue(de,"boneTexture",Hi.boneTexture,K))}Me.isBatchedMesh&&(Zn.setOptional(de,Me,"batchingTexture"),Zn.setValue(de,"batchingTexture",Me._matricesTexture,K),Zn.setOptional(de,Me,"batchingIdTexture"),Zn.setValue(de,"batchingIdTexture",Me._indirectTexture,K),Zn.setOptional(de,Me,"batchingColorTexture"),Me._colorsTexture!==null&&Zn.setValue(de,"batchingColorTexture",Me._colorsTexture,K));const ci=Ie.morphAttributes;if((ci.position!==void 0||ci.normal!==void 0||ci.color!==void 0)&&V.update(Me,Ie,Is),(la||St.receiveShadow!==Me.receiveShadow)&&(St.receiveShadow=Me.receiveShadow,Zn.setValue(de,"receiveShadow",Me.receiveShadow)),Re.isMeshGouraudMaterial&&Re.envMap!==null&&(ui.envMap.value=mt,ui.flipEnvMap.value=mt.isCubeTexture&&mt.isRenderTargetTexture===!1?-1:1),Re.isMeshStandardMaterial&&Re.envMap===null&&Se.environment!==null&&(ui.envMapIntensity.value=Se.environmentIntensity),ui.dfgLUT!==void 0&&(ui.dfgLUT.value=qTe()),la&&(Zn.setValue(de,"toneMappingExposure",S.toneMappingExposure),St.needsLights&&e0(ui,dm),it&&Re.fog===!0&&Te.refreshFogUniforms(ui,it),Te.refreshMaterialUniforms(ui,Re,O,ee,_.state.transmissionRenderTarget[ne.id]),hC.upload(de,cm(St),ui,K)),Re.isShaderMaterial&&Re.uniformsNeedUpdate===!0&&(hC.upload(de,cm(St),ui,K),Re.uniformsNeedUpdate=!1),Re.isSpriteMaterial&&Zn.setValue(de,"center",Me.center),Zn.setValue(de,"modelViewMatrix",Me.modelViewMatrix),Zn.setValue(de,"normalMatrix",Me.normalMatrix),Zn.setValue(de,"modelMatrix",Me.matrixWorld),Re.isShaderMaterial||Re.isRawShaderMaterial){const Hi=Re.uniformsGroups;for(let os=0,t0=Hi.length;os<t0;os++){const Tu=Hi[os];Le.update(Tu,Is),Le.bind(Tu,Is)}}return Is}function e0(ne,Se){ne.ambientLightColor.needsUpdate=Se,ne.lightProbe.needsUpdate=Se,ne.directionalLights.needsUpdate=Se,ne.directionalLightShadows.needsUpdate=Se,ne.pointLights.needsUpdate=Se,ne.pointLightShadows.needsUpdate=Se,ne.spotLights.needsUpdate=Se,ne.spotLightShadows.needsUpdate=Se,ne.rectAreaLights.needsUpdate=Se,ne.hemisphereLights.needsUpdate=Se}function hm(ne){return ne.isMeshLambertMaterial||ne.isMeshToonMaterial||ne.isMeshPhongMaterial||ne.isMeshStandardMaterial||ne.isShadowMaterial||ne.isShaderMaterial&&ne.lights===!0}this.getActiveCubeFace=function(){return D},this.getActiveMipmapLevel=function(){return N},this.getRenderTarget=function(){return R},this.setRenderTargetTextures=function(ne,Se,Ie){const Re=P.get(ne);Re.__autoAllocateDepthBuffer=ne.resolveDepthBuffer===!1,Re.__autoAllocateDepthBuffer===!1&&(Re.__useRenderToTexture=!1),P.get(ne.texture).__webglTexture=Se,P.get(ne.depthTexture).__webglTexture=Re.__autoAllocateDepthBuffer?void 0:Ie,Re.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(ne,Se){const Ie=P.get(ne);Ie.__webglFramebuffer=Se,Ie.__useDefaultFramebuffer=Se===void 0};const Bc=de.createFramebuffer();this.setRenderTarget=function(ne,Se=0,Ie=0){R=ne,D=Se,N=Ie;let Re=null,Me=!1,it=!1;if(ne){const at=P.get(ne);if(at.__useDefaultFramebuffer!==void 0){fe.bindFramebuffer(de.FRAMEBUFFER,at.__webglFramebuffer),I.copy(ne.viewport),F.copy(ne.scissor),$=ne.scissorTest,fe.viewport(I),fe.scissor(F),fe.setScissorTest($),z=-1;return}else if(at.__webglFramebuffer===void 0)K.setupRenderTarget(ne);else if(at.__hasExternalTextures)K.rebindTextures(ne,P.get(ne.texture).__webglTexture,P.get(ne.depthTexture).__webglTexture);else if(ne.depthBuffer){const At=ne.depthTexture;if(at.__boundDepthTexture!==At){if(At!==null&&P.has(At)&&(ne.width!==At.image.width||ne.height!==At.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");K.setupDepthRenderbuffer(ne)}}const mt=ne.texture;(mt.isData3DTexture||mt.isDataArrayTexture||mt.isCompressedArrayTexture)&&(it=!0);const wt=P.get(ne).__webglFramebuffer;ne.isWebGLCubeRenderTarget?(Array.isArray(wt[Se])?Re=wt[Se][Ie]:Re=wt[Se],Me=!0):ne.samples>0&&K.useMultisampledRTT(ne)===!1?Re=P.get(ne).__webglMultisampledFramebuffer:Array.isArray(wt)?Re=wt[Ie]:Re=wt,I.copy(ne.viewport),F.copy(ne.scissor),$=ne.scissorTest}else I.copy(re).multiplyScalar(O).floor(),F.copy(le).multiplyScalar(O).floor(),$=te;if(Ie!==0&&(Re=Bc),fe.bindFramebuffer(de.FRAMEBUFFER,Re)&&fe.drawBuffers(ne,Re),fe.viewport(I),fe.scissor(F),fe.setScissorTest($),Me){const at=P.get(ne.texture);de.framebufferTexture2D(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_CUBE_MAP_POSITIVE_X+Se,at.__webglTexture,Ie)}else if(it){const at=Se;for(let mt=0;mt<ne.textures.length;mt++){const wt=P.get(ne.textures[mt]);de.framebufferTextureLayer(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0+mt,wt.__webglTexture,Ie,at)}}else if(ne!==null&&Ie!==0){const at=P.get(ne.texture);de.framebufferTexture2D(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_2D,at.__webglTexture,Ie)}z=-1},this.readRenderTargetPixels=function(ne,Se,Ie,Re,Me,it,ht,at=0){if(!(ne&&ne.isWebGLRenderTarget)){Bn("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let mt=P.get(ne).__webglFramebuffer;if(ne.isWebGLCubeRenderTarget&&ht!==void 0&&(mt=mt[ht]),mt){fe.bindFramebuffer(de.FRAMEBUFFER,mt);try{const wt=ne.textures[at],At=wt.format,xt=wt.type;if(!se.textureFormatReadable(At)){Bn("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!se.textureTypeReadable(xt)){Bn("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Se>=0&&Se<=ne.width-Re&&Ie>=0&&Ie<=ne.height-Me&&(ne.textures.length>1&&de.readBuffer(de.COLOR_ATTACHMENT0+at),de.readPixels(Se,Ie,Re,Me,Ee.convert(At),Ee.convert(xt),it))}finally{const wt=R!==null?P.get(R).__webglFramebuffer:null;fe.bindFramebuffer(de.FRAMEBUFFER,wt)}}},this.readRenderTargetPixelsAsync=async function(ne,Se,Ie,Re,Me,it,ht,at=0){if(!(ne&&ne.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let mt=P.get(ne).__webglFramebuffer;if(ne.isWebGLCubeRenderTarget&&ht!==void 0&&(mt=mt[ht]),mt)if(Se>=0&&Se<=ne.width-Re&&Ie>=0&&Ie<=ne.height-Me){fe.bindFramebuffer(de.FRAMEBUFFER,mt);const wt=ne.textures[at],At=wt.format,xt=wt.type;if(!se.textureFormatReadable(At))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!se.textureTypeReadable(xt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Wt=de.createBuffer();de.bindBuffer(de.PIXEL_PACK_BUFFER,Wt),de.bufferData(de.PIXEL_PACK_BUFFER,it.byteLength,de.STREAM_READ),ne.textures.length>1&&de.readBuffer(de.COLOR_ATTACHMENT0+at),de.readPixels(Se,Ie,Re,Me,Ee.convert(At),Ee.convert(xt),0);const Cn=R!==null?P.get(R).__webglFramebuffer:null;fe.bindFramebuffer(de.FRAMEBUFFER,Cn);const mr=de.fenceSync(de.SYNC_GPU_COMMANDS_COMPLETE,0);return de.flush(),await p1e(de,mr,4),de.bindBuffer(de.PIXEL_PACK_BUFFER,Wt),de.getBufferSubData(de.PIXEL_PACK_BUFFER,0,it),de.deleteBuffer(Wt),de.deleteSync(mr),it}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(ne,Se=null,Ie=0){const Re=Math.pow(2,-Ie),Me=Math.floor(ne.image.width*Re),it=Math.floor(ne.image.height*Re),ht=Se!==null?Se.x:0,at=Se!==null?Se.y:0;K.setTexture2D(ne,0),de.copyTexSubImage2D(de.TEXTURE_2D,Ie,0,0,ht,at,Me,it),fe.unbindTexture()};const oa=de.createFramebuffer(),bn=de.createFramebuffer();this.copyTextureToTexture=function(ne,Se,Ie=null,Re=null,Me=0,it=null){it===null&&(Me!==0?(Mw("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),it=Me,Me=0):it=0);let ht,at,mt,wt,At,xt,Wt,Cn,mr;const Ot=ne.isCompressedTexture?ne.mipmaps[it]:ne.image;if(Ie!==null)ht=Ie.max.x-Ie.min.x,at=Ie.max.y-Ie.min.y,mt=Ie.isBox3?Ie.max.z-Ie.min.z:1,wt=Ie.min.x,At=Ie.min.y,xt=Ie.isBox3?Ie.min.z:0;else{const ci=Math.pow(2,-Me);ht=Math.floor(Ot.width*ci),at=Math.floor(Ot.height*ci),ne.isDataArrayTexture?mt=Ot.depth:ne.isData3DTexture?mt=Math.floor(Ot.depth*ci):mt=1,wt=0,At=0,xt=0}Re!==null?(Wt=Re.x,Cn=Re.y,mr=Re.z):(Wt=0,Cn=0,mr=0);const kn=Ee.convert(Se.format),St=Ee.convert(Se.type);let _n;Se.isData3DTexture?(K.setTexture3D(Se,0),_n=de.TEXTURE_3D):Se.isDataArrayTexture||Se.isCompressedArrayTexture?(K.setTexture2DArray(Se,0),_n=de.TEXTURE_2D_ARRAY):(K.setTexture2D(Se,0),_n=de.TEXTURE_2D),de.pixelStorei(de.UNPACK_FLIP_Y_WEBGL,Se.flipY),de.pixelStorei(de.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Se.premultiplyAlpha),de.pixelStorei(de.UNPACK_ALIGNMENT,Se.unpackAlignment);const Dn=de.getParameter(de.UNPACK_ROW_LENGTH),Is=de.getParameter(de.UNPACK_IMAGE_HEIGHT),Nd=de.getParameter(de.UNPACK_SKIP_PIXELS),la=de.getParameter(de.UNPACK_SKIP_ROWS),dm=de.getParameter(de.UNPACK_SKIP_IMAGES);de.pixelStorei(de.UNPACK_ROW_LENGTH,Ot.width),de.pixelStorei(de.UNPACK_IMAGE_HEIGHT,Ot.height),de.pixelStorei(de.UNPACK_SKIP_PIXELS,wt),de.pixelStorei(de.UNPACK_SKIP_ROWS,At),de.pixelStorei(de.UNPACK_SKIP_IMAGES,xt);const Zn=ne.isDataArrayTexture||ne.isData3DTexture,ui=Se.isDataArrayTexture||Se.isData3DTexture;if(ne.isDepthTexture){const ci=P.get(ne),Hi=P.get(Se),os=P.get(ci.__renderTarget),t0=P.get(Hi.__renderTarget);fe.bindFramebuffer(de.READ_FRAMEBUFFER,os.__webglFramebuffer),fe.bindFramebuffer(de.DRAW_FRAMEBUFFER,t0.__webglFramebuffer);for(let Tu=0;Tu<mt;Tu++)Zn&&(de.framebufferTextureLayer(de.READ_FRAMEBUFFER,de.COLOR_ATTACHMENT0,P.get(ne).__webglTexture,Me,xt+Tu),de.framebufferTextureLayer(de.DRAW_FRAMEBUFFER,de.COLOR_ATTACHMENT0,P.get(Se).__webglTexture,it,mr+Tu)),de.blitFramebuffer(wt,At,ht,at,Wt,Cn,ht,at,de.DEPTH_BUFFER_BIT,de.NEAREST);fe.bindFramebuffer(de.READ_FRAMEBUFFER,null),fe.bindFramebuffer(de.DRAW_FRAMEBUFFER,null)}else if(Me!==0||ne.isRenderTargetTexture||P.has(ne)){const ci=P.get(ne),Hi=P.get(Se);fe.bindFramebuffer(de.READ_FRAMEBUFFER,oa),fe.bindFramebuffer(de.DRAW_FRAMEBUFFER,bn);for(let os=0;os<mt;os++)Zn?de.framebufferTextureLayer(de.READ_FRAMEBUFFER,de.COLOR_ATTACHMENT0,ci.__webglTexture,Me,xt+os):de.framebufferTexture2D(de.READ_FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_2D,ci.__webglTexture,Me),ui?de.framebufferTextureLayer(de.DRAW_FRAMEBUFFER,de.COLOR_ATTACHMENT0,Hi.__webglTexture,it,mr+os):de.framebufferTexture2D(de.DRAW_FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_2D,Hi.__webglTexture,it),Me!==0?de.blitFramebuffer(wt,At,ht,at,Wt,Cn,ht,at,de.COLOR_BUFFER_BIT,de.NEAREST):ui?de.copyTexSubImage3D(_n,it,Wt,Cn,mr+os,wt,At,ht,at):de.copyTexSubImage2D(_n,it,Wt,Cn,wt,At,ht,at);fe.bindFramebuffer(de.READ_FRAMEBUFFER,null),fe.bindFramebuffer(de.DRAW_FRAMEBUFFER,null)}else ui?ne.isDataTexture||ne.isData3DTexture?de.texSubImage3D(_n,it,Wt,Cn,mr,ht,at,mt,kn,St,Ot.data):Se.isCompressedArrayTexture?de.compressedTexSubImage3D(_n,it,Wt,Cn,mr,ht,at,mt,kn,Ot.data):de.texSubImage3D(_n,it,Wt,Cn,mr,ht,at,mt,kn,St,Ot):ne.isDataTexture?de.texSubImage2D(de.TEXTURE_2D,it,Wt,Cn,ht,at,kn,St,Ot.data):ne.isCompressedTexture?de.compressedTexSubImage2D(de.TEXTURE_2D,it,Wt,Cn,Ot.width,Ot.height,kn,Ot.data):de.texSubImage2D(de.TEXTURE_2D,it,Wt,Cn,ht,at,kn,St,Ot);de.pixelStorei(de.UNPACK_ROW_LENGTH,Dn),de.pixelStorei(de.UNPACK_IMAGE_HEIGHT,Is),de.pixelStorei(de.UNPACK_SKIP_PIXELS,Nd),de.pixelStorei(de.UNPACK_SKIP_ROWS,la),de.pixelStorei(de.UNPACK_SKIP_IMAGES,dm),it===0&&Se.generateMipmaps&&de.generateMipmap(_n),fe.unbindTexture()},this.initRenderTarget=function(ne){P.get(ne).__webglFramebuffer===void 0&&K.setupRenderTarget(ne)},this.initTexture=function(ne){ne.isCubeTexture?K.setTextureCube(ne,0):ne.isData3DTexture?K.setTexture3D(ne,0):ne.isDataArrayTexture||ne.isCompressedArrayTexture?K.setTexture2DArray(ne,0):K.setTexture2D(ne,0),fe.unbindTexture()},this.resetState=function(){D=0,N=0,R=null,fe.reset(),Fe.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return uc}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Rn._getDrawingBufferColorSpace(e),t.unpackColorSpace=Rn._getUnpackColorSpace()}}function XTe(){const{isDark:n}=Nl(),[e,t]=xe.useState("neutron-collision"),[r,i]=xe.useState(0),[s,a]=xe.useState(1),[o,l]=xe.useState(!0),[u,c]=xe.useState(!0),h=xe.useRef(null),d=xe.useRef(null),f=xe.useRef(null),p=xe.useRef(null),m=xe.useRef(null),y=xe.useRef(0),v=xe.useRef({x:0,y:0,down:!1}),b=F=>{let $,H,Z;const J=Math.max(1e3,Math.min(5e4,F))/100;return J<=66?($=255,H=Math.max(0,9.94743955*Math.log(J)-161.1195681)):($=Math.max(0,32.9698727446*Math.pow(J-60,-.1332047592)),H=Math.max(0,28.81221695*Math.pow(J-60,-.0755148492))),Z=J>=66?255:Math.max(0,13.96777577*Math.log(J-10)-305.0447927),new Bt($/255,H/255,Z/255)};class x{constructor($,H={}){this.count=$,this.config={maxVelocity:H.maxVelocity||.1,lifetime:H.lifetime||10,gravity:H.gravity||0,radius:H.radius||.5,...H};const Z=new Ms,J=new Float32Array($*3),ee=new Float32Array($*3),O=new Float32Array($*3),ue=new Float32Array($),Q=new Float32Array($);for(let le=0;le<$;le++){const te=Math.random()*Math.PI*2,Y=Math.acos(Math.random()*2-1),oe=Math.random()**(1/3)*this.config.radius;J[le*3]=Math.sin(Y)*Math.cos(te)*oe,J[le*3+1]=Math.sin(Y)*Math.sin(te)*oe,J[le*3+2]=Math.cos(Y)*oe;const ve=Math.random()*this.config.maxVelocity;ee[le*3]=Math.sin(Y)*Math.cos(te)*ve,ee[le*3+1]=Math.sin(Y)*Math.sin(te)*ve,ee[le*3+2]=Math.cos(Y)*ve;const me=Math.random()*(this.config.maxTemp-this.config.minTemp)+this.config.minTemp,be=b(me);O[le*3]=be.r,O[le*3+1]=be.g,O[le*3+2]=be.b,ue[le]=this.config.lifetime,Q[le]=0}Z.setAttribute("position",new Ya(J,3)),Z.setAttribute("color",new Ya(O,3));const re=new fO({size:.05,vertexColors:!0,sizeAttenuation:!0,transparent:!0,opacity:.9});this.mesh=new _9(Z,re),this.velocities=ee,this.ages=Q,this.lifetimes=ue,this.positionAttribute=Z.getAttribute("position"),this.colorAttribute=Z.getAttribute("color")}update($){const H=this.positionAttribute.array;for(let Z=0;Z<this.count;Z++){const J=Z*3;if(this.ages[Z]+=$,1-this.ages[Z]/this.lifetimes[Z]>0){if(this.config.gravity){const O=H[J]**2+H[J+1]**2+H[J+2]**2;if(O>.001){const ue=Math.sqrt(O),Q=-this.config.gravity/O;this.velocities[J]+=Q*H[J]/ue*.016,this.velocities[J+1]+=Q*H[J+1]/ue*.016,this.velocities[J+2]+=Q*H[J+2]/ue*.016}}H[J]+=this.velocities[J],H[J+1]+=this.velocities[J+1],H[J+2]+=this.velocities[J+2]}}this.positionAttribute.needsUpdate=!0}}const w=()=>{const F=new Float32Array(6e3),$=new Float32Array(2e3*3);for(let J=0;J<2e3;J++){F[J*3]=(Math.random()-.5)*300,F[J*3+1]=(Math.random()-.5)*300,F[J*3+2]=(Math.random()-.5)*300;const ee=3e3+Math.random()*2e4,O=b(ee);$[J*3]=O.r,$[J*3+1]=O.g,$[J*3+2]=O.b}const H=new Ms;H.setAttribute("position",new Ya(F,3)),H.setAttribute("color",new Ya($,3));const Z=new fO({size:.3,vertexColors:!0,sizeAttenuation:!0,transparent:!0,opacity:.8});return new _9(H,Z)},z=[{id:"neutron-collision",name:" ",create:()=>{const F=new Gc;F.background=new Bt(0),F.fog=new Lu(0,150,500),F.add(w());const $=new zl(.3,64,64),H=new Ru({color:1728416,emissive:867694,metalness:.2,roughness:.4}),Z=new cr($,H);Z.position.set(-1.2,0,0),F.add(Z);const J=new zl(.3,64,64),ee=new Ru({color:13395456,emissive:10044416,metalness:.2,roughness:.4}),O=new cr(J,ee);O.position.set(1.2,0,0),F.add(O);const ue=new Zc(.8,.25,32,256),Q=new Ru({color:16737792,emissive:16729088,emissiveIntensity:0,metalness:0,roughness:.7,transparent:!0,opacity:0}),re=new cr(ue,Q);re.rotation.x=.3,F.add(re);const le=new x(2500,{maxVelocity:.35,lifetime:8,radius:.1,minTemp:3e3,maxTemp:12e3,gravity:.02});F.add(le.mesh);const te=[];for(let me=0;me<8;me++){const be=new Zc(.4+me*.35,.06,32,128),_e=new Xd({color:56831,transparent:!0,opacity:0,wireframe:!0}),Be=new cr(be,_e);te.push({mesh:Be,scale:.4+me*.35}),F.add(Be)}const Y=new ua(35071,1.2);Y.position.set(-3,2,3),F.add(Y);const oe=new ua(16737792,1.5);oe.position.set(3,2,3),F.add(oe);const ve=new jc(3359846,.4);return F.add(ve),{scene:F,animate:me=>{const be=Math.min(me,.4),_e=Math.max(0,Math.min(1,(me-.4)/.3));Z.position.x=-1.2+be*2,O.position.x=1.2-be*2,Z.rotation.y+=.008,O.rotation.y-=.008,_e>0&&(re.material.opacity=Math.min(.8,_e*1.5),re.material.emissiveIntensity=_e*.9,re.rotation.z+=.06,le.update(.016),te.forEach((Be,ze)=>{Be.mesh.material.opacity=Math.max(0,.6-_e*.8),Be.mesh.scale.set(1+_e*1+ze*.15,1+_e*1+ze*.15,1)}))}}}},{id:"black-hole",name:"  ",create:()=>{const F=new Gc;F.background=new Bt(0),F.fog=new Lu(0,200,500),F.add(w());const $=new zl(.35,128,128),H=new Xd({color:0}),Z=new cr($,H);F.add(Z);const J=new Zc(.55,.12,32,512),ee=new q1e({color:16755268,emissive:16746496,emissiveIntensity:.95,shininess:120}),O=new cr(J,ee);O.rotation.x=.35,F.add(O);const ue=[];for(let me=0;me<14;me++){const be=.65+me*.28,_e=.16,Be=new Zc(be,_e,16,512),ze=8500-me*450,tt=b(ze),de=new Ru({color:tt,emissive:tt,emissiveIntensity:.75,metalness:0,roughness:.5,transparent:!0,opacity:.9-me*.05}),Xe=new cr(Be,de);Xe.rotation.x=.2,Xe.userData.rotationSpeed=.045-me*.002,ue.push(Xe),F.add(Xe)}const Q=new G4(.18,3.5,32),re=new Ru({color:43775,emissive:35071,emissiveIntensity:.95,metalness:.1}),le=new cr(Q,re);le.position.z=2.2;const te=new cr(Q,re);te.position.z=-2.2,te.rotation.z=Math.PI,F.add(le),F.add(te);const Y=new ua(16746564,2);F.add(Y);const oe=new ua(35071,1.2);oe.position.set(0,0,5),F.add(oe);const ve=new jc(1714746,.3);return F.add(ve),{scene:F,animate:me=>{ue.forEach((be,_e)=>{be.rotation.z+=be.userData.rotationSpeed,be.material.emissiveIntensity=.65+Math.sin(me*2.5+_e)*.2}),O.rotation.z+=.02,O.material.emissiveIntensity=.85+Math.sin(me*1.8)*.15,le.position.z=2.2+Math.sin(me*.6)*.15,te.position.z=-2.2-Math.sin(me*.6)*.15}}}},{id:"supernova",name:" ",create:()=>{const F=new Gc;F.background=new Bt(657966),F.fog=new Lu(657966,100,500),F.add(w());const $=new zl(.15,32,32),H=new Ru({color:16776960,emissive:16776960,emissiveIntensity:1,metalness:0}),Z=new cr($,H);F.add(Z);const J=new zl(.2,64,64),ee=new Ru({color:16737792,emissive:16729088,emissiveIntensity:.8,transparent:!0,opacity:.7}),O=new cr(J,ee);F.add(O);const ue=new x(3500,{maxVelocity:.45,lifetime:10,radius:.2,minTemp:4e3,maxTemp:15e3,gravity:.015});F.add(ue.mesh);const Q=[];for(let Y=0;Y<12;Y++){const oe=new Zc(.25+Y*.22,.07,16,256),ve=new Xd({color:65535,transparent:!0,opacity:0,wireframe:!0}),me=new cr(oe,ve);Q.push(me),F.add(me)}const re=new ua(16776960,2.5);F.add(re);const le=new ua(16737792,1.8);le.position.set(.5,.5,.5),F.add(le);const te=new jc(4856320,.35);return F.add(te),{scene:F,animate:Y=>{O.scale.set(1+Y*3.5,1+Y*3.5,1+Y*3.5),O.material.opacity=Math.max(0,.7-Y*.7),Z.scale.set(Math.max(.1,.15-Y*.12),Math.max(.1,.15-Y*.12),Math.max(.1,.15-Y*.12)),ue.update(.016),Q.forEach((oe,ve)=>{oe.scale.set(1+Y*3.5+ve*.3,1+Y*3.5+ve*.3,1),oe.material.opacity=Math.max(0,.8-Y*.95-ve*.08)})}}}},{id:"galaxy-merger",name:"  ",create:()=>{const F=new Gc;F.background=new Bt(2053),F.fog=new Lu(2053,150,500),F.add(w());const $=new x(2e3,{maxVelocity:.08,lifetime:12,radius:1.2,minTemp:3500,maxTemp:9e3,gravity:.08});$.mesh.position.set(-2,0,0),F.add($.mesh);const H=new x(2e3,{maxVelocity:.08,lifetime:12,radius:1.2,minTemp:3500,maxTemp:9e3,gravity:.08});H.mesh.position.set(2,.5,0),F.add(H.mesh);const Z=new ua(4491519,1);Z.position.set(-3,1,2),F.add(Z);const J=new ua(16755268,1);J.position.set(3,1,2),F.add(J);const ee=new jc(2241348,.4);return F.add(ee),{scene:F,animate:O=>{$.mesh.position.x=-2+O*1.8,H.mesh.position.x=2-O*1.8,$.update(.016),H.update(.016)}}}},{id:"cosmic-web",name:"  ",create:()=>{const F=new Gc;F.background=new Bt(0),F.fog=new Lu(0,200,500),F.add(w());const $=[];for(let J=0;J<20;J++){const ee=J/20*Math.PI*2,O=Math.cos(ee)*2,ue=Math.sin(ee)*2,Q=new x(800,{maxVelocity:.02,lifetime:15,radius:.3,minTemp:1e3,maxTemp:5e3,gravity:.03});Q.mesh.position.set(O,0,ue),$.push(Q),F.add(Q.mesh)}const H=new ua(17663,.8);F.add(H);const Z=new jc(1710650,.4);return F.add(Z),{scene:F,animate:J=>{$.forEach((ee,O)=>{ee.update(.016),ee.mesh.rotation.z+=.001})}}}},{id:"cme",name:" ",create:()=>{const F=new Gc;F.background=new Bt(0),F.fog=new Lu(0,150,500),F.add(w());const $=new zl(.4,64,64),H=new Ru({color:16746564,emissive:16737792,emissiveIntensity:.9,metalness:0}),Z=new cr($,H);F.add(Z);const J=new x(2500,{maxVelocity:.3,lifetime:8,radius:.15,minTemp:5e3,maxTemp:2e4,gravity:.01});F.add(J.mesh);const ee=[];for(let re=0;re<15;re++){const le=[];for(let ve=0;ve<20;ve++){const me=ve/20,be=re/15*Math.PI*2,_e=(.5+me*1.5)*Math.cos(be),Be=Math.sin(me*Math.PI)*.5,ze=(.5+me*1.5)*Math.sin(be);le.push(new De(_e,Be,ze))}const te=new Ms().setFromPoints(le),Y=new Wee({color:43775,transparent:!0,opacity:0}),oe=new H1e(te,Y);ee.push({line:oe,opacity:0}),F.add(oe)}const O=new ua(16746564,2);F.add(O);const ue=new ua(43775,.8);ue.position.set(0,2,0),F.add(ue);const Q=new jc(3807744,.3);return F.add(Q),{scene:F,animate:re=>{Z.rotation.y+=.002,J.update(.016),ee.forEach((le,te)=>{re<.5?le.opacity=Math.min(.7,re*1.4):le.opacity=Math.max(0,.7-(re-.5)*1.4),le.line.material.opacity=le.opacity})}}}},{id:"inflation",name:"  ",create:()=>{const F=new Gc;F.background=new Bt(328976),F.fog=new Lu(328976,200,500);const $=new x(4e3,{maxVelocity:.5,lifetime:12,radius:1.5,minTemp:8e3,maxTemp:25e3,gravity:0});F.add($.mesh);const H=[];for(let O=0;O<10;O++){const ue=new zl(.3+O*.4,32,32),Q=new Xd({color:65535,transparent:!0,opacity:0,wireframe:!0}),re=new cr(ue,Q);H.push(re),F.add(re)}const Z=new ua(65535,1);Z.position.set(3,0,0),F.add(Z);const J=new ua(16711935,.8);J.position.set(-3,0,0),F.add(J);const ee=new jc(1706554,.4);return F.add(ee),{scene:F,animate:O=>{$.update(.016),H.forEach((ue,Q)=>{ue.scale.set(1+O*2.5+Q*.3,1+O*2.5+Q*.3,1+O*2.5+Q*.3),ue.material.opacity=Math.max(0,.6-O*.6-Q*.08)})}}}},{id:"planet",name:"  ",create:()=>{const F=new Gc;F.background=new Bt(656656),F.fog=new Lu(656656,150,500),F.add(w());const $=new Zc(1.5,.5,32,256),H=new Ru({color:11176004,emissive:8930338,emissiveIntensity:.6,metalness:0,roughness:.8,transparent:!0,opacity:.8}),Z=new cr($,H);Z.rotation.x=.4,F.add(Z);const J=new x(2500,{maxVelocity:.1,lifetime:10,radius:1.2,minTemp:2e3,maxTemp:5e3,gravity:.05});F.add(J.mesh);const ee=[];for(let Q=0;Q<5;Q++){const re=Q/5*Math.PI*2,le=new zl(.08+Math.random()*.08,32,32),te=new Ru({color:new Bt().setHSL(Math.random(),.6,.4),metalness:.3,roughness:.6}),Y=new cr(le,te),oe=.8+Math.random()*.6;Y.position.set(Math.cos(re)*oe,.1,Math.sin(re)*oe),ee.push({mesh:Y,angle:re,radius:oe,speed:.002+Math.random()*.004}),F.add(Y)}const O=new ua(16755302,1.5);F.add(O);const ue=new jc(3811866,.4);return F.add(ue),{scene:F,animate:Q=>{Z.rotation.z+=.001,J.update(.016),ee.forEach(re=>{re.angle+=re.speed,re.mesh.position.x=Math.cos(re.angle)*re.radius,re.mesh.position.z=Math.sin(re.angle)*re.radius,re.mesh.rotation.y+=.01})}}}},{id:"lensing",name:"  ",create:()=>{const F=new Gc;F.background=new Bt(0),F.add(w());const $=new zl(.25,64,64),H=new Xd({color:0}),Z=new cr($,H);F.add(Z);const J=new x(2e3,{maxVelocity:.02,lifetime:15,radius:1,minTemp:4e3,maxTemp:8e3,gravity:.03});J.mesh.position.z=-2,F.add(J.mesh);const ee=[];for(let Q=0;Q<6;Q++){const re=new Zc(.4+Q*.2,.05,32,128),le=new Xd({color:43775,transparent:!0,opacity:.3}),te=new cr(re,le);ee.push(te),F.add(te)}const O=new ua(16777215,.5);O.position.set(2,2,2),F.add(O);const ue=new jc(1710650,.4);return F.add(ue),{scene:F,animate:Q=>{Z.rotation.z+=.005,J.update(.016),ee.forEach((re,le)=>{re.rotation.z+=.01+le*.005,re.material.opacity=.3+Math.sin(Q*2+le)*.15})}}}}],j=z.find(F=>F.id===e),I=`${n?"bg-gray-900 border-gray-800 text-white":"bg-white border-gray-200 text-gray-900"}`;return xe.useEffect(()=>{if(!h.current)return;p.current&&(p.current.dispose(),h.current.removeChild(p.current.domElement));const F=new WTe({antialias:!0,alpha:!0});F.setSize(h.current.clientWidth,500),F.setPixelRatio(window.devicePixelRatio),F.shadowMap.enabled=!0,h.current.appendChild(F.domElement);const $=new Io(75,h.current.clientWidth/500,.1,1e3);$.position.z=4;const H=j.create(),Z=H.scene;d.current=Z,f.current=$,p.current=F,y.current=0;const J=O=>{u&&(v.current.x=O.clientX/window.innerWidth*2-1,v.current.y=-(O.clientY/window.innerHeight)*2+1)};window.addEventListener("mousemove",J);const ee=()=>{m.current=requestAnimationFrame(ee),o?(y.current+=.003*s,y.current>1&&(y.current=0),i(y.current)):y.current=r,u&&($.position.x=Math.sin(v.current.x*Math.PI)*4,$.position.y=v.current.y*3,$.lookAt(0,0,0)),H.animate(y.current),F.render(Z,$)};return ee(),()=>{window.removeEventListener("mousemove",J),m.current&&cancelAnimationFrame(m.current)}},[e,o,s,u,n,j,r]),k.jsxs("div",{className:`space-y-6 ${n?"bg-gray-950":"bg-gray-50"}`,children:[k.jsxs(ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:`p-6 rounded-3xl border shadow-sm ${I}`,children:[k.jsx("h1",{className:"text-4xl font-bold mb-2",children:"  "}),k.jsx("p",{className:`text-lg ${n?"text-gray-400":"text-gray-600"}`,children:"   3D  "})]}),k.jsxs(ct.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.1},className:`p-6 rounded-3xl border shadow-sm ${I}`,children:[k.jsx("div",{ref:h,className:"w-full rounded-2xl overflow-hidden",style:{height:"500px"}}),k.jsx("div",{className:"mt-6 grid grid-cols-3 gap-2",children:z.map(F=>k.jsx("button",{onClick:()=>t(F.id),className:`py-2 px-3 rounded-lg text-sm font-bold transition-all ${e===F.id?"bg-gradient-to-r from-purple-500 to-pink-500 text-white":n?"bg-gray-800 text-gray-300 hover:bg-gray-700":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:F.name},F.id))}),k.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6",children:[k.jsxs("div",{children:[k.jsxs("label",{className:"block text-sm font-semibold mb-3",children:["  (",(r*100).toFixed(0),"%)"]}),k.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:r,onChange:F=>{const $=parseFloat(F.target.value);i($),y.current=$,l(!1)},className:"w-full"})]}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-sm font-semibold mb-3",children:" "}),k.jsxs("select",{value:s,onChange:F=>a(parseFloat(F.target.value)),className:`w-full px-3 py-2 rounded-lg border ${n?"bg-gray-800 border-gray-700":"bg-white border-gray-300"}`,children:[k.jsx("option",{value:.25,children:"0.25x"}),k.jsx("option",{value:.5,children:"0.5x"}),k.jsx("option",{value:1,children:"1x"}),k.jsx("option",{value:2,children:"2x"}),k.jsx("option",{value:3,children:"3x"})]})]})]}),k.jsxs("div",{className:"flex gap-3 mt-6",children:[k.jsx("button",{onClick:()=>l(!o),className:`flex-1 py-3 px-4 rounded-xl font-bold transition-all ${o?"bg-gradient-to-r from-red-500 to-pink-500 text-white":"bg-gradient-to-r from-green-500 to-blue-500 text-white"}`,children:o?"  ":" "}),k.jsx("button",{onClick:()=>c(!u),className:`flex-1 py-3 px-4 rounded-xl font-bold transition-all ${u?"bg-gradient-to-r from-purple-500 to-pink-500 text-white":"bg-gradient-to-r from-gray-500 to-gray-600 text-white"}`,children:u?"  ":"  "})]})]}),k.jsxs(ct.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},className:`p-6 rounded-3xl border shadow-sm ${I}`,children:[k.jsx("h2",{className:"text-2xl font-bold mb-4",children:" "}),k.jsxs("div",{className:`space-y-2 text-sm ${n?"text-gray-300":"text-gray-600"}`,children:[k.jsxs("p",{children:[k.jsx("strong",{children:" 9  3D :"})," Planck       "]}),k.jsxs("p",{children:[k.jsx("strong",{children:"  :"}),"   3D    "]}),k.jsxs("p",{children:[k.jsx("strong",{children:"  :"}),"      "]}),k.jsxs("p",{children:[k.jsx("strong",{children:"  :"}),"   , ,  ,   "]})]})]})]})}function ai(){return ai=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},ai.apply(null,arguments)}var nte={relTol:1e-12,absTol:1e-15,matrix:"Matrix",number:"number",numberFallback:"number",precision:64,predictable:!1,randomSeed:null,legacySubset:!1};function Ea(n,e){if(ND(n,e))return n[e];throw typeof n[e]=="function"&&j4(n,e)?new Error('Cannot access method "'+e+'" as a property'):new Error('No access to property "'+e+'"')}function bb(n,e,t){if(ND(n,e))return n[e]=t,t;throw new Error('No access to property "'+e+'"')}function ND(n,e){return!YTe(n)&&!Array.isArray(n)?!1:vt(QTe,e)?!0:!(e in Object.prototype||e in Function.prototype)}function KTe(n,e){if(!j4(n,e))throw new Error('No access to method "'+e+'"');return n[e]}function j4(n,e){return n==null||typeof n[e]!="function"||vt(n,e)&&Object.getPrototypeOf&&e in Object.getPrototypeOf(n)?!1:vt(ZTe,e)?!0:!(e in Object.prototype||e in Function.prototype)}function YTe(n){return typeof n=="object"&&n&&n.constructor===Object}var QTe={length:!0,name:!0},ZTe={toString:!0,valueOf:!0,toLocaleString:!0};class MN{constructor(e){this.wrappedObject=e,this[Symbol.iterator]=this.entries}keys(){return Object.keys(this.wrappedObject).filter(e=>this.has(e)).values()}get(e){return Ea(this.wrappedObject,e)}set(e,t){return bb(this.wrappedObject,e,t),this}has(e){return ND(this.wrappedObject,e)&&e in this.wrappedObject}entries(){return ite(this.keys(),e=>[e,this.get(e)])}forEach(e){for(var t of this.keys())e(this.get(t),t,this)}delete(e){ND(this.wrappedObject,e)&&delete this.wrappedObject[e]}clear(){for(var e of this.keys())this.delete(e)}get size(){return Object.keys(this.wrappedObject).length}}class rte{constructor(e,t,r){this.a=e,this.b=t,this.bKeys=r,this[Symbol.iterator]=this.entries}get(e){return this.bKeys.has(e)?this.b.get(e):this.a.get(e)}set(e,t){return this.bKeys.has(e)?this.b.set(e,t):this.a.set(e,t),this}has(e){return this.b.has(e)||this.a.has(e)}keys(){return new Set([...this.a.keys(),...this.b.keys()])[Symbol.iterator]()}entries(){return ite(this.keys(),e=>[e,this.get(e)])}forEach(e){for(var t of this.keys())e(this.get(t),t,this)}delete(e){return this.bKeys.has(e)?this.b.delete(e):this.a.delete(e)}clear(){this.a.clear(),this.b.clear()}get size(){return[...this.keys()].length}}function ite(n,e){return{next:()=>{var t=n.next();return t.done?t:{value:e(t.value),done:!1}}}}function Dw(){return new Map}function Ty(n){if(!n)return Dw();if(ote(n))return n;if(DN(n))return new MN(n);throw new Error("createMap can create maps from objects or Maps")}function JTe(n){if(n instanceof MN)return n.wrappedObject;var e={};for(var t of n.keys()){var r=n.get(t);bb(e,t,r)}return e}function Tt(n){return typeof n=="number"}function jt(n){return!n||typeof n!="object"||typeof n.constructor!="function"?!1:n.isBigNumber===!0&&typeof n.constructor.prototype=="object"&&n.constructor.prototype.isBigNumber===!0||typeof n.constructor.isDecimal=="function"&&n.constructor.isDecimal(n)===!0}function L1(n){return typeof n=="bigint"}function Qh(n){return n&&typeof n=="object"&&Object.getPrototypeOf(n).isComplex===!0||!1}function iA(n){return n&&typeof n=="object"&&Object.getPrototypeOf(n).isFraction===!0||!1}function Ro(n){return n&&n.constructor.prototype.isUnit===!0||!1}function Qr(n){return typeof n=="string"}var Wn=Array.isArray;function Dt(n){return n&&n.constructor.prototype.isMatrix===!0||!1}function zo(n){return Array.isArray(n)||Dt(n)}function RD(n){return n&&n.isDenseMatrix&&n.constructor.prototype.isMatrix===!0||!1}function jm(n){return n&&n.isSparseMatrix&&n.constructor.prototype.isMatrix===!0||!1}function q4(n){return n&&n.constructor.prototype.isRange===!0||!1}function CN(n){return n&&n.constructor.prototype.isIndex===!0||!1}function eMe(n){return typeof n=="boolean"}function tMe(n){return n&&n.constructor.prototype.isResultSet===!0||!1}function ste(n){return n&&n.constructor.prototype.isHelp===!0||!1}function ate(n){return typeof n=="function"}function nMe(n){return n instanceof Date}function rMe(n){return n instanceof RegExp}function DN(n){return!!(n&&typeof n=="object"&&n.constructor===Object&&!Qh(n)&&!iA(n))}function ote(n){return n?n instanceof Map||n instanceof MN||typeof n.set=="function"&&typeof n.get=="function"&&typeof n.keys=="function"&&typeof n.has=="function":!1}function iMe(n){return n===null}function sMe(n){return n===void 0}function gd(n){return n&&n.isAccessorNode===!0&&n.constructor.prototype.isNode===!0||!1}function fl(n){return n&&n.isArrayNode===!0&&n.constructor.prototype.isNode===!0||!1}function aMe(n){return n&&n.isAssignmentNode===!0&&n.constructor.prototype.isNode===!0||!1}function oMe(n){return n&&n.isBlockNode===!0&&n.constructor.prototype.isNode===!0||!1}function lMe(n){return n&&n.isConditionalNode===!0&&n.constructor.prototype.isNode===!0||!1}function pn(n){return n&&n.isConstantNode===!0&&n.constructor.prototype.isNode===!0||!1}function vO(n){return pn(n)||ii(n)&&n.args.length===1&&pn(n.args[0])&&"-+~".includes(n.op)}function sA(n){return n&&n.isFunctionAssignmentNode===!0&&n.constructor.prototype.isNode===!0||!1}function Fp(n){return n&&n.isFunctionNode===!0&&n.constructor.prototype.isNode===!0||!1}function qb(n){return n&&n.isIndexNode===!0&&n.constructor.prototype.isNode===!0||!1}function zn(n){return n&&n.isNode===!0&&n.constructor.prototype.isNode===!0||!1}function NN(n){return n&&n.isObjectNode===!0&&n.constructor.prototype.isNode===!0||!1}function ii(n){return n&&n.isOperatorNode===!0&&n.constructor.prototype.isNode===!0||!1}function vd(n){return n&&n.isParenthesisNode===!0&&n.constructor.prototype.isNode===!0||!1}function uMe(n){return n&&n.isRangeNode===!0&&n.constructor.prototype.isNode===!0||!1}function cMe(n){return n&&n.isRelationalNode===!0&&n.constructor.prototype.isNode===!0||!1}function is(n){return n&&n.isSymbolNode===!0&&n.constructor.prototype.isNode===!0||!1}function lte(n){return n&&n.constructor.prototype.isChain===!0||!1}function Kn(n){var e=typeof n;return e==="object"?n===null?"null":jt(n)?"BigNumber":n.constructor&&n.constructor.name?n.constructor.name:"Object":e}function Ut(n){var e=typeof n;if(e==="number"||e==="bigint"||e==="string"||e==="boolean"||n===null||n===void 0)return n;if(typeof n.clone=="function")return n.clone();if(Array.isArray(n))return n.map(function(t){return Ut(t)});if(n instanceof Date)return new Date(n.valueOf());if(jt(n))return n;if(DN(n))return hMe(n,Ut);if(e==="function")return n;throw new TypeError("Cannot clone: unknown type of value (value: ".concat(n,")"))}function hMe(n,e){var t={};for(var r in n)vt(n,r)&&(t[r]=e(n[r]));return t}function ute(n,e){for(var t in e)vt(e,t)&&(n[t]=e[t]);return n}function yd(n,e){var t,r,i;if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(r=0,i=n.length;r<i;r++)if(!yd(n[r],e[r]))return!1;return!0}else{if(typeof n=="function")return n===e;if(n instanceof Object){if(Array.isArray(e)||!(e instanceof Object))return!1;for(t in n)if(!(t in e)||!yd(n[t],e[t]))return!1;for(t in e)if(!(t in n))return!1;return!0}else return n===e}}function dMe(n,e,t){var r=!0,i;Object.defineProperty(n,e,{get:function(){return r&&(i=t(),r=!1),i},set:function(a){i=a,r=!1},configurable:!0,enumerable:!0})}function vt(n,e){return n&&Object.hasOwnProperty.call(n,e)}function fMe(n,e){for(var t={},r=0;r<e.length;r++){var i=e[r],s=n[i];s!==void 0&&(t[i]=s)}return t}var pMe=["Matrix","Array"],mMe=["number","BigNumber","bigint","Fraction"],Ve=function(e){if(e)throw new Error(`The global config is readonly. 
Please create a mathjs instance if you want to change the default configuration. 
Example:

  import { create, all } from 'mathjs';
  const mathjs = create(all);
  mathjs.config({ number: 'BigNumber' });
`);return Object.freeze(nte)};ai(Ve,nte,{MATRIX_OPTIONS:pMe,NUMBER_OPTIONS:mMe});function K9(){return!0}function Yo(){return!1}function b0(){}const Y9="Argument is not a typed-function.";function cte(){function n(L){return typeof L=="object"&&L!==null&&L.constructor===Object}const e=[{name:"number",test:function(L){return typeof L=="number"}},{name:"string",test:function(L){return typeof L=="string"}},{name:"boolean",test:function(L){return typeof L=="boolean"}},{name:"Function",test:function(L){return typeof L=="function"}},{name:"Array",test:Array.isArray},{name:"Date",test:function(L){return L instanceof Date}},{name:"RegExp",test:function(L){return L instanceof RegExp}},{name:"Object",test:n},{name:"null",test:function(L){return L===null}},{name:"undefined",test:function(L){return L===void 0}}],t={name:"any",test:K9,isAny:!0};let r,i,s=0,a={createCount:0};function o(L){const P=r.get(L);if(P)return P;let K='Unknown type "'+L+'"';const ae=L.toLowerCase();let pe;for(pe of i)if(pe.toLowerCase()===ae){K+='. Did you mean "'+pe+'" ?';break}throw new TypeError(K)}function l(L){let P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"any";const K=P?o(P).index:i.length,ae=[];for(let ce=0;ce<L.length;++ce){if(!L[ce]||typeof L[ce].name!="string"||typeof L[ce].test!="function")throw new TypeError("Object with properties {name: string, test: function} expected");const Ae=L[ce].name;if(r.has(Ae))throw new TypeError('Duplicate type name "'+Ae+'"');ae.push(Ae),r.set(Ae,{name:Ae,test:L[ce].test,isAny:L[ce].isAny,index:K+ce,conversionsTo:[]})}const pe=i.slice(K);i=i.slice(0,K).concat(ae).concat(pe);for(let ce=K+ae.length;ce<i.length;++ce)r.get(i[ce]).index=ce}function u(){r=new Map,i=[],s=0,l([t],!1)}u(),l(e);function c(){let L;for(L of i)r.get(L).conversionsTo=[];s=0}function h(L){const P=i.filter(K=>{const ae=r.get(K);return!ae.isAny&&ae.test(L)});return P.length?P:["any"]}function d(L){return L&&typeof L=="function"&&"_typedFunctionData"in L}function f(L,P,K){if(!d(L))throw new TypeError(Y9);const ae=K&&K.exact,pe=Array.isArray(P)?P.join(","):P,ce=w(pe),Ae=y(ce);if(!ae||Ae in L.signatures){const Ne=L._typedFunctionData.signatureMap.get(Ae);if(Ne)return Ne}const we=ce.length;let Pe;if(ae){Pe=[];let Ne;for(Ne in L.signatures)Pe.push(L._typedFunctionData.signatureMap.get(Ne))}else Pe=L._typedFunctionData.signatures;for(let Ne=0;Ne<we;++Ne){const $e=ce[Ne],Ye=[];let Ge;for(Ge of Pe){const qe=T(Ge.params,Ne);if(!(!qe||$e.restParam&&!qe.restParam)){if(!qe.hasAny){const V=x(qe);if($e.types.some(W=>!V.has(W.name)))continue}Ye.push(Ge)}}if(Pe=Ye,Pe.length===0)break}let Te;for(Te of Pe)if(Te.params.length<=we)return Te;throw new TypeError("Signature not found (signature: "+(L.name||"unnamed")+"("+y(ce,", ")+"))")}function p(L,P,K){return f(L,P,K).implementation}function m(L,P){const K=o(P);if(K.test(L))return L;const ae=K.conversionsTo;if(ae.length===0)throw new Error("There are no conversions to "+P+" defined.");for(let pe=0;pe<ae.length;pe++)if(o(ae[pe].from).test(L))return ae[pe].convert(L);throw new Error("Cannot convert "+L+" to "+P)}function y(L){let P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:",";return L.map(K=>K.name).join(P)}function v(L){const P=L.indexOf("...")===0,ae=(P?L.length>3?L.slice(3):"any":L).split("|").map(we=>o(we.trim()));let pe=!1,ce=P?"...":"";return{types:ae.map(function(we){return pe=we.isAny||pe,ce+=we.name+"|",{name:we.name,typeIndex:we.index,test:we.test,isAny:we.isAny,conversion:null,conversionIndex:-1}}),name:ce.slice(0,-1),hasAny:pe,hasConversion:!1,restParam:P}}function b(L){const P=L.types.map(Ae=>Ae.name),K=F(P);let ae=L.hasAny,pe=L.name;const ce=K.map(function(Ae){const we=o(Ae.from);return ae=we.isAny||ae,pe+="|"+Ae.from,{name:Ae.from,typeIndex:we.index,test:we.test,isAny:we.isAny,conversion:Ae,conversionIndex:Ae.index}});return{types:L.types.concat(ce),name:pe,hasAny:ae,hasConversion:ce.length>0,restParam:L.restParam}}function x(L){return L.typeSet||(L.typeSet=new Set,L.types.forEach(P=>L.typeSet.add(P.name))),L.typeSet}function w(L){const P=[];if(typeof L!="string")throw new TypeError("Signatures must be strings");const K=L.trim();if(K==="")return P;const ae=K.split(",");for(let pe=0;pe<ae.length;++pe){const ce=v(ae[pe].trim());if(ce.restParam&&pe!==ae.length-1)throw new SyntaxError('Unexpected rest parameter "'+ae[pe]+'": only allowed for the last parameter');if(ce.types.length===0)return null;P.push(ce)}return P}function _(L){const P=Y(L);return P?P.restParam:!1}function E(L){if(!L||L.types.length===0)return K9;if(L.types.length===1)return o(L.types[0].name).test;if(L.types.length===2){const P=o(L.types[0].name).test,K=o(L.types[1].name).test;return function(pe){return P(pe)||K(pe)}}else{const P=L.types.map(function(K){return o(K.name).test});return function(ae){for(let pe=0;pe<P.length;pe++)if(P[pe](ae))return!0;return!1}}}function A(L){let P,K,ae;if(_(L)){P=te(L).map(E);const pe=P.length,ce=E(Y(L)),Ae=function(we){for(let Pe=pe;Pe<we.length;Pe++)if(!ce(we[Pe]))return!1;return!0};return function(Pe){for(let Te=0;Te<P.length;Te++)if(!P[Te](Pe[Te]))return!1;return Ae(Pe)&&Pe.length>=pe+1}}else return L.length===0?function(ce){return ce.length===0}:L.length===1?(K=E(L[0]),function(ce){return K(ce[0])&&ce.length===1}):L.length===2?(K=E(L[0]),ae=E(L[1]),function(ce){return K(ce[0])&&ae(ce[1])&&ce.length===2}):(P=L.map(E),function(ce){for(let Ae=0;Ae<P.length;Ae++)if(!P[Ae](ce[Ae]))return!1;return ce.length===P.length})}function T(L,P){return P<L.length?L[P]:_(L)?Y(L):null}function S(L,P){const K=T(L,P);return K?x(K):new Set}function M(L){return L.conversion===null||L.conversion===void 0}function D(L,P){const K=new Set;return L.forEach(ae=>{const pe=S(ae.params,P);let ce;for(ce of pe)K.add(ce)}),K.has("any")?["any"]:Array.from(K)}function N(L,P,K){let ae,pe;const ce=L||"unnamed";let Ae=K,we;for(we=0;we<P.length;we++){const $e=[];if(Ae.forEach(Ye=>{const Ge=T(Ye.params,we),qe=E(Ge);(we<Ye.params.length||_(Ye.params))&&qe(P[we])&&$e.push(Ye)}),$e.length===0){if(pe=D(Ae,we),pe.length>0){const Ye=h(P[we]);return ae=new TypeError("Unexpected type of argument in function "+ce+" (expected: "+pe.join(" or ")+", actual: "+Ye.join(" | ")+", index: "+we+")"),ae.data={category:"wrongType",fn:ce,index:we,actual:Ye,expected:pe},ae}}else Ae=$e}const Pe=Ae.map(function($e){return _($e.params)?1/0:$e.params.length});if(P.length<Math.min.apply(null,Pe))return pe=D(Ae,we),ae=new TypeError("Too few arguments in function "+ce+" (expected: "+pe.join(" or ")+", index: "+P.length+")"),ae.data={category:"tooFewArgs",fn:ce,index:P.length,expected:pe},ae;const Te=Math.max.apply(null,Pe);if(P.length>Te)return ae=new TypeError("Too many arguments in function "+ce+" (expected: "+Te+", actual: "+P.length+")"),ae.data={category:"tooManyArgs",fn:ce,index:P.length,expectedLength:Te},ae;const Ne=[];for(let $e=0;$e<P.length;++$e)Ne.push(h(P[$e]).join("|"));return ae=new TypeError('Arguments of type "'+Ne.join(", ")+'" do not match any of the defined signatures of function '+ce+"."),ae.data={category:"mismatch",actual:Ne},ae}function R(L){let P=i.length+1;for(let K=0;K<L.types.length;K++)P=Math.min(P,L.types[K].typeIndex);return P}function z(L){let P=s+1;for(let K=0;K<L.types.length;K++)M(L.types[K])||(P=Math.min(P,L.types[K].conversionIndex));return P}function j(L,P){if(L.hasAny){if(!P.hasAny)return .1}else if(P.hasAny)return-.1;if(L.restParam){if(!P.restParam)return .01}else if(P.restParam)return-.01;const K=R(L)-R(P);if(K<0)return-.001;if(K>0)return .001;const ae=z(L),pe=z(P);if(L.hasConversion){if(!P.hasConversion)return(1+ae)*1e-6}else if(P.hasConversion)return-(1+pe)*1e-6;const ce=ae-pe;return ce<0?-1e-7:ce>0?1e-7:0}function I(L,P){const K=L.params,ae=P.params,pe=Y(K),ce=Y(ae),Ae=_(K),we=_(ae);if(Ae&&pe.hasAny){if(!we||!ce.hasAny)return 1e7}else if(we&&ce.hasAny)return-1e7;let Pe=0,Te=0,Ne;for(Ne of K)Ne.hasAny&&++Pe,Ne.hasConversion&&++Te;let $e=0,Ye=0;for(Ne of ae)Ne.hasAny&&++$e,Ne.hasConversion&&++Ye;if(Pe!==$e)return(Pe-$e)*1e6;if(Ae&&pe.hasConversion){if(!we||!ce.hasConversion)return 1e5}else if(we&&ce.hasConversion)return-1e5;if(Te!==Ye)return(Te-Ye)*1e4;if(Ae){if(!we)return 1e3}else if(we)return-1e3;const Ge=(K.length-ae.length)*(Ae?-100:100);if(Ge!==0)return Ge;const qe=[];let V=0;for(let Fe=0;Fe<K.length;++Fe){const Le=j(K[Fe],ae[Fe]);qe.push(Le),V+=Le}if(V!==0)return(V<0?-10:10)+V;let W,ye=9;const Ee=ye/(qe.length+1);for(W of qe){if(W!==0)return(W<0?-ye:ye)+W;ye-=Ee}return 0}function F(L){if(L.length===0)return[];const P=L.map(o);if(L.length===1)return P[0].conversionsTo;const K=new Set(L),ae=new Set;for(let ce=0;ce<P.length;++ce)for(const Ae of P[ce].conversionsTo)K.has(Ae.from)||ae.add(Ae.from);const pe=[];for(const ce of ae){let Ae=s+1,we=null;for(let Pe=0;Pe<P.length;++Pe)for(const Te of P[Pe].conversionsTo)Te.from===ce&&Te.index<Ae&&(Ae=Te.index,we=Te);pe.push(we)}return pe}function $(L,P){let K=P,ae="";if(L.some(ce=>ce.hasConversion)){const ce=_(L),Ae=L.map(H);ae=Ae.map(we=>we.name).join(";"),K=function(){const Pe=[],Te=ce?arguments.length-1:arguments.length;for(let Ne=0;Ne<Te;Ne++)Pe[Ne]=Ae[Ne](arguments[Ne]);return ce&&(Pe[Te]=arguments[Te].map(Ae[Te])),P.apply(this,Pe)}}let pe=K;if(_(L)){const ce=L.length-1;pe=function(){return K.apply(this,oe(arguments,0,ce).concat([oe(arguments,ce)]))}}return ae&&Object.defineProperty(pe,"name",{value:ae}),pe}function H(L){let P,K,ae,pe;const ce=[],Ae=[];let we="";L.types.forEach(function(Te){Te.conversion&&(we+=Te.conversion.from+"~>"+Te.conversion.to+",",ce.push(o(Te.conversion.from).test),Ae.push(Te.conversion.convert))}),we?we=we.slice(0,-1):we="pass";let Pe=Te=>Te;switch(Ae.length){case 0:break;case 1:P=ce[0],ae=Ae[0],Pe=function(Ne){return P(Ne)?ae(Ne):Ne};break;case 2:P=ce[0],K=ce[1],ae=Ae[0],pe=Ae[1],Pe=function(Ne){return P(Ne)?ae(Ne):K(Ne)?pe(Ne):Ne};break;default:Pe=function(Ne){for(let $e=0;$e<Ae.length;$e++)if(ce[$e](Ne))return Ae[$e](Ne);return Ne}}return Object.defineProperty(Pe,"name",{value:we}),Pe}function Z(L){function P(K,ae,pe){if(ae<K.length){const ce=K[ae];let Ae=[];if(ce.restParam){const we=ce.types.filter(M);we.length<ce.types.length&&Ae.push({types:we,name:"..."+we.map(Pe=>Pe.name).join("|"),hasAny:we.some(Pe=>Pe.isAny),hasConversion:!1,restParam:!0}),Ae.push(ce)}else Ae=ce.types.map(function(we){return{types:[we],name:we.name,hasAny:we.isAny,hasConversion:we.conversion,restParam:!1}});return me(Ae,function(we){return P(K,ae+1,pe.concat([we]))})}else return[pe]}return P(L,0,[])}function J(L,P){const K=Math.max(L.length,P.length);for(let we=0;we<K;we++){const Pe=S(L,we),Te=S(P,we);let Ne=!1,$e;for($e of Te)if(Pe.has($e)){Ne=!0;break}if(!Ne)return!1}const ae=L.length,pe=P.length,ce=_(L),Ae=_(P);return ce?Ae?ae===pe:pe>=ae:Ae?ae>=pe:ae===pe}function ee(L){return L.map(P=>tt(P)?Be(P.referToSelf.callback):ze(P)?_e(P.referTo.references,P.referTo.callback):P)}function O(L,P,K){const ae=[];let pe;for(pe of L){let ce=K[pe];if(typeof ce!="number")throw new TypeError('No definition for referenced signature "'+pe+'"');if(ce=P[ce],typeof ce!="function")return!1;ae.push(ce)}return ae}function ue(L,P,K){const ae=ee(L),pe=new Array(ae.length).fill(!1);let ce=!0;for(;ce;){ce=!1;let Ae=!0;for(let we=0;we<ae.length;++we){if(pe[we])continue;const Pe=ae[we];if(tt(Pe))ae[we]=Pe.referToSelf.callback(K),ae[we].referToSelf=Pe.referToSelf,pe[we]=!0,Ae=!1;else if(ze(Pe)){const Te=O(Pe.referTo.references,ae,P);Te?(ae[we]=Pe.referTo.callback.apply(this,Te),ae[we].referTo=Pe.referTo,pe[we]=!0,Ae=!1):ce=!0}}if(Ae&&ce)throw new SyntaxError("Circular reference detected in resolving typed.referTo")}return ae}function Q(L){const P=/\bthis(\(|\.signatures\b)/;Object.keys(L).forEach(K=>{const ae=L[K];if(P.test(ae.toString()))throw new SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")})}function re(L,P){if(a.createCount++,Object.keys(P).length===0)throw new SyntaxError("No signatures provided");a.warnAgainstDeprecatedThis&&Q(P);const K=[],ae=[],pe={},ce=[];let Ae;for(Ae in P){if(!Object.prototype.hasOwnProperty.call(P,Ae))continue;const bn=w(Ae);if(!bn)continue;K.forEach(function(Re){if(J(Re,bn))throw new TypeError('Conflicting signatures "'+y(Re)+'" and "'+y(bn)+'".')}),K.push(bn);const ne=ae.length;ae.push(P[Ae]);const Se=bn.map(b);let Ie;for(Ie of Z(Se)){const Re=y(Ie);ce.push({params:Ie,name:Re,fn:ne}),Ie.every(Me=>!Me.hasConversion)&&(pe[Re]=ne)}}ce.sort(I);const we=ue(ae,pe,oa);let Pe;for(Pe in pe)Object.prototype.hasOwnProperty.call(pe,Pe)&&(pe[Pe]=we[pe[Pe]]);const Te=[],Ne=new Map;for(Pe of ce)Ne.has(Pe.name)||(Pe.fn=we[Pe.fn],Te.push(Pe),Ne.set(Pe.name,Pe));const $e=Te[0]&&Te[0].params.length<=2&&!_(Te[0].params),Ye=Te[1]&&Te[1].params.length<=2&&!_(Te[1].params),Ge=Te[2]&&Te[2].params.length<=2&&!_(Te[2].params),qe=Te[3]&&Te[3].params.length<=2&&!_(Te[3].params),V=Te[4]&&Te[4].params.length<=2&&!_(Te[4].params),W=Te[5]&&Te[5].params.length<=2&&!_(Te[5].params),ye=$e&&Ye&&Ge&&qe&&V&&W;for(let bn=0;bn<Te.length;++bn)Te[bn].test=A(Te[bn].params);const Ee=$e?E(Te[0].params[0]):Yo,Fe=Ye?E(Te[1].params[0]):Yo,Le=Ge?E(Te[2].params[0]):Yo,Ue=qe?E(Te[3].params[0]):Yo,nt=V?E(Te[4].params[0]):Yo,Pt=W?E(Te[5].params[0]):Yo,Vn=$e?E(Te[0].params[1]):Yo,dn=Ye?E(Te[1].params[1]):Yo,Ia=Ge?E(Te[2].params[1]):Yo,io=qe?E(Te[3].params[1]):Yo,Sd=V?E(Te[4].params[1]):Yo,am=W?E(Te[5].params[1]):Yo;for(let bn=0;bn<Te.length;++bn)Te[bn].implementation=$(Te[bn].params,Te[bn].fn);const Ad=$e?Te[0].implementation:b0,om=Ye?Te[1].implementation:b0,Su=Ge?Te[2].implementation:b0,Zv=qe?Te[3].implementation:b0,$i=V?Te[4].implementation:b0,Td=W?Te[5].implementation:b0,lm=$e?Te[0].params.length:-1,Md=Ye?Te[1].params.length:-1,Au=Ge?Te[2].params.length:-1,um=qe?Te[3].params.length:-1,Cd=V?Te[4].params.length:-1,cm=W?Te[5].params.length:-1,Jv=ye?6:0,Dd=Te.length,e0=Te.map(bn=>bn.test),hm=Te.map(bn=>bn.implementation),Bc=function(){for(let ne=Jv;ne<Dd;ne++)if(e0[ne](arguments))return hm[ne].apply(this,arguments);return a.onMismatch(L,arguments,Te)};function oa(bn,ne){return arguments.length===lm&&Ee(bn)&&Vn(ne)?Ad.apply(this,arguments):arguments.length===Md&&Fe(bn)&&dn(ne)?om.apply(this,arguments):arguments.length===Au&&Le(bn)&&Ia(ne)?Su.apply(this,arguments):arguments.length===um&&Ue(bn)&&io(ne)?Zv.apply(this,arguments):arguments.length===Cd&&nt(bn)&&Sd(ne)?$i.apply(this,arguments):arguments.length===cm&&Pt(bn)&&am(ne)?Td.apply(this,arguments):Bc.apply(this,arguments)}try{Object.defineProperty(oa,"name",{value:L})}catch{}return oa.signatures=pe,oa._typedFunctionData={signatures:Te,signatureMap:Ne},oa}function le(L,P,K){throw N(L,P,K)}function te(L){return oe(L,0,L.length-1)}function Y(L){return L[L.length-1]}function oe(L,P,K){return Array.prototype.slice.call(L,P,K)}function ve(L,P){for(let K=0;K<L.length;K++)if(P(L[K]))return L[K]}function me(L,P){return Array.prototype.concat.apply([],L.map(P))}function be(){const L=te(arguments).map(K=>y(w(K))),P=Y(arguments);if(typeof P!="function")throw new TypeError("Callback function expected as last argument");return _e(L,P)}function _e(L,P){return{referTo:{references:L,callback:P}}}function Be(L){if(typeof L!="function")throw new TypeError("Callback function expected as first argument");return{referToSelf:{callback:L}}}function ze(L){return L&&typeof L.referTo=="object"&&Array.isArray(L.referTo.references)&&typeof L.referTo.callback=="function"}function tt(L){return L&&typeof L.referToSelf=="object"&&typeof L.referToSelf.callback=="function"}function de(L,P){if(!L)return P;if(P&&P!==L){const K=new Error("Function names do not match (expected: "+L+", actual: "+P+")");throw K.data={actual:P,expected:L},K}return L}function Xe(L){let P;for(const K in L)Object.prototype.hasOwnProperty.call(L,K)&&(d(L[K])||typeof L[K].signature=="string")&&(P=de(P,L[K].name));return P}function Ke(L,P){let K;for(K in P)if(Object.prototype.hasOwnProperty.call(P,K)){if(K in L&&P[K]!==L[K]){const ae=new Error('Signature "'+K+'" is defined twice');throw ae.data={signature:K,sourceFunction:P[K],destFunction:L[K]},ae}L[K]=P[K]}}const se=a;a=function(L){const P=typeof L=="string",K=P?1:0;let ae=P?L:"";const pe={};for(let ce=K;ce<arguments.length;++ce){const Ae=arguments[ce];let we={},Pe;if(typeof Ae=="function"?(Pe=Ae.name,typeof Ae.signature=="string"?we[Ae.signature]=Ae:d(Ae)&&(we=Ae.signatures)):n(Ae)&&(we=Ae,P||(Pe=Xe(Ae))),Object.keys(we).length===0){const Te=new TypeError("Argument to 'typed' at index "+ce+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw Te.data={index:ce,argument:Ae},Te}P||(ae=de(ae,Pe)),Ke(pe,we)}return re(ae||"",pe)},a.create=cte,a.createCount=se.createCount,a.onMismatch=le,a.throwMismatchError=le,a.createError=N,a.clear=u,a.clearConversions=c,a.addTypes=l,a._findType=o,a.referTo=be,a.referToSelf=Be,a.convert=m,a.findSignature=f,a.find=p,a.isTypedFunction=d,a.warnAgainstDeprecatedThis=!0,a.addType=function(L,P){let K="any";P!==!1&&r.has("Object")&&(K="Object"),a.addTypes([L],K)};function fe(L){if(!L||typeof L.from!="string"||typeof L.to!="string"||typeof L.convert!="function")throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");if(L.to===L.from)throw new SyntaxError('Illegal to define conversion from "'+L.from+'" to itself.')}return a.addConversion=function(L){let P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{override:!1};fe(L);const K=o(L.to),ae=K.conversionsTo.find(pe=>pe.from===L.from);if(ae)if(P&&P.override)a.removeConversion({from:ae.from,to:L.to,convert:ae.convert});else throw new Error('There is already a conversion from "'+L.from+'" to "'+K.name+'"');K.conversionsTo.push({from:L.from,to:K.name,convert:L.convert,index:s++})},a.addConversions=function(L,P){L.forEach(K=>a.addConversion(K,P))},a.removeConversion=function(L){fe(L);const P=o(L.to),K=ve(P.conversionsTo,pe=>pe.from===L.from);if(!K)throw new Error("Attempt to remove nonexistent conversion from "+L.from+" to "+L.to);if(K.convert!==L.convert)throw new Error("Conversion to remove does not match existing conversion");const ae=P.conversionsTo.indexOf(K);P.conversionsTo.splice(ae,1)},a.resolve=function(L,P){if(!d(L))throw new TypeError(Y9);const K=L._typedFunctionData.signatures;for(let ae=0;ae<K.length;++ae)if(K[ae].test(P))return K[ae];return null},a}const ID=cte();function ie(n,e,t,r){function i(s){var a=fMe(s,e.map(yMe));return gMe(n,e,s),t(a)}return i.isFactory=!0,i.fn=n,i.dependencies=e.slice().sort(),r&&(i.meta=r),i}function gMe(n,e,t){var r=e.filter(s=>!vMe(s)).every(s=>t[s]!==void 0);if(!r){var i=e.filter(s=>t[s]===void 0);throw new Error('Cannot create function "'.concat(n,'", ')+"some dependencies are missing: ".concat(i.map(s=>'"'.concat(s,'"')).join(", "),"."))}}function vMe(n){return n&&n[0]==="?"}function yMe(n){return n&&n[0]==="?"?n.slice(1):n}function bt(n){return typeof n=="boolean"?!0:Number.isFinite(n)?n===Math.round(n):!1}function Kp(n,e){if(e.number==="bigint")try{BigInt(n)}catch{return e.numberFallback}return e.number}var np=Math.sign||function(n){return n>0?1:n<0?-1:0},xMe=Math.log2||function(e){return Math.log(e)/Math.LN2},bMe=Math.log10||function(e){return Math.log(e)/Math.LN10},_Me=Math.log1p||function(n){return Math.log(n+1)},wMe=Math.cbrt||function(e){if(e===0)return e;var t=e<0,r;return t&&(e=-e),Number.isFinite(e)?(r=Math.exp(Math.log(e)/3),r=(e/(r*r)+2*r)/3):r=e,t?-r:r},EMe=Math.expm1||function(e){return e>=2e-4||e<=-2e-4?Math.exp(e)-1:e+e*e/2+e*e*e/6};function qI(n,e,t){var r={2:"0b",8:"0o",16:"0x"},i=r[e],s="";if(t){if(t<1)throw new Error("size must be in greater than 0");if(!bt(t))throw new Error("size must be an integer");if(n>2**(t-1)-1||n<-(2**(t-1)))throw new Error("Value must be in range [-2^".concat(t-1,", 2^").concat(t-1,"-1]"));if(!bt(n))throw new Error("Value must be an integer");n<0&&(n=n+2**t),s="i".concat(t)}var a="";return n<0&&(n=-n,a="-"),"".concat(a).concat(i).concat(n.toString(e)).concat(s)}function pv(n,e){if(typeof e=="function")return e(n);if(n===1/0)return"Infinity";if(n===-1/0)return"-Infinity";if(isNaN(n))return"NaN";var{notation:t,precision:r,wordSize:i}=hte(e);switch(t){case"fixed":return dte(n,r);case"exponential":return fte(n,r);case"engineering":return SMe(n,r);case"bin":return qI(n,2,i);case"oct":return qI(n,8,i);case"hex":return qI(n,16,i);case"auto":return AMe(n,r,e).replace(/((\.\d*?)(0+))($|e)/,function(){var s=arguments[2],a=arguments[4];return s!=="."?s+a:a});default:throw new Error('Unknown notation "'+t+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function hte(n){var e="auto",t,r;if(n!==void 0)if(Tt(n))t=n;else if(jt(n))t=n.toNumber();else if(DN(n))n.precision!==void 0&&(t=Q9(n.precision,()=>{throw new Error('Option "precision" must be a number or BigNumber')})),n.wordSize!==void 0&&(r=Q9(n.wordSize,()=>{throw new Error('Option "wordSize" must be a number or BigNumber')})),n.notation&&(e=n.notation);else throw new Error("Unsupported type of options, number, BigNumber, or object expected");return{notation:e,precision:t,wordSize:r}}function aA(n){var e=String(n).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!e)throw new SyntaxError("Invalid number "+n);var t=e[1],r=e[2],i=parseFloat(e[4]||"0"),s=r.indexOf(".");i+=s!==-1?s-1:r.length-1;var a=r.replace(".","").replace(/^0*/,function(o){return i-=o.length,""}).replace(/0*$/,"").split("").map(function(o){return parseInt(o)});return a.length===0&&(a.push(0),i++),{sign:t,coefficients:a,exponent:i}}function SMe(n,e){if(isNaN(n)||!Number.isFinite(n))return String(n);var t=aA(n),r=RN(t,e),i=r.exponent,s=r.coefficients,a=i%3===0?i:i<0?i-3-i%3:i-i%3;if(Tt(e))for(;e>s.length||i-a+1>s.length;)s.push(0);else for(var o=Math.abs(i-a)-(s.length-1),l=0;l<o;l++)s.push(0);for(var u=Math.abs(i-a),c=1;u>0;)c++,u--;var h=s.slice(c).join(""),d=Tt(e)&&h.length||h.match(/[1-9]/)?"."+h:"",f=s.slice(0,c).join("")+d+"e"+(i>=0?"+":"")+a.toString();return r.sign+f}function dte(n,e){if(isNaN(n)||!Number.isFinite(n))return String(n);var t=aA(n),r=typeof e=="number"?RN(t,t.exponent+1+e):t,i=r.coefficients,s=r.exponent+1,a=s+(e||0);return i.length<a&&(i=i.concat(My(a-i.length))),s<0&&(i=My(-s+1).concat(i),s=1),s<i.length&&i.splice(s,0,s===0?"0.":"."),r.sign+i.join("")}function fte(n,e){if(isNaN(n)||!Number.isFinite(Number(n)))return String(n);var t=aA(n),r=e?RN(t,e):t,i=r.coefficients,s=r.exponent;i.length<e&&(i=i.concat(My(e-i.length)));var a=i.shift();return r.sign+a+(i.length>0?"."+i.join(""):"")+"e"+(s>=0?"+":"")+s}function AMe(n,e,t){if(isNaN(n)||!Number.isFinite(n))return String(n);var r=Z9(t==null?void 0:t.lowerExp,-3),i=Z9(t==null?void 0:t.upperExp,5),s=aA(n),a=e?RN(s,e):s;if(a.exponent<r||a.exponent>=i)return fte(n,e);var o=a.coefficients,l=a.exponent;o.length<e&&(o=o.concat(My(e-o.length))),o=o.concat(My(l-o.length+1+(o.length<e?e-o.length:0))),o=My(-l).concat(o);var u=l>0?l:0;return u<o.length-1&&o.splice(u+1,0,"."),a.sign+o.join("")}function RN(n,e){for(var t={sign:n.sign,coefficients:n.coefficients,exponent:n.exponent},r=t.coefficients;e<=0;)r.unshift(0),t.exponent++,e++;if(r.length>e){var i=r.splice(e,r.length-e);if(i[0]>=5){var s=e-1;for(r[s]++;r[s]===10;)r.pop(),s===0&&(r.unshift(0),t.exponent++,s++),s--,r[s]++}}return t}function My(n){for(var e=[],t=0;t<n;t++)e.push(0);return e}function TMe(n){return n.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length}function as(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e-8,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(t<=0)throw new Error("Relative tolerance must be greater than 0");if(r<0)throw new Error("Absolute tolerance must be at least 0");return isNaN(n)||isNaN(e)?!1:!Number.isFinite(n)||!Number.isFinite(e)?n===e:n===e?!0:Math.abs(n-e)<=Math.max(t*Math.max(Math.abs(n),Math.abs(e)),r)}var MMe=Math.acosh||function(n){return Math.log(Math.sqrt(n*n-1)+n)},CMe=Math.asinh||function(n){return Math.log(Math.sqrt(n*n+1)+n)},DMe=Math.atanh||function(n){return Math.log((1+n)/(1-n))/2},NMe=Math.cosh||function(n){return(Math.exp(n)+Math.exp(-n))/2},RMe=Math.sinh||function(n){return(Math.exp(n)-Math.exp(-n))/2},IMe=Math.tanh||function(n){var e=Math.exp(2*n);return(e-1)/(e+1)};function PMe(n,e){var t=!0,r=e>0?!0:e<0?!1:1/e===1/0;return t^r?-n:n}function Q9(n,e){if(Tt(n))return n;if(jt(n))return n.toNumber();e()}function Z9(n,e){return Tt(n)?n:jt(n)?n.toNumber():e}var pte=function(){return pte=ID.create,ID},FMe=["?BigNumber","?Complex","?DenseMatrix","?Fraction"],LMe=ie("typed",FMe,function(e){var{BigNumber:t,Complex:r,DenseMatrix:i,Fraction:s}=e,a=pte();return a.clear(),a.addTypes([{name:"number",test:Tt},{name:"Complex",test:Qh},{name:"BigNumber",test:jt},{name:"bigint",test:L1},{name:"Fraction",test:iA},{name:"Unit",test:Ro},{name:"identifier",test:o=>Qr&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(o)},{name:"string",test:Qr},{name:"Chain",test:lte},{name:"Array",test:Wn},{name:"Matrix",test:Dt},{name:"DenseMatrix",test:RD},{name:"SparseMatrix",test:jm},{name:"Range",test:q4},{name:"Index",test:CN},{name:"boolean",test:eMe},{name:"ResultSet",test:tMe},{name:"Help",test:ste},{name:"function",test:ate},{name:"Date",test:nMe},{name:"RegExp",test:rMe},{name:"null",test:iMe},{name:"undefined",test:sMe},{name:"AccessorNode",test:gd},{name:"ArrayNode",test:fl},{name:"AssignmentNode",test:aMe},{name:"BlockNode",test:oMe},{name:"ConditionalNode",test:lMe},{name:"ConstantNode",test:pn},{name:"FunctionNode",test:Fp},{name:"FunctionAssignmentNode",test:sA},{name:"IndexNode",test:qb},{name:"Node",test:zn},{name:"ObjectNode",test:NN},{name:"OperatorNode",test:ii},{name:"ParenthesisNode",test:vd},{name:"RangeNode",test:uMe},{name:"RelationalNode",test:cMe},{name:"SymbolNode",test:is},{name:"Map",test:ote},{name:"Object",test:DN}]),a.addConversions([{from:"number",to:"BigNumber",convert:function(l){if(t||IT(l),TMe(l)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+l+"). Use function bignumber(x) to convert to BigNumber.");return new t(l)}},{from:"number",to:"Complex",convert:function(l){return r||PT(l),new r(l,0)}},{from:"BigNumber",to:"Complex",convert:function(l){return r||PT(l),new r(l.toNumber(),0)}},{from:"bigint",to:"number",convert:function(l){if(l>Number.MAX_SAFE_INTEGER)throw new TypeError("Cannot implicitly convert bigint to number: value exceeds the max safe integer value (value: "+l+")");return Number(l)}},{from:"bigint",to:"BigNumber",convert:function(l){return t||IT(l),new t(l.toString())}},{from:"bigint",to:"Fraction",convert:function(l){return s||FT(l),new s(l)}},{from:"Fraction",to:"BigNumber",convert:function(l){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(l){return r||PT(l),new r(l.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(l){s||FT(l);var u=new s(l);if(u.valueOf()!==l)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+l+"). Use function fraction(x) to convert to Fraction.");return u}},{from:"string",to:"number",convert:function(l){var u=Number(l);if(isNaN(u))throw new Error('Cannot convert "'+l+'" to a number');return u}},{from:"string",to:"BigNumber",convert:function(l){t||IT(l);try{return new t(l)}catch{throw new Error('Cannot convert "'+l+'" to BigNumber')}}},{from:"string",to:"bigint",convert:function(l){try{return BigInt(l)}catch{throw new Error('Cannot convert "'+l+'" to BigInt')}}},{from:"string",to:"Fraction",convert:function(l){s||FT(l);try{return new s(l)}catch{throw new Error('Cannot convert "'+l+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(l){r||PT(l);try{return new r(l)}catch{throw new Error('Cannot convert "'+l+'" to Complex')}}},{from:"boolean",to:"number",convert:function(l){return+l}},{from:"boolean",to:"BigNumber",convert:function(l){return t||IT(l),new t(+l)}},{from:"boolean",to:"bigint",convert:function(l){return BigInt(+l)}},{from:"boolean",to:"Fraction",convert:function(l){return s||FT(l),new s(+l)}},{from:"boolean",to:"string",convert:function(l){return String(l)}},{from:"Array",to:"Matrix",convert:function(l){return i||OMe(),new i(l)}},{from:"Matrix",to:"Array",convert:function(l){return l.valueOf()}}]),a.onMismatch=(o,l,u)=>{var c=a.createError(o,l,u);if(["wrongType","mismatch"].includes(c.data.category)&&l.length===1&&zo(l[0])&&u.some(d=>!d.params.includes(","))){var h=new TypeError("Function '".concat(o,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(o,")'."));throw h.data=c.data,h}throw c},a.onMismatch=(o,l,u)=>{var c=a.createError(o,l,u);if(["wrongType","mismatch"].includes(c.data.category)&&l.length===1&&zo(l[0])&&u.some(d=>!d.params.includes(","))){var h=new TypeError("Function '".concat(o,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(o,")'."));throw h.data=c.data,h}throw c},a});function IT(n){throw new Error("Cannot convert value ".concat(n," into a BigNumber: no class 'BigNumber' provided"))}function PT(n){throw new Error("Cannot convert value ".concat(n," into a Complex number: no class 'Complex' provided"))}function OMe(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}function FT(n){throw new Error("Cannot convert value ".concat(n," into a Fraction, no class 'Fraction' provided."))}var kMe="ResultSet",BMe=[],UMe=ie(kMe,BMe,()=>{function n(e){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this.entries=e||[]}return n.prototype.type="ResultSet",n.prototype.isResultSet=!0,n.prototype.valueOf=function(){return this.entries},n.prototype.toString=function(){return"["+this.entries.map(String).join(", ")+"]"},n.prototype.toJSON=function(){return{mathjs:"ResultSet",entries:this.entries}},n.fromJSON=function(e){return new n(e.entries)},n},{isClass:!0});/*!
 *  decimal.js v10.6.0
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var sy=9e15,Yp=1e9,yO="0123456789abcdef",PD="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",FD="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",xO={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-sy,maxE:sy,crypto:!1},mte,Hh,$t=!0,IN="[DecimalError] ",Lp=IN+"Invalid argument: ",gte=IN+"Precision limit exceeded",vte=IN+"crypto unavailable",yte="[object Decimal]",na=Math.floor,Di=Math.pow,VMe=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,zMe=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,$Me=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,xte=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,du=1e7,Nt=7,HMe=9007199254740991,GMe=PD.length-1,bO=FD.length-1,We={toStringTag:yte};We.absoluteValue=We.abs=function(){var n=new this.constructor(this);return n.s<0&&(n.s=1),Mt(n)};We.ceil=function(){return Mt(new this.constructor(this),this.e+1,2)};We.clampedTo=We.clamp=function(n,e){var t,r=this,i=r.constructor;if(n=new i(n),e=new i(e),!n.s||!e.s)return new i(NaN);if(n.gt(e))throw Error(Lp+e);return t=r.cmp(n),t<0?n:r.cmp(e)>0?e:new i(r)};We.comparedTo=We.cmp=function(n){var e,t,r,i,s=this,a=s.d,o=(n=new s.constructor(n)).d,l=s.s,u=n.s;if(!a||!o)return!l||!u?NaN:l!==u?l:a===o?0:!a^l<0?1:-1;if(!a[0]||!o[0])return a[0]?l:o[0]?-u:0;if(l!==u)return l;if(s.e!==n.e)return s.e>n.e^l<0?1:-1;for(r=a.length,i=o.length,e=0,t=r<i?r:i;e<t;++e)if(a[e]!==o[e])return a[e]>o[e]^l<0?1:-1;return r===i?0:r>i^l<0?1:-1};We.cosine=We.cos=function(){var n,e,t=this,r=t.constructor;return t.d?t.d[0]?(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+Nt,r.rounding=1,t=jMe(r,Ste(r,t)),r.precision=n,r.rounding=e,Mt(Hh==2||Hh==3?t.neg():t,n,e,!0)):new r(1):new r(NaN)};We.cubeRoot=We.cbrt=function(){var n,e,t,r,i,s,a,o,l,u,c=this,h=c.constructor;if(!c.isFinite()||c.isZero())return new h(c);for($t=!1,s=c.s*Di(c.s*c,1/3),!s||Math.abs(s)==1/0?(t=Es(c.d),n=c.e,(s=(n-t.length+1)%3)&&(t+=s==1||s==-2?"0":"00"),s=Di(t,1/3),n=na((n+1)/3)-(n%3==(n<0?-1:2)),s==1/0?t="5e"+n:(t=s.toExponential(),t=t.slice(0,t.indexOf("e")+1)+n),r=new h(t),r.s=c.s):r=new h(s.toString()),a=(n=h.precision)+3;;)if(o=r,l=o.times(o).times(o),u=l.plus(c),r=pr(u.plus(c).times(o),u.plus(l),a+2,1),Es(o.d).slice(0,a)===(t=Es(r.d)).slice(0,a))if(t=t.slice(a-3,a+1),t=="9999"||!i&&t=="4999"){if(!i&&(Mt(o,n+1,0),o.times(o).times(o).eq(c))){r=o;break}a+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(Mt(r,n+1,1),e=!r.times(r).times(r).eq(c));break}return $t=!0,Mt(r,n,h.rounding,e)};We.decimalPlaces=We.dp=function(){var n,e=this.d,t=NaN;if(e){if(n=e.length-1,t=(n-na(this.e/Nt))*Nt,n=e[n],n)for(;n%10==0;n/=10)t--;t<0&&(t=0)}return t};We.dividedBy=We.div=function(n){return pr(this,new this.constructor(n))};We.dividedToIntegerBy=We.divToInt=function(n){var e=this,t=e.constructor;return Mt(pr(e,new t(n),0,1,1),t.precision,t.rounding)};We.equals=We.eq=function(n){return this.cmp(n)===0};We.floor=function(){return Mt(new this.constructor(this),this.e+1,3)};We.greaterThan=We.gt=function(n){return this.cmp(n)>0};We.greaterThanOrEqualTo=We.gte=function(n){var e=this.cmp(n);return e==1||e===0};We.hyperbolicCosine=We.cosh=function(){var n,e,t,r,i,s=this,a=s.constructor,o=new a(1);if(!s.isFinite())return new a(s.s?1/0:NaN);if(s.isZero())return o;t=a.precision,r=a.rounding,a.precision=t+Math.max(s.e,s.sd())+4,a.rounding=1,i=s.d.length,i<32?(n=Math.ceil(i/3),e=(1/FN(4,n)).toString()):(n=16,e="2.3283064365386962890625e-10"),s=_b(a,1,s.times(e),new a(1),!0);for(var l,u=n,c=new a(8);u--;)l=s.times(s),s=o.minus(l.times(c.minus(l.times(c))));return Mt(s,a.precision=t,a.rounding=r,!0)};We.hyperbolicSine=We.sinh=function(){var n,e,t,r,i=this,s=i.constructor;if(!i.isFinite()||i.isZero())return new s(i);if(e=s.precision,t=s.rounding,s.precision=e+Math.max(i.e,i.sd())+4,s.rounding=1,r=i.d.length,r<3)i=_b(s,2,i,i,!0);else{n=1.4*Math.sqrt(r),n=n>16?16:n|0,i=i.times(1/FN(5,n)),i=_b(s,2,i,i,!0);for(var a,o=new s(5),l=new s(16),u=new s(20);n--;)a=i.times(i),i=i.times(o.plus(a.times(l.times(a).plus(u))))}return s.precision=e,s.rounding=t,Mt(i,e,t,!0)};We.hyperbolicTangent=We.tanh=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+7,r.rounding=1,pr(t.sinh(),t.cosh(),r.precision=n,r.rounding=e)):new r(t.s)};We.inverseCosine=We.acos=function(){var n=this,e=n.constructor,t=n.abs().cmp(1),r=e.precision,i=e.rounding;return t!==-1?t===0?n.isNeg()?cc(e,r,i):new e(0):new e(NaN):n.isZero()?cc(e,r+4,i).times(.5):(e.precision=r+6,e.rounding=1,n=new e(1).minus(n).div(n.plus(1)).sqrt().atan(),e.precision=r,e.rounding=i,n.times(2))};We.inverseHyperbolicCosine=We.acosh=function(){var n,e,t=this,r=t.constructor;return t.lte(1)?new r(t.eq(1)?0:NaN):t.isFinite()?(n=r.precision,e=r.rounding,r.precision=n+Math.max(Math.abs(t.e),t.sd())+4,r.rounding=1,$t=!1,t=t.times(t).minus(1).sqrt().plus(t),$t=!0,r.precision=n,r.rounding=e,t.ln()):new r(t)};We.inverseHyperbolicSine=We.asinh=function(){var n,e,t=this,r=t.constructor;return!t.isFinite()||t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+2*Math.max(Math.abs(t.e),t.sd())+6,r.rounding=1,$t=!1,t=t.times(t).plus(1).sqrt().plus(t),$t=!0,r.precision=n,r.rounding=e,t.ln())};We.inverseHyperbolicTangent=We.atanh=function(){var n,e,t,r,i=this,s=i.constructor;return i.isFinite()?i.e>=0?new s(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(n=s.precision,e=s.rounding,r=i.sd(),Math.max(r,n)<2*-i.e-1?Mt(new s(i),n,e,!0):(s.precision=t=r-i.e,i=pr(i.plus(1),new s(1).minus(i),t+n,1),s.precision=n+4,s.rounding=1,i=i.ln(),s.precision=n,s.rounding=e,i.times(.5))):new s(NaN)};We.inverseSine=We.asin=function(){var n,e,t,r,i=this,s=i.constructor;return i.isZero()?new s(i):(e=i.abs().cmp(1),t=s.precision,r=s.rounding,e!==-1?e===0?(n=cc(s,t+4,r).times(.5),n.s=i.s,n):new s(NaN):(s.precision=t+6,s.rounding=1,i=i.div(new s(1).minus(i.times(i)).sqrt().plus(1)).atan(),s.precision=t,s.rounding=r,i.times(2)))};We.inverseTangent=We.atan=function(){var n,e,t,r,i,s,a,o,l,u=this,c=u.constructor,h=c.precision,d=c.rounding;if(u.isFinite()){if(u.isZero())return new c(u);if(u.abs().eq(1)&&h+4<=bO)return a=cc(c,h+4,d).times(.25),a.s=u.s,a}else{if(!u.s)return new c(NaN);if(h+4<=bO)return a=cc(c,h+4,d).times(.5),a.s=u.s,a}for(c.precision=o=h+10,c.rounding=1,t=Math.min(28,o/Nt+2|0),n=t;n;--n)u=u.div(u.times(u).plus(1).sqrt().plus(1));for($t=!1,e=Math.ceil(o/Nt),r=1,l=u.times(u),a=new c(u),i=u;n!==-1;)if(i=i.times(l),s=a.minus(i.div(r+=2)),i=i.times(l),a=s.plus(i.div(r+=2)),a.d[e]!==void 0)for(n=e;a.d[n]===s.d[n]&&n--;);return t&&(a=a.times(2<<t-1)),$t=!0,Mt(a,c.precision=h,c.rounding=d,!0)};We.isFinite=function(){return!!this.d};We.isInteger=We.isInt=function(){return!!this.d&&na(this.e/Nt)>this.d.length-2};We.isNaN=function(){return!this.s};We.isNegative=We.isNeg=function(){return this.s<0};We.isPositive=We.isPos=function(){return this.s>0};We.isZero=function(){return!!this.d&&this.d[0]===0};We.lessThan=We.lt=function(n){return this.cmp(n)<0};We.lessThanOrEqualTo=We.lte=function(n){return this.cmp(n)<1};We.logarithm=We.log=function(n){var e,t,r,i,s,a,o,l,u=this,c=u.constructor,h=c.precision,d=c.rounding,f=5;if(n==null)n=new c(10),e=!0;else{if(n=new c(n),t=n.d,n.s<0||!t||!t[0]||n.eq(1))return new c(NaN);e=n.eq(10)}if(t=u.d,u.s<0||!t||!t[0]||u.eq(1))return new c(t&&!t[0]?-1/0:u.s!=1?NaN:t?0:1/0);if(e)if(t.length>1)s=!0;else{for(i=t[0];i%10===0;)i/=10;s=i!==1}if($t=!1,o=h+f,a=rp(u,o),r=e?LD(c,o+10):rp(n,o),l=pr(a,r,o,1),Nw(l.d,i=h,d))do if(o+=10,a=rp(u,o),r=e?LD(c,o+10):rp(n,o),l=pr(a,r,o,1),!s){+Es(l.d).slice(i+1,i+15)+1==1e14&&(l=Mt(l,h+1,0));break}while(Nw(l.d,i+=10,d));return $t=!0,Mt(l,h,d)};We.minus=We.sub=function(n){var e,t,r,i,s,a,o,l,u,c,h,d,f=this,p=f.constructor;if(n=new p(n),!f.d||!n.d)return!f.s||!n.s?n=new p(NaN):f.d?n.s=-n.s:n=new p(n.d||f.s!==n.s?f:NaN),n;if(f.s!=n.s)return n.s=-n.s,f.plus(n);if(u=f.d,d=n.d,o=p.precision,l=p.rounding,!u[0]||!d[0]){if(d[0])n.s=-n.s;else if(u[0])n=new p(f);else return new p(l===3?-0:0);return $t?Mt(n,o,l):n}if(t=na(n.e/Nt),c=na(f.e/Nt),u=u.slice(),s=c-t,s){for(h=s<0,h?(e=u,s=-s,a=d.length):(e=d,t=c,a=u.length),r=Math.max(Math.ceil(o/Nt),a)+2,s>r&&(s=r,e.length=1),e.reverse(),r=s;r--;)e.push(0);e.reverse()}else{for(r=u.length,a=d.length,h=r<a,h&&(a=r),r=0;r<a;r++)if(u[r]!=d[r]){h=u[r]<d[r];break}s=0}for(h&&(e=u,u=d,d=e,n.s=-n.s),a=u.length,r=d.length-a;r>0;--r)u[a++]=0;for(r=d.length;r>s;){if(u[--r]<d[r]){for(i=r;i&&u[--i]===0;)u[i]=du-1;--u[i],u[r]+=du}u[r]-=d[r]}for(;u[--a]===0;)u.pop();for(;u[0]===0;u.shift())--t;return u[0]?(n.d=u,n.e=PN(u,t),$t?Mt(n,o,l):n):new p(l===3?-0:0)};We.modulo=We.mod=function(n){var e,t=this,r=t.constructor;return n=new r(n),!t.d||!n.s||n.d&&!n.d[0]?new r(NaN):!n.d||t.d&&!t.d[0]?Mt(new r(t),r.precision,r.rounding):($t=!1,r.modulo==9?(e=pr(t,n.abs(),0,3,1),e.s*=n.s):e=pr(t,n,0,r.modulo,1),e=e.times(n),$t=!0,t.minus(e))};We.naturalExponential=We.exp=function(){return _O(this)};We.naturalLogarithm=We.ln=function(){return rp(this)};We.negated=We.neg=function(){var n=new this.constructor(this);return n.s=-n.s,Mt(n)};We.plus=We.add=function(n){var e,t,r,i,s,a,o,l,u,c,h=this,d=h.constructor;if(n=new d(n),!h.d||!n.d)return!h.s||!n.s?n=new d(NaN):h.d||(n=new d(n.d||h.s===n.s?h:NaN)),n;if(h.s!=n.s)return n.s=-n.s,h.minus(n);if(u=h.d,c=n.d,o=d.precision,l=d.rounding,!u[0]||!c[0])return c[0]||(n=new d(h)),$t?Mt(n,o,l):n;if(s=na(h.e/Nt),r=na(n.e/Nt),u=u.slice(),i=s-r,i){for(i<0?(t=u,i=-i,a=c.length):(t=c,r=s,a=u.length),s=Math.ceil(o/Nt),a=s>a?s+1:a+1,i>a&&(i=a,t.length=1),t.reverse();i--;)t.push(0);t.reverse()}for(a=u.length,i=c.length,a-i<0&&(i=a,t=c,c=u,u=t),e=0;i;)e=(u[--i]=u[i]+c[i]+e)/du|0,u[i]%=du;for(e&&(u.unshift(e),++r),a=u.length;u[--a]==0;)u.pop();return n.d=u,n.e=PN(u,r),$t?Mt(n,o,l):n};We.precision=We.sd=function(n){var e,t=this;if(n!==void 0&&n!==!!n&&n!==1&&n!==0)throw Error(Lp+n);return t.d?(e=bte(t.d),n&&t.e+1>e&&(e=t.e+1)):e=NaN,e};We.round=function(){var n=this,e=n.constructor;return Mt(new e(n),n.e+1,e.rounding)};We.sine=We.sin=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+Math.max(t.e,t.sd())+Nt,r.rounding=1,t=WMe(r,Ste(r,t)),r.precision=n,r.rounding=e,Mt(Hh>2?t.neg():t,n,e,!0)):new r(NaN)};We.squareRoot=We.sqrt=function(){var n,e,t,r,i,s,a=this,o=a.d,l=a.e,u=a.s,c=a.constructor;if(u!==1||!o||!o[0])return new c(!u||u<0&&(!o||o[0])?NaN:o?a:1/0);for($t=!1,u=Math.sqrt(+a),u==0||u==1/0?(e=Es(o),(e.length+l)%2==0&&(e+="0"),u=Math.sqrt(e),l=na((l+1)/2)-(l<0||l%2),u==1/0?e="5e"+l:(e=u.toExponential(),e=e.slice(0,e.indexOf("e")+1)+l),r=new c(e)):r=new c(u.toString()),t=(l=c.precision)+3;;)if(s=r,r=s.plus(pr(a,s,t+2,1)).times(.5),Es(s.d).slice(0,t)===(e=Es(r.d)).slice(0,t))if(e=e.slice(t-3,t+1),e=="9999"||!i&&e=="4999"){if(!i&&(Mt(s,l+1,0),s.times(s).eq(a))){r=s;break}t+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(Mt(r,l+1,1),n=!r.times(r).eq(a));break}return $t=!0,Mt(r,l,c.rounding,n)};We.tangent=We.tan=function(){var n,e,t=this,r=t.constructor;return t.isFinite()?t.isZero()?new r(t):(n=r.precision,e=r.rounding,r.precision=n+10,r.rounding=1,t=t.sin(),t.s=1,t=pr(t,new r(1).minus(t.times(t)).sqrt(),n+10,0),r.precision=n,r.rounding=e,Mt(Hh==2||Hh==4?t.neg():t,n,e,!0)):new r(NaN)};We.times=We.mul=function(n){var e,t,r,i,s,a,o,l,u,c=this,h=c.constructor,d=c.d,f=(n=new h(n)).d;if(n.s*=c.s,!d||!d[0]||!f||!f[0])return new h(!n.s||d&&!d[0]&&!f||f&&!f[0]&&!d?NaN:!d||!f?n.s/0:n.s*0);for(t=na(c.e/Nt)+na(n.e/Nt),l=d.length,u=f.length,l<u&&(s=d,d=f,f=s,a=l,l=u,u=a),s=[],a=l+u,r=a;r--;)s.push(0);for(r=u;--r>=0;){for(e=0,i=l+r;i>r;)o=s[i]+f[r]*d[i-r-1]+e,s[i--]=o%du|0,e=o/du|0;s[i]=(s[i]+e)%du|0}for(;!s[--a];)s.pop();return e?++t:s.shift(),n.d=s,n.e=PN(s,t),$t?Mt(n,h.precision,h.rounding):n};We.toBinary=function(n,e){return W4(this,2,n,e)};We.toDecimalPlaces=We.toDP=function(n,e){var t=this,r=t.constructor;return t=new r(t),n===void 0?t:(ro(n,0,Yp),e===void 0?e=r.rounding:ro(e,0,8),Mt(t,n+t.e+1,e))};We.toExponential=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=Dc(r,!0):(ro(n,0,Yp),e===void 0?e=i.rounding:ro(e,0,8),r=Mt(new i(r),n+1,e),t=Dc(r,!0,n+1)),r.isNeg()&&!r.isZero()?"-"+t:t};We.toFixed=function(n,e){var t,r,i=this,s=i.constructor;return n===void 0?t=Dc(i):(ro(n,0,Yp),e===void 0?e=s.rounding:ro(e,0,8),r=Mt(new s(i),n+i.e+1,e),t=Dc(r,!1,n+r.e+1)),i.isNeg()&&!i.isZero()?"-"+t:t};We.toFraction=function(n){var e,t,r,i,s,a,o,l,u,c,h,d,f=this,p=f.d,m=f.constructor;if(!p)return new m(f);if(u=t=new m(1),r=l=new m(0),e=new m(r),s=e.e=bte(p)-f.e-1,a=s%Nt,e.d[0]=Di(10,a<0?Nt+a:a),n==null)n=s>0?e:u;else{if(o=new m(n),!o.isInt()||o.lt(u))throw Error(Lp+o);n=o.gt(e)?s>0?e:u:o}for($t=!1,o=new m(Es(p)),c=m.precision,m.precision=s=p.length*Nt*2;h=pr(o,e,0,1,1),i=t.plus(h.times(r)),i.cmp(n)!=1;)t=r,r=i,i=u,u=l.plus(h.times(i)),l=i,i=e,e=o.minus(h.times(i)),o=i;return i=pr(n.minus(t),r,0,1,1),l=l.plus(i.times(u)),t=t.plus(i.times(r)),l.s=u.s=f.s,d=pr(u,r,s,1).minus(f).abs().cmp(pr(l,t,s,1).minus(f).abs())<1?[u,r]:[l,t],m.precision=c,$t=!0,d};We.toHexadecimal=We.toHex=function(n,e){return W4(this,16,n,e)};We.toNearest=function(n,e){var t=this,r=t.constructor;if(t=new r(t),n==null){if(!t.d)return t;n=new r(1),e=r.rounding}else{if(n=new r(n),e===void 0?e=r.rounding:ro(e,0,8),!t.d)return n.s?t:n;if(!n.d)return n.s&&(n.s=t.s),n}return n.d[0]?($t=!1,t=pr(t,n,0,e,1).times(n),$t=!0,Mt(t)):(n.s=t.s,t=n),t};We.toNumber=function(){return+this};We.toOctal=function(n,e){return W4(this,8,n,e)};We.toPower=We.pow=function(n){var e,t,r,i,s,a,o=this,l=o.constructor,u=+(n=new l(n));if(!o.d||!n.d||!o.d[0]||!n.d[0])return new l(Di(+o,u));if(o=new l(o),o.eq(1))return o;if(r=l.precision,s=l.rounding,n.eq(1))return Mt(o,r,s);if(e=na(n.e/Nt),e>=n.d.length-1&&(t=u<0?-u:u)<=HMe)return i=_te(l,o,t,r),n.s<0?new l(1).div(i):Mt(i,r,s);if(a=o.s,a<0){if(e<n.d.length-1)return new l(NaN);if(n.d[e]&1||(a=1),o.e==0&&o.d[0]==1&&o.d.length==1)return o.s=a,o}return t=Di(+o,u),e=t==0||!isFinite(t)?na(u*(Math.log("0."+Es(o.d))/Math.LN10+o.e+1)):new l(t+"").e,e>l.maxE+1||e<l.minE-1?new l(e>0?a/0:0):($t=!1,l.rounding=o.s=1,t=Math.min(12,(e+"").length),i=_O(n.times(rp(o,r+t)),r),i.d&&(i=Mt(i,r+5,1),Nw(i.d,r,s)&&(e=r+10,i=Mt(_O(n.times(rp(o,e+t)),e),e+5,1),+Es(i.d).slice(r+1,r+15)+1==1e14&&(i=Mt(i,r+1,0)))),i.s=a,$t=!0,l.rounding=s,Mt(i,r,s))};We.toPrecision=function(n,e){var t,r=this,i=r.constructor;return n===void 0?t=Dc(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(ro(n,1,Yp),e===void 0?e=i.rounding:ro(e,0,8),r=Mt(new i(r),n,e),t=Dc(r,n<=r.e||r.e<=i.toExpNeg,n)),r.isNeg()&&!r.isZero()?"-"+t:t};We.toSignificantDigits=We.toSD=function(n,e){var t=this,r=t.constructor;return n===void 0?(n=r.precision,e=r.rounding):(ro(n,1,Yp),e===void 0?e=r.rounding:ro(e,0,8)),Mt(new r(t),n,e)};We.toString=function(){var n=this,e=n.constructor,t=Dc(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()&&!n.isZero()?"-"+t:t};We.truncated=We.trunc=function(){return Mt(new this.constructor(this),this.e+1,1)};We.valueOf=We.toJSON=function(){var n=this,e=n.constructor,t=Dc(n,n.e<=e.toExpNeg||n.e>=e.toExpPos);return n.isNeg()?"-"+t:t};function Es(n){var e,t,r,i=n.length-1,s="",a=n[0];if(i>0){for(s+=a,e=1;e<i;e++)r=n[e]+"",t=Nt-r.length,t&&(s+=Kd(t)),s+=r;a=n[e],r=a+"",t=Nt-r.length,t&&(s+=Kd(t))}else if(a===0)return"0";for(;a%10===0;)a/=10;return s+a}function ro(n,e,t){if(n!==~~n||n<e||n>t)throw Error(Lp+n)}function Nw(n,e,t,r){var i,s,a,o;for(s=n[0];s>=10;s/=10)--e;return--e<0?(e+=Nt,i=0):(i=Math.ceil((e+1)/Nt),e%=Nt),s=Di(10,Nt-e),o=n[i]%s|0,r==null?e<3?(e==0?o=o/100|0:e==1&&(o=o/10|0),a=t<4&&o==99999||t>3&&o==49999||o==5e4||o==0):a=(t<4&&o+1==s||t>3&&o+1==s/2)&&(n[i+1]/s/100|0)==Di(10,e-2)-1||(o==s/2||o==0)&&(n[i+1]/s/100|0)==0:e<4?(e==0?o=o/1e3|0:e==1?o=o/100|0:e==2&&(o=o/10|0),a=(r||t<4)&&o==9999||!r&&t>3&&o==4999):a=((r||t<4)&&o+1==s||!r&&t>3&&o+1==s/2)&&(n[i+1]/s/1e3|0)==Di(10,e-3)-1,a}function dC(n,e,t){for(var r,i=[0],s,a=0,o=n.length;a<o;){for(s=i.length;s--;)i[s]*=e;for(i[0]+=yO.indexOf(n.charAt(a++)),r=0;r<i.length;r++)i[r]>t-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/t|0,i[r]%=t)}return i.reverse()}function jMe(n,e){var t,r,i;if(e.isZero())return e;r=e.d.length,r<32?(t=Math.ceil(r/3),i=(1/FN(4,t)).toString()):(t=16,i="2.3283064365386962890625e-10"),n.precision+=t,e=_b(n,1,e.times(i),new n(1));for(var s=t;s--;){var a=e.times(e);e=a.times(a).minus(a).times(8).plus(1)}return n.precision-=t,e}var pr=function(){function n(r,i,s){var a,o=0,l=r.length;for(r=r.slice();l--;)a=r[l]*i+o,r[l]=a%s|0,o=a/s|0;return o&&r.unshift(o),r}function e(r,i,s,a){var o,l;if(s!=a)l=s>a?1:-1;else for(o=l=0;o<s;o++)if(r[o]!=i[o]){l=r[o]>i[o]?1:-1;break}return l}function t(r,i,s,a){for(var o=0;s--;)r[s]-=o,o=r[s]<i[s]?1:0,r[s]=o*a+r[s]-i[s];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,s,a,o,l){var u,c,h,d,f,p,m,y,v,b,x,w,_,E,A,T,S,M,D,N,R=r.constructor,z=r.s==i.s?1:-1,j=r.d,I=i.d;if(!j||!j[0]||!I||!I[0])return new R(!r.s||!i.s||(j?I&&j[0]==I[0]:!I)?NaN:j&&j[0]==0||!I?z*0:z/0);for(l?(f=1,c=r.e-i.e):(l=du,f=Nt,c=na(r.e/f)-na(i.e/f)),D=I.length,S=j.length,v=new R(z),b=v.d=[],h=0;I[h]==(j[h]||0);h++);if(I[h]>(j[h]||0)&&c--,s==null?(E=s=R.precision,a=R.rounding):o?E=s+(r.e-i.e)+1:E=s,E<0)b.push(1),p=!0;else{if(E=E/f+2|0,h=0,D==1){for(d=0,I=I[0],E++;(h<S||d)&&E--;h++)A=d*l+(j[h]||0),b[h]=A/I|0,d=A%I|0;p=d||h<S}else{for(d=l/(I[0]+1)|0,d>1&&(I=n(I,d,l),j=n(j,d,l),D=I.length,S=j.length),T=D,x=j.slice(0,D),w=x.length;w<D;)x[w++]=0;N=I.slice(),N.unshift(0),M=I[0],I[1]>=l/2&&++M;do d=0,u=e(I,x,D,w),u<0?(_=x[0],D!=w&&(_=_*l+(x[1]||0)),d=_/M|0,d>1?(d>=l&&(d=l-1),m=n(I,d,l),y=m.length,w=x.length,u=e(m,x,y,w),u==1&&(d--,t(m,D<y?N:I,y,l))):(d==0&&(u=d=1),m=I.slice()),y=m.length,y<w&&m.unshift(0),t(x,m,w,l),u==-1&&(w=x.length,u=e(I,x,D,w),u<1&&(d++,t(x,D<w?N:I,w,l))),w=x.length):u===0&&(d++,x=[0]),b[h++]=d,u&&x[0]?x[w++]=j[T]||0:(x=[j[T]],w=1);while((T++<S||x[0]!==void 0)&&E--);p=x[0]!==void 0}b[0]||b.shift()}if(f==1)v.e=c,mte=p;else{for(h=1,d=b[0];d>=10;d/=10)h++;v.e=h+c*f-1,Mt(v,o?s+v.e+1:s,a,p)}return v}}();function Mt(n,e,t,r){var i,s,a,o,l,u,c,h,d,f=n.constructor;e:if(e!=null){if(h=n.d,!h)return n;for(i=1,o=h[0];o>=10;o/=10)i++;if(s=e-i,s<0)s+=Nt,a=e,c=h[d=0],l=c/Di(10,i-a-1)%10|0;else if(d=Math.ceil((s+1)/Nt),o=h.length,d>=o)if(r){for(;o++<=d;)h.push(0);c=l=0,i=1,s%=Nt,a=s-Nt+1}else break e;else{for(c=o=h[d],i=1;o>=10;o/=10)i++;s%=Nt,a=s-Nt+i,l=a<0?0:c/Di(10,i-a-1)%10|0}if(r=r||e<0||h[d+1]!==void 0||(a<0?c:c%Di(10,i-a-1)),u=t<4?(l||r)&&(t==0||t==(n.s<0?3:2)):l>5||l==5&&(t==4||r||t==6&&(s>0?a>0?c/Di(10,i-a):0:h[d-1])%10&1||t==(n.s<0?8:7)),e<1||!h[0])return h.length=0,u?(e-=n.e+1,h[0]=Di(10,(Nt-e%Nt)%Nt),n.e=-e||0):h[0]=n.e=0,n;if(s==0?(h.length=d,o=1,d--):(h.length=d+1,o=Di(10,Nt-s),h[d]=a>0?(c/Di(10,i-a)%Di(10,a)|0)*o:0),u)for(;;)if(d==0){for(s=1,a=h[0];a>=10;a/=10)s++;for(a=h[0]+=o,o=1;a>=10;a/=10)o++;s!=o&&(n.e++,h[0]==du&&(h[0]=1));break}else{if(h[d]+=o,h[d]!=du)break;h[d--]=0,o=1}for(s=h.length;h[--s]===0;)h.pop()}return $t&&(n.e>f.maxE?(n.d=null,n.e=NaN):n.e<f.minE&&(n.e=0,n.d=[0])),n}function Dc(n,e,t){if(!n.isFinite())return Ete(n);var r,i=n.e,s=Es(n.d),a=s.length;return e?(t&&(r=t-a)>0?s=s.charAt(0)+"."+s.slice(1)+Kd(r):a>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(n.e<0?"e":"e+")+n.e):i<0?(s="0."+Kd(-i-1)+s,t&&(r=t-a)>0&&(s+=Kd(r))):i>=a?(s+=Kd(i+1-a),t&&(r=t-i-1)>0&&(s=s+"."+Kd(r))):((r=i+1)<a&&(s=s.slice(0,r)+"."+s.slice(r)),t&&(r=t-a)>0&&(i+1===a&&(s+="."),s+=Kd(r))),s}function PN(n,e){var t=n[0];for(e*=Nt;t>=10;t/=10)e++;return e}function LD(n,e,t){if(e>GMe)throw $t=!0,t&&(n.precision=t),Error(gte);return Mt(new n(PD),e,1,!0)}function cc(n,e,t){if(e>bO)throw Error(gte);return Mt(new n(FD),e,t,!0)}function bte(n){var e=n.length-1,t=e*Nt+1;if(e=n[e],e){for(;e%10==0;e/=10)t--;for(e=n[0];e>=10;e/=10)t++}return t}function Kd(n){for(var e="";n--;)e+="0";return e}function _te(n,e,t,r){var i,s=new n(1),a=Math.ceil(r/Nt+4);for($t=!1;;){if(t%2&&(s=s.times(e),e$(s.d,a)&&(i=!0)),t=na(t/2),t===0){t=s.d.length-1,i&&s.d[t]===0&&++s.d[t];break}e=e.times(e),e$(e.d,a)}return $t=!0,s}function J9(n){return n.d[n.d.length-1]&1}function wte(n,e,t){for(var r,i,s=new n(e[0]),a=0;++a<e.length;){if(i=new n(e[a]),!i.s){s=i;break}r=s.cmp(i),(r===t||r===0&&s.s===t)&&(s=i)}return s}function _O(n,e){var t,r,i,s,a,o,l,u=0,c=0,h=0,d=n.constructor,f=d.rounding,p=d.precision;if(!n.d||!n.d[0]||n.e>17)return new d(n.d?n.d[0]?n.s<0?0:1/0:1:n.s?n.s<0?0:n:NaN);for(e==null?($t=!1,l=p):l=e,o=new d(.03125);n.e>-2;)n=n.times(o),h+=5;for(r=Math.log(Di(2,h))/Math.LN10*2+5|0,l+=r,t=s=a=new d(1),d.precision=l;;){if(s=Mt(s.times(n),l,1),t=t.times(++c),o=a.plus(pr(s,t,l,1)),Es(o.d).slice(0,l)===Es(a.d).slice(0,l)){for(i=h;i--;)a=Mt(a.times(a),l,1);if(e==null)if(u<3&&Nw(a.d,l-r,f,u))d.precision=l+=10,t=s=o=new d(1),c=0,u++;else return Mt(a,d.precision=p,f,$t=!0);else return d.precision=p,a}a=o}}function rp(n,e){var t,r,i,s,a,o,l,u,c,h,d,f=1,p=10,m=n,y=m.d,v=m.constructor,b=v.rounding,x=v.precision;if(m.s<0||!y||!y[0]||!m.e&&y[0]==1&&y.length==1)return new v(y&&!y[0]?-1/0:m.s!=1?NaN:y?0:m);if(e==null?($t=!1,c=x):c=e,v.precision=c+=p,t=Es(y),r=t.charAt(0),Math.abs(s=m.e)<15e14){for(;r<7&&r!=1||r==1&&t.charAt(1)>3;)m=m.times(n),t=Es(m.d),r=t.charAt(0),f++;s=m.e,r>1?(m=new v("0."+t),s++):m=new v(r+"."+t.slice(1))}else return u=LD(v,c+2,x).times(s+""),m=rp(new v(r+"."+t.slice(1)),c-p).plus(u),v.precision=x,e==null?Mt(m,x,b,$t=!0):m;for(h=m,l=a=m=pr(m.minus(1),m.plus(1),c,1),d=Mt(m.times(m),c,1),i=3;;){if(a=Mt(a.times(d),c,1),u=l.plus(pr(a,new v(i),c,1)),Es(u.d).slice(0,c)===Es(l.d).slice(0,c))if(l=l.times(2),s!==0&&(l=l.plus(LD(v,c+2,x).times(s+""))),l=pr(l,new v(f),c,1),e==null)if(Nw(l.d,c-p,b,o))v.precision=c+=p,u=a=m=pr(h.minus(1),h.plus(1),c,1),d=Mt(m.times(m),c,1),i=o=1;else return Mt(l,v.precision=x,b,$t=!0);else return v.precision=x,l;l=u,i+=2}}function Ete(n){return String(n.s*n.s/0)}function fC(n,e){var t,r,i;for((t=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(t<0&&(t=r),t+=+e.slice(r+1),e=e.substring(0,r)):t<0&&(t=e.length),r=0;e.charCodeAt(r)===48;r++);for(i=e.length;e.charCodeAt(i-1)===48;--i);if(e=e.slice(r,i),e){if(i-=r,n.e=t=t-r-1,n.d=[],r=(t+1)%Nt,t<0&&(r+=Nt),r<i){for(r&&n.d.push(+e.slice(0,r)),i-=Nt;r<i;)n.d.push(+e.slice(r,r+=Nt));e=e.slice(r),r=Nt-e.length}else r-=i;for(;r--;)e+="0";n.d.push(+e),$t&&(n.e>n.constructor.maxE?(n.d=null,n.e=NaN):n.e<n.constructor.minE&&(n.e=0,n.d=[0]))}else n.e=0,n.d=[0];return n}function qMe(n,e){var t,r,i,s,a,o,l,u,c;if(e.indexOf("_")>-1){if(e=e.replace(/(\d)_(?=\d)/g,"$1"),xte.test(e))return fC(n,e)}else if(e==="Infinity"||e==="NaN")return+e||(n.s=NaN),n.e=NaN,n.d=null,n;if(zMe.test(e))t=16,e=e.toLowerCase();else if(VMe.test(e))t=2;else if($Me.test(e))t=8;else throw Error(Lp+e);for(s=e.search(/p/i),s>0?(l=+e.slice(s+1),e=e.substring(2,s)):e=e.slice(2),s=e.indexOf("."),a=s>=0,r=n.constructor,a&&(e=e.replace(".",""),o=e.length,s=o-s,i=_te(r,new r(t),s,s*2)),u=dC(e,t,du),c=u.length-1,s=c;u[s]===0;--s)u.pop();return s<0?new r(n.s*0):(n.e=PN(u,c),n.d=u,$t=!1,a&&(n=pr(n,i,o*4)),l&&(n=n.times(Math.abs(l)<54?Di(2,l):Op.pow(2,l))),$t=!0,n)}function WMe(n,e){var t,r=e.d.length;if(r<3)return e.isZero()?e:_b(n,2,e,e);t=1.4*Math.sqrt(r),t=t>16?16:t|0,e=e.times(1/FN(5,t)),e=_b(n,2,e,e);for(var i,s=new n(5),a=new n(16),o=new n(20);t--;)i=e.times(e),e=e.times(s.plus(i.times(a.times(i).minus(o))));return e}function _b(n,e,t,r,i){var s,a,o,l,u=n.precision,c=Math.ceil(u/Nt);for($t=!1,l=t.times(t),o=new n(r);;){if(a=pr(o.times(l),new n(e++*e++),u,1),o=i?r.plus(a):r.minus(a),r=pr(a.times(l),new n(e++*e++),u,1),a=o.plus(r),a.d[c]!==void 0){for(s=c;a.d[s]===o.d[s]&&s--;);if(s==-1)break}s=o,o=r,r=a,a=s}return $t=!0,a.d.length=c+1,a}function FN(n,e){for(var t=n;--e;)t*=n;return t}function Ste(n,e){var t,r=e.s<0,i=cc(n,n.precision,1),s=i.times(.5);if(e=e.abs(),e.lte(s))return Hh=r?4:1,e;if(t=e.divToInt(i),t.isZero())Hh=r?3:2;else{if(e=e.minus(t.times(i)),e.lte(s))return Hh=J9(t)?r?2:3:r?4:1,e;Hh=J9(t)?r?1:4:r?3:2}return e.minus(i).abs()}function W4(n,e,t,r){var i,s,a,o,l,u,c,h,d,f=n.constructor,p=t!==void 0;if(p?(ro(t,1,Yp),r===void 0?r=f.rounding:ro(r,0,8)):(t=f.precision,r=f.rounding),!n.isFinite())c=Ete(n);else{for(c=Dc(n),a=c.indexOf("."),p?(i=2,e==16?t=t*4-3:e==8&&(t=t*3-2)):i=e,a>=0&&(c=c.replace(".",""),d=new f(1),d.e=c.length-a,d.d=dC(Dc(d),10,i),d.e=d.d.length),h=dC(c,10,i),s=l=h.length;h[--l]==0;)h.pop();if(!h[0])c=p?"0p+0":"0";else{if(a<0?s--:(n=new f(n),n.d=h,n.e=s,n=pr(n,d,t,r,0,i),h=n.d,s=n.e,u=mte),a=h[t],o=i/2,u=u||h[t+1]!==void 0,u=r<4?(a!==void 0||u)&&(r===0||r===(n.s<0?3:2)):a>o||a===o&&(r===4||u||r===6&&h[t-1]&1||r===(n.s<0?8:7)),h.length=t,u)for(;++h[--t]>i-1;)h[t]=0,t||(++s,h.unshift(1));for(l=h.length;!h[l-1];--l);for(a=0,c="";a<l;a++)c+=yO.charAt(h[a]);if(p){if(l>1)if(e==16||e==8){for(a=e==16?4:3,--l;l%a;l++)c+="0";for(h=dC(c,i,e),l=h.length;!h[l-1];--l);for(a=1,c="1.";a<l;a++)c+=yO.charAt(h[a])}else c=c.charAt(0)+"."+c.slice(1);c=c+(s<0?"p":"p+")+s}else if(s<0){for(;++s;)c="0"+c;c="0."+c}else if(++s>l)for(s-=l;s--;)c+="0";else s<l&&(c=c.slice(0,s)+"."+c.slice(s))}c=(e==16?"0x":e==2?"0b":e==8?"0o":"")+c}return n.s<0?"-"+c:c}function e$(n,e){if(n.length>e)return n.length=e,!0}function XMe(n){return new this(n).abs()}function KMe(n){return new this(n).acos()}function YMe(n){return new this(n).acosh()}function QMe(n,e){return new this(n).plus(e)}function ZMe(n){return new this(n).asin()}function JMe(n){return new this(n).asinh()}function eCe(n){return new this(n).atan()}function tCe(n){return new this(n).atanh()}function nCe(n,e){n=new this(n),e=new this(e);var t,r=this.precision,i=this.rounding,s=r+4;return!n.s||!e.s?t=new this(NaN):!n.d&&!e.d?(t=cc(this,s,1).times(e.s>0?.25:.75),t.s=n.s):!e.d||n.isZero()?(t=e.s<0?cc(this,r,i):new this(0),t.s=n.s):!n.d||e.isZero()?(t=cc(this,s,1).times(.5),t.s=n.s):e.s<0?(this.precision=s,this.rounding=1,t=this.atan(pr(n,e,s,1)),e=cc(this,s,1),this.precision=r,this.rounding=i,t=n.s<0?t.minus(e):t.plus(e)):t=this.atan(pr(n,e,s,1)),t}function rCe(n){return new this(n).cbrt()}function iCe(n){return Mt(n=new this(n),n.e+1,2)}function sCe(n,e,t){return new this(n).clamp(e,t)}function aCe(n){if(!n||typeof n!="object")throw Error(IN+"Object expected");var e,t,r,i=n.defaults===!0,s=["precision",1,Yp,"rounding",0,8,"toExpNeg",-sy,0,"toExpPos",0,sy,"maxE",0,sy,"minE",-sy,0,"modulo",0,9];for(e=0;e<s.length;e+=3)if(t=s[e],i&&(this[t]=xO[t]),(r=n[t])!==void 0)if(na(r)===r&&r>=s[e+1]&&r<=s[e+2])this[t]=r;else throw Error(Lp+t+": "+r);if(t="crypto",i&&(this[t]=xO[t]),(r=n[t])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[t]=!0;else throw Error(vte);else this[t]=!1;else throw Error(Lp+t+": "+r);return this}function oCe(n){return new this(n).cos()}function lCe(n){return new this(n).cosh()}function Ate(n){var e,t,r;function i(s){var a,o,l,u=this;if(!(u instanceof i))return new i(s);if(u.constructor=i,t$(s)){u.s=s.s,$t?!s.d||s.e>i.maxE?(u.e=NaN,u.d=null):s.e<i.minE?(u.e=0,u.d=[0]):(u.e=s.e,u.d=s.d.slice()):(u.e=s.e,u.d=s.d?s.d.slice():s.d);return}if(l=typeof s,l==="number"){if(s===0){u.s=1/s<0?-1:1,u.e=0,u.d=[0];return}if(s<0?(s=-s,u.s=-1):u.s=1,s===~~s&&s<1e7){for(a=0,o=s;o>=10;o/=10)a++;$t?a>i.maxE?(u.e=NaN,u.d=null):a<i.minE?(u.e=0,u.d=[0]):(u.e=a,u.d=[s]):(u.e=a,u.d=[s]);return}if(s*0!==0){s||(u.s=NaN),u.e=NaN,u.d=null;return}return fC(u,s.toString())}if(l==="string")return(o=s.charCodeAt(0))===45?(s=s.slice(1),u.s=-1):(o===43&&(s=s.slice(1)),u.s=1),xte.test(s)?fC(u,s):qMe(u,s);if(l==="bigint")return s<0?(s=-s,u.s=-1):u.s=1,fC(u,s.toString());throw Error(Lp+s)}if(i.prototype=We,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=aCe,i.clone=Ate,i.isDecimal=t$,i.abs=XMe,i.acos=KMe,i.acosh=YMe,i.add=QMe,i.asin=ZMe,i.asinh=JMe,i.atan=eCe,i.atanh=tCe,i.atan2=nCe,i.cbrt=rCe,i.ceil=iCe,i.clamp=sCe,i.cos=oCe,i.cosh=lCe,i.div=uCe,i.exp=cCe,i.floor=hCe,i.hypot=dCe,i.ln=fCe,i.log=pCe,i.log10=gCe,i.log2=mCe,i.max=vCe,i.min=yCe,i.mod=xCe,i.mul=bCe,i.pow=_Ce,i.random=wCe,i.round=ECe,i.sign=SCe,i.sin=ACe,i.sinh=TCe,i.sqrt=MCe,i.sub=CCe,i.sum=DCe,i.tan=NCe,i.tanh=RCe,i.trunc=ICe,n===void 0&&(n={}),n&&n.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],e=0;e<r.length;)n.hasOwnProperty(t=r[e++])||(n[t]=this[t]);return i.config(n),i}function uCe(n,e){return new this(n).div(e)}function cCe(n){return new this(n).exp()}function hCe(n){return Mt(n=new this(n),n.e+1,3)}function dCe(){var n,e,t=new this(0);for($t=!1,n=0;n<arguments.length;)if(e=new this(arguments[n++]),e.d)t.d&&(t=t.plus(e.times(e)));else{if(e.s)return $t=!0,new this(1/0);t=e}return $t=!0,t.sqrt()}function t$(n){return n instanceof Op||n&&n.toStringTag===yte||!1}function fCe(n){return new this(n).ln()}function pCe(n,e){return new this(n).log(e)}function mCe(n){return new this(n).log(2)}function gCe(n){return new this(n).log(10)}function vCe(){return wte(this,arguments,-1)}function yCe(){return wte(this,arguments,1)}function xCe(n,e){return new this(n).mod(e)}function bCe(n,e){return new this(n).mul(e)}function _Ce(n,e){return new this(n).pow(e)}function wCe(n){var e,t,r,i,s=0,a=new this(1),o=[];if(n===void 0?n=this.precision:ro(n,1,Yp),r=Math.ceil(n/Nt),this.crypto)if(crypto.getRandomValues)for(e=crypto.getRandomValues(new Uint32Array(r));s<r;)i=e[s],i>=429e7?e[s]=crypto.getRandomValues(new Uint32Array(1))[0]:o[s++]=i%1e7;else if(crypto.randomBytes){for(e=crypto.randomBytes(r*=4);s<r;)i=e[s]+(e[s+1]<<8)+(e[s+2]<<16)+((e[s+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(e,s):(o.push(i%1e7),s+=4);s=r/4}else throw Error(vte);else for(;s<r;)o[s++]=Math.random()*1e7|0;for(r=o[--s],n%=Nt,r&&n&&(i=Di(10,Nt-n),o[s]=(r/i|0)*i);o[s]===0;s--)o.pop();if(s<0)t=0,o=[0];else{for(t=-1;o[0]===0;t-=Nt)o.shift();for(r=1,i=o[0];i>=10;i/=10)r++;r<Nt&&(t-=Nt-r)}return a.e=t,a.d=o,a}function ECe(n){return Mt(n=new this(n),n.e+1,this.rounding)}function SCe(n){return n=new this(n),n.d?n.d[0]?n.s:0*n.s:n.s||NaN}function ACe(n){return new this(n).sin()}function TCe(n){return new this(n).sinh()}function MCe(n){return new this(n).sqrt()}function CCe(n,e){return new this(n).sub(e)}function DCe(){var n=0,e=arguments,t=new this(e[n]);for($t=!1;t.s&&++n<e.length;)t=t.plus(e[n]);return $t=!0,Mt(t,this.precision,this.rounding)}function NCe(n){return new this(n).tan()}function RCe(n){return new this(n).tanh()}function ICe(n){return Mt(n=new this(n),n.e+1,1)}We[Symbol.for("nodejs.util.inspect.custom")]=We.toString;We[Symbol.toStringTag]="Decimal";var Op=We.constructor=Ate(xO);PD=new Op(PD);FD=new Op(FD);var PCe="BigNumber",FCe=["?on","config"],LCe=ie(PCe,FCe,n=>{var{on:e,config:t}=n,r=Op.clone({precision:t.precision,modulo:Op.EUCLID});return r.prototype=Object.create(r.prototype),r.prototype.type="BigNumber",r.prototype.isBigNumber=!0,r.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},r.fromJSON=function(i){return new r(i.value)},e&&e("config",function(i,s){i.precision!==s.precision&&r.config({precision:i.precision})}),r},{isClass:!0});const Bs=Math.cosh||function(n){return Math.abs(n)<1e-9?1-n:(Math.exp(n)+Math.exp(-n))*.5},Qo=Math.sinh||function(n){return Math.abs(n)<1e-9?n:(Math.exp(n)-Math.exp(-n))*.5},OCe=n=>{const e=Math.sin(.5*n);return-2*e*e},WI=function(n,e){return n=Math.abs(n),e=Math.abs(e),n<e&&([n,e]=[e,n]),n<1e8?Math.sqrt(n*n+e*e):(e/=n,n*Math.sqrt(1+e*e))},_0=function(){throw SyntaxError("Invalid Param")};function XI(n,e){const t=Math.abs(n),r=Math.abs(e);return n===0?Math.log(r):e===0?Math.log(t):t<3e3&&r<3e3?Math.log(n*n+e*e)*.5:(n=n*.5,e=e*.5,.5*Math.log(n*n+e*e)+Math.LN2)}const kCe={re:0,im:0},Nm=function(n,e){const t=kCe;if(n==null)t.re=t.im=0;else if(e!==void 0)t.re=n,t.im=e;else switch(typeof n){case"object":if("im"in n&&"re"in n)t.re=n.re,t.im=n.im;else if("abs"in n&&"arg"in n){if(!isFinite(n.abs)&&isFinite(n.arg))return Oe.INFINITY;t.re=n.abs*Math.cos(n.arg),t.im=n.abs*Math.sin(n.arg)}else if("r"in n&&"phi"in n){if(!isFinite(n.r)&&isFinite(n.phi))return Oe.INFINITY;t.re=n.r*Math.cos(n.phi),t.im=n.r*Math.sin(n.phi)}else n.length===2?(t.re=n[0],t.im=n[1]):_0();break;case"string":t.im=t.re=0;const r=n.replace(/_/g,"").match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g);let i=1,s=0;r===null&&_0();for(let a=0;a<r.length;a++){const o=r[a];o===" "||o==="	"||o===`
`||(o==="+"?i++:o==="-"?s++:o==="i"||o==="I"?(i+s===0&&_0(),r[a+1]!==" "&&!isNaN(r[a+1])?(t.im+=parseFloat((s%2?"-":"")+r[a+1]),a++):t.im+=parseFloat((s%2?"-":"")+"1"),i=s=0):((i+s===0||isNaN(o))&&_0(),r[a+1]==="i"||r[a+1]==="I"?(t.im+=parseFloat((s%2?"-":"")+o),a++):t.re+=parseFloat((s%2?"-":"")+o),i=s=0))}i+s>0&&_0();break;case"number":t.im=0,t.re=n;break;default:_0()}return isNaN(t.re)||isNaN(t.im),t};function Oe(n,e){if(!(this instanceof Oe))return new Oe(n,e);const t=Nm(n,e);this.re=t.re,this.im=t.im}Oe.prototype={re:0,im:0,sign:function(){const n=WI(this.re,this.im);return new Oe(this.re/n,this.im/n)},add:function(n,e){const t=Nm(n,e),r=this.isInfinite(),i=!(isFinite(t.re)&&isFinite(t.im));return r||i?r&&i?Oe.NAN:Oe.INFINITY:new Oe(this.re+t.re,this.im+t.im)},sub:function(n,e){const t=Nm(n,e),r=this.isInfinite(),i=!(isFinite(t.re)&&isFinite(t.im));return r||i?r&&i?Oe.NAN:Oe.INFINITY:new Oe(this.re-t.re,this.im-t.im)},mul:function(n,e){const t=Nm(n,e),r=this.isInfinite(),i=!(isFinite(t.re)&&isFinite(t.im)),s=this.re===0&&this.im===0,a=t.re===0&&t.im===0;return r&&a||i&&s?Oe.NAN:r||i?Oe.INFINITY:t.im===0&&this.im===0?new Oe(this.re*t.re,0):new Oe(this.re*t.re-this.im*t.im,this.re*t.im+this.im*t.re)},div:function(n,e){const t=Nm(n,e),r=this.isInfinite(),i=!(isFinite(t.re)&&isFinite(t.im)),s=this.re===0&&this.im===0,a=t.re===0&&t.im===0;if(s&&a||r&&i)return Oe.NAN;if(a||r)return Oe.INFINITY;if(s||i)return Oe.ZERO;if(t.im===0)return new Oe(this.re/t.re,this.im/t.re);if(Math.abs(t.re)<Math.abs(t.im)){const o=t.re/t.im,l=t.re*o+t.im;return new Oe((this.re*o+this.im)/l,(this.im*o-this.re)/l)}else{const o=t.im/t.re,l=t.im*o+t.re;return new Oe((this.re+this.im*o)/l,(this.im-this.re*o)/l)}},pow:function(n,e){const t=Nm(n,e),r=this.re===0&&this.im===0;if(t.re===0&&t.im===0)return Oe.ONE;if(t.im===0){if(this.im===0&&this.re>0)return new Oe(Math.pow(this.re,t.re),0);if(this.re===0)switch((t.re%4+4)%4){case 0:return new Oe(Math.pow(this.im,t.re),0);case 1:return new Oe(0,Math.pow(this.im,t.re));case 2:return new Oe(-Math.pow(this.im,t.re),0);case 3:return new Oe(0,-Math.pow(this.im,t.re))}}if(r&&t.re>0)return Oe.ZERO;const s=Math.atan2(this.im,this.re),a=XI(this.re,this.im);let o=Math.exp(t.re*a-t.im*s),l=t.im*a+t.re*s;return new Oe(o*Math.cos(l),o*Math.sin(l))},sqrt:function(){const n=this.re,e=this.im;if(e===0)return n>=0?new Oe(Math.sqrt(n),0):new Oe(0,Math.sqrt(-n));const t=WI(n,e);let r=Math.sqrt(.5*(t+Math.abs(n))),i=Math.abs(e)/(2*r);return n>=0?new Oe(r,e<0?-i:i):new Oe(i,e<0?-r:r)},exp:function(){const n=Math.exp(this.re);return this.im===0?new Oe(n,0):new Oe(n*Math.cos(this.im),n*Math.sin(this.im))},expm1:function(){const n=this.re,e=this.im;return new Oe(Math.expm1(n)*Math.cos(e)+OCe(e),Math.exp(n)*Math.sin(e))},log:function(){const n=this.re,e=this.im;return e===0&&n>0?new Oe(Math.log(n),0):new Oe(XI(n,e),Math.atan2(e,n))},abs:function(){return WI(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){const n=this.re,e=this.im;return new Oe(Math.sin(n)*Bs(e),Math.cos(n)*Qo(e))},cos:function(){const n=this.re,e=this.im;return new Oe(Math.cos(n)*Bs(e),-Math.sin(n)*Qo(e))},tan:function(){const n=2*this.re,e=2*this.im,t=Math.cos(n)+Bs(e);return new Oe(Math.sin(n)/t,Qo(e)/t)},cot:function(){const n=2*this.re,e=2*this.im,t=Math.cos(n)-Bs(e);return new Oe(-Math.sin(n)/t,Qo(e)/t)},sec:function(){const n=this.re,e=this.im,t=.5*Bs(2*e)+.5*Math.cos(2*n);return new Oe(Math.cos(n)*Bs(e)/t,Math.sin(n)*Qo(e)/t)},csc:function(){const n=this.re,e=this.im,t=.5*Bs(2*e)-.5*Math.cos(2*n);return new Oe(Math.sin(n)*Bs(e)/t,-Math.cos(n)*Qo(e)/t)},asin:function(){const n=this.re,e=this.im,t=new Oe(e*e-n*n+1,-2*n*e).sqrt(),r=new Oe(t.re-e,t.im+n).log();return new Oe(r.im,-r.re)},acos:function(){const n=this.re,e=this.im,t=new Oe(e*e-n*n+1,-2*n*e).sqrt(),r=new Oe(t.re-e,t.im+n).log();return new Oe(Math.PI/2-r.im,r.re)},atan:function(){const n=this.re,e=this.im;if(n===0){if(e===1)return new Oe(0,1/0);if(e===-1)return new Oe(0,-1/0)}const t=n*n+(1-e)*(1-e),r=new Oe((1-e*e-n*n)/t,-2*n/t).log();return new Oe(-.5*r.im,.5*r.re)},acot:function(){const n=this.re,e=this.im;if(e===0)return new Oe(Math.atan2(1,n),0);const t=n*n+e*e;return t!==0?new Oe(n/t,-e/t).atan():new Oe(n!==0?n/0:0,e!==0?-e/0:0).atan()},asec:function(){const n=this.re,e=this.im;if(n===0&&e===0)return new Oe(0,1/0);const t=n*n+e*e;return t!==0?new Oe(n/t,-e/t).acos():new Oe(n!==0?n/0:0,e!==0?-e/0:0).acos()},acsc:function(){const n=this.re,e=this.im;if(n===0&&e===0)return new Oe(Math.PI/2,1/0);const t=n*n+e*e;return t!==0?new Oe(n/t,-e/t).asin():new Oe(n!==0?n/0:0,e!==0?-e/0:0).asin()},sinh:function(){const n=this.re,e=this.im;return new Oe(Qo(n)*Math.cos(e),Bs(n)*Math.sin(e))},cosh:function(){const n=this.re,e=this.im;return new Oe(Bs(n)*Math.cos(e),Qo(n)*Math.sin(e))},tanh:function(){const n=2*this.re,e=2*this.im,t=Bs(n)+Math.cos(e);return new Oe(Qo(n)/t,Math.sin(e)/t)},coth:function(){const n=2*this.re,e=2*this.im,t=Bs(n)-Math.cos(e);return new Oe(Qo(n)/t,-Math.sin(e)/t)},csch:function(){const n=this.re,e=this.im,t=Math.cos(2*e)-Bs(2*n);return new Oe(-2*Qo(n)*Math.cos(e)/t,2*Bs(n)*Math.sin(e)/t)},sech:function(){const n=this.re,e=this.im,t=Math.cos(2*e)+Bs(2*n);return new Oe(2*Bs(n)*Math.cos(e)/t,-2*Qo(n)*Math.sin(e)/t)},asinh:function(){const n=this.re,e=this.im;if(e===0){if(n===0)return new Oe(0,0);const s=Math.abs(n),a=Math.log(s+Math.sqrt(s*s+1));return new Oe(n<0?-a:a,0)}const t=n*n-e*e+1,r=2*n*e,i=new Oe(t,r).sqrt();return new Oe(n+i.re,e+i.im).log()},acosh:function(){const n=this.re,e=this.im;if(e===0){if(n>1)return new Oe(Math.log(n+Math.sqrt(n-1)*Math.sqrt(n+1)),0);if(n<-1){const i=Math.sqrt(n*n-1);return new Oe(Math.log(-n+i),Math.PI)}return new Oe(0,Math.acos(n))}const t=new Oe(n-1,e).sqrt(),r=new Oe(n+1,e).sqrt();return new Oe(n+t.re*r.re-t.im*r.im,e+t.re*r.im+t.im*r.re).log()},atanh:function(){const n=this.re,e=this.im;if(e===0){if(n===0)return new Oe(0,0);if(n===1)return new Oe(1/0,0);if(n===-1)return new Oe(-1/0,0);if(-1<n&&n<1)return new Oe(.5*Math.log((1+n)/(1-n)),0);if(n>1){const l=(n+1)/(n-1);return new Oe(.5*Math.log(l),-Math.PI/2)}const o=(1+n)/(1-n);return new Oe(.5*Math.log(-o),Math.PI/2)}const t=1-n,r=1+n,i=t*t+e*e;if(i===0)return new Oe(n!==-1?n/0:0,e!==0?e/0:0);const s=(r*t-e*e)/i,a=(e*t+r*e)/i;return new Oe(XI(s,a)/2,Math.atan2(a,s)/2)},acoth:function(){const n=this.re,e=this.im;if(n===0&&e===0)return new Oe(0,Math.PI/2);const t=n*n+e*e;return t!==0?new Oe(n/t,-e/t).atanh():new Oe(n!==0?n/0:0,e!==0?-e/0:0).atanh()},acsch:function(){const n=this.re,e=this.im;if(e===0){if(n===0)return new Oe(1/0,0);const r=1/n;return new Oe(Math.log(r+Math.sqrt(r*r+1)),0)}const t=n*n+e*e;return t!==0?new Oe(n/t,-e/t).asinh():new Oe(n!==0?n/0:0,e!==0?-e/0:0).asinh()},asech:function(){const n=this.re,e=this.im;if(this.isZero())return Oe.INFINITY;const t=n*n+e*e;return t!==0?new Oe(n/t,-e/t).acosh():new Oe(n!==0?n/0:0,e!==0?-e/0:0).acosh()},inverse:function(){if(this.isZero())return Oe.INFINITY;if(this.isInfinite())return Oe.ZERO;const n=this.re,e=this.im,t=n*n+e*e;return new Oe(n/t,-e/t)},conjugate:function(){return new Oe(this.re,-this.im)},neg:function(){return new Oe(-this.re,-this.im)},ceil:function(n){return n=Math.pow(10,n||0),new Oe(Math.ceil(this.re*n)/n,Math.ceil(this.im*n)/n)},floor:function(n){return n=Math.pow(10,n||0),new Oe(Math.floor(this.re*n)/n,Math.floor(this.im*n)/n)},round:function(n){return n=Math.pow(10,n||0),new Oe(Math.round(this.re*n)/n,Math.round(this.im*n)/n)},equals:function(n,e){const t=Nm(n,e);return Math.abs(t.re-this.re)<=Oe.EPSILON&&Math.abs(t.im-this.im)<=Oe.EPSILON},clone:function(){return new Oe(this.re,this.im)},toString:function(){let n=this.re,e=this.im,t="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(n)<Oe.EPSILON&&(n=0),Math.abs(e)<Oe.EPSILON&&(e=0),e===0?t+n:(n!==0?(t+=n,t+=" ",e<0?(e=-e,t+="-"):t+="+",t+=" "):e<0&&(e=-e,t+="-"),e!==1&&(t+=e),t+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return this.im===0?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return this.im===0&&this.re===0},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!this.isFinite()}};Oe.ZERO=new Oe(0,0);Oe.ONE=new Oe(1,0);Oe.I=new Oe(0,1);Oe.PI=new Oe(Math.PI,0);Oe.E=new Oe(Math.E,0);Oe.INFINITY=new Oe(1/0,1/0);Oe.NAN=new Oe(NaN,NaN);Oe.EPSILON=1e-15;var BCe="Complex",UCe=[],VCe=ie(BCe,UCe,()=>(Object.defineProperty(Oe,"name",{value:"Complex"}),Oe.prototype.constructor=Oe,Oe.prototype.type="Complex",Oe.prototype.isComplex=!0,Oe.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},Oe.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},Oe.prototype.format=function(n){var e="",t=this.im,r=this.re,i=pv(this.re,n),s=pv(this.im,n),a=Tt(n)?n:n?n.precision:null;if(a!==null){var o=Math.pow(10,-a);Math.abs(r/t)<o&&(r=0),Math.abs(t/r)<o&&(t=0)}return t===0?e=i:r===0?t===1?e="i":t===-1?e="-i":e=s+"i":t<0?t===-1?e=i+" - i":e=i+" - "+s.substring(1)+"i":t===1?e=i+" + i":e=i+" + "+s+"i",e},Oe.fromPolar=function(n){switch(arguments.length){case 1:{var e=arguments[0];if(typeof e=="object")return Oe(e);throw new TypeError("Input has to be an object with r and phi keys.")}case 2:{var t=arguments[0],r=arguments[1];if(Tt(t)){if(Ro(r)&&r.hasBase("ANGLE")&&(r=r.toNumber("rad")),Tt(r))return new Oe({r:t,phi:r});throw new TypeError("Phi is not a number nor an angle unit.")}else throw new TypeError("Radius r is not a number.")}default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},Oe.prototype.valueOf=Oe.prototype.toString,Oe.fromJSON=function(n){return new Oe(n)},Oe.compare=function(n,e){return n.re>e.re?1:n.re<e.re?-1:n.im>e.im?1:n.im<e.im?-1:0},Oe),{isClass:!0});typeof BigInt>"u"&&(BigInt=function(n){if(isNaN(n))throw new Error("");return n});const Et=BigInt(0),cn=BigInt(1),ts=BigInt(2),O1=BigInt(3),ay=BigInt(5),ja=BigInt(10);BigInt(Number.MAX_SAFE_INTEGER);const zCe=2e3,st={s:cn,n:Et,d:cn};function qc(n,e){try{n=BigInt(n)}catch{throw jd()}return n*e}function Bl(n){return typeof n=="bigint"?n:Math.floor(n)}function Ar(n,e){if(e===Et)throw X4();const t=Object.create(Jo.prototype);t.s=n<Et?-cn:cn,n=n<Et?-n:n;const r=Pm(n,e);return t.n=n/r,t.d=e/r,t}const $Ce=[ts*ts,ts,ts*ts,ts,ts*ts,ts*O1,ts,ts*O1];function w0(n){const e=Object.create(null);if(n<=cn)return e[n]=cn,e;const t=r=>{e[r]=(e[r]||Et)+cn};for(;n%ts===Et;)t(ts),n/=ts;for(;n%O1===Et;)t(O1),n/=O1;for(;n%ay===Et;)t(ay),n/=ay;for(let r=0,i=ts+ay;i*i<=n;){for(;n%i===Et;)t(i),n/=i;i+=$Ce[r],r=r+1&7}return n>cn&&t(n),e}const Wi=function(n,e){let t=Et,r=cn,i=cn;if(n!=null)if(e!==void 0){if(typeof n=="bigint")t=n;else{if(isNaN(n))throw jd();if(n%1!==0)throw n$();t=BigInt(n)}if(typeof e=="bigint")r=e;else{if(isNaN(e))throw jd();if(e%1!==0)throw n$();r=BigInt(e)}i=t*r}else if(typeof n=="object"){if("d"in n&&"n"in n)t=BigInt(n.n),r=BigInt(n.d),"s"in n&&(t*=BigInt(n.s));else if(0 in n)t=BigInt(n[0]),1 in n&&(r=BigInt(n[1]));else if(typeof n=="bigint")t=n;else throw jd();i=t*r}else if(typeof n=="number"){if(isNaN(n))throw jd();if(n<0&&(i=-cn,n=-n),n%1===0)t=BigInt(n);else{let s=1,a=0,o=1,l=1,u=1,c=1e7;for(n>=1&&(s=10**Math.floor(1+Math.log10(n)),n/=s);o<=c&&u<=c;){let h=(a+l)/(o+u);if(n===h){o+u<=c?(t=a+l,r=o+u):u>o?(t=l,r=u):(t=a,r=o);break}else n>h?(a+=l,o+=u):(l+=a,u+=o),o>c?(t=l,r=u):(t=a,r=o)}t=BigInt(t)*BigInt(s),r=BigInt(r)}}else if(typeof n=="string"){let s=0,a=Et,o=Et,l=Et,u=cn,c=cn,h=n.replace(/_/g,"").match(/\d+|./g);if(h===null)throw jd();if(h[s]==="-"?(i=-cn,s++):h[s]==="+"&&s++,h.length===s+1?o=qc(h[s++],i):h[s+1]==="."||h[s]==="."?(h[s]!=="."&&(a=qc(h[s++],i)),s++,(s+1===h.length||h[s+1]==="("&&h[s+3]===")"||h[s+1]==="'"&&h[s+3]==="'")&&(o=qc(h[s],i),u=ja**BigInt(h[s].length),s++),(h[s]==="("&&h[s+2]===")"||h[s]==="'"&&h[s+2]==="'")&&(l=qc(h[s+1],i),c=ja**BigInt(h[s+1].length)-cn,s+=3)):h[s+1]==="/"||h[s+1]===":"?(o=qc(h[s],i),u=qc(h[s+2],cn),s+=3):h[s+3]==="/"&&h[s+1]===" "&&(a=qc(h[s],i),o=qc(h[s+2],i),u=qc(h[s+4],cn),s+=5),h.length<=s)r=u*c,i=t=l+r*a+c*o;else throw jd()}else if(typeof n=="bigint")t=n,i=n,r=cn;else throw jd();if(r===Et)throw X4();st.s=i<Et?-cn:cn,st.n=t<Et?-t:t,st.d=r<Et?-r:r};function HCe(n,e,t){let r=cn;for(;e>Et;n=n*n%t,e>>=cn)e&cn&&(r=r*n%t);return r}function GCe(n,e){for(;e%ts===Et;e/=ts);for(;e%ay===Et;e/=ay);if(e===cn)return Et;let t=ja%e,r=1;for(;t!==cn;r++)if(t=t*ja%e,r>zCe)return Et;return BigInt(r)}function jCe(n,e,t){let r=cn,i=HCe(ja,t,e);for(let s=0;s<300;s++){if(r===i)return BigInt(s);r=r*ja%e,i=i*ja%e}return 0}function Pm(n,e){if(!n)return e;if(!e)return n;for(;;){if(n%=e,!n)return e;if(e%=n,!e)return n}}function Jo(n,e){if(Wi(n,e),this instanceof Jo)n=Pm(st.d,st.n),this.s=st.s,this.n=st.n/n,this.d=st.d/n;else return Ar(st.s*st.n,st.d)}const X4=function(){return new Error("Division by Zero")},jd=function(){return new Error("Invalid argument")},n$=function(){return new Error("Parameters must be integer")};Jo.prototype={s:cn,n:Et,d:cn,abs:function(){return Ar(this.n,this.d)},neg:function(){return Ar(-this.s*this.n,this.d)},add:function(n,e){return Wi(n,e),Ar(this.s*this.n*st.d+st.s*this.d*st.n,this.d*st.d)},sub:function(n,e){return Wi(n,e),Ar(this.s*this.n*st.d-st.s*this.d*st.n,this.d*st.d)},mul:function(n,e){return Wi(n,e),Ar(this.s*st.s*this.n*st.n,this.d*st.d)},div:function(n,e){return Wi(n,e),Ar(this.s*st.s*this.n*st.d,this.d*st.n)},clone:function(){return Ar(this.s*this.n,this.d)},mod:function(n,e){if(n===void 0)return Ar(this.s*this.n%this.d,cn);if(Wi(n,e),Et===st.n*this.d)throw X4();return Ar(this.s*(st.d*this.n)%(st.n*this.d),st.d*this.d)},gcd:function(n,e){return Wi(n,e),Ar(Pm(st.n,this.n)*Pm(st.d,this.d),st.d*this.d)},lcm:function(n,e){return Wi(n,e),st.n===Et&&this.n===Et?Ar(Et,cn):Ar(st.n*this.n,Pm(st.n,this.n)*Pm(st.d,this.d))},inverse:function(){return Ar(this.s*this.d,this.n)},pow:function(n,e){if(Wi(n,e),st.d===cn)return st.s<Et?Ar((this.s*this.d)**st.n,this.n**st.n):Ar((this.s*this.n)**st.n,this.d**st.n);if(this.s<Et)return null;let t=w0(this.n),r=w0(this.d),i=cn,s=cn;for(let a in t)if(a!=="1"){if(a==="0"){i=Et;break}if(t[a]*=st.n,t[a]%st.d===Et)t[a]/=st.d;else return null;i*=BigInt(a)**t[a]}for(let a in r)if(a!=="1"){if(r[a]*=st.n,r[a]%st.d===Et)r[a]/=st.d;else return null;s*=BigInt(a)**r[a]}return st.s<Et?Ar(s,i):Ar(i,s)},log:function(n,e){if(Wi(n,e),this.s<=Et||st.s<=Et)return null;const t=Object.create(null),r=w0(st.n),i=w0(st.d),s=w0(this.n),a=w0(this.d);for(const u in i)r[u]=(r[u]||Et)-i[u];for(const u in a)s[u]=(s[u]||Et)-a[u];for(const u in r)u!=="1"&&(t[u]=!0);for(const u in s)u!=="1"&&(t[u]=!0);let o=null,l=null;for(const u in t){const c=r[u]||Et,h=s[u]||Et;if(c===Et){if(h!==Et)return null;continue}let d=h,f=c;const p=Pm(d,f);if(d/=p,f/=p,o===null&&l===null)o=d,l=f;else if(d*l!==o*f)return null}return o!==null&&l!==null?Ar(o,l):null},equals:function(n,e){return Wi(n,e),this.s*this.n*st.d===st.s*st.n*this.d},lt:function(n,e){return Wi(n,e),this.s*this.n*st.d<st.s*st.n*this.d},lte:function(n,e){return Wi(n,e),this.s*this.n*st.d<=st.s*st.n*this.d},gt:function(n,e){return Wi(n,e),this.s*this.n*st.d>st.s*st.n*this.d},gte:function(n,e){return Wi(n,e),this.s*this.n*st.d>=st.s*st.n*this.d},compare:function(n,e){Wi(n,e);let t=this.s*this.n*st.d-st.s*st.n*this.d;return(Et<t)-(t<Et)},ceil:function(n){return n=ja**BigInt(n||0),Ar(Bl(this.s*n*this.n/this.d)+(n*this.n%this.d>Et&&this.s>=Et?cn:Et),n)},floor:function(n){return n=ja**BigInt(n||0),Ar(Bl(this.s*n*this.n/this.d)-(n*this.n%this.d>Et&&this.s<Et?cn:Et),n)},round:function(n){return n=ja**BigInt(n||0),Ar(Bl(this.s*n*this.n/this.d)+this.s*((this.s>=Et?cn:Et)+ts*(n*this.n%this.d)>this.d?cn:Et),n)},roundTo:function(n,e){Wi(n,e);const t=this.n*st.d,r=this.d*st.n,i=t%r;let s=Bl(t/r);return i+i>=r&&s++,Ar(this.s*s*st.n,st.d)},divisible:function(n,e){return Wi(n,e),st.n===Et?!1:this.n*st.d%(st.n*this.d)===Et},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(n=15){let e=this.n,t=this.d,r=GCe(e,t),i=jCe(e,t,r),s=this.s<Et?"-":"";if(s+=Bl(e/t),e%=t,e*=ja,e&&(s+="."),r){for(let a=i;a--;)s+=Bl(e/t),e%=t,e*=ja;s+="(";for(let a=r;a--;)s+=Bl(e/t),e%=t,e*=ja;s+=")"}else for(let a=n;e&&a--;)s+=Bl(e/t),e%=t,e*=ja;return s},toFraction:function(n=!1){let e=this.n,t=this.d,r=this.s<Et?"-":"";if(t===cn)r+=e;else{const i=Bl(e/t);n&&i>Et&&(r+=i,r+=" ",e%=t),r+=e,r+="/",r+=t}return r},toLatex:function(n=!1){let e=this.n,t=this.d,r=this.s<Et?"-":"";if(t===cn)r+=e;else{const i=Bl(e/t);n&&i>Et&&(r+=i,e%=t),r+="\\frac{",r+=e,r+="}{",r+=t,r+="}"}return r},toContinued:function(){let n=this.n,e=this.d;const t=[];for(;e;){t.push(Bl(n/e));const r=n%e;n=e,e=r}return t},simplify:function(n=.001){const e=BigInt(Math.ceil(1/n)),t=this.abs(),r=t.toContinued();for(let i=1;i<r.length;i++){let s=Ar(r[i-1],cn);for(let o=i-2;o>=0;o--)s=s.inverse().add(r[o]);let a=s.sub(t);if(a.n*e<a.d)return s.mul(this.s)}return this}};var qCe="Fraction",WCe=[],XCe=ie(qCe,WCe,()=>(Object.defineProperty(Jo,"name",{value:"Fraction"}),Jo.prototype.constructor=Jo,Jo.prototype.type="Fraction",Jo.prototype.isFraction=!0,Jo.prototype.toJSON=function(){return{mathjs:"Fraction",n:String(this.s*this.n),d:String(this.d)}},Jo.fromJSON=function(n){return new Jo(n)},Jo),{isClass:!0}),KCe="Range",YCe=[],QCe=ie(KCe,YCe,()=>{function n(e,t,r){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");var i=e!=null,s=t!=null,a=r!=null;if(i){if(jt(e))e=e.toNumber();else if(typeof e!="number"&&!L1(e))throw new TypeError("Parameter start must be a number or bigint")}if(s){if(jt(t))t=t.toNumber();else if(typeof t!="number"&&!L1(t))throw new TypeError("Parameter end must be a number or bigint")}if(a){if(jt(r))r=r.toNumber();else if(typeof r!="number"&&!L1(r))throw new TypeError("Parameter step must be a number or bigint")}if(this.start=i?parseFloat(e):0,this.end=s?parseFloat(t):0,this.step=a?parseFloat(r):1,a&&as(this.step,0))throw new Error("Step must not be zero")}return n.prototype.type="Range",n.prototype.isRange=!0,n.parse=function(e){if(typeof e!="string")return null;var t=e.split(":"),r=t.map(function(s){return parseFloat(s)}),i=r.some(function(s){return isNaN(s)});if(i)return null;switch(r.length){case 2:return new n(r[0],r[1]);case 3:return new n(r[0],r[2],r[1]);default:return null}},n.prototype.clone=function(){return new n(this.start,this.end,this.step)},n.prototype.size=function(){var e=0,t=this.start,r=this.step,i=this.end,s=i-t;return np(r)===np(s)?e=Math.ceil(s/r):s===0&&(e=0),isNaN(e)&&(e=0),[e]},n.prototype.min=function(){var e=this.size()[0];if(e>0)return this.step>0?this.start:this.start+(e-1)*this.step},n.prototype.max=function(){var e=this.size()[0];if(e>0)return this.step>0?this.start+(e-1)*this.step:this.start},n.prototype.forEach=function(e){var t=this.start,r=this.step,i=this.end,s=0;if(r>0)for(;t<i;)e(t,[s],this),t+=r,s++;else if(r<0)for(;t>i;)e(t,[s],this),t+=r,s++},n.prototype.map=function(e){var t=[];return this.forEach(function(r,i,s){t[i[0]]=e(r,i,s)}),t},n.prototype.toArray=function(){var e=[];return this.forEach(function(t,r){e[r[0]]=t}),e},n.prototype.valueOf=function(){return this.toArray()},n.prototype.format=function(e){var t=pv(this.start,e);return this.step!==1&&(t+=":"+pv(this.step,e)),t+=":"+pv(this.end,e),t},n.prototype.toString=function(){return this.format()},n.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},n.fromJSON=function(e){return new n(e.start,e.end,e.step)},n},{isClass:!0}),ZCe="Matrix",JCe=[],eDe=ie(ZCe,JCe,()=>{function n(){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator")}return n.prototype.type="Matrix",n.prototype.isMatrix=!0,n.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},n.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},n.prototype.create=function(e,t){throw new Error("Cannot invoke create on a Matrix interface")},n.prototype.subset=function(e,t,r){throw new Error("Cannot invoke subset on a Matrix interface")},n.prototype.get=function(e){throw new Error("Cannot invoke get on a Matrix interface")},n.prototype.set=function(e,t,r){throw new Error("Cannot invoke set on a Matrix interface")},n.prototype.resize=function(e,t){throw new Error("Cannot invoke resize on a Matrix interface")},n.prototype.reshape=function(e,t){throw new Error("Cannot invoke reshape on a Matrix interface")},n.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},n.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},n.prototype.map=function(e,t){throw new Error("Cannot invoke map on a Matrix interface")},n.prototype.forEach=function(e){throw new Error("Cannot invoke forEach on a Matrix interface")},n.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},n.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},n.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},n.prototype.format=function(e){throw new Error("Cannot invoke format on a Matrix interface")},n.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},n},{isClass:!0});function KI(n,e,t){var r=n.constructor,i=new r(2),s="";if(t){if(t<1)throw new Error("size must be in greater than 0");if(!bt(t))throw new Error("size must be an integer");if(n.greaterThan(i.pow(t-1).sub(1))||n.lessThan(i.pow(t-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(t-1,", 2^").concat(t-1,"-1]"));if(!n.isInteger())throw new Error("Value must be an integer");n.lessThan(0)&&(n=n.add(i.pow(t))),s="i".concat(t)}switch(e){case 2:return"".concat(n.toBinary()).concat(s);case 8:return"".concat(n.toOctal()).concat(s);case 16:return"".concat(n.toHexadecimal()).concat(s);default:throw new Error("Base ".concat(e," not supported "))}}function tDe(n,e){if(typeof e=="function")return e(n);if(!n.isFinite())return n.isNaN()?"NaN":n.gt(0)?"Infinity":"-Infinity";var{notation:t,precision:r,wordSize:i}=hte(e);switch(t){case"fixed":return rDe(n,r);case"exponential":return r$(n,r);case"engineering":return nDe(n,r);case"bin":return KI(n,2,i);case"oct":return KI(n,8,i);case"hex":return KI(n,16,i);case"auto":{var s=i$(e==null?void 0:e.lowerExp,-3),a=i$(e==null?void 0:e.upperExp,5);if(n.isZero())return"0";var o,l=n.toSignificantDigits(r),u=l.e;return u>=s&&u<a?o=l.toFixed():o=r$(n,r),o.replace(/((\.\d*?)(0+))($|e)/,function(){var c=arguments[2],h=arguments[4];return c!=="."?c+h:h})}default:throw new Error('Unknown notation "'+t+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function nDe(n,e){var t=n.e,r=t%3===0?t:t<0?t-3-t%3:t-t%3,i=n.mul(Math.pow(10,-r)),s=i.toPrecision(e);if(s.includes("e")){var a=n.constructor;s=new a(s).toFixed()}return s+"e"+(t>=0?"+":"")+r.toString()}function r$(n,e){return e!==void 0?n.toExponential(e-1):n.toExponential()}function rDe(n,e){return n.toFixed(e)}function i$(n,e){return Tt(n)?n:jt(n)?n.toNumber():e}function iDe(n,e){var t=n.length-e.length,r=n.length;return n.substring(t,r)===e}function nn(n,e){var t=sDe(n,e);return e&&typeof e=="object"&&"truncate"in e&&t.length>e.truncate?t.substring(0,e.truncate-3)+"...":t}function sDe(n,e){if(typeof n=="number")return pv(n,e);if(jt(n))return tDe(n,e);if(aDe(n))return!e||e.fraction!=="decimal"?"".concat(n.s*n.n,"/").concat(n.d):n.toString();if(Array.isArray(n))return Tte(n,e);if(Qr(n))return oy(n);if(typeof n=="function")return n.syntax?String(n.syntax):"function";if(n&&typeof n=="object"){if(typeof n.format=="function")return n.format(e);if(n&&n.toString(e)!=={}.toString())return n.toString(e);var t=Object.keys(n).map(r=>oy(r)+": "+nn(n[r],e));return"{"+t.join(", ")+"}"}return String(n)}function oy(n){for(var e=String(n),t="",r=0;r<e.length;){var i=e.charAt(r);t+=i in s$?s$[i]:i,r++}return'"'+t+'"'}var s$={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"};function vl(n){var e=String(n);return e=e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e}function Tte(n,e){if(Array.isArray(n)){for(var t="[",r=n.length,i=0;i<r;i++)i!==0&&(t+=", "),t+=Tte(n[i],e);return t+="]",t}else return nn(n,e)}function aDe(n){return n&&typeof n=="object"&&typeof n.s=="bigint"&&typeof n.n=="bigint"&&typeof n.d=="bigint"||!1}function wO(n,e){if(!Qr(n))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+Kn(n)+", index: 0)");if(!Qr(e))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+Kn(e)+", index: 1)");return n===e?0:n>e?1:-1}function en(n,e,t){if(!(this instanceof en))throw new SyntaxError("Constructor must be called with the new operator");this.actual=n,this.expected=e,this.relation=t,this.message="Dimension mismatch ("+(Array.isArray(n)?"["+n.join(", ")+"]":n)+" "+(this.relation||"!=")+" "+(Array.isArray(e)?"["+e.join(", ")+"]":e)+")",this.stack=new Error().stack}en.prototype=new RangeError;en.prototype.constructor=RangeError;en.prototype.name="DimensionError";en.prototype.isDimensionError=!0;function yu(n,e,t){if(!(this instanceof yu))throw new SyntaxError("Constructor must be called with the new operator");this.index=n,arguments.length<3?(this.min=0,this.max=e):(this.min=e,this.max=t),this.min!==void 0&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":this.max!==void 0&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=new Error().stack}yu.prototype=new RangeError;yu.prototype.constructor=RangeError;yu.prototype.name="IndexError";yu.prototype.isIndexError=!0;function Vt(n){for(var e=[];Array.isArray(n);)e.push(n.length),n=n[0];return e}function Mte(n,e,t){var r,i=n.length;if(i!==e[t])throw new en(i,e[t]);if(t<e.length-1){var s=t+1;for(r=0;r<i;r++){var a=n[r];if(!Array.isArray(a))throw new en(e.length-1,e.length,"<");Mte(n[r],e,s)}}else for(r=0;r<i;r++)if(Array.isArray(n[r]))throw new en(e.length+1,e.length,">")}function a$(n,e){var t=e.length===0;if(t){if(Array.isArray(n))throw new en(n.length,0)}else Mte(n,e,0)}function OD(n,e){var t=n.isMatrix?n._size:Vt(n),r=e._sourceSize;r.forEach((i,s)=>{if(i!==null&&i!==t[s])throw new en(i,t[s])})}function ir(n,e){if(n!==void 0){if(!Tt(n)||!bt(n))throw new TypeError("Index must be an integer (value: "+n+")");if(n<0||typeof e=="number"&&n>=e)throw new yu(n,e)}}function wb(n){for(var e=0;e<n._dimensions.length;++e){var t=n._dimensions[e];if(t._data&&Wn(t._data)){if(t._size[0]===0)return!0}else if(t.isRange){if(t.start===t.end)return!0}else if(Qr(t)&&t.length===0)return!0}return!1}function Eb(n,e,t){if(!Array.isArray(e))throw new TypeError("Array expected");if(e.length===0)throw new Error("Resizing to scalar is not supported");e.forEach(function(i){if(!Tt(i)||!bt(i)||i<0)throw new TypeError("Invalid size, must contain positive integers (size: "+nn(e)+")")}),(Tt(n)||jt(n))&&(n=[n]);var r=t!==void 0?t:0;return EO(n,e,0,r),n}function EO(n,e,t,r){var i,s,a=n.length,o=e[t],l=Math.min(a,o);if(n.length=o,t<e.length-1){var u=t+1;for(i=0;i<l;i++)s=n[i],Array.isArray(s)||(s=[s],n[i]=s),EO(s,e,u,r);for(i=l;i<o;i++)s=[],n[i]=s,EO(s,e,u,r)}else{for(i=0;i<l;i++)for(;Array.isArray(n[i]);)n[i]=n[i][0];for(i=l;i<o;i++)n[i]=r}}function K4(n,e){var t=Tn(n,!0),r=t.length;if(!Array.isArray(n)||!Array.isArray(e))throw new TypeError("Array expected");if(e.length===0)throw new en(0,r,"!=");e=Y4(e,r);var i=Cte(e);if(r!==i)throw new en(i,r,"!=");try{return oDe(t,e)}catch(s){throw s instanceof en?new en(i,r,"!="):s}}function Y4(n,e){var t=Cte(n),r=n.slice(),i=-1,s=n.indexOf(i),a=n.indexOf(i,s+1)>=0;if(a)throw new Error("More than one wildcard in sizes");var o=s>=0,l=e%t===0;if(o)if(l)r[s]=-e/t;else throw new Error("Could not replace wildcard, since "+e+" is no multiple of "+-t);return r}function Cte(n){return n.reduce((e,t)=>e*t,1)}function oDe(n,e){for(var t=n,r,i=e.length-1;i>0;i--){var s=e[i];r=[];for(var a=t.length/s,o=0;o<a;o++)r.push(t.slice(o*s,(o+1)*s));t=r}return t}function kD(n,e){for(var t=Vt(n);Array.isArray(n)&&n.length===1;)n=n[0],t.shift();for(var r=t.length;t[r-1]===1;)r--;return r<t.length&&(n=Dte(n,r,0),t.length=r),n}function Dte(n,e,t){var r,i;if(t<e){var s=t+1;for(r=0,i=n.length;r<i;r++)n[r]=Dte(n[r],e,s)}else for(;Array.isArray(n);)n=n[0];return n}function Nte(n,e,t,r){var i=r||Vt(n);if(t)for(var s=0;s<t;s++)n=[n],i.unshift(1);for(n=Rte(n,e,0);i.length<e;)i.push(1);return n}function Rte(n,e,t){var r,i;if(Array.isArray(n)){var s=t+1;for(r=0,i=n.length;r<i;r++)n[r]=Rte(n[r],e,s)}else for(var a=t;a<e;a++)n=[n];return n}function Tn(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!Array.isArray(n))return n;if(typeof e!="boolean")throw new TypeError("Boolean expected for second argument of flatten");var t=[];return e?i(n):r(n),t;function r(s){for(var a=0;a<s.length;a++){var o=s[a];Array.isArray(o)?r(o):t.push(o)}}function i(s){if(Array.isArray(s[0]))for(var a=0;a<s.length;a++)i(s[a]);else for(var o=0;o<s.length;o++)t.push(s[o])}}function vp(n,e){return Array.prototype.map.call(n,e)}function Ite(n,e){Array.prototype.forEach.call(n,e)}function o$(n,e){if(Vt(n).length!==1)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(n,e)}function l$(n,e){if(Vt(n).length!==1)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(n,t=>e.test(t))}function u$(n,e){return Array.prototype.join.call(n,e)}function Sb(n){if(!Array.isArray(n))throw new TypeError("Array input expected");if(n.length===0)return n;var e=[],t=0;e[0]={value:n[0],identifier:0};for(var r=1;r<n.length;r++)n[r]===n[r-1]?t++:t=0,e.push({value:n[r],identifier:t});return e}function BD(n){if(!Array.isArray(n))throw new TypeError("Array input expected");if(n.length===0)return n;for(var e=[],t=0;t<n.length;t++)e.push(n[t].value);return e}function LN(n,e){for(var t,r=0,i=0;i<n.length;i++){var s=n[i],a=Array.isArray(s);if(i===0&&a&&(r=s.length),a&&s.length!==r)return;var o=a?LN(s,e):e(s);if(t===void 0)t=o;else if(t!==o)return"mixed"}return t}function Pte(n,e,t,r){if(r<t){if(n.length!==e.length)throw new en(n.length,e.length);for(var i=[],s=0;s<n.length;s++)i[s]=Pte(n[s],e[s],t,r+1);return i}else return n.concat(e)}function Fte(){var n=Array.prototype.slice.call(arguments,0,-1),e=Array.prototype.slice.call(arguments,-1);if(n.length===1)return n[0];if(n.length>1)return n.slice(1).reduce(function(t,r){return Pte(t,r,e,0)},n[0]);throw new Error("Wrong number of arguments in function concat")}function UD(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];for(var r=e.map(d=>d.length),i=Math.max(...r),s=new Array(i).fill(null),a=0;a<e.length;a++)for(var o=e[a],l=r[a],u=0;u<l;u++){var c=i-l+u;o[u]>s[c]&&(s[c]=o[u])}for(var h=0;h<e.length;h++)Lte(e[h],s);return s}function Lte(n,e){for(var t=e.length,r=n.length,i=0;i<r;i++){var s=t-r+i;if(n[i]<e[s]&&n[i]>1||n[i]>e[s])throw new Error("shape mismatch: mismatch is found in arg with shape (".concat(n,") not possible to broadcast dimension ").concat(r," with size ").concat(n[i]," to size ").concat(e[s]))}}function qm(n,e){var t=Vt(n);if(yd(t,e))return n;Lte(t,e);var r=UD(t,e),i=r.length,s=[...Array(i-t.length).fill(1),...t],a=uDe(n);t.length<i&&(a=K4(a,s),t=Vt(a));for(var o=0;o<i;o++)t[o]<r[o]&&(a=lDe(a,r[o],o),t=Vt(a));return a}function lDe(n,e,t){return Fte(...Array(e).fill(n),t)}function VD(n,e){if(!Array.isArray(n))throw new Error("Array expected");var t=Vt(n);if(e.length!==t.length)throw new en(e.length,t.length);for(var r=0;r<e.length;r++)ir(e[r],t[r]);return e.reduce((i,s)=>i[s],n)}function SO(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n.length===0)return[];if(t)return s(n);var r=[];return i(n,0);function i(a,o){if(Array.isArray(a)){for(var l=a.length,u=Array(l),c=0;c<l;c++)r[o]=c,u[c]=i(a[c],o+1);return u}else return e(a,r.slice(0,o),n)}function s(a){if(Array.isArray(a)){for(var o=a.length,l=Array(o),u=0;u<o;u++)l[u]=s(a[u]);return l}else return e(a)}}function Ote(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(n.length===0)return;if(t){s(n);return}var r=[];i(n,0);function i(a,o){if(Array.isArray(a))for(var l=a.length,u=0;u<l;u++)r[o]=u,i(a[u],o+1);else e(a,r.slice(0,o),n)}function s(a){if(Array.isArray(a))for(var o=a.length,l=0;l<o;l++)s(a[l]);else e(a)}}function uDe(n){return ai([],n)}function Rv(n,e,t,r){if(ID.isTypedFunction(n)){var i;if(r)i=1;else{var s=e.isMatrix?e.size():Vt(e),a=s.length?s[s.length-1]===0:!0;if(a)return{isUnary:r,fn:n};var o=s.map(()=>0),l=e.isMatrix?e.get(o):VD(e,o);i=dDe(n,l,o,e)}var u;if(e.isMatrix&&e.dataType!=="mixed"&&e.dataType!==void 0){var c=cDe(n,i);u=c!==void 0?c:n}else u=n;return i>=1&&i<=3?{isUnary:i===1,fn:function(){for(var d=arguments.length,f=new Array(d),p=0;p<d;p++)f[p]=arguments[p];return c$(u,f.slice(0,i),t,n.name)}}:{isUnary:!1,fn:function(){for(var d=arguments.length,f=new Array(d),p=0;p<d;p++)f[p]=arguments[p];return c$(u,f,t,n.name)}}}return r===void 0?{isUnary:hDe(n),fn:n}:{isUnary:r,fn:n}}function cDe(n,e){var t=[];if(Object.entries(n.signatures).forEach(r=>{var[i,s]=r;i.split(",").length===e&&t.push(s)}),t.length===1)return t[0]}function hDe(n){if(n.length!==1)return!1;var e=n.toString();if(/arguments/.test(e))return!1;var t=e.match(/\(.*?\)/);return!/\.\.\./.test(t)}function dDe(n,e,t,r){for(var i=[e,t,r],s=3;s>0;s--){var a=i.slice(0,s);if(ID.resolve(n,a)!==null)return s}}function c$(n,e,t,r){try{return n(...e)}catch(i){fDe(i,e,t,r)}}function fDe(n,e,t,r){var i;if(n instanceof TypeError&&((i=n.data)===null||i===void 0?void 0:i.category)==="wrongType"){var s=[];throw s.push("value: ".concat(Kn(e[0]))),e.length>=2&&s.push("index: ".concat(Kn(e[1]))),e.length>=3&&s.push("array: ".concat(Kn(e[2]))),new TypeError("Function ".concat(t," cannot apply callback arguments ")+"".concat(r,"(").concat(s.join(", "),") at index ").concat(JSON.stringify(e[1])))}else throw new TypeError("Function ".concat(t," cannot apply callback arguments ")+"to function ".concat(r,": ").concat(n.message))}var pDe="DenseMatrix",mDe=["Matrix","config"],gDe=ie(pDe,mDe,n=>{var{Matrix:e,config:t}=n;function r(h,d){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(d&&!Qr(d))throw new Error("Invalid datatype: "+d);if(Dt(h))h.type==="DenseMatrix"?(this._data=Ut(h._data),this._size=Ut(h._size),this._datatype=d||h._datatype):(this._data=h.toArray(),this._size=h.size(),this._datatype=d||h._datatype);else if(h&&Wn(h.data)&&Wn(h.size))this._data=h.data,this._size=h.size,a$(this._data,this._size),this._datatype=d||h.datatype;else if(Wn(h))this._data=c(h),this._size=Vt(this._data),a$(this._data,this._size),this._datatype=d;else{if(h)throw new TypeError("Unsupported type of data ("+Kn(h)+")");this._data=[],this._size=[0],this._datatype=d}}r.prototype=new e,r.prototype.createDenseMatrix=function(h,d){return new r(h,d)},Object.defineProperty(r,"name",{value:"DenseMatrix"}),r.prototype.constructor=r,r.prototype.type="DenseMatrix",r.prototype.isDenseMatrix=!0,r.prototype.getDataType=function(){return LN(this._data,Kn)},r.prototype.storage=function(){return"dense"},r.prototype.datatype=function(){return this._datatype},r.prototype.create=function(h,d){return new r(h,d)},r.prototype.subset=function(h,d,f){switch(arguments.length){case 1:return i(this,h);case 2:case 3:return a(this,h,d,f);default:throw new SyntaxError("Wrong number of arguments")}},r.prototype.get=function(h){return VD(this._data,h)},r.prototype.set=function(h,d,f){if(!Wn(h))throw new TypeError("Array expected");if(h.length<this._size.length)throw new en(h.length,this._size.length,"<");var p,m,y,v=h.map(function(x){return x+1});u(this,v,f);var b=this._data;for(p=0,m=h.length-1;p<m;p++)y=h[p],ir(y,b.length),b=b[y];return y=h[h.length-1],ir(y,b.length),b[y]=d,this};function i(h,d){if(!CN(d))throw new TypeError("Invalid index");var f=t.legacySubset?d.size().every(_=>_===1):d.isScalar();if(f)return h.get(d.min());var p=d.size();if(p.length!==h._size.length)throw new en(p.length,h._size.length);for(var m=d.min(),y=d.max(),v=0,b=h._size.length;v<b;v++)ir(m[v],h._size[v]),ir(y[v],h._size[v]);var x=new r,w=s(h._data,d);return x._size=w.size,x._datatype=h._datatype,x._data=w.data,t.legacySubset?x.reshape(d.size()):x}function s(h,d){var f=d.size().length-1,p=Array(f);return{data:m(h),size:p.filter(y=>y!==null)};function m(y){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=d.dimension(v);function x(w,_){return Tt(w)?_(w):w.map(_).valueOf()}return Tt(b)?p[v]=null:p[v]=b.size()[0],v<f?x(b,w=>(ir(w,y.length),m(y[w],v+1))):x(b,w=>(ir(w,y.length),y[w]))}}function a(h,d,f,p){if(!d||d.isIndex!==!0)throw new TypeError("Invalid index");var m=d.size(),y=d.isScalar(),v;if(Dt(f)?(v=f.size(),f=f.valueOf()):v=Vt(f),y){if(v.length!==0)throw new TypeError("Scalar expected");h.set(d.min(),f,p)}else{if(!yd(v,m)){if(v.length===0)f=qm([f],m);else try{f=qm(f,m)}catch{}v=Vt(f)}if(m.length<h._size.length)throw new en(m.length,h._size.length,"<");if(v.length<m.length){for(var b=0,x=0;m[b]===1&&v[b]===1;)b++;for(;m[b]===1;)x++,b++;f=Nte(f,m.length,x,v)}if(!yd(m,v))throw new en(m,v,">");var w=d.max().map(function(_){return _+1});u(h,w,p),o(h._data,d,f)}return h}function o(h,d,f){var p=d.size().length-1;m(h,f);function m(y,v){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,x=d.dimension(b),w=(E,A)=>{ir(E,y.length),m(y[E],v[A[0]],b+1)},_=(E,A)=>{ir(E,y.length),y[E]=v[A[0]]};b<p?Tt(x)?w(x,[0]):x.forEach(w):Tt(x)?_(x,[0]):x.forEach(_)}}r.prototype.resize=function(h,d,f){if(!zo(h))throw new TypeError("Array or Matrix expected");var p=h.valueOf().map(y=>Array.isArray(y)&&y.length===1?y[0]:y),m=f?this.clone():this;return l(m,p,d)};function l(h,d,f){if(d.length===0){for(var p=h._data;Wn(p);)p=p[0];return p}return h._size=d.slice(0),h._data=Eb(h._data,h._size,f),h}r.prototype.reshape=function(h,d){var f=d?this.clone():this;f._data=K4(f._data,h);var p=f._size.reduce((m,y)=>m*y);return f._size=Y4(h,p),f};function u(h,d,f){for(var p=h._size.slice(0),m=!1;p.length<d.length;)p.push(0),m=!0;for(var y=0,v=d.length;y<v;y++)d[y]>p[y]&&(p[y]=d[y],m=!0);m&&l(h,p,f)}r.prototype.clone=function(){var h=new r({data:Ut(this._data),size:Ut(this._size),datatype:this._datatype});return h},r.prototype.size=function(){return this._size.slice(0)},r.prototype.map=function(h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,f=this,p=f._size.length-1;if(p<0)return f.clone();var m=Rv(h,f,"map",d),y=m.fn,v=f.create(void 0,f._datatype);if(v._size=f._size,d||m.isUnary)return v._data=A(f._data),v;if(p===0){for(var b=f.valueOf(),x=Array(b.length),w=0;w<b.length;w++)x[w]=y(b[w],[w],f);return v._data=x,v}var _=[];return v._data=E(f._data),v;function E(T){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,M=Array(T.length);if(S<p)for(var D=0;D<T.length;D++)_[S]=D,M[D]=E(T[D],S+1);else for(var N=0;N<T.length;N++)_[S]=N,M[N]=y(T[N],_.slice(),f);return M}function A(T){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,M=Array(T.length);if(S<p)for(var D=0;D<T.length;D++)M[D]=A(T[D],S+1);else for(var N=0;N<T.length;N++)M[N]=y(T[N]);return M}},r.prototype.forEach=function(h){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,f=this,p=f._size.length-1;if(p<0)return;var m=Rv(h,f,"map",d),y=m.fn;if(d||m.isUnary){w(f._data);return}if(p===0){for(var v=0;v<f._data.length;v++)y(f._data[v],[v],f);return}var b=[];x(f._data);function x(_){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(E<p)for(var A=0;A<_.length;A++)b[E]=A,x(_[A],E+1);else for(var T=0;T<_.length;T++)b[E]=T,y(_[T],b.slice(),f)}function w(_){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(E<p)for(var A=0;A<_.length;A++)w(_[A],E+1);else for(var T=0;T<_.length;T++)y(_[T])}},r.prototype[Symbol.iterator]=function*(){var h=this._size.length-1;if(!(h<0)){if(h===0){for(var d=0;d<this._data.length;d++)yield{value:this._data[d],index:[d]};return}for(var f=Array(h+1).fill(0),p=this._size.reduce((x,w)=>x*w,1),m=0;m<p;m++){for(var y=this._data,v=0;v<h;v++)y=y[f[v]];yield{value:y[f[h]],index:f.slice()};for(var b=h;b>=0&&(f[b]++,!(f[b]<this._size[b]));b--)f[b]=0}}},r.prototype.rows=function(){var h=[],d=this.size();if(d.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");var f=this._data;for(var p of f)h.push(new r([p],this._datatype));return h},r.prototype.columns=function(){var h=this,d=[],f=this.size();if(f.length!==2)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var p=this._data,m=function(b){var x=p.map(w=>[w[b]]);d.push(new r(x,h._datatype))},y=0;y<f[1];y++)m(y);return d},r.prototype.toArray=function(){return Ut(this._data)},r.prototype.valueOf=function(){return this._data},r.prototype.format=function(h){return nn(this._data,h)},r.prototype.toString=function(){return nn(this._data)},r.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.prototype.diagonal=function(h){if(h){if(jt(h)&&(h=h.toNumber()),!Tt(h)||!bt(h))throw new TypeError("The parameter k must be an integer number")}else h=0;for(var d=h>0?h:0,f=h<0?-h:0,p=this._size[0],m=this._size[1],y=Math.min(p-f,m-d),v=[],b=0;b<y;b++)v[b]=this._data[b+f][b+d];return new r({data:v,size:[y],datatype:this._datatype})},r.diagonal=function(h,d,f,p){if(!Wn(h))throw new TypeError("Array expected, size parameter");if(h.length!==2)throw new Error("Only two dimensions matrix are supported");if(h=h.map(function(T){if(jt(T)&&(T=T.toNumber()),!Tt(T)||!bt(T)||T<1)throw new Error("Size values must be positive integers");return T}),f){if(jt(f)&&(f=f.toNumber()),!Tt(f)||!bt(f))throw new TypeError("The parameter k must be an integer number")}else f=0;var m=f>0?f:0,y=f<0?-f:0,v=h[0],b=h[1],x=Math.min(v-y,b-m),w;if(Wn(d)){if(d.length!==x)throw new Error("Invalid value array length");w=function(S){return d[S]}}else if(Dt(d)){var _=d.size();if(_.length!==1||_[0]!==x)throw new Error("Invalid matrix length");w=function(S){return d.get([S])}}else w=function(){return d};p||(p=jt(w(0))?w(0).mul(0):0);var E=[];if(h.length>0){E=Eb(E,h,p);for(var A=0;A<x;A++)E[A+y][A+m]=w(A)}return new r({data:E,size:[v,b]})},r.fromJSON=function(h){return new r(h)},r.prototype.swapRows=function(h,d){if(!Tt(h)||!bt(h)||!Tt(d)||!bt(d))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return ir(h,this._size[0]),ir(d,this._size[0]),r._swapRows(h,d,this._data),this},r._swapRows=function(h,d,f){var p=f[h];f[h]=f[d],f[d]=p};function c(h){return Dt(h)?c(h.valueOf()):Wn(h)?h.map(c):h}return r},{isClass:!0}),h$="clone",vDe=["typed"],yDe=ie(h$,vDe,n=>{var{typed:e}=n;return e(h$,{any:Ut})});function kte(n){var e=n.length,t=n[0].length,r,i,s=[];for(i=0;i<t;i++){var a=[];for(r=0;r<e;r++)a.push(n[r][i]);s.push(a)}return s}function Wb(n){for(var e=0;e<n.length;e++)if(zo(n[e]))return!0;return!1}function kp(n,e){Dt(n)?n.forEach(t=>e(t),!1,!0):Ote(n,e,!0)}function qt(n,e,t){if(!t)return Dt(n)?n.map(i=>e(i),!1,!0):SO(n,e,!0);var r=i=>i===0?i:e(i);return Dt(n)?n.map(i=>r(i),!1,!0):SO(n,r,!0)}function ON(n,e,t){var r=Array.isArray(n)?Vt(n):n.size();if(e<0||e>=r.length)throw new yu(e,r.length);return Dt(n)?n.create(zD(n.valueOf(),e,t),n.datatype()):zD(n,e,t)}function zD(n,e,t){var r,i,s,a;if(e<=0)if(Array.isArray(n[0])){for(a=kte(n),i=[],r=0;r<a.length;r++)i[r]=zD(a[r],e-1,t);return i}else{for(s=n[0],r=1;r<n.length;r++)s=t(s,n[r]);return s}else{for(i=[],r=0;r<n.length;r++)i[r]=zD(n[r],e-1,t);return i}}function d$(n,e,t,r,i,s,a,o,l,u,c){var h=n._values,d=n._index,f=n._ptr,p,m,y,v;if(r)for(m=f[e],y=f[e+1],p=m;p<y;p++)v=d[p],t[v]!==s?(t[v]=s,a.push(v),r[v]=h[p]):(r[v]=o(r[v],h[p]),i[v]=s);else for(m=f[e],y=f[e+1],p=m;p<y;p++)v=d[p],t[v]!==s?(t[v]=s,a.push(v)):i[v]=s}var f$="isInteger",xDe=["typed","equal"],bDe=ie(f$,xDe,n=>{var{typed:e,equal:t}=n;return e(f$,{number:r=>Number.isFinite(r)?t(r,Math.round(r)):!1,BigNumber:r=>r.isFinite()?t(r.round(),r):!1,bigint:r=>!0,Fraction:r=>r.d===1n,"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))})}),xu="number",Xb="number, number";function Bte(n){return Math.abs(n)}Bte.signature=xu;function Ute(n,e){return n+e}Ute.signature=Xb;function Vte(n,e){return n-e}Vte.signature=Xb;function zte(n,e){return n*e}zte.signature=Xb;function $te(n){return-n}$te.signature=xu;function Hte(n){return n}Hte.signature=xu;function f1(n){return wMe(n)}f1.signature=xu;function Gte(n){return n*n*n}Gte.signature=xu;function jte(n){return Math.exp(n)}jte.signature=xu;function qte(n){return EMe(n)}qte.signature=xu;function Wte(n,e){if(!bt(n)||!bt(e))throw new Error("Parameters in function lcm must be integer numbers");if(n===0||e===0)return 0;for(var t,r=n*e;e!==0;)t=e,e=n%t,n=t;return Math.abs(r/n)}Wte.signature=Xb;function p$(n,e){return e?Math.log(n)/Math.log(e):Math.log(n)}function $D(n){return bMe(n)}$D.signature=xu;function AO(n){return xMe(n)}AO.signature=xu;function m$(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,t=e<0;if(t&&(e=-e),e===0)throw new Error("Root must be non-zero");if(n<0&&Math.abs(e)%2!==1)throw new Error("Root must be odd when a is negative.");if(n===0)return t?1/0:0;if(!isFinite(n))return t?0:n;var r=Math.pow(Math.abs(n),1/e);return r=n<0?-r:r,t?1/r:r}function TO(n){return np(n)}TO.signature=xu;function Xte(n){return n*n}Xte.signature=xu;function Kte(n,e){var t,r,i,s=0,a=1,o=1,l=0;if(!bt(n)||!bt(e))throw new Error("Parameters in function xgcd must be integer numbers");for(;e;)r=Math.floor(n/e),i=n-r*e,t=s,s=a-r*s,a=t,t=o,o=l-r*o,l=t,n=e,e=i;var u;return n<0?u=[-n,-a,-l]:u=[n,n?a:0,l],u}Kte.signature=Xb;function Yte(n,e){return n*n<1&&e===1/0||n*n>1&&e===-1/0?0:Math.pow(n,e)}Yte.signature=Xb;function N_(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!bt(e)||e<0||e>15)throw new Error("Number of decimals in function round must be an integer from 0 to 15 inclusive");return parseFloat(dte(n,e))}var _De="number",Kb="number, number";function Qte(n,e){if(!bt(n)||!bt(e))throw new Error("Integers expected in function bitAnd");return n&e}Qte.signature=Kb;function Zte(n){if(!bt(n))throw new Error("Integer expected in function bitNot");return~n}Zte.signature=_De;function Jte(n,e){if(!bt(n)||!bt(e))throw new Error("Integers expected in function bitOr");return n|e}Jte.signature=Kb;function ene(n,e){if(!bt(n)||!bt(e))throw new Error("Integers expected in function bitXor");return n^e}ene.signature=Kb;function tne(n,e){if(!bt(n)||!bt(e))throw new Error("Integers expected in function leftShift");return n<<e}tne.signature=Kb;function nne(n,e){if(!bt(n)||!bt(e))throw new Error("Integers expected in function rightArithShift");return n>>e}nne.signature=Kb;function rne(n,e){if(!bt(n)||!bt(e))throw new Error("Integers expected in function rightLogShift");return n>>>e}rne.signature=Kb;function Gh(n,e){if(e<n)return 1;if(e===n)return e;var t=e+n>>1;return Gh(n,t)*Gh(t+1,e)}function ine(n,e){if(!bt(n)||n<0)throw new TypeError("Positive integer value expected in function combinations");if(!bt(e)||e<0)throw new TypeError("Positive integer value expected in function combinations");if(e>n)throw new TypeError("k must be less than or equal to n");for(var t=n-e,r=1,i=e<t?t+1:e+1,s=2,a=e<t?e:t,o=i;o<=n;++o)for(r*=o;s<=a&&r%s===0;)r/=s,++s;return s<=a&&(r/=Gh(s,a)),r}ine.signature="number, number";var wDe=Math.PI,EDe=2*Math.PI,SDe=Math.E,ADe=1.618033988749895,TDe="number",Q4="number, number";function sne(n){return!n}sne.signature=TDe;function MO(n,e){return!!(n||e)}MO.signature=Q4;function CO(n,e){return!!n!=!!e}CO.signature=Q4;function DO(n,e){return!!(n&&e)}DO.signature=Q4;function HD(n){var e;if(bt(n))return n<=0?Number.isFinite(n)?1/0:NaN:n>171?1/0:Gh(1,n-1);if(n<.5)return Math.PI/(Math.sin(Math.PI*n)*HD(1-n));if(n>=171.35)return 1/0;if(n>85){var t=n*n,r=t*n,i=r*n,s=i*n;return Math.sqrt(2*Math.PI/n)*Math.pow(n/Math.E,n)*(1+1/(12*n)+1/(288*t)-139/(51840*r)-571/(2488320*i)+163879/(209018880*s)+5246819/(75246796800*s*n))}--n,e=Cy[0];for(var a=1;a<Cy.length;++a)e+=Cy[a]/(n+a);var o=n+ane+.5;return Math.sqrt(2*Math.PI)*Math.pow(o,n+.5)*Math.exp(-o)*e}HD.signature="number";var ane=4.7421875,Cy=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],one=.9189385332046728,MDe=5,CDe=7,g$=[1.000000000190015,76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];function GD(n){if(n<0)return NaN;if(n===0)return 1/0;if(!Number.isFinite(n))return n;if(n<.5)return Math.log(Math.PI/Math.sin(Math.PI*n))-GD(1-n);n=n-1;for(var e=n+MDe+.5,t=g$[0],r=CDe-1;r>=1;r--)t+=g$[r]/(n+r);return one+(n+.5)*Math.log(e)-e+Math.log(t)}GD.signature="number";var ra="number";function lne(n){return MMe(n)}lne.signature=ra;function une(n){return Math.atan(1/n)}une.signature=ra;function cne(n){return Number.isFinite(n)?(Math.log((n+1)/n)+Math.log(n/(n-1)))/2:0}cne.signature=ra;function hne(n){return Math.asin(1/n)}hne.signature=ra;function dne(n){var e=1/n;return Math.log(e+Math.sqrt(e*e+1))}dne.signature=ra;function fne(n){return Math.acos(1/n)}fne.signature=ra;function pne(n){var e=1/n,t=Math.sqrt(e*e-1);return Math.log(t+e)}pne.signature=ra;function mne(n){return CMe(n)}mne.signature=ra;function gne(n){return DMe(n)}gne.signature=ra;function vne(n){return 1/Math.tan(n)}vne.signature=ra;function yne(n){var e=Math.exp(2*n);return(e+1)/(e-1)}yne.signature=ra;function xne(n){return 1/Math.sin(n)}xne.signature=ra;function bne(n){return n===0?Number.POSITIVE_INFINITY:Math.abs(2/(Math.exp(n)-Math.exp(-n)))*np(n)}bne.signature=ra;function _ne(n){return 1/Math.cos(n)}_ne.signature=ra;function wne(n){return 2/(Math.exp(n)+Math.exp(-n))}wne.signature=ra;function Ene(n){return RMe(n)}Ene.signature=ra;var Z4="number";function Sne(n){return n<0}Sne.signature=Z4;function Ane(n){return n>0}Ane.signature=Z4;function Tne(n){return Number.isNaN(n)}Tne.signature=Z4;function Dl(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e-9,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(t<=0)throw new Error("Relative tolerance must be greater than 0");if(r<0)throw new Error("Absolute tolerance must be at least 0");return n.isNaN()||e.isNaN()?!1:!n.isFinite()||!e.isFinite()?n.eq(e):n.eq(e)?!0:n.minus(e).abs().lte(n.constructor.max(n.constructor.max(n.abs(),e.abs()).mul(t),r))}var v$="isNegative",DDe=["typed","config"],NDe=ie(v$,DDe,n=>{var{typed:e,config:t}=n;return e(v$,{number:r=>as(r,0,t.relTol,t.absTol)?!1:Sne(r),BigNumber:r=>Dl(r,new r.constructor(0),t.relTol,t.absTol)?!1:r.isNeg()&&!r.isZero()&&!r.isNaN(),bigint:r=>r<0n,Fraction:r=>r.s<0n,Unit:e.referToSelf(r=>i=>e.find(r,i.valueType())(i.value)),"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))})}),y$="isNumeric",RDe=["typed"],IDe=ie(y$,RDe,n=>{var{typed:e}=n;return e(y$,{"number | BigNumber | bigint | Fraction | boolean":()=>!0,"Complex | Unit | string | null | undefined | Node":()=>!1,"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),x$="hasNumericValue",PDe=["typed","isNumeric"],FDe=ie(x$,PDe,n=>{var{typed:e,isNumeric:t}=n;return e(x$,{boolean:()=>!0,string:function(i){return i.trim().length>0&&!isNaN(Number(i))},any:function(i){return t(i)}})}),b$="isPositive",LDe=["typed","config"],ODe=ie(b$,LDe,n=>{var{typed:e,config:t}=n;return e(b$,{number:r=>as(r,0,t.relTol,t.absTol)?!1:Ane(r),BigNumber:r=>Dl(r,new r.constructor(0),t.relTol,t.absTol)?!1:!r.isNeg()&&!r.isZero()&&!r.isNaN(),bigint:r=>r>0n,Fraction:r=>r.s>0n&&r.n>0n,Unit:e.referToSelf(r=>i=>e.find(r,i.valueType())(i.value)),"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))})}),_$="isZero",kDe=["typed","equalScalar"],BDe=ie(_$,kDe,n=>{var{typed:e,equalScalar:t}=n;return e(_$,{"number | BigNumber | Complex | Fraction":r=>t(r,0),bigint:r=>r===0n,Unit:e.referToSelf(r=>i=>e.find(r,i.valueType())(i.value)),"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))})}),w$="isNaN",UDe=["typed"],VDe=ie(w$,UDe,n=>{var{typed:e}=n;return e(w$,{number:Tne,BigNumber:function(r){return r.isNaN()},bigint:function(r){return!1},Fraction:function(r){return!1},Complex:function(r){return r.isNaN()},Unit:function(r){return Number.isNaN(r.value)},"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),E$="isBounded",zDe=["typed"],$De=ie(E$,zDe,n=>{var{typed:e}=n;return e(E$,{number:t=>Number.isFinite(t),"BigNumber | Complex":t=>t.isFinite(),"bigint | Fraction":()=>!0,"null | undefined":()=>!1,Unit:e.referToSelf(t=>r=>t(r.value)),"Array | Matrix":e.referToSelf(t=>r=>(Array.isArray(r)||(r=r.valueOf()),r.every(i=>t(i))))})}),S$="isFinite",HDe=["typed","isBounded","map"],GDe=ie(S$,HDe,n=>{var{typed:e,isBounded:t,map:r}=n;return e(S$,{"Array | Matrix":i=>r(i,t),any:i=>t(i)})}),A$="typeOf",jDe=["typed"],qDe=ie(A$,jDe,n=>{var{typed:e}=n;return e(A$,{any:Kn})});function WDe(n,e,t,r){return as(n.re,e.re,t,r)&&as(n.im,e.im,t,r)}var Yb=ie("compareUnits",["typed"],n=>{var{typed:e}=n;return{"Unit, Unit":e.referToSelf(t=>(r,i)=>{if(!r.equalBase(i))throw new Error("Cannot compare units with different base");return e.find(t,[r.valueType(),i.valueType()])(r.value,i.value)})}}),jD="equalScalar",XDe=["typed","config"],KDe=ie(jD,XDe,n=>{var{typed:e,config:t}=n,r=Yb({typed:e});return e(jD,{"boolean, boolean":function(s,a){return s===a},"number, number":function(s,a){return as(s,a,t.relTol,t.absTol)},"BigNumber, BigNumber":function(s,a){return s.eq(a)||Dl(s,a,t.relTol,t.absTol)},"bigint, bigint":function(s,a){return s===a},"Fraction, Fraction":function(s,a){return s.equals(a)},"Complex, Complex":function(s,a){return WDe(s,a,t.relTol,t.absTol)}},r)});ie(jD,["typed","config"],n=>{var{typed:e,config:t}=n;return e(jD,{"number, number":function(i,s){return as(i,s,t.relTol,t.absTol)}})});var YDe="SparseMatrix",QDe=["typed","equalScalar","Matrix"],ZDe=ie(YDe,QDe,n=>{var{typed:e,equalScalar:t,Matrix:r}=n;function i(m,y){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(y&&!Qr(y))throw new Error("Invalid datatype: "+y);if(Dt(m))s(this,m,y);else if(m&&Wn(m.index)&&Wn(m.ptr)&&Wn(m.size))this._values=m.values,this._index=m.index,this._ptr=m.ptr,this._size=m.size,this._datatype=y||m.datatype;else if(Wn(m))a(this,m,y);else{if(m)throw new TypeError("Unsupported type of data ("+Kn(m)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=y}}function s(m,y,v){y.type==="SparseMatrix"?(m._values=y._values?Ut(y._values):void 0,m._index=Ut(y._index),m._ptr=Ut(y._ptr),m._size=Ut(y._size),m._datatype=v||y._datatype):a(m,y.valueOf(),v||y._datatype)}function a(m,y,v){m._values=[],m._index=[],m._ptr=[],m._datatype=v;var b=y.length,x=0,w=t,_=0;if(Qr(v)&&(w=e.find(t,[v,v])||t,_=e.convert(0,v)),b>0){var E=0;do{m._ptr.push(m._index.length);for(var A=0;A<b;A++){var T=y[A];if(Wn(T)){if(E===0&&x<T.length&&(x=T.length),E<T.length){var S=T[E];w(S,_)||(m._values.push(S),m._index.push(A))}}else E===0&&x<1&&(x=1),w(T,_)||(m._values.push(T),m._index.push(A))}E++}while(E<x)}for(;m._ptr.length<=x;)m._ptr.push(m._index.length);m._size=[b,x]}i.prototype=new r,i.prototype.createSparseMatrix=function(m,y){return new i(m,y)},Object.defineProperty(i,"name",{value:"SparseMatrix"}),i.prototype.constructor=i,i.prototype.type="SparseMatrix",i.prototype.isSparseMatrix=!0,i.prototype.getDataType=function(){return LN(this._values,Kn)},i.prototype.storage=function(){return"sparse"},i.prototype.datatype=function(){return this._datatype},i.prototype.create=function(m,y){return new i(m,y)},i.prototype.density=function(){var m=this._size[0],y=this._size[1];return m!==0&&y!==0?this._index.length/(m*y):0},i.prototype.subset=function(m,y,v){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return o(this,m);case 2:case 3:return l(this,m,y,v);default:throw new SyntaxError("Wrong number of arguments")}};function o(m,y){if(!CN(y))throw new TypeError("Invalid index");var v=y.isScalar();if(v)return m.get(y.min());var b=y.size();if(b.length!==m._size.length)throw new en(b.length,m._size.length);var x,w,_,E,A=y.min(),T=y.max();for(x=0,w=m._size.length;x<w;x++)ir(A[x],m._size[x]),ir(T[x],m._size[x]);var S=m._values,M=m._index,D=m._ptr,N=y.dimension(0),R=y.dimension(1),z=[],j=[];function I(J,ee){j[J]=ee[0],z[J]=!0}Number.isInteger(N)?I(N,[0]):N.forEach(I);var F=S?[]:void 0,$=[],H=[];function Z(J){for(H.push($.length),_=D[J],E=D[J+1];_<E;_++)x=M[_],z[x]===!0&&($.push(j[x]),F&&F.push(S[_]))}return Number.isInteger(R)?Z(R):R.forEach(Z),H.push($.length),new i({values:F,index:$,ptr:H,size:b,datatype:m._datatype})}function l(m,y,v,b){if(!y||y.isIndex!==!0)throw new TypeError("Invalid index");var x=y.size(),w=y.isScalar(),_;if(Dt(v)?(_=v.size(),v=v.toArray()):_=Vt(v),w){if(_.length!==0)throw new TypeError("Scalar expected");m.set(y.min(),v,b)}else{if(x.length!==1&&x.length!==2)throw new en(x.length,m._size.length,"<");if(_.length<x.length){for(var E=0,A=0;x[E]===1&&_[E]===1;)E++;for(;x[E]===1;)A++,E++;v=Nte(v,x.length,A,_)}if(!yd(x,_))throw new en(x,_,">");if(x.length===1){var T=y.dimension(0);D(T,(N,R)=>{ir(N),m.set([N,0],v[R[0]],b)})}else{var S=y.dimension(0),M=y.dimension(1);D(S,(N,R)=>{ir(N),D(M,(z,j)=>{ir(z),m.set([N,z],v[R[0]][j[0]],b)})})}}return m;function D(N,R){Tt(N)?R(N,[0]):N.forEach(R)}}i.prototype.get=function(m){if(!Wn(m))throw new TypeError("Array expected");if(m.length!==this._size.length)throw new en(m.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var y=m[0],v=m[1];ir(y,this._size[0]),ir(v,this._size[1]);var b=u(y,this._ptr[v],this._ptr[v+1],this._index);return b<this._ptr[v+1]&&this._index[b]===y?this._values[b]:0},i.prototype.set=function(m,y,v){if(!Wn(m))throw new TypeError("Array expected");if(m.length!==this._size.length)throw new en(m.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var b=m[0],x=m[1],w=this._size[0],_=this._size[1],E=t,A=0;Qr(this._datatype)&&(E=e.find(t,[this._datatype,this._datatype])||t,A=e.convert(0,this._datatype)),(b>w-1||x>_-1)&&(d(this,Math.max(b+1,w),Math.max(x+1,_),v),w=this._size[0],_=this._size[1]),ir(b,w),ir(x,_);var T=u(b,this._ptr[x],this._ptr[x+1],this._index);return T<this._ptr[x+1]&&this._index[T]===b?E(y,A)?c(T,x,this._values,this._index,this._ptr):this._values[T]=y:E(y,A)||h(T,b,x,y,this._values,this._index,this._ptr),this};function u(m,y,v,b){if(v-y===0)return v;for(var x=y;x<v;x++)if(b[x]===m)return x;return y}function c(m,y,v,b,x){v.splice(m,1),b.splice(m,1);for(var w=y+1;w<x.length;w++)x[w]--}function h(m,y,v,b,x,w,_){x.splice(m,0,b),w.splice(m,0,y);for(var E=v+1;E<_.length;E++)_[E]++}i.prototype.resize=function(m,y,v){if(!zo(m))throw new TypeError("Array or Matrix expected");var b=m.valueOf().map(w=>Array.isArray(w)&&w.length===1?w[0]:w);if(b.length!==2)throw new Error("Only two dimensions matrix are supported");b.forEach(function(w){if(!Tt(w)||!bt(w)||w<0)throw new TypeError("Invalid size, must contain positive integers (size: "+nn(b)+")")});var x=v?this.clone():this;return d(x,b[0],b[1],y)};function d(m,y,v,b){var x=b||0,w=t,_=0;Qr(m._datatype)&&(w=e.find(t,[m._datatype,m._datatype])||t,_=e.convert(0,m._datatype),x=e.convert(x,m._datatype));var E=!w(x,_),A=m._size[0],T=m._size[1],S,M,D;if(v>T){for(M=T;M<v;M++)if(m._ptr[M]=m._values.length,E)for(S=0;S<A;S++)m._values.push(x),m._index.push(S);m._ptr[v]=m._values.length}else v<T&&(m._ptr.splice(v+1,T-v),m._values.splice(m._ptr[v],m._values.length),m._index.splice(m._ptr[v],m._index.length));if(T=v,y>A){if(E){var N=0;for(M=0;M<T;M++){m._ptr[M]=m._ptr[M]+N,D=m._ptr[M+1]+N;var R=0;for(S=A;S<y;S++,R++)m._values.splice(D+R,0,x),m._index.splice(D+R,0,S),N++}m._ptr[T]=m._values.length}}else if(y<A){var z=0;for(M=0;M<T;M++){m._ptr[M]=m._ptr[M]-z;var j=m._ptr[M],I=m._ptr[M+1]-z;for(D=j;D<I;D++)S=m._index[D],S>y-1&&(m._values.splice(D,1),m._index.splice(D,1),z++)}m._ptr[M]=m._values.length}return m._size[0]=y,m._size[1]=v,m}i.prototype.reshape=function(m,y){if(!Wn(m))throw new TypeError("Array expected");if(m.length!==2)throw new Error("Sparse matrices can only be reshaped in two dimensions");m.forEach(function(H){if(!Tt(H)||!bt(H)||H<=-2||H===0)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+nn(m)+")")});var v=this._size[0]*this._size[1];m=Y4(m,v);var b=m[0]*m[1];if(v!==b)throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var x=y?this.clone():this;if(this._size[0]===m[0]&&this._size[1]===m[1])return x;for(var w=[],_=0;_<x._ptr.length;_++)for(var E=0;E<x._ptr[_+1]-x._ptr[_];E++)w.push(_);for(var A=x._values.slice(),T=x._index.slice(),S=0;S<x._index.length;S++){var M=T[S],D=w[S],N=M*x._size[1]+D;w[S]=N%m[1],T[S]=Math.floor(N/m[1])}x._values.length=0,x._index.length=0,x._ptr.length=m[1]+1,x._size=m.slice();for(var R=0;R<x._ptr.length;R++)x._ptr[R]=0;for(var z=0;z<A.length;z++){var j=T[z],I=w[z],F=A[z],$=u(j,x._ptr[I],x._ptr[I+1],x._index);h($,j,I,F,x._values,x._index,x._ptr)}return x},i.prototype.clone=function(){var m=new i({values:this._values?Ut(this._values):void 0,index:Ut(this._index),ptr:Ut(this._ptr),size:Ut(this._size),datatype:this._datatype});return m},i.prototype.size=function(){return this._size.slice(0)},i.prototype.map=function(m,y){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var v=this,b=this._size[0],x=this._size[1],w=Rv(m,v,"map"),_=function(A,T,S){return w.fn(A,[T,S],v)};return f(this,0,b-1,0,x-1,_,y)};function f(m,y,v,b,x,w,_){var E=[],A=[],T=[],S=t,M=0;Qr(m._datatype)&&(S=e.find(t,[m._datatype,m._datatype])||t,M=e.convert(0,m._datatype));for(var D=function(O,ue,Q){var re=w(O,ue,Q);S(re,M)||(E.push(re),A.push(ue))},N=b;N<=x;N++){T.push(E.length);var R=m._ptr[N],z=m._ptr[N+1];if(_)for(var j=R;j<z;j++){var I=m._index[j];I>=y&&I<=v&&D(m._values[j],I-y,N-b)}else{for(var F={},$=R;$<z;$++){var H=m._index[$];F[H]=m._values[$]}for(var Z=y;Z<=v;Z++){var J=Z in F?F[Z]:0;D(J,Z-y,N-b)}}}return T.push(E.length),new i({values:E,index:A,ptr:T,size:[v-y+1,x-b+1]})}i.prototype.forEach=function(m,y){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var v=this,b=this._size[0],x=this._size[1],w=Rv(m,v,"forEach"),_=0;_<x;_++){var E=this._ptr[_],A=this._ptr[_+1];if(y)for(var T=E;T<A;T++){var S=this._index[T];w.fn(this._values[T],[S,_],v)}else{for(var M={},D=E;D<A;D++){var N=this._index[D];M[N]=this._values[D]}for(var R=0;R<b;R++){var z=R in M?M[R]:0;w.fn(z,[R,_],v)}}}},i.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var m=this._size[1],y=0;y<m;y++)for(var v=this._ptr[y],b=this._ptr[y+1],x=v;x<b;x++){var w=this._index[x];yield{value:this._values[x],index:[w,y]}}},i.prototype.toArray=function(){return p(this._values,this._index,this._ptr,this._size,!0)},i.prototype.valueOf=function(){return p(this._values,this._index,this._ptr,this._size,!1)};function p(m,y,v,b,x){var w=b[0],_=b[1],E=[],A,T;for(A=0;A<w;A++)for(E[A]=[],T=0;T<_;T++)E[A][T]=0;for(T=0;T<_;T++)for(var S=v[T],M=v[T+1],D=S;D<M;D++)A=y[D],E[A][T]=m?x?Ut(m[D]):m[D]:1;return E}return i.prototype.format=function(m){for(var y=this._size[0],v=this._size[1],b=this.density(),x="Sparse Matrix ["+nn(y,m)+" x "+nn(v,m)+"] density: "+nn(b,m)+`
`,w=0;w<v;w++)for(var _=this._ptr[w],E=this._ptr[w+1],A=_;A<E;A++){var T=this._index[A];x+=`
    (`+nn(T,m)+", "+nn(w,m)+") ==> "+(this._values?nn(this._values[A],m):"X")}return x},i.prototype.toString=function(){return nn(this.toArray())},i.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},i.prototype.diagonal=function(m){if(m){if(jt(m)&&(m=m.toNumber()),!Tt(m)||!bt(m))throw new TypeError("The parameter k must be an integer number")}else m=0;var y=m>0?m:0,v=m<0?-m:0,b=this._size[0],x=this._size[1],w=Math.min(b-v,x-y),_=[],E=[],A=[];A[0]=0;for(var T=y;T<x&&_.length<w;T++)for(var S=this._ptr[T],M=this._ptr[T+1],D=S;D<M;D++){var N=this._index[D];if(N===T-y+v){_.push(this._values[D]),E[_.length-1]=N-v;break}}return A.push(_.length),new i({values:_,index:E,ptr:A,size:[w,1]})},i.fromJSON=function(m){return new i(m)},i.diagonal=function(m,y,v,b,x){if(!Wn(m))throw new TypeError("Array expected, size parameter");if(m.length!==2)throw new Error("Only two dimensions matrix are supported");if(m=m.map(function(H){if(jt(H)&&(H=H.toNumber()),!Tt(H)||!bt(H)||H<1)throw new Error("Size values must be positive integers");return H}),v){if(jt(v)&&(v=v.toNumber()),!Tt(v)||!bt(v))throw new TypeError("The parameter k must be an integer number")}else v=0;var w=t,_=0;Qr(x)&&(w=e.find(t,[x,x])||t,_=e.convert(0,x));var E=v>0?v:0,A=v<0?-v:0,T=m[0],S=m[1],M=Math.min(T-A,S-E),D;if(Wn(y)){if(y.length!==M)throw new Error("Invalid value array length");D=function(Z){return y[Z]}}else if(Dt(y)){var N=y.size();if(N.length!==1||N[0]!==M)throw new Error("Invalid matrix length");D=function(Z){return y.get([Z])}}else D=function(){return y};for(var R=[],z=[],j=[],I=0;I<S;I++){j.push(R.length);var F=I-E;if(F>=0&&F<M){var $=D(F);w($,_)||(z.push(F+A),R.push($))}}return j.push(R.length),new i({values:R,index:z,ptr:j,size:[T,S]})},i.prototype.swapRows=function(m,y){if(!Tt(m)||!bt(m)||!Tt(y)||!bt(y))throw new Error("Row index must be positive integers");if(this._size.length!==2)throw new Error("Only two dimensional matrix is supported");return ir(m,this._size[0]),ir(y,this._size[0]),i._swapRows(m,y,this._size[1],this._values,this._index,this._ptr),this},i._forEachRow=function(m,y,v,b,x){for(var w=b[m],_=b[m+1],E=w;E<_;E++)x(v[E],y[E])},i._swapRows=function(m,y,v,b,x,w){for(var _=0;_<v;_++){var E=w[_],A=w[_+1],T=u(m,E,A,x),S=u(y,E,A,x);if(T<A&&S<A&&x[T]===m&&x[S]===y){if(b){var M=b[T];b[T]=b[S],b[S]=M}continue}if(T<A&&x[T]===m&&(S>=A||x[S]!==y)){var D=b?b[T]:void 0;x.splice(S,0,y),b&&b.splice(S,0,D),x.splice(S<=T?T+1:T,1),b&&b.splice(S<=T?T+1:T,1);continue}if(S<A&&x[S]===y&&(T>=A||x[T]!==m)){var N=b?b[S]:void 0;x.splice(T,0,m),b&&b.splice(T,0,N),x.splice(T<=S?S+1:S,1),b&&b.splice(T<=S?S+1:S,1)}}},i},{isClass:!0}),JDe="number",e2e=["typed"];function t2e(n){var e=n.match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/);if(e){var t={"0b":2,"0o":8,"0x":16}[e[1]],r=e[2],i=e[3];return{input:n,radix:t,integerPart:r,fractionalPart:i}}else return null}function n2e(n){for(var e=parseInt(n.integerPart,n.radix),t=0,r=0;r<n.fractionalPart.length;r++){var i=parseInt(n.fractionalPart[r],n.radix);t+=i/Math.pow(n.radix,r+1)}var s=e+t;if(isNaN(s))throw new SyntaxError('String "'+n.input+'" is not a valid number');return s}var r2e=ie(JDe,e2e,n=>{var{typed:e}=n,t=e("number",{"":function(){return 0},number:function(i){return i},string:function(i){if(i==="NaN")return NaN;var s=t2e(i);if(s)return n2e(s);var a=0,o=i.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);o&&(a=Number(o[2]),i=o[1]);var l=Number(i);if(isNaN(l))throw new SyntaxError('String "'+i+'" is not a valid number');if(o){if(l>2**a-1)throw new SyntaxError('String "'.concat(i,'" is out of range'));l>=2**(a-1)&&(l=l-2**a)}return l},BigNumber:function(i){return i.toNumber()},bigint:function(i){return Number(i)},Fraction:function(i){return i.valueOf()},Unit:e.referToSelf(r=>i=>{var s=i.clone();return s.value=r(i.value),s}),null:function(i){return 0},"Unit, string | Unit":function(i,s){return i.toNumber(s)},"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))});return t.fromJSON=function(r){return parseFloat(r.value)},t}),i2e="bigint",s2e=["typed"],a2e=ie(i2e,s2e,n=>{var{typed:e}=n,t=e("bigint",{"":function(){return 0n},bigint:function(i){return i},number:function(i){return BigInt(i.toFixed())},BigNumber:function(i){return BigInt(i.round().toString())},Fraction:function(i){return BigInt(i.valueOf().toFixed())},"string | boolean":function(i){return BigInt(i)},null:function(i){return 0n},"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))});return t.fromJSON=function(r){return BigInt(r.value)},t}),T$="string",o2e=["typed"],l2e=ie(T$,o2e,n=>{var{typed:e}=n;return e(T$,{"":function(){return""},number:pv,null:function(r){return"null"},boolean:function(r){return r+""},string:function(r){return r},"Array | Matrix":e.referToSelf(t=>r=>qt(r,t)),any:function(r){return String(r)}})}),M$="boolean",u2e=["typed"],c2e=ie(M$,u2e,n=>{var{typed:e}=n;return e(M$,{"":function(){return!1},boolean:function(r){return r},number:function(r){return!!r},null:function(r){return!1},BigNumber:function(r){return!r.isZero()},string:function(r){var i=r.toLowerCase();if(i==="true")return!0;if(i==="false")return!1;var s=Number(r);if(r!==""&&!isNaN(s))return!!s;throw new Error('Cannot convert "'+r+'" to a boolean')},"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),h2e="bignumber",d2e=["typed","BigNumber"],f2e=ie(h2e,d2e,n=>{var{typed:e,BigNumber:t}=n;return e("bignumber",{"":function(){return new t(0)},number:function(i){return new t(i+"")},string:function(i){var s=i.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(s){var a=s[2],o=t(s[1]),l=new t(2).pow(Number(a));if(o.gt(l.sub(1)))throw new SyntaxError('String "'.concat(i,'" is out of range'));var u=new t(2).pow(Number(a)-1);return o.gte(u)?o.sub(l):o}return new t(i)},BigNumber:function(i){return i},bigint:function(i){return new t(i.toString())},Unit:e.referToSelf(r=>i=>{var s=i.clone();return s.value=r(i.value),s}),Fraction:function(i){return new t(String(i.n)).div(String(i.d)).times(String(i.s))},null:function(i){return new t(0)},"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))})}),p2e="complex",m2e=["typed","Complex"],g2e=ie(p2e,m2e,n=>{var{typed:e,Complex:t}=n;return e("complex",{"":function(){return t.ZERO},number:function(i){return new t(i,0)},"number, number":function(i,s){return new t(i,s)},"BigNumber, BigNumber":function(i,s){return new t(i.toNumber(),s.toNumber())},Fraction:function(i){return new t(i.valueOf(),0)},Complex:function(i){return i.clone()},string:function(i){return t(i)},null:function(i){return t(0)},Object:function(i){if("re"in i&&"im"in i)return new t(i.re,i.im);if("r"in i&&"phi"in i||"abs"in i&&"arg"in i)return new t(i);throw new Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))})}),v2e="fraction",y2e=["typed","Fraction"],x2e=ie(v2e,y2e,n=>{var{typed:e,Fraction:t}=n;return e("fraction",{number:function(i){if(!Number.isFinite(i)||isNaN(i))throw new Error(i+" cannot be represented as a fraction");return new t(i)},string:function(i){return new t(i)},"number, number":function(i,s){return new t(i,s)},"bigint, bigint":function(i,s){return new t(i,s)},null:function(i){return new t(0)},BigNumber:function(i){return new t(i.toString())},bigint:function(i){return new t(i.toString())},Fraction:function(i){return i},Unit:e.referToSelf(r=>i=>{var s=i.clone();return s.value=r(i.value),s}),Object:function(i){return new t(i)},"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))})}),C$="matrix",b2e=["typed","Matrix","DenseMatrix","SparseMatrix"],_2e=ie(C$,b2e,n=>{var{typed:e,Matrix:t,DenseMatrix:r,SparseMatrix:i}=n;return e(C$,{"":function(){return s([])},string:function(o){return s([],o)},"string, string":function(o,l){return s([],o,l)},Array:function(o){return s(o)},Matrix:function(o){return s(o,o.storage())},"Array | Matrix, string":s,"Array | Matrix, string, string":s});function s(a,o,l){if(o==="dense"||o==="default"||o===void 0)return new r(a,l);if(o==="sparse")return new i(a,l);throw new TypeError("Unknown matrix type "+JSON.stringify(o)+".")}}),D$="matrixFromFunction",w2e=["typed","matrix","isZero"],E2e=ie(D$,w2e,n=>{var{typed:e,matrix:t,isZero:r}=n;return e(D$,{"Array | Matrix, function, string, string":function(a,o,l,u){return i(a,o,l,u)},"Array | Matrix, function, string":function(a,o,l){return i(a,o,l)},"Matrix, function":function(a,o){return i(a,o,"dense")},"Array, function":function(a,o){return i(a,o,"dense").toArray()},"Array | Matrix, string, function":function(a,o,l){return i(a,l,o)},"Array | Matrix, string, string, function":function(a,o,l,u){return i(a,u,o,l)}});function i(s,a,o,l){var u;return l!==void 0?u=t(o,l):u=t(o),u.resize(s),u.forEach(function(c,h){var d=a(h);r(d)||u.set(h,d)}),u}}),N$="matrixFromRows",S2e=["typed","matrix","flatten","size"],A2e=ie(N$,S2e,n=>{var{typed:e,matrix:t,flatten:r,size:i}=n;return e(N$,{"...Array":function(l){return s(l)},"...Matrix":function(l){return t(s(l.map(u=>u.toArray())))}});function s(o){if(o.length===0)throw new TypeError("At least one row is needed to construct a matrix.");var l=a(o[0]),u=[];for(var c of o){var h=a(c);if(h!==l)throw new TypeError("The vectors had different length: "+(l|0)+"  "+(h|0));u.push(r(c))}return u}function a(o){var l=i(o);if(l.length===1)return l[0];if(l.length===2){if(l[0]===1)return l[1];if(l[1]===1)return l[0];throw new TypeError("At least one of the arguments is not a vector.")}else throw new TypeError("Only one- or two-dimensional vectors are supported.")}}),R$="matrixFromColumns",T2e=["typed","matrix","flatten","size"],M2e=ie(R$,T2e,n=>{var{typed:e,matrix:t,flatten:r,size:i}=n;return e(R$,{"...Array":function(l){return s(l)},"...Matrix":function(l){return t(s(l.map(u=>u.toArray())))}});function s(o){if(o.length===0)throw new TypeError("At least one column is needed to construct a matrix.");for(var l=a(o[0]),u=[],c=0;c<l;c++)u[c]=[];for(var h of o){var d=a(h);if(d!==l)throw new TypeError("The vectors had different length: "+(l|0)+"  "+(d|0));for(var f=r(h),p=0;p<l;p++)u[p].push(f[p])}return u}function a(o){var l=i(o);if(l.length===1)return l[0];if(l.length===2){if(l[0]===1)return l[1];if(l[1]===1)return l[0];throw new TypeError("At least one of the arguments is not a vector.")}else throw new TypeError("Only one- or two-dimensional vectors are supported.")}}),I$="splitUnit",C2e=["typed"],D2e=ie(I$,C2e,n=>{var{typed:e}=n;return e(I$,{"Unit, Array":function(r,i){return r.splitUnit(i)}})}),P$="unaryMinus",N2e=["typed"],R2e=ie(P$,N2e,n=>{var{typed:e}=n;return e(P$,{number:$te,"Complex | BigNumber | Fraction":t=>t.neg(),bigint:t=>-t,Unit:e.referToSelf(t=>r=>{var i=r.clone();return i.value=e.find(t,i.valueType())(r.value),i}),"Array | Matrix":e.referToSelf(t=>r=>qt(r,t,!0))})}),F$="unaryPlus",I2e=["typed","config","numeric"],P2e=ie(F$,I2e,n=>{var{typed:e,config:t,numeric:r}=n;return e(F$,{number:Hte,Complex:function(s){return s},BigNumber:function(s){return s},bigint:function(s){return s},Fraction:function(s){return s},Unit:function(s){return s.clone()},"Array | Matrix":e.referToSelf(i=>s=>qt(s,i,!0)),boolean:function(s){return r(s?1:0,t.number)},string:function(s){return r(s,Kp(s,t))}})}),L$="abs",F2e=["typed"],L2e=ie(L$,F2e,n=>{var{typed:e}=n;return e(L$,{number:Bte,"Complex | BigNumber | Fraction | Unit":t=>t.abs(),bigint:t=>t<0n?-t:t,"Array | Matrix":e.referToSelf(t=>r=>qt(r,t,!0))})}),O$="mapSlices",O2e=["typed","isInteger"],NO=ie(O$,O2e,n=>{var{typed:e,isInteger:t}=n;return e(O$,{"Array | Matrix, number | BigNumber, function":function(i,s,a){if(!t(s))throw new TypeError("Integer number expected for dimension");var o=Array.isArray(i)?Vt(i):i.size();if(s<0||s>=o.length)throw new yu(s,o.length);return Dt(i)?i.create(qD(i.valueOf(),s,a),i.datatype()):qD(i,s,a)}})},{formerly:"apply"});function qD(n,e,t){var r,i,s;if(e<=0)if(Array.isArray(n[0])){for(s=k2e(n),i=[],r=0;r<s.length;r++)i[r]=qD(s[r],e-1,t);return i}else return t(n);else{for(i=[],r=0;r<n.length;r++)i[r]=qD(n[r],e-1,t);return i}}function k2e(n){var e=n.length,t=n[0].length,r,i,s=[];for(i=0;i<t;i++){var a=[];for(r=0;r<e;r++)a.push(n[r][i]);s.push(a)}return s}var k$="addScalar",B2e=["typed"],U2e=ie(k$,B2e,n=>{var{typed:e}=n;return e(k$,{"number, number":Ute,"Complex, Complex":function(r,i){return r.add(i)},"BigNumber, BigNumber":function(r,i){return r.plus(i)},"bigint, bigint":function(r,i){return r+i},"Fraction, Fraction":function(r,i){return r.add(i)},"Unit, Unit":e.referToSelf(t=>(r,i)=>{if(r.value===null||r.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(i.value===null||i.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!r.equalBase(i))throw new Error("Units do not match");var s=r.clone();return s.value=e.find(t,[s.valueType(),i.valueType()])(s.value,i.value),s.fixPrefix=!1,s})})}),B$="subtractScalar",V2e=["typed"],z2e=ie(B$,V2e,n=>{var{typed:e}=n;return e(B$,{"number, number":Vte,"Complex, Complex":function(r,i){return r.sub(i)},"BigNumber, BigNumber":function(r,i){return r.minus(i)},"bigint, bigint":function(r,i){return r-i},"Fraction, Fraction":function(r,i){return r.sub(i)},"Unit, Unit":e.referToSelf(t=>(r,i)=>{if(r.value===null||r.value===void 0)throw new Error("Parameter x contains a unit with undefined value");if(i.value===null||i.value===void 0)throw new Error("Parameter y contains a unit with undefined value");if(!r.equalBase(i))throw new Error("Units do not match");var s=r.clone();return s.value=e.find(t,[s.valueType(),i.valueType()])(s.value,i.value),s.fixPrefix=!1,s})})}),U$="cbrt",$2e=["config","typed","isNegative","unaryMinus","matrix","Complex","BigNumber","Fraction"],H2e=ie(U$,$2e,n=>{var{config:e,typed:t,isNegative:r,unaryMinus:i,matrix:s,Complex:a,BigNumber:o,Fraction:l}=n;return t(U$,{number:f1,Complex:u,"Complex, boolean":u,BigNumber:function(d){return d.cbrt()},Unit:c});function u(h,d){var f=h.arg()/3,p=h.abs(),m=new a(f1(p),0).mul(new a(0,f).exp());if(d){var y=[m,new a(f1(p),0).mul(new a(0,f+Math.PI*2/3).exp()),new a(f1(p),0).mul(new a(0,f-Math.PI*2/3).exp())];return e.matrix==="Array"?y:s(y)}else return m}function c(h){if(h.value&&Qh(h.value)){var d=h.clone();return d.value=1,d=d.pow(1/3),d.value=u(h.value),d}else{var f=r(h.value);f&&(h.value=i(h.value));var p;jt(h.value)?p=new o(1).div(3):iA(h.value)?p=new l(1,3):p=1/3;var m=h.pow(p);return f&&(m.value=i(m.value)),m}}}),G2e="matAlgo11xS0s",j2e=["typed","equalScalar"],Rs=ie(G2e,j2e,n=>{var{typed:e,equalScalar:t}=n;return function(i,s,a,o){var l=i._values,u=i._index,c=i._ptr,h=i._size,d=i._datatype;if(!l)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var f=h[0],p=h[1],m,y=t,v=0,b=a;typeof d=="string"&&(m=d,y=e.find(t,[m,m]),v=e.convert(0,m),s=e.convert(s,m),b=e.find(a,[m,m]));for(var x=[],w=[],_=[],E=0;E<p;E++){_[E]=w.length;for(var A=c[E],T=c[E+1],S=A;S<T;S++){var M=u[S],D=o?b(s,l[S]):b(l[S],s);y(D,v)||(w.push(M),x.push(D))}}return _[p]=w.length,i.createSparseMatrix({values:x,index:w,ptr:_,size:[f,p],datatype:m})}}),q2e="matAlgo12xSfs",W2e=["typed","DenseMatrix"],Bi=ie(q2e,W2e,n=>{var{typed:e,DenseMatrix:t}=n;return function(i,s,a,o){var l=i._values,u=i._index,c=i._ptr,h=i._size,d=i._datatype;if(!l)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var f=h[0],p=h[1],m,y=a;typeof d=="string"&&(m=d,s=e.convert(s,m),y=e.find(a,[m,m]));for(var v=[],b=[],x=[],w=0;w<p;w++){for(var _=w+1,E=c[w],A=c[w+1],T=E;T<A;T++){var S=u[T];b[S]=l[T],x[S]=_}for(var M=0;M<f;M++)w===0&&(v[M]=[]),x[M]===_?v[M][w]=o?y(s,b[M]):y(b[M],s):v[M][w]=o?y(s,0):y(0,s)}return new t({data:v,size:[f,p],datatype:m})}}),X2e="matAlgo14xDs",K2e=["typed"],Rl=ie(X2e,K2e,n=>{var{typed:e}=n;return function(i,s,a,o){var l=i._data,u=i._size,c=i._datatype,h,d=a;typeof c=="string"&&(h=c,s=e.convert(s,h),d=e.find(a,[h,h]));var f=u.length>0?t(d,0,u,u[0],l,s,o):[];return i.createDenseMatrix({data:f,size:Ut(u),datatype:h})};function t(r,i,s,a,o,l,u){var c=[];if(i===s.length-1)for(var h=0;h<a;h++)c[h]=u?r(l,o[h]):r(o[h],l);else for(var d=0;d<a;d++)c[d]=t(r,i+1,s,s[i+1],o[d],l,u);return c}}),RO="ceil",Y2e=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],Q2e=new Op(10),Z2e=ie(RO,["typed","config","round"],n=>{var{typed:e,config:t,round:r}=n;function i(s){var a=Math.ceil(s),o=r(s);return a===o?a:as(s,o,t.relTol,t.absTol)&&!as(s,a,t.relTol,t.absTol)?o:a}return e(RO,{number:i,"number, number":function(a,o){if(!bt(o))throw new RangeError("number of decimals in function ceil must be an integer");if(o<0||o>15)throw new RangeError("number of decimals in ceil number must be in range 0-15");var l=10**o;return i(a*l)/l}})}),J2e=ie(RO,Y2e,n=>{var{typed:e,config:t,round:r,matrix:i,equalScalar:s,zeros:a,DenseMatrix:o}=n,l=Rs({typed:e,equalScalar:s}),u=Bi({typed:e,DenseMatrix:o}),c=Rl({typed:e}),h=Z2e({typed:e,config:t,round:r});function d(f){var p=(v,b)=>Dl(v,b,t.relTol,t.absTol),m=f.ceil(),y=r(f);return m.eq(y)?m:p(f,y)&&!p(f,m)?y:m}return e("ceil",{number:h.signatures.number,"number,number":h.signatures["number,number"],Complex:function(p){return p.ceil()},"Complex, number":function(p,m){return p.ceil(m)},"Complex, BigNumber":function(p,m){return p.ceil(m.toNumber())},BigNumber:d,"BigNumber, BigNumber":function(p,m){var y=Q2e.pow(m);return d(p.mul(y)).div(y)},bigint:f=>f,"bigint, number":(f,p)=>f,"bigint, BigNumber":(f,p)=>f,Fraction:function(p){return p.ceil()},"Fraction, number":function(p,m){return p.ceil(m)},"Fraction, BigNumber":function(p,m){return p.ceil(m.toNumber())},"Unit, number, Unit":e.referToSelf(f=>function(p,m,y){var v=p.toNumeric(y);return y.multiply(f(v,m))}),"Unit, BigNumber, Unit":e.referToSelf(f=>(p,m,y)=>f(p,m.toNumber(),y)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(f=>(p,m,y)=>qt(p,v=>f(v,m,y),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(f=>(p,m)=>f(p,0,m)),"Array | Matrix":e.referToSelf(f=>p=>qt(p,f,!0)),"Array, number | BigNumber":e.referToSelf(f=>(p,m)=>qt(p,y=>f(y,m),!0)),"SparseMatrix, number | BigNumber":e.referToSelf(f=>(p,m)=>l(p,m,f,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(f=>(p,m)=>c(p,m,f,!1)),"number | Complex | Fraction | BigNumber, Array":e.referToSelf(f=>(p,m)=>c(i(m),p,f,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf(f=>(p,m)=>s(p,0)?a(m.size(),m.storage()):m.storage()==="dense"?c(m,p,f,!0):u(m,p,f,!0))})}),V$="cube",eNe=["typed"],tNe=ie(V$,eNe,n=>{var{typed:e}=n;return e(V$,{number:Gte,Complex:function(r){return r.mul(r).mul(r)},BigNumber:function(r){return r.times(r).times(r)},bigint:function(r){return r*r*r},Fraction:function(r){return r.pow(3)},Unit:function(r){return r.pow(3)}})}),z$="exp",nNe=["typed"],rNe=ie(z$,nNe,n=>{var{typed:e}=n;return e(z$,{number:jte,Complex:function(r){return r.exp()},BigNumber:function(r){return r.exp()}})}),$$="expm1",iNe=["typed","Complex"],sNe=ie($$,iNe,n=>{var{typed:e,Complex:t}=n;return e($$,{number:qte,Complex:function(i){var s=Math.exp(i.re);return new t(s*Math.cos(i.im)-1,s*Math.sin(i.im))},BigNumber:function(i){return i.exp().minus(1)}})}),IO="fix",aNe=["typed","Complex","matrix","ceil","floor","equalScalar","zeros","DenseMatrix"],oNe=ie(IO,["typed","ceil","floor"],n=>{var{typed:e,ceil:t,floor:r}=n;return e(IO,{number:function(s){return s>0?r(s):t(s)},"number, number":function(s,a){return s>0?r(s,a):t(s,a)}})}),lNe=ie(IO,aNe,n=>{var{typed:e,Complex:t,matrix:r,ceil:i,floor:s,equalScalar:a,zeros:o,DenseMatrix:l}=n,u=Bi({typed:e,DenseMatrix:l}),c=Rl({typed:e}),h=oNe({typed:e,ceil:i,floor:s});return e("fix",{number:h.signatures.number,"number, number | BigNumber":h.signatures["number,number"],Complex:function(f){return new t(f.re>0?Math.floor(f.re):Math.ceil(f.re),f.im>0?Math.floor(f.im):Math.ceil(f.im))},"Complex, number":function(f,p){return new t(f.re>0?s(f.re,p):i(f.re,p),f.im>0?s(f.im,p):i(f.im,p))},"Complex, BigNumber":function(f,p){var m=p.toNumber();return new t(f.re>0?s(f.re,m):i(f.re,m),f.im>0?s(f.im,m):i(f.im,m))},BigNumber:function(f){return f.isNegative()?i(f):s(f)},"BigNumber, number | BigNumber":function(f,p){return f.isNegative()?i(f,p):s(f,p)},bigint:d=>d,"bigint, number":(d,f)=>d,"bigint, BigNumber":(d,f)=>d,Fraction:function(f){return f.s<0n?f.ceil():f.floor()},"Fraction, number | BigNumber":function(f,p){return f.s<0n?i(f,p):s(f,p)},"Unit, number, Unit":e.referToSelf(d=>function(f,p,m){var y=f.toNumeric(m);return m.multiply(d(y,p))}),"Unit, BigNumber, Unit":e.referToSelf(d=>(f,p,m)=>d(f,p.toNumber(),m)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(d=>(f,p,m)=>qt(f,y=>d(y,p,m),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(d=>(f,p)=>d(f,0,p)),"Array | Matrix":e.referToSelf(d=>f=>qt(f,d,!0)),"Array | Matrix, number | BigNumber":e.referToSelf(d=>(f,p)=>qt(f,m=>d(m,p),!0)),"number | Complex | Fraction | BigNumber, Array":e.referToSelf(d=>(f,p)=>c(r(p),f,d,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf(d=>(f,p)=>a(f,0)?o(p.size(),p.storage()):p.storage()==="dense"?c(p,f,d,!0):u(p,f,d,!0))})}),PO="floor",uNe=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],cNe=new Op(10),hNe=ie(PO,["typed","config","round"],n=>{var{typed:e,config:t,round:r}=n;function i(s){var a=Math.floor(s),o=r(s);return a===o?a:as(s,o,t.relTol,t.absTol)&&!as(s,a,t.relTol,t.absTol)?o:a}return e(PO,{number:i,"number, number":function(a,o){if(!bt(o))throw new RangeError("number of decimals in function floor must be an integer");if(o<0||o>15)throw new RangeError("number of decimals in floor number must be in range 0 - 15");var l=10**o;return i(a*l)/l}})}),Mne=ie(PO,uNe,n=>{var{typed:e,config:t,round:r,matrix:i,equalScalar:s,zeros:a,DenseMatrix:o}=n,l=Rs({typed:e,equalScalar:s}),u=Bi({typed:e,DenseMatrix:o}),c=Rl({typed:e}),h=hNe({typed:e,config:t,round:r});function d(f){var p=(v,b)=>Dl(v,b,t.relTol,t.absTol),m=f.floor(),y=r(f);return m.eq(y)?m:p(f,y)&&!p(f,m)?y:m}return e("floor",{number:h.signatures.number,"number,number":h.signatures["number,number"],Complex:function(p){return p.floor()},"Complex, number":function(p,m){return p.floor(m)},"Complex, BigNumber":function(p,m){return p.floor(m.toNumber())},BigNumber:d,"BigNumber, BigNumber":function(p,m){var y=cNe.pow(m);return d(p.mul(y)).div(y)},bigint:f=>f,"bigint, number":(f,p)=>f,"bigint, BigNumber":(f,p)=>f,Fraction:function(p){return p.floor()},"Fraction, number":function(p,m){return p.floor(m)},"Fraction, BigNumber":function(p,m){return p.floor(m.toNumber())},"Unit, number, Unit":e.referToSelf(f=>function(p,m,y){var v=p.toNumeric(y);return y.multiply(f(v,m))}),"Unit, BigNumber, Unit":e.referToSelf(f=>(p,m,y)=>f(p,m.toNumber(),y)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(f=>(p,m,y)=>qt(p,v=>f(v,m,y),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(f=>(p,m)=>f(p,0,m)),"Array | Matrix":e.referToSelf(f=>p=>qt(p,f,!0)),"Array, number | BigNumber":e.referToSelf(f=>(p,m)=>qt(p,y=>f(y,m),!0)),"SparseMatrix, number | BigNumber":e.referToSelf(f=>(p,m)=>l(p,m,f,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(f=>(p,m)=>c(p,m,f,!1)),"number | Complex | Fraction | BigNumber, Array":e.referToSelf(f=>(p,m)=>c(i(m),p,f,!0).valueOf()),"number | Complex | Fraction | BigNumber, Matrix":e.referToSelf(f=>(p,m)=>s(p,0)?a(m.size(),m.storage()):m.storage()==="dense"?c(m,p,f,!0):u(m,p,f,!0))})}),dNe="matAlgo02xDS0",fNe=["typed","equalScalar"],bu=ie(dNe,fNe,n=>{var{typed:e,equalScalar:t}=n;return function(i,s,a,o){var l=i._data,u=i._size,c=i._datatype||i.getDataType(),h=s._values,d=s._index,f=s._ptr,p=s._size,m=s._datatype||s._data===void 0?s._datatype:s.getDataType();if(u.length!==p.length)throw new en(u.length,p.length);if(u[0]!==p[0]||u[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+p+")");if(!h)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var y=u[0],v=u[1],b,x=t,w=0,_=a;typeof c=="string"&&c===m&&c!=="mixed"&&(b=c,x=e.find(t,[b,b]),w=e.convert(0,b),_=e.find(a,[b,b]));for(var E=[],A=[],T=[],S=0;S<v;S++){T[S]=A.length;for(var M=f[S],D=f[S+1],N=M;N<D;N++){var R=d[N],z=o?_(h[N],l[R][S]):_(l[R][S],h[N]);x(z,w)||(A.push(R),E.push(z))}}return T[v]=A.length,s.createSparseMatrix({values:E,index:A,ptr:T,size:[y,v],datatype:c===i._datatype&&m===s._datatype?b:void 0})}}),pNe="matAlgo03xDSf",mNe=["typed"],ia=ie(pNe,mNe,n=>{var{typed:e}=n;return function(r,i,s,a){var o=r._data,l=r._size,u=r._datatype||r.getDataType(),c=i._values,h=i._index,d=i._ptr,f=i._size,p=i._datatype||i._data===void 0?i._datatype:i.getDataType();if(l.length!==f.length)throw new en(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");if(!c)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var m=l[0],y=l[1],v,b=0,x=s;typeof u=="string"&&u===p&&u!=="mixed"&&(v=u,b=e.convert(0,v),x=e.find(s,[v,v]));for(var w=[],_=0;_<m;_++)w[_]=[];for(var E=[],A=[],T=0;T<y;T++){for(var S=T+1,M=d[T],D=d[T+1],N=M;N<D;N++){var R=h[N];E[R]=a?x(c[N],o[R][T]):x(o[R][T],c[N]),A[R]=S}for(var z=0;z<m;z++)A[z]===S?w[z][T]=E[z]:w[z][T]=a?x(b,o[z][T]):x(o[z][T],b)}return r.createDenseMatrix({data:w,size:[m,y],datatype:u===r._datatype&&p===i._datatype?v:void 0})}}),gNe="matAlgo05xSfSf",vNe=["typed","equalScalar"],kN=ie(gNe,vNe,n=>{var{typed:e,equalScalar:t}=n;return function(i,s,a){var o=i._values,l=i._index,u=i._ptr,c=i._size,h=i._datatype||i._data===void 0?i._datatype:i.getDataType(),d=s._values,f=s._index,p=s._ptr,m=s._size,y=s._datatype||s._data===void 0?s._datatype:s.getDataType();if(c.length!==m.length)throw new en(c.length,m.length);if(c[0]!==m[0]||c[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+m+")");var v=c[0],b=c[1],x,w=t,_=0,E=a;typeof h=="string"&&h===y&&h!=="mixed"&&(x=h,w=e.find(t,[x,x]),_=e.convert(0,x),E=e.find(a,[x,x]));var A=o&&d?[]:void 0,T=[],S=[],M=A?[]:void 0,D=A?[]:void 0,N=[],R=[],z,j,I,F;for(j=0;j<b;j++){S[j]=T.length;var $=j+1;for(I=u[j],F=u[j+1];I<F;I++)z=l[I],T.push(z),N[z]=$,M&&(M[z]=o[I]);for(I=p[j],F=p[j+1];I<F;I++)z=f[I],N[z]!==$&&T.push(z),R[z]=$,D&&(D[z]=d[I]);if(A)for(I=S[j];I<T.length;){z=T[I];var H=N[z],Z=R[z];if(H===$||Z===$){var J=H===$?M[z]:_,ee=Z===$?D[z]:_,O=E(J,ee);w(O,_)?T.splice(I,1):(A.push(O),I++)}}}return S[b]=T.length,i.createSparseMatrix({values:A,index:T,ptr:S,size:[v,b],datatype:h===i._datatype&&y===s._datatype?x:void 0})}}),yNe="matAlgo13xDD",xNe=["typed"],Cne=ie(yNe,xNe,n=>{var{typed:e}=n;return function(i,s,a){var o=i._data,l=i._size,u=i._datatype,c=s._data,h=s._size,d=s._datatype,f=[];if(l.length!==h.length)throw new en(l.length,h.length);for(var p=0;p<l.length;p++){if(l[p]!==h[p])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+h+")");f[p]=l[p]}var m,y=a;typeof u=="string"&&u===d&&(m=u,y=e.find(a,[m,m]));var v=f.length>0?t(y,0,f,f[0],o,c):[];return i.createDenseMatrix({data:v,size:f,datatype:m})};function t(r,i,s,a,o,l){var u=[];if(i===s.length-1)for(var c=0;c<a;c++)u[c]=r(o[c],l[c]);else for(var h=0;h<a;h++)u[h]=t(r,i+1,s,s[i+1],o[h],l[h]);return u}});function qi(n,e){if(yd(n.size(),e.size()))return[n,e];var t=UD(n.size(),e.size());return[n,e].map(r=>bNe(r,t))}function bNe(n,e){return yd(n.size(),e)?n:n.create(qm(n.valueOf(),e),n.datatype())}var _Ne="matrixAlgorithmSuite",wNe=["typed","matrix"],ar=ie(_Ne,wNe,n=>{var{typed:e,matrix:t}=n,r=Cne({typed:e}),i=Rl({typed:e});return function(a){var o=a.elop,l=a.SD||a.DS,u;o?(u={"DenseMatrix, DenseMatrix":(f,p)=>r(...qi(f,p),o),"Array, Array":(f,p)=>r(...qi(t(f),t(p)),o).valueOf(),"Array, DenseMatrix":(f,p)=>r(...qi(t(f),p),o),"DenseMatrix, Array":(f,p)=>r(...qi(f,t(p)),o)},a.SS&&(u["SparseMatrix, SparseMatrix"]=(f,p)=>a.SS(...qi(f,p),o,!1)),a.DS&&(u["DenseMatrix, SparseMatrix"]=(f,p)=>a.DS(...qi(f,p),o,!1),u["Array, SparseMatrix"]=(f,p)=>a.DS(...qi(t(f),p),o,!1)),l&&(u["SparseMatrix, DenseMatrix"]=(f,p)=>l(...qi(p,f),o,!0),u["SparseMatrix, Array"]=(f,p)=>l(...qi(t(p),f),o,!0))):(u={"DenseMatrix, DenseMatrix":e.referToSelf(f=>(p,m)=>r(...qi(p,m),f)),"Array, Array":e.referToSelf(f=>(p,m)=>r(...qi(t(p),t(m)),f).valueOf()),"Array, DenseMatrix":e.referToSelf(f=>(p,m)=>r(...qi(t(p),m),f)),"DenseMatrix, Array":e.referToSelf(f=>(p,m)=>r(...qi(p,t(m)),f))},a.SS&&(u["SparseMatrix, SparseMatrix"]=e.referToSelf(f=>(p,m)=>a.SS(...qi(p,m),f,!1))),a.DS&&(u["DenseMatrix, SparseMatrix"]=e.referToSelf(f=>(p,m)=>a.DS(...qi(p,m),f,!1)),u["Array, SparseMatrix"]=e.referToSelf(f=>(p,m)=>a.DS(...qi(t(p),m),f,!1))),l&&(u["SparseMatrix, DenseMatrix"]=e.referToSelf(f=>(p,m)=>l(...qi(m,p),f,!0)),u["SparseMatrix, Array"]=e.referToSelf(f=>(p,m)=>l(...qi(t(m),p),f,!0))));var c=a.scalar||"any",h=a.Ds||a.Ss;h&&(o?(u["DenseMatrix,"+c]=(f,p)=>i(f,p,o,!1),u[c+", DenseMatrix"]=(f,p)=>i(p,f,o,!0),u["Array,"+c]=(f,p)=>i(t(f),p,o,!1).valueOf(),u[c+", Array"]=(f,p)=>i(t(p),f,o,!0).valueOf()):(u["DenseMatrix,"+c]=e.referToSelf(f=>(p,m)=>i(p,m,f,!1)),u[c+", DenseMatrix"]=e.referToSelf(f=>(p,m)=>i(m,p,f,!0)),u["Array,"+c]=e.referToSelf(f=>(p,m)=>i(t(p),m,f,!1).valueOf()),u[c+", Array"]=e.referToSelf(f=>(p,m)=>i(t(m),p,f,!0).valueOf())));var d=a.sS!==void 0?a.sS:a.Ss;return o?(a.Ss&&(u["SparseMatrix,"+c]=(f,p)=>a.Ss(f,p,o,!1)),d&&(u[c+", SparseMatrix"]=(f,p)=>d(p,f,o,!0))):(a.Ss&&(u["SparseMatrix,"+c]=e.referToSelf(f=>(p,m)=>a.Ss(p,m,f,!1))),d&&(u[c+", SparseMatrix"]=e.referToSelf(f=>(p,m)=>d(m,p,f,!0)))),o&&o.signatures&&ute(u,o.signatures),u}}),H$="mod",ENe=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix","concat"],Dne=ie(H$,ENe,n=>{var{typed:e,config:t,round:r,matrix:i,equalScalar:s,zeros:a,DenseMatrix:o,concat:l}=n,u=Mne({typed:e,config:t,round:r,matrix:i,equalScalar:s,zeros:a,DenseMatrix:o}),c=bu({typed:e,equalScalar:s}),h=ia({typed:e}),d=kN({typed:e,equalScalar:s}),f=Rs({typed:e,equalScalar:s}),p=Bi({typed:e,DenseMatrix:o}),m=ar({typed:e,matrix:i,concat:l});return e(H$,{"number, number":y,"BigNumber, BigNumber":function(b,x){return x.isZero()?b:b.sub(x.mul(u(b.div(x))))},"bigint, bigint":function(b,x){if(x===0n)return b;if(b<0){var w=b%x;return w===0n?w:w+x}return b%x},"Fraction, Fraction":function(b,x){return x.equals(0)?b:b.sub(x.mul(u(b.div(x))))}},m({SS:d,DS:h,SD:c,Ss:f,sS:p}));function y(v,b){return b===0?v:v-b*u(v/b)}}),SNe="matAlgo01xDSid",ANe=["typed"],Qp=ie(SNe,ANe,n=>{var{typed:e}=n;return function(r,i,s,a){var o=r._data,l=r._size,u=r._datatype||r.getDataType(),c=i._values,h=i._index,d=i._ptr,f=i._size,p=i._datatype||i._data===void 0?i._datatype:i.getDataType();if(l.length!==f.length)throw new en(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");if(!c)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var m=l[0],y=l[1],v=typeof u=="string"&&u!=="mixed"&&u===p?u:void 0,b=v?e.find(s,[v,v]):s,x,w,_=[];for(x=0;x<m;x++)_[x]=[];var E=[],A=[];for(w=0;w<y;w++){for(var T=w+1,S=d[w],M=d[w+1],D=S;D<M;D++)x=h[D],E[x]=a?b(c[D],o[x][w]):b(o[x][w],c[D]),A[x]=T;for(x=0;x<m;x++)A[x]===T?_[x][w]=E[x]:_[x][w]=o[x][w]}return r.createDenseMatrix({data:_,size:[m,y],datatype:u===r._datatype&&p===i._datatype?v:void 0})}}),TNe="matAlgo04xSidSid",MNe=["typed","equalScalar"],J4=ie(TNe,MNe,n=>{var{typed:e,equalScalar:t}=n;return function(i,s,a){var o=i._values,l=i._index,u=i._ptr,c=i._size,h=i._datatype||i._data===void 0?i._datatype:i.getDataType(),d=s._values,f=s._index,p=s._ptr,m=s._size,y=s._datatype||s._data===void 0?s._datatype:s.getDataType();if(c.length!==m.length)throw new en(c.length,m.length);if(c[0]!==m[0]||c[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+m+")");var v=c[0],b=c[1],x,w=t,_=0,E=a;typeof h=="string"&&h===y&&h!=="mixed"&&(x=h,w=e.find(t,[x,x]),_=e.convert(0,x),E=e.find(a,[x,x]));var A=o&&d?[]:void 0,T=[],S=[],M=o&&d?[]:void 0,D=o&&d?[]:void 0,N=[],R=[],z,j,I,F,$;for(j=0;j<b;j++){S[j]=T.length;var H=j+1;for(F=u[j],$=u[j+1],I=F;I<$;I++)z=l[I],T.push(z),N[z]=H,M&&(M[z]=o[I]);for(F=p[j],$=p[j+1],I=F;I<$;I++)if(z=f[I],N[z]===H){if(M){var Z=E(M[z],d[I]);w(Z,_)?N[z]=null:M[z]=Z}}else T.push(z),R[z]=H,D&&(D[z]=d[I]);if(M&&D)for(I=S[j];I<T.length;)z=T[I],N[z]===H?(A[I]=M[z],I++):R[z]===H?(A[I]=D[z],I++):T.splice(I,1)}return S[b]=T.length,i.createSparseMatrix({values:A,index:T,ptr:S,size:[v,b],datatype:h===i._datatype&&y===s._datatype?x:void 0})}}),CNe="matAlgo10xSids",DNe=["typed","DenseMatrix"],$v=ie(CNe,DNe,n=>{var{typed:e,DenseMatrix:t}=n;return function(i,s,a,o){var l=i._values,u=i._index,c=i._ptr,h=i._size,d=i._datatype;if(!l)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var f=h[0],p=h[1],m,y=a;typeof d=="string"&&(m=d,s=e.convert(s,m),y=e.find(a,[m,m]));for(var v=[],b=[],x=[],w=0;w<p;w++){for(var _=w+1,E=c[w],A=c[w+1],T=E;T<A;T++){var S=u[T];b[S]=l[T],x[S]=_}for(var M=0;M<f;M++)w===0&&(v[M]=[]),x[M]===_?v[M][w]=o?y(s,b[M]):y(b[M],s):v[M][w]=s}return new t({data:v,size:[f,p],datatype:m})}});function Hv(n,e,t,r){if(!(this instanceof Hv))throw new SyntaxError("Constructor must be called with the new operator");this.fn=n,this.count=e,this.min=t,this.max=r,this.message="Wrong number of arguments in function "+n+" ("+e+" provided, "+t+(r!=null?"-"+r:"")+" expected)",this.stack=new Error().stack}Hv.prototype=new Error;Hv.prototype.constructor=Error;Hv.prototype.name="ArgumentsError";Hv.prototype.isArgumentsError=!0;var G$="gcd",NNe=["typed","config","round","matrix","equalScalar","zeros","BigNumber","DenseMatrix","concat"],YI="number | BigNumber | Fraction | Matrix | Array",RNe="".concat(YI,", ").concat(YI,", ...").concat(YI);function j$(n){return!n.some(e=>Array.isArray(e))}var INe=ie(G$,NNe,n=>{var{typed:e,matrix:t,config:r,round:i,equalScalar:s,zeros:a,BigNumber:o,DenseMatrix:l,concat:u}=n,c=Dne({typed:e,config:r,round:i,matrix:t,equalScalar:s,zeros:a,DenseMatrix:l,concat:u}),h=Qp({typed:e}),d=J4({typed:e,equalScalar:s}),f=$v({typed:e,DenseMatrix:l}),p=ar({typed:e,matrix:t,concat:u});return e(G$,{"number, number":m,"BigNumber, BigNumber":y,"Fraction, Fraction":(v,b)=>v.gcd(b)},p({SS:d,DS:h,Ss:f}),{[RNe]:e.referToSelf(v=>(b,x,w)=>{for(var _=v(b,x),E=0;E<w.length;E++)_=v(_,w[E]);return _}),Array:e.referToSelf(v=>b=>{if(b.length===1&&Array.isArray(b[0])&&j$(b[0]))return v(...b[0]);if(j$(b))return v(...b);throw new Hv("gcd() supports only 1d matrices!")}),Matrix:e.referToSelf(v=>b=>v(b.toArray()))});function m(v,b){if(!bt(v)||!bt(b))throw new Error("Parameters in function gcd must be integer numbers");for(var x;b!==0;)x=c(v,b),v=b,b=x;return v<0?-v:v}function y(v,b){if(!v.isInt()||!b.isInt())throw new Error("Parameters in function gcd must be integer numbers");for(var x=new o(0);!b.isZero();){var w=c(v,b);v=b,b=w}return v.lt(x)?v.neg():v}}),PNe="matAlgo06xS0S0",FNe=["typed","equalScalar"],BN=ie(PNe,FNe,n=>{var{typed:e,equalScalar:t}=n;return function(i,s,a){var o=i._values,l=i._size,u=i._datatype||i._data===void 0?i._datatype:i.getDataType(),c=s._values,h=s._size,d=s._datatype||s._data===void 0?s._datatype:s.getDataType();if(l.length!==h.length)throw new en(l.length,h.length);if(l[0]!==h[0]||l[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+h+")");var f=l[0],p=l[1],m,y=t,v=0,b=a;typeof u=="string"&&u===d&&u!=="mixed"&&(m=u,y=e.find(t,[m,m]),v=e.convert(0,m),b=e.find(a,[m,m]));for(var x=o&&c?[]:void 0,w=[],_=[],E=x?[]:void 0,A=[],T=[],S=0;S<p;S++){_[S]=w.length;var M=S+1;if(d$(i,S,A,E,T,M,w,b),d$(s,S,A,E,T,M,w,b),E)for(var D=_[S];D<w.length;){var N=w[D];if(T[N]===M){var R=E[N];y(R,v)?w.splice(D,1):(x.push(R),D++)}else w.splice(D,1)}else for(var z=_[S];z<w.length;){var j=w[z];T[j]!==M?w.splice(z,1):z++}}return _[p]=w.length,i.createSparseMatrix({values:x,index:w,ptr:_,size:[f,p],datatype:u===i._datatype&&d===s._datatype?m:void 0})}}),q$="lcm",LNe=["typed","matrix","equalScalar","concat"],ONe=ie(q$,LNe,n=>{var{typed:e,matrix:t,equalScalar:r,concat:i}=n,s=bu({typed:e,equalScalar:r}),a=BN({typed:e,equalScalar:r}),o=Rs({typed:e,equalScalar:r}),l=ar({typed:e,matrix:t,concat:i}),u="number | BigNumber | Fraction | Matrix | Array",c={};return c["".concat(u,", ").concat(u,", ...").concat(u)]=e.referToSelf(d=>(f,p,m)=>{for(var y=d(f,p),v=0;v<m.length;v++)y=d(y,m[v]);return y}),e(q$,{"number, number":Wte,"BigNumber, BigNumber":h,"Fraction, Fraction":(d,f)=>d.lcm(f)},l({SS:a,DS:s,Ss:o}),c);function h(d,f){if(!d.isInt()||!f.isInt())throw new Error("Parameters in function lcm must be integer numbers");if(d.isZero())return d;if(f.isZero())return f;for(var p=d.times(f);!f.isZero();){var m=f;f=d.mod(m),d=m}return p.div(d).abs()}});function eU(n,e,t,r){return function(i){if(i>0||t.predictable){if(i<=0)return NaN;var s=i.toString(16),a=s.substring(0,15);return n*(s.length-a.length)+e(+("0x"+a))}return r(i.toNumber())}}var W$="log10",kNe=["typed","config","Complex"],BNe=$D(16),UNe=ie(W$,kNe,n=>{var{typed:e,config:t,Complex:r}=n;function i(a){return a.log().div(Math.LN10)}function s(a){return i(new r(a,0))}return e(W$,{number:function(o){return o>=0||t.predictable?$D(o):s(o)},bigint:eU(BNe,$D,t,s),Complex:i,BigNumber:function(o){return!o.isNegative()||t.predictable?o.log():s(o.toNumber())},"Array | Matrix":e.referToSelf(a=>o=>qt(o,a))})}),X$="log2",VNe=["typed","config","Complex"],zNe=ie(X$,VNe,n=>{var{typed:e,config:t,Complex:r}=n;function i(a){return s(new r(a,0))}return e(X$,{number:function(o){return o>=0||t.predictable?AO(o):i(o)},bigint:eU(4,AO,t,i),Complex:s,BigNumber:function(o){return!o.isNegative()||t.predictable?o.log(2):i(o.toNumber())},"Array | Matrix":e.referToSelf(a=>o=>qt(o,a))});function s(a){var o=Math.sqrt(a.re*a.re+a.im*a.im);return new r(Math.log2?Math.log2(o):Math.log(o)/Math.LN2,Math.atan2(a.im,a.re)/Math.LN2)}}),$Ne="multiplyScalar",HNe=["typed"],GNe=ie($Ne,HNe,n=>{var{typed:e}=n;return e("multiplyScalar",{"number, number":zte,"Complex, Complex":function(r,i){return r.mul(i)},"BigNumber, BigNumber":function(r,i){return r.times(i)},"bigint, bigint":function(r,i){return r*i},"Fraction, Fraction":function(r,i){return r.mul(i)},"number | Fraction | BigNumber | Complex, Unit":(t,r)=>r.multiply(t),"Unit, number | Fraction | BigNumber | Complex | Unit":(t,r)=>t.multiply(r)})}),K$="multiply",jNe=["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],qNe=ie(K$,jNe,n=>{var{typed:e,matrix:t,addScalar:r,multiplyScalar:i,equalScalar:s,dot:a}=n,o=Rs({typed:e,equalScalar:s}),l=Rl({typed:e});function u(_,E){switch(_.length){case 1:switch(E.length){case 1:if(_[0]!==E[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(_[0]!==E[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+_[0]+") must match Matrix rows ("+E[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+E.length+" dimensions)")}break;case 2:switch(E.length){case 1:if(_[1]!==E[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+_[1]+") must match Vector length ("+E[0]+")");break;case 2:if(_[1]!==E[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+_[1]+") must match Matrix B rows ("+E[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+E.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+_.length+" dimensions)")}}function c(_,E,A){if(A===0)throw new Error("Cannot multiply two empty vectors");return a(_,E)}function h(_,E){if(E.storage()!=="dense")throw new Error("Support for SparseMatrix not implemented");return d(_,E)}function d(_,E){var A=_._data,T=_._size,S=_._datatype||_.getDataType(),M=E._data,D=E._size,N=E._datatype||E.getDataType(),R=T[0],z=D[1],j,I=r,F=i;S&&N&&S===N&&typeof S=="string"&&S!=="mixed"&&(j=S,I=e.find(r,[j,j]),F=e.find(i,[j,j]));for(var $=[],H=0;H<z;H++){for(var Z=F(A[0],M[0][H]),J=1;J<R;J++)Z=I(Z,F(A[J],M[J][H]));$[H]=Z}return _.createDenseMatrix({data:$,size:[z],datatype:S===_._datatype&&N===E._datatype?j:void 0})}var f=e("_multiplyMatrixVector",{"DenseMatrix, any":m,"SparseMatrix, any":b}),p=e("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":y,"DenseMatrix, SparseMatrix":v,"SparseMatrix, DenseMatrix":x,"SparseMatrix, SparseMatrix":w});function m(_,E){var A=_._data,T=_._size,S=_._datatype||_.getDataType(),M=E._data,D=E._datatype||E.getDataType(),N=T[0],R=T[1],z,j=r,I=i;S&&D&&S===D&&typeof S=="string"&&S!=="mixed"&&(z=S,j=e.find(r,[z,z]),I=e.find(i,[z,z]));for(var F=[],$=0;$<N;$++){for(var H=A[$],Z=I(H[0],M[0]),J=1;J<R;J++)Z=j(Z,I(H[J],M[J]));F[$]=Z}return _.createDenseMatrix({data:F,size:[N],datatype:S===_._datatype&&D===E._datatype?z:void 0})}function y(_,E){var A=_._data,T=_._size,S=_._datatype||_.getDataType(),M=E._data,D=E._size,N=E._datatype||E.getDataType(),R=T[0],z=T[1],j=D[1],I,F=r,$=i;S&&N&&S===N&&typeof S=="string"&&S!=="mixed"&&S!=="mixed"&&(I=S,F=e.find(r,[I,I]),$=e.find(i,[I,I]));for(var H=[],Z=0;Z<R;Z++){var J=A[Z];H[Z]=[];for(var ee=0;ee<j;ee++){for(var O=$(J[0],M[0][ee]),ue=1;ue<z;ue++)O=F(O,$(J[ue],M[ue][ee]));H[Z][ee]=O}}return _.createDenseMatrix({data:H,size:[R,j],datatype:S===_._datatype&&N===E._datatype?I:void 0})}function v(_,E){var A=_._data,T=_._size,S=_._datatype||_.getDataType(),M=E._values,D=E._index,N=E._ptr,R=E._size,z=E._datatype||E._data===void 0?E._datatype:E.getDataType();if(!M)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var j=T[0],I=R[1],F,$=r,H=i,Z=s,J=0;S&&z&&S===z&&typeof S=="string"&&S!=="mixed"&&(F=S,$=e.find(r,[F,F]),H=e.find(i,[F,F]),Z=e.find(s,[F,F]),J=e.convert(0,F));for(var ee=[],O=[],ue=[],Q=E.createSparseMatrix({values:ee,index:O,ptr:ue,size:[j,I],datatype:S===_._datatype&&z===E._datatype?F:void 0}),re=0;re<I;re++){ue[re]=O.length;var le=N[re],te=N[re+1];if(te>le)for(var Y=0,oe=0;oe<j;oe++){for(var ve=oe+1,me=void 0,be=le;be<te;be++){var _e=D[be];Y!==ve?(me=H(A[oe][_e],M[be]),Y=ve):me=$(me,H(A[oe][_e],M[be]))}Y===ve&&!Z(me,J)&&(O.push(oe),ee.push(me))}}return ue[I]=O.length,Q}function b(_,E){var A=_._values,T=_._index,S=_._ptr,M=_._datatype||_._data===void 0?_._datatype:_.getDataType();if(!A)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var D=E._data,N=E._datatype||E.getDataType(),R=_._size[0],z=E._size[0],j=[],I=[],F=[],$,H=r,Z=i,J=s,ee=0;M&&N&&M===N&&typeof M=="string"&&M!=="mixed"&&($=M,H=e.find(r,[$,$]),Z=e.find(i,[$,$]),J=e.find(s,[$,$]),ee=e.convert(0,$));var O=[],ue=[];F[0]=0;for(var Q=0;Q<z;Q++){var re=D[Q];if(!J(re,ee))for(var le=S[Q],te=S[Q+1],Y=le;Y<te;Y++){var oe=T[Y];ue[oe]?O[oe]=H(O[oe],Z(re,A[Y])):(ue[oe]=!0,I.push(oe),O[oe]=Z(re,A[Y]))}}for(var ve=I.length,me=0;me<ve;me++){var be=I[me];j[me]=O[be]}return F[1]=I.length,_.createSparseMatrix({values:j,index:I,ptr:F,size:[R,1],datatype:M===_._datatype&&N===E._datatype?$:void 0})}function x(_,E){var A=_._values,T=_._index,S=_._ptr,M=_._datatype||_._data===void 0?_._datatype:_.getDataType();if(!A)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var D=E._data,N=E._datatype||E.getDataType(),R=_._size[0],z=E._size[0],j=E._size[1],I,F=r,$=i,H=s,Z=0;M&&N&&M===N&&typeof M=="string"&&M!=="mixed"&&(I=M,F=e.find(r,[I,I]),$=e.find(i,[I,I]),H=e.find(s,[I,I]),Z=e.convert(0,I));for(var J=[],ee=[],O=[],ue=_.createSparseMatrix({values:J,index:ee,ptr:O,size:[R,j],datatype:M===_._datatype&&N===E._datatype?I:void 0}),Q=[],re=[],le=0;le<j;le++){O[le]=ee.length;for(var te=le+1,Y=0;Y<z;Y++){var oe=D[Y][le];if(!H(oe,Z))for(var ve=S[Y],me=S[Y+1],be=ve;be<me;be++){var _e=T[be];re[_e]!==te?(re[_e]=te,ee.push(_e),Q[_e]=$(oe,A[be])):Q[_e]=F(Q[_e],$(oe,A[be]))}}for(var Be=O[le],ze=ee.length,tt=Be;tt<ze;tt++){var de=ee[tt];J[tt]=Q[de]}}return O[j]=ee.length,ue}function w(_,E){var A=_._values,T=_._index,S=_._ptr,M=_._datatype||_._data===void 0?_._datatype:_.getDataType(),D=E._values,N=E._index,R=E._ptr,z=E._datatype||E._data===void 0?E._datatype:E.getDataType(),j=_._size[0],I=E._size[1],F=A&&D,$,H=r,Z=i;M&&z&&M===z&&typeof M=="string"&&M!=="mixed"&&($=M,H=e.find(r,[$,$]),Z=e.find(i,[$,$]));for(var J=F?[]:void 0,ee=[],O=[],ue=_.createSparseMatrix({values:J,index:ee,ptr:O,size:[j,I],datatype:M===_._datatype&&z===E._datatype?$:void 0}),Q=F?[]:void 0,re=[],le,te,Y,oe,ve,me,be,_e,Be=0;Be<I;Be++){O[Be]=ee.length;var ze=Be+1;for(ve=R[Be],me=R[Be+1],oe=ve;oe<me;oe++)if(_e=N[oe],F)for(te=S[_e],Y=S[_e+1],le=te;le<Y;le++)be=T[le],re[be]!==ze?(re[be]=ze,ee.push(be),Q[be]=Z(D[oe],A[le])):Q[be]=H(Q[be],Z(D[oe],A[le]));else for(te=S[_e],Y=S[_e+1],le=te;le<Y;le++)be=T[le],re[be]!==ze&&(re[be]=ze,ee.push(be));if(F)for(var tt=O[Be],de=ee.length,Xe=tt;Xe<de;Xe++){var Ke=ee[Xe];J[Xe]=Q[Ke]}}return O[I]=ee.length,ue}return e(K$,i,{"Array, Array":e.referTo("Matrix, Matrix",_=>(E,A)=>{u(Vt(E),Vt(A));var T=_(t(E),t(A));return Dt(T)?T.valueOf():T}),"Matrix, Matrix":function(E,A){var T=E.size(),S=A.size();return u(T,S),T.length===1?S.length===1?c(E,A,T[0]):h(E,A):S.length===1?f(E,A):p(E,A)},"Matrix, Array":e.referTo("Matrix,Matrix",_=>(E,A)=>_(E,t(A))),"Array, Matrix":e.referToSelf(_=>(E,A)=>_(t(E,A.storage()),A)),"SparseMatrix, any":function(E,A){return o(E,A,i,!1)},"DenseMatrix, any":function(E,A){return l(E,A,i,!1)},"any, SparseMatrix":function(E,A){return o(A,E,i,!0)},"any, DenseMatrix":function(E,A){return l(A,E,i,!0)},"Array, any":function(E,A){return l(t(E),A,i,!1).valueOf()},"any, Array":function(E,A){return l(t(A),E,i,!0).valueOf()},"any, any":i,"any, any, ...any":e.referToSelf(_=>(E,A,T)=>{for(var S=_(E,A),M=0;M<T.length;M++)S=_(S,T[M]);return S})})}),Y$="nthRoot",WNe=["typed","matrix","equalScalar","BigNumber","concat"],XNe=ie(Y$,WNe,n=>{var{typed:e,matrix:t,equalScalar:r,BigNumber:i,concat:s}=n,a=Qp({typed:e}),o=bu({typed:e,equalScalar:r}),l=BN({typed:e,equalScalar:r}),u=Rs({typed:e,equalScalar:r}),c=ar({typed:e,matrix:t,concat:s});function h(){throw new Error("Complex number not supported in function nthRoot. Use nthRoots instead.")}return e(Y$,{number:m$,"number, number":m$,BigNumber:f=>d(f,new i(2)),"BigNumber, BigNumber":d,Complex:h,"Complex, number":h,Array:e.referTo("DenseMatrix,number",f=>p=>f(t(p),2).valueOf()),DenseMatrix:e.referTo("DenseMatrix,number",f=>p=>f(p,2)),SparseMatrix:e.referTo("SparseMatrix,number",f=>p=>f(p,2)),"SparseMatrix, SparseMatrix":e.referToSelf(f=>(p,m)=>{if(m.density()===1)return l(p,m,f);throw new Error("Root must be non-zero")}),"DenseMatrix, SparseMatrix":e.referToSelf(f=>(p,m)=>{if(m.density()===1)return a(p,m,f,!1);throw new Error("Root must be non-zero")}),"Array, SparseMatrix":e.referTo("DenseMatrix,SparseMatrix",f=>(p,m)=>f(t(p),m)),"number | BigNumber, SparseMatrix":e.referToSelf(f=>(p,m)=>{if(m.density()===1)return u(m,p,f,!0);throw new Error("Root must be non-zero")})},c({scalar:"number | BigNumber",SD:o,Ss:u,sS:!1}));function d(f,p){var m=i.precision,y=i.clone({precision:m+2}),v=new i(0),b=new y(1),x=p.isNegative();if(x&&(p=p.neg()),p.isZero())throw new Error("Root must be non-zero");if(f.isNegative()&&!p.abs().mod(2).equals(1))throw new Error("Root must be odd when a is negative.");if(f.isZero())return x?new y(1/0):0;if(!f.isFinite())return x?v:f;var w=f.abs().pow(b.div(p));return w=f.isNeg()?w.neg():w,new i((x?b.div(w):w).toPrecision(m))}}),Q$="sign",KNe=["typed","BigNumber","Fraction","complex"],YNe=ie(Q$,KNe,n=>{var{typed:e,BigNumber:t,complex:r,Fraction:i}=n;return e(Q$,{number:TO,Complex:function(a){return a.im===0?r(TO(a.re)):a.sign()},BigNumber:function(a){return new t(a.cmp(0))},bigint:function(a){return a>0n?1n:a<0n?-1n:0n},Fraction:function(a){return a.n===0n?new i(0):new i(a.s)},"Array | Matrix":e.referToSelf(s=>a=>qt(a,s,!0)),Unit:e.referToSelf(s=>a=>{if(!a._isDerived()&&a.units[0].unit.offset!==0)throw new TypeError("sign is ambiguous for units with offset");return e.find(s,a.valueType())(a.value)})})}),QNe="sqrt",ZNe=["config","typed","Complex"],JNe=ie(QNe,ZNe,n=>{var{config:e,typed:t,Complex:r}=n;return t("sqrt",{number:i,Complex:function(a){return a.sqrt()},BigNumber:function(a){return!a.isNegative()||e.predictable?a.sqrt():i(a.toNumber())},Unit:function(a){return a.pow(.5)}});function i(s){return isNaN(s)?NaN:s>=0||e.predictable?Math.sqrt(s):new r(s,0).sqrt()}}),Z$="square",eRe=["typed"],tRe=ie(Z$,eRe,n=>{var{typed:e}=n;return e(Z$,{number:Xte,Complex:function(r){return r.mul(r)},BigNumber:function(r){return r.times(r)},bigint:function(r){return r*r},Fraction:function(r){return r.mul(r)},Unit:function(r){return r.pow(2)}})}),J$="subtract",nRe=["typed","matrix","equalScalar","subtractScalar","unaryMinus","DenseMatrix","concat"],rRe=ie(J$,nRe,n=>{var{typed:e,matrix:t,equalScalar:r,subtractScalar:i,unaryMinus:s,DenseMatrix:a,concat:o}=n,l=Qp({typed:e}),u=ia({typed:e}),c=kN({typed:e,equalScalar:r}),h=$v({typed:e,DenseMatrix:a}),d=Bi({typed:e,DenseMatrix:a}),f=ar({typed:e,matrix:t,concat:o});return e(J$,{"any, any":i},f({elop:i,SS:c,DS:l,SD:u,Ss:d,sS:h}))}),e7="xgcd",iRe=["typed","config","matrix","BigNumber"],sRe=ie(e7,iRe,n=>{var{typed:e,config:t,matrix:r,BigNumber:i}=n;return e(e7,{"number, number":function(o,l){var u=Kte(o,l);return t.matrix==="Array"?u:r(u)},"BigNumber, BigNumber":s});function s(a,o){var l,u,c,h=new i(0),d=new i(1),f=h,p=d,m=d,y=h;if(!a.isInt()||!o.isInt())throw new Error("Parameters in function xgcd must be integer numbers");for(;!o.isZero();)u=a.div(o).floor(),c=a.mod(o),l=f,f=p.minus(u.times(f)),p=l,l=m,m=y.minus(u.times(m)),y=l,a=o,o=c;var v;return a.lt(h)?v=[a.neg(),p.neg(),y.neg()]:v=[a,a.isZero()?0:p,y],t.matrix==="Array"?v:r(v)}}),t7="invmod",aRe=["typed","config","BigNumber","xgcd","equal","smaller","mod","add","isInteger"],oRe=ie(t7,aRe,n=>{var{typed:e,config:t,BigNumber:r,xgcd:i,equal:s,smaller:a,mod:o,add:l,isInteger:u}=n;return e(t7,{"number, number":c,"BigNumber, BigNumber":c});function c(h,d){if(!u(h)||!u(d))throw new Error("Parameters in function invmod must be integer numbers");if(h=o(h,d),s(d,0))throw new Error("Divisor must be non zero");var f=i(h,d);f=f.valueOf();var[p,m]=f;return s(p,r(1))?(m=o(m,d),a(m,r(0))&&(m=l(m,d)),m):NaN}}),lRe="matAlgo09xS0Sf",uRe=["typed","equalScalar"],Nne=ie(lRe,uRe,n=>{var{typed:e,equalScalar:t}=n;return function(i,s,a){var o=i._values,l=i._index,u=i._ptr,c=i._size,h=i._datatype||i._data===void 0?i._datatype:i.getDataType(),d=s._values,f=s._index,p=s._ptr,m=s._size,y=s._datatype||s._data===void 0?s._datatype:s.getDataType();if(c.length!==m.length)throw new en(c.length,m.length);if(c[0]!==m[0]||c[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+m+")");var v=c[0],b=c[1],x,w=t,_=0,E=a;typeof h=="string"&&h===y&&h!=="mixed"&&(x=h,w=e.find(t,[x,x]),_=e.convert(0,x),E=e.find(a,[x,x]));var A=o&&d?[]:void 0,T=[],S=[],M=A?[]:void 0,D=[],N,R,z,j,I;for(R=0;R<b;R++){S[R]=T.length;var F=R+1;if(M)for(j=p[R],I=p[R+1],z=j;z<I;z++)N=f[z],D[N]=F,M[N]=d[z];for(j=u[R],I=u[R+1],z=j;z<I;z++)if(N=l[z],M){var $=D[N]===F?M[N]:_,H=E(o[z],$);w(H,_)||(T.push(N),A.push(H))}else T.push(N)}return S[b]=T.length,i.createSparseMatrix({values:A,index:T,ptr:S,size:[v,b],datatype:h===i._datatype&&y===s._datatype?x:void 0})}}),n7="dotMultiply",cRe=["typed","matrix","equalScalar","multiplyScalar","concat"],hRe=ie(n7,cRe,n=>{var{typed:e,matrix:t,equalScalar:r,multiplyScalar:i,concat:s}=n,a=bu({typed:e,equalScalar:r}),o=Nne({typed:e,equalScalar:r}),l=Rs({typed:e,equalScalar:r}),u=ar({typed:e,matrix:t,concat:s});return e(n7,u({elop:i,SS:o,DS:a,Ss:l}))});function dRe(n,e){if(n.isFinite()&&!n.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitAnd");var t=n.constructor;if(n.isNaN()||e.isNaN())return new t(NaN);if(n.isZero()||e.eq(-1)||n.eq(e))return n;if(e.isZero()||n.eq(-1))return e;if(!n.isFinite()||!e.isFinite()){if(!n.isFinite()&&!e.isFinite())return n.isNegative()===e.isNegative()?n:new t(0);if(!n.isFinite())return e.isNegative()?n:n.isNegative()?new t(0):e;if(!e.isFinite())return n.isNegative()?e:e.isNegative()?new t(0):n}return tU(n,e,function(r,i){return r&i})}function Rw(n){if(n.isFinite()&&!n.isInteger())throw new Error("Integer expected in function bitNot");var e=n.constructor,t=e.precision;e.config({precision:1e9});var r=n.plus(new e(1));return r.s=-r.s||null,e.config({precision:t}),r}function fRe(n,e){if(n.isFinite()&&!n.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitOr");var t=n.constructor;if(n.isNaN()||e.isNaN())return new t(NaN);var r=new t(-1);return n.isZero()||e.eq(r)||n.eq(e)?e:e.isZero()||n.eq(r)?n:!n.isFinite()||!e.isFinite()?!n.isFinite()&&!n.isNegative()&&e.isNegative()||n.isNegative()&&!e.isNegative()&&!e.isFinite()?r:n.isNegative()&&e.isNegative()?n.isFinite()?n:e:n.isFinite()?e:n:tU(n,e,function(i,s){return i|s})}function tU(n,e,t){var r=n.constructor,i,s,a=+(n.s<0),o=+(e.s<0);if(a){i=LT(Rw(n));for(var l=0;l<i.length;++l)i[l]^=1}else i=LT(n);if(o){s=LT(Rw(e));for(var u=0;u<s.length;++u)s[u]^=1}else s=LT(e);var c,h,d;i.length<=s.length?(c=i,h=s,d=a):(c=s,h=i,d=o);var f=c.length,p=h.length,m=t(a,o)^1,y=new r(m^1),v=new r(1),b=new r(2),x=r.precision;for(r.config({precision:1e9});f>0;)t(c[--f],h[--p])===m&&(y=y.plus(v)),v=v.times(b);for(;p>0;)t(d,h[--p])===m&&(y=y.plus(v)),v=v.times(b);return r.config({precision:x}),m===0&&(y.s=-y.s),y}function LT(n){for(var e=n.d,t=e[0]+"",r=1;r<e.length;++r){for(var i=e[r]+"",s=7-i.length;s--;)i="0"+i;t+=i}for(var a=t.length;t.charAt(a)==="0";)a--;var o=n.e,l=t.slice(0,a+1||1),u=l.length;if(o>0)if(++o>u)for(o-=u;o--;)l+="0";else o<u&&(l=l.slice(0,o)+"."+l.slice(o));for(var c=[0],h=0;h<l.length;){for(var d=c.length;d--;)c[d]*=10;c[0]+=parseInt(l.charAt(h++));for(var f=0;f<c.length;++f)c[f]>1&&((c[f+1]===null||c[f+1]===void 0)&&(c[f+1]=0),c[f+1]+=c[f]>>1,c[f]&=1)}return c.reverse()}function pRe(n,e){if(n.isFinite()&&!n.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function bitXor");var t=n.constructor;if(n.isNaN()||e.isNaN())return new t(NaN);if(n.isZero())return e;if(e.isZero())return n;if(n.eq(e))return new t(0);var r=new t(-1);return n.eq(r)?Rw(e):e.eq(r)?Rw(n):!n.isFinite()||!e.isFinite()?!n.isFinite()&&!e.isFinite()?r:new t(n.isNegative()===e.isNegative()?1/0:-1/0):tU(n,e,function(i,s){return i^s})}function mRe(n,e){if(n.isFinite()&&!n.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function leftShift");var t=n.constructor;return n.isNaN()||e.isNaN()||e.isNegative()&&!e.isZero()?new t(NaN):n.isZero()||e.isZero()?n:!n.isFinite()&&!e.isFinite()?new t(NaN):e.lt(55)?n.times(Math.pow(2,e.toNumber())+""):n.times(new t(2).pow(e))}function gRe(n,e){if(n.isFinite()&&!n.isInteger()||e.isFinite()&&!e.isInteger())throw new Error("Integers expected in function rightArithShift");var t=n.constructor;return n.isNaN()||e.isNaN()||e.isNegative()&&!e.isZero()?new t(NaN):n.isZero()||e.isZero()?n:e.isFinite()?e.lt(55)?n.div(Math.pow(2,e.toNumber())+"").floor():n.div(new t(2).pow(e)).floor():n.isNegative()?new t(-1):n.isFinite()?new t(0):new t(NaN)}var r7="bitAnd",vRe=["typed","matrix","equalScalar","concat"],Rne=ie(r7,vRe,n=>{var{typed:e,matrix:t,equalScalar:r,concat:i}=n,s=bu({typed:e,equalScalar:r}),a=BN({typed:e,equalScalar:r}),o=Rs({typed:e,equalScalar:r}),l=ar({typed:e,matrix:t,concat:i});return e(r7,{"number, number":Qte,"BigNumber, BigNumber":dRe,"bigint, bigint":(u,c)=>u&c},l({SS:a,DS:s,Ss:o}))}),i7="bitNot",yRe=["typed"],xRe=ie(i7,yRe,n=>{var{typed:e}=n;return e(i7,{number:Zte,BigNumber:Rw,bigint:t=>~t,"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),s7="bitOr",bRe=["typed","matrix","equalScalar","DenseMatrix","concat"],Ine=ie(s7,bRe,n=>{var{typed:e,matrix:t,equalScalar:r,DenseMatrix:i,concat:s}=n,a=Qp({typed:e}),o=J4({typed:e,equalScalar:r}),l=$v({typed:e,DenseMatrix:i}),u=ar({typed:e,matrix:t,concat:s});return e(s7,{"number, number":Jte,"BigNumber, BigNumber":fRe,"bigint, bigint":(c,h)=>c|h},u({SS:o,DS:a,Ss:l}))}),_Re="matAlgo07xSSf",wRe=["typed","SparseMatrix"],Fc=ie(_Re,wRe,n=>{var{typed:e,SparseMatrix:t}=n;return function(s,a,o){var l=s._size,u=s._datatype||s._data===void 0?s._datatype:s.getDataType(),c=a._size,h=a._datatype||a._data===void 0?a._datatype:a.getDataType();if(l.length!==c.length)throw new en(l.length,c.length);if(l[0]!==c[0]||l[1]!==c[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+c+")");var d=l[0],f=l[1],p,m=0,y=o;typeof u=="string"&&u===h&&u!=="mixed"&&(p=u,m=e.convert(0,p),y=e.find(o,[p,p]));for(var v=[],b=[],x=new Array(f+1).fill(0),w=[],_=[],E=[],A=[],T=0;T<f;T++){var S=T+1,M=0;r(s,T,E,w,S),r(a,T,A,_,S);for(var D=0;D<d;D++){var N=E[D]===S?w[D]:m,R=A[D]===S?_[D]:m,z=y(N,R);z!==0&&z!==!1&&(b.push(D),v.push(z),M++)}x[T+1]=x[T]+M}return new t({values:v,index:b,ptr:x,size:[d,f],datatype:u===s._datatype&&h===a._datatype?p:void 0})};function r(i,s,a,o,l){for(var u=i._values,c=i._index,h=i._ptr,d=h[s],f=h[s+1];d<f;d++){var p=c[d];a[p]=l,o[p]=u[d]}}}),a7="bitXor",ERe=["typed","matrix","DenseMatrix","concat","SparseMatrix"],SRe=ie(a7,ERe,n=>{var{typed:e,matrix:t,DenseMatrix:r,concat:i,SparseMatrix:s}=n,a=ia({typed:e}),o=Fc({typed:e,SparseMatrix:s}),l=Bi({typed:e,DenseMatrix:r}),u=ar({typed:e,matrix:t,concat:i});return e(a7,{"number, number":ene,"BigNumber, BigNumber":pRe,"bigint, bigint":(c,h)=>c^h},u({SS:o,DS:a,Ss:l}))}),o7="arg",ARe=["typed"],TRe=ie(o7,ARe,n=>{var{typed:e}=n;return e(o7,{number:function(r){return Math.atan2(0,r)},BigNumber:function(r){return r.constructor.atan2(0,r)},Complex:function(r){return r.arg()},"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),l7="conj",MRe=["typed"],CRe=ie(l7,MRe,n=>{var{typed:e}=n;return e(l7,{"number | BigNumber | Fraction":t=>t,Complex:t=>t.conjugate(),Unit:e.referToSelf(t=>r=>new r.constructor(t(r.toNumeric()),r.formatUnits())),"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),u7="im",DRe=["typed"],NRe=ie(u7,DRe,n=>{var{typed:e}=n;return e(u7,{number:()=>0,"BigNumber | Fraction":t=>t.mul(0),Complex:t=>t.im,"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),c7="re",RRe=["typed"],IRe=ie(c7,RRe,n=>{var{typed:e}=n;return e(c7,{"number | BigNumber | Fraction":t=>t,Complex:t=>t.re,"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),h7="not",PRe=["typed"],FRe=ie(h7,PRe,n=>{var{typed:e}=n;return e(h7,{"null | undefined":()=>!0,number:sne,Complex:function(r){return r.re===0&&r.im===0},BigNumber:function(r){return r.isZero()||r.isNaN()},bigint:t=>!t,Unit:e.referToSelf(t=>r=>e.find(t,r.valueType())(r.value)),"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),d7="nullish",LRe=["typed","matrix","size","flatten","deepEqual"],Pne=ie(d7,LRe,n=>{var{typed:e,matrix:t,size:r,flatten:i,deepEqual:s}=n,a=ia({typed:e}),o=Rl({typed:e}),l=Cne({typed:e});return e(d7,{"number|bigint|Complex|BigNumber|Fraction|Unit|string|boolean|SparseMatrix, any":(u,c)=>u,"null, any":(u,c)=>c,"undefined, any":(u,c)=>c,"SparseMatrix, Array | Matrix":(u,c)=>{var h=r(u),d=r(c);if(s(h,d))return u;throw new en(h,d)},"DenseMatrix, DenseMatrix":e.referToSelf(u=>(c,h)=>l(c,h,u)),"DenseMatrix, SparseMatrix":e.referToSelf(u=>(c,h)=>a(c,h,u,!1)),"DenseMatrix, Array":e.referToSelf(u=>(c,h)=>l(c,t(h),u)),"DenseMatrix, any":e.referToSelf(u=>(c,h)=>o(c,h,u,!1)),"Array, Array":e.referToSelf(u=>(c,h)=>l(t(c),t(h),u).valueOf()),"Array, DenseMatrix":e.referToSelf(u=>(c,h)=>l(t(c),h,u)),"Array, SparseMatrix":e.referToSelf(u=>(c,h)=>a(t(c),h,u,!1)),"Array, any":e.referToSelf(u=>(c,h)=>o(t(c),h,u,!1).valueOf())})}),f7="or",ORe=["typed","matrix","equalScalar","DenseMatrix","concat"],Fne=ie(f7,ORe,n=>{var{typed:e,matrix:t,equalScalar:r,DenseMatrix:i,concat:s}=n,a=ia({typed:e}),o=kN({typed:e,equalScalar:r}),l=Bi({typed:e,DenseMatrix:i}),u=ar({typed:e,matrix:t,concat:s});return e(f7,{"number, number":MO,"Complex, Complex":function(h,d){return h.re!==0||h.im!==0||d.re!==0||d.im!==0},"BigNumber, BigNumber":function(h,d){return!h.isZero()&&!h.isNaN()||!d.isZero()&&!d.isNaN()},"bigint, bigint":MO,"Unit, Unit":e.referToSelf(c=>(h,d)=>c(h.value||0,d.value||0))},u({SS:o,DS:a,Ss:l}))}),p7="xor",kRe=["typed","matrix","DenseMatrix","concat","SparseMatrix"],BRe=ie(p7,kRe,n=>{var{typed:e,matrix:t,DenseMatrix:r,concat:i,SparseMatrix:s}=n,a=ia({typed:e}),o=Fc({typed:e,SparseMatrix:s}),l=Bi({typed:e,DenseMatrix:r}),u=ar({typed:e,matrix:t,concat:i});return e(p7,{"number, number":CO,"Complex, Complex":function(h,d){return(h.re!==0||h.im!==0)!=(d.re!==0||d.im!==0)},"bigint, bigint":CO,"BigNumber, BigNumber":function(h,d){return(!h.isZero()&&!h.isNaN())!=(!d.isZero()&&!d.isNaN())},"Unit, Unit":e.referToSelf(c=>(h,d)=>c(h.value||0,d.value||0))},u({SS:o,DS:a,Ss:l}))}),m7="concat",URe=["typed","matrix","isInteger"],Lne=ie(m7,URe,n=>{var{typed:e,matrix:t,isInteger:r}=n;return e(m7,{"...Array | Matrix | number | BigNumber":function(s){var a,o=s.length,l=-1,u,c=!1,h=[];for(a=0;a<o;a++){var d=s[a];if(Dt(d)&&(c=!0),Tt(d)||jt(d)){if(a!==o-1)throw new Error("Dimension must be specified as last argument");if(u=l,l=d.valueOf(),!r(l))throw new TypeError("Integer number expected for dimension");if(l<0||a>0&&l>u)throw new yu(l,u+1)}else{var f=Ut(d).valueOf(),p=Vt(f);if(h[a]=f,u=l,l=p.length-1,a>0&&l!==u)throw new en(u+1,l+1)}}if(h.length===0)throw new SyntaxError("At least one matrix expected");for(var m=h.shift();h.length;)m=Fte(m,h.shift(),l);return c?t(m):m},"...string":function(s){return s.join("")}})}),g7="column",VRe=["typed","Index","matrix","range"],One=ie(g7,VRe,n=>{var{typed:e,Index:t,matrix:r,range:i}=n;return e(g7,{"Matrix, number":s,"Array, number":function(o,l){return s(r(Ut(o)),l).valueOf()}});function s(a,o){if(a.size().length!==2)throw new Error("Only two dimensional matrix is supported");ir(o,a.size()[1]);var l=i(0,a.size()[0]),u=new t(l,[o]),c=a.subset(u);return Dt(c)?c:r([[c]])}}),v7="count",zRe=["typed","size","prod"],$Re=ie(v7,zRe,n=>{var{typed:e,size:t,prod:r}=n;return e(v7,{string:function(s){return s.length},"Matrix | Array":function(s){return r(t(s))}})}),y7="cross",HRe=["typed","matrix","subtract","multiply"],GRe=ie(y7,HRe,n=>{var{typed:e,matrix:t,subtract:r,multiply:i}=n;return e(y7,{"Matrix, Matrix":function(o,l){return t(s(o.toArray(),l.toArray()))},"Matrix, Array":function(o,l){return t(s(o.toArray(),l))},"Array, Matrix":function(o,l){return t(s(o,l.toArray()))},"Array, Array":s});function s(a,o){var l=Math.max(Vt(a).length,Vt(o).length);a=kD(a),o=kD(o);var u=Vt(a),c=Vt(o);if(u.length!==1||c.length!==1||u[0]!==3||c[0]!==3)throw new RangeError("Vectors with length 3 expected (Size A = ["+u.join(", ")+"], B = ["+c.join(", ")+"])");var h=[r(i(a[1],o[2]),i(a[2],o[1])),r(i(a[2],o[0]),i(a[0],o[2])),r(i(a[0],o[1]),i(a[1],o[0]))];return l>1?[h]:h}}),x7="diag",jRe=["typed","matrix","DenseMatrix","SparseMatrix"],qRe=ie(x7,jRe,n=>{var{typed:e,matrix:t,DenseMatrix:r,SparseMatrix:i}=n;return e(x7,{Array:function(u){return s(u,0,Vt(u),null)},"Array, number":function(u,c){return s(u,c,Vt(u),null)},"Array, BigNumber":function(u,c){return s(u,c.toNumber(),Vt(u),null)},"Array, string":function(u,c){return s(u,0,Vt(u),c)},"Array, number, string":function(u,c,h){return s(u,c,Vt(u),h)},"Array, BigNumber, string":function(u,c,h){return s(u,c.toNumber(),Vt(u),h)},Matrix:function(u){return s(u,0,u.size(),u.storage())},"Matrix, number":function(u,c){return s(u,c,u.size(),u.storage())},"Matrix, BigNumber":function(u,c){return s(u,c.toNumber(),u.size(),u.storage())},"Matrix, string":function(u,c){return s(u,0,u.size(),c)},"Matrix, number, string":function(u,c,h){return s(u,c,u.size(),h)},"Matrix, BigNumber, string":function(u,c,h){return s(u,c.toNumber(),u.size(),h)}});function s(l,u,c,h){if(!bt(u))throw new TypeError("Second parameter in function diag must be an integer");var d=u>0?u:0,f=u<0?-u:0;switch(c.length){case 1:return a(l,u,h,c[0],f,d);case 2:return o(l,u,h,c,f,d)}throw new RangeError("Matrix for function diag must be 2 dimensional")}function a(l,u,c,h,d,f){var p=[h+d,h+f];if(c&&c!=="sparse"&&c!=="dense")throw new TypeError("Unknown matrix type ".concat(c,'"'));var m=c==="sparse"?i.diagonal(p,l,u):r.diagonal(p,l,u);return c!==null?m:m.valueOf()}function o(l,u,c,h,d,f){if(Dt(l)){var p=l.diagonal(u);return c!==null?c!==p.storage()?t(p,c):p:p.valueOf()}for(var m=Math.min(h[0]-d,h[1]-f),y=[],v=0;v<m;v++)y[v]=l[v+d][v+f];return c!==null?t(y):y}}),WRe="filter",XRe=["typed"],kne=ie(WRe,XRe,n=>{var{typed:e}=n;return e("filter",{"Array, function":b7,"Matrix, function":function(r,i){return r.create(b7(r.valueOf(),i),r.datatype())},"Array, RegExp":l$,"Matrix, RegExp":function(r,i){return r.create(l$(r.valueOf(),i),r.datatype())}})});function b7(n,e){var t=Rv(e,n,"filter");return t.isUnary?o$(n,t.fn):o$(n,function(r,i,s){return t.fn(r,[i],s)})}var _7="flatten",KRe=["typed"],YRe=ie(_7,KRe,n=>{var{typed:e}=n;return e(_7,{Array:function(r){return Tn(r)},DenseMatrix:function(r){return r.create(Tn(r.valueOf(),!0),r.datatype())},SparseMatrix:function(r){throw new TypeError("SparseMatrix is not supported by function flatten because it does not support 1D vectors. Convert to a DenseMatrix or Array first. Example: flatten(x.toArray())")}})}),FO="forEach",QRe=["typed"],Bne=ie(FO,QRe,n=>{var{typed:e}=n;return e(FO,{"Array, function":ZRe,"Matrix, function":function(r,i){r.forEach(i)}})});function ZRe(n,e){var t=Rv(e,n,FO);Ote(n,t.fn,t.isUnary)}var w7="getMatrixDataType",JRe=["typed"],eIe=ie(w7,JRe,n=>{var{typed:e}=n;return e(w7,{Array:function(r){return LN(r,Kn)},Matrix:function(r){return r.getDataType()}})}),E7="identity",tIe=["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],nIe=ie(E7,tIe,n=>{var{typed:e,config:t,matrix:r,BigNumber:i,DenseMatrix:s,SparseMatrix:a}=n;return e(E7,{"":function(){return t.matrix==="Matrix"?r([]):[]},string:function(c){return r(c)},"number | BigNumber":function(c){return l(c,c,t.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, string":function(c,h){return l(c,c,h)},"number | BigNumber, number | BigNumber":function(c,h){return l(c,h,t.matrix==="Matrix"?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(c,h,d){return l(c,h,d)},Array:function(c){return o(c)},"Array, string":function(c,h){return o(c,h)},Matrix:function(c){return o(c.valueOf(),c.storage())},"Matrix, string":function(c,h){return o(c.valueOf(),h)}});function o(u,c){switch(u.length){case 0:return c?r(c):[];case 1:return l(u[0],u[0],c);case 2:return l(u[0],u[1],c);default:throw new Error("Vector containing two values expected")}}function l(u,c,h){var d=jt(u)||jt(c)?i:null;if(jt(u)&&(u=u.toNumber()),jt(c)&&(c=c.toNumber()),!bt(u)||u<1)throw new Error("Parameters in function identity must be positive integers");if(!bt(c)||c<1)throw new Error("Parameters in function identity must be positive integers");var f=d?new i(1):1,p=d?new d(0):0,m=[u,c];if(h){if(h==="sparse")return a.diagonal(m,f,0,p);if(h==="dense")return s.diagonal(m,f,0,p);throw new TypeError('Unknown matrix type "'.concat(h,'"'))}for(var y=Eb([],m,p),v=u<c?u:c,b=0;b<v;b++)y[b][b]=f;return y}}),S7="kron",rIe=["typed","matrix","multiplyScalar"],iIe=ie(S7,rIe,n=>{var{typed:e,matrix:t,multiplyScalar:r}=n;return e(S7,{"Matrix, Matrix":function(o,l){return t(s(o.toArray(),l.toArray()))},"Matrix, Array":function(o,l){return t(s(o.toArray(),l))},"Array, Matrix":function(o,l){return t(s(o,l.toArray()))},"Array, Array":s});function i(a,o){return a.flatMap(l=>o.map(u=>r(l,u)))}function s(a,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;if(l<0){var u=Vt(a).length,c=Vt(o).length;for(l=Math.max(u,c);u++<l;)a=[a];for(;c++<l;)o=[o]}return l===1?i(a,o):a.flatMap(h=>o.map(d=>s(h,d,l-1)))}}),QI="map",sIe=["typed"],Une=ie(QI,sIe,n=>{var{typed:e}=n;return e(QI,{"Array, function":o,"Matrix, function":function(u,c){return u.map(c)},"Array|Matrix, Array|Matrix, ...Array|Matrix|function":(l,u,c)=>t([l,u,...c.slice(0,c.length-1)],c[c.length-1])});function t(l,u){if(typeof u!="function")throw new Error("Last argument must be a callback function");var c=l[0].isMatrix,h=l.map(_=>_.isMatrix?_.size():Vt(_)),d=UD(...h),f=l.length,p=c?(_,E)=>_.get(E):VD,m=l.map((_,E)=>{var A=h[E].map(()=>0);return _.isMatrix?_.get(A):VD(_,A)}),y=e.isTypedFunction(u)?a(u,m,d.map(()=>0),l):s(u,f);if(y<2){var v=i(y,u,null);return r(l,v)}var b=c?l.map(_=>_.isMatrix?_.create(qm(_.toArray(),d),_.datatype()):l[0].create(qm(_.valueOf(),d))):l.map(_=>_.isMatrix?qm(_.toArray(),d):qm(_,d)),x=i(y,u,b),w=(_,E)=>x([_,...b.slice(1).map(A=>p(A,E))],E);return c?b[0].map(w):o(b[0],w)}function r(l,u){var c=l[0],h=l.map(_=>_.isMatrix?_.valueOf():_),d=l.map(_=>_.isMatrix?_.size():Vt(_)),f=UD(...d),p=d.map(_=>f.length-_.length),m=f.length-1,y=u.length>1,v=y?[]:null,b=w(h,0);if(c.isMatrix){var x=c.create();return x._data=b,x._size=f,x}else return b;function w(_){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,A=f[E],T=Array(A);if(E<m)for(var S=function(z){v&&(v[E]=z),T[z]=w(_.map((j,I)=>p[I]>E?j:j.length===1?j[0]:j[z]),E+1)},M=0;M<A;M++)S(M);else for(var D=function(z){v&&(v[E]=z),T[z]=u(_.map(j=>j.length===1?j[0]:j[z]),v?v.slice():void 0)},N=0;N<A;N++)D(N);return T}}function i(l,u,c){switch(l){case 0:return h=>u(...h);case 1:return(h,d)=>u(...h,d);case 2:return(h,d)=>u(...h,d,...c)}}function s(l,u){var c=l.toString();if(/arguments/.test(c))return 2;var h=c.match(/\(.*?\)/);return/\.\.\./.test(h)||l.length>u+1?2:l.length===u+1?1:0}function a(l,u,c,h){return e.resolve(l,[...u,c,...h])!==null?2:e.resolve(l,[...u,c])!==null?1:(e.resolve(l,u)!==null,0)}function o(l,u){var c=Rv(u,l,QI);return SO(l,c.fn,c.isUnary)}}),A7="diff",aIe=["typed","matrix","subtract","number"],Vne=ie(A7,aIe,n=>{var{typed:e,matrix:t,subtract:r,number:i}=n;return e(A7,{"Array | Matrix":function(c){return Dt(c)?t(a(c.toArray())):a(c)},"Array | Matrix, number":function(c,h){if(!bt(h))throw new RangeError("Dimension must be a whole number");return Dt(c)?t(s(c.toArray(),h)):s(c,h)},"Array, BigNumber":e.referTo("Array,number",u=>(c,h)=>u(c,i(h))),"Matrix, BigNumber":e.referTo("Matrix,number",u=>(c,h)=>u(c,i(h)))});function s(u,c){if(Dt(u)&&(u=u.toArray()),!Array.isArray(u))throw RangeError("Array/Matrix does not have that many dimensions");if(c>0){var h=[];return u.forEach(d=>{h.push(s(d,c-1))}),h}else{if(c===0)return a(u);throw RangeError("Cannot have negative dimension")}}function a(u){for(var c=[],h=u.length,d=1;d<h;d++)c.push(o(u[d-1],u[d]));return c}function o(u,c){Dt(u)&&(u=u.toArray()),Dt(c)&&(c=c.toArray());var h=Array.isArray(u),d=Array.isArray(c);if(h&&d)return l(u,c);if(!h&&!d)return r(c,u);throw TypeError("Cannot calculate difference between 1 array and 1 non-array")}function l(u,c){if(u.length!==c.length)throw RangeError("Not all sub-arrays have the same length");for(var h=[],d=u.length,f=0;f<d;f++)h.push(o(u[f],c[f]));return h}}),oIe="ones",lIe=["typed","config","matrix","BigNumber"],uIe=ie(oIe,lIe,n=>{var{typed:e,config:t,matrix:r,BigNumber:i}=n;return e("ones",{"":function(){return t.matrix==="Array"?s([]):s([],"default")},"...number | BigNumber | string":function(u){var c=u[u.length-1];if(typeof c=="string"){var h=u.pop();return s(u,h)}else return t.matrix==="Array"?s(u):s(u,"default")},Array:s,Matrix:function(u){var c=u.storage();return s(u.valueOf(),c)},"Array | Matrix, string":function(u,c){return s(u.valueOf(),c)}});function s(l,u){var c=a(l),h=c?new i(1):1;if(o(l),u){var d=r(u);return l.length>0?d.resize(l,h):d}else{var f=[];return l.length>0?Eb(f,l,h):f}}function a(l){var u=!1;return l.forEach(function(c,h,d){jt(c)&&(u=!0,d[h]=c.toNumber())}),u}function o(l){l.forEach(function(u){if(typeof u!="number"||!bt(u)||u<0)throw new Error("Parameters in function ones must be positive integers")})}});function nU(){throw new Error('No "bignumber" implementation available')}function zne(){throw new Error('No "fraction" implementation available')}function cIe(){throw new Error('No "matrix" implementation available')}var T7="range",hIe=["typed","config","?matrix","?bignumber","equal","smaller","smallerEq","larger","largerEq","add","isZero","isPositive"],$ne=ie(T7,hIe,n=>{var{typed:e,config:t,matrix:r,bignumber:i,smaller:s,smallerEq:a,larger:o,largerEq:l,add:u,isZero:c,isPositive:h}=n;return e(T7,{string:f,"string, boolean":f,number:function(v){throw new TypeError("Too few arguments to function range(): ".concat(v))},boolean:function(v){throw new TypeError("Unexpected type of argument 1 to function range(): ".concat(v,", number|bigint|BigNumber|Fraction"))},"number, number":function(v,b){return d(p(v,b,1,!1))},"number, number, number":function(v,b,x){return d(p(v,b,x,!1))},"number, number, boolean":function(v,b,x){return d(p(v,b,1,x))},"number, number, number, boolean":function(v,b,x,w){return d(p(v,b,x,w))},"bigint, bigint|number":function(v,b){return d(p(v,b,1n,!1))},"number, bigint":function(v,b){return d(p(BigInt(v),b,1n,!1))},"bigint, bigint|number, bigint|number":function(v,b,x){return d(p(v,b,BigInt(x),!1))},"number, bigint, bigint|number":function(v,b,x){return d(p(BigInt(v),b,BigInt(x),!1))},"bigint, bigint|number, boolean":function(v,b,x){return d(p(v,b,1n,x))},"number, bigint, boolean":function(v,b,x){return d(p(BigInt(v),b,1n,x))},"bigint, bigint|number, bigint|number, boolean":function(v,b,x,w){return d(p(v,b,BigInt(x),w))},"number, bigint, bigint|number, boolean":function(v,b,x,w){return d(p(BigInt(v),b,BigInt(x),w))},"BigNumber, BigNumber":function(v,b){var x=v.constructor;return d(p(v,b,new x(1),!1))},"BigNumber, BigNumber, BigNumber":function(v,b,x){return d(p(v,b,x,!1))},"BigNumber, BigNumber, boolean":function(v,b,x){var w=v.constructor;return d(p(v,b,new w(1),x))},"BigNumber, BigNumber, BigNumber, boolean":function(v,b,x,w){return d(p(v,b,x,w))},"Fraction, Fraction":function(v,b){return d(p(v,b,1,!1))},"Fraction, Fraction, Fraction":function(v,b,x){return d(p(v,b,x,!1))},"Fraction, Fraction, boolean":function(v,b,x){return d(p(v,b,1,x))},"Fraction, Fraction, Fraction, boolean":function(v,b,x,w){return d(p(v,b,x,w))},"Unit, Unit, Unit":function(v,b,x){return d(p(v,b,x,!1))},"Unit, Unit, Unit, boolean":function(v,b,x,w){return d(p(v,b,x,w))}});function d(y){return t.matrix==="Matrix"?r?r(y):cIe():y}function f(y,v){var b=m(y);if(!b)throw new SyntaxError('String "'+y+'" is no valid range');return t.number==="BigNumber"?(i===void 0&&nU(),d(p(i(b.start),i(b.end),i(b.step)))):d(p(b.start,b.end,b.step,v))}function p(y,v,b,x){var w=[];if(c(b))throw new Error("Step must be non-zero");for(var _=h(b)?x?a:s:x?l:o,E=y;_(E,v);)w.push(E),E=u(E,b);return w}function m(y){var v=y.split(":"),b=v.map(function(w){return Number(w)}),x=b.some(function(w){return isNaN(w)});if(x)return null;switch(b.length){case 2:return{start:b[0],end:b[1],step:1};case 3:return{start:b[0],end:b[2],step:b[1]};default:return null}}}),M7="reshape",dIe=["typed","isInteger","matrix"],fIe=ie(M7,dIe,n=>{var{typed:e,isInteger:t}=n;return e(M7,{"Matrix, Array":function(i,s){return i.reshape(s,!0)},"Array, Array":function(i,s){return s.forEach(function(a){if(!t(a))throw new TypeError("Invalid size for dimension: "+a)}),K4(i,s)}})}),pIe="resize",mIe=["config","matrix"],gIe=ie(pIe,mIe,n=>{var{config:e,matrix:t}=n;return function(s,a,o){if(arguments.length!==2&&arguments.length!==3)throw new Hv("resize",arguments.length,2,3);if(Dt(a)&&(a=a.valueOf()),jt(a[0])&&(a=a.map(function(c){return jt(c)?c.toNumber():c})),Dt(s))return s.resize(a,o,!0);if(typeof s=="string")return r(s,a,o);var l=Array.isArray(s)?!1:e.matrix!=="Array";if(a.length===0){for(;Array.isArray(s);)s=s[0];return Ut(s)}else{Array.isArray(s)||(s=[s]),s=Ut(s);var u=Eb(s,a,o);return l?t(u):u}};function r(i,s,a){if(a!==void 0){if(typeof a!="string"||a.length!==1)throw new TypeError("Single character expected as defaultValue")}else a=" ";if(s.length!==1)throw new en(s.length,1);var o=s[0];if(typeof o!="number"||!bt(o))throw new TypeError("Invalid size, must contain positive integers (size: "+nn(s)+")");if(i.length>o)return i.substring(0,o);if(i.length<o){for(var l=i,u=0,c=o-i.length;u<c;u++)l+=a;return l}else return i}}),C7="rotate",vIe=["typed","multiply","rotationMatrix"],yIe=ie(C7,vIe,n=>{var{typed:e,multiply:t,rotationMatrix:r}=n;return e(C7,{"Array , number | BigNumber | Complex | Unit":function(a,o){i(a,2);var l=t(r(o),a);return l.toArray()},"Matrix , number | BigNumber | Complex | Unit":function(a,o){return i(a,2),t(r(o),a)},"Array, number | BigNumber | Complex | Unit, Array | Matrix":function(a,o,l){i(a,3);var u=t(r(o,l),a);return u},"Matrix, number | BigNumber | Complex | Unit, Array | Matrix":function(a,o,l){return i(a,3),t(r(o,l),a)}});function i(s,a){var o=Array.isArray(s)?Vt(s):s.size();if(o.length>2)throw new RangeError("Vector must be of dimensions 1x".concat(a));if(o.length===2&&o[1]!==1)throw new RangeError("Vector must be of dimensions 1x".concat(a));if(o[0]!==a)throw new RangeError("Vector must be of dimensions 1x".concat(a))}}),D7="rotationMatrix",xIe=["typed","config","multiplyScalar","addScalar","unaryMinus","norm","matrix","BigNumber","DenseMatrix","SparseMatrix","cos","sin"],bIe=ie(D7,xIe,n=>{var{typed:e,config:t,multiplyScalar:r,addScalar:i,unaryMinus:s,norm:a,BigNumber:o,matrix:l,DenseMatrix:u,SparseMatrix:c,cos:h,sin:d}=n;return e(D7,{"":function(){return t.matrix==="Matrix"?l([]):[]},string:function(x){return l(x)},"number | BigNumber | Complex | Unit":function(x){return f(x,t.matrix==="Matrix"?"dense":void 0)},"number | BigNumber | Complex | Unit, string":function(x,w){return f(x,w)},"number | BigNumber | Complex | Unit, Array":function(x,w){var _=l(w);return p(_),v(x,_,void 0)},"number | BigNumber | Complex | Unit, Matrix":function(x,w){p(w);var _=w.storage()||(t.matrix==="Matrix"?"dense":void 0);return v(x,w,_)},"number | BigNumber | Complex | Unit, Array, string":function(x,w,_){var E=l(w);return p(E),v(x,E,_)},"number | BigNumber | Complex | Unit, Matrix, string":function(x,w,_){return p(w),v(x,w,_)}});function f(b,x){var w=jt(b),_=w?new o(-1):-1,E=h(b),A=d(b),T=[[E,r(_,A)],[A,E]];return y(T,x)}function p(b){var x=b.size();if(x.length<1||x[0]!==3)throw new RangeError("Vector must be of dimensions 1x3")}function m(b){return b.reduce((x,w)=>r(x,w))}function y(b,x){if(x){if(x==="sparse")return new c(b);if(x==="dense")return new u(b);throw new TypeError('Unknown matrix type "'.concat(x,'"'))}return b}function v(b,x,w){var _=a(x);if(_===0)throw new RangeError("Rotation around zero vector");var E=jt(b)?o:null,A=E?new E(1):1,T=E?new E(-1):-1,S=E?new E(x.get([0])/_):x.get([0])/_,M=E?new E(x.get([1])/_):x.get([1])/_,D=E?new E(x.get([2])/_):x.get([2])/_,N=h(b),R=i(A,s(N)),z=d(b),j=i(N,m([S,S,R])),I=i(m([S,M,R]),m([T,D,z])),F=i(m([S,D,R]),m([M,z])),$=i(m([S,M,R]),m([D,z])),H=i(N,m([M,M,R])),Z=i(m([M,D,R]),m([T,S,z])),J=i(m([S,D,R]),m([T,M,z])),ee=i(m([M,D,R]),m([S,z])),O=i(N,m([D,D,R])),ue=[[j,I,F],[$,H,Z],[J,ee,O]];return y(ue,w)}}),N7="row",_Ie=["typed","Index","matrix","range"],Hne=ie(N7,_Ie,n=>{var{typed:e,Index:t,matrix:r,range:i}=n;return e(N7,{"Matrix, number":s,"Array, number":function(o,l){return s(r(Ut(o)),l).valueOf()}});function s(a,o){if(a.size().length!==2)throw new Error("Only two dimensional matrix is supported");ir(o,a.size()[0]);var l=i(0,a.size()[1]),u=new t([o],l),c=a.subset(u);return Dt(c)?c:r([[c]])}}),R7="size",wIe=["typed"],EIe=ie(R7,wIe,n=>{var{typed:e}=n;return e(R7,{Matrix:t=>t.size(),Array:Vt,string:t=>[t.length],"number | Complex | BigNumber | Unit | boolean | null":t=>[]})}),I7="squeeze",SIe=["typed"],AIe=ie(I7,SIe,n=>{var{typed:e}=n;return e(I7,{Array:function(r){return kD(Ut(r))},Matrix:function(r){var i=kD(r.toArray());return Array.isArray(i)?r.create(i,r.datatype()):i},any:function(r){return Ut(r)}})}),P7="subset",TIe=["typed","matrix","zeros","add"],Gne=ie(P7,TIe,n=>{var{typed:e,matrix:t,zeros:r,add:i}=n;return e(P7,{"Matrix, Index":function(o,l){return wb(l)?t():(OD(o,l),o.subset(l))},"Array, Index":e.referTo("Matrix, Index",function(a){return function(o,l){var u=a(t(o),l);return l.isScalar()?u:u.valueOf()}}),"Object, Index":CIe,"string, Index":MIe,"Matrix, Index, any, any":function(o,l,u,c){return wb(l)?o:(OD(o,l),o.clone().subset(l,s(u,l),c))},"Array, Index, any, any":e.referTo("Matrix, Index, any, any",function(a){return function(o,l,u,c){var h=a(t(o),l,u,c);return h.isMatrix?h.valueOf():h}}),"Array, Index, any":e.referTo("Matrix, Index, any, any",function(a){return function(o,l,u){return a(t(o),l,u,void 0).valueOf()}}),"Matrix, Index, any":e.referTo("Matrix, Index, any, any",function(a){return function(o,l,u){return a(o,l,u,void 0)}}),"string, Index, string":F7,"string, Index, string, string":F7,"Object, Index, any":DIe});function s(a,o){if(typeof a=="string")throw new Error("can't boradcast a string");if(o.isScalar())return a;var l=o.size();if(l.every(u=>u>0))try{return i(a,r(l))}catch{return a}else return a}});function MIe(n,e){if(!CN(e))throw new TypeError("Index expected");if(wb(e))return"";if(OD(Array.from(n),e),e.size().length!==1)throw new en(e.size().length,1);var t=n.length;ir(e.min()[0],t),ir(e.max()[0],t);var r=e.dimension(0),i="";function s(a){i+=n.charAt(a)}return Number.isInteger(r)?s(r):r.forEach(s),i}function F7(n,e,t,r){if(!e||e.isIndex!==!0)throw new TypeError("Index expected");if(wb(e))return n;if(OD(Array.from(n),e),e.size().length!==1)throw new en(e.size().length,1);if(r!==void 0){if(typeof r!="string"||r.length!==1)throw new TypeError("Single character expected as defaultValue")}else r=" ";var i=e.dimension(0),s=Number.isInteger(i)?1:i.size()[0];if(s!==t.length)throw new en(i.size()[0],t.length);var a=n.length;ir(e.min()[0]),ir(e.max()[0]);for(var o=[],l=0;l<a;l++)o[l]=n.charAt(l);function u(d,f){o[d]=t.charAt(f[0])}if(Number.isInteger(i)?u(i,[0]):i.forEach(u),o.length>a)for(var c=a-1,h=o.length;c<h;c++)o[c]||(o[c]=r);return o.join("")}function CIe(n,e){if(!wb(e)){if(e.size().length!==1)throw new en(e.size(),1);var t=e.dimension(0);if(typeof t!="string")throw new TypeError("String expected as index to retrieve an object property");return Ea(n,t)}}function DIe(n,e,t){if(wb(e))return n;if(e.size().length!==1)throw new en(e.size(),1);var r=e.dimension(0);if(typeof r!="string")throw new TypeError("String expected as index to retrieve an object property");var i=Ut(n);return bb(i,r,t),i}var L7="transpose",NIe=["typed","matrix"],RIe=ie(L7,NIe,n=>{var{typed:e,matrix:t}=n;return e(L7,{Array:a=>r(t(a)).valueOf(),Matrix:r,any:Ut});function r(a){var o=a.size(),l;switch(o.length){case 1:l=a.clone();break;case 2:{var u=o[0],c=o[1];if(c===0)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+nn(o)+")");switch(a.storage()){case"dense":l=i(a,u,c);break;case"sparse":l=s(a,u,c);break}}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+nn(o)+")")}return l}function i(a,o,l){for(var u=a._data,c=[],h,d=0;d<l;d++){h=c[d]=[];for(var f=0;f<o;f++)h[f]=Ut(u[f][d])}return a.createDenseMatrix({data:c,size:[l,o],datatype:a._datatype})}function s(a,o,l){for(var u=a._values,c=a._index,h=a._ptr,d=u?[]:void 0,f=[],p=[],m=[],y=0;y<o;y++)m[y]=0;var v,b,x;for(v=0,b=c.length;v<b;v++)m[c[v]]++;for(var w=0,_=0;_<o;_++)p.push(w),w+=m[_],m[_]=p[_];for(p.push(w),x=0;x<l;x++)for(var E=h[x],A=h[x+1],T=E;T<A;T++){var S=m[c[T]]++;f[S]=x,u&&(d[S]=Ut(u[T]))}return a.createSparseMatrix({values:d,index:f,ptr:p,size:[l,o],datatype:a._datatype})}}),O7="ctranspose",IIe=["typed","transpose","conj"],PIe=ie(O7,IIe,n=>{var{typed:e,transpose:t,conj:r}=n;return e(O7,{any:function(s){return r(t(s))}})}),k7="zeros",FIe=["typed","config","matrix","BigNumber"],LIe=ie(k7,FIe,n=>{var{typed:e,config:t,matrix:r,BigNumber:i}=n;return e(k7,{"":function(){return t.matrix==="Array"?s([]):s([],"default")},"...number | BigNumber | string":function(u){var c=u[u.length-1];if(typeof c=="string"){var h=u.pop();return s(u,h)}else return t.matrix==="Array"?s(u):s(u,"default")},Array:s,Matrix:function(u){var c=u.storage();return s(u.valueOf(),c)},"Array | Matrix, string":function(u,c){return s(u.valueOf(),c)}});function s(l,u){var c=a(l),h=c?new i(0):0;if(o(l),u){var d=r(u);return l.length>0?d.resize(l,h):d}else{var f=[];return l.length>0?Eb(f,l,h):f}}function a(l){var u=!1;return l.forEach(function(c,h,d){jt(c)&&(u=!0,d[h]=c.toNumber())}),u}function o(l){l.forEach(function(u){if(typeof u!="number"||!bt(u)||u<0)throw new Error("Parameters in function zeros must be positive integers")})}}),B7="fft",OIe=["typed","matrix","addScalar","multiplyScalar","divideScalar","exp","tau","i","dotDivide","conj","pow","ceil","log2"],kIe=ie(B7,OIe,n=>{var{typed:e,matrix:t,addScalar:r,multiplyScalar:i,divideScalar:s,exp:a,tau:o,i:l,dotDivide:u,conj:c,pow:h,ceil:d,log2:f}=n;return e(B7,{Array:p,Matrix:function(x){return x.create(p(x.valueOf()),x.datatype())}});function p(b){var x=Vt(b);return x.length===1?v(b,x[0]):m(b.map(w=>p(w,x.slice(1))),0)}function m(b,x){var w=Vt(b);if(x!==0)return new Array(w[0]).fill(0).map((E,A)=>m(b[A],x-1));if(w.length===1)return v(b);function _(E){var A=Vt(E);return new Array(A[1]).fill(0).map((T,S)=>new Array(A[0]).fill(0).map((M,D)=>E[D][S]))}return _(m(_(b),1))}function y(b){for(var x=b.length,w=a(s(i(-1,i(l,o)),x)),_=[],E=1-x;E<x;E++)_.push(h(w,s(h(E,2),2)));for(var A=h(2,d(f(x+x-1))),T=[...new Array(x).fill(0).map((I,F)=>i(b[F],_[x-1+F])),...new Array(A-x).fill(0)],S=[...new Array(x+x-1).fill(0).map((I,F)=>s(1,_[F])),...new Array(A-(x+x-1)).fill(0)],M=v(T),D=v(S),N=new Array(A).fill(0).map((I,F)=>i(M[F],D[F])),R=u(c(p(c(N))),A),z=[],j=x-1;j<x+x-1;j++)z.push(i(R[j],_[j]));return z}function v(b){var x=b.length;if(x===1)return[b[0]];if(x%2===0){for(var w=[...v(b.filter((T,S)=>S%2===0)),...v(b.filter((T,S)=>S%2===1))],_=0;_<x/2;_++){var E=w[_],A=i(w[_+x/2],a(i(i(o,l),s(-_,x))));w[_]=r(E,A),w[_+x/2]=r(E,i(-1,A))}return w}else return y(b)}}),U7="ifft",BIe=["typed","fft","dotDivide","conj"],UIe=ie(U7,BIe,n=>{var{typed:e,fft:t,dotDivide:r,conj:i}=n;return e(U7,{"Array | Matrix":function(a){var o=Dt(a)?a.size():Vt(a);return r(i(t(i(a))),o.reduce((l,u)=>l*u,1))}})});function Iw(n){"@babel/helpers - typeof";return Iw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Iw(n)}function VIe(n,e){if(Iw(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(Iw(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function zIe(n){var e=VIe(n,"string");return Iw(e)=="symbol"?e:e+""}function bi(n,e,t){return(e=zIe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function V7(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function $Ie(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?V7(Object(t),!0).forEach(function(r){bi(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):V7(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var HIe="solveODE",GIe=["typed","add","subtract","multiply","divide","max","map","abs","isPositive","isNegative","larger","smaller","matrix","bignumber","unaryMinus"],jIe=ie(HIe,GIe,n=>{var{typed:e,add:t,subtract:r,multiply:i,divide:s,max:a,map:o,abs:l,isPositive:u,isNegative:c,larger:h,smaller:d,matrix:f,bignumber:p,unaryMinus:m}=n;function y(T){return function(S,M,D,N){var R=!(M.length===2&&(M.every(E)||M.every(Ro)));if(R)throw new Error('"tspan" must be an Array of two numeric values or two units [tStart, tEnd]');var z=M[0],j=M[1],I=h(j,z),F=N.firstStep;if(F!==void 0&&!u(F))throw new Error('"firstStep" must be positive');var $=N.maxStep;if($!==void 0&&!u($))throw new Error('"maxStep" must be positive');var H=N.minStep;if(H&&c(H))throw new Error('"minStep" must be positive or zero');var Z=[z,j,F,H,$].filter(L=>L!==void 0);if(!(Z.every(E)||Z.every(Ro)))throw new Error('Inconsistent type of "t" dependant variables');for(var J=1,ee=N.tol?N.tol:1e-4,O=N.minDelta?N.minDelta:.2,ue=N.maxDelta?N.maxDelta:5,Q=N.maxIter?N.maxIter:1e4,re=[z,j,...D,$,H].some(jt),[le,te,Y,oe]=re?[p(T.a),p(T.c),p(T.b),p(T.bp)]:[T.a,T.c,T.b,T.bp],ve=F?I?F:m(F):s(r(j,z),J),me=[z],be=[D],_e=r(Y,oe),Be=0,ze=0,tt=w(I),de=_(I);tt(me[Be],j);){var Xe=[];ve=de(me[Be],j,ve),Xe.push(S(me[Be],be[Be]));for(var Ke=1;Ke<te.length;++Ke)Xe.push(S(t(me[Be],i(te[Ke],ve)),t(be[Be],i(ve,le[Ke],Xe))));var se=a(l(o(i(_e,Xe),L=>Ro(L)?L.value:L)));se<ee&&ee/se>1/4&&(me.push(t(me[Be],ve)),be.push(t(be[Be],i(ve,Y,Xe))),Be++);var fe=.84*(ee/se)**(1/5);if(d(fe,O)?fe=O:h(fe,ue)&&(fe=ue),fe=re?p(fe):fe,ve=i(ve,fe),$&&h(l(ve),$)?ve=I?$:m($):H&&d(l(ve),H)&&(ve=I?H:m(H)),ze++,ze>Q)throw new Error("Maximum number of iterations reached, try changing options")}return{t:me,y:be}}}function v(T,S,M,D){var N=[[],[.5],[0,.75],[.2222222222222222,.3333333333333333,.4444444444444444]],R=[null,1/2,3/4,1],z=[2/9,1/3,4/9,0],j=[7/24,1/4,1/3,1/8],I={a:N,c:R,b:z,bp:j};return y(I)(T,S,M,D)}function b(T,S,M,D){var N=[[],[.2],[.075,.225],[.9777777777777777,-3.7333333333333334,3.5555555555555554],[2.9525986892242035,-11.595793324188385,9.822892851699436,-.2908093278463649],[2.8462752525252526,-10.757575757575758,8.906422717743473,.2784090909090909,-.2735313036020583],[.09114583333333333,0,.44923629829290207,.6510416666666666,-.322376179245283,.13095238095238096]],R=[null,1/5,3/10,4/5,8/9,1,1],z=[35/384,0,500/1113,125/192,-2187/6784,11/84,0],j=[5179/57600,0,7571/16695,393/640,-92097/339200,187/2100,1/40],I={a:N,c:R,b:z,bp:j};return y(I)(T,S,M,D)}function x(T,S,M,D){var N=D.method?D.method:"RK45",R={RK23:v,RK45:b};if(N.toUpperCase()in R){var z=$Ie({},D);return delete z.method,R[N.toUpperCase()](T,S,M,z)}else{var j=Object.keys(R).map(F=>'"'.concat(F,'"')),I="".concat(j.slice(0,-1).join(", ")," and ").concat(j.slice(-1));throw new Error('Unavailable method "'.concat(N,'". Available methods are ').concat(I))}}function w(T){return T?d:h}function _(T){var S=T?h:d;return function(M,D,N){var R=t(M,N);return S(R,D)?r(D,M):N}}function E(T){return jt(T)||Tt(T)}function A(T,S,M,D){var N=x(T,S.toArray(),M.toArray(),D);return{t:f(N.t),y:f(N.y)}}return e("solveODE",{"function, Array, Array, Object":x,"function, Matrix, Matrix, Object":A,"function, Array, Array":(T,S,M)=>x(T,S,M,{}),"function, Matrix, Matrix":(T,S,M)=>A(T,S,M,{}),"function, Array, number | BigNumber | Unit":(T,S,M)=>{var D=x(T,S,[M],{});return{t:D.t,y:D.y.map(N=>N[0])}},"function, Matrix, number | BigNumber | Unit":(T,S,M)=>{var D=x(T,S.toArray(),[M],{});return{t:f(D.t),y:f(D.y.map(N=>N[0]))}},"function, Array, number | BigNumber | Unit, Object":(T,S,M,D)=>{var N=x(T,S,[M],D);return{t:N.t,y:N.y.map(R=>R[0])}},"function, Matrix, number | BigNumber | Unit, Object":(T,S,M,D)=>{var N=x(T,S.toArray(),[M],D);return{t:f(N.t),y:f(N.y.map(R=>R[0]))}}})}),qIe="erf",WIe=["typed"],XIe=ie(qIe,WIe,n=>{var{typed:e}=n;return e("name",{number:function(a){var o=Math.abs(a);return o>=QIe?np(a):o<=KIe?np(a)*t(o):o<=4?np(a)*(1-r(o)):np(a)*(1-i(o))},"Array | Matrix":e.referToSelf(s=>a=>qt(a,s))});function t(s){var a=s*s,o=Wc[0][4]*a,l=a,u;for(u=0;u<3;u+=1)o=(o+Wc[0][u])*a,l=(l+E0[0][u])*a;return s*(o+Wc[0][3])/(l+E0[0][3])}function r(s){var a=Wc[1][8]*s,o=s,l;for(l=0;l<7;l+=1)a=(a+Wc[1][l])*s,o=(o+E0[1][l])*s;var u=(a+Wc[1][7])/(o+E0[1][7]),c=parseInt(s*16)/16,h=(s-c)*(s+c);return Math.exp(-c*c)*Math.exp(-h)*u}function i(s){var a=1/(s*s),o=Wc[2][5]*a,l=a,u;for(u=0;u<4;u+=1)o=(o+Wc[2][u])*a,l=(l+E0[2][u])*a;var c=a*(o+Wc[2][4])/(l+E0[2][4]);c=(YIe-c)/s,a=parseInt(s*16)/16;var h=(s-a)*(s+a);return Math.exp(-a*a)*Math.exp(-h)*c}}),KIe=.46875,YIe=.5641895835477563,Wc=[[3.1611237438705655,113.86415415105016,377.485237685302,3209.3775891384694,.18577770618460315],[.5641884969886701,8.883149794388377,66.11919063714163,298.6351381974001,881.952221241769,1712.0476126340707,2051.0783778260716,1230.3393547979972,21531153547440383e-24],[.30532663496123236,.36034489994980445,.12578172611122926,.016083785148742275,.0006587491615298378,.016315387137302097]],E0=[[23.601290952344122,244.02463793444417,1282.6165260773723,2844.236833439171],[15.744926110709835,117.6939508913125,537.1811018620099,1621.3895745666903,3290.7992357334597,4362.619090143247,3439.3676741437216,1230.3393548037495],[2.568520192289822,1.8729528499234604,.5279051029514285,.06051834131244132,.0023352049762686918]],QIe=Math.pow(2,53),z7="zeta",ZIe=["typed","config","multiply","pow","divide","factorial","equal","smallerEq","isBounded","isNegative","gamma","sin","subtract","add","?Complex","?BigNumber","pi"],JIe=ie(z7,ZIe,n=>{var{typed:e,config:t,multiply:r,pow:i,divide:s,factorial:a,equal:o,smallerEq:l,isBounded:u,isNegative:c,gamma:h,sin:d,subtract:f,add:p,Complex:m,BigNumber:y,pi:v}=n;return e(z7,{number:A=>b(A,T=>T,()=>20),BigNumber:A=>b(A,T=>new y(T),()=>Math.abs(Math.log10(t.relTol))),Complex:x});function b(A,T,S){return o(A,0)?T(-.5):o(A,1)?T(NaN):u(A)?w(A,T,S,M=>M):c(A)?T(NaN):T(1)}function x(A){return A.re===0&&A.im===0?new m(-.5):A.re===1?new m(NaN,NaN):A.re===1/0&&A.im===0?new m(1):A.im===1/0||A.re===-1/0?new m(NaN,NaN):w(A,T=>T,T=>Math.round(1.3*15+.9*Math.abs(T.im)),T=>T.re)}function w(A,T,S,M){var D=S(A);if(M(A)>-(D-1)/2)return E(A,T(D),T);var N=r(i(2,A),i(T(v),f(A,1)));return N=r(N,d(r(s(T(v),2),A))),N=r(N,h(f(1,A))),r(N,w(f(1,A),T,S,M))}function _(A,T){for(var S=A,M=A;l(M,T);M=p(M,1)){var D=s(r(a(p(T,f(M,1))),i(4,M)),r(a(f(T,M)),a(r(2,M))));S=p(S,D)}return r(T,S)}function E(A,T,S){for(var M=s(1,r(_(S(0),T),f(1,i(2,f(1,A))))),D=S(0),N=S(1);l(N,T);N=p(N,1))D=p(D,s(r((-1)**(N-1),_(N,T)),i(N,A)));return r(M,D)}}),$7="mode",ePe=["typed","isNaN","isNumeric"],tPe=ie($7,ePe,n=>{var{typed:e,isNaN:t,isNumeric:r}=n;return e($7,{"Array | Matrix":i,"...":function(a){return i(a)}});function i(s){s=Tn(s.valueOf());var a=s.length;if(a===0)throw new Error("Cannot calculate mode of an empty array");for(var o={},l=[],u=0,c=0;c<s.length;c++){var h=s[c];if(r(h)&&t(h))throw new Error("Cannot calculate mode of an array containing NaN values");h in o||(o[h]=0),o[h]++,o[h]===u?l.push(h):o[h]>u&&(u=o[h],l=[h])}return l}});function Ca(n,e,t){var r;return String(n).includes("Unexpected type")?(r=arguments.length>2?" (type: "+Kn(t)+", value: "+JSON.stringify(t)+")":" (type: "+n.data.actual+")",new TypeError("Cannot calculate "+e+", unexpected type of argument"+r)):String(n).includes("complex numbers")?(r=arguments.length>2?" (type: "+Kn(t)+", value: "+JSON.stringify(t)+")":"",new TypeError("Cannot calculate "+e+", no ordering relation is defined for complex numbers"+r)):n}var H7="prod",nPe=["typed","config","multiplyScalar","numeric"],rPe=ie(H7,nPe,n=>{var{typed:e,config:t,multiplyScalar:r,numeric:i}=n;return e(H7,{"Array | Matrix":s,"Array | Matrix, number | BigNumber":function(o,l){throw new Error("prod(A, dim) is not yet supported")},"...":function(o){return s(o)}});function s(a){var o;if(kp(a,function(l){try{o=o===void 0?l:r(o,l)}catch(u){throw Ca(u,"prod",l)}}),typeof o=="string"&&(o=i(o,Kp(o,t))),o===void 0)throw new Error("Cannot calculate prod of an empty array");return o}}),G7="format",iPe=["typed"],sPe=ie(G7,iPe,n=>{var{typed:e}=n;return e(G7,{any:nn,"any, Object | function | number | BigNumber":nn})}),j7="bin",aPe=["typed","format"],oPe=ie(j7,aPe,n=>{var{typed:e,format:t}=n;return e(j7,{"number | BigNumber":function(i){return t(i,{notation:"bin"})},"number | BigNumber, number | BigNumber":function(i,s){return t(i,{notation:"bin",wordSize:s})}})}),q7="oct",lPe=["typed","format"],uPe=ie(q7,lPe,n=>{var{typed:e,format:t}=n;return e(q7,{"number | BigNumber":function(i){return t(i,{notation:"oct"})},"number | BigNumber, number | BigNumber":function(i,s){return t(i,{notation:"oct",wordSize:s})}})}),W7="hex",cPe=["typed","format"],hPe=ie(W7,cPe,n=>{var{typed:e,format:t}=n;return e(W7,{"number | BigNumber":function(i){return t(i,{notation:"hex"})},"number | BigNumber, number | BigNumber":function(i,s){return t(i,{notation:"hex",wordSize:s})}})}),jne=/\$([\w.]+)/g,X7="print",dPe=["typed"],qne=ie(X7,dPe,n=>{var{typed:e}=n;return e(X7,{"string, Object | Array":K7,"string, Object | Array, number | Object":K7})});function K7(n,e,t){return n.replace(jne,function(r,i){var s=i.split("."),a=e[s.shift()];for(a!==void 0&&a.isMatrix&&(a=a.toArray());s.length&&a!==void 0;){var o=s.shift();a=o?a[o]:a+"."}return a!==void 0?Qr(a)?a:nn(a,t):r})}var Y7="to",fPe=["typed","matrix","concat"],pPe=ie(Y7,fPe,n=>{var{typed:e,matrix:t,concat:r}=n,i=ar({typed:e,matrix:t,concat:r});return e(Y7,{"Unit, Unit | string":(s,a)=>s.to(a)},i({Ds:!0}))}),Q7="toBest",mPe=["typed"],gPe=ie(Q7,mPe,n=>{var{typed:e}=n;return e(Q7,{Unit:t=>t.toBest(),"Unit, string":(t,r)=>t.toBest(r.split(",")),"Unit, string, Object":(t,r,i)=>t.toBest(r.split(","),i),"Unit, Array":(t,r)=>t.toBest(r),"Unit, Array, Object":(t,r,i)=>t.toBest(r,i)})}),Z7="isPrime",vPe=["typed"],yPe=ie(Z7,vPe,n=>{var{typed:e}=n;return e(Z7,{number:function(r){if(r<=3)return r>1;if(r%2===0||r%3===0)return!1;for(var i=5;i*i<=r;i+=6)if(r%i===0||r%(i+2)===0)return!1;return!0},bigint:function(r){if(r<=3n)return r>1n;if(r%2n===0n||r%3n===0n)return!1;for(var i=5n;i*i<=r;i+=6n)if(r%i===0n||r%(i+2n)===0n)return!1;return!0},BigNumber:function(r){if(r.lte(3))return r.gt(1);if(r.mod(2).eq(0)||r.mod(3).eq(0))return!1;if(r.lt(Math.pow(2,32))){for(var i=r.toNumber(),s=5;s*s<=i;s+=6)if(i%s===0||i%(s+2)===0)return!1;return!0}function a(b,x,w){for(var _=1;!x.eq(0);)x.mod(2).eq(0)?(x=x.div(2),b=b.mul(b).mod(w)):(x=x.sub(1),_=b.mul(_).mod(w));return _}var o=r.constructor.clone({precision:r.toFixed(0).length*2});r=new o(r);for(var l=0,u=r.sub(1);u.mod(2).eq(0);)u=u.div(2),l+=1;var c=null;if(r.lt("3317044064679887385961981"))c=[2,3,5,7,11,13,17,19,23,29,31,37,41].filter(b=>b<r);else{var h=Math.min(r.toNumber()-2,Math.floor(2*Math.pow(r.toFixed(0).length*Math.log(10),2)));c=[];for(var d=2;d<=h;d+=1)c.push(h)}for(var f=0;f<c.length;f+=1){var p=c[f],m=a(r.sub(r).add(p),u,r);if(!m.eq(1)){for(var y=0,v=m;!v.eq(r.sub(1));y+=1,v=v.mul(v).mod(r))if(y===l-1)return!1}}return!0},"Array | Matrix":e.referToSelf(t=>r=>qt(r,t))})}),xPe="numeric",bPe=["number","?bignumber","?fraction"],_Pe=ie(xPe,bPe,n=>{var{number:e,bignumber:t,fraction:r}=n,i={string:!0,number:!0,BigNumber:!0,Fraction:!0},s={number:a=>e(a),BigNumber:t?a=>t(a):nU,bigint:a=>BigInt(a),Fraction:r?a=>r(a):zne};return function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"number",u=arguments.length>2?arguments[2]:void 0;if(u!==void 0)throw new SyntaxError("numeric() takes one or two arguments");var c=Kn(o);if(!(c in i))throw new TypeError("Cannot convert "+o+' of type "'+c+'"; valid input types are '+Object.keys(i).join(", "));if(!(l in s))throw new TypeError("Cannot convert "+o+' to type "'+l+'"; valid output types are '+Object.keys(s).join(", "));return l===c?o:s[l](o)}}),J7="divideScalar",wPe=["typed","numeric"],EPe=ie(J7,wPe,n=>{var{typed:e,numeric:t}=n;return e(J7,{"number, number":function(i,s){return i/s},"Complex, Complex":function(i,s){return i.div(s)},"BigNumber, BigNumber":function(i,s){return i.div(s)},"bigint, bigint":function(i,s){return i/s},"Fraction, Fraction":function(i,s){return i.div(s)},"Unit, number | Complex | Fraction | BigNumber | Unit":(r,i)=>r.divide(i),"number | Fraction | Complex | BigNumber, Unit":(r,i)=>i.divideInto(r)})}),eH="pow",SPe=["typed","config","identity","multiply","matrix","inv","fraction","number","Complex"],APe=ie(eH,SPe,n=>{var{typed:e,config:t,identity:r,multiply:i,matrix:s,inv:a,number:o,fraction:l,Complex:u}=n;return e(eH,{"number, number":c,"Complex, Complex":function(p,m){return p.pow(m)},"BigNumber, BigNumber":function(p,m){return m.isInteger()||p>=0||t.predictable?p.pow(m):new u(p.toNumber(),0).pow(m.toNumber(),0)},"bigint, bigint":(f,p)=>f**p,"Fraction, Fraction":function(p,m){var y=p.pow(m);if(y!=null)return y;if(t.predictable)throw new Error("Result of pow is non-rational and cannot be expressed as a fraction");return c(p.valueOf(),m.valueOf())},"Array, number":h,"Array, BigNumber":function(p,m){return h(p,m.toNumber())},"Matrix, number":d,"Matrix, BigNumber":function(p,m){return d(p,m.toNumber())},"Unit, number | BigNumber":function(p,m){return p.pow(m)}});function c(f,p){if(t.predictable&&!bt(p)&&f<0)try{var m=l(p),y=o(m);if((p===y||Math.abs((p-y)/p)<1e-14)&&m.d%2n===1n)return(m.n%2n===0n?1:-1)*Math.pow(-f,p)}catch{}return t.predictable&&(f<-1&&p===1/0||f>-1&&f<0&&p===-1/0)?NaN:bt(p)||f>=0||t.predictable?Yte(f,p):f*f<1&&p===1/0||f*f>1&&p===-1/0?0:new u(f,0).pow(p,0)}function h(f,p){if(!bt(p))throw new TypeError("For A^b, b must be an integer (value is "+p+")");var m=Vt(f);if(m.length!==2)throw new Error("For A^b, A must be 2 dimensional (A has "+m.length+" dimensions)");if(m[0]!==m[1])throw new Error("For A^b, A must be square (size is "+m[0]+"x"+m[1]+")");if(p<0)try{return h(a(f),-p)}catch(b){throw b.message==="Cannot calculate inverse, determinant is zero"?new TypeError("For A^b, when A is not invertible, b must be a positive integer (value is "+p+")"):b}for(var y=r(m[0]).valueOf(),v=f;p>=1;)(p&1)===1&&(y=i(v,y)),p>>=1,v=i(v,v);return y}function d(f,p){return s(h(f.valueOf(),p))}}),S0="Number of decimals in function round must be an integer",tH="round",TPe=["typed","config","matrix","equalScalar","zeros","BigNumber","DenseMatrix"],MPe=ie(tH,TPe,n=>{var{typed:e,config:t,matrix:r,equalScalar:i,zeros:s,BigNumber:a,DenseMatrix:o}=n,l=Rs({typed:e,equalScalar:i}),u=Bi({typed:e,DenseMatrix:o}),c=Rl({typed:e});function h(d){return Math.abs(aA(d).exponent)}return e(tH,{number:function(f){var p=N_(f,h(t.relTol)),m=as(f,p,t.relTol,t.absTol)?p:f;return N_(m)},"number, number":function(f,p){var m=h(t.relTol);if(p>=m)return N_(f,p);var y=N_(f,m),v=as(f,y,t.relTol,t.absTol)?y:f;return N_(v,p)},"number, BigNumber":function(f,p){if(!p.isInteger())throw new TypeError(S0);return new a(f).toDecimalPlaces(p.toNumber())},Complex:function(f){return f.round()},"Complex, number":function(f,p){if(p%1)throw new TypeError(S0);return f.round(p)},"Complex, BigNumber":function(f,p){if(!p.isInteger())throw new TypeError(S0);var m=p.toNumber();return f.round(m)},BigNumber:function(f){var p=new a(f).toDecimalPlaces(h(t.relTol)),m=Dl(f,p,t.relTol,t.absTol)?p:f;return m.toDecimalPlaces(0)},"BigNumber, BigNumber":function(f,p){if(!p.isInteger())throw new TypeError(S0);var m=h(t.relTol);if(p>=m)return f.toDecimalPlaces(p.toNumber());var y=f.toDecimalPlaces(m),v=Dl(f,y,t.relTol,t.absTol)?y:f;return v.toDecimalPlaces(p.toNumber())},bigint:d=>d,"bigint, number":(d,f)=>d,"bigint, BigNumber":(d,f)=>d,Fraction:function(f){return f.round()},"Fraction, number":function(f,p){if(p%1)throw new TypeError(S0);return f.round(p)},"Fraction, BigNumber":function(f,p){if(!p.isInteger())throw new TypeError(S0);return f.round(p.toNumber())},"Unit, number, Unit":e.referToSelf(d=>function(f,p,m){var y=f.toNumeric(m);return m.multiply(d(y,p))}),"Unit, BigNumber, Unit":e.referToSelf(d=>(f,p,m)=>d(f,p.toNumber(),m)),"Array | Matrix, number | BigNumber, Unit":e.referToSelf(d=>(f,p,m)=>qt(f,y=>d(y,p,m),!0)),"Array | Matrix | Unit, Unit":e.referToSelf(d=>(f,p)=>d(f,0,p)),"Array | Matrix":e.referToSelf(d=>f=>qt(f,d,!0)),"SparseMatrix, number | BigNumber":e.referToSelf(d=>(f,p)=>l(f,p,d,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(d=>(f,p)=>c(f,p,d,!1)),"Array, number | BigNumber":e.referToSelf(d=>(f,p)=>c(r(f),p,d,!1).valueOf()),"number | Complex | BigNumber | Fraction, SparseMatrix":e.referToSelf(d=>(f,p)=>i(f,0)?s(p.size(),p.storage()):u(p,f,d,!0)),"number | Complex | BigNumber | Fraction, DenseMatrix":e.referToSelf(d=>(f,p)=>i(f,0)?s(p.size(),p.storage()):c(p,f,d,!0)),"number | Complex | BigNumber | Fraction, Array":e.referToSelf(d=>(f,p)=>c(r(p),f,d,!0).valueOf())})}),nH="log",CPe=["config","typed","typeOf","divideScalar","Complex"],DPe=Math.log(16),NPe=ie(nH,CPe,n=>{var{typed:e,typeOf:t,config:r,divideScalar:i,Complex:s}=n;function a(l){return l.log()}function o(l){return a(new s(l,0))}return e(nH,{number:function(u){return u>=0||r.predictable?p$(u):o(u)},bigint:eU(DPe,p$,r,o),Complex:a,BigNumber:function(u){return!u.isNegative()||r.predictable?u.ln():o(u.toNumber())},"any, any":e.referToSelf(l=>(u,c)=>{if(t(u)==="Fraction"&&t(c)==="Fraction"){var h=u.log(c);if(h!==null)return h}return i(l(u),l(c))})})}),rH="log1p",RPe=["typed","config","divideScalar","log","Complex"],IPe=ie(rH,RPe,n=>{var{typed:e,config:t,divideScalar:r,log:i,Complex:s}=n;return e(rH,{number:function(l){return l>=-1||t.predictable?_Me(l):a(new s(l,0))},Complex:a,BigNumber:function(l){var u=l.plus(1);return!u.isNegative()||t.predictable?u.ln():a(new s(l.toNumber(),0))},"Array | Matrix":e.referToSelf(o=>l=>qt(l,o)),"any, any":e.referToSelf(o=>(l,u)=>r(o(l),i(u)))});function a(o){var l=o.re+1;return new s(Math.log(Math.sqrt(l*l+o.im*o.im)),Math.atan2(o.im,l))}}),iH="nthRoots",PPe=["config","typed","divideScalar","Complex"],FPe=ie(iH,PPe,n=>{var{typed:e,config:t,divideScalar:r,Complex:i}=n,s=[function(l){return new i(l,0)},function(l){return new i(0,l)},function(l){return new i(-l,0)},function(l){return new i(0,-l)}];function a(o,l){if(l<0)throw new Error("Root must be greater than zero");if(l===0)throw new Error("Root must be non-zero");if(l%1!==0)throw new Error("Root must be an integer");if(o===0||o.abs()===0)return[new i(0,0)];var u=typeof o=="number",c;(u||o.re===0||o.im===0)&&(u?c=2*+(o<0):o.im===0?c=2*+(o.re<0):c=2*+(o.im<0)+1);for(var h=o.arg(),d=o.abs(),f=[],p=Math.pow(d,1/l),m=0;m<l;m++){var y=(c+4*m)/l;if(y===Math.round(y)){f.push(s[y%4](p));continue}f.push(new i({r:p,phi:(h+2*Math.PI*m)/l}))}return f}return e(iH,{Complex:function(l){return a(l,2)},"Complex, number":a})}),sH="dotPow",LPe=["typed","equalScalar","matrix","pow","DenseMatrix","concat","SparseMatrix"],OPe=ie(sH,LPe,n=>{var{typed:e,equalScalar:t,matrix:r,pow:i,DenseMatrix:s,concat:a,SparseMatrix:o}=n,l=ia({typed:e}),u=Fc({typed:e,SparseMatrix:o}),c=Rs({typed:e,equalScalar:t}),h=Bi({typed:e,DenseMatrix:s}),d=ar({typed:e,matrix:r,concat:a}),f={};for(var p in i.signatures)Object.prototype.hasOwnProperty.call(i.signatures,p)&&!p.includes("Matrix")&&!p.includes("Array")&&(f[p]=i.signatures[p]);var m=e(f);return e(sH,d({elop:m,SS:u,DS:l,Ss:c,sS:h}))}),aH="dotDivide",kPe=["typed","matrix","equalScalar","divideScalar","DenseMatrix","concat","SparseMatrix"],BPe=ie(aH,kPe,n=>{var{typed:e,matrix:t,equalScalar:r,divideScalar:i,DenseMatrix:s,concat:a,SparseMatrix:o}=n,l=bu({typed:e,equalScalar:r}),u=ia({typed:e}),c=Fc({typed:e,SparseMatrix:o}),h=Rs({typed:e,equalScalar:r}),d=Bi({typed:e,DenseMatrix:s}),f=ar({typed:e,matrix:t,concat:a});return e(aH,f({elop:i,SS:c,DS:u,SD:l,Ss:h,sS:d}))});function oA(n){var{DenseMatrix:e}=n;return function(r,i,s){var a=r.size();if(a.length!==2)throw new RangeError("Matrix must be two dimensional (size: "+nn(a)+")");var o=a[0],l=a[1];if(o!==l)throw new RangeError("Matrix must be square (size: "+nn(a)+")");var u=[];if(Dt(i)){var c=i.size(),h=i._data;if(c.length===1){if(c[0]!==o)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var d=0;d<o;d++)u[d]=[h[d]];return new e({data:u,size:[o,1],datatype:i._datatype})}if(c.length===2){if(c[0]!==o||c[1]!==1)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(RD(i)){if(s){u=[];for(var f=0;f<o;f++)u[f]=[h[f][0]];return new e({data:u,size:[o,1],datatype:i._datatype})}return i}if(jm(i)){for(var p=0;p<o;p++)u[p]=[0];for(var m=i._values,y=i._index,v=i._ptr,b=v[1],x=v[0];x<b;x++){var w=y[x];u[w][0]=m[x]}return new e({data:u,size:[o,1],datatype:i._datatype})}}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}if(Wn(i)){var _=Vt(i);if(_.length===1){if(_[0]!==o)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var E=0;E<o;E++)u[E]=[i[E]];return new e({data:u,size:[o,1]})}if(_.length===2){if(_[0]!==o||_[1]!==1)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var A=0;A<o;A++)u[A]=[i[A][0]];return new e({data:u,size:[o,1]})}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}}}var oH="lsolve",UPe=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],VPe=ie(oH,UPe,n=>{var{typed:e,matrix:t,divideScalar:r,multiplyScalar:i,subtractScalar:s,equalScalar:a,DenseMatrix:o}=n,l=oA({DenseMatrix:o});return e(oH,{"SparseMatrix, Array | Matrix":function(d,f){return c(d,f)},"DenseMatrix, Array | Matrix":function(d,f){return u(d,f)},"Array, Array | Matrix":function(d,f){var p=t(d),m=u(p,f);return m.valueOf()}});function u(h,d){d=l(h,d,!0);for(var f=d._data,p=h._size[0],m=h._size[1],y=[],v=h._data,b=0;b<m;b++){var x=f[b][0]||0,w=void 0;if(a(x,0))w=0;else{var _=v[b][b];if(a(_,0))throw new Error("Linear system cannot be solved since matrix is singular");w=r(x,_);for(var E=b+1;E<p;E++)f[E]=[s(f[E][0]||0,i(w,v[E][b]))]}y[b]=[w]}return new o({data:y,size:[p,1]})}function c(h,d){d=l(h,d,!0);for(var f=d._data,p=h._size[0],m=h._size[1],y=h._values,v=h._index,b=h._ptr,x=[],w=0;w<m;w++){var _=f[w][0]||0;if(a(_,0))x[w]=[0];else{for(var E=0,A=[],T=[],S=b[w],M=b[w+1],D=S;D<M;D++){var N=v[D];N===w?E=y[D]:N>w&&(A.push(y[D]),T.push(N))}if(a(E,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var R=r(_,E),z=0,j=T.length;z<j;z++){var I=T[z];f[I]=[s(f[I][0]||0,i(R,A[z]))]}x[w]=[R]}}return new o({data:x,size:[p,1]})}}),lH="usolve",zPe=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],$Pe=ie(lH,zPe,n=>{var{typed:e,matrix:t,divideScalar:r,multiplyScalar:i,subtractScalar:s,equalScalar:a,DenseMatrix:o}=n,l=oA({DenseMatrix:o});return e(lH,{"SparseMatrix, Array | Matrix":function(d,f){return c(d,f)},"DenseMatrix, Array | Matrix":function(d,f){return u(d,f)},"Array, Array | Matrix":function(d,f){var p=t(d),m=u(p,f);return m.valueOf()}});function u(h,d){d=l(h,d,!0);for(var f=d._data,p=h._size[0],m=h._size[1],y=[],v=h._data,b=m-1;b>=0;b--){var x=f[b][0]||0,w=void 0;if(a(x,0))w=0;else{var _=v[b][b];if(a(_,0))throw new Error("Linear system cannot be solved since matrix is singular");w=r(x,_);for(var E=b-1;E>=0;E--)f[E]=[s(f[E][0]||0,i(w,v[E][b]))]}y[b]=[w]}return new o({data:y,size:[p,1]})}function c(h,d){d=l(h,d,!0);for(var f=d._data,p=h._size[0],m=h._size[1],y=h._values,v=h._index,b=h._ptr,x=[],w=m-1;w>=0;w--){var _=f[w][0]||0;if(a(_,0))x[w]=[0];else{for(var E=0,A=[],T=[],S=b[w],M=b[w+1],D=M-1;D>=S;D--){var N=v[D];N===w?E=y[D]:N<w&&(A.push(y[D]),T.push(N))}if(a(E,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var R=r(_,E),z=0,j=T.length;z<j;z++){var I=T[z];f[I]=[s(f[I][0],i(R,A[z]))]}x[w]=[R]}}return new o({data:x,size:[p,1]})}}),uH="lsolveAll",HPe=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],GPe=ie(uH,HPe,n=>{var{typed:e,matrix:t,divideScalar:r,multiplyScalar:i,subtractScalar:s,equalScalar:a,DenseMatrix:o}=n,l=oA({DenseMatrix:o});return e(uH,{"SparseMatrix, Array | Matrix":function(d,f){return c(d,f)},"DenseMatrix, Array | Matrix":function(d,f){return u(d,f)},"Array, Array | Matrix":function(d,f){var p=t(d),m=u(p,f);return m.map(y=>y.valueOf())}});function u(h,d){for(var f=[l(h,d,!0)._data.map(T=>T[0])],p=h._data,m=h._size[0],y=h._size[1],v=0;v<y;v++)for(var b=f.length,x=0;x<b;x++){var w=f[x];if(a(p[v][v],0))if(a(w[v],0)){if(x===0){var E=[...w];E[v]=1;for(var A=v+1;A<y;A++)E[A]=s(E[A],p[A][v]);f.push(E)}}else{if(x===0)return[];f.splice(x,1),x-=1,b-=1}else{w[v]=r(w[v],p[v][v]);for(var _=v+1;_<y;_++)w[_]=s(w[_],i(w[v],p[_][v]))}}return f.map(T=>new o({data:T.map(S=>[S]),size:[m,1]}))}function c(h,d){for(var f=[l(h,d,!0)._data.map(J=>J[0])],p=h._size[0],m=h._size[1],y=h._values,v=h._index,b=h._ptr,x=0;x<m;x++)for(var w=f.length,_=0;_<w;_++){for(var E=f[_],A=[],T=[],S=b[x],M=b[x+1],D=0,N=S;N<M;N++){var R=v[N];R===x?D=y[N]:R>x&&(A.push(y[N]),T.push(R))}if(a(D,0))if(a(E[x],0)){if(_===0){var F=[...E];F[x]=1;for(var $=0,H=T.length;$<H;$++){var Z=T[$];F[Z]=s(F[Z],A[$])}f.push(F)}}else{if(_===0)return[];f.splice(_,1),_-=1,w-=1}else{E[x]=r(E[x],D);for(var z=0,j=T.length;z<j;z++){var I=T[z];E[I]=s(E[I],i(E[x],A[z]))}}}return f.map(J=>new o({data:J.map(ee=>[ee]),size:[p,1]}))}}),cH="usolveAll",jPe=["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],qPe=ie(cH,jPe,n=>{var{typed:e,matrix:t,divideScalar:r,multiplyScalar:i,subtractScalar:s,equalScalar:a,DenseMatrix:o}=n,l=oA({DenseMatrix:o});return e(cH,{"SparseMatrix, Array | Matrix":function(d,f){return c(d,f)},"DenseMatrix, Array | Matrix":function(d,f){return u(d,f)},"Array, Array | Matrix":function(d,f){var p=t(d),m=u(p,f);return m.map(y=>y.valueOf())}});function u(h,d){for(var f=[l(h,d,!0)._data.map(T=>T[0])],p=h._data,m=h._size[0],y=h._size[1],v=y-1;v>=0;v--)for(var b=f.length,x=0;x<b;x++){var w=f[x];if(a(p[v][v],0))if(a(w[v],0)){if(x===0){var E=[...w];E[v]=1;for(var A=v-1;A>=0;A--)E[A]=s(E[A],p[A][v]);f.push(E)}}else{if(x===0)return[];f.splice(x,1),x-=1,b-=1}else{w[v]=r(w[v],p[v][v]);for(var _=v-1;_>=0;_--)w[_]=s(w[_],i(w[v],p[_][v]))}}return f.map(T=>new o({data:T.map(S=>[S]),size:[m,1]}))}function c(h,d){for(var f=[l(h,d,!0)._data.map(J=>J[0])],p=h._size[0],m=h._size[1],y=h._values,v=h._index,b=h._ptr,x=m-1;x>=0;x--)for(var w=f.length,_=0;_<w;_++){for(var E=f[_],A=[],T=[],S=b[x],M=b[x+1],D=0,N=M-1;N>=S;N--){var R=v[N];R===x?D=y[N]:R<x&&(A.push(y[N]),T.push(R))}if(a(D,0))if(a(E[x],0)){if(_===0){var F=[...E];F[x]=1;for(var $=0,H=T.length;$<H;$++){var Z=T[$];F[Z]=s(F[Z],A[$])}f.push(F)}}else{if(_===0)return[];f.splice(_,1),_-=1,w-=1}else{E[x]=r(E[x],D);for(var z=0,j=T.length;z<j;z++){var I=T[z];E[I]=s(E[I],i(E[x],A[z]))}}}return f.map(J=>new o({data:J.map(ee=>[ee]),size:[p,1]}))}}),WPe="matAlgo08xS0Sid",XPe=["typed","equalScalar"],rU=ie(WPe,XPe,n=>{var{typed:e,equalScalar:t}=n;return function(i,s,a){var o=i._values,l=i._index,u=i._ptr,c=i._size,h=i._datatype||i._data===void 0?i._datatype:i.getDataType(),d=s._values,f=s._index,p=s._ptr,m=s._size,y=s._datatype||s._data===void 0?s._datatype:s.getDataType();if(c.length!==m.length)throw new en(c.length,m.length);if(c[0]!==m[0]||c[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+m+")");if(!o||!d)throw new Error("Cannot perform operation on Pattern Sparse Matrices");var v=c[0],b=c[1],x,w=t,_=0,E=a;typeof h=="string"&&h===y&&h!=="mixed"&&(x=h,w=e.find(t,[x,x]),_=e.convert(0,x),E=e.find(a,[x,x]));for(var A=[],T=[],S=[],M=[],D=[],N,R,z,j,I=0;I<b;I++){S[I]=T.length;var F=I+1;for(R=u[I],z=u[I+1],N=R;N<z;N++)j=l[N],D[j]=F,M[j]=o[N],T.push(j);for(R=p[I],z=p[I+1],N=R;N<z;N++)j=f[N],D[j]===F&&(M[j]=E(M[j],d[N]));for(N=S[I];N<T.length;){j=T[N];var $=M[j];w($,_)?T.splice(N,1):(A.push($),N++)}}return S[b]=T.length,i.createSparseMatrix({values:A,index:T,ptr:S,size:[v,b],datatype:h===i._datatype&&y===s._datatype?x:void 0})}}),iU=ie("useMatrixForArrayScalar",["typed","matrix"],n=>{var{typed:e,matrix:t}=n;return{"Array, number":e.referTo("DenseMatrix, number",r=>(i,s)=>r(t(i),s).valueOf()),"Array, BigNumber":e.referTo("DenseMatrix, BigNumber",r=>(i,s)=>r(t(i),s).valueOf()),"number, Array":e.referTo("number, DenseMatrix",r=>(i,s)=>r(i,t(s)).valueOf()),"BigNumber, Array":e.referTo("BigNumber, DenseMatrix",r=>(i,s)=>r(i,t(s)).valueOf())}}),hH="leftShift",KPe=["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],YPe=ie(hH,KPe,n=>{var{typed:e,matrix:t,equalScalar:r,zeros:i,DenseMatrix:s,concat:a}=n,o=Qp({typed:e}),l=bu({typed:e,equalScalar:r}),u=rU({typed:e,equalScalar:r}),c=$v({typed:e,DenseMatrix:s}),h=Rs({typed:e,equalScalar:r}),d=Rl({typed:e}),f=ar({typed:e,matrix:t,concat:a}),p=iU({typed:e,matrix:t});return e(hH,{"number, number":tne,"BigNumber, BigNumber":mRe,"bigint, bigint":(m,y)=>m<<y,"SparseMatrix, number | BigNumber":e.referToSelf(m=>(y,v)=>r(v,0)?y.clone():h(y,v,m,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(m=>(y,v)=>r(v,0)?y.clone():d(y,v,m,!1)),"number | BigNumber, SparseMatrix":e.referToSelf(m=>(y,v)=>r(y,0)?i(v.size(),v.storage()):c(v,y,m,!0)),"number | BigNumber, DenseMatrix":e.referToSelf(m=>(y,v)=>r(y,0)?i(v.size(),v.storage()):d(v,y,m,!0))},p,f({SS:u,DS:o,SD:l}))}),dH="rightArithShift",QPe=["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],ZPe=ie(dH,QPe,n=>{var{typed:e,matrix:t,equalScalar:r,zeros:i,DenseMatrix:s,concat:a}=n,o=Qp({typed:e}),l=bu({typed:e,equalScalar:r}),u=rU({typed:e,equalScalar:r}),c=$v({typed:e,DenseMatrix:s}),h=Rs({typed:e,equalScalar:r}),d=Rl({typed:e}),f=ar({typed:e,matrix:t,concat:a}),p=iU({typed:e,matrix:t});return e(dH,{"number, number":nne,"BigNumber, BigNumber":gRe,"bigint, bigint":(m,y)=>m>>y,"SparseMatrix, number | BigNumber":e.referToSelf(m=>(y,v)=>r(v,0)?y.clone():h(y,v,m,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(m=>(y,v)=>r(v,0)?y.clone():d(y,v,m,!1)),"number | BigNumber, SparseMatrix":e.referToSelf(m=>(y,v)=>r(y,0)?i(v.size(),v.storage()):c(v,y,m,!0)),"number | BigNumber, DenseMatrix":e.referToSelf(m=>(y,v)=>r(y,0)?i(v.size(),v.storage()):d(v,y,m,!0))},p,f({SS:u,DS:o,SD:l}))}),fH="rightLogShift",JPe=["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],e3e=ie(fH,JPe,n=>{var{typed:e,matrix:t,equalScalar:r,zeros:i,DenseMatrix:s,concat:a}=n,o=Qp({typed:e}),l=bu({typed:e,equalScalar:r}),u=rU({typed:e,equalScalar:r}),c=$v({typed:e,DenseMatrix:s}),h=Rs({typed:e,equalScalar:r}),d=Rl({typed:e}),f=ar({typed:e,matrix:t,concat:a}),p=iU({typed:e,matrix:t});return e(fH,{"number, number":rne,"SparseMatrix, number | BigNumber":e.referToSelf(m=>(y,v)=>r(v,0)?y.clone():h(y,v,m,!1)),"DenseMatrix, number | BigNumber":e.referToSelf(m=>(y,v)=>r(v,0)?y.clone():d(y,v,m,!1)),"number | BigNumber, SparseMatrix":e.referToSelf(m=>(y,v)=>r(y,0)?i(v.size(),v.storage()):c(v,y,m,!0)),"number | BigNumber, DenseMatrix":e.referToSelf(m=>(y,v)=>r(y,0)?i(v.size(),v.storage()):d(v,y,m,!0))},p,f({SS:u,DS:o,SD:l}))}),pH="and",t3e=["typed","matrix","equalScalar","zeros","not","concat"],Wne=ie(pH,t3e,n=>{var{typed:e,matrix:t,equalScalar:r,zeros:i,not:s,concat:a}=n,o=bu({typed:e,equalScalar:r}),l=BN({typed:e,equalScalar:r}),u=Rs({typed:e,equalScalar:r}),c=Rl({typed:e}),h=ar({typed:e,matrix:t,concat:a});return e(pH,{"number, number":DO,"Complex, Complex":function(f,p){return(f.re!==0||f.im!==0)&&(p.re!==0||p.im!==0)},"BigNumber, BigNumber":function(f,p){return!f.isZero()&&!p.isZero()&&!f.isNaN()&&!p.isNaN()},"bigint, bigint":DO,"Unit, Unit":e.referToSelf(d=>(f,p)=>d(f.value||0,p.value||0)),"SparseMatrix, any":e.referToSelf(d=>(f,p)=>s(p)?i(f.size(),f.storage()):u(f,p,d,!1)),"DenseMatrix, any":e.referToSelf(d=>(f,p)=>s(p)?i(f.size(),f.storage()):c(f,p,d,!1)),"any, SparseMatrix":e.referToSelf(d=>(f,p)=>s(f)?i(f.size(),f.storage()):u(p,f,d,!0)),"any, DenseMatrix":e.referToSelf(d=>(f,p)=>s(f)?i(f.size(),f.storage()):c(p,f,d,!0)),"Array, any":e.referToSelf(d=>(f,p)=>d(t(f),p).valueOf()),"any, Array":e.referToSelf(d=>(f,p)=>d(f,t(p)).valueOf())},h({SS:l,DS:o}))}),WD="compare",n3e=["typed","config","matrix","equalScalar","BigNumber","Fraction","DenseMatrix","concat"],r3e=ie(WD,n3e,n=>{var{typed:e,config:t,equalScalar:r,matrix:i,BigNumber:s,Fraction:a,DenseMatrix:o,concat:l}=n,u=ia({typed:e}),c=kN({typed:e,equalScalar:r}),h=Bi({typed:e,DenseMatrix:o}),d=ar({typed:e,matrix:i,concat:l}),f=Yb({typed:e});return e(WD,i3e({typed:e,config:t}),{"boolean, boolean":function(m,y){return m===y?0:m>y?1:-1},"BigNumber, BigNumber":function(m,y){return Dl(m,y,t.relTol,t.absTol)?new s(0):new s(m.cmp(y))},"bigint, bigint":function(m,y){return m===y?0n:m>y?1n:-1n},"Fraction, Fraction":function(m,y){return new a(m.compare(y))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},f,d({SS:c,DS:u,Ss:h}))}),i3e=ie(WD,["typed","config"],n=>{var{typed:e,config:t}=n;return e(WD,{"number, number":function(i,s){return as(i,s,t.relTol,t.absTol)?0:i>s?1:-1}})}),s3e=function n(e,t){var r=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,i=/(^[ ]*|[ ]*$)/g,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,a=/^0x[0-9a-f]+$/i,o=/^0/,l=function(x){return n.insensitive&&(""+x).toLowerCase()||""+x},u=l(e).replace(i,"")||"",c=l(t).replace(i,"")||"",h=u.replace(r,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),d=c.replace(r,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),f=parseInt(u.match(a),16)||h.length!==1&&u.match(s)&&Date.parse(u),p=parseInt(c.match(a),16)||f&&c.match(s)&&Date.parse(c)||null,m,y;if(p){if(f<p)return-1;if(f>p)return 1}for(var v=0,b=Math.max(h.length,d.length);v<b;v++){if(m=!(h[v]||"").match(o)&&parseFloat(h[v])||h[v]||0,y=!(d[v]||"").match(o)&&parseFloat(d[v])||d[v]||0,isNaN(m)!==isNaN(y))return isNaN(m)?1:-1;if(typeof m!=typeof y&&(m+="",y+=""),m<y)return-1;if(m>y)return 1}return 0};const A0=w2(s3e);var mH="compareNatural",a3e=["typed","compare"],o3e=ie(mH,a3e,n=>{var{typed:e,compare:t}=n,r=t.signatures["boolean,boolean"];return e(mH,{"any, any":i});function i(l,u){var c=Kn(l),h=Kn(u),d;if((c==="number"||c==="BigNumber"||c==="Fraction")&&(h==="number"||h==="BigNumber"||h==="Fraction"))return d=t(l,u),d.toString()!=="0"?d>0?1:-1:A0(c,h);var f=["Array","DenseMatrix","SparseMatrix"];if(f.includes(c)||f.includes(h))return d=s(i,l,u),d!==0?d:A0(c,h);if(c!==h)return A0(c,h);if(c==="Complex")return l3e(l,u);if(c==="Unit")return l.equalBase(u)?i(l.value,u.value):a(i,l.formatUnits(),u.formatUnits());if(c==="boolean")return r(l,u);if(c==="string")return A0(l,u);if(c==="Object")return o(i,l,u);if(c==="null"||c==="undefined")return 0;throw new TypeError('Unsupported type of value "'+c+'"')}function s(l,u,c){return jm(u)&&jm(c)?a(l,u.toJSON().values,c.toJSON().values):jm(u)?s(l,u.toArray(),c):jm(c)?s(l,u,c.toArray()):RD(u)?s(l,u.toJSON().data,c):RD(c)?s(l,u,c.toJSON().data):Array.isArray(u)?Array.isArray(c)?a(l,u,c):s(l,u,[c]):s(l,[u],c)}function a(l,u,c){for(var h=0,d=Math.min(u.length,c.length);h<d;h++){var f=l(u[h],c[h]);if(f!==0)return f}return u.length>c.length?1:u.length<c.length?-1:0}function o(l,u,c){var h=Object.keys(u),d=Object.keys(c);h.sort(A0),d.sort(A0);var f=a(l,h,d);if(f!==0)return f;for(var p=0;p<h.length;p++){var m=l(u[h[p]],c[d[p]]);if(m!==0)return m}return 0}});function l3e(n,e){return n.re>e.re?1:n.re<e.re?-1:n.im>e.im?1:n.im<e.im?-1:0}var gH="compareText",u3e=["typed","matrix","concat"];wO.signature="any, any";var c3e=ie(gH,u3e,n=>{var{typed:e,matrix:t,concat:r}=n,i=ar({typed:e,matrix:t,concat:r});return e(gH,wO,i({elop:wO,Ds:!0}))}),XD="equal",h3e=["typed","matrix","equalScalar","DenseMatrix","SparseMatrix"],d3e=ie(XD,h3e,n=>{var{typed:e,matrix:t,equalScalar:r,DenseMatrix:i,concat:s,SparseMatrix:a}=n,o=ia({typed:e}),l=Fc({typed:e,SparseMatrix:a}),u=Bi({typed:e,DenseMatrix:i}),c=ar({typed:e,matrix:t});return e(XD,f3e({typed:e,equalScalar:r}),c({elop:r,SS:l,DS:o,Ss:u}))}),f3e=ie(XD,["typed","equalScalar"],n=>{var{typed:e,equalScalar:t}=n;return e(XD,{"any, any":function(i,s){return i===null?s===null:s===null?i===null:i===void 0?s===void 0:s===void 0?i===void 0:t(i,s)}})}),vH="equalText",p3e=["typed","compareText","isZero"],m3e=ie(vH,p3e,n=>{var{typed:e,compareText:t,isZero:r}=n;return e(vH,{"any, any":function(s,a){return r(t(s,a))}})}),KD="smaller",g3e=["typed","config","bignumber","matrix","DenseMatrix","concat","SparseMatrix"],v3e=ie(KD,g3e,n=>{var{typed:e,config:t,bignumber:r,matrix:i,DenseMatrix:s,concat:a,SparseMatrix:o}=n,l=ia({typed:e}),u=Fc({typed:e,SparseMatrix:o}),c=Bi({typed:e,DenseMatrix:s}),h=ar({typed:e,matrix:i,concat:a}),d=Yb({typed:e});function f(p,m){return p.lt(m)&&!Dl(p,m,t.relTol,t.absTol)}return e(KD,y3e({typed:e,config:t}),{"boolean, boolean":(p,m)=>p<m,"BigNumber, BigNumber":f,"bigint, bigint":(p,m)=>p<m,"Fraction, Fraction":(p,m)=>p.compare(m)===-1,"Fraction, BigNumber":function(m,y){return f(r(m),y)},"BigNumber, Fraction":function(m,y){return f(m,r(y))},"Complex, Complex":function(m,y){throw new TypeError("No ordering relation is defined for complex numbers")}},d,h({SS:u,DS:l,Ss:c}))}),y3e=ie(KD,["typed","config"],n=>{var{typed:e,config:t}=n;return e(KD,{"number, number":function(i,s){return i<s&&!as(i,s,t.relTol,t.absTol)}})}),YD="smallerEq",x3e=["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],b3e=ie(YD,x3e,n=>{var{typed:e,config:t,matrix:r,DenseMatrix:i,concat:s,SparseMatrix:a}=n,o=ia({typed:e}),l=Fc({typed:e,SparseMatrix:a}),u=Bi({typed:e,DenseMatrix:i}),c=ar({typed:e,matrix:r,concat:s}),h=Yb({typed:e});return e(YD,_3e({typed:e,config:t}),{"boolean, boolean":(d,f)=>d<=f,"BigNumber, BigNumber":function(f,p){return f.lte(p)||Dl(f,p,t.relTol,t.absTol)},"bigint, bigint":(d,f)=>d<=f,"Fraction, Fraction":(d,f)=>d.compare(f)!==1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},h,c({SS:l,DS:o,Ss:u}))}),_3e=ie(YD,["typed","config"],n=>{var{typed:e,config:t}=n;return e(YD,{"number, number":function(i,s){return i<=s||as(i,s,t.relTol,t.absTol)}})}),QD="larger",w3e=["typed","config","bignumber","matrix","DenseMatrix","concat","SparseMatrix"],E3e=ie(QD,w3e,n=>{var{typed:e,config:t,bignumber:r,matrix:i,DenseMatrix:s,concat:a,SparseMatrix:o}=n,l=ia({typed:e}),u=Fc({typed:e,SparseMatrix:o}),c=Bi({typed:e,DenseMatrix:s}),h=ar({typed:e,matrix:i,concat:a}),d=Yb({typed:e});function f(p,m){return p.gt(m)&&!Dl(p,m,t.relTol,t.absTol)}return e(QD,S3e({typed:e,config:t}),{"boolean, boolean":(p,m)=>p>m,"BigNumber, BigNumber":f,"bigint, bigint":(p,m)=>p>m,"Fraction, Fraction":(p,m)=>p.compare(m)===1,"Fraction, BigNumber":function(m,y){return f(r(m),y)},"BigNumber, Fraction":function(m,y){return f(m,r(y))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},d,h({SS:u,DS:l,Ss:c}))}),S3e=ie(QD,["typed","config"],n=>{var{typed:e,config:t}=n;return e(QD,{"number, number":function(i,s){return i>s&&!as(i,s,t.relTol,t.absTol)}})}),ZD="largerEq",A3e=["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],T3e=ie(ZD,A3e,n=>{var{typed:e,config:t,matrix:r,DenseMatrix:i,concat:s,SparseMatrix:a}=n,o=ia({typed:e}),l=Fc({typed:e,SparseMatrix:a}),u=Bi({typed:e,DenseMatrix:i}),c=ar({typed:e,matrix:r,concat:s}),h=Yb({typed:e});return e(ZD,M3e({typed:e,config:t}),{"boolean, boolean":(d,f)=>d>=f,"BigNumber, BigNumber":function(f,p){return f.gte(p)||Dl(f,p,t.relTol,t.absTol)},"bigint, bigint":function(f,p){return f>=p},"Fraction, Fraction":(d,f)=>d.compare(f)!==-1,"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},h,c({SS:l,DS:o,Ss:u}))}),M3e=ie(ZD,["typed","config"],n=>{var{typed:e,config:t}=n;return e(ZD,{"number, number":function(i,s){return i>=s||as(i,s,t.relTol,t.absTol)}})}),yH="deepEqual",C3e=["typed","equal"],D3e=ie(yH,C3e,n=>{var{typed:e,equal:t}=n;return e(yH,{"any, any":function(s,a){return r(s.valueOf(),a.valueOf())}});function r(i,s){if(Array.isArray(i))if(Array.isArray(s)){var a=i.length;if(a!==s.length)return!1;for(var o=0;o<a;o++)if(!r(i[o],s[o]))return!1;return!0}else return!1;else return Array.isArray(s)?!1:t(i,s)}}),JD="unequal",N3e=["typed","config","equalScalar","matrix","DenseMatrix","concat","SparseMatrix"],R3e=ie(JD,N3e,n=>{var{typed:e,config:t,equalScalar:r,matrix:i,DenseMatrix:s,concat:a,SparseMatrix:o}=n,l=ia({typed:e}),u=Fc({typed:e,SparseMatrix:o}),c=Bi({typed:e,DenseMatrix:s}),h=ar({typed:e,matrix:i,concat:a});return e(JD,I3e({typed:e,equalScalar:r}),h({elop:d,SS:u,DS:l,Ss:c}));function d(f,p){return!r(f,p)}}),I3e=ie(JD,["typed","equalScalar"],n=>{var{typed:e,equalScalar:t}=n;return e(JD,{"any, any":function(i,s){return i===null?s!==null:s===null?i!==null:i===void 0?s!==void 0:s===void 0?i!==void 0:!t(i,s)}})}),xH="partitionSelect",P3e=["typed","isNumeric","isNaN","compare"],F3e=ie(xH,P3e,n=>{var{typed:e,isNumeric:t,isNaN:r,compare:i}=n,s=i,a=(u,c)=>-i(u,c);return e(xH,{"Array | Matrix, number":function(c,h){return o(c,h,s)},"Array | Matrix, number, string":function(c,h,d){if(d==="asc")return o(c,h,s);if(d==="desc")return o(c,h,a);throw new Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":o});function o(u,c,h){if(!bt(c)||c<0)throw new Error("k must be a non-negative integer");if(Dt(u)){var d=u.size();if(d.length>1)throw new Error("Only one dimensional matrices supported");return l(u.valueOf(),c,h)}if(Array.isArray(u))return l(u,c,h)}function l(u,c,h){if(c>=u.length)throw new Error("k out of bounds");for(var d=0;d<u.length;d++)if(t(u[d])&&r(u[d]))return u[d];for(var f=0,p=u.length-1;f<p;){for(var m=f,y=p,v=u[Math.floor(Math.random()*(p-f+1))+f];m<y;)if(h(u[m],v)>=0){var b=u[y];u[y]=u[m],u[m]=b,--y}else++m;h(u[m],v)>0&&--m,c<=m?p=m:f=m+1}return u[c]}}),bH="sort",L3e=["typed","matrix","compare","compareNatural"],O3e=ie(bH,L3e,n=>{var{typed:e,matrix:t,compare:r,compareNatural:i}=n,s=r,a=(c,h)=>-r(c,h);return e(bH,{Array:function(h){return l(h),h.sort(s)},Matrix:function(h){return u(h),t(h.toArray().sort(s),h.storage())},"Array, function":function(h,d){return l(h),h.sort(d)},"Matrix, function":function(h,d){return u(h),t(h.toArray().sort(d),h.storage())},"Array, string":function(h,d){return l(h),h.sort(o(d))},"Matrix, string":function(h,d){return u(h),t(h.toArray().sort(o(d)),h.storage())}});function o(c){if(c==="asc")return s;if(c==="desc")return a;if(c==="natural")return i;throw new Error('String "asc", "desc", or "natural" expected')}function l(c){if(Vt(c).length!==1)throw new Error("One dimensional array expected")}function u(c){if(c.size().length!==1)throw new Error("One dimensional matrix expected")}}),_H="max",k3e=["typed","config","numeric","larger","isNaN"],Xne=ie(_H,k3e,n=>{var{typed:e,config:t,numeric:r,larger:i,isNaN:s}=n;return e(_H,{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(u,c){return ON(u,c.valueOf(),a)},"...":function(u){if(Wb(u))throw new TypeError("Scalar values expected in function max");return o(u)}});function a(l,u){try{return i(l,u)?l:u}catch(c){throw Ca(c,"max",u)}}function o(l){var u;if(kp(l,function(c){try{(s(c)||u===void 0||i(c,u))&&(u=c)}catch(h){throw Ca(h,"max",c)}}),u===void 0)throw new Error("Cannot calculate max of an empty array");return typeof u=="string"&&(u=r(u,Kp(u,t))),u}}),wH="min",B3e=["typed","config","numeric","smaller","isNaN"],Kne=ie(wH,B3e,n=>{var{typed:e,config:t,numeric:r,smaller:i,isNaN:s}=n;return e(wH,{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(u,c){return ON(u,c.valueOf(),a)},"...":function(u){if(Wb(u))throw new TypeError("Scalar values expected in function min");return o(u)}});function a(l,u){try{return i(l,u)?l:u}catch(c){throw Ca(c,"min",u)}}function o(l){var u;if(kp(l,function(c){try{(s(c)||u===void 0||i(c,u))&&(u=c)}catch(h){throw Ca(h,"min",c)}}),u===void 0)throw new Error("Cannot calculate min of an empty array");return typeof u=="string"&&(u=r(u,Kp(u,t))),u}}),U3e="ImmutableDenseMatrix",V3e=["smaller","DenseMatrix"],z3e=ie(U3e,V3e,n=>{var{smaller:e,DenseMatrix:t}=n;function r(i,s){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(s&&!Qr(s))throw new Error("Invalid datatype: "+s);if(Dt(i)||Wn(i)){var a=new t(i,s);this._data=a._data,this._size=a._size,this._datatype=a._datatype,this._min=null,this._max=null}else if(i&&Wn(i.data)&&Wn(i.size))this._data=i.data,this._size=i.size,this._datatype=i.datatype,this._min=typeof i.min<"u"?i.min:null,this._max=typeof i.max<"u"?i.max:null;else{if(i)throw new TypeError("Unsupported type of data ("+Kn(i)+")");this._data=[],this._size=[0],this._datatype=s,this._min=null,this._max=null}}return r.prototype=new t,r.prototype.type="ImmutableDenseMatrix",r.prototype.isImmutableDenseMatrix=!0,r.prototype.subset=function(i){switch(arguments.length){case 1:{var s=t.prototype.subset.call(this,i);return Dt(s)?new r({data:s._data,size:s._size,datatype:s._datatype}):s}case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},r.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},r.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},r.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},r.prototype.clone=function(){return new r({data:Ut(this._data),size:Ut(this._size),datatype:this._datatype})},r.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.fromJSON=function(i){return new r(i)},r.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},r.prototype.min=function(){if(this._min===null){var i=null;this.forEach(function(s){(i===null||e(s,i))&&(i=s)}),this._min=i!==null?i:void 0}return this._min},r.prototype.max=function(){if(this._max===null){var i=null;this.forEach(function(s){(i===null||e(i,s))&&(i=s)}),this._max=i!==null?i:void 0}return this._max},r},{isClass:!0}),$3e="Index",H3e=["ImmutableDenseMatrix","getMatrixDataType"],G3e=ie($3e,H3e,n=>{var{ImmutableDenseMatrix:e,getMatrixDataType:t}=n;function r(){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._sourceSize=[],this._isScalar=!0;for(var s=0,a=arguments.length;s<a;s++){var o=s<0||arguments.length<=s?void 0:arguments[s],l=Wn(o),u=Dt(o),c=typeof o,h=null;if(q4(o))this._dimensions.push(o),this._isScalar=!1;else if(l||u){var d=void 0;this._isScalar=!1,t(o)==="boolean"?(l&&(d=i(EH(o).valueOf())),u&&(d=i(EH(o._data).valueOf())),h=o.valueOf().length):d=i(o.valueOf()),this._dimensions.push(d)}else if(c==="number")this._dimensions.push(o);else if(c==="bigint")this._dimensions.push(Number(o));else if(c==="string")this._dimensions.push(o);else throw new TypeError("Dimension must be an Array, Matrix, number, bigint, string, or Range");this._sourceSize.push(h)}}r.prototype.type="Index",r.prototype.isIndex=!0;function i(s){for(var a=0,o=s.length;a<o;a++)if(!Tt(s[a])||!bt(s[a]))throw new TypeError("Index parameters must be positive integer numbers");var l=new e;return l._data=s,l._size=[s.length],l}return r.prototype.clone=function(){var s=new r;return s._dimensions=Ut(this._dimensions),s._isScalar=this._isScalar,s._sourceSize=this._sourceSize,s},r.create=function(s){var a=new r;return r.apply(a,s),a},r.prototype.size=function(){for(var s=[],a=0,o=this._dimensions.length;a<o;a++){var l=this._dimensions[a];s[a]=Qr(l)||Tt(l)?1:l.size()[0]}return s},r.prototype.max=function(){for(var s=[],a=0,o=this._dimensions.length;a<o;a++){var l=this._dimensions[a];s[a]=Qr(l)||Tt(l)?l:l.max()}return s},r.prototype.min=function(){for(var s=[],a=0,o=this._dimensions.length;a<o;a++){var l=this._dimensions[a];s[a]=Qr(l)||Tt(l)?l:l.min()}return s},r.prototype.forEach=function(s){for(var a=0,o=this._dimensions.length;a<o;a++)s(this._dimensions[a],a,this)},r.prototype.dimension=function(s){var a;return Tt(s)&&(a=this._dimensions[s])!==null&&a!==void 0?a:null},r.prototype.isObjectProperty=function(){return this._dimensions.length===1&&Qr(this._dimensions[0])},r.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},r.prototype.isScalar=function(){return this._isScalar},r.prototype.toArray=function(){for(var s=[],a=0,o=this._dimensions.length;a<o;a++){var l=this._dimensions[a];s.push(Qr(l)||Tt(l)?l:l.toArray())}return s},r.prototype.valueOf=r.prototype.toArray,r.prototype.toString=function(){for(var s=[],a=0,o=this._dimensions.length;a<o;a++){var l=this._dimensions[a];Qr(l)?s.push(JSON.stringify(l)):s.push(l.toString())}return"["+s.join(", ")+"]"},r.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},r.fromJSON=function(s){return r.create(s.dimensions)},r},{isClass:!0});function EH(n){var e=[];return n.forEach((t,r)=>{t&&e.push(r)}),e}var j3e="FibonacciHeap",q3e=["smaller","larger"],W3e=ie(j3e,q3e,n=>{var{smaller:e,larger:t}=n,r=1/Math.log((1+Math.sqrt(5))/2);function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}i.prototype.type="FibonacciHeap",i.prototype.isFibonacciHeap=!0,i.prototype.insert=function(c,h){var d={key:c,value:h,degree:0};if(this._minimum){var f=this._minimum;d.left=f,d.right=f.right,f.right=d,d.right.left=d,e(c,f.key)&&(this._minimum=d)}else d.left=d,d.right=d,this._minimum=d;return this._size++,d},i.prototype.size=function(){return this._size},i.prototype.clear=function(){this._minimum=null,this._size=0},i.prototype.isEmpty=function(){return this._size===0},i.prototype.extractMinimum=function(){var c=this._minimum;if(c===null)return c;for(var h=this._minimum,d=c.degree,f=c.child;d>0;){var p=f.right;f.left.right=f.right,f.right.left=f.left,f.left=h,f.right=h.right,h.right=f,f.right.left=f,f.parent=null,f=p,d--}return c.left.right=c.right,c.right.left=c.left,c===c.right?h=null:(h=c.right,h=u(h,this._size)),this._size--,this._minimum=h,c},i.prototype.remove=function(c){this._minimum=s(this._minimum,c,-1),this.extractMinimum()};function s(c,h,d){h.key=d;var f=h.parent;return f&&e(h.key,f.key)&&(a(c,h,f),o(c,f)),e(h.key,c.key)&&(c=h),c}function a(c,h,d){h.left.right=h.right,h.right.left=h.left,d.degree--,d.child===h&&(d.child=h.right),d.degree===0&&(d.child=null),h.left=c,h.right=c.right,c.right=h,h.right.left=h,h.parent=null,h.mark=!1}function o(c,h){var d=h.parent;d&&(h.mark?(a(c,h,d),o(d)):h.mark=!0)}var l=function(h,d){h.left.right=h.right,h.right.left=h.left,h.parent=d,d.child?(h.left=d.child,h.right=d.child.right,d.child.right=h,h.right.left=h):(d.child=h,h.right=h,h.left=h),d.degree++,h.mark=!1};function u(c,h){var d=Math.floor(Math.log(h)*r)+1,f=new Array(d),p=0,m=c;if(m)for(p++,m=m.right;m!==c;)p++,m=m.right;for(var y;p>0;){for(var v=m.degree,b=m.right;y=f[v],!!y;){if(t(m.key,y.key)){var x=y;y=m,m=x}l(y,m),f[v]=null,v++}f[v]=m,m=b,p--}c=null;for(var w=0;w<d;w++)y=f[w],y&&(c?(y.left.right=y.right,y.right.left=y.left,y.left=c,y.right=c.right,c.right=y,y.right.left=y,e(y.key,c.key)&&(c=y)):c=y);return c}return i},{isClass:!0}),X3e="Spa",K3e=["addScalar","equalScalar","FibonacciHeap"],Y3e=ie(X3e,K3e,n=>{var{addScalar:e,equalScalar:t,FibonacciHeap:r}=n;function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new r}return i.prototype.type="Spa",i.prototype.isSpa=!0,i.prototype.set=function(s,a){if(this._values[s])this._values[s].value=a;else{var o=this._heap.insert(s,a);this._values[s]=o}},i.prototype.get=function(s){var a=this._values[s];return a?a.value:0},i.prototype.accumulate=function(s,a){var o=this._values[s];o?o.value=e(o.value,a):(o=this._heap.insert(s,a),this._values[s]=o)},i.prototype.forEach=function(s,a,o){var l=this._heap,u=this._values,c=[],h=l.extractMinimum();for(h&&c.push(h);h&&h.key<=a;)h.key>=s&&(t(h.value,0)||o(h.key,h.value,this)),h=l.extractMinimum(),h&&c.push(h);for(var d=0;d<c.length;d++){var f=c[d];h=l.insert(f.key,f.value),u[h.key]=h}},i.prototype.swap=function(s,a){var o=this._values[s],l=this._values[a];if(!o&&l)o=this._heap.insert(s,l.value),this._heap.remove(l),this._values[s]=o,this._values[a]=void 0;else if(o&&!l)l=this._heap.insert(a,o.value),this._heap.remove(o),this._values[a]=l,this._values[s]=void 0;else if(o&&l){var u=o.value;o.value=l.value,l.value=u}},i},{isClass:!0});function Q3e(n){var e=0,t=1,r=Object.create(null),i=Object.create(null),s=0,a=function(l){var u=i[l];if(u&&(delete r[u],delete i[l],--e,t===u)){if(!e){s=0,t=1;return}for(;!Object.prototype.hasOwnProperty.call(r,++t););}};return n=Math.abs(n),{hit:function(l){var u=i[l],c=++s;if(r[c]=l,i[l]=c,!u)return++e,e<=n?void 0:(l=r[t],a(l),l);if(delete r[u],t===u)for(;!Object.prototype.hasOwnProperty.call(r,++t););},delete:a,clear:function(){e=s=0,t=1,r=Object.create(null),i=Object.create(null)}}}function lA(n){var{hasher:e,limit:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return t=t??Number.POSITIVE_INFINITY,e=e??JSON.stringify,function r(){typeof r.cache!="object"&&(r.cache={values:new Map,lru:Q3e(t||Number.POSITIVE_INFINITY)});for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var a=e(i);if(r.cache.values.has(a))return r.cache.lru.hit(a),r.cache.values.get(a);var o=n.apply(n,i);return r.cache.values.set(a,o),r.cache.values.delete(r.cache.lru.hit(a)),o}}var Z3e=lA(function(n){return new n(1).exp()},{hasher:UN}),J3e=lA(function(n){return new n(1).plus(new n(5).sqrt()).div(2)},{hasher:UN}),sU=lA(function(n){return n.acos(-1)},{hasher:UN}),eFe=lA(function(n){return sU(n).times(2)},{hasher:UN});function UN(n){return n[0].precision}function SH(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function ZI(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?SH(Object(t),!0).forEach(function(r){bi(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):SH(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var tFe="Unit",nFe=["?on","config","addScalar","subtractScalar","multiplyScalar","divideScalar","pow","abs","fix","round","equal","isNumeric","format","number","Complex","BigNumber","Fraction"],rFe=ie(tFe,nFe,n=>{var{on:e,config:t,addScalar:r,subtractScalar:i,multiplyScalar:s,divideScalar:a,pow:o,abs:l,fix:u,round:c,equal:h,isNumeric:d,format:f,number:p,Complex:m,BigNumber:y,Fraction:v}=n,b=p,x=!1,w=!0;function _(se,fe){if(!(this instanceof _))throw new Error("Constructor must be called with the new operator");if(!(se==null||d(se)||Qh(se)))throw new TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(this.fixPrefix=x,this.skipAutomaticSimplification=w,fe===void 0)this.units=[],this.dimensions=ue.map(P=>0);else if(typeof fe=="string"){var L=_.parse(fe);this.units=L.units,this.dimensions=L.dimensions}else if(Ro(fe)&&fe.value===null)this.fixPrefix=fe.fixPrefix,this.skipAutomaticSimplification=fe.skipAutomaticSimplification,this.dimensions=fe.dimensions.slice(0),this.units=fe.units.map(P=>ai({},P));else throw new TypeError("Second parameter in Unit constructor must be a string or valueless Unit");this.value=this._normalize(se)}Object.defineProperty(_,"name",{value:"Unit"}),_.prototype.constructor=_,_.prototype.type="Unit",_.prototype.isUnit=!0;var E,A,T;function S(){for(;T===" "||T==="	";)N()}function M(se){return se>="0"&&se<="9"||se==="."}function D(se){return se>="0"&&se<="9"}function N(){A++,T=E.charAt(A)}function R(se){A=se,T=E.charAt(A)}function z(){var se="",fe=A;if(T==="+"?N():T==="-"&&(se+=T,N()),!M(T))return R(fe),null;if(T==="."){if(se+=T,N(),!D(T))return R(fe),null}else{for(;D(T);)se+=T,N();T==="."&&(se+=T,N())}for(;D(T);)se+=T,N();if(T==="E"||T==="e"){var L="",P=A;if(L+=T,N(),(T==="+"||T==="-")&&(L+=T,N()),!D(T))return R(P),se;for(se=se+L;D(T);)se+=T,N()}return se}function j(){for(var se="";D(T)||_.isValidAlpha(T);)se+=T,N();var fe=se.charAt(0);return _.isValidAlpha(fe)?se:null}function I(se){return T===se?(N(),se):null}_.parse=function(se,fe){if(fe=fe||{},E=se,A=-1,T="",typeof E!="string")throw new TypeError("Invalid argument in Unit.parse, string expected");var L=new _;L.units=[];var P=1,K=!1;N(),S();var ae=z(),pe=null;if(ae){if(t.number==="BigNumber")pe=new y(ae);else if(t.number==="Fraction")try{pe=new v(ae)}catch{pe=parseFloat(ae)}else pe=parseFloat(ae);S(),I("*")?(P=1,K=!0):I("/")&&(P=-1,K=!0)}for(var ce=[],Ae=1;;){for(S();T==="(";)ce.push(P),Ae*=P,P=1,N(),S();var we=void 0;if(T){var Pe=T;if(we=j(),we===null)throw new SyntaxError('Unexpected "'+Pe+'" in "'+E+'" at index '+A.toString())}else break;var Te=F(we);if(Te===null)throw new SyntaxError('Unit "'+we+'" not found.');var Ne=P*Ae;if(S(),I("^")){S();var $e=z();if($e===null)throw new SyntaxError('In "'+se+'", "^" must be followed by a floating-point number');Ne*=$e}L.units.push({unit:Te.unit,prefix:Te.prefix,power:Ne});for(var Ye=0;Ye<ue.length;Ye++)L.dimensions[Ye]+=(Te.unit.dimensions[Ye]||0)*Ne;for(S();T===")";){if(ce.length===0)throw new SyntaxError('Unmatched ")" in "'+E+'" at index '+A.toString());Ae/=ce.pop(),N(),S()}if(K=!1,I("*")?(P=1,K=!0):I("/")?(P=-1,K=!0):P=1,Te.unit.base){var Ge=Te.unit.base.key;me.auto[Ge]={unit:Te.unit,prefix:Te.prefix}}}if(S(),T)throw new SyntaxError('Could not parse: "'+se+'"');if(K)throw new SyntaxError('Trailing characters: "'+se+'"');if(ce.length!==0)throw new SyntaxError('Unmatched "(" in "'+E+'"');if(L.units.length===0&&!fe.allowNoUnits)throw new SyntaxError('"'+se+'" contains no units');return L.value=pe!==void 0?L._normalize(pe):null,L},_.prototype.clone=function(){var se=new _;se.fixPrefix=this.fixPrefix,se.skipAutomaticSimplification=this.skipAutomaticSimplification,se.value=Ut(this.value),se.dimensions=this.dimensions.slice(0),se.units=[];for(var fe=0;fe<this.units.length;fe++){se.units[fe]={};for(var L in this.units[fe])vt(this.units[fe],L)&&(se.units[fe][L]=this.units[fe][L])}return se},_.prototype.valueType=function(){return Kn(this.value)},_.prototype._isDerived=function(){return this.units.length===0?!1:this.units.length>1||Math.abs(this.units[0].power-1)>1e-15},_.prototype._normalize=function(se){if(se==null||this.units.length===0)return se;for(var fe=se,L=_._getNumberConverter(Kn(se)),P=0;P<this.units.length;P++){var K=L(this.units[P].unit.value),ae=L(this.units[P].prefix.value),pe=L(this.units[P].power);fe=s(fe,o(s(K,ae),pe))}return fe},_.prototype._denormalize=function(se,fe){if(se==null||this.units.length===0)return se;for(var L=se,P=_._getNumberConverter(Kn(se)),K=0;K<this.units.length;K++){var ae=P(this.units[K].unit.value),pe=P(this.units[K].prefix.value),ce=P(this.units[K].power);L=a(L,o(s(ae,pe),ce))}return L};var F=lA(se=>{if(vt(Y,se)){var fe=Y[se],L=fe.prefixes[""];return{unit:fe,prefix:L}}for(var P in Y)if(vt(Y,P)&&iDe(se,P)){var K=Y[P],ae=se.length-P.length,pe=se.substring(0,ae),ce=vt(K.prefixes,pe)?K.prefixes[pe]:void 0;if(ce!==void 0)return{unit:K,prefix:ce}}return null},{hasher:se=>se[0],limit:100});_.isValuelessUnit=function(se){return F(se)!==null},_.prototype.hasBase=function(se){if(typeof se=="string"&&(se=Q[se]),!se)return!1;for(var fe=0;fe<ue.length;fe++)if(Math.abs((this.dimensions[fe]||0)-(se.dimensions[fe]||0))>1e-12)return!1;return!0},_.prototype.equalBase=function(se){for(var fe=0;fe<ue.length;fe++)if(Math.abs((this.dimensions[fe]||0)-(se.dimensions[fe]||0))>1e-12)return!1;return!0},_.prototype.equals=function(se){return this.equalBase(se)&&h(this.value,se.value)},_.prototype.multiply=function(se){for(var fe=this.clone(),L=Ro(se)?se:new _(se),P=0;P<ue.length;P++)fe.dimensions[P]=(this.dimensions[P]||0)+(L.dimensions[P]||0);for(var K=0;K<L.units.length;K++){var ae=ZI({},L.units[K]);fe.units.push(ae)}if(this.value!==null||L.value!==null){var pe=this.value===null?this._normalize(H(L.value)):this.value,ce=L.value===null?L._normalize(H(this.value)):L.value;fe.value=s(pe,ce)}else fe.value=null;return Ro(se)&&(fe.skipAutomaticSimplification=!1),$(fe)},_.prototype.divideInto=function(se){return new _(se).divide(this)},_.prototype.divide=function(se){for(var fe=this.clone(),L=Ro(se)?se:new _(se),P=0;P<ue.length;P++)fe.dimensions[P]=(this.dimensions[P]||0)-(L.dimensions[P]||0);for(var K=0;K<L.units.length;K++){var ae=ZI(ZI({},L.units[K]),{},{power:-L.units[K].power});fe.units.push(ae)}if(this.value!==null||L.value!==null){var pe=this.value===null?this._normalize(H(L.value)):this.value,ce=L.value===null?L._normalize(H(this.value)):L.value;fe.value=a(pe,ce)}else fe.value=null;return Ro(se)&&(fe.skipAutomaticSimplification=!1),$(fe)},_.prototype.pow=function(se){for(var fe=this.clone(),L=0;L<ue.length;L++)fe.dimensions[L]=(this.dimensions[L]||0)*se;for(var P=0;P<fe.units.length;P++)fe.units[P].power*=se;return fe.value!==null?fe.value=o(fe.value,se):fe.value=null,fe.skipAutomaticSimplification=!1,$(fe)};function $(se){return se.equalBase(Q.NONE)&&se.value!==null&&!t.predictable?se.value:se}function H(se){var fe=_._getNumberConverter(Kn(se));return fe(1)}_.prototype.abs=function(){var se=this.clone();if(se.value!==null)if(se._isDerived()||se.units.length===0||se.units[0].unit.offset===0)se.value=l(se.value);else{var fe=se._numberConverter(),L=fe(se.units[0].unit.value),P=fe(se.units[0].unit.offset),K=s(L,P);se.value=i(l(r(se.value,K)),K)}for(var ae in se.units)(se.units[ae].unit.name==="VA"||se.units[ae].unit.name==="VAR")&&(se.units[ae].unit=Y.W);return se},_.prototype.to=function(se){var fe=this.value===null?this._normalize(1):this.value,L;if(typeof se=="string")L=_.parse(se);else if(Ro(se))L=se.clone();else throw new Error("String or Unit expected as parameter");if(!this.equalBase(L))throw new Error("Units do not match ('".concat(L.toString(),"' != '").concat(this.toString(),"')"));if(L.value!==null)throw new Error("Cannot convert to a unit with a value");if(this.value===null||this._isDerived()||this.units.length===0||L.units.length===0||this.units[0].unit.offset===L.units[0].unit.offset)L.value=Ut(fe);else{var P=_._getNumberConverter(Kn(fe)),K=this.units[0].unit.value,ae=this.units[0].unit.offset,pe=s(K,ae),ce=L.units[0].unit.value,Ae=L.units[0].unit.offset,we=s(ce,Ae);L.value=r(fe,P(i(pe,we)))}return L.fixPrefix=!0,L.skipAutomaticSimplification=!0,L},_.prototype.toNumber=function(se){return b(this.toNumeric(se))},_.prototype.toNumeric=function(se){var fe;return se?fe=this.to(se):fe=this.clone(),fe._isDerived()||fe.units.length===0?fe._denormalize(fe.value):fe._denormalize(fe.value,fe.units[0].prefix.value)},_.prototype.toString=function(){return this.format()},_.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.units.length>0?this.formatUnits():null,fixPrefix:this.fixPrefix,skipSimp:this.skipAutomaticSimplification}},_.fromJSON=function(se){var fe,L,P,K=new _(se.value,(fe=se.unit)!==null&&fe!==void 0?fe:void 0);return K.fixPrefix=(L=se.fixPrefix)!==null&&L!==void 0?L:x,K.skipAutomaticSimplification=(P=se.skipSimp)!==null&&P!==void 0?P:w,K},_.prototype.valueOf=_.prototype.toString,_.prototype.simplify=function(){var se=this.clone(),fe=[],L;for(var P in be)if(vt(be,P)&&se.hasBase(Q[P])){L=P;break}if(L==="NONE")se.units=[];else{var K;if(L&&vt(be,L)&&(K=be[L]),K)se.units=[{unit:K.unit,prefix:K.prefix,power:1}];else{for(var ae=!1,pe=0;pe<ue.length;pe++){var ce=ue[pe];Math.abs(se.dimensions[pe]||0)>1e-12&&(vt(be,ce)?fe.push({unit:be[ce].unit,prefix:be[ce].prefix,power:se.dimensions[pe]||0}):ae=!0)}fe.length<se.units.length&&!ae&&(se.units=fe)}}return se},_.prototype.toSI=function(){for(var se=this.clone(),fe=[],L=0;L<ue.length;L++){var P=ue[L];if(Math.abs(se.dimensions[L]||0)>1e-12)if(vt(me.si,P))fe.push({unit:me.si[P].unit,prefix:me.si[P].prefix,power:se.dimensions[L]||0});else throw new Error("Cannot express custom unit "+P+" in SI units")}return se.units=fe,se.fixPrefix=!0,se.skipAutomaticSimplification=!0,this.value!==null?(se.value=null,this.to(se)):se},_.prototype.formatUnits=function(){for(var se="",fe="",L=0,P=0,K=0;K<this.units.length;K++)this.units[K].power>0?(L++,se+=" "+this.units[K].prefix.name+this.units[K].unit.name,Math.abs(this.units[K].power-1)>1e-15&&(se+="^"+this.units[K].power)):this.units[K].power<0&&P++;if(P>0)for(var ae=0;ae<this.units.length;ae++)this.units[ae].power<0&&(L>0?(fe+=" "+this.units[ae].prefix.name+this.units[ae].unit.name,Math.abs(this.units[ae].power+1)>1e-15&&(fe+="^"+-this.units[ae].power)):(fe+=" "+this.units[ae].prefix.name+this.units[ae].unit.name,fe+="^"+this.units[ae].power));se=se.substr(1),fe=fe.substr(1),L>1&&P>0&&(se="("+se+")"),P>1&&L>0&&(fe="("+fe+")");var pe=se;return L>0&&P>0&&(pe+=" / "),pe+=fe,pe},_.prototype.toBest=function(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(se&&!Array.isArray(se))throw new Error("Invalid unit type. Expected string or Unit.");var L=this.units[0].unit.prefixes;if(se&&se.length>0){var P=se.map(pe=>{var ce=null;if(typeof pe=="string"){if(ce=_.parse(pe),!ce)throw new Error("Invalid unit type. Expected compatible string or Unit.")}else if(!Ro(pe))throw new Error("Invalid unit type. Expected compatible string or Unit.");ce===null&&(ce=pe.clone());try{return this.to(ce.formatUnits()),ce}catch{throw new Error("Invalid unit type. Expected compatible string or Unit.")}}),K=P.map(pe=>pe.units[0].prefix);this.units[0].unit.prefixes=K.reduce((pe,ce)=>(pe[ce.name]=ce,pe),{}),this.units[0].prefix=K[0]}var ae=Z(this,fe).simp;return this.units[0].unit.prefixes=L,ae.fixPrefix=!0,ae},_.prototype.format=function(se){var{simp:fe,valueStr:L,unitStr:P}=Z(this,se),K=L;return fe.value&&Qh(fe.value)&&(K="("+K+")"),P.length>0&&K.length>0&&(K+=" "),K+=P,K};function Z(se){var fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},L=se.skipAutomaticSimplification||se.value===null?se.clone():se.simplify();J(L),ee(L,fe.offset);var P=L._denormalize(L.value),K=L.value!==null?f(P,fe||{}):"",ae=L.formatUnits();return{simp:L,valueStr:K,unitStr:ae}}function J(se){var fe=!1;typeof se.value<"u"&&se.value!==null&&Qh(se.value)&&(fe=Math.abs(se.value.re)<1e-14);for(var L in se.units)vt(se.units,L)&&se.units[L].unit&&(se.units[L].unit.name==="VA"&&fe?se.units[L].unit=Y.VAR:se.units[L].unit.name==="VAR"&&!fe&&(se.units[L].unit=Y.VA))}function ee(se,fe){se.units.length===1&&!se.fixPrefix&&Math.abs(se.units[0].power-Math.round(se.units[0].power))<1e-14&&(se.units[0].prefix=se._bestPrefix(fe))}_.prototype._bestPrefix=function(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1.2;if(this.units.length!==1)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");if(Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var fe=this.value!==null?l(this.value):0,L=l(this.units[0].unit.value),P=this.units[0].prefix;if(fe===0)return P;var K=this.units[0].power,ae=Math.log(fe/Math.pow(P.value*L,K))/Math.LN10-se;if(ae>-2.200001&&ae<1.800001)return P;ae=Math.abs(ae);var pe=this.units[0].unit.prefixes;for(var ce in pe)if(vt(pe,ce)){var Ae=pe[ce];if(Ae.scientific){var we=Math.abs(Math.log(fe/Math.pow(Ae.value*L,K))/Math.LN10-se);(we<ae||we===ae&&Ae.name.length<P.name.length)&&(P=Ae,ae=we)}}return P},_.prototype.splitUnit=function(se){for(var fe=this.clone(),L=[],P=0;P<se.length&&(fe=fe.to(se[P]),P!==se.length-1);P++){var K=fe.toNumeric(),ae=c(K),pe=void 0,ce=h(ae,K);ce?pe=ae:pe=u(fe.toNumeric());var Ae=new _(pe,se[P].toString());L.push(Ae),fe=i(fe,Ae)}for(var we=0,Pe=0;Pe<L.length;Pe++)we=r(we,L[Pe].value);return h(we,this.value)&&(fe.value=0),L.push(fe),L};var O={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},R:{name:"R",value:1e27,scientific:!0},Q:{name:"Q",value:1e30,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0},r:{name:"r",value:1e-27,scientific:!0},q:{name:"q",value:1e-30,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},ronna:{name:"ronna",value:1e27,scientific:!0},quetta:{name:"quetta",value:1e30,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0},ronto:{name:"ronto",value:1e-27,scientific:!0},quecto:{name:"quecto",value:1e-30,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},R:{name:"R",value:1e54,scientific:!0},Q:{name:"Q",value:1e60,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0},r:{name:"r",value:1e-54,scientific:!0},q:{name:"q",value:1e-60,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},R:{name:"R",value:1e81,scientific:!0},Q:{name:"Q",value:1e90,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0},r:{name:"r",value:1e-81,scientific:!0},q:{name:"q",value:1e-90,scientific:!0}},BINARY_SHORT_SI:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0}},BINARY_SHORT_IEC:{"":{name:"",value:1,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG_SI:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0}},BINARY_LONG_IEC:{"":{name:"",value:1,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};O.SHORTLONG=ai({},O.SHORT,O.LONG),O.BINARY_SHORT=ai({},O.BINARY_SHORT_SI,O.BINARY_SHORT_IEC),O.BINARY_LONG=ai({},O.BINARY_LONG_SI,O.BINARY_LONG_IEC);var ue=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],Q={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var re in Q)vt(Q,re)&&(Q[re].key=re);var le={},te={name:"",base:le,value:1,offset:0,dimensions:ue.map(se=>0)},Y={meter:{name:"meter",base:Q.LENGTH,prefixes:O.LONG,value:1,offset:0},inch:{name:"inch",base:Q.LENGTH,prefixes:O.NONE,value:.0254,offset:0},foot:{name:"foot",base:Q.LENGTH,prefixes:O.NONE,value:.3048,offset:0},yard:{name:"yard",base:Q.LENGTH,prefixes:O.NONE,value:.9144,offset:0},mile:{name:"mile",base:Q.LENGTH,prefixes:O.NONE,value:1609.344,offset:0},link:{name:"link",base:Q.LENGTH,prefixes:O.NONE,value:.201168,offset:0},rod:{name:"rod",base:Q.LENGTH,prefixes:O.NONE,value:5.0292,offset:0},chain:{name:"chain",base:Q.LENGTH,prefixes:O.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:Q.LENGTH,prefixes:O.NONE,value:1e-10,offset:0},m:{name:"m",base:Q.LENGTH,prefixes:O.SHORT,value:1,offset:0},in:{name:"in",base:Q.LENGTH,prefixes:O.NONE,value:.0254,offset:0},ft:{name:"ft",base:Q.LENGTH,prefixes:O.NONE,value:.3048,offset:0},yd:{name:"yd",base:Q.LENGTH,prefixes:O.NONE,value:.9144,offset:0},mi:{name:"mi",base:Q.LENGTH,prefixes:O.NONE,value:1609.344,offset:0},li:{name:"li",base:Q.LENGTH,prefixes:O.NONE,value:.201168,offset:0},rd:{name:"rd",base:Q.LENGTH,prefixes:O.NONE,value:5.02921,offset:0},ch:{name:"ch",base:Q.LENGTH,prefixes:O.NONE,value:20.1168,offset:0},mil:{name:"mil",base:Q.LENGTH,prefixes:O.NONE,value:254e-7,offset:0},m2:{name:"m2",base:Q.SURFACE,prefixes:O.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:Q.SURFACE,prefixes:O.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:Q.SURFACE,prefixes:O.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:Q.SURFACE,prefixes:O.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:Q.SURFACE,prefixes:O.NONE,value:2589988110336e-6,offset:0},sqrd:{name:"sqrd",base:Q.SURFACE,prefixes:O.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:Q.SURFACE,prefixes:O.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:Q.SURFACE,prefixes:O.NONE,value:64516e-14,offset:0},acre:{name:"acre",base:Q.SURFACE,prefixes:O.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:Q.SURFACE,prefixes:O.NONE,value:1e4,offset:0},m3:{name:"m3",base:Q.VOLUME,prefixes:O.CUBIC,value:1,offset:0},L:{name:"L",base:Q.VOLUME,prefixes:O.SHORT,value:.001,offset:0},l:{name:"l",base:Q.VOLUME,prefixes:O.SHORT,value:.001,offset:0},litre:{name:"litre",base:Q.VOLUME,prefixes:O.LONG,value:.001,offset:0},cuin:{name:"cuin",base:Q.VOLUME,prefixes:O.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:Q.VOLUME,prefixes:O.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:Q.VOLUME,prefixes:O.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:Q.VOLUME,prefixes:O.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:Q.VOLUME,prefixes:O.NONE,value:15e-6,offset:0},drop:{name:"drop",base:Q.VOLUME,prefixes:O.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:Q.VOLUME,prefixes:O.NONE,value:5e-8,offset:0},minim:{name:"minim",base:Q.VOLUME,prefixes:O.NONE,value:61611519921875e-21,offset:0},fluiddram:{name:"fluiddram",base:Q.VOLUME,prefixes:O.NONE,value:36966911953125e-19,offset:0},fluidounce:{name:"fluidounce",base:Q.VOLUME,prefixes:O.NONE,value:295735295625e-16,offset:0},gill:{name:"gill",base:Q.VOLUME,prefixes:O.NONE,value:.00011829411825,offset:0},cc:{name:"cc",base:Q.VOLUME,prefixes:O.NONE,value:1e-6,offset:0},cup:{name:"cup",base:Q.VOLUME,prefixes:O.NONE,value:.0002365882365,offset:0},pint:{name:"pint",base:Q.VOLUME,prefixes:O.NONE,value:.000473176473,offset:0},quart:{name:"quart",base:Q.VOLUME,prefixes:O.NONE,value:.000946352946,offset:0},gallon:{name:"gallon",base:Q.VOLUME,prefixes:O.NONE,value:.003785411784,offset:0},beerbarrel:{name:"beerbarrel",base:Q.VOLUME,prefixes:O.NONE,value:.117347765304,offset:0},oilbarrel:{name:"oilbarrel",base:Q.VOLUME,prefixes:O.NONE,value:.158987294928,offset:0},hogshead:{name:"hogshead",base:Q.VOLUME,prefixes:O.NONE,value:.238480942392,offset:0},g:{name:"g",base:Q.MASS,prefixes:O.SHORT,value:.001,offset:0},gram:{name:"gram",base:Q.MASS,prefixes:O.LONG,value:.001,offset:0},ton:{name:"ton",base:Q.MASS,prefixes:O.SHORT,value:907.18474,offset:0},t:{name:"t",base:Q.MASS,prefixes:O.SHORT,value:1e3,offset:0},tonne:{name:"tonne",base:Q.MASS,prefixes:O.LONG,value:1e3,offset:0},grain:{name:"grain",base:Q.MASS,prefixes:O.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:Q.MASS,prefixes:O.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:Q.MASS,prefixes:O.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:Q.MASS,prefixes:O.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:Q.MASS,prefixes:O.NONE,value:45.359237,offset:0},stick:{name:"stick",base:Q.MASS,prefixes:O.NONE,value:.115,offset:0},stone:{name:"stone",base:Q.MASS,prefixes:O.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:Q.MASS,prefixes:O.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:Q.MASS,prefixes:O.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:Q.MASS,prefixes:O.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:Q.MASS,prefixes:O.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:Q.MASS,prefixes:O.NONE,value:45.359237,offset:0},s:{name:"s",base:Q.TIME,prefixes:O.SHORT,value:1,offset:0},min:{name:"min",base:Q.TIME,prefixes:O.NONE,value:60,offset:0},h:{name:"h",base:Q.TIME,prefixes:O.NONE,value:3600,offset:0},second:{name:"second",base:Q.TIME,prefixes:O.LONG,value:1,offset:0},sec:{name:"sec",base:Q.TIME,prefixes:O.LONG,value:1,offset:0},minute:{name:"minute",base:Q.TIME,prefixes:O.NONE,value:60,offset:0},hour:{name:"hour",base:Q.TIME,prefixes:O.NONE,value:3600,offset:0},day:{name:"day",base:Q.TIME,prefixes:O.NONE,value:86400,offset:0},week:{name:"week",base:Q.TIME,prefixes:O.NONE,value:7*86400,offset:0},month:{name:"month",base:Q.TIME,prefixes:O.NONE,value:2629800,offset:0},year:{name:"year",base:Q.TIME,prefixes:O.NONE,value:31557600,offset:0},decade:{name:"decade",base:Q.TIME,prefixes:O.NONE,value:315576e3,offset:0},century:{name:"century",base:Q.TIME,prefixes:O.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:Q.TIME,prefixes:O.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:Q.FREQUENCY,prefixes:O.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:Q.FREQUENCY,prefixes:O.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:Q.ANGLE,prefixes:O.SHORT,value:1,offset:0},radian:{name:"radian",base:Q.ANGLE,prefixes:O.LONG,value:1,offset:0},deg:{name:"deg",base:Q.ANGLE,prefixes:O.SHORT,value:null,offset:0},degree:{name:"degree",base:Q.ANGLE,prefixes:O.LONG,value:null,offset:0},grad:{name:"grad",base:Q.ANGLE,prefixes:O.SHORT,value:null,offset:0},gradian:{name:"gradian",base:Q.ANGLE,prefixes:O.LONG,value:null,offset:0},cycle:{name:"cycle",base:Q.ANGLE,prefixes:O.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:Q.ANGLE,prefixes:O.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:Q.ANGLE,prefixes:O.NONE,value:null,offset:0},A:{name:"A",base:Q.CURRENT,prefixes:O.SHORT,value:1,offset:0},ampere:{name:"ampere",base:Q.CURRENT,prefixes:O.LONG,value:1,offset:0},K:{name:"K",base:Q.TEMPERATURE,prefixes:O.SHORT,value:1,offset:0},degC:{name:"degC",base:Q.TEMPERATURE,prefixes:O.SHORT,value:1,offset:273.15},degF:{name:"degF",base:Q.TEMPERATURE,prefixes:O.SHORT,value:new v(5,9),offset:459.67},degR:{name:"degR",base:Q.TEMPERATURE,prefixes:O.SHORT,value:new v(5,9),offset:0},kelvin:{name:"kelvin",base:Q.TEMPERATURE,prefixes:O.LONG,value:1,offset:0},celsius:{name:"celsius",base:Q.TEMPERATURE,prefixes:O.LONG,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:Q.TEMPERATURE,prefixes:O.LONG,value:new v(5,9),offset:459.67},rankine:{name:"rankine",base:Q.TEMPERATURE,prefixes:O.LONG,value:new v(5,9),offset:0},mol:{name:"mol",base:Q.AMOUNT_OF_SUBSTANCE,prefixes:O.SHORT,value:1,offset:0},mole:{name:"mole",base:Q.AMOUNT_OF_SUBSTANCE,prefixes:O.LONG,value:1,offset:0},cd:{name:"cd",base:Q.LUMINOUS_INTENSITY,prefixes:O.SHORT,value:1,offset:0},candela:{name:"candela",base:Q.LUMINOUS_INTENSITY,prefixes:O.LONG,value:1,offset:0},N:{name:"N",base:Q.FORCE,prefixes:O.SHORT,value:1,offset:0},newton:{name:"newton",base:Q.FORCE,prefixes:O.LONG,value:1,offset:0},dyn:{name:"dyn",base:Q.FORCE,prefixes:O.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:Q.FORCE,prefixes:O.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:Q.FORCE,prefixes:O.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:Q.FORCE,prefixes:O.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:Q.FORCE,prefixes:O.LONG,value:4448.2216,offset:0},kilogramforce:{name:"kilogramforce",base:Q.FORCE,prefixes:O.NONE,value:9.80665,offset:0},J:{name:"J",base:Q.ENERGY,prefixes:O.SHORT,value:1,offset:0},joule:{name:"joule",base:Q.ENERGY,prefixes:O.LONG,value:1,offset:0},erg:{name:"erg",base:Q.ENERGY,prefixes:O.SHORTLONG,value:1e-7,offset:0},Wh:{name:"Wh",base:Q.ENERGY,prefixes:O.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:Q.ENERGY,prefixes:O.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:Q.ENERGY,prefixes:O.SHORT,value:1602176565e-28,offset:0},electronvolt:{name:"electronvolt",base:Q.ENERGY,prefixes:O.LONG,value:1602176565e-28,offset:0},W:{name:"W",base:Q.POWER,prefixes:O.SHORT,value:1,offset:0},watt:{name:"watt",base:Q.POWER,prefixes:O.LONG,value:1,offset:0},hp:{name:"hp",base:Q.POWER,prefixes:O.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:Q.POWER,prefixes:O.SHORT,value:m.I,offset:0},VA:{name:"VA",base:Q.POWER,prefixes:O.SHORT,value:1,offset:0},Pa:{name:"Pa",base:Q.PRESSURE,prefixes:O.SHORT,value:1,offset:0},psi:{name:"psi",base:Q.PRESSURE,prefixes:O.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:Q.PRESSURE,prefixes:O.NONE,value:101325,offset:0},bar:{name:"bar",base:Q.PRESSURE,prefixes:O.SHORTLONG,value:1e5,offset:0},torr:{name:"torr",base:Q.PRESSURE,prefixes:O.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:Q.PRESSURE,prefixes:O.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:Q.PRESSURE,prefixes:O.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:Q.PRESSURE,prefixes:O.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:Q.ELECTRIC_CHARGE,prefixes:O.LONG,value:1,offset:0},C:{name:"C",base:Q.ELECTRIC_CHARGE,prefixes:O.SHORT,value:1,offset:0},farad:{name:"farad",base:Q.ELECTRIC_CAPACITANCE,prefixes:O.LONG,value:1,offset:0},F:{name:"F",base:Q.ELECTRIC_CAPACITANCE,prefixes:O.SHORT,value:1,offset:0},volt:{name:"volt",base:Q.ELECTRIC_POTENTIAL,prefixes:O.LONG,value:1,offset:0},V:{name:"V",base:Q.ELECTRIC_POTENTIAL,prefixes:O.SHORT,value:1,offset:0},ohm:{name:"ohm",base:Q.ELECTRIC_RESISTANCE,prefixes:O.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:Q.ELECTRIC_INDUCTANCE,prefixes:O.LONG,value:1,offset:0},H:{name:"H",base:Q.ELECTRIC_INDUCTANCE,prefixes:O.SHORT,value:1,offset:0},siemens:{name:"siemens",base:Q.ELECTRIC_CONDUCTANCE,prefixes:O.LONG,value:1,offset:0},S:{name:"S",base:Q.ELECTRIC_CONDUCTANCE,prefixes:O.SHORT,value:1,offset:0},weber:{name:"weber",base:Q.MAGNETIC_FLUX,prefixes:O.LONG,value:1,offset:0},Wb:{name:"Wb",base:Q.MAGNETIC_FLUX,prefixes:O.SHORT,value:1,offset:0},tesla:{name:"tesla",base:Q.MAGNETIC_FLUX_DENSITY,prefixes:O.LONG,value:1,offset:0},T:{name:"T",base:Q.MAGNETIC_FLUX_DENSITY,prefixes:O.SHORT,value:1,offset:0},b:{name:"b",base:Q.BIT,prefixes:O.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:Q.BIT,prefixes:O.BINARY_LONG,value:1,offset:0},B:{name:"B",base:Q.BIT,prefixes:O.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:Q.BIT,prefixes:O.BINARY_LONG,value:8,offset:0}},oe={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fldr:"fluiddram",fluiddrams:"fluiddram",floz:"fluidounce",fluidounces:"fluidounce",gi:"gill",gills:"gill",cp:"cup",cups:"cup",pt:"pint",pints:"pint",qt:"quart",quarts:"quart",gal:"gallon",gallons:"gallon",bbl:"beerbarrel",beerbarrels:"beerbarrel",obl:"oilbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",kgf:"kilogramforce",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",decades:"decade",centuries:"century",millennia:"millennium",hertz:"hertz",radians:"radian",degrees:"degree",gradians:"gradian",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",amps:"ampere",amp:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole",bit:"bits",byte:"bytes"};function ve(se){if(se.number==="BigNumber"){var fe=sU(y);Y.rad.value=new y(1),Y.deg.value=fe.div(180),Y.grad.value=fe.div(200),Y.cycle.value=fe.times(2),Y.arcsec.value=fe.div(648e3),Y.arcmin.value=fe.div(10800)}else Y.rad.value=1,Y.deg.value=Math.PI/180,Y.grad.value=Math.PI/200,Y.cycle.value=Math.PI*2,Y.arcsec.value=Math.PI/648e3,Y.arcmin.value=Math.PI/10800;Y.radian.value=Y.rad.value,Y.degree.value=Y.deg.value,Y.gradian.value=Y.grad.value}ve(t),e&&e("config",function(se,fe){se.number!==fe.number&&ve(se)});var me={si:{NONE:{unit:te,prefix:O.NONE[""]},LENGTH:{unit:Y.m,prefix:O.SHORT[""]},MASS:{unit:Y.g,prefix:O.SHORT.k},TIME:{unit:Y.s,prefix:O.SHORT[""]},CURRENT:{unit:Y.A,prefix:O.SHORT[""]},TEMPERATURE:{unit:Y.K,prefix:O.SHORT[""]},LUMINOUS_INTENSITY:{unit:Y.cd,prefix:O.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:Y.mol,prefix:O.SHORT[""]},ANGLE:{unit:Y.rad,prefix:O.SHORT[""]},BIT:{unit:Y.bits,prefix:O.SHORT[""]},FORCE:{unit:Y.N,prefix:O.SHORT[""]},ENERGY:{unit:Y.J,prefix:O.SHORT[""]},POWER:{unit:Y.W,prefix:O.SHORT[""]},PRESSURE:{unit:Y.Pa,prefix:O.SHORT[""]},ELECTRIC_CHARGE:{unit:Y.C,prefix:O.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:Y.F,prefix:O.SHORT[""]},ELECTRIC_POTENTIAL:{unit:Y.V,prefix:O.SHORT[""]},ELECTRIC_RESISTANCE:{unit:Y.ohm,prefix:O.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:Y.H,prefix:O.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:Y.S,prefix:O.SHORT[""]},MAGNETIC_FLUX:{unit:Y.Wb,prefix:O.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:Y.T,prefix:O.SHORT[""]},FREQUENCY:{unit:Y.Hz,prefix:O.SHORT[""]}}};me.cgs=JSON.parse(JSON.stringify(me.si)),me.cgs.LENGTH={unit:Y.m,prefix:O.SHORT.c},me.cgs.MASS={unit:Y.g,prefix:O.SHORT[""]},me.cgs.FORCE={unit:Y.dyn,prefix:O.SHORT[""]},me.cgs.ENERGY={unit:Y.erg,prefix:O.NONE[""]},me.us=JSON.parse(JSON.stringify(me.si)),me.us.LENGTH={unit:Y.ft,prefix:O.NONE[""]},me.us.MASS={unit:Y.lbm,prefix:O.NONE[""]},me.us.TEMPERATURE={unit:Y.degF,prefix:O.NONE[""]},me.us.FORCE={unit:Y.lbf,prefix:O.NONE[""]},me.us.ENERGY={unit:Y.BTU,prefix:O.BTU[""]},me.us.POWER={unit:Y.hp,prefix:O.NONE[""]},me.us.PRESSURE={unit:Y.psi,prefix:O.NONE[""]},me.auto=JSON.parse(JSON.stringify(me.si));var be=me.auto;_.setUnitSystem=function(se){if(vt(me,se))be=me[se];else throw new Error("Unit system "+se+" does not exist. Choices are: "+Object.keys(me).join(", "))},_.getUnitSystem=function(){for(var se in me)if(vt(me,se)&&me[se]===be)return se},_.typeConverters={BigNumber:function(fe){return fe!=null&&fe.isFraction?new y(String(fe.n)).div(String(fe.d)).times(String(fe.s)):new y(fe+"")},Fraction:function(fe){return new v(fe)},Complex:function(fe){return fe},number:function(fe){return fe!=null&&fe.isFraction?p(fe):fe}},_.prototype._numberConverter=function(){var se=_.typeConverters[this.valueType()];if(se)return se;throw new TypeError('Unsupported Unit value type "'+this.valueType()+'"')},_._getNumberConverter=function(se){if(!_.typeConverters[se])throw new TypeError('Unsupported type "'+se+'"');return _.typeConverters[se]};for(var _e in Y)if(vt(Y,_e)){var Be=Y[_e];Be.dimensions=Be.base.dimensions}for(var ze in oe)if(vt(oe,ze)){var tt=Y[oe[ze]],de={};for(var Xe in tt)vt(tt,Xe)&&(de[Xe]=tt[Xe]);de.name=ze,Y[ze]=de}_.isValidAlpha=function(fe){return/^[a-zA-Z]$/.test(fe)};function Ke(se){for(var fe=0;fe<se.length;fe++){if(T=se.charAt(fe),fe===0&&!_.isValidAlpha(T))throw new Error('Invalid unit name (must begin with alpha character): "'+se+'"');if(fe>0&&!(_.isValidAlpha(T)||D(T)))throw new Error('Invalid unit name (only alphanumeric characters are allowed): "'+se+'"')}}return _.createUnit=function(se,fe){if(typeof se!="object")throw new TypeError("createUnit expects first parameter to be of type 'Object'");if(fe&&fe.override){for(var L in se)if(vt(se,L)&&_.deleteUnit(L),se[L].aliases)for(var P=0;P<se[L].aliases.length;P++)_.deleteUnit(se[L].aliases[P])}var K;for(var ae in se)vt(se,ae)&&(K=_.createUnitSingle(ae,se[ae]));return K},_.createUnitSingle=function(se,fe){if((typeof fe>"u"||fe===null)&&(fe={}),typeof se!="string")throw new TypeError("createUnitSingle expects first parameter to be of type 'string'");if(vt(Y,se))throw new Error('Cannot create unit "'+se+'": a unit with that name already exists');Ke(se);var L=null,P=[],K=0,ae,pe,ce;if(fe&&fe.type==="Unit")L=fe.clone();else if(typeof fe=="string")fe!==""&&(ae=fe);else if(typeof fe=="object")ae=fe.definition,pe=fe.prefixes,K=fe.offset,ce=fe.baseName,fe.aliases&&(P=fe.aliases.valueOf());else throw new TypeError('Cannot create unit "'+se+'" from "'+fe.toString()+'": expecting "string" or "Unit" or "Object"');if(P){for(var Ae=0;Ae<P.length;Ae++)if(vt(Y,P[Ae]))throw new Error('Cannot create alias "'+P[Ae]+'": a unit with that name already exists')}if(ae&&typeof ae=="string"&&!L)try{L=_.parse(ae,{allowNoUnits:!0})}catch(Le){throw Le.message='Could not create unit "'+se+'" from "'+ae+'": '+Le.message,Le}else ae&&ae.type==="Unit"&&(L=ae.clone());P=P||[],K=K||0,pe&&pe.toUpperCase?pe=O[pe.toUpperCase()]||O.NONE:pe=O.NONE;var we={};if(L){we={name:se,value:L.value,dimensions:L.dimensions.slice(0),prefixes:pe,offset:K};var $e=!1;for(var Ye in Q)if(vt(Q,Ye)){for(var Ge=!0,qe=0;qe<ue.length;qe++)if(Math.abs((we.dimensions[qe]||0)-(Q[Ye].dimensions[qe]||0))>1e-12){Ge=!1;break}if(Ge){$e=!0,we.base=Q[Ye];break}}if(!$e){ce=ce||se+"_STUFF";var V={dimensions:L.dimensions.slice(0)};V.key=ce,Q[ce]=V,be[ce]={unit:we,prefix:O.NONE[""]},we.base=Q[ce]}}else{if(ce=ce||se+"_STUFF",ue.indexOf(ce)>=0)throw new Error('Cannot create new base unit "'+se+'": a base unit with that name already exists (and cannot be overridden)');ue.push(ce);for(var Pe in Q)vt(Q,Pe)&&(Q[Pe].dimensions[ue.length-1]=0);for(var Te={dimensions:[]},Ne=0;Ne<ue.length;Ne++)Te.dimensions[Ne]=0;Te.dimensions[ue.length-1]=1,Te.key=ce,Q[ce]=Te,we={name:se,value:1,dimensions:Q[ce].dimensions.slice(0),prefixes:pe,offset:K,base:Q[ce]},be[ce]={unit:we,prefix:O.NONE[""]}}_.UNITS[se]=we;for(var W=0;W<P.length;W++){var ye=P[W],Ee={};for(var Fe in we)vt(we,Fe)&&(Ee[Fe]=we[Fe]);Ee.name=ye,_.UNITS[ye]=Ee}return delete F.cache,new _(null,se)},_.deleteUnit=function(se){delete _.UNITS[se],delete F.cache},_.PREFIXES=O,_.BASE_DIMENSIONS=ue,_.BASE_UNITS=Q,_.UNIT_SYSTEMS=me,_.UNITS=Y,_},{isClass:!0}),AH="unit",iFe=["typed","Unit"],sFe=ie(AH,iFe,n=>{var{typed:e,Unit:t}=n;return e(AH,{Unit:function(i){return i.clone()},string:function(i){return t.isValuelessUnit(i)?new t(null,i):t.parse(i,{allowNoUnits:!0})},"number | BigNumber | Fraction | Complex, string | Unit":function(i,s){return new t(i,s)},"number | BigNumber | Fraction":function(i){return new t(i)},"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))})}),TH="sparse",aFe=["typed","SparseMatrix"],oFe=ie(TH,aFe,n=>{var{typed:e,SparseMatrix:t}=n;return e(TH,{"":function(){return new t([])},string:function(i){return new t([],i)},"Array | Matrix":function(i){return new t(i)},"Array | Matrix, string":function(i,s){return new t(i,s)}})}),MH="createUnit",lFe=["typed","Unit"],uFe=ie(MH,lFe,n=>{var{typed:e,Unit:t}=n;return e(MH,{"Object, Object":function(i,s){return t.createUnit(i,s)},Object:function(i){return t.createUnit(i,{})},"string, Unit | string | Object, Object":function(i,s,a){var o={};return o[i]=s,t.createUnit(o,a)},"string, Unit | string | Object":function(i,s){var a={};return a[i]=s,t.createUnit(a,{})},string:function(i){var s={};return s[i]={},t.createUnit(s,{})}})}),CH="acos",cFe=["typed","config","Complex"],hFe=ie(CH,cFe,n=>{var{typed:e,config:t,Complex:r}=n;return e(CH,{number:function(s){return s>=-1&&s<=1||t.predictable?Math.acos(s):new r(s,0).acos()},Complex:function(s){return s.acos()},BigNumber:function(s){return s.acos()}})}),DH="acosh",dFe=["typed","config","Complex"],fFe=ie(DH,dFe,n=>{var{typed:e,config:t,Complex:r}=n;return e(DH,{number:function(s){return s>=1||t.predictable?lne(s):s<=-1?new r(Math.log(Math.sqrt(s*s-1)-s),Math.PI):new r(s,0).acosh()},Complex:function(s){return s.acosh()},BigNumber:function(s){return s.acosh()}})}),NH="acot",pFe=["typed","BigNumber"],mFe=ie(NH,pFe,n=>{var{typed:e,BigNumber:t}=n;return e(NH,{number:une,Complex:function(i){return i.acot()},BigNumber:function(i){return new t(1).div(i).atan()}})}),RH="acoth",gFe=["typed","config","Complex","BigNumber"],vFe=ie(RH,gFe,n=>{var{typed:e,config:t,Complex:r,BigNumber:i}=n;return e(RH,{number:function(a){return a>=1||a<=-1||t.predictable?cne(a):new r(a,0).acoth()},Complex:function(a){return a.acoth()},BigNumber:function(a){return new i(1).div(a).atanh()}})}),IH="acsc",yFe=["typed","config","Complex","BigNumber"],xFe=ie(IH,yFe,n=>{var{typed:e,config:t,Complex:r,BigNumber:i}=n;return e(IH,{number:function(a){return a<=-1||a>=1||t.predictable?hne(a):new r(a,0).acsc()},Complex:function(a){return a.acsc()},BigNumber:function(a){return new i(1).div(a).asin()}})}),PH="acsch",bFe=["typed","BigNumber"],_Fe=ie(PH,bFe,n=>{var{typed:e,BigNumber:t}=n;return e(PH,{number:dne,Complex:function(i){return i.acsch()},BigNumber:function(i){return new t(1).div(i).asinh()}})}),FH="asec",wFe=["typed","config","Complex","BigNumber"],EFe=ie(FH,wFe,n=>{var{typed:e,config:t,Complex:r,BigNumber:i}=n;return e(FH,{number:function(a){return a<=-1||a>=1||t.predictable?fne(a):new r(a,0).asec()},Complex:function(a){return a.asec()},BigNumber:function(a){return new i(1).div(a).acos()}})}),LH="asech",SFe=["typed","config","Complex","BigNumber"],AFe=ie(LH,SFe,n=>{var{typed:e,config:t,Complex:r,BigNumber:i}=n;return e(LH,{number:function(a){if(a<=1&&a>=-1||t.predictable){var o=1/a;if(o>0||t.predictable)return pne(a);var l=Math.sqrt(o*o-1);return new r(Math.log(l-o),Math.PI)}return new r(a,0).asech()},Complex:function(a){return a.asech()},BigNumber:function(a){return new i(1).div(a).acosh()}})}),OH="asin",TFe=["typed","config","Complex"],MFe=ie(OH,TFe,n=>{var{typed:e,config:t,Complex:r}=n;return e(OH,{number:function(s){return s>=-1&&s<=1||t.predictable?Math.asin(s):new r(s,0).asin()},Complex:function(s){return s.asin()},BigNumber:function(s){return s.asin()}})}),CFe="asinh",DFe=["typed"],NFe=ie(CFe,DFe,n=>{var{typed:e}=n;return e("asinh",{number:mne,Complex:function(r){return r.asinh()},BigNumber:function(r){return r.asinh()}})}),RFe="atan",IFe=["typed"],PFe=ie(RFe,IFe,n=>{var{typed:e}=n;return e("atan",{number:function(r){return Math.atan(r)},Complex:function(r){return r.atan()},BigNumber:function(r){return r.atan()}})}),kH="atan2",FFe=["typed","matrix","equalScalar","BigNumber","DenseMatrix","concat"],LFe=ie(kH,FFe,n=>{var{typed:e,matrix:t,equalScalar:r,BigNumber:i,DenseMatrix:s,concat:a}=n,o=bu({typed:e,equalScalar:r}),l=ia({typed:e}),u=Nne({typed:e,equalScalar:r}),c=Rs({typed:e,equalScalar:r}),h=Bi({typed:e,DenseMatrix:s}),d=ar({typed:e,matrix:t,concat:a});return e(kH,{"number, number":Math.atan2,"BigNumber, BigNumber":(f,p)=>i.atan2(f,p)},d({scalar:"number | BigNumber",SS:u,DS:l,SD:o,Ss:c,sS:h}))}),BH="atanh",OFe=["typed","config","Complex"],kFe=ie(BH,OFe,n=>{var{typed:e,config:t,Complex:r}=n;return e(BH,{number:function(s){return s<=1&&s>=-1||t.predictable?gne(s):new r(s,0).atanh()},Complex:function(s){return s.atanh()},BigNumber:function(s){return s.atanh()}})}),Qb=ie("trigUnit",["typed"],n=>{var{typed:e}=n;return{Unit:e.referToSelf(t=>r=>{if(!r.hasBase(r.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return e.find(t,r.valueType())(r.value)})}}),UH="cos",BFe=["typed"],UFe=ie(UH,BFe,n=>{var{typed:e}=n,t=Qb({typed:e});return e(UH,{number:Math.cos,"Complex | BigNumber":r=>r.cos()},t)}),VH="cosh",VFe=["typed"],zFe=ie(VH,VFe,n=>{var{typed:e}=n;return e(VH,{number:NMe,"Complex | BigNumber":t=>t.cosh()})}),zH="cot",$Fe=["typed","BigNumber"],HFe=ie(zH,$Fe,n=>{var{typed:e,BigNumber:t}=n,r=Qb({typed:e});return e(zH,{number:vne,Complex:i=>i.cot(),BigNumber:i=>new t(1).div(i.tan())},r)}),$H="coth",GFe=["typed","BigNumber"],jFe=ie($H,GFe,n=>{var{typed:e,BigNumber:t}=n;return e($H,{number:yne,Complex:r=>r.coth(),BigNumber:r=>new t(1).div(r.tanh())})}),HH="csc",qFe=["typed","BigNumber"],WFe=ie(HH,qFe,n=>{var{typed:e,BigNumber:t}=n,r=Qb({typed:e});return e(HH,{number:xne,Complex:i=>i.csc(),BigNumber:i=>new t(1).div(i.sin())},r)}),GH="csch",XFe=["typed","BigNumber"],KFe=ie(GH,XFe,n=>{var{typed:e,BigNumber:t}=n;return e(GH,{number:bne,Complex:r=>r.csch(),BigNumber:r=>new t(1).div(r.sinh())})}),jH="sec",YFe=["typed","BigNumber"],QFe=ie(jH,YFe,n=>{var{typed:e,BigNumber:t}=n,r=Qb({typed:e});return e(jH,{number:_ne,Complex:i=>i.sec(),BigNumber:i=>new t(1).div(i.cos())},r)}),qH="sech",ZFe=["typed","BigNumber"],JFe=ie(qH,ZFe,n=>{var{typed:e,BigNumber:t}=n;return e(qH,{number:wne,Complex:r=>r.sech(),BigNumber:r=>new t(1).div(r.cosh())})}),WH="sin",eLe=["typed"],tLe=ie(WH,eLe,n=>{var{typed:e}=n,t=Qb({typed:e});return e(WH,{number:Math.sin,"Complex | BigNumber":r=>r.sin()},t)}),XH="sinh",nLe=["typed"],rLe=ie(XH,nLe,n=>{var{typed:e}=n;return e(XH,{number:Ene,"Complex | BigNumber":t=>t.sinh()})}),KH="tan",iLe=["typed"],sLe=ie(KH,iLe,n=>{var{typed:e}=n,t=Qb({typed:e});return e(KH,{number:Math.tan,"Complex | BigNumber":r=>r.tan()},t)}),aLe="tanh",oLe=["typed"],lLe=ie(aLe,oLe,n=>{var{typed:e}=n;return e("tanh",{number:IMe,"Complex | BigNumber":t=>t.tanh()})}),YH="setCartesian",uLe=["typed","size","subset","compareNatural","Index","DenseMatrix"],cLe=ie(YH,uLe,n=>{var{typed:e,size:t,subset:r,compareNatural:i,Index:s,DenseMatrix:a}=n;return e(YH,{"Array | Matrix, Array | Matrix":function(l,u){var c=[];if(r(t(l),new s(0))!==0&&r(t(u),new s(0))!==0){var h=Tn(Array.isArray(l)?l:l.toArray()).sort(i),d=Tn(Array.isArray(u)?u:u.toArray()).sort(i);c=[];for(var f=0;f<h.length;f++)for(var p=0;p<d.length;p++)c.push([h[f],d[p]])}return Array.isArray(l)&&Array.isArray(u)?c:new a(c)}})}),QH="setDifference",hLe=["typed","size","subset","compareNatural","Index","DenseMatrix"],dLe=ie(QH,hLe,n=>{var{typed:e,size:t,subset:r,compareNatural:i,Index:s,DenseMatrix:a}=n;return e(QH,{"Array | Matrix, Array | Matrix":function(l,u){var c;if(r(t(l),new s(0))===0)c=[];else{if(r(t(u),new s(0))===0)return Tn(l.toArray());var h=Sb(Tn(Array.isArray(l)?l:l.toArray()).sort(i)),d=Sb(Tn(Array.isArray(u)?u:u.toArray()).sort(i));c=[];for(var f,p=0;p<h.length;p++){f=!1;for(var m=0;m<d.length;m++)if(i(h[p].value,d[m].value)===0&&h[p].identifier===d[m].identifier){f=!0;break}f||c.push(h[p])}}return Array.isArray(l)&&Array.isArray(u)?BD(c):new a(BD(c))}})}),ZH="setDistinct",fLe=["typed","size","subset","compareNatural","Index","DenseMatrix"],pLe=ie(ZH,fLe,n=>{var{typed:e,size:t,subset:r,compareNatural:i,Index:s,DenseMatrix:a}=n;return e(ZH,{"Array | Matrix":function(l){var u;if(r(t(l),new s(0))===0)u=[];else{var c=Tn(Array.isArray(l)?l:l.toArray()).sort(i);u=[],u.push(c[0]);for(var h=1;h<c.length;h++)i(c[h],c[h-1])!==0&&u.push(c[h])}return Array.isArray(l)?u:new a(u)}})}),JH="setIntersect",mLe=["typed","size","subset","compareNatural","Index","DenseMatrix"],gLe=ie(JH,mLe,n=>{var{typed:e,size:t,subset:r,compareNatural:i,Index:s,DenseMatrix:a}=n;return e(JH,{"Array | Matrix, Array | Matrix":function(l,u){var c;if(r(t(l),new s(0))===0||r(t(u),new s(0))===0)c=[];else{var h=Sb(Tn(Array.isArray(l)?l:l.toArray()).sort(i)),d=Sb(Tn(Array.isArray(u)?u:u.toArray()).sort(i));c=[];for(var f=0;f<h.length;f++)for(var p=0;p<d.length;p++)if(i(h[f].value,d[p].value)===0&&h[f].identifier===d[p].identifier){c.push(h[f]);break}}return Array.isArray(l)&&Array.isArray(u)?BD(c):new a(BD(c))}})}),eG="setIsSubset",vLe=["typed","size","subset","compareNatural","Index"],yLe=ie(eG,vLe,n=>{var{typed:e,size:t,subset:r,compareNatural:i,Index:s}=n;return e(eG,{"Array | Matrix, Array | Matrix":function(o,l){if(r(t(o),new s(0))===0)return!0;if(r(t(l),new s(0))===0)return!1;for(var u=Sb(Tn(Array.isArray(o)?o:o.toArray()).sort(i)),c=Sb(Tn(Array.isArray(l)?l:l.toArray()).sort(i)),h,d=0;d<u.length;d++){h=!1;for(var f=0;f<c.length;f++)if(i(u[d].value,c[f].value)===0&&u[d].identifier===c[f].identifier){h=!0;break}if(h===!1)return!1}return!0}})}),tG="setMultiplicity",xLe=["typed","size","subset","compareNatural","Index"],bLe=ie(tG,xLe,n=>{var{typed:e,size:t,subset:r,compareNatural:i,Index:s}=n;return e(tG,{"number | BigNumber | Fraction | Complex, Array | Matrix":function(o,l){if(r(t(l),new s(0))===0)return 0;for(var u=Tn(Array.isArray(l)?l:l.toArray()),c=0,h=0;h<u.length;h++)i(u[h],o)===0&&c++;return c}})}),nG="setPowerset",_Le=["typed","size","subset","compareNatural","Index"],wLe=ie(nG,_Le,n=>{var{typed:e,size:t,subset:r,compareNatural:i,Index:s}=n;return e(nG,{"Array | Matrix":function(u){if(r(t(u),new s(0))===0)return[];for(var c=Tn(Array.isArray(u)?u:u.toArray()).sort(i),h=[],d=0;d.toString(2).length<=c.length;)h.push(a(c,d.toString(2).split("").reverse())),d++;return o(h)}});function a(l,u){for(var c=[],h=0;h<u.length;h++)u[h]==="1"&&c.push(l[h]);return c}function o(l){for(var u=[],c=l.length-1;c>0;c--)for(var h=0;h<c;h++)l[h].length>l[h+1].length&&(u=l[h],l[h]=l[h+1],l[h+1]=u);return l}}),rG="setSize",ELe=["typed","compareNatural"],SLe=ie(rG,ELe,n=>{var{typed:e,compareNatural:t}=n;return e(rG,{"Array | Matrix":function(i){return Array.isArray(i)?Tn(i).length:Tn(i.toArray()).length},"Array | Matrix, boolean":function(i,s){if(s===!1||i.length===0)return Array.isArray(i)?Tn(i).length:Tn(i.toArray()).length;for(var a=Tn(Array.isArray(i)?i:i.toArray()).sort(t),o=1,l=1;l<a.length;l++)t(a[l],a[l-1])!==0&&o++;return o}})}),iG="setSymDifference",ALe=["typed","size","concat","subset","setDifference","Index"],TLe=ie(iG,ALe,n=>{var{typed:e,size:t,concat:r,subset:i,setDifference:s,Index:a}=n;return e(iG,{"Array | Matrix, Array | Matrix":function(l,u){if(i(t(l),new a(0))===0)return Tn(u);if(i(t(u),new a(0))===0)return Tn(l);var c=Tn(l),h=Tn(u);return r(s(c,h),s(h,c))}})}),sG="setUnion",MLe=["typed","size","concat","subset","setIntersect","setSymDifference","Index"],CLe=ie(sG,MLe,n=>{var{typed:e,size:t,concat:r,subset:i,setIntersect:s,setSymDifference:a,Index:o}=n;return e(sG,{"Array | Matrix, Array | Matrix":function(u,c){if(i(t(u),new o(0))===0)return Tn(c);if(i(t(c),new o(0))===0)return Tn(u);var h=Tn(u),d=Tn(c);return r(a(h,d),s(h,d))}})}),aG="add",DLe=["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix","concat"],NLe=ie(aG,DLe,n=>{var{typed:e,matrix:t,addScalar:r,equalScalar:i,DenseMatrix:s,SparseMatrix:a,concat:o}=n,l=Qp({typed:e}),u=J4({typed:e,equalScalar:i}),c=$v({typed:e,DenseMatrix:s}),h=ar({typed:e,matrix:t,concat:o});return e(aG,{"any, any":r,"any, any, ...any":e.referToSelf(d=>(f,p,m)=>{for(var y=d(f,p),v=0;v<m.length;v++)y=d(y,m[v]);return y})},h({elop:r,DS:l,SS:u,Ss:c}))}),oG="hypot",RLe=["typed","abs","addScalar","divideScalar","multiplyScalar","sqrt","smaller","isPositive"],ILe=ie(oG,RLe,n=>{var{typed:e,abs:t,addScalar:r,divideScalar:i,multiplyScalar:s,sqrt:a,smaller:o,isPositive:l}=n;return e(oG,{"... number | BigNumber":u,Array:u,Matrix:c=>u(Tn(c.toArray(),!0))});function u(c){for(var h=0,d=0,f=0;f<c.length;f++){if(Qh(c[f]))throw new TypeError("Unexpected type of argument to hypot");var p=t(c[f]);o(d,p)?(h=s(h,s(i(d,p),i(d,p))),h=r(h,1),d=p):h=r(h,l(p)?s(i(p,d),i(p,d)):p)}return s(d,a(h))}}),lG="norm",PLe=["typed","abs","add","pow","conj","sqrt","multiply","equalScalar","larger","smaller","matrix","ctranspose","eigs"],FLe=ie(lG,PLe,n=>{var{typed:e,abs:t,add:r,pow:i,conj:s,sqrt:a,multiply:o,equalScalar:l,larger:u,smaller:c,matrix:h,ctranspose:d,eigs:f}=n;return e(lG,{number:Math.abs,Complex:function(T){return T.abs()},BigNumber:function(T){return T.abs()},boolean:function(T){return Math.abs(T)},Array:function(T){return E(h(T),2)},Matrix:function(T){return E(T,2)},"Array, number | BigNumber | string":function(T,S){return E(h(T),S)},"Matrix, number | BigNumber | string":function(T,S){return E(T,S)}});function p(A){var T=0;return A.forEach(function(S){var M=t(S);u(M,T)&&(T=M)},!0),T}function m(A){var T;return A.forEach(function(S){var M=t(S);(!T||c(M,T))&&(T=M)},!0),T||0}function y(A,T){if(T===Number.POSITIVE_INFINITY||T==="inf")return p(A);if(T===Number.NEGATIVE_INFINITY||T==="-inf")return m(A);if(T==="fro")return E(A,2);if(typeof T=="number"&&!isNaN(T)){if(!l(T,0)){var S=0;return A.forEach(function(M){S=r(i(t(M),T),S)},!0),i(S,1/T)}return Number.POSITIVE_INFINITY}throw new Error("Unsupported parameter value")}function v(A){var T=0;return A.forEach(function(S,M){T=r(T,o(S,s(S)))}),t(a(T))}function b(A){var T=[],S=0;return A.forEach(function(M,D){var N=D[1],R=r(T[N]||0,t(M));u(R,S)&&(S=R),T[N]=R},!0),S}function x(A){var T=A.size();if(T[0]!==T[1])throw new RangeError("Invalid matrix dimensions");var S=d(A),M=o(S,A),D=f(M).values.toArray(),N=D[D.length-1];return t(a(N))}function w(A){var T=[],S=0;return A.forEach(function(M,D){var N=D[0],R=r(T[N]||0,t(M));u(R,S)&&(S=R),T[N]=R},!0),S}function _(A,T){if(T===1)return b(A);if(T===Number.POSITIVE_INFINITY||T==="inf")return w(A);if(T==="fro")return v(A);if(T===2)return x(A);throw new Error("Unsupported parameter value "+T)}function E(A,T){var S=A.size();if(S.length===1)return y(A,T);if(S.length===2){if(S[0]&&S[1])return _(A,T);throw new RangeError("Invalid matrix dimensions")}}}),uG="dot",LLe=["typed","addScalar","multiplyScalar","conj","size"],OLe=ie(uG,LLe,n=>{var{typed:e,addScalar:t,multiplyScalar:r,conj:i,size:s}=n;return e(uG,{"Array | DenseMatrix, Array | DenseMatrix":o,"SparseMatrix, SparseMatrix":l});function a(u,c){var h=s(u),d=s(c),f,p;if(h.length===1)f=h[0];else if(h.length===2&&h[1]===1)f=h[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+h.join(", ")+")");if(d.length===1)p=d[0];else if(d.length===2&&d[1]===1)p=d[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+d.join(", ")+")");if(f!==p)throw new RangeError("Vectors must have equal length ("+f+" != "+p+")");if(f===0)throw new RangeError("Cannot calculate the dot product of empty vectors");return f}function o(u,c){var h=a(u,c),d=Dt(u)?u._data:u,f=Dt(u)?u._datatype||u.getDataType():void 0,p=Dt(c)?c._data:c,m=Dt(c)?c._datatype||c.getDataType():void 0,y=s(u).length===2,v=s(c).length===2,b=t,x=r;if(f&&m&&f===m&&typeof f=="string"&&f!=="mixed"){var w=f;b=e.find(t,[w,w]),x=e.find(r,[w,w])}if(!y&&!v){for(var _=x(i(d[0]),p[0]),E=1;E<h;E++)_=b(_,x(i(d[E]),p[E]));return _}if(!y&&v){for(var A=x(i(d[0]),p[0][0]),T=1;T<h;T++)A=b(A,x(i(d[T]),p[T][0]));return A}if(y&&!v){for(var S=x(i(d[0][0]),p[0]),M=1;M<h;M++)S=b(S,x(i(d[M][0]),p[M]));return S}if(y&&v){for(var D=x(i(d[0][0]),p[0][0]),N=1;N<h;N++)D=b(D,x(i(d[N][0]),p[N][0]));return D}}function l(u,c){a(u,c);for(var h=u._index,d=u._values,f=c._index,p=c._values,m=0,y=t,v=r,b=0,x=0;b<h.length&&x<f.length;){var w=h[b],_=f[x];if(w<_){b++;continue}if(w>_){x++;continue}w===_&&(m=y(m,v(d[b],p[x])),b++,x++)}return m}}),kLe="trace",BLe=["typed","matrix","add"],ULe=ie(kLe,BLe,n=>{var{typed:e,matrix:t,add:r}=n;return e("trace",{Array:function(o){return i(t(o))},SparseMatrix:s,DenseMatrix:i,any:Ut});function i(a){var o=a._size,l=a._data;switch(o.length){case 1:if(o[0]===1)return Ut(l[0]);throw new RangeError("Matrix must be square (size: "+nn(o)+")");case 2:{var u=o[0],c=o[1];if(u===c){for(var h=0,d=0;d<u;d++)h=r(h,l[d][d]);return h}else throw new RangeError("Matrix must be square (size: "+nn(o)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+nn(o)+")")}}function s(a){var o=a._values,l=a._index,u=a._ptr,c=a._size,h=c[0],d=c[1];if(h===d){var f=0;if(o.length>0)for(var p=0;p<d;p++)for(var m=u[p],y=u[p+1],v=m;v<y;v++){var b=l[v];if(b===p){f=r(f,o[v]);break}if(b>p)break}return f}throw new RangeError("Matrix must be square (size: "+nn(c)+")")}}),cG="index",VLe=["typed","Index"],zLe=ie(cG,VLe,n=>{var{typed:e,Index:t}=n;return e(cG,{"...number | string | BigNumber | Range | Array | Matrix":function(i){var s=i.map(function(o){return jt(o)?o.toNumber():Wn(o)||Dt(o)?o.map(function(l){return jt(l)?l.toNumber():l}):o}),a=new t;return t.apply(a,s),a}})}),Yne=new Set(["end"]),$Le="Node",HLe=["mathWithTransform"],GLe=ie($Le,HLe,n=>{var{mathWithTransform:e}=n;function t(i){for(var s of[...Yne])if(i.has(s))throw new Error('Scope contains an illegal symbol, "'+s+'" is a reserved keyword')}class r{get type(){return"Node"}get isNode(){return!0}evaluate(s){return this.compile().evaluate(s)}compile(){var s=this._compile(e,{}),a={},o=null;function l(u){var c=Ty(u);return t(c),s(c,a,o)}return{evaluate:l}}_compile(s,a){throw new Error("Method _compile must be implemented by type "+this.type)}forEach(s){throw new Error("Cannot run forEach on a Node interface")}map(s){throw new Error("Cannot run map on a Node interface")}_ifNode(s){if(!zn(s))throw new TypeError("Callback function must return a Node");return s}traverse(s){s(this,null,null);function a(o,l){o.forEach(function(u,c,h){l(u,c,h),a(u,l)})}a(this,s)}transform(s){function a(o,l,u){var c=s(o,l,u);return c!==o?c:o.map(a)}return a(this,null,null)}filter(s){var a=[];return this.traverse(function(o,l,u){s(o,l,u)&&a.push(o)}),a}clone(){throw new Error("Cannot clone a Node interface")}cloneDeep(){return this.map(function(s){return s.cloneDeep()})}equals(s){return s?this.type===s.type&&yd(this,s):!1}toString(s){var a=this._getCustomString(s);return typeof a<"u"?a:this._toString(s)}_toString(){throw new Error("_toString not implemented for "+this.type)}toJSON(){throw new Error("Cannot serialize object: toJSON not implemented by "+this.type)}toHTML(s){var a=this._getCustomString(s);return typeof a<"u"?a:this._toHTML(s)}_toHTML(){throw new Error("_toHTML not implemented for "+this.type)}toTex(s){var a=this._getCustomString(s);return typeof a<"u"?a:this._toTex(s)}_toTex(s){throw new Error("_toTex not implemented for "+this.type)}_getCustomString(s){if(s&&typeof s=="object")switch(typeof s.handler){case"object":case"undefined":return;case"function":return s.handler(this,s);default:throw new TypeError("Object or function expected as callback")}}getIdentifier(){return this.type}getContent(){return this}}return r},{isClass:!0,isNode:!0});function Ra(n){return n&&n.isIndexError?new yu(n.index+1,n.min+1,n.max!==void 0?n.max+1:void 0):n}function Qne(n){var{subset:e}=n;return function(r,i){try{if(Array.isArray(r))return e(r,i);if(r&&typeof r.subset=="function")return r.subset(i);if(typeof r=="string")return e(r,i);if(typeof r=="object"){if(!i.isObjectProperty())throw new TypeError("Cannot apply a numeric index as object property");return Ea(r,i.getObjectProperty())}else throw new TypeError("Cannot apply index: unsupported type of object")}catch(s){throw Ra(s)}}}var OT="AccessorNode",jLe=["subset","Node"],qLe=ie(OT,jLe,n=>{var{subset:e,Node:t}=n,r=Qne({subset:e});function i(a){return!(gd(a)||fl(a)||pn(a)||Fp(a)||NN(a)||vd(a)||is(a))}class s extends t{constructor(o,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(super(),!zn(o))throw new TypeError('Node expected for parameter "object"');if(!qb(l))throw new TypeError('IndexNode expected for parameter "index"');this.object=o,this.index=l,this.optionalChaining=u}get name(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}get type(){return OT}get isAccessorNode(){return!0}_compile(o,l){var u=this.object._compile(o,l),c=this.index._compile(o,l),h=this.optionalChaining,d=gd(this.object)&&this.object.optionalChaining;if(this.index.isObjectProperty()){var f=this.index.getObjectProperty();return function(m,y,v){var b=v||{},x=u(m,y,b);if(h&&x==null){b.optionalShortCircuit=!0;return}if(!(d&&b!==null&&b!==void 0&&b.optionalShortCircuit))return Ea(x,f)}}else return function(m,y,v){var b=v||{},x=u(m,y,b);if(h&&x==null){b.optionalShortCircuit=!0;return}if(!(d&&b!==null&&b!==void 0&&b.optionalShortCircuit)){var w=c(m,y,x);return r(x,w)}}}forEach(o){o(this.object,"object",this),o(this.index,"index",this)}map(o){return new s(this._ifNode(o(this.object,"object",this)),this._ifNode(o(this.index,"index",this)),this.optionalChaining)}clone(){return new s(this.object,this.index,this.optionalChaining)}_toString(o){var l=this.object.toString(o);i(this.object)&&(l="("+l+")");var u=this.optionalChaining?this.index.dotNotation?"?":"?.":"";return l+u+this.index.toString(o)}_toHTML(o){var l=this.object.toHTML(o);return i(this.object)&&(l='<span class="math-parenthesis math-round-parenthesis">(</span>'+l+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l+this.index.toHTML(o)}_toTex(o){var l=this.object.toTex(o);return i(this.object)&&(l="\\left(' + object + '\\right)"),l+this.index.toTex(o)}toJSON(){return{mathjs:OT,object:this.object,index:this.index,optionalChaining:this.optionalChaining}}static fromJSON(o){return new s(o.object,o.index,o.optionalChaining)}}return bi(s,"name",OT),s},{isClass:!0,isNode:!0}),kT="ArrayNode",WLe=["Node"],XLe=ie(kT,WLe,n=>{var{Node:e}=n;class t extends e{constructor(i){if(super(),this.items=i||[],!Array.isArray(this.items)||!this.items.every(zn))throw new TypeError("Array containing Nodes expected")}get type(){return kT}get isArrayNode(){return!0}_compile(i,s){var a=vp(this.items,function(u){return u._compile(i,s)}),o=i.config.matrix!=="Array";if(o){var l=i.matrix;return function(c,h,d){return l(vp(a,function(f){return f(c,h,d)}))}}else return function(c,h,d){return vp(a,function(f){return f(c,h,d)})}}forEach(i){for(var s=0;s<this.items.length;s++){var a=this.items[s];i(a,"items["+s+"]",this)}}map(i){for(var s=[],a=0;a<this.items.length;a++)s[a]=this._ifNode(i(this.items[a],"items["+a+"]",this));return new t(s)}clone(){return new t(this.items.slice(0))}_toString(i){var s=this.items.map(function(a){return a.toString(i)});return"["+s.join(", ")+"]"}toJSON(){return{mathjs:kT,items:this.items}}static fromJSON(i){return new t(i.items)}_toHTML(i){var s=this.items.map(function(a){return a.toHTML(i)});return'<span class="math-parenthesis math-square-parenthesis">[</span>'+s.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'}_toTex(i){function s(a,o){var l=a.some(fl)&&!a.every(fl),u=o||l,c=u?"&":"\\\\",h=a.map(function(d){return d.items?s(d.items,!o):d.toTex(i)}).join(c);return l||!u||u&&!o?"\\begin{bmatrix}"+h+"\\end{bmatrix}":h}return s(this.items,!1)}}return bi(t,"name",kT),t},{isClass:!0,isNode:!0});function KLe(n){var{subset:e,matrix:t}=n;return function(i,s,a){try{if(Array.isArray(i)){var o=t(i).subset(s,a).valueOf();return o.forEach((l,u)=>{i[u]=l}),i}else{if(i&&typeof i.subset=="function")return i.subset(s,a);if(typeof i=="string")return e(i,s,a);if(typeof i=="object"){if(!s.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return bb(i,s.getObjectProperty(),a),i}else throw new TypeError("Cannot apply index: unsupported type of object")}}catch(l){throw Ra(l)}}}var iu=[{AssignmentNode:{},FunctionAssignmentNode:{}},{ConditionalNode:{latexLeftParens:!1,latexRightParens:!1,latexParens:!1}},{"OperatorNode:or":{op:"or",associativity:"left",associativeWith:[]}},{"OperatorNode:xor":{op:"xor",associativity:"left",associativeWith:[]}},{"OperatorNode:and":{op:"and",associativity:"left",associativeWith:[]}},{"OperatorNode:bitOr":{op:"|",associativity:"left",associativeWith:[]}},{"OperatorNode:bitXor":{op:"^|",associativity:"left",associativeWith:[]}},{"OperatorNode:bitAnd":{op:"&",associativity:"left",associativeWith:[]}},{"OperatorNode:equal":{op:"==",associativity:"left",associativeWith:[]},"OperatorNode:unequal":{op:"!=",associativity:"left",associativeWith:[]},"OperatorNode:smaller":{op:"<",associativity:"left",associativeWith:[]},"OperatorNode:larger":{op:">",associativity:"left",associativeWith:[]},"OperatorNode:smallerEq":{op:"<=",associativity:"left",associativeWith:[]},"OperatorNode:largerEq":{op:">=",associativity:"left",associativeWith:[]},RelationalNode:{associativity:"left",associativeWith:[]}},{"OperatorNode:leftShift":{op:"<<",associativity:"left",associativeWith:[]},"OperatorNode:rightArithShift":{op:">>",associativity:"left",associativeWith:[]},"OperatorNode:rightLogShift":{op:">>>",associativity:"left",associativeWith:[]}},{"OperatorNode:to":{op:"to",associativity:"left",associativeWith:[]}},{RangeNode:{}},{"OperatorNode:add":{op:"+",associativity:"left",associativeWith:["OperatorNode:add","OperatorNode:subtract"]},"OperatorNode:subtract":{op:"-",associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{op:"*",associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]},"OperatorNode:divide":{op:"/",associativity:"left",associativeWith:[],latexLeftParens:!1,latexRightParens:!1,latexParens:!1},"OperatorNode:dotMultiply":{op:".*",associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","OperatorNode:dotMultiply","OperatorNode:doDivide"]},"OperatorNode:dotDivide":{op:"./",associativity:"left",associativeWith:[]},"OperatorNode:mod":{op:"mod",associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]}},{"OperatorNode:unaryPlus":{op:"+",associativity:"right"},"OperatorNode:unaryMinus":{op:"-",associativity:"right"},"OperatorNode:bitNot":{op:"~",associativity:"right"},"OperatorNode:not":{op:"not",associativity:"right"}},{"OperatorNode:pow":{op:"^",associativity:"right",associativeWith:[],latexRightParens:!1},"OperatorNode:dotPow":{op:".^",associativity:"right",associativeWith:[]}},{"OperatorNode:nullish":{op:"??",associativity:"left",associativeWith:[]}},{"OperatorNode:factorial":{op:"!",associativity:"left"}},{"OperatorNode:ctranspose":{op:"'",associativity:"left"}}];function BT(n,e){if(!e||e!=="auto")return n;for(var t=n;vd(t);)t=t.content;return t}function Xn(n,e,t,r){var i=n;e!=="keep"&&(i=n.getContent());for(var s=i.getIdentifier(),a=null,o=0;o<iu.length;o++)if(s in iu[o]){a=o;break}if(s==="OperatorNode:multiply"&&i.implicit&&t!=="show"){var l=BT(i.args[0],e);!(pn(l)&&r&&r.getIdentifier()==="OperatorNode:divide"&&vO(BT(r.args[0],e)))&&!(l.getIdentifier()==="OperatorNode:divide"&&vO(BT(l.args[0],e))&&pn(BT(l.args[1])))&&(a+=1)}return a}function R_(n,e){var t=n;e!=="keep"&&(t=n.getContent());var r=t.getIdentifier(),i=Xn(t,e);if(i===null)return null;var s=iu[i][r];if(vt(s,"associativity")){if(s.associativity==="left")return"left";if(s.associativity==="right")return"right";throw Error("'"+r+"' has the invalid associativity '"+s.associativity+"'.")}return null}function JI(n,e,t){var r=t!=="keep"?n.getContent():n,i=t!=="keep"?n.getContent():e,s=r.getIdentifier(),a=i.getIdentifier(),o=Xn(r,t);if(o===null)return null;var l=iu[o][s];if(vt(l,"associativeWith")&&l.associativeWith instanceof Array){for(var u=0;u<l.associativeWith.length;u++)if(l.associativeWith[u]===a)return!0;return!1}return null}function YLe(n){var e="OperatorNode:"+n;for(var t of iu)if(e in t)return t[e].op;return null}var UT="AssignmentNode",QLe=["subset","?matrix","Node"],ZLe=ie(UT,QLe,n=>{var{subset:e,matrix:t,Node:r}=n,i=Qne({subset:e}),s=KLe({subset:e,matrix:t});function a(l,u,c){u||(u="keep");var h=Xn(l,u,c),d=Xn(l.value,u,c);return u==="all"||d!==null&&d<=h}class o extends r{constructor(u,c,h){if(super(),this.object=u,this.index=h?c:null,this.value=h||c,!is(u)&&!gd(u))throw new TypeError('SymbolNode or AccessorNode expected as "object"');if(is(u)&&u.name==="end")throw new Error('Cannot assign to symbol "end"');if(this.index&&!qb(this.index))throw new TypeError('IndexNode expected as "index"');if(!zn(this.value))throw new TypeError('Node expected as "value"')}get name(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}get type(){return UT}get isAssignmentNode(){return!0}_compile(u,c){var h=this.object._compile(u,c),d=this.index?this.index._compile(u,c):null,f=this.value._compile(u,c),p=this.object.name;if(this.index)if(this.index.isObjectProperty()){var m=this.index.getObjectProperty();return function(w,_,E){var A=h(w,_,E),T=f(w,_,E);return bb(A,m,T),T}}else{if(is(this.object))return function(w,_,E){var A=h(w,_,E),T=f(w,_,E),S=d(w,_,A);return w.set(p,s(A,S,T)),T};var y=this.object.object._compile(u,c);if(this.object.index.isObjectProperty()){var v=this.object.index.getObjectProperty();return function(w,_,E){var A=y(w,_,E),T=Ea(A,v),S=d(w,_,T),M=f(w,_,E);return bb(A,v,s(T,S,M)),M}}else{var b=this.object.index._compile(u,c);return function(w,_,E){var A=y(w,_,E),T=b(w,_,A),S=i(A,T),M=d(w,_,S),D=f(w,_,E);return s(A,T,s(S,M,D)),D}}}else{if(!is(this.object))throw new TypeError("SymbolNode expected as object");return function(w,_,E){var A=f(w,_,E);return w.set(p,A),A}}}forEach(u){u(this.object,"object",this),this.index&&u(this.index,"index",this),u(this.value,"value",this)}map(u){var c=this._ifNode(u(this.object,"object",this)),h=this.index?this._ifNode(u(this.index,"index",this)):null,d=this._ifNode(u(this.value,"value",this));return new o(c,h,d)}clone(){return new o(this.object,this.index,this.value)}_toString(u){var c=this.object.toString(u),h=this.index?this.index.toString(u):"",d=this.value.toString(u);return a(this,u&&u.parenthesis,u&&u.implicit)&&(d="("+d+")"),c+h+" = "+d}toJSON(){return{mathjs:UT,object:this.object,index:this.index,value:this.value}}static fromJSON(u){return new o(u.object,u.index,u.value)}_toHTML(u){var c=this.object.toHTML(u),h=this.index?this.index.toHTML(u):"",d=this.value.toHTML(u);return a(this,u&&u.parenthesis,u&&u.implicit)&&(d='<span class="math-paranthesis math-round-parenthesis">(</span>'+d+'<span class="math-paranthesis math-round-parenthesis">)</span>'),c+h+'<span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+d}_toTex(u){var c=this.object.toTex(u),h=this.index?this.index.toTex(u):"",d=this.value.toTex(u);return a(this,u&&u.parenthesis,u&&u.implicit)&&(d="\\left(".concat(d,"\\right)")),c+h+"="+d}}return bi(o,"name",UT),o},{isClass:!0,isNode:!0}),VT="BlockNode",JLe=["ResultSet","Node"],eOe=ie(VT,JLe,n=>{var{ResultSet:e,Node:t}=n;class r extends t{constructor(s){if(super(),!Array.isArray(s))throw new Error("Array expected");this.blocks=s.map(function(a){var o=a&&a.node,l=a&&a.visible!==void 0?a.visible:!0;if(!zn(o))throw new TypeError('Property "node" must be a Node');if(typeof l!="boolean")throw new TypeError('Property "visible" must be a boolean');return{node:o,visible:l}})}get type(){return VT}get isBlockNode(){return!0}_compile(s,a){var o=vp(this.blocks,function(l){return{evaluate:l.node._compile(s,a),visible:l.visible}});return function(u,c,h){var d=[];return Ite(o,function(p){var m=p.evaluate(u,c,h);p.visible&&d.push(m)}),new e(d)}}forEach(s){for(var a=0;a<this.blocks.length;a++)s(this.blocks[a].node,"blocks["+a+"].node",this)}map(s){for(var a=[],o=0;o<this.blocks.length;o++){var l=this.blocks[o],u=this._ifNode(s(l.node,"blocks["+o+"].node",this));a[o]={node:u,visible:l.visible}}return new r(a)}clone(){var s=this.blocks.map(function(a){return{node:a.node,visible:a.visible}});return new r(s)}_toString(s){return this.blocks.map(function(a){return a.node.toString(s)+(a.visible?"":";")}).join(`
`)}toJSON(){return{mathjs:VT,blocks:this.blocks}}static fromJSON(s){return new r(s.blocks)}_toHTML(s){return this.blocks.map(function(a){return a.node.toHTML(s)+(a.visible?"":'<span class="math-separator">;</span>')}).join('<span class="math-separator"><br /></span>')}_toTex(s){return this.blocks.map(function(a){return a.node.toTex(s)+(a.visible?"":";")}).join(`\\;\\;
`)}}return bi(r,"name",VT),r},{isClass:!0,isNode:!0}),zT="ConditionalNode",tOe=["Node"],nOe=ie(zT,tOe,n=>{var{Node:e}=n;function t(i){if(typeof i=="number"||typeof i=="boolean"||typeof i=="string")return!!i;if(i){if(jt(i))return!i.isZero();if(Qh(i))return!!(i.re||i.im);if(Ro(i))return!!i.value}if(i==null)return!1;throw new TypeError('Unsupported type of condition "'+Kn(i)+'"')}class r extends e{constructor(s,a,o){if(super(),!zn(s))throw new TypeError("Parameter condition must be a Node");if(!zn(a))throw new TypeError("Parameter trueExpr must be a Node");if(!zn(o))throw new TypeError("Parameter falseExpr must be a Node");this.condition=s,this.trueExpr=a,this.falseExpr=o}get type(){return zT}get isConditionalNode(){return!0}_compile(s,a){var o=this.condition._compile(s,a),l=this.trueExpr._compile(s,a),u=this.falseExpr._compile(s,a);return function(h,d,f){return t(o(h,d,f))?l(h,d,f):u(h,d,f)}}forEach(s){s(this.condition,"condition",this),s(this.trueExpr,"trueExpr",this),s(this.falseExpr,"falseExpr",this)}map(s){return new r(this._ifNode(s(this.condition,"condition",this)),this._ifNode(s(this.trueExpr,"trueExpr",this)),this._ifNode(s(this.falseExpr,"falseExpr",this)))}clone(){return new r(this.condition,this.trueExpr,this.falseExpr)}_toString(s){var a=s&&s.parenthesis?s.parenthesis:"keep",o=Xn(this,a,s&&s.implicit),l=this.condition.toString(s),u=Xn(this.condition,a,s&&s.implicit);(a==="all"||this.condition.type==="OperatorNode"||u!==null&&u<=o)&&(l="("+l+")");var c=this.trueExpr.toString(s),h=Xn(this.trueExpr,a,s&&s.implicit);(a==="all"||this.trueExpr.type==="OperatorNode"||h!==null&&h<=o)&&(c="("+c+")");var d=this.falseExpr.toString(s),f=Xn(this.falseExpr,a,s&&s.implicit);return(a==="all"||this.falseExpr.type==="OperatorNode"||f!==null&&f<=o)&&(d="("+d+")"),l+" ? "+c+" : "+d}toJSON(){return{mathjs:zT,condition:this.condition,trueExpr:this.trueExpr,falseExpr:this.falseExpr}}static fromJSON(s){return new r(s.condition,s.trueExpr,s.falseExpr)}_toHTML(s){var a=s&&s.parenthesis?s.parenthesis:"keep",o=Xn(this,a,s&&s.implicit),l=this.condition.toHTML(s),u=Xn(this.condition,a,s&&s.implicit);(a==="all"||this.condition.type==="OperatorNode"||u!==null&&u<=o)&&(l='<span class="math-parenthesis math-round-parenthesis">(</span>'+l+'<span class="math-parenthesis math-round-parenthesis">)</span>');var c=this.trueExpr.toHTML(s),h=Xn(this.trueExpr,a,s&&s.implicit);(a==="all"||this.trueExpr.type==="OperatorNode"||h!==null&&h<=o)&&(c='<span class="math-parenthesis math-round-parenthesis">(</span>'+c+'<span class="math-parenthesis math-round-parenthesis">)</span>');var d=this.falseExpr.toHTML(s),f=Xn(this.falseExpr,a,s&&s.implicit);return(a==="all"||this.falseExpr.type==="OperatorNode"||f!==null&&f<=o)&&(d='<span class="math-parenthesis math-round-parenthesis">(</span>'+d+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l+'<span class="math-operator math-conditional-operator">?</span>'+c+'<span class="math-operator math-conditional-operator">:</span>'+d}_toTex(s){return"\\begin{cases} {"+this.trueExpr.toTex(s)+"}, &\\quad{\\text{if }\\;"+this.condition.toTex(s)+"}\\\\{"+this.falseExpr.toTex(s)+"}, &\\quad{\\text{otherwise}}\\end{cases}"}}return bi(r,"name",zT),r},{isClass:!0,isNode:!0}),LO=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},rOe={"{":"\\{","}":"\\}","\\":"\\textbackslash{}","#":"\\#",$:"\\$","%":"\\%","&":"\\&","^":"\\textasciicircum{}",_:"\\_","~":"\\textasciitilde{}"},iOe={"":"\\--","":"\\---"," ":"~","	":"\\qquad{}","\r\n":"\\newline{}","\n":"\\newline{}"},sOe=function(e,t){return LO({},e,t)},aOe=function(n){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.preserveFormatting,r=t===void 0?!1:t,i=e.escapeMapFn,s=i===void 0?sOe:i,a=String(n),o="",l=s(LO({},rOe),r?LO({},iOe):{}),u=Object.keys(l),c=function(){var d=!1;u.forEach(function(f,p){d||a.length>=f.length&&a.slice(0,f.length)===f&&(o+=l[u[p]],a=a.slice(f.length,a.length),d=!0)}),d||(o+=a.slice(0,1),a=a.slice(1,a.length))};a;)c();return o};const oOe=w2(aOe);var OO={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega",true:"\\mathrm{True}",false:"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},wn={transpose:"^\\top",ctranspose:"^H",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"\\~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},hG={abs:{1:"\\left|${args[0]}\\right|"},add:{2:"\\left(${args[0]}".concat(wn.add,"${args[1]}\\right)")},cbrt:{1:"\\sqrt[3]{${args[0]}}"},ceil:{1:"\\left\\lceil${args[0]}\\right\\rceil"},cube:{1:"\\left(${args[0]}\\right)^3"},divide:{2:"\\frac{${args[0]}}{${args[1]}}"},dotDivide:{2:"\\left(${args[0]}".concat(wn.dotDivide,"${args[1]}\\right)")},dotMultiply:{2:"\\left(${args[0]}".concat(wn.dotMultiply,"${args[1]}\\right)")},dotPow:{2:"\\left(${args[0]}".concat(wn.dotPow,"${args[1]}\\right)")},exp:{1:"\\exp\\left(${args[0]}\\right)"},expm1:"\\left(e".concat(wn.pow,"{${args[0]}}-1\\right)"),fix:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},floor:{1:"\\left\\lfloor${args[0]}\\right\\rfloor"},fraction:{2:"\\frac{${args[0]}}{${args[1]}}"},gcd:"\\gcd\\left(${args}\\right)",hypot:"\\hypot\\left(${args}\\right)",log:{1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"},log10:{1:"\\log_{10}\\left(${args[0]}\\right)"},log1p:{1:"\\ln\\left(${args[0]}+1\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}+1\\right)"},log2:"\\log_{2}\\left(${args[0]}\\right)",mod:{2:"\\left(${args[0]}".concat(wn.mod,"${args[1]}\\right)")},multiply:{2:"\\left(${args[0]}".concat(wn.multiply,"${args[1]}\\right)")},norm:{1:"\\left\\|${args[0]}\\right\\|",2:void 0},nthRoot:{2:"\\sqrt[${args[1]}]{${args[0]}}"},nthRoots:{2:"\\{y : y^${args[1]} = {${args[0]}}\\}"},pow:{2:"\\left(${args[0]}\\right)".concat(wn.pow,"{${args[1]}}")},round:{1:"\\left\\lfloor${args[0]}\\right\\rceil",2:void 0},sign:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},sqrt:{1:"\\sqrt{${args[0]}}"},square:{1:"\\left(${args[0]}\\right)^2"},subtract:{2:"\\left(${args[0]}".concat(wn.subtract,"${args[1]}\\right)")},unaryMinus:{1:"".concat(wn.unaryMinus,"\\left(${args[0]}\\right)")},unaryPlus:{1:"".concat(wn.unaryPlus,"\\left(${args[0]}\\right)")},bitAnd:{2:"\\left(${args[0]}".concat(wn.bitAnd,"${args[1]}\\right)")},bitNot:{1:wn.bitNot+"\\left(${args[0]}\\right)"},bitOr:{2:"\\left(${args[0]}".concat(wn.bitOr,"${args[1]}\\right)")},bitXor:{2:"\\left(${args[0]}".concat(wn.bitXor,"${args[1]}\\right)")},leftShift:{2:"\\left(${args[0]}".concat(wn.leftShift,"${args[1]}\\right)")},rightArithShift:{2:"\\left(${args[0]}".concat(wn.rightArithShift,"${args[1]}\\right)")},rightLogShift:{2:"\\left(${args[0]}".concat(wn.rightLogShift,"${args[1]}\\right)")},bellNumbers:{1:"\\mathrm{B}_{${args[0]}}"},catalan:{1:"\\mathrm{C}_{${args[0]}}"},stirlingS2:{2:"\\mathrm{S}\\left(${args}\\right)"},arg:{1:"\\arg\\left(${args[0]}\\right)"},conj:{1:"\\left(${args[0]}\\right)^*"},im:{1:"\\Im\\left\\lbrace${args[0]}\\right\\rbrace"},re:{1:"\\Re\\left\\lbrace${args[0]}\\right\\rbrace"},and:{2:"\\left(${args[0]}".concat(wn.and,"${args[1]}\\right)")},not:{1:wn.not+"\\left(${args[0]}\\right)"},or:{2:"\\left(${args[0]}".concat(wn.or,"${args[1]}\\right)")},xor:{2:"\\left(${args[0]}".concat(wn.xor,"${args[1]}\\right)")},cross:{2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"},ctranspose:{1:"\\left(${args[0]}\\right)".concat(wn.ctranspose)},det:{1:"\\det\\left(${args[0]}\\right)"},dot:{2:"\\left(${args[0]}\\cdot${args[1]}\\right)"},expm:{1:"\\exp\\left(${args[0]}\\right)"},inv:{1:"\\left(${args[0]}\\right)^{-1}"},pinv:{1:"\\left(${args[0]}\\right)^{+}"},sqrtm:{1:"{${args[0]}}".concat(wn.pow,"{\\frac{1}{2}}")},trace:{1:"\\mathrm{tr}\\left(${args[0]}\\right)"},transpose:{1:"\\left(${args[0]}\\right)".concat(wn.transpose)},combinations:{2:"\\binom{${args[0]}}{${args[1]}}"},combinationsWithRep:{2:"\\left(\\!\\!{\\binom{${args[0]}}{${args[1]}}}\\!\\!\\right)"},factorial:{1:"\\left(${args[0]}\\right)".concat(wn.factorial)},gamma:{1:"\\Gamma\\left(${args[0]}\\right)"},lgamma:{1:"\\ln\\Gamma\\left(${args[0]}\\right)"},equal:{2:"\\left(${args[0]}".concat(wn.equal,"${args[1]}\\right)")},larger:{2:"\\left(${args[0]}".concat(wn.larger,"${args[1]}\\right)")},largerEq:{2:"\\left(${args[0]}".concat(wn.largerEq,"${args[1]}\\right)")},smaller:{2:"\\left(${args[0]}".concat(wn.smaller,"${args[1]}\\right)")},smallerEq:{2:"\\left(${args[0]}".concat(wn.smallerEq,"${args[1]}\\right)")},unequal:{2:"\\left(${args[0]}".concat(wn.unequal,"${args[1]}\\right)")},erf:{1:"erf\\left(${args[0]}\\right)"},max:"\\max\\left(${args}\\right)",min:"\\min\\left(${args}\\right)",variance:"\\mathrm{Var}\\left(${args}\\right)",acos:{1:"\\cos^{-1}\\left(${args[0]}\\right)"},acosh:{1:"\\cosh^{-1}\\left(${args[0]}\\right)"},acot:{1:"\\cot^{-1}\\left(${args[0]}\\right)"},acoth:{1:"\\coth^{-1}\\left(${args[0]}\\right)"},acsc:{1:"\\csc^{-1}\\left(${args[0]}\\right)"},acsch:{1:"\\mathrm{csch}^{-1}\\left(${args[0]}\\right)"},asec:{1:"\\sec^{-1}\\left(${args[0]}\\right)"},asech:{1:"\\mathrm{sech}^{-1}\\left(${args[0]}\\right)"},asin:{1:"\\sin^{-1}\\left(${args[0]}\\right)"},asinh:{1:"\\sinh^{-1}\\left(${args[0]}\\right)"},atan:{1:"\\tan^{-1}\\left(${args[0]}\\right)"},atan2:{2:"\\mathrm{atan2}\\left(${args}\\right)"},atanh:{1:"\\tanh^{-1}\\left(${args[0]}\\right)"},cos:{1:"\\cos\\left(${args[0]}\\right)"},cosh:{1:"\\cosh\\left(${args[0]}\\right)"},cot:{1:"\\cot\\left(${args[0]}\\right)"},coth:{1:"\\coth\\left(${args[0]}\\right)"},csc:{1:"\\csc\\left(${args[0]}\\right)"},csch:{1:"\\mathrm{csch}\\left(${args[0]}\\right)"},sec:{1:"\\sec\\left(${args[0]}\\right)"},sech:{1:"\\mathrm{sech}\\left(${args[0]}\\right)"},sin:{1:"\\sin\\left(${args[0]}\\right)"},sinh:{1:"\\sinh\\left(${args[0]}\\right)"},tan:{1:"\\tan\\left(${args[0]}\\right)"},tanh:{1:"\\tanh\\left(${args[0]}\\right)"},to:{2:"\\left(${args[0]}".concat(wn.to,"${args[1]}\\right)")},numeric:function(e,t){return e.args[0].toTex()},number:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},string:{0:'\\mathtt{""}',1:"\\mathrm{string}\\left(${args[0]}\\right)"},bignumber:{0:"0",1:"\\left(${args[0]}\\right)"},bigint:{0:"0",1:"\\left(${args[0]}\\right)"},complex:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)+".concat(OO.i,"\\cdot\\left(${args[1]}\\right)\\right)")},matrix:{0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},sparse:{0:"\\begin{bsparse}\\end{bsparse}",1:"\\left(${args[0]}\\right)"},unit:{1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"}},lOe="\\mathrm{${name}}\\left(${args}\\right)",dG={deg:"^\\circ"};function kO(n){return oOe(n,{preserveFormatting:!0})}function Zne(n,e){return e=typeof e>"u"?!1:e,e?vt(dG,n)?dG[n]:"\\mathrm{"+kO(n)+"}":vt(OO,n)?OO[n]:kO(n)}var $T="ConstantNode",uOe=["Node","isBounded"],cOe=ie($T,uOe,n=>{var{Node:e,isBounded:t}=n;class r extends e{constructor(s){super(),this.value=s}get type(){return $T}get isConstantNode(){return!0}_compile(s,a){var o=this.value;return function(){return o}}forEach(s){}map(s){return this.clone()}clone(){return new r(this.value)}_toString(s){return nn(this.value,s)}_toHTML(s){var a=this._toString(s);switch(Kn(this.value)){case"number":case"bigint":case"BigNumber":case"Fraction":return'<span class="math-number">'+a+"</span>";case"string":return'<span class="math-string">'+a+"</span>";case"boolean":return'<span class="math-boolean">'+a+"</span>";case"null":return'<span class="math-null-symbol">'+a+"</span>";case"undefined":return'<span class="math-undefined">'+a+"</span>";default:return'<span class="math-symbol">'+a+"</span>"}}toJSON(){return{mathjs:$T,value:this.value}}static fromJSON(s){return new r(s.value)}_toTex(s){var a=this._toString(s),o=Kn(this.value);switch(o){case"string":return"\\mathtt{"+kO(a)+"}";case"number":case"BigNumber":{if(!t(this.value))return this.value.valueOf()<0?"-\\infty":"\\infty";var l=a.toLowerCase().indexOf("e");return l!==-1?a.substring(0,l)+"\\cdot10^{"+a.substring(l+1)+"}":a}case"bigint":return a.toString();case"Fraction":return this.value.toLatex();default:return a}}}return bi(r,"name",$T),r},{isClass:!0,isNode:!0}),HT="FunctionAssignmentNode",hOe=["typed","Node"],dOe=ie(HT,hOe,n=>{var{typed:e,Node:t}=n;function r(s,a,o){var l=Xn(s,a,o),u=Xn(s.expr,a,o);return a==="all"||u!==null&&u<=l}class i extends t{constructor(a,o,l){if(super(),typeof a!="string")throw new TypeError('String expected for parameter "name"');if(!Array.isArray(o))throw new TypeError('Array containing strings or objects expected for parameter "params"');if(!zn(l))throw new TypeError('Node expected for parameter "expr"');if(Yne.has(a))throw new Error('Illegal function name, "'+a+'" is a reserved keyword');var u=new Set;for(var c of o){var h=typeof c=="string"?c:c.name;if(u.has(h))throw new Error('Duplicate parameter name "'.concat(h,'"'));u.add(h)}this.name=a,this.params=o.map(function(d){return d&&d.name||d}),this.types=o.map(function(d){return d&&d.type||"any"}),this.expr=l}get type(){return HT}get isFunctionAssignmentNode(){return!0}_compile(a,o){var l=Object.create(o);Ite(this.params,function(m){l[m]=!0});var u=this.expr,c=u._compile(a,l),h=this.name,d=this.params,f=u$(this.types,","),p=h+"("+u$(this.params,", ")+")";return function(y,v,b){var x={};x[f]=function(){for(var _=Object.create(v),E=0;E<d.length;E++)_[d[E]]=arguments[E];return c(y,_,b)};var w=e(h,x);return w.syntax=p,w.expr=u.toString(),y.set(h,w),w}}forEach(a){a(this.expr,"expr",this)}map(a){var o=this._ifNode(a(this.expr,"expr",this));return new i(this.name,this.params.slice(0),o)}clone(){return new i(this.name,this.params.slice(0),this.expr)}_toString(a){var o=a&&a.parenthesis?a.parenthesis:"keep",l=this.expr.toString(a);return r(this,o,a&&a.implicit)&&(l="("+l+")"),this.name+"("+this.params.join(", ")+") = "+l}toJSON(){var a=this.types;return{mathjs:HT,name:this.name,params:this.params.map(function(o,l){return{name:o,type:a[l]}}),expr:this.expr}}static fromJSON(a){return new i(a.name,a.params,a.expr)}_toHTML(a){for(var o=a&&a.parenthesis?a.parenthesis:"keep",l=[],u=0;u<this.params.length;u++)l.push('<span class="math-symbol math-parameter">'+vl(this.params[u])+"</span>");var c=this.expr.toHTML(a);return r(this,o,a&&a.implicit)&&(c='<span class="math-parenthesis math-round-parenthesis">(</span>'+c+'<span class="math-parenthesis math-round-parenthesis">)</span>'),'<span class="math-function">'+vl(this.name)+'</span><span class="math-parenthesis math-round-parenthesis">(</span>'+l.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-round-parenthesis">)</span><span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+c}_toTex(a){var o=a&&a.parenthesis?a.parenthesis:"keep",l=this.expr.toTex(a);return r(this,o,a&&a.implicit)&&(l="\\left(".concat(l,"\\right)")),"\\mathrm{"+this.name+"}\\left("+this.params.map(Zne).join(",")+"\\right)="+l}}return bi(i,"name",HT),i},{isClass:!0,isNode:!0}),GT="IndexNode",fOe=["Node","size"],pOe=ie(GT,fOe,n=>{var{Node:e,size:t}=n;class r extends e{constructor(s,a){if(super(),this.dimensions=s,this.dotNotation=a||!1,!Array.isArray(s)||!s.every(zn))throw new TypeError('Array containing Nodes expected for parameter "dimensions"');if(this.dotNotation&&!this.isObjectProperty())throw new Error("dotNotation only applicable for object properties")}get type(){return GT}get isIndexNode(){return!0}_compile(s,a){var o=vp(this.dimensions,function(u,c){var h=u.filter(p=>p.isSymbolNode&&p.name==="end").length>0;if(h){var d=Object.create(a);d.end=!0;var f=u._compile(s,d);return function(m,y,v){if(!Dt(v)&&!Wn(v)&&!Qr(v))throw new TypeError('Cannot resolve "end": context must be a Matrix, Array, or string but is '+Kn(v));var b=t(v),x=Object.create(y);return x.end=b[c],f(m,x,v)}}else return u._compile(s,a)}),l=Ea(s,"index");return function(c,h,d){var f=vp(o,function(p){return p(c,h,d)});return l(...f)}}forEach(s){for(var a=0;a<this.dimensions.length;a++)s(this.dimensions[a],"dimensions["+a+"]",this)}map(s){for(var a=[],o=0;o<this.dimensions.length;o++)a[o]=this._ifNode(s(this.dimensions[o],"dimensions["+o+"]",this));return new r(a,this.dotNotation)}clone(){return new r(this.dimensions.slice(0),this.dotNotation)}isObjectProperty(){return this.dimensions.length===1&&pn(this.dimensions[0])&&typeof this.dimensions[0].value=="string"}getObjectProperty(){return this.isObjectProperty()?this.dimensions[0].value:null}_toString(s){return this.dotNotation?"."+this.getObjectProperty():"["+this.dimensions.join(", ")+"]"}toJSON(){return{mathjs:GT,dimensions:this.dimensions,dotNotation:this.dotNotation}}static fromJSON(s){return new r(s.dimensions,s.dotNotation)}_toHTML(s){for(var a=[],o=0;o<this.dimensions.length;o++)a[o]=this.dimensions[o].toHTML();return this.dotNotation?'<span class="math-operator math-accessor-operator">.</span><span class="math-symbol math-property">'+vl(this.getObjectProperty())+"</span>":'<span class="math-parenthesis math-square-parenthesis">[</span>'+a.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'}_toTex(s){var a=this.dimensions.map(function(o){return o.toTex(s)});return this.dotNotation?"."+this.getObjectProperty():"_{"+a.join(",")+"}"}}return bi(r,"name",GT),r},{isClass:!0,isNode:!0}),jT="ObjectNode",mOe=["Node"],gOe=ie(jT,mOe,n=>{var{Node:e}=n;class t extends e{constructor(i){if(super(),this.properties=i||{},i&&(typeof i!="object"||!Object.keys(i).every(function(s){return zn(i[s])})))throw new TypeError("Object containing Nodes expected")}get type(){return jT}get isObjectNode(){return!0}_compile(i,s){var a={};for(var o in this.properties)if(vt(this.properties,o)){var l=oy(o),u=JSON.parse(l),c=Ea(this.properties,o);a[u]=c._compile(i,s)}return function(d,f,p){var m={};for(var y in a)vt(a,y)&&(m[y]=a[y](d,f,p));return m}}forEach(i){for(var s in this.properties)vt(this.properties,s)&&i(this.properties[s],"properties["+oy(s)+"]",this)}map(i){var s={};for(var a in this.properties)vt(this.properties,a)&&(s[a]=this._ifNode(i(this.properties[a],"properties["+oy(a)+"]",this)));return new t(s)}clone(){var i={};for(var s in this.properties)vt(this.properties,s)&&(i[s]=this.properties[s]);return new t(i)}_toString(i){var s=[];for(var a in this.properties)vt(this.properties,a)&&s.push(oy(a)+": "+this.properties[a].toString(i));return"{"+s.join(", ")+"}"}toJSON(){return{mathjs:jT,properties:this.properties}}static fromJSON(i){return new t(i.properties)}_toHTML(i){var s=[];for(var a in this.properties)vt(this.properties,a)&&s.push('<span class="math-symbol math-property">'+vl(a)+'</span><span class="math-operator math-assignment-operator math-property-assignment-operator math-binary-operator">:</span>'+this.properties[a].toHTML(i));return'<span class="math-parenthesis math-curly-parenthesis">{</span>'+s.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-curly-parenthesis">}</span>'}_toTex(i){var s=[];for(var a in this.properties)vt(this.properties,a)&&s.push("\\mathbf{"+a+":} & "+this.properties[a].toTex(i)+"\\\\");var o="\\left\\{\\begin{array}{ll}"+s.join(`
`)+"\\end{array}\\right\\}";return o}}return bi(t,"name",jT),t},{isClass:!0,isNode:!0});function p1(n,e){return new rte(n,new MN(e),new Set(Object.keys(e)))}var qT="OperatorNode",vOe=["Node"],yOe=ie(qT,vOe,n=>{var{Node:e}=n;function t(s,a){var o=s;if(a==="auto")for(;vd(o);)o=o.content;return pn(o)?!0:ii(o)?t(o.args[0],a):!1}function r(s,a,o,l,u){var c=Xn(s,a,o),h=R_(s,a);if(a==="all"||l.length>2&&s.getIdentifier()!=="OperatorNode:add"&&s.getIdentifier()!=="OperatorNode:multiply")return l.map(function(M){switch(M.getContent().type){case"ArrayNode":case"ConstantNode":case"SymbolNode":case"ParenthesisNode":return!1;default:return!0}});var d;switch(l.length){case 0:d=[];break;case 1:{var f=Xn(l[0],a,o,s);if(u&&f!==null){var p,m;if(a==="keep"?(p=l[0].getIdentifier(),m=s.getIdentifier()):(p=l[0].getContent().getIdentifier(),m=s.getContent().getIdentifier()),iu[c][m].latexLeftParens===!1){d=[!1];break}if(iu[f][p].latexParens===!1){d=[!1];break}}if(f===null){d=[!1];break}if(f<=c){d=[!0];break}d=[!1]}break;case 2:{var y,v=Xn(l[0],a,o,s),b=JI(s,l[0],a);v===null?y=!1:v===c&&h==="right"&&!b||v<c?y=!0:y=!1;var x,w=Xn(l[1],a,o,s),_=JI(s,l[1],a);if(w===null?x=!1:w===c&&h==="left"&&!_||w<c?x=!0:x=!1,u){var E,A,T;a==="keep"?(E=s.getIdentifier(),A=s.args[0].getIdentifier(),T=s.args[1].getIdentifier()):(E=s.getContent().getIdentifier(),A=s.args[0].getContent().getIdentifier(),T=s.args[1].getContent().getIdentifier()),v!==null&&(iu[c][E].latexLeftParens===!1&&(y=!1),iu[v][A].latexParens===!1&&(y=!1)),w!==null&&(iu[c][E].latexRightParens===!1&&(x=!1),iu[w][T].latexParens===!1&&(x=!1))}d=[y,x]}break;default:(s.getIdentifier()==="OperatorNode:add"||s.getIdentifier()==="OperatorNode:multiply")&&(d=l.map(function(M){var D=Xn(M,a,o,s),N=JI(s,M,a),R=R_(M,a);return D===null?!1:c===D&&h===R&&!N?!0:D<c}));break}if(l.length>=2&&s.getIdentifier()==="OperatorNode:multiply"&&s.implicit&&a!=="all"&&o==="hide")for(var S=1;S<d.length;++S)t(l[S],a)&&!d[S-1]&&(a!=="keep"||!vd(l[S-1]))&&(d[S]=!0);return d}class i extends e{constructor(a,o,l,u,c){if(super(),typeof a!="string")throw new TypeError('string expected for parameter "op"');if(typeof o!="string")throw new TypeError('string expected for parameter "fn"');if(!Array.isArray(l)||!l.every(zn))throw new TypeError('Array containing Nodes expected for parameter "args"');this.implicit=u===!0,this.isPercentage=c===!0,this.op=a,this.fn=o,this.args=l||[]}get type(){return qT}get isOperatorNode(){return!0}_compile(a,o){if(typeof this.fn!="string"||!j4(a,this.fn))throw a[this.fn]?new Error('No access to function "'+this.fn+'"'):new Error("Function "+this.fn+' missing in provided namespace "math"');var l=Ea(a,this.fn),u=vp(this.args,function(p){return p._compile(a,o)});if(typeof l=="function"&&l.rawArgs===!0){var c=this.args;return function(m,y,v){return l(c,a,p1(m,y))}}else if(u.length===1){var h=u[0];return function(m,y,v){return l(h(m,y,v))}}else if(u.length===2){var d=u[0],f=u[1];return function(m,y,v){return l(d(m,y,v),f(m,y,v))}}else return function(m,y,v){return l.apply(null,vp(u,function(b){return b(m,y,v)}))}}forEach(a){for(var o=0;o<this.args.length;o++)a(this.args[o],"args["+o+"]",this)}map(a){for(var o=[],l=0;l<this.args.length;l++)o[l]=this._ifNode(a(this.args[l],"args["+l+"]",this));return new i(this.op,this.fn,o,this.implicit,this.isPercentage)}clone(){return new i(this.op,this.fn,this.args.slice(0),this.implicit,this.isPercentage)}isUnary(){return this.args.length===1}isBinary(){return this.args.length===2}_toString(a){var o=a&&a.parenthesis?a.parenthesis:"keep",l=a&&a.implicit?a.implicit:"hide",u=this.args,c=r(this,o,l,u,!1);if(u.length===1){var h=R_(this,o),d=u[0].toString(a);c[0]&&(d="("+d+")");var f=/[a-zA-Z]+/.test(this.op);return h==="right"?this.op+(f?" ":"")+d:h==="left"?d+(f?" ":"")+this.op:d+this.op}else if(u.length===2){var p=u[0].toString(a),m=u[1].toString(a);return c[0]&&(p="("+p+")"),c[1]&&(m="("+m+")"),this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&l==="hide"?p+" "+m:p+" "+this.op+" "+m}else if(u.length>2&&(this.getIdentifier()==="OperatorNode:add"||this.getIdentifier()==="OperatorNode:multiply")){var y=u.map(function(v,b){return v=v.toString(a),c[b]&&(v="("+v+")"),v});return this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&l==="hide"?y.join(" "):y.join(" "+this.op+" ")}else return this.fn+"("+this.args.join(", ")+")"}toJSON(){return{mathjs:qT,op:this.op,fn:this.fn,args:this.args,implicit:this.implicit,isPercentage:this.isPercentage}}static fromJSON(a){return new i(a.op,a.fn,a.args,a.implicit,a.isPercentage)}_toHTML(a){var o=a&&a.parenthesis?a.parenthesis:"keep",l=a&&a.implicit?a.implicit:"hide",u=this.args,c=r(this,o,l,u,!1);if(u.length===1){var h=R_(this,o),d=u[0].toHTML(a);return c[0]&&(d='<span class="math-parenthesis math-round-parenthesis">(</span>'+d+'<span class="math-parenthesis math-round-parenthesis">)</span>'),h==="right"?'<span class="math-operator math-unary-operator math-lefthand-unary-operator">'+vl(this.op)+"</span>"+d:d+'<span class="math-operator math-unary-operator math-righthand-unary-operator">'+vl(this.op)+"</span>"}else if(u.length===2){var f=u[0].toHTML(a),p=u[1].toHTML(a);return c[0]&&(f='<span class="math-parenthesis math-round-parenthesis">(</span>'+f+'<span class="math-parenthesis math-round-parenthesis">)</span>'),c[1]&&(p='<span class="math-parenthesis math-round-parenthesis">(</span>'+p+'<span class="math-parenthesis math-round-parenthesis">)</span>'),this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&l==="hide"?f+'<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'+p:f+'<span class="math-operator math-binary-operator math-explicit-binary-operator">'+vl(this.op)+"</span>"+p}else{var m=u.map(function(y,v){return y=y.toHTML(a),c[v]&&(y='<span class="math-parenthesis math-round-parenthesis">(</span>'+y+'<span class="math-parenthesis math-round-parenthesis">)</span>'),y});return u.length>2&&(this.getIdentifier()==="OperatorNode:add"||this.getIdentifier()==="OperatorNode:multiply")?this.implicit&&this.getIdentifier()==="OperatorNode:multiply"&&l==="hide"?m.join('<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'):m.join('<span class="math-operator math-binary-operator math-explicit-binary-operator">'+vl(this.op)+"</span>"):'<span class="math-function">'+vl(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+m.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}}_toTex(a){var o=a&&a.parenthesis?a.parenthesis:"keep",l=a&&a.implicit?a.implicit:"hide",u=this.args,c=r(this,o,l,u,!0),h=wn[this.fn];if(h=typeof h>"u"?this.op:h,u.length===1){var d=R_(this,o),f=u[0].toTex(a);return c[0]&&(f="\\left(".concat(f,"\\right)")),d==="right"?h+f:f+h}else if(u.length===2){var p=u[0],m=p.toTex(a);c[0]&&(m="\\left(".concat(m,"\\right)"));var y=u[1],v=y.toTex(a);c[1]&&(v="\\left(".concat(v,"\\right)"));var b;switch(o==="keep"?b=p.getIdentifier():b=p.getContent().getIdentifier(),this.getIdentifier()){case"OperatorNode:divide":return h+"{"+m+"}{"+v+"}";case"OperatorNode:pow":switch(m="{"+m+"}",v="{"+v+"}",b){case"ConditionalNode":case"OperatorNode:divide":m="\\left(".concat(m,"\\right)")}break;case"OperatorNode:multiply":if(this.implicit&&l==="hide")return m+"~"+v}return m+h+v}else if(u.length>2&&(this.getIdentifier()==="OperatorNode:add"||this.getIdentifier()==="OperatorNode:multiply")){var x=u.map(function(w,_){return w=w.toTex(a),c[_]&&(w="\\left(".concat(w,"\\right)")),w});return this.getIdentifier()==="OperatorNode:multiply"&&this.implicit&&l==="hide"?x.join("~"):x.join(h)}else return"\\mathrm{"+this.fn+"}\\left("+u.map(function(w){return w.toTex(a)}).join(",")+"\\right)"}getIdentifier(){return this.type+":"+this.fn}}return bi(i,"name",qT),i},{isClass:!0,isNode:!0}),WT="ParenthesisNode",xOe=["Node"],bOe=ie(WT,xOe,n=>{var{Node:e}=n;class t extends e{constructor(i){if(super(),!zn(i))throw new TypeError('Node expected for parameter "content"');this.content=i}get type(){return WT}get isParenthesisNode(){return!0}_compile(i,s){return this.content._compile(i,s)}getContent(){return this.content.getContent()}forEach(i){i(this.content,"content",this)}map(i){var s=i(this.content,"content",this);return new t(s)}clone(){return new t(this.content)}_toString(i){return!i||i&&!i.parenthesis||i&&i.parenthesis==="keep"?"("+this.content.toString(i)+")":this.content.toString(i)}toJSON(){return{mathjs:WT,content:this.content}}static fromJSON(i){return new t(i.content)}_toHTML(i){return!i||i&&!i.parenthesis||i&&i.parenthesis==="keep"?'<span class="math-parenthesis math-round-parenthesis">(</span>'+this.content.toHTML(i)+'<span class="math-parenthesis math-round-parenthesis">)</span>':this.content.toHTML(i)}_toTex(i){return!i||i&&!i.parenthesis||i&&i.parenthesis==="keep"?"\\left(".concat(this.content.toTex(i),"\\right)"):this.content.toTex(i)}}return bi(t,"name",WT),t},{isClass:!0,isNode:!0}),XT="RangeNode",_Oe=["Node"],wOe=ie(XT,_Oe,n=>{var{Node:e}=n;function t(i,s,a){var o=Xn(i,s,a),l={},u=Xn(i.start,s,a);if(l.start=u!==null&&u<=o||s==="all",i.step){var c=Xn(i.step,s,a);l.step=c!==null&&c<=o||s==="all"}var h=Xn(i.end,s,a);return l.end=h!==null&&h<=o||s==="all",l}class r extends e{constructor(s,a,o){if(super(),!zn(s))throw new TypeError("Node expected");if(!zn(a))throw new TypeError("Node expected");if(o&&!zn(o))throw new TypeError("Node expected");if(arguments.length>3)throw new Error("Too many arguments");this.start=s,this.end=a,this.step=o||null}get type(){return XT}get isRangeNode(){return!0}needsEnd(){var s=this.filter(function(a){return is(a)&&a.name==="end"});return s.length>0}_compile(s,a){var o=s.range,l=this.start._compile(s,a),u=this.end._compile(s,a);if(this.step){var c=this.step._compile(s,a);return function(d,f,p){return o(l(d,f,p),u(d,f,p),c(d,f,p))}}else return function(d,f,p){return o(l(d,f,p),u(d,f,p))}}forEach(s){s(this.start,"start",this),s(this.end,"end",this),this.step&&s(this.step,"step",this)}map(s){return new r(this._ifNode(s(this.start,"start",this)),this._ifNode(s(this.end,"end",this)),this.step&&this._ifNode(s(this.step,"step",this)))}clone(){return new r(this.start,this.end,this.step&&this.step)}_toString(s){var a=s&&s.parenthesis?s.parenthesis:"keep",o=t(this,a,s&&s.implicit),l,u=this.start.toString(s);if(o.start&&(u="("+u+")"),l=u,this.step){var c=this.step.toString(s);o.step&&(c="("+c+")"),l+=":"+c}var h=this.end.toString(s);return o.end&&(h="("+h+")"),l+=":"+h,l}toJSON(){return{mathjs:XT,start:this.start,end:this.end,step:this.step}}static fromJSON(s){return new r(s.start,s.end,s.step)}_toHTML(s){var a=s&&s.parenthesis?s.parenthesis:"keep",o=t(this,a,s&&s.implicit),l,u=this.start.toHTML(s);if(o.start&&(u='<span class="math-parenthesis math-round-parenthesis">(</span>'+u+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l=u,this.step){var c=this.step.toHTML(s);o.step&&(c='<span class="math-parenthesis math-round-parenthesis">(</span>'+c+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l+='<span class="math-operator math-range-operator">:</span>'+c}var h=this.end.toHTML(s);return o.end&&(h='<span class="math-parenthesis math-round-parenthesis">(</span>'+h+'<span class="math-parenthesis math-round-parenthesis">)</span>'),l+='<span class="math-operator math-range-operator">:</span>'+h,l}_toTex(s){var a=s&&s.parenthesis?s.parenthesis:"keep",o=t(this,a,s&&s.implicit),l=this.start.toTex(s);if(o.start&&(l="\\left(".concat(l,"\\right)")),this.step){var u=this.step.toTex(s);o.step&&(u="\\left(".concat(u,"\\right)")),l+=":"+u}var c=this.end.toTex(s);return o.end&&(c="\\left(".concat(c,"\\right)")),l+=":"+c,l}}return bi(r,"name",XT),r},{isClass:!0,isNode:!0}),KT="RelationalNode",EOe=["Node"],SOe=ie(KT,EOe,n=>{var{Node:e}=n,t={equal:"==",unequal:"!=",smaller:"<",larger:">",smallerEq:"<=",largerEq:">="};class r extends e{constructor(s,a){if(super(),!Array.isArray(s))throw new TypeError("Parameter conditionals must be an array");if(!Array.isArray(a))throw new TypeError("Parameter params must be an array");if(s.length!==a.length-1)throw new TypeError("Parameter params must contain exactly one more element than parameter conditionals");this.conditionals=s,this.params=a}get type(){return KT}get isRelationalNode(){return!0}_compile(s,a){var o=this,l=this.params.map(u=>u._compile(s,a));return function(c,h,d){for(var f,p=l[0](c,h,d),m=0;m<o.conditionals.length;m++){f=p,p=l[m+1](c,h,d);var y=Ea(s,o.conditionals[m]);if(!y(f,p))return!1}return!0}}forEach(s){this.params.forEach((a,o)=>s(a,"params["+o+"]",this),this)}map(s){return new r(this.conditionals.slice(),this.params.map((a,o)=>this._ifNode(s(a,"params["+o+"]",this)),this))}clone(){return new r(this.conditionals,this.params)}_toString(s){for(var a=s&&s.parenthesis?s.parenthesis:"keep",o=Xn(this,a,s&&s.implicit),l=this.params.map(function(h,d){var f=Xn(h,a,s&&s.implicit);return a==="all"||f!==null&&f<=o?"("+h.toString(s)+")":h.toString(s)}),u=l[0],c=0;c<this.conditionals.length;c++)u+=" "+t[this.conditionals[c]],u+=" "+l[c+1];return u}toJSON(){return{mathjs:KT,conditionals:this.conditionals,params:this.params}}static fromJSON(s){return new r(s.conditionals,s.params)}_toHTML(s){for(var a=s&&s.parenthesis?s.parenthesis:"keep",o=Xn(this,a,s&&s.implicit),l=this.params.map(function(h,d){var f=Xn(h,a,s&&s.implicit);return a==="all"||f!==null&&f<=o?'<span class="math-parenthesis math-round-parenthesis">(</span>'+h.toHTML(s)+'<span class="math-parenthesis math-round-parenthesis">)</span>':h.toHTML(s)}),u=l[0],c=0;c<this.conditionals.length;c++)u+='<span class="math-operator math-binary-operator math-explicit-binary-operator">'+vl(t[this.conditionals[c]])+"</span>"+l[c+1];return u}_toTex(s){for(var a=s&&s.parenthesis?s.parenthesis:"keep",o=Xn(this,a,s&&s.implicit),l=this.params.map(function(h,d){var f=Xn(h,a,s&&s.implicit);return a==="all"||f!==null&&f<=o?"\\left("+h.toTex(s)+"\right)":h.toTex(s)}),u=l[0],c=0;c<this.conditionals.length;c++)u+=wn[this.conditionals[c]]+l[c+1];return u}}return bi(r,"name",KT),r},{isClass:!0,isNode:!0}),AOe="SymbolNode",TOe=["math","?Unit","Node"],MOe=ie(AOe,TOe,n=>{var{math:e,Unit:t,Node:r}=n;function i(a){return t?t.isValuelessUnit(a):!1}class s extends r{constructor(o){if(super(),typeof o!="string")throw new TypeError('String expected for parameter "name"');this.name=o}get type(){return"SymbolNode"}get isSymbolNode(){return!0}_compile(o,l){var u=this.name;if(l[u]===!0)return function(h,d,f){return Ea(d,u)};if(u in o)return function(h,d,f){return h.has(u)?h.get(u):Ea(o,u)};var c=i(u);return function(h,d,f){return h.has(u)?h.get(u):c?new t(null,u):s.onUndefinedSymbol(u)}}forEach(o){}map(o){return this.clone()}static onUndefinedSymbol(o){throw new Error("Undefined symbol "+o)}clone(){return new s(this.name)}_toString(o){return this.name}_toHTML(o){var l=vl(this.name);return l==="true"||l==="false"?'<span class="math-symbol math-boolean">'+l+"</span>":l==="i"?'<span class="math-symbol math-imaginary-symbol">'+l+"</span>":l==="Infinity"?'<span class="math-symbol math-infinity-symbol">'+l+"</span>":l==="NaN"?'<span class="math-symbol math-nan-symbol">'+l+"</span>":l==="null"?'<span class="math-symbol math-null-symbol">'+l+"</span>":l==="undefined"?'<span class="math-symbol math-undefined-symbol">'+l+"</span>":'<span class="math-symbol">'+l+"</span>"}toJSON(){return{mathjs:"SymbolNode",name:this.name}}static fromJSON(o){return new s(o.name)}_toTex(o){var l=!1;typeof e[this.name]>"u"&&i(this.name)&&(l=!0);var u=Zne(this.name,l);return u[0]==="\\"?u:" "+u}}return s},{isClass:!0,isNode:!0}),YT="FunctionNode",COe=["math","Node","SymbolNode"],DOe=ie(YT,COe,n=>{var e,{math:t,Node:r,SymbolNode:i}=n,s=l=>nn(l,{truncate:78});function a(l,u,c){for(var h="",d=/\$(?:\{([a-z_][a-z_0-9]*)(?:\[([0-9]+)\])?\}|\$)/gi,f=0,p;(p=d.exec(l))!==null;)if(h+=l.substring(f,p.index),f=p.index,p[0]==="$$")h+="$",f++;else{f+=p[0].length;var m=u[p[1]];if(!m)throw new ReferenceError("Template: Property "+p[1]+" does not exist.");if(p[2]===void 0)switch(typeof m){case"string":h+=m;break;case"object":if(zn(m))h+=m.toTex(c);else if(Array.isArray(m))h+=m.map(function(y,v){if(zn(y))return y.toTex(c);throw new TypeError("Template: "+p[1]+"["+v+"] is not a Node.")}).join(",");else throw new TypeError("Template: "+p[1]+" has to be a Node, String or array of Nodes");break;default:throw new TypeError("Template: "+p[1]+" has to be a Node, String or array of Nodes")}else if(zn(m[p[2]]&&m[p[2]]))h+=m[p[2]].toTex(c);else throw new TypeError("Template: "+p[1]+"["+p[2]+"] is not a Node.")}return h+=l.slice(f),h}class o extends r{constructor(u,c,h){if(super(),typeof u=="string"&&(u=new i(u)),!zn(u))throw new TypeError('Node expected as parameter "fn"');if(!Array.isArray(c)||!c.every(zn))throw new TypeError('Array containing Nodes expected for parameter "args"');var d=typeof h;if(!(d==="undefined"||d==="boolean"))throw new TypeError("optional flag, if specified, must be boolean");this.fn=u,this.args=c||[],this.optional=!!h}get name(){return this.fn.name||""}get type(){return YT}get isFunctionNode(){return!0}_compile(u,c){var h=this.args.map(S=>S._compile(u,c)),d=this.optional||gd(this.fn)&&this.fn.optionalChaining;if(is(this.fn)){var f=this.fn.name;if(c[f]){var b=this.args;return function(M,D,N){var R=Ea(D,f);if(!(d&&R===void 0)){if(typeof R!="function")throw new TypeError("Argument '".concat(f,"' was not a function; received: ").concat(s(R)));if(R.rawArgs)return R(b,u,p1(M,D));var z=h.map(j=>j(M,D,N));return R.apply(R,z)}}}else{var p=f in u?Ea(u,f):void 0,m=typeof p=="function"&&p.rawArgs===!0,y=S=>{var M;if(S.has(f))M=S.get(f);else if(f in u)M=Ea(u,f);else if(d)M=void 0;else return o.onUndefinedFunction(f);if(typeof M=="function"||d&&M===void 0)return M;throw new TypeError("'".concat(f,`' is not a function; its value is:
  `).concat(s(M)))};if(m){var v=this.args;return function(M,D,N){var R=y(M);if(R.rawArgs===!0)return R(v,u,p1(M,D));var z=h.map(j=>j(M,D,N));return R(...z)}}else switch(h.length){case 0:return function(M,D,N){var R=y(M);if(!(d&&R===void 0))return R()};case 1:return function(M,D,N){var R=y(M);if(!(d&&R===void 0)){var z=h[0];return R(z(M,D,N))}};case 2:return function(M,D,N){var R=y(M);if(!(d&&R===void 0)){var z=h[0],j=h[1];return R(z(M,D,N),j(M,D,N))}};default:return function(M,D,N){var R=y(M);if(!(d&&R===void 0)){var z=h.map(j=>j(M,D,N));return R(...z)}}}}}else if(gd(this.fn)&&qb(this.fn.index)&&this.fn.index.isObjectProperty()){var x=this.fn.object._compile(u,c),w=this.fn.index.getObjectProperty(),_=this.args;return function(M,D,N){var R=x(M,D,N);if(!(d&&(R==null||R[w]===void 0))){var z=KTe(R,w);if(z!=null&&z.rawArgs)return z(_,u,p1(M,D));var j=h.map(I=>I(M,D,N));return z.apply(R,j)}}}else{var E=this.fn.toString(),A=this.fn._compile(u,c),T=this.args;return function(M,D,N){var R=A(M,D,N);if(!(d&&R===void 0)){if(typeof R!="function")throw new TypeError("Expression '".concat(E,"' did not evaluate to a function; value is:")+`
  `.concat(s(R)));if(R.rawArgs)return R(T,u,p1(M,D));var z=h.map(j=>j(M,D,N));return R.apply(R,z)}}}}forEach(u){u(this.fn,"fn",this);for(var c=0;c<this.args.length;c++)u(this.args[c],"args["+c+"]",this)}map(u){for(var c=this._ifNode(u(this.fn,"fn",this)),h=[],d=0;d<this.args.length;d++)h[d]=this._ifNode(u(this.args[d],"args["+d+"]",this));return new o(c,h)}clone(){return new o(this.fn,this.args.slice(0))}toString(u){var c,h=this.fn.toString(u);return u&&typeof u.handler=="object"&&vt(u.handler,h)&&(c=u.handler[h](this,u)),typeof c<"u"?c:super.toString(u)}_toString(u){var c=this.args.map(function(d){return d.toString(u)}),h=sA(this.fn)?"("+this.fn.toString(u)+")":this.fn.toString(u);return h+"("+c.join(", ")+")"}toJSON(){return{mathjs:YT,fn:this.fn,args:this.args}}_toHTML(u){var c=this.args.map(function(h){return h.toHTML(u)});return'<span class="math-function">'+vl(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+c.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}toTex(u){var c;return u&&typeof u.handler=="object"&&vt(u.handler,this.name)&&(c=u.handler[this.name](this,u)),typeof c<"u"?c:super.toTex(u)}_toTex(u){var c=this.args.map(function(f){return f.toTex(u)}),h;hG[this.name]&&(h=hG[this.name]),t[this.name]&&(typeof t[this.name].toTex=="function"||typeof t[this.name].toTex=="object"||typeof t[this.name].toTex=="string")&&(h=t[this.name].toTex);var d;switch(typeof h){case"function":d=h(this,u);break;case"string":d=a(h,this,u);break;case"object":switch(typeof h[c.length]){case"function":d=h[c.length](this,u);break;case"string":d=a(h[c.length],this,u);break}}return typeof d<"u"?d:a(lOe,this,u)}getIdentifier(){return this.type+":"+this.name}}return e=o,bi(o,"name",YT),bi(o,"onUndefinedFunction",function(l){throw new Error("Undefined function "+l)}),bi(o,"fromJSON",function(l){return new e(l.fn,l.args)}),o},{isClass:!0,isNode:!0}),fG="parse",NOe=["typed","numeric","config","AccessorNode","ArrayNode","AssignmentNode","BlockNode","ConditionalNode","ConstantNode","FunctionAssignmentNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","RangeNode","RelationalNode","SymbolNode"],ROe=ie(fG,NOe,n=>{var{typed:e,numeric:t,config:r,AccessorNode:i,ArrayNode:s,AssignmentNode:a,BlockNode:o,ConditionalNode:l,ConstantNode:u,FunctionAssignmentNode:c,FunctionNode:h,IndexNode:d,ObjectNode:f,OperatorNode:p,ParenthesisNode:m,RangeNode:y,RelationalNode:v,SymbolNode:b}=n,x=e(fG,{string:function(W){return J(W,{})},"Array | Matrix":function(W){return w(W,{})},"string, Object":function(W,ye){var Ee=ye.nodes!==void 0?ye.nodes:{};return J(W,Ee)},"Array | Matrix, Object":w});function w(V){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ye=W.nodes!==void 0?W.nodes:{};return qt(V,function(Ee){if(typeof Ee!="string")throw new TypeError("String expected");return J(Ee,ye)})}var _={NULL:0,DELIMITER:1,NUMBER:2,SYMBOL:3,UNKNOWN:4},E={",":!0,"(":!0,")":!0,"[":!0,"]":!0,"{":!0,"}":!0,'"':!0,"'":!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"~":!0,"!":!0,"&":!0,"|":!0,"^|":!0,"=":!0,":":!0,"?":!0,"?.":!0,"??":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0,"<<":!0,">>":!0,">>>":!0},A={mod:!0,to:!0,in:!0,and:!0,xor:!0,or:!0,not:!0},T={true:!0,false:!1,null:null,undefined:void 0},S=["NaN","Infinity"],M={'"':'"',"'":"'","\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function D(){return{extraNodes:{},expression:"",comment:"",index:0,token:"",tokenType:_.NULL,nestingLevel:0,conditionalLevel:null}}function N(V,W){return V.expression.substr(V.index,W)}function R(V){return N(V,1)}function z(V){V.index++}function j(V){return V.expression.charAt(V.index-1)}function I(V){return V.expression.charAt(V.index+1)}function F(V){for(V.tokenType=_.NULL,V.token="",V.comment="";;){if(R(V)==="#")for(;R(V)!==`
`&&R(V)!=="";)V.comment+=R(V),z(V);if(x.isWhitespace(R(V),V.nestingLevel))z(V);else break}if(R(V)===""){V.tokenType=_.DELIMITER;return}if(R(V)===`
`&&!V.nestingLevel){V.tokenType=_.DELIMITER,V.token=R(V),z(V);return}var W=R(V),ye=N(V,2),Ee=N(V,3);if(Ee.length===3&&E[Ee]){V.tokenType=_.DELIMITER,V.token=Ee,z(V),z(V),z(V);return}if(ye.length===2&&E[ye]&&(ye!=="?."||!x.isDigit(V.expression.charAt(V.index+2)))){V.tokenType=_.DELIMITER,V.token=ye,z(V),z(V);return}if(E[W]){V.tokenType=_.DELIMITER,V.token=W,z(V);return}if(x.isDigitDot(W)){V.tokenType=_.NUMBER;var Fe=N(V,2);if(Fe==="0b"||Fe==="0o"||Fe==="0x"){for(V.token+=R(V),z(V),V.token+=R(V),z(V);x.isAlpha(R(V),j(V),I(V))||x.isDigit(R(V));)V.token+=R(V),z(V);if(R(V)===".")for(V.token+=".",z(V);x.isAlpha(R(V),j(V),I(V))||x.isDigit(R(V));)V.token+=R(V),z(V);else if(R(V)==="i")for(V.token+="i",z(V);x.isDigit(R(V));)V.token+=R(V),z(V);return}if(R(V)==="."){if(V.token+=R(V),z(V),!x.isDigit(R(V))){V.tokenType=_.DELIMITER;return}}else{for(;x.isDigit(R(V));)V.token+=R(V),z(V);x.isDecimalMark(R(V),I(V))&&(V.token+=R(V),z(V))}for(;x.isDigit(R(V));)V.token+=R(V),z(V);if(R(V)==="E"||R(V)==="e"){if(x.isDigit(I(V))||I(V)==="-"||I(V)==="+"){if(V.token+=R(V),z(V),(R(V)==="+"||R(V)==="-")&&(V.token+=R(V),z(V)),!x.isDigit(R(V)))throw Ge(V,'Digit expected, got "'+R(V)+'"');for(;x.isDigit(R(V));)V.token+=R(V),z(V);if(x.isDecimalMark(R(V),I(V)))throw Ge(V,'Digit expected, got "'+R(V)+'"')}else if(x.isDecimalMark(I(V),V.expression.charAt(V.index+2)))throw z(V),Ge(V,'Digit expected, got "'+R(V)+'"')}return}if(x.isAlpha(R(V),j(V),I(V))){for(;x.isAlpha(R(V),j(V),I(V))||x.isDigit(R(V));)V.token+=R(V),z(V);vt(A,V.token)?V.tokenType=_.DELIMITER:V.tokenType=_.SYMBOL;return}for(V.tokenType=_.UNKNOWN;R(V)!=="";)V.token+=R(V),z(V);throw Ge(V,'Syntax error in part "'+V.token+'"')}function $(V){do F(V);while(V.token===`
`)}function H(V){V.nestingLevel++}function Z(V){V.nestingLevel--}x.isAlpha=function(W,ye,Ee){return x.isValidLatinOrGreek(W)||x.isValidMathSymbol(W,Ee)||x.isValidMathSymbol(ye,W)},x.isValidLatinOrGreek=function(W){return/^[a-zA-Z_$\u00C0-\u02AF\u0370-\u03FF\u2100-\u214F]$/.test(W)},x.isValidMathSymbol=function(W,ye){return/^[\uD835]$/.test(W)&&/^[\uDC00-\uDFFF]$/.test(ye)&&/^[^\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]$/.test(ye)},x.isWhitespace=function(W,ye){return W===" "||W==="	"||W===""||W===`
`&&ye>0},x.isDecimalMark=function(W,ye){return W==="."&&ye!=="/"&&ye!=="*"&&ye!=="^"},x.isDigitDot=function(W){return W>="0"&&W<="9"||W==="."},x.isDigit=function(W){return W>="0"&&W<="9"};function J(V,W){var ye=D();ai(ye,{expression:V,extraNodes:W}),F(ye);var Ee=ee(ye);if(ye.token!=="")throw ye.tokenType===_.DELIMITER?qe(ye,"Unexpected operator "+ye.token):Ge(ye,'Unexpected part "'+ye.token+'"');return Ee}function ee(V){var W,ye=[],Ee;for(V.token!==""&&V.token!==`
`&&V.token!==";"&&(W=O(V),V.comment&&(W.comment=V.comment));V.token===`
`||V.token===";";)ye.length===0&&W&&(Ee=V.token!==";",ye.push({node:W,visible:Ee})),F(V),V.token!==`
`&&V.token!==";"&&V.token!==""&&(W=O(V),V.comment&&(W.comment=V.comment),Ee=V.token!==";",ye.push({node:W,visible:Ee}));return ye.length>0?new o(ye):(W||(W=new u(void 0),V.comment&&(W.comment=V.comment)),W)}function O(V){var W,ye,Ee,Fe,Le=ue(V);if(V.token==="="){if(is(Le))return W=Le.name,$(V),Ee=O(V),new a(new b(W),Ee);if(gd(Le)){if(Le.optionalChaining)throw Ge(V,"Cannot assign to optional chain");return $(V),Ee=O(V),new a(Le.object,Le.index,Ee)}else if(Fp(Le)&&is(Le.fn)&&(Fe=!0,ye=[],W=Le.name,Le.args.forEach(function(Ue,nt){is(Ue)?ye[nt]=Ue.name:Fe=!1}),Fe))return $(V),Ee=O(V),new c(W,ye,Ee);throw Ge(V,"Invalid left hand side of assignment operator =")}return Le}function ue(V){for(var W=Q(V);V.token==="?";){var ye=V.conditionalLevel;V.conditionalLevel=V.nestingLevel,$(V);var Ee=W,Fe=O(V);if(V.token!==":")throw Ge(V,"False part of conditional expression expected");V.conditionalLevel=null,$(V);var Le=O(V);W=new l(Ee,Fe,Le),V.conditionalLevel=ye}return W}function Q(V){for(var W=re(V);V.token==="or";)$(V),W=new p("or","or",[W,re(V)]);return W}function re(V){for(var W=le(V);V.token==="xor";)$(V),W=new p("xor","xor",[W,le(V)]);return W}function le(V){for(var W=te(V);V.token==="and";)$(V),W=new p("and","and",[W,te(V)]);return W}function te(V){for(var W=Y(V);V.token==="|";)$(V),W=new p("|","bitOr",[W,Y(V)]);return W}function Y(V){for(var W=oe(V);V.token==="^|";)$(V),W=new p("^|","bitXor",[W,oe(V)]);return W}function oe(V){for(var W=ve(V);V.token==="&";)$(V),W=new p("&","bitAnd",[W,ve(V)]);return W}function ve(V){for(var W=[me(V)],ye=[],Ee={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};vt(Ee,V.token);){var Fe={name:V.token,fn:Ee[V.token]};ye.push(Fe),$(V),W.push(me(V))}return W.length===1?W[0]:W.length===2?new p(ye[0].name,ye[0].fn,W):new v(ye.map(Le=>Le.fn),W)}function me(V){var W,ye,Ee,Fe;W=be(V);for(var Le={"<<":"leftShift",">>":"rightArithShift",">>>":"rightLogShift"};vt(Le,V.token);)ye=V.token,Ee=Le[ye],$(V),Fe=[W,be(V)],W=new p(ye,Ee,Fe);return W}function be(V){var W,ye,Ee,Fe;W=_e(V);for(var Le={to:"to",in:"to"};vt(Le,V.token);)ye=V.token,Ee=Le[ye],$(V),ye==="in"&&"])},;".includes(V.token)?W=new p("*","multiply",[W,new b("in")],!0):(Fe=[W,_e(V)],W=new p(ye,Ee,Fe));return W}function _e(V){var W,ye=[];if(V.token===":"?W=new u(1):W=Be(V),V.token===":"&&V.conditionalLevel!==V.nestingLevel){for(ye.push(W);V.token===":"&&ye.length<3;)$(V),V.token===")"||V.token==="]"||V.token===","||V.token===""?ye.push(new b("end")):ye.push(Be(V));ye.length===3?W=new y(ye[0],ye[2],ye[1]):W=new y(ye[0],ye[1])}return W}function Be(V){var W,ye,Ee,Fe;W=ze(V);for(var Le={"+":"add","-":"subtract"};vt(Le,V.token);){ye=V.token,Ee=Le[ye],$(V);var Ue=ze(V);Ue.isPercentage?Fe=[W,new p("*","multiply",[W,Ue])]:Fe=[W,Ue],W=new p(ye,Ee,Fe)}return W}function ze(V){var W,ye,Ee,Fe;W=tt(V),ye=W;for(var Le={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide","%":"mod",mod:"mod"};vt(Le,V.token);)Ee=V.token,Fe=Le[Ee],$(V),ye=tt(V),W=new p(Ee,Fe,[W,ye]);return W}function tt(V){var W,ye;for(W=de(V),ye=W;V.tokenType===_.SYMBOL||V.token==="in"&&pn(W)||V.token==="in"&&ii(W)&&W.fn==="unaryMinus"&&pn(W.args[0])||V.tokenType===_.NUMBER&&!pn(ye)&&(!ii(ye)||ye.op==="!")||V.token==="(";)ye=de(V),W=new p("*","multiply",[W,ye],!0);return W}function de(V){for(var W=Xe(V),ye=W,Ee=[];V.token==="/"&&vO(ye);)if(Ee.push(ai({},V)),$(V),V.tokenType===_.NUMBER)if(Ee.push(ai({},V)),$(V),V.tokenType===_.SYMBOL||V.token==="("||V.token==="in")ai(V,Ee.pop()),Ee.pop(),ye=Xe(V),W=new p("/","divide",[W,ye]);else{Ee.pop(),ai(V,Ee.pop());break}else{ai(V,Ee.pop());break}return W}function Xe(V){var W=Ke(V);if(V.token==="%"){var ye=ai({},V);$(V);try{Ke(V),ai(V,ye)}catch{W=new p("/","divide",[W,new u(100)],!1,!0)}}return W}function Ke(V){var W,ye,Ee,Fe={"-":"unaryMinus","+":"unaryPlus","~":"bitNot",not:"not"};return vt(Fe,V.token)?(Ee=Fe[V.token],W=V.token,$(V),ye=[Ke(V)],new p(W,Ee,ye)):se(V)}function se(V){var W,ye,Ee,Fe;return W=fe(V),(V.token==="^"||V.token===".^")&&(ye=V.token,Ee=ye==="^"?"pow":"dotPow",$(V),Fe=[W,Ke(V)],W=new p(ye,Ee,Fe)),W}function fe(V){for(var W=L(V);V.token==="??";)$(V),W=new p("??","nullish",[W,L(V)]);return W}function L(V){var W,ye,Ee,Fe;W=P(V);for(var Le={"!":"factorial","'":"ctranspose"};vt(Le,V.token);)ye=V.token,Ee=Le[ye],F(V),Fe=[W],W=new p(ye,Ee,Fe),W=ae(V,W);return W}function P(V){var W=[];if(V.tokenType===_.SYMBOL&&vt(V.extraNodes,V.token)){var ye=V.extraNodes[V.token];if(F(V),V.token==="("){if(W=[],H(V),F(V),V.token!==")")for(W.push(O(V));V.token===",";)F(V),W.push(O(V));if(V.token!==")")throw Ge(V,"Parenthesis ) expected");Z(V),F(V)}return new ye(W)}return K(V)}function K(V){var W,ye;return V.tokenType===_.SYMBOL||V.tokenType===_.DELIMITER&&V.token in A?(ye=V.token,F(V),vt(T,ye)?W=new u(T[ye]):S.includes(ye)?W=new u(t(ye,"number")):W=new b(ye),W=ae(V,W),W):pe(V)}function ae(V,W,ye){for(var Ee;;){var Fe=!1;V.token==="?."&&(Fe=!0,F(V));var Le=(V.token==="("||V.token==="["||V.token===".")&&!0;if(!(Fe||Le))break;if(Ee=[],V.token==="(")if(Fe||is(W)||gd(W)){if(H(V),F(V),V.token!==")")for(Ee.push(O(V));V.token===",";)F(V),Ee.push(O(V));if(V.token!==")")throw Ge(V,"Parenthesis ) expected");Z(V),F(V),W=new h(W,Ee,Fe)}else return W;else if(V.token==="["){if(H(V),F(V),V.token!=="]")for(Ee.push(O(V));V.token===",";)F(V),Ee.push(O(V));if(V.token!=="]")throw Ge(V,"Parenthesis ] expected");Z(V),F(V),W=new i(W,new d(Ee),Fe)}else{Fe||F(V);var Ue=V.tokenType===_.SYMBOL||V.tokenType===_.DELIMITER&&V.token in A;if(!Ue){var nt="Property name expected after ";throw nt+=Fe?"optional chain":"dot",Ge(V,nt)}Ee.push(new u(V.token)),F(V);var Pt=!0;W=new i(W,new d(Ee,Pt),Fe)}}return W}function pe(V){var W,ye;return V.token==='"'||V.token==="'"?(ye=ce(V,V.token),W=new u(ye),W=ae(V,W),W):Ae(V)}function ce(V,W){for(var ye="";R(V)!==""&&R(V)!==W;)if(R(V)==="\\"){z(V);var Ee=R(V),Fe=M[Ee];if(Fe!==void 0)ye+=Fe,V.index+=1;else if(Ee==="u"){var Le=V.expression.slice(V.index+1,V.index+5);if(/^[0-9A-Fa-f]{4}$/.test(Le))ye+=String.fromCharCode(parseInt(Le,16)),V.index+=5;else throw Ge(V,"Invalid unicode character \\u".concat(Le))}else throw Ge(V,"Bad escape character \\".concat(Ee))}else ye+=R(V),z(V);if(F(V),V.token!==W)throw Ge(V,"End of string ".concat(W," expected"));return F(V),ye}function Ae(V){var W,ye,Ee,Fe;if(V.token==="["){if(H(V),F(V),V.token!=="]"){var Le=we(V);if(V.token===";"){for(Ee=1,ye=[Le];V.token===";";)F(V),V.token!=="]"&&(ye[Ee]=we(V),Ee++);if(V.token!=="]")throw Ge(V,"End of matrix ] expected");Z(V),F(V),Fe=ye[0].items.length;for(var Ue=1;Ue<Ee;Ue++)if(ye[Ue].items.length!==Fe)throw qe(V,"Column dimensions mismatch ("+ye[Ue].items.length+" !== "+Fe+")");W=new s(ye)}else{if(V.token!=="]")throw Ge(V,"End of matrix ] expected");Z(V),F(V),W=Le}}else Z(V),F(V),W=new s([]);return ae(V,W)}return Pe(V)}function we(V){for(var W=[O(V)],ye=1;V.token===",";)F(V),V.token!=="]"&&V.token!==";"&&(W[ye]=O(V),ye++);return new s(W)}function Pe(V){if(V.token==="{"){H(V);var W,ye={};do if(F(V),V.token!=="}"){if(V.token==='"'||V.token==="'")W=ce(V,V.token);else if(V.tokenType===_.SYMBOL||V.tokenType===_.DELIMITER&&V.token in A)W=V.token,F(V);else throw Ge(V,"Symbol or string expected as object key");if(V.token!==":")throw Ge(V,"Colon : expected after object key");F(V),ye[W]=O(V)}while(V.token===",");if(V.token!=="}")throw Ge(V,"Comma , or bracket } expected after object value");Z(V),F(V);var Ee=new f(ye);return Ee=ae(V,Ee),Ee}return Te(V)}function Te(V){var W;if(V.tokenType===_.NUMBER){W=V.token,F(V);var ye=Kp(W,r),Ee=t(W,ye);return new u(Ee)}return Ne(V)}function Ne(V){var W;if(V.token==="("){if(H(V),F(V),W=O(V),V.token!==")")throw Ge(V,"Parenthesis ) expected");return Z(V),F(V),W=new m(W),W=ae(V,W),W}return $e(V)}function $e(V){throw V.token===""?Ge(V,"Unexpected end of expression"):Ge(V,"Value expected")}function Ye(V){return V.index-V.token.length+1}function Ge(V,W){var ye=Ye(V),Ee=new SyntaxError(W+" (char "+ye+")");return Ee.char=ye,Ee}function qe(V,W){var ye=Ye(V),Ee=new SyntaxError(W+" (char "+ye+")");return Ee.char=ye,Ee}return e.addConversion({from:"string",to:"Node",convert:x}),x}),pG="compile",IOe=["typed","parse"],POe=ie(pG,IOe,n=>{var{typed:e,parse:t}=n;return e(pG,{string:function(i){return t(i).compile()},"Array | Matrix":function(i){return qt(i,function(s){return t(s).compile()})}})}),mG="evaluate",FOe=["typed","parse"],LOe=ie(mG,FOe,n=>{var{typed:e,parse:t}=n;return e(mG,{string:function(i){var s=Dw();return t(i).compile().evaluate(s)},"string, Map | Object":function(i,s){return t(i).compile().evaluate(s)},"Array | Matrix":function(i){var s=Dw();return qt(i,function(a){return t(a).compile().evaluate(s)})},"Array | Matrix, Map | Object":function(i,s){return qt(i,function(a){return t(a).compile().evaluate(s)})}})}),OOe="Parser",kOe=["evaluate","parse"],BOe=ie(OOe,kOe,n=>{var{evaluate:e,parse:t}=n;function r(){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");Object.defineProperty(this,"scope",{value:Dw(),writable:!1})}r.prototype.type="Parser",r.prototype.isParser=!0,r.prototype.evaluate=function(s){return e(s,this.scope)},r.prototype.get=function(s){if(this.scope.has(s))return this.scope.get(s)},r.prototype.getAll=function(){return JTe(this.scope)},r.prototype.getAllAsMap=function(){return this.scope};function i(s){if(s.length===0)return!1;for(var a=0;a<s.length;a++){var o=s.charAt(a-1),l=s.charAt(a),u=s.charAt(a+1),c=t.isAlpha(l,o,u)||a>0&&t.isDigit(l);if(!c)return!1}return!0}return r.prototype.set=function(s,a){if(!i(s))throw new Error("Invalid variable name: '".concat(s,"'. Variable names must follow the specified rules."));return this.scope.set(s,a),a},r.prototype.remove=function(s){this.scope.delete(s)},r.prototype.clear=function(){this.scope.clear()},r.prototype.toJSON=function(){var s={mathjs:"Parser",variables:{},functions:{}};for(var[a,o]of this.scope)if(ate(o)){if(!UOe(o))throw new Error("Cannot serialize external function ".concat(a));s.functions[a]="".concat(o.syntax," = ").concat(o.expr)}else s.variables[a]=o;return s},r.fromJSON=function(s){var a=new r;return Object.entries(s.variables).forEach(o=>{var[l,u]=o;return a.set(l,u)}),Object.entries(s.functions).forEach(o=>{var[l,u]=o;return a.evaluate(u)}),a},r},{isClass:!0});function UOe(n){return typeof n=="function"&&typeof n.syntax=="string"&&typeof n.expr=="string"}var gG="parser",VOe=["typed","Parser"],zOe=ie(gG,VOe,n=>{var{typed:e,Parser:t}=n;return e(gG,{"":function(){return new t}})}),vG="lup",$Oe=["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtractScalar","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],HOe=ie(vG,$Oe,n=>{var{typed:e,matrix:t,abs:r,addScalar:i,divideScalar:s,multiplyScalar:a,subtractScalar:o,larger:l,equalScalar:u,unaryMinus:c,DenseMatrix:h,SparseMatrix:d,Spa:f}=n;return e(vG,{DenseMatrix:function(v){return p(v)},SparseMatrix:function(v){return m(v)},Array:function(v){var b=t(v),x=p(b);return{L:x.L.valueOf(),U:x.U.valueOf(),p:x.p}}});function p(y){var v=y._size[0],b=y._size[1],x=Math.min(v,b),w=Ut(y._data),_=[],E=[v,x],A=[],T=[x,b],S,M,D,N=[];for(S=0;S<v;S++)N[S]=S;for(M=0;M<b;M++){if(M>0)for(S=0;S<v;S++){var R=Math.min(S,M),z=0;for(D=0;D<R;D++)z=i(z,a(w[S][D],w[D][M]));w[S][M]=o(w[S][M],z)}var j=M,I=0,F=0;for(S=M;S<v;S++){var $=w[S][M],H=r($);l(H,I)&&(j=S,I=H,F=$)}if(M!==j&&(N[M]=[N[j],N[j]=N[M]][0],h._swapRows(M,j,w)),M<v)for(S=M+1;S<v;S++){var Z=w[S][M];u(Z,0)||(w[S][M]=s(w[S][M],F))}}for(M=0;M<b;M++)for(S=0;S<v;S++){if(M===0&&(S<b&&(A[S]=[]),_[S]=[]),S<M){S<b&&(A[S][M]=w[S][M]),M<v&&(_[S][M]=0);continue}if(S===M){S<b&&(A[S][M]=w[S][M]),M<v&&(_[S][M]=1);continue}S<b&&(A[S][M]=0),M<v&&(_[S][M]=w[S][M])}var J=new h({data:_,size:E}),ee=new h({data:A,size:T}),O=[];for(S=0,x=N.length;S<x;S++)O[N[S]]=S;return{L:J,U:ee,p:O,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
P: `+this.p}}}function m(y){var v=y._size[0],b=y._size[1],x=Math.min(v,b),w=y._values,_=y._index,E=y._ptr,A=[],T=[],S=[],M=[v,x],D=[],N=[],R=[],z=[x,b],j,I,F,$=[],H=[];for(j=0;j<v;j++)$[j]=j,H[j]=j;var Z=function(O,ue){var Q=H[O],re=H[ue];$[Q]=ue,$[re]=O,H[O]=re,H[ue]=Q},J=function(){var O=new f;I<v&&(S.push(A.length),A.push(1),T.push(I)),R.push(D.length);var ue=E[I],Q=E[I+1];for(F=ue;F<Q;F++)j=_[F],O.set($[j],w[F]);I>0&&O.forEach(0,I-1,function(Y,oe){d._forEachRow(Y,A,T,S,function(ve,me){ve>Y&&O.accumulate(ve,c(a(me,oe)))})});var re=I,le=O.get(I),te=r(le);O.forEach(I+1,v-1,function(Y,oe){var ve=r(oe);l(ve,te)&&(re=Y,te=ve,le=oe)}),I!==re&&(d._swapRows(I,re,M[1],A,T,S),d._swapRows(I,re,z[1],D,N,R),O.swap(I,re),Z(I,re)),O.forEach(0,v-1,function(Y,oe){Y<=I?(D.push(oe),N.push(Y)):(oe=s(oe,le),u(oe,0)||(A.push(oe),T.push(Y)))})};for(I=0;I<b;I++)J();return R.push(D.length),S.push(A.length),{L:new d({values:A,index:T,ptr:S,size:M}),U:new d({values:D,index:N,ptr:R,size:z}),p:$,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
P: `+this.p}}}}),yG="qr",GOe=["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtractScalar","complex"],jOe=ie(yG,GOe,n=>{var{typed:e,matrix:t,zeros:r,identity:i,isZero:s,equal:a,sign:o,sqrt:l,conj:u,unaryMinus:c,addScalar:h,divideScalar:d,multiplyScalar:f,subtractScalar:p,complex:m}=n;return ai(e(yG,{DenseMatrix:function(w){return v(w)},SparseMatrix:function(w){return b()},Array:function(w){var _=t(w),E=v(_);return{Q:E.Q.valueOf(),R:E.R.valueOf()}}}),{_denseQRimpl:y});function y(x){var w=x._size[0],_=x._size[1],E=i([w],"dense"),A=E._data,T=x.clone(),S=T._data,M,D,N,R=r([w],"");for(N=0;N<Math.min(_,w);++N){var z=S[N][N],j=c(a(z,0)?1:o(z)),I=u(j),F=0;for(M=N;M<w;M++)F=h(F,f(S[M][N],u(S[M][N])));var $=f(j,l(F));if(!s($)){var H=p(z,$);for(R[N]=1,M=N+1;M<w;M++)R[M]=d(S[M][N],H);var Z=c(u(d(H,$))),J=void 0;for(D=N;D<_;D++){for(J=0,M=N;M<w;M++)J=h(J,f(u(R[M]),S[M][D]));for(J=f(J,Z),M=N;M<w;M++)S[M][D]=f(p(S[M][D],f(R[M],J)),I)}for(M=0;M<w;M++){for(J=0,D=N;D<w;D++)J=h(J,f(A[M][D],R[D]));for(J=f(J,Z),D=N;D<w;++D)A[M][D]=d(p(A[M][D],f(J,u(R[D]))),I)}}}return{Q:E,R:T,toString:function(){return"Q: "+this.Q.toString()+`
R: `+this.R.toString()}}}function v(x){var w=y(x),_=w.R._data;if(x._data.length>0)for(var E=_[0][0].type==="Complex"?m(0):0,A=0;A<_.length;++A)for(var T=0;T<A&&T<(_[0]||[]).length;++T)_[A][T]=E;return w}function b(x){throw new Error("qr not implemented for sparse matrices yet")}});function qOe(n,e,t,r){n._values;for(var i=n._index,s=n._ptr,a=n._size,o=n._datatype,l=a[0],u=a[1],c=null,h=[],d=[],f=0,p=0;p<u;p++){d[p]=f;for(var m=t?t[p]:p,y=s[m],v=s[m+1],b=y;b<v;b++){var x=i[b];h[f]=x,f++}}return d[u]=f,n.createSparseMatrix({values:c,index:h,ptr:d,size:[l,u],datatype:o})}function Jne(n,e,t,r,i,s,a){var o=0;for(t[a]=n;o>=0;){var l=t[a+o],u=t[r+l];u===-1?(o--,s[e++]=l):(t[r+l]=t[i+u],++o,t[a+o]=u)}return e}function WOe(n,e){if(!n)return null;var t=0,r,i=[],s=[],a=0,o=e,l=2*e;for(r=0;r<e;r++)s[a+r]=-1;for(r=e-1;r>=0;r--)n[r]!==-1&&(s[o+r]=s[a+n[r]],s[a+n[r]]=r);for(r=0;r<e;r++)n[r]===-1&&(t=Jne(r,t,s,a,o,i,l));return i}function XOe(n,e){if(!n)return null;var t=n._index,r=n._ptr,i=n._size,s=i[0],a=i[1],o=[],l=[],u=0,c=a,h,d;for(h=0;h<s;h++)l[c+h]=-1;for(var f=0;f<a;f++){o[f]=-1,l[u+f]=-1;for(var p=r[f],m=r[f+1],y=p;y<m;y++){var v=t[y];for(h=l[c+v];h!==-1&&h<f;h=d)d=l[u+h],l[u+h]=f,d===-1&&(o[h]=f);l[c+v]=f}}return o}function KOe(n,e,t){for(var r=n._values,i=n._index,s=n._ptr,a=n._size,o=a[1],l=0,u=0;u<o;u++){var c=s[u];for(s[u]=l;c<s[u+1];c++)e(i[c],u,r?r[c]:1,t)&&(i[l]=i[c],r&&(r[l]=r[c]),l++)}return s[o]=l,i.splice(l,i.length-l),r&&r.splice(l,r.length-l),l}function Yd(n){return-n-2}var YOe="csAmd",QOe=["add","multiply","transpose"],ZOe=ie(YOe,QOe,n=>{var{add:e,multiply:t,transpose:r}=n;return function(c,h){if(!h||c<=0||c>3)return null;var d=h._size,f=d[0],p=d[1],m=0,y=Math.max(16,10*Math.sqrt(p));y=Math.min(p-2,y);var v=i(c,h,f,p,y);KOe(v,l,null);for(var b=v._index,x=v._ptr,w=x[p],_=[],E=[],A=0,T=p+1,S=2*(p+1),M=3*(p+1),D=4*(p+1),N=5*(p+1),R=6*(p+1),z=7*(p+1),j=_,I=s(p,x,E,A,M,j,S,z,T,R,D,N),F=a(p,x,E,N,D,R,y,T,M,j,S),$=0,H,Z,J,ee,O,ue,Q,re,le,te,Y,oe,ve,me,be,_e;F<p;){for(J=-1;$<p&&(J=E[M+$])===-1;$++);E[S+J]!==-1&&(j[E[S+J]]=-1),E[M+$]=E[S+J];var Be=E[D+J],ze=E[T+J];F+=ze;var tt=0;E[T+J]=-ze;var de=x[J],Xe=Be===0?de:w,Ke=Xe;for(ee=1;ee<=Be+1;ee++){for(ee>Be?(ue=J,Q=de,re=E[A+J]-Be):(ue=b[de++],Q=x[ue],re=E[A+ue]),O=1;O<=re;O++)H=b[Q++],!((le=E[T+H])<=0)&&(tt+=le,E[T+H]=-le,b[Ke++]=H,E[S+H]!==-1&&(j[E[S+H]]=j[H]),j[H]!==-1?E[S+j[H]]=E[S+H]:E[M+E[N+H]]=E[S+H]);ue!==J&&(x[ue]=Yd(J),E[R+ue]=0)}for(Be!==0&&(w=Ke),E[N+J]=tt,x[J]=Xe,E[A+J]=Ke-Xe,E[D+J]=-2,I=o(I,m,E,R,p),te=Xe;te<Ke;te++)if(H=b[te],!((Y=E[D+H])<=0)){le=-E[T+H];var se=I-le;for(de=x[H],oe=x[H]+Y-1;de<=oe;de++)ue=b[de],E[R+ue]>=I?E[R+ue]-=le:E[R+ue]!==0&&(E[R+ue]=E[N+ue]+se)}for(te=Xe;te<Ke;te++){for(H=b[te],oe=x[H],ve=oe+E[D+H]-1,me=oe,be=0,_e=0,de=oe;de<=ve;de++)if(ue=b[de],E[R+ue]!==0){var fe=E[R+ue]-I;fe>0?(_e+=fe,b[me++]=ue,be+=ue):(x[ue]=Yd(J),E[R+ue]=0)}E[D+H]=me-oe+1;var L=me,P=oe+E[A+H];for(de=ve+1;de<P;de++){Z=b[de];var K=E[T+Z];K<=0||(_e+=K,b[me++]=Z,be+=Z)}_e===0?(x[H]=Yd(J),le=-E[T+H],tt-=le,ze+=le,F+=le,E[T+H]=0,E[D+H]=-1):(E[N+H]=Math.min(E[N+H],_e),b[me]=b[L],b[L]=b[oe],b[oe]=J,E[A+H]=me-oe+1,be=(be<0?-be:be)%p,E[S+H]=E[z+be],E[z+be]=H,j[H]=be)}for(E[N+J]=tt,m=Math.max(m,tt),I=o(I+m,m,E,R,p),te=Xe;te<Ke;te++)if(H=b[te],!(E[T+H]>=0))for(be=j[H],H=E[z+be],E[z+be]=-1;H!==-1&&E[S+H]!==-1;H=E[S+H],I++){for(re=E[A+H],Y=E[D+H],de=x[H]+1;de<=x[H]+re-1;de++)E[R+b[de]]=I;var ae=H;for(Z=E[S+H];Z!==-1;){var pe=E[A+Z]===re&&E[D+Z]===Y;for(de=x[Z]+1;pe&&de<=x[Z]+re-1;de++)E[R+b[de]]!==I&&(pe=0);pe?(x[Z]=Yd(H),E[T+H]+=E[T+Z],E[T+Z]=0,E[D+Z]=-1,Z=E[S+Z],E[S+ae]=Z):(ae=Z,Z=E[S+Z])}}for(de=Xe,te=Xe;te<Ke;te++)H=b[te],!((le=-E[T+H])<=0)&&(E[T+H]=le,_e=E[N+H]+tt-le,_e=Math.min(_e,p-F-le),E[M+_e]!==-1&&(j[E[M+_e]]=H),E[S+H]=E[M+_e],j[H]=-1,E[M+_e]=H,$=Math.min($,_e),E[N+H]=_e,b[de++]=H);E[T+J]=ze,(E[A+J]=de-Xe)===0&&(x[J]=-1,E[R+J]=0),Be!==0&&(w=de)}for(H=0;H<p;H++)x[H]=Yd(x[H]);for(Z=0;Z<=p;Z++)E[M+Z]=-1;for(Z=p;Z>=0;Z--)E[T+Z]>0||(E[S+Z]=E[M+x[Z]],E[M+x[Z]]=Z);for(ue=p;ue>=0;ue--)E[T+ue]<=0||x[ue]!==-1&&(E[S+ue]=E[M+x[ue]],E[M+x[ue]]=ue);for(J=0,H=0;H<=p;H++)x[H]===-1&&(J=Jne(H,J,E,M,S,_,R));return _.splice(_.length-1,1),_};function i(u,c,h,d,f){var p=r(c);if(u===1&&d===h)return e(c,p);if(u===2){for(var m=p._index,y=p._ptr,v=0,b=0;b<h;b++){var x=y[b];if(y[b]=v,!(y[b+1]-x>f))for(var w=y[b+1];x<w;x++)m[v++]=m[x]}return y[h]=v,c=r(p),t(p,c)}return t(p,c)}function s(u,c,h,d,f,p,m,y,v,b,x,w){for(var _=0;_<u;_++)h[d+_]=c[_+1]-c[_];h[d+u]=0;for(var E=0;E<=u;E++)h[f+E]=-1,p[E]=-1,h[m+E]=-1,h[y+E]=-1,h[v+E]=1,h[b+E]=1,h[x+E]=0,h[w+E]=h[d+E];var A=o(0,0,h,b,u);return h[x+u]=-2,c[u]=-1,h[b+u]=0,A}function a(u,c,h,d,f,p,m,y,v,b,x){for(var w=0,_=0;_<u;_++){var E=h[d+_];if(E===0)h[f+_]=-2,w++,c[_]=-1,h[p+_]=0;else if(E>m)h[y+_]=0,h[f+_]=-1,w++,c[_]=Yd(u),h[y+u]++;else{var A=h[v+E];A!==-1&&(b[A]=_),h[x+_]=h[v+E],h[v+E]=_}}return w}function o(u,c,h,d,f){if(u<2||u+c<0){for(var p=0;p<f;p++)h[d+p]!==0&&(h[d+p]=1);u=2}return u}function l(u,c){return u!==c}});function JOe(n,e,t,r,i,s,a){var o,l,u=0,c;if(n<=e||t[r+e]<=t[i+n])return-1;t[i+n]=t[r+e];var h=t[s+n];if(t[s+n]=e,h===-1)u=1,c=n;else{for(u=2,c=h;c!==t[a+c];c=t[a+c]);for(o=h;o!==c;o=l)l=t[a+o],t[a+o]=c}return{jleaf:u,q:c}}var eke="csCounts",tke=["transpose"],nke=ie(eke,tke,n=>{var{transpose:e}=n;return function(t,r,i,s){if(!t||!r||!i)return null;var a=t._size,o=a[0],l=a[1],u,c,h,d,f,p,m,y=4*l+(s?l+o+1:0),v=[],b=0,x=l,w=2*l,_=3*l,E=4*l,A=5*l+1;for(h=0;h<y;h++)v[h]=-1;var T=[],S=e(t),M=S._index,D=S._ptr;for(h=0;h<l;h++)for(c=i[h],T[c]=v[_+c]===-1?1:0;c!==-1&&v[_+c]===-1;c=r[c])v[_+c]=h;if(s){for(h=0;h<l;h++)v[i[h]]=h;for(u=0;u<o;u++){for(h=l,p=D[u],m=D[u+1],f=p;f<m;f++)h=Math.min(h,v[M[f]]);v[A+u]=v[E+h],v[E+h]=u}}for(u=0;u<l;u++)v[b+u]=u;for(h=0;h<l;h++){for(c=i[h],r[c]!==-1&&T[r[c]]--,d=s?v[E+h]:c;d!==-1;d=s?v[A+d]:-1)for(f=D[d];f<D[d+1];f++){u=M[f];var N=JOe(u,c,v,_,x,w,b);N.jleaf>=1&&T[c]++,N.jleaf===2&&T[N.q]--}r[c]!==-1&&(v[b+c]=r[c])}for(c=0;c<l;c++)r[c]!==-1&&(T[r[c]]+=T[c]);return T}}),rke="csSqr",ike=["add","multiply","transpose"],ske=ie(rke,ike,n=>{var{add:e,multiply:t,transpose:r}=n,i=ZOe({add:e,multiply:t,transpose:r}),s=nke({transpose:r});return function(l,u,c){var h=u._ptr,d=u._size,f=d[1],p,m={};if(m.q=i(l,u),l&&!m.q)return null;if(c){var y=l?qOe(u,null,m.q):u;m.parent=XOe(y);var v=WOe(m.parent,f);if(m.cp=s(y,m.parent,v,1),y&&m.parent&&m.cp&&a(y,m))for(m.unz=0,p=0;p<f;p++)m.unz+=m.cp[p]}else m.unz=4*h[f]+f,m.lnz=m.unz;return m};function a(o,l){var u=o._ptr,c=o._index,h=o._size,d=h[0],f=h[1];l.pinv=[],l.leftmost=[];var p=l.parent,m=l.pinv,y=l.leftmost,v=[],b=0,x=d,w=d+f,_=d+2*f,E,A,T,S,M;for(A=0;A<f;A++)v[x+A]=-1,v[w+A]=-1,v[_+A]=0;for(E=0;E<d;E++)y[E]=-1;for(A=f-1;A>=0;A--)for(S=u[A],M=u[A+1],T=S;T<M;T++)y[c[T]]=A;for(E=d-1;E>=0;E--)m[E]=-1,A=y[E],A!==-1&&(v[_+A]++===0&&(v[w+A]=E),v[b+E]=v[x+A],v[x+A]=E);for(l.lnz=0,l.m2=d,A=0;A<f;A++)if(E=v[x+A],l.lnz++,E<0&&(E=l.m2++),m[E]=A,!(--_[A]<=0)){l.lnz+=v[_+A];var D=p[A];D!==-1&&(v[_+D]===0&&(v[w+D]=v[w+A]),v[b+v[w+A]]=v[x+D],v[x+D]=v[b+E],v[_+D]+=v[_+A])}for(E=0;E<d;E++)m[E]<0&&(m[E]=A++);return!0}});function BO(n,e){return n[e]<0}function ere(n,e){n[e]=Yd(n[e])}function xG(n){return n<0?Yd(n):n}function ake(n,e,t,r,i){var s=e._index,a=e._ptr,o=e._size,l=o[1],u,c,h,d=0;for(r[0]=n;d>=0;){n=r[d];var f=i?i[n]:n;BO(a,n)||(ere(a,n),r[l+d]=f<0?0:xG(a[f]));var p=1;for(c=r[l+d],h=f<0?0:xG(a[f+1]);c<h;c++)if(u=s[c],!BO(a,u)){r[l+d]=c,r[++d]=u,p=0;break}p&&(d--,r[--t]=n)}return t}function oke(n,e,t,r,i){var s=n._ptr,a=n._size,o=e._index,l=e._ptr,u=a[1],c,h,d,f=u;for(h=l[t],d=l[t+1],c=h;c<d;c++){var p=o[c];BO(s,p)||(f=ake(p,n,f,r,i))}for(c=f;c<u;c++)ere(s,r[c]);return f}var lke="csSpsolve",uke=["divideScalar","multiply","subtract"],cke=ie(lke,uke,n=>{var{divideScalar:e,multiply:t,subtract:r}=n;return function(s,a,o,l,u,c,h){var d=s._values,f=s._index,p=s._ptr,m=s._size,y=m[1],v=a._values,b=a._index,x=a._ptr,w,_,E,A,T=oke(s,a,o,l,c);for(w=T;w<y;w++)u[l[w]]=0;for(_=x[o],E=x[o+1],w=_;w<E;w++)u[b[w]]=v[w];for(var S=T;S<y;S++){var M=l[S],D=c?c[M]:M;if(!(D<0))for(_=p[D],E=p[D+1],u[M]=e(u[M],d[h?_:E-1]),w=h?_+1:_,A=h?E:E-1;w<A;w++){var N=f[w];u[N]=r(u[N],t(d[w],u[M]))}}return T}}),hke="csLu",dke=["abs","divideScalar","multiply","subtract","larger","largerEq","SparseMatrix"],fke=ie(hke,dke,n=>{var{abs:e,divideScalar:t,multiply:r,subtract:i,larger:s,largerEq:a,SparseMatrix:o}=n,l=cke({divideScalar:t,multiply:r,subtract:i});return function(c,h,d){if(!c)return null;var f=c._size,p=f[1],m,y=100,v=100;h&&(m=h.q,y=h.lnz||y,v=h.unz||v);var b=[],x=[],w=[],_=new o({values:b,index:x,ptr:w,size:[p,p]}),E=[],A=[],T=[],S=new o({values:E,index:A,ptr:T,size:[p,p]}),M=[],D,N,R=[],z=[];for(D=0;D<p;D++)R[D]=0,M[D]=-1,w[D+1]=0;y=0,v=0;for(var j=0;j<p;j++){w[j]=y,T[j]=v;var I=m?m[j]:j,F=l(_,c,I,z,R,M,1),$=-1,H=-1;for(N=F;N<p;N++)if(D=z[N],M[D]<0){var Z=e(R[D]);s(Z,H)&&(H=Z,$=D)}else A[v]=M[D],E[v++]=R[D];if($===-1||H<=0)return null;M[I]<0&&a(e(R[I]),r(H,d))&&($=I);var J=R[$];for(A[v]=j,E[v++]=J,M[$]=j,x[y]=$,b[y++]=1,N=F;N<p;N++)D=z[N],M[D]<0&&(x[y]=D,b[y++]=t(R[D],J)),R[D]=0}for(w[p]=y,T[p]=v,N=0;N<y;N++)x[N]=M[x[N]];return b.splice(y,b.length-y),x.splice(y,x.length-y),E.splice(v,E.length-v),A.splice(v,A.length-v),{L:_,U:S,pinv:M}}}),bG="slu",pke=["typed","abs","add","multiply","transpose","divideScalar","subtract","larger","largerEq","SparseMatrix"],mke=ie(bG,pke,n=>{var{typed:e,abs:t,add:r,multiply:i,transpose:s,divideScalar:a,subtract:o,larger:l,largerEq:u,SparseMatrix:c}=n,h=ske({add:r,multiply:i,transpose:s}),d=fke({abs:t,divideScalar:a,multiply:i,subtract:o,larger:l,largerEq:u,SparseMatrix:c});return e(bG,{"SparseMatrix, number, number":function(p,m,y){if(!bt(m)||m<0||m>3)throw new Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(y<0||y>1)throw new Error("Partial pivoting threshold must be a number from 0 to 1");var v=h(m,p,!1),b=d(p,v,y);return{L:b.L,U:b.U,p:b.pinv,q:v.q,toString:function(){return"L: "+this.L.toString()+`
U: `+this.U.toString()+`
p: `+this.p.toString()+(this.q?`
q: `+this.q.toString():"")+`
`}}}})});function _G(n,e){var t,r=e.length,i=[];if(n)for(t=0;t<r;t++)i[n[t]]=e[t];else for(t=0;t<r;t++)i[t]=e[t];return i}var wG="lusolve",gke=["typed","matrix","lup","slu","usolve","lsolve","DenseMatrix"],vke=ie(wG,gke,n=>{var{typed:e,matrix:t,lup:r,slu:i,usolve:s,lsolve:a,DenseMatrix:o}=n,l=oA({DenseMatrix:o});return e(wG,{"Array, Array | Matrix":function(d,f){d=t(d);var p=r(d),m=c(p.L,p.U,p.p,null,f);return m.valueOf()},"DenseMatrix, Array | Matrix":function(d,f){var p=r(d);return c(p.L,p.U,p.p,null,f)},"SparseMatrix, Array | Matrix":function(d,f){var p=r(d);return c(p.L,p.U,p.p,null,f)},"SparseMatrix, Array | Matrix, number, number":function(d,f,p,m){var y=i(d,p,m);return c(y.L,y.U,y.p,y.q,f)},"Object, Array | Matrix":function(d,f){return c(d.L,d.U,d.p,d.q,f)}});function u(h){if(Dt(h))return h;if(Wn(h))return t(h);throw new TypeError("Invalid Matrix LU decomposition")}function c(h,d,f,p,m){h=u(h),d=u(d),f&&(m=l(h,m,!0),m._data=_G(f,m._data));var y=a(h,m),v=s(d,y);return p&&(v._data=_G(p,v._data)),v}}),EG="polynomialRoot",yke=["typed","isZero","equalScalar","add","subtract","multiply","divide","sqrt","unaryMinus","cbrt","typeOf","im","re"],xke=ie(EG,yke,n=>{var{typed:e,isZero:t,equalScalar:r,add:i,subtract:s,multiply:a,divide:o,sqrt:l,unaryMinus:u,cbrt:c,typeOf:h,im:d,re:f}=n;return e(EG,{"number|Complex, ...number|Complex":(p,m)=>{for(var y=[p,...m];y.length>0&&t(y[y.length-1]);)y.pop();if(y.length<2)throw new RangeError("Polynomial [".concat(p,", ").concat(m,"] must have a non-zero non-constant coefficient"));switch(y.length){case 2:return[u(o(y[0],y[1]))];case 3:{var[v,b,x]=y,w=a(2,x),_=a(b,b),E=a(4,x,v);if(r(_,E))return[o(u(b),w)];var A=l(s(_,E));return[o(s(A,b),w),o(s(u(A),b),w)]}case 4:{var[T,S,M,D]=y,N=u(a(3,D)),R=a(M,M),z=a(3,D,S),j=i(a(2,M,M,M),a(27,D,D,T)),I=a(9,D,M,S);if(r(R,z)&&r(j,I))return[o(M,N)];var F=s(R,z),$=s(j,I),H=i(a(18,D,M,S,T),a(M,M,S,S)),Z=i(a(4,M,M,M,T),a(4,D,S,S,S),a(27,D,D,T,T));if(r(H,Z))return[o(s(a(4,D,M,S),i(a(9,D,D,T),a(M,M,M))),a(D,F)),o(s(a(9,D,T),a(M,S)),a(2,F))];var J;r(R,z)?J=$:J=o(i($,l(s(a($,$),a(4,F,F,F)))),2);var ee=!0,O=c(J,ee).toArray().map(ue=>o(i(M,ue,o(F,ue)),N));return O.map(ue=>h(ue)==="Complex"&&r(f(ue),f(ue)+d(ue))?f(ue):ue)}default:throw new RangeError("only implemented for cubic or lower-order polynomials, not ".concat(y))}}})}),bke="Help",_ke=["evaluate"],wke=ie(bke,_ke,n=>{var{evaluate:e}=n;function t(r){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(!r)throw new Error('Argument "doc" missing');this.doc=r}return t.prototype.type="Help",t.prototype.isHelp=!0,t.prototype.toString=function(){var r=this.doc||{},i=`
`;if(r.name&&(i+="Name: "+r.name+`

`),r.category&&(i+="Category: "+r.category+`

`),r.description&&(i+=`Description:
    `+r.description+`

`),r.syntax&&(i+=`Syntax:
    `+r.syntax.join(`
    `)+`

`),r.examples){i+=`Examples:
`;for(var s=!1,a=e("config()"),o={config:h=>(s=!0,e("config(newConfig)",{newConfig:h}))},l=0;l<r.examples.length;l++){var u=r.examples[l];i+="    "+u+`
`;var c=void 0;try{c=e(u,o)}catch(h){c=h}c!==void 0&&!ste(c)&&(i+="        "+nn(c,{precision:14})+`
`)}i+=`
`,s&&e("config(originalConfig)",{originalConfig:a})}return r.mayThrow&&r.mayThrow.length&&(i+="Throws: "+r.mayThrow.join(", ")+`

`),r.seealso&&r.seealso.length&&(i+="See also: "+r.seealso.join(", ")+`
`),i},t.prototype.toJSON=function(){var r=Ut(this.doc);return r.mathjs="Help",r},t.fromJSON=function(r){var i={};return Object.keys(r).filter(s=>s!=="mathjs").forEach(s=>{i[s]=r[s]}),new t(i)},t.prototype.valueOf=t.prototype.toString,t},{isClass:!0}),Eke="Chain",Ske=["?on","math","typed"],Ake=ie(Eke,Ske,n=>{var{on:e,math:t,typed:r}=n;function i(u){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");lte(u)?this.value=u.value:this.value=u}i.prototype.type="Chain",i.prototype.isChain=!0,i.prototype.done=function(){return this.value},i.prototype.valueOf=function(){return this.value},i.prototype.toString=function(){return nn(this.value)},i.prototype.toJSON=function(){return{mathjs:"Chain",value:this.value}},i.fromJSON=function(u){return new i(u.value)};function s(u,c){typeof c=="function"&&(i.prototype[u]=o(c))}function a(u,c){dMe(i.prototype,u,function(){var d=c();if(typeof d=="function")return o(d)})}function o(u){return function(){if(arguments.length===0)return new i(u(this.value));for(var c=[this.value],h=0;h<arguments.length;h++)c[h+1]=arguments[h];if(r.isTypedFunction(u)){var d=r.resolve(u,c);if(d.params.length===1)throw new Error("chain function "+u.name+" cannot match rest parameter between chain value and additional arguments.");return new i(d.implementation.apply(u,c))}return new i(u.apply(u,c))}}i.createProxy=function(u,c){if(typeof u=="string")s(u,c);else{var h=function(p){vt(u,p)&&l[p]===void 0&&a(p,()=>u[p])};for(var d in u)h(d)}};var l={expression:!0,docs:!0,type:!0,classes:!0,json:!0,error:!0,isChain:!0};return i.createProxy(t),e&&e("import",function(u,c,h){h||a(u,c)}),i},{isClass:!0}),SG={name:"e",category:"Constants",syntax:["e"],description:"Euler's number, the base of the natural logarithm. Approximately equal to 2.71828",examples:["e","e ^ 2","exp(2)","log(e)"],seealso:["exp"]},Tke={name:"false",category:"Constants",syntax:["false"],description:"Boolean value false",examples:["false"],seealso:["true"]},Mke={name:"i",category:"Constants",syntax:["i"],description:"Imaginary unit, defined as i*i=-1. A complex number is described as a + b*i, where a is the real part, and b is the imaginary part.",examples:["i","i * i","sqrt(-1)"],seealso:[]},Cke={name:"Infinity",category:"Constants",syntax:["Infinity"],description:"Infinity, a number which is larger than the maximum number that can be handled by a floating point number.",examples:["Infinity","1 / 0"],seealso:[]},Dke={name:"LN10",category:"Constants",syntax:["LN10"],description:"Returns the natural logarithm of 10, approximately equal to 2.302",examples:["LN10","log(10)"],seealso:[]},Nke={name:"LN2",category:"Constants",syntax:["LN2"],description:"Returns the natural logarithm of 2, approximately equal to 0.693",examples:["LN2","log(2)"],seealso:[]},Rke={name:"LOG10E",category:"Constants",syntax:["LOG10E"],description:"Returns the base-10 logarithm of E, approximately equal to 0.434",examples:["LOG10E","log(e, 10)"],seealso:[]},Ike={name:"LOG2E",category:"Constants",syntax:["LOG2E"],description:"Returns the base-2 logarithm of E, approximately equal to 1.442",examples:["LOG2E","log(e, 2)"],seealso:[]},Pke={name:"NaN",category:"Constants",syntax:["NaN"],description:"Not a number",examples:["NaN","0 / 0"],seealso:[]},Fke={name:"null",category:"Constants",syntax:["null"],description:"Value null",examples:["null"],seealso:["true","false"]},Lke={name:"phi",category:"Constants",syntax:["phi"],description:"Phi is the golden ratio. Two quantities are in the golden ratio if their ratio is the same as the ratio of their sum to the larger of the two quantities. Phi is defined as `(1 + sqrt(5)) / 2` and is approximately 1.618034...",examples:["phi"],seealso:[]},AG={name:"pi",category:"Constants",syntax:["pi"],description:"The number pi is a mathematical constant that is the ratio of a circle's circumference to its diameter, and is approximately equal to 3.14159",examples:["pi","sin(pi/2)"],seealso:["tau"]},Oke={name:"SQRT1_2",category:"Constants",syntax:["SQRT1_2"],description:"Returns the square root of 1/2, approximately equal to 0.707",examples:["SQRT1_2","sqrt(1/2)"],seealso:[]},kke={name:"SQRT2",category:"Constants",syntax:["SQRT2"],description:"Returns the square root of 2, approximately equal to 1.414",examples:["SQRT2","sqrt(2)"],seealso:[]},Bke={name:"tau",category:"Constants",syntax:["tau"],description:"Tau is the ratio constant of a circle's circumference to radius, equal to 2 * pi, approximately 6.2832.",examples:["tau","2 * pi"],seealso:["pi"]},Uke={name:"true",category:"Constants",syntax:["true"],description:"Boolean value true",examples:["true"],seealso:["false"]},Vke={name:"version",category:"Constants",syntax:["version"],description:"A string with the version number of math.js",examples:["version"],seealso:[]},zke={name:"bignumber",category:"Construction",syntax:["bignumber(x)"],description:"Create a big number from a number or string.",examples:["0.1 + 0.2","bignumber(0.1) + bignumber(0.2)",'bignumber("7.2")','bignumber("7.2e500")',"bignumber([0.1, 0.2, 0.3])"],seealso:["boolean","bigint","complex","fraction","index","matrix","string","unit"]},$ke={name:"bigint",category:"Construction",syntax:["bigint(x)"],description:"Create a bigint, an integer with an arbitrary number of digits, from a number or string.",examples:["123123123123123123 # a large number will lose digits",'bigint("123123123123123123")','bignumber(["1", "3", "5"])'],seealso:["boolean","bignumber","number","complex","fraction","index","matrix","string","unit"]},Hke={name:"boolean",category:"Construction",syntax:["x","boolean(x)"],description:"Convert a string or number into a boolean.",examples:["boolean(0)","boolean(1)","boolean(3)",'boolean("true")','boolean("false")',"boolean([1, 0, 1, 1])"],seealso:["bignumber","complex","index","matrix","number","string","unit"]},Gke={name:"complex",category:"Construction",syntax:["complex()","complex(re, im)","complex(string)"],description:"Create a complex number.",examples:["complex()","complex(2, 3)",'complex("7 - 2i")'],seealso:["bignumber","boolean","index","matrix","number","string","unit"]},jke={name:"createUnit",category:"Construction",syntax:["createUnit(definitions)","createUnit(name, definition)"],description:"Create a user-defined unit and register it with the Unit type.",examples:['createUnit("foo")','createUnit("knot", {definition: "0.514444444 m/s", aliases: ["knots", "kt", "kts"]})','createUnit("mph", "1 mile/hour")'],seealso:["unit","splitUnit"]},qke={name:"fraction",category:"Construction",syntax:["fraction(num)","fraction(matrix)","fraction(num,den)","fraction({n: num, d: den})"],description:"Create a fraction from a number or from integer numerator and denominator.",examples:["fraction(0.125)","fraction(1, 3) + fraction(2, 5)","fraction({n: 333, d: 53})","fraction([sqrt(9), sqrt(10), sqrt(11)])"],seealso:["bignumber","boolean","complex","index","matrix","string","unit"]},Wke={name:"index",category:"Construction",syntax:["[start]","[start:end]","[start:step:end]","[start1, start 2, ...]","[start1:end1, start2:end2, ...]","[start1:step1:end1, start2:step2:end2, ...]"],description:"Create an index to get or replace a subset of a matrix",examples:["A = [1, 2, 3; 4, 5, 6]","A[1, :]","A[1, 2] = 50","A[1:2, 1:2] = 1","B = [1, 2, 3]","B[B>1 and B<3]"],seealso:["bignumber","boolean","complex","matrix","number","range","string","unit"]},Xke={name:"matrix",category:"Construction",syntax:["[]","[a1, b1, ...; a2, b2, ...]","matrix()",'matrix("dense")',"matrix([...])"],description:"Create a matrix.",examples:["[]","[1, 2, 3]","[1, 2, 3; 4, 5, 6]","matrix()","matrix([3, 4])",'matrix([3, 4; 5, 6], "sparse")','matrix([3, 4; 5, 6], "sparse", "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","sparse"]},Kke={name:"number",category:"Construction",syntax:["x","number(x)","number(unit, valuelessUnit)"],description:"Create a number or convert a string or boolean into a number.",examples:["2","2e3","4.05","number(2)",'number("7.2")',"number(true)","number([true, false, true, true])",'number(unit("52cm"), "m")'],seealso:["bignumber","bigint","boolean","complex","fraction","index","matrix","string","unit"]},Yke={name:"sparse",category:"Construction",syntax:["sparse()","sparse([a1, b1, ...; a1, b2, ...])",'sparse([a1, b1, ...; a1, b2, ...], "number")'],description:"Create a sparse matrix.",examples:["sparse()","sparse([3, 4; 5, 6])",'sparse([3, 0; 5, 0], "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","matrix"]},Qke={name:"splitUnit",category:"Construction",syntax:["splitUnit(unit: Unit, parts: Unit[])"],description:"Split a unit in an array of units whose sum is equal to the original unit.",examples:['splitUnit(1 m, ["feet", "inch"])'],seealso:["unit","createUnit"]},Zke={name:"string",category:"Construction",syntax:['"text"',"string(x)"],description:"Create a string or convert a value to a string",examples:['"Hello World!"',"string(4.2)","string(3 + 2i)"],seealso:["bignumber","boolean","complex","index","matrix","number","unit"]},Jke={name:"unit",category:"Construction",syntax:["value unit","unit(value, unit)","unit(string)"],description:"Create a unit.",examples:["5.5 mm","3 inch",'unit(7.1, "kilogram")','unit("23 deg")'],seealso:["bignumber","boolean","complex","index","matrix","number","string"]},eBe={name:"config",category:"Core",syntax:["config()","config(options)"],description:"Get configuration or change configuration.",examples:["config()","1/3 + 1/4",'config({number: "Fraction"})',"1/3 + 1/4"],seealso:[]},tBe={name:"import",category:"Core",syntax:["import(functions)","import(functions, options)"],description:"Import functions or constants from an object.",examples:["import({myFn: f(x)=x^2, myConstant: 32 })","myFn(2)","myConstant"],seealso:[]},nBe={name:"typed",category:"Core",syntax:["typed(signatures)","typed(name, signatures)"],description:"Create a typed function.",examples:['double = typed({ "number": f(x)=x+x, "string": f(x)=concat(x,x) })',"double(2)",'double("hello")'],seealso:[]},rBe={name:"derivative",category:"Algebra",syntax:["derivative(expr, variable)","derivative(expr, variable, {simplify: boolean})"],description:"Takes the derivative of an expression expressed in parser Nodes. The derivative will be taken over the supplied variable in the second parameter. If there are multiple variables in the expression, it will return a partial derivative.",examples:['derivative("2x^3", "x")','derivative("2x^3", "x", {simplify: false})','derivative("2x^2 + 3x + 4", "x")','derivative("sin(2x)", "x")','f = parse("x^2 + x")','x = parse("x")',"df = derivative(f, x)","df.evaluate({x: 3})"],seealso:["simplify","parse","evaluate"]},iBe={name:"leafCount",category:"Algebra",syntax:["leafCount(expr)"],description:"Computes the number of leaves in the parse tree of the given expression",examples:['leafCount("e^(i*pi)-1")','leafCount(parse("{a: 22/7, b: 10^(1/2)}"))'],seealso:["simplify"]},sBe={name:"lsolve",category:"Algebra",syntax:["x=lsolve(L, b)"],description:"Finds one solution of the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lsolveAll","lup","lusolve","usolve","matrix","sparse"]},aBe={name:"lsolveAll",category:"Algebra",syntax:["x=lsolveAll(L, b)"],description:"Finds all solutions of the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lsolve","lup","lusolve","usolve","matrix","sparse"]},oBe={name:"lup",category:"Algebra",syntax:["lup(m)"],description:"Calculate the Matrix LU decomposition with partial pivoting. Matrix A is decomposed in three matrices (L, U, P) where P * A = L * U",examples:["lup([[2, 1], [1, 4]])","lup(matrix([[2, 1], [1, 4]]))","lup(sparse([[2, 1], [1, 4]]))"],seealso:["lusolve","lsolve","usolve","matrix","sparse","slu","qr"]},lBe={name:"lusolve",category:"Algebra",syntax:["x=lusolve(A, b)","x=lusolve(lu, b)"],description:"Solves the linear system A * x = b where A is an [n x n] matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lusolve(a, b)"],seealso:["lup","slu","lsolve","usolve","matrix","sparse"]},uBe={name:"polynomialRoot",category:"Algebra",syntax:["x=polynomialRoot(-6, 3)","x=polynomialRoot(4, -4, 1)","x=polynomialRoot(-8, 12, -6, 1)"],description:"Finds the roots of a univariate polynomial given by its coefficients starting from constant, linear, and so on, increasing in degree.",examples:["a = polynomialRoot(-6, 11, -6, 1)"],seealso:["cbrt","sqrt"]},cBe={name:"qr",category:"Algebra",syntax:["qr(A)"],description:"Calculates the Matrix QR decomposition. Matrix `A` is decomposed in two matrices (`Q`, `R`) where `Q` is an orthogonal matrix and `R` is an upper triangular matrix.",examples:["qr([[1, -1,  4], [1,  4, -2], [1,  4,  2], [1,  -1, 0]])"],seealso:["lup","slu","matrix"]},hBe={name:"rationalize",category:"Algebra",syntax:["rationalize(expr)","rationalize(expr, scope)","rationalize(expr, scope, detailed)"],description:"Transform a rationalizable expression in a rational fraction. If rational fraction is one variable polynomial then converts the numerator and denominator in canonical form, with decreasing exponents, returning the coefficients of numerator.",examples:['rationalize("2x/y - y/(x+1)")','rationalize("2x/y - y/(x+1)", true)'],seealso:["simplify"]},dBe={name:"resolve",category:"Algebra",syntax:["resolve(node, scope)"],description:"Recursively substitute variables in an expression tree.",examples:['resolve(parse("1 + x"), { x: 7 })','resolve(parse("size(text)"), { text: "Hello World" })','resolve(parse("x + y"), { x: parse("3z") })','resolve(parse("3x"), { x: parse("y+z"), z: parse("w^y") })'],seealso:["simplify","evaluate"],mayThrow:["ReferenceError"]},fBe={name:"simplify",category:"Algebra",syntax:["simplify(expr)","simplify(expr, rules)"],description:"Simplify an expression tree.",examples:['simplify("3 + 2 / 4")','simplify("2x + x")','f = parse("x * (x + 2 + x)")',"simplified = simplify(f)","simplified.evaluate({x: 2})"],seealso:["simplifyCore","derivative","evaluate","parse","rationalize","resolve"]},pBe={name:"simplifyConstant",category:"Algebra",syntax:["simplifyConstant(expr)","simplifyConstant(expr, options)"],description:"Replace constant subexpressions of node with their values.",examples:['simplifyConstant("(3-3)*x")','simplifyConstant(parse("z-cos(tau/8)"))'],seealso:["simplify","simplifyCore","evaluate"]},mBe={name:"simplifyCore",category:"Algebra",syntax:["simplifyCore(node)"],description:"Perform simple one-pass simplifications on an expression tree.",examples:['simplifyCore(parse("0*x"))','simplifyCore(parse("(x+0)*2"))'],seealso:["simplify","simplifyConstant","evaluate"]},gBe={name:"slu",category:"Algebra",syntax:["slu(A, order, threshold)"],description:"Calculate the Matrix LU decomposition with full pivoting. Matrix A is decomposed in two matrices (L, U) and two permutation vectors (pinv, q) where P * A * Q = L * U",examples:["slu(sparse([4.5, 0, 3.2, 0; 3.1, 2.9, 0, 0.9; 0, 1.7, 3, 0; 3.5, 0.4, 0, 1]), 1, 0.001)"],seealso:["lusolve","lsolve","usolve","matrix","sparse","lup","qr"]},vBe={name:"symbolicEqual",category:"Algebra",syntax:["symbolicEqual(expr1, expr2)","symbolicEqual(expr1, expr2, options)"],description:"Returns true if the difference of the expressions simplifies to 0",examples:['symbolicEqual("x*y","y*x")','symbolicEqual("abs(x^2)", "x^2")','symbolicEqual("abs(x)", "x", {context: {abs: {trivial: true}}})'],seealso:["simplify","evaluate"]},yBe={name:"usolve",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Finds one solution of the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["usolveAll","lup","lusolve","lsolve","matrix","sparse"]},xBe={name:"usolveAll",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Finds all solutions of the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["usolve","lup","lusolve","lsolve","matrix","sparse"]},bBe={name:"abs",category:"Arithmetic",syntax:["abs(x)"],description:"Compute the absolute value.",examples:["abs(3.5)","abs(-4.2)"],seealso:["sign"]},_Be={name:"add",category:"Operators",syntax:["x + y","add(x, y)"],description:"Add two values.",examples:["a = 2.1 + 3.6","a - 3.6","3 + 2i","3 cm + 2 inch",'"2.3" + "4"'],seealso:["subtract"]},wBe={name:"cbrt",category:"Arithmetic",syntax:["cbrt(x)","cbrt(x, allRoots)"],description:"Compute the cubic root value. If x = y * y * y, then y is the cubic root of x. When `x` is a number or complex number, an optional second argument `allRoots` can be provided to return all three cubic roots. If not provided, the principal root is returned",examples:["cbrt(64)","cube(4)","cbrt(-8)","cbrt(2 + 3i)","cbrt(8i)","cbrt(8i, true)","cbrt(27 m^3)"],seealso:["square","sqrt","cube","multiply"]},EBe={name:"ceil",category:"Arithmetic",syntax:["ceil(x)","ceil(x, n)","ceil(unit, valuelessUnit)","ceil(unit, n, valuelessUnit)"],description:"Round a value towards plus infinity. If x is complex, both real and imaginary part are rounded towards plus infinity.",examples:["ceil(3.2)","ceil(3.8)","ceil(-4.2)","ceil(3.241cm, cm)","ceil(3.241cm, 2, cm)"],seealso:["floor","fix","round"]},SBe={name:"cube",category:"Arithmetic",syntax:["cube(x)"],description:"Compute the cube of a value. The cube of x is x * x * x.",examples:["cube(2)","2^3","2 * 2 * 2"],seealso:["multiply","square","pow"]},ABe={name:"divide",category:"Operators",syntax:["x / y","divide(x, y)"],description:"Divide two values.",examples:["a = 2 / 3","a * 3","4.5 / 2","3 + 4 / 2","(3 + 4) / 2","18 km / 4.5"],seealso:["multiply"]},TBe={name:"dotDivide",category:"Operators",syntax:["x ./ y","dotDivide(x, y)"],description:"Divide two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a ./ b"],seealso:["multiply","dotMultiply","divide"]},MBe={name:"dotMultiply",category:"Operators",syntax:["x .* y","dotMultiply(x, y)"],description:"Multiply two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a .* b"],seealso:["multiply","divide","dotDivide"]},CBe={name:"dotPow",category:"Operators",syntax:["x .^ y","dotPow(x, y)"],description:"Calculates the power of x to y element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","a .^ 2"],seealso:["pow"]},DBe={name:"exp",category:"Arithmetic",syntax:["exp(x)"],description:"Calculate the exponent of a value.",examples:["exp(1.3)","e ^ 1.3","log(exp(1.3))","x = 2.4","(exp(i*x) == cos(x) + i*sin(x))   # Euler's formula"],seealso:["expm","expm1","pow","log"]},NBe={name:"expm",category:"Arithmetic",syntax:["exp(x)"],description:"Compute the matrix exponential, expm(A) = e^A. The matrix must be square. Not to be confused with exp(a), which performs element-wise exponentiation.",examples:["expm([[0,2],[0,0]])"],seealso:["exp"]},RBe={name:"expm1",category:"Arithmetic",syntax:["expm1(x)"],description:"Calculate the value of subtracting 1 from the exponential value.",examples:["expm1(2)","pow(e, 2) - 1","log(expm1(2) + 1)"],seealso:["exp","pow","log"]},IBe={name:"fix",category:"Arithmetic",syntax:["fix(x)","fix(x, n)","fix(unit, valuelessUnit)","fix(unit, n, valuelessUnit)"],description:"Round a value towards zero. If x is complex, both real and imaginary part are rounded towards zero.",examples:["fix(3.2)","fix(3.8)","fix(-4.2)","fix(-4.8)","fix(3.241cm, cm)","fix(3.241cm, 2, cm)"],seealso:["ceil","floor","round"]},PBe={name:"floor",category:"Arithmetic",syntax:["floor(x)","floor(x, n)","floor(unit, valuelessUnit)","floor(unit, n, valuelessUnit)"],description:"Round a value towards minus infinity.If x is complex, both real and imaginary part are rounded towards minus infinity.",examples:["floor(3.2)","floor(3.8)","floor(-4.2)","floor(3.241cm, cm)","floor(3.241cm, 2, cm)"],seealso:["ceil","fix","round"]},FBe={name:"gcd",category:"Arithmetic",syntax:["gcd(a, b)","gcd(a, b, c, ...)"],description:"Compute the greatest common divisor.",examples:["gcd(8, 12)","gcd(-4, 6)","gcd(25, 15, -10)"],seealso:["lcm","xgcd"]},LBe={name:"hypot",category:"Arithmetic",syntax:["hypot(a, b, c, ...)","hypot([a, b, c, ...])"],description:"Calculate the hypotenuse of a list with values.",examples:["hypot(3, 4)","sqrt(3^2 + 4^2)","hypot(-2)","hypot([3, 4, 5])"],seealso:["abs","norm"]},OBe={name:"invmod",category:"Arithmetic",syntax:["invmod(a, b)"],description:"Calculate the (modular) multiplicative inverse of a modulo b. Solution to the equation ax  1 (mod b)",examples:["invmod(8, 12)","invmod(7, 13)","invmod(15151, 15122)"],seealso:["gcd","xgcd"]},kBe={name:"lcm",category:"Arithmetic",syntax:["lcm(x, y)"],description:"Compute the least common multiple.",examples:["lcm(4, 6)","lcm(6, 21)","lcm(6, 21, 5)"],seealso:["gcd"]},BBe={name:"log",category:"Arithmetic",syntax:["log(x)","log(x, base)"],description:"Compute the logarithm of a value. If no base is provided, the natural logarithm of x is calculated. If base if provided, the logarithm is calculated for the specified base. log(x, base) is defined as log(x) / log(base).",examples:["log(3.5)","a = log(2.4)","exp(a)","10 ^ 4","log(10000, 10)","log(10000) / log(10)","b = log(1024, 2)","2 ^ b"],seealso:["exp","log1p","log2","log10"]},UBe={name:"log10",category:"Arithmetic",syntax:["log10(x)"],description:"Compute the 10-base logarithm of a value.",examples:["log10(0.00001)","log10(10000)","10 ^ 4","log(10000) / log(10)","log(10000, 10)"],seealso:["exp","log"]},VBe={name:"log1p",category:"Arithmetic",syntax:["log1p(x)","log1p(x, base)"],description:"Calculate the logarithm of a `value+1`",examples:["log1p(2.5)","exp(log1p(1.4))","pow(10, 4)","log1p(9999, 10)","log1p(9999) / log(10)"],seealso:["exp","log","log2","log10"]},zBe={name:"log2",category:"Arithmetic",syntax:["log2(x)"],description:"Calculate the 2-base of a value. This is the same as calculating `log(x, 2)`.",examples:["log2(0.03125)","log2(16)","log2(16) / log2(2)","pow(2, 4)"],seealso:["exp","log1p","log","log10"]},$Be={name:"mod",category:"Operators",syntax:["x % y","x mod y","mod(x, y)"],description:"Calculates the modulus, the remainder of an integer division.",examples:["7 % 3","11 % 2","10 mod 4","isOdd(x) = x % 2","isOdd(2)","isOdd(3)"],seealso:["divide"]},HBe={name:"multiply",category:"Operators",syntax:["x * y","multiply(x, y)"],description:"multiply two values.",examples:["a = 2.1 * 3.4","a / 3.4","2 * 3 + 4","2 * (3 + 4)","3 * 2.1 km"],seealso:["divide"]},GBe={name:"norm",category:"Arithmetic",syntax:["norm(x)","norm(x, p)"],description:"Calculate the norm of a number, vector or matrix.",examples:["abs(-3.5)","norm(-3.5)","norm(3 - 4i)","norm([1, 2, -3], Infinity)","norm([1, 2, -3], -Infinity)","norm([3, 4], 2)","norm([[1, 2], [3, 4]], 1)",'norm([[1, 2], [3, 4]], "inf")','norm([[1, 2], [3, 4]], "fro")']},jBe={name:"nthRoot",category:"Arithmetic",syntax:["nthRoot(a)","nthRoot(a, root)"],description:'Calculate the nth root of a value. The principal nth root of a positive real number A, is the positive real solution of the equation "x^root = A".',examples:["4 ^ 3","nthRoot(64, 3)","nthRoot(9, 2)","sqrt(9)"],seealso:["nthRoots","pow","sqrt"]},qBe={name:"nthRoots",category:"Arithmetic",syntax:["nthRoots(A)","nthRoots(A, root)"],description:'Calculate the nth roots of a value. An nth root of a positive real number A, is a positive real solution of the equation "x^root = A". This function returns an array of complex values.',examples:["nthRoots(1)","nthRoots(1, 3)"],seealso:["sqrt","pow","nthRoot"]},WBe={name:"pow",category:"Operators",syntax:["x ^ y","pow(x, y)"],description:"Calculates the power of x to y, x^y.",examples:["2^3","2*2*2","1 + e ^ (pi * i)","pow([[1, 2], [4, 3]], 2)","pow([[1, 2], [4, 3]], -1)"],seealso:["multiply","nthRoot","nthRoots","sqrt"]},XBe={name:"round",category:"Arithmetic",syntax:["round(x)","round(x, n)","round(unit, valuelessUnit)","round(unit, n, valuelessUnit)"],description:"round a value towards the nearest integer.If x is complex, both real and imaginary part are rounded towards the nearest integer. When n is specified, the value is rounded to n decimals.",examples:["round(3.2)","round(3.8)","round(-4.2)","round(-4.8)","round(pi, 3)","round(123.45678, 2)","round(3.241cm, 2, cm)","round([3.2, 3.8, -4.7])"],seealso:["ceil","floor","fix"]},KBe={name:"sign",category:"Arithmetic",syntax:["sign(x)"],description:"Compute the sign of a value. The sign of a value x is 1 when x>0, -1 when x<0, and 0 when x=0.",examples:["sign(3.5)","sign(-4.2)","sign(0)"],seealso:["abs"]},YBe={name:"sqrt",category:"Arithmetic",syntax:["sqrt(x)"],description:"Compute the square root value. If x = y * y, then y is the square root of x.",examples:["sqrt(25)","5 * 5","sqrt(-1)"],seealso:["square","sqrtm","multiply","nthRoot","nthRoots","pow"]},QBe={name:"sqrtm",category:"Arithmetic",syntax:["sqrtm(x)"],description:"Calculate the principal square root of a square matrix. The principal square root matrix `X` of another matrix `A` is such that `X * X = A`.",examples:["sqrtm([[33, 24], [48, 57]])"],seealso:["sqrt","abs","square","multiply"]},ZBe={name:"sylvester",category:"Algebra",syntax:["sylvester(A,B,C)"],description:"Solves the real-valued Sylvester equation AX+XB=C for X",examples:["sylvester([[-1, -2], [1, 1]], [[-2, 1], [-1, 2]], [[-3, 2], [3, 0]])","A = [[-1, -2], [1, 1]]; B = [[2, -1], [1, -2]]; C = [[-3, 2], [3, 0]]","sylvester(A, B, C)"],seealso:["schur","lyap"]},JBe={name:"schur",category:"Algebra",syntax:["schur(A)"],description:"Performs a real Schur decomposition of the real matrix A = UTU'",examples:["schur([[1, 0], [-4, 3]])","A = [[1, 0], [-4, 3]]","schur(A)"],seealso:["lyap","sylvester"]},e4e={name:"lyap",category:"Algebra",syntax:["lyap(A,Q)"],description:"Solves the Continuous-time Lyapunov equation AP+PA'+Q=0 for P",examples:["lyap([[-2, 0], [1, -4]], [[3, 1], [1, 3]])","A = [[-2, 0], [1, -4]]","Q = [[3, 1], [1, 3]]","lyap(A,Q)"],seealso:["schur","sylvester"]},t4e={name:"square",category:"Arithmetic",syntax:["square(x)"],description:"Compute the square of a value. The square of x is x * x.",examples:["square(3)","sqrt(9)","3^2","3 * 3"],seealso:["multiply","pow","sqrt","cube"]},n4e={name:"subtract",category:"Operators",syntax:["x - y","subtract(x, y)"],description:"subtract two values.",examples:["a = 5.3 - 2","a + 2","2/3 - 1/6","2 * 3 - 3","2.1 km - 500m"],seealso:["add"]},r4e={name:"unaryMinus",category:"Operators",syntax:["-x","unaryMinus(x)"],description:"Inverse the sign of a value. Converts booleans and strings to numbers.",examples:["-4.5","-(-5.6)",'-"22"'],seealso:["add","subtract","unaryPlus"]},i4e={name:"unaryPlus",category:"Operators",syntax:["+x","unaryPlus(x)"],description:"Converts booleans and strings to numbers.",examples:["+true",'+"2"'],seealso:["add","subtract","unaryMinus"]},s4e={name:"xgcd",category:"Arithmetic",syntax:["xgcd(a, b)"],description:"Calculate the extended greatest common divisor for two values. The result is an array [d, x, y] with 3 entries, where d is the greatest common divisor, and d = x * a + y * b.",examples:["xgcd(8, 12)","gcd(8, 12)","xgcd(36163, 21199)"],seealso:["gcd","lcm"]},a4e={name:"bitAnd",category:"Bitwise",syntax:["x & y","bitAnd(x, y)"],description:"Bitwise AND operation. Performs the logical AND operation on each pair of the corresponding bits of the two given values by multiplying them. If both bits in the compared position are 1, the bit in the resulting binary representation is 1, otherwise, the result is 0",examples:["5 & 3","bitAnd(53, 131)","[1, 12, 31] & 42"],seealso:["bitNot","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},o4e={name:"bitNot",category:"Bitwise",syntax:["~x","bitNot(x)"],description:"Bitwise NOT operation. Performs a logical negation on each bit of the given value. Bits that are 0 become 1, and those that are 1 become 0.",examples:["~1","~2","bitNot([2, -3, 4])"],seealso:["bitAnd","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},l4e={name:"bitOr",category:"Bitwise",syntax:["x | y","bitOr(x, y)"],description:"Bitwise OR operation. Performs the logical inclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if the first bit is 1 or the second bit is 1 or both bits are 1, otherwise, the result is 0.",examples:["5 | 3","bitOr([1, 2, 3], 4)"],seealso:["bitAnd","bitNot","bitXor","leftShift","rightArithShift","rightLogShift"]},u4e={name:"bitXor",category:"Bitwise",syntax:["bitXor(x, y)"],description:"Bitwise XOR operation, exclusive OR. Performs the logical exclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but will be 0 if both are 0 or both are 1.",examples:["bitOr(1, 2)","bitXor([2, 3, 4], 4)"],seealso:["bitAnd","bitNot","bitOr","leftShift","rightArithShift","rightLogShift"]},c4e={name:"leftShift",category:"Bitwise",syntax:["x << y","leftShift(x, y)"],description:"Bitwise left logical shift of a value x by y number of bits.",examples:["4 << 1","8 >> 1"],seealso:["bitAnd","bitNot","bitOr","bitXor","rightArithShift","rightLogShift"]},h4e={name:"rightArithShift",category:"Bitwise",syntax:["x >> y","rightArithShift(x, y)"],description:"Bitwise right arithmetic shift of a value x by y number of bits.",examples:["8 >> 1","4 << 1","-12 >> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightLogShift"]},d4e={name:"rightLogShift",category:"Bitwise",syntax:["x >>> y","rightLogShift(x, y)"],description:"Bitwise right logical shift of a value x by y number of bits.",examples:["8 >>> 1","4 << 1","-12 >>> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightArithShift"]},f4e={name:"bellNumbers",category:"Combinatorics",syntax:["bellNumbers(n)"],description:"The Bell Numbers count the number of partitions of a set. A partition is a pairwise disjoint subset of S whose union is S. `bellNumbers` only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["bellNumbers(3)","bellNumbers(8)"],seealso:["stirlingS2"]},p4e={name:"catalan",category:"Combinatorics",syntax:["catalan(n)"],description:"The Catalan Numbers enumerate combinatorial structures of many different types. catalan only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["catalan(3)","catalan(8)"],seealso:["bellNumbers"]},m4e={name:"composition",category:"Combinatorics",syntax:["composition(n, k)"],description:"The composition counts of n into k parts. composition only takes integer arguments. The following condition must be enforced: k <= n.",examples:["composition(5, 3)"],seealso:["combinations"]},g4e={name:"stirlingS2",category:"Combinatorics",syntax:["stirlingS2(n, k)"],description:"The Stirling numbers of the second kind, counts the number of ways to partition a set of n labelled objects into k nonempty unlabelled subsets. `stirlingS2` only takes integer arguments. The following condition must be enforced: k <= n. If n = k or k = 1, then s(n,k) = 1.",examples:["stirlingS2(5, 3)"],seealso:["bellNumbers","bernoulli"]},v4e={name:"arg",category:"Complex",syntax:["arg(x)"],description:"Compute the argument of a complex value. If x = a+bi, the argument is computed as atan2(b, a).",examples:["arg(2 + 2i)","atan2(3, 2)","arg(2 + 3i)"],seealso:["re","im","conj","abs"]},y4e={name:"conj",category:"Complex",syntax:["conj(x)"],description:"Compute the complex conjugate of a complex value. If x = a+bi, the complex conjugate is a-bi.",examples:["conj(2 + 3i)","conj(2 - 3i)","conj(-5.2i)"],seealso:["re","im","abs","arg"]},x4e={name:"im",category:"Complex",syntax:["im(x)"],description:"Get the imaginary part of a complex number.",examples:["im(2 + 3i)","re(2 + 3i)","im(-5.2i)","im(2.4)"],seealso:["re","conj","abs","arg"]},b4e={name:"re",category:"Complex",syntax:["re(x)"],description:"Get the real part of a complex number.",examples:["re(2 + 3i)","im(2 + 3i)","re(-5.2i)","re(2.4)"],seealso:["im","conj","abs","arg"]},_4e={name:"evaluate",category:"Expression",syntax:["evaluate(expression)","evaluate(expression, scope)","evaluate([expr1, expr2, expr3, ...])","evaluate([expr1, expr2, expr3, ...], scope)"],description:"Evaluate an expression or an array with expressions.",examples:['evaluate("2 + 3")','evaluate("sqrt(16)")','evaluate("2 inch to cm")','evaluate("sin(x * pi)", { "x": 1/2 })','evaluate(["width=2", "height=4","width*height"])'],seealso:["parser","parse","compile"]},w4e={name:"parser",category:"Expression",syntax:["parser()"],description:"Create a parser object that keeps a context of variables and their values, allowing the evaluation of expressions in that context.",examples:["myParser = parser()",'myParser.evaluate("sqrt(3^2 + 4^2)")','myParser.set("x", 3)','myParser.evaluate("y = x + 3")','myParser.evaluate(["y = x + 3", "y = y + 1"])','myParser.get("y")'],seealso:["evaluate","parse","compile"]},E4e={name:"parse",category:"Expression",syntax:["parse(expr)","parse(expr, options)","parse([expr1, expr2, expr3, ...])","parse([expr1, expr2, expr3, ...], options)"],description:"Parse an expression. Returns a node tree, which can be evaluated by invoking node.evaluate() or transformed into a functional object via node.compile().",examples:['node1 = parse("sqrt(3^2 + 4^2)")',"node1.evaluate()","code1 = node1.compile()","code1.evaluate()","scope = {a: 3, b: 4}",'node2 = parse("a * b")',"node2.evaluate(scope)","code2 = node2.compile()","code2.evaluate(scope)"],seealso:["parser","evaluate","compile"]},S4e={name:"compile",category:"Expression",syntax:["compile(expr) ","compile([expr1, expr2, expr3, ...])"],description:"Parse and compile an expression. Returns a an object with a function evaluate([scope]) to evaluate the compiled expression.",examples:['code1 = compile("sqrt(3^2 + 4^2)")',"code1.evaluate() ",'code2 = compile("a * b")',"code2.evaluate({a: 3, b: 4})"],seealso:["parser","parse","evaluate"]},A4e={name:"help",category:"Expression",syntax:["help(object)","help(string)"],description:"Display documentation on a function or data type.",examples:["help(sqrt)",'help("complex")'],seealso:[]},T4e={name:"distance",category:"Geometry",syntax:["distance([x1, y1], [x2, y2])","distance([[x1, y1], [x2, y2]])"],description:"Calculates the Euclidean distance between two points.",examples:["distance([0,0], [4,4])","distance([[0,0], [4,4]])"],seealso:[]},M4e={name:"intersect",category:"Geometry",syntax:["intersect(expr1, expr2, expr3, expr4)","intersect(expr1, expr2, expr3)"],description:"Computes the intersection point of lines and/or planes.",examples:["intersect([0, 0], [10, 10], [10, 0], [0, 10])","intersect([1, 0, 1],  [4, -2, 2], [1, 1, 1, 6])"],seealso:[]},C4e={name:"and",category:"Logical",syntax:["x and y","and(x, y)"],description:"Logical and. Test whether two values are both defined with a nonzero/nonempty value.",examples:["true and false","true and true","2 and 4"],seealso:["not","or","xor"]},D4e={name:"not",category:"Logical",syntax:["not x","not(x)"],description:"Logical not. Flips the boolean value of given argument.",examples:["not true","not false","not 2","not 0"],seealso:["and","or","xor"]},N4e={name:"nullish",category:"Logical",syntax:["x ?? y","nullish(x, y)"],description:"Nullish coalescing operator. Returns the right-hand operand when the left-hand operand is null or undefined, and otherwise returns the left-hand operand.",examples:["null ?? 42","undefined ?? 42","0 ?? 42","false ?? 42","null ?? undefined ?? 42"],seealso:["and","or","not"]},R4e={name:"or",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical or. Test if at least one value is defined with a nonzero/nonempty value.",examples:["true or false","false or false","0 or 4"],seealso:["not","and","xor"]},I4e={name:"xor",category:"Logical",syntax:["x xor y","xor(x, y)"],description:"Logical exclusive or, xor. Test whether one and only one value is defined with a nonzero/nonempty value.",examples:["true xor false","false xor false","true xor true","0 xor 4"],seealso:["not","and","or"]},P4e={name:"mapSlices",category:"Matrix",syntax:["mapSlices(A, dim, callback)"],description:"Generate a matrix one dimension less than A by applying callback to each slice of A along dimension dim.",examples:["A = [[1, 2], [3, 4]]","mapSlices(A, 1, sum)","mapSlices(A, 2, prod)"],seealso:["map","forEach"]},F4e={name:"column",category:"Matrix",syntax:["column(x, index)"],description:"Return a column from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","column(A, 1)","column(A, 2)"],seealso:["row","matrixFromColumns"]},L4e={name:"concat",category:"Matrix",syntax:["concat(A, B, C, ...)","concat(A, B, C, ..., dim)"],description:"Concatenate matrices. By default, the matrices are concatenated by the last dimension. The dimension on which to concatenate can be provided as last argument.",examples:["A = [1, 2; 5, 6]","B = [3, 4; 7, 8]","concat(A, B)","concat(A, B, 1)","concat(A, B, 2)"],seealso:["det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},O4e={name:"count",category:"Matrix",syntax:["count(x)"],description:"Count the number of elements of a matrix, array or string.",examples:["a = [1, 2; 3, 4; 5, 6]","count(a)","size(a)",'count("hello world")'],seealso:["size"]},k4e={name:"cross",category:"Matrix",syntax:["cross(A, B)"],description:"Calculate the cross product for two vectors in three dimensional space.",examples:["cross([1, 1, 0],  [0, 1, 1])","cross([3, -3, 1], [4, 9, 2])","cross([2, 3, 4],  [5, 6, 7])"],seealso:["multiply","dot"]},B4e={name:"ctranspose",category:"Matrix",syntax:["x'","ctranspose(x)"],description:"Complex Conjugate and Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","ctranspose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},U4e={name:"det",category:"Matrix",syntax:["det(x)"],description:"Calculate the determinant of a matrix",examples:["det([1, 2; 3, 4])","det([-2, 2, 3; -1, 1, 3; 2, 0, -1])"],seealso:["concat","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},V4e={name:"diag",category:"Matrix",syntax:["diag(x)","diag(x, k)"],description:"Create a diagonal matrix or retrieve the diagonal of a matrix. When x is a vector, a matrix with the vector values on the diagonal will be returned. When x is a matrix, a vector with the diagonal values of the matrix is returned. When k is provided, the k-th diagonal will be filled in or retrieved, if k is positive, the values are placed on the super diagonal. When k is negative, the values are placed on the sub diagonal.",examples:["diag(1:3)","diag(1:3, 1)","a = [1, 2, 3; 4, 5, 6; 7, 8, 9]","diag(a)"],seealso:["concat","det","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},z4e={name:"diff",category:"Matrix",syntax:["diff(arr)","diff(arr, dim)"],description:["Create a new matrix or array with the difference of the passed matrix or array.","Dim parameter is optional and used to indicate the dimension of the array/matrix to apply the difference","If no dimension parameter is passed it is assumed as dimension 0","Dimension is zero-based in javascript and one-based in the parser","Arrays must be 'rectangular' meaning arrays like [1, 2]","If something is passed as a matrix it will be returned as a matrix but other than that all matrices are converted to arrays"],examples:["A = [1, 2, 4, 7, 0]","diff(A)","diff(A, 1)","B = [[1, 2], [3, 4]]","diff(B)","diff(B, 1)","diff(B, 2)","diff(B, bignumber(2))","diff([[1, 2], matrix([3, 4])], 2)"],seealso:["subtract","partitionSelect"]},$4e={name:"dot",category:"Matrix",syntax:["dot(A, B)","A * B"],description:"Calculate the dot product of two vectors. The dot product of A = [a1, a2, a3, ..., an] and B = [b1, b2, b3, ..., bn] is defined as dot(A, B) = a1 * b1 + a2 * b2 + a3 * b3 + ... + an * bn",examples:["dot([2, 4, 1], [2, 2, 3])","[2, 4, 1] * [2, 2, 3]"],seealso:["multiply","cross"]},H4e={name:"eigs",category:"Matrix",syntax:["eigs(x)"],description:"Calculate the eigenvalues and optionally eigenvectors of a square matrix",examples:["eigs([[5, 2.3], [2.3, 1]])","eigs([[1, 2, 3], [4, 5, 6], [7, 8, 9]], { precision: 1e-6, eigenvectors: false })"],seealso:["inv"]},G4e={name:"filter",category:"Matrix",syntax:["filter(x, test)"],description:"Filter items in a matrix.",examples:["isPositive(x) = x > 0","filter([6, -2, -1, 4, 3], isPositive)","filter([6, -2, 0, 1, 0], x != 0)"],seealso:["sort","map","forEach"]},j4e={name:"flatten",category:"Matrix",syntax:["flatten(x)"],description:"Flatten a multi dimensional matrix into a single dimensional matrix.",examples:["a = [1, 2, 3; 4, 5, 6]","size(a)","b = flatten(a)","size(b)"],seealso:["concat","resize","size","squeeze"]},q4e={name:"forEach",category:"Matrix",syntax:["forEach(x, callback)"],description:"Iterates over all elements of a matrix/array, and executes the given callback function.",examples:["numberOfPets = {}","addPet(n) = numberOfPets[n] = (numberOfPets[n] ? numberOfPets[n]:0 ) + 1;",'forEach(["Dog","Cat","Cat"], addPet)',"numberOfPets"],seealso:["map","sort","filter"]},W4e={name:"getMatrixDataType",category:"Matrix",syntax:["getMatrixDataType(x)"],description:'Find the data type of all elements in a matrix or array, for example "number" if all items are a number and "Complex" if all values are complex numbers. If a matrix contains more than one data type, it will return "mixed".',examples:["getMatrixDataType([1, 2, 3])","getMatrixDataType([[5 cm], [2 inch]])",'getMatrixDataType([1, "text"])',"getMatrixDataType([1, bignumber(4)])"],seealso:["matrix","sparse","typeOf"]},X4e={name:"identity",category:"Matrix",syntax:["identity(n)","identity(m, n)","identity([m, n])"],description:"Returns the identity matrix with size m-by-n. The matrix has ones on the diagonal and zeros elsewhere.",examples:["identity(3)","identity(3, 5)","a = [1, 2, 3; 4, 5, 6]","identity(size(a))"],seealso:["concat","det","diag","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},K4e={name:"inv",category:"Matrix",syntax:["inv(x)"],description:"Calculate the inverse of a matrix",examples:["inv([1, 2; 3, 4])","inv(4)","1 / 4"],seealso:["concat","det","diag","identity","ones","range","size","squeeze","subset","trace","transpose","zeros"]},Y4e={name:"pinv",category:"Matrix",syntax:["pinv(x)"],description:"Calculate the MoorePenrose inverse of a matrix",examples:["pinv([1, 2; 3, 4])","pinv([[1, 0], [0, 1], [0, 1]])","pinv(4)"],seealso:["inv"]},Q4e={name:"kron",category:"Matrix",syntax:["kron(x, y)"],description:"Calculates the Kronecker product of 2 matrices or vectors.",examples:["kron([[1, 0], [0, 1]], [[1, 2], [3, 4]])","kron([1,1], [2,3,4])"],seealso:["multiply","dot","cross"]},Z4e={name:"map",category:"Matrix",syntax:["map(x, callback)","map(x, y, ..., callback)"],description:"Create a new matrix or array with the results of the callback function executed on each entry of the matrix/array or the matrices/arrays.",examples:["map([1, 2, 3], square)","map([1, 2], [3, 4], f(a,b) = a + b)"],seealso:["filter","forEach"]},J4e={name:"matrixFromColumns",category:"Matrix",syntax:["matrixFromColumns(...arr)","matrixFromColumns(row1, row2)","matrixFromColumns(row1, row2, row3)"],description:"Create a dense matrix from vectors as individual columns.",examples:["matrixFromColumns([1, 2, 3], [[4],[5],[6]])"],seealso:["matrix","matrixFromRows","matrixFromFunction","zeros"]},eUe={name:"matrixFromFunction",category:"Matrix",syntax:["matrixFromFunction(size, fn)","matrixFromFunction(size, fn, format)","matrixFromFunction(size, fn, format, datatype)","matrixFromFunction(size, format, fn)","matrixFromFunction(size, format, datatype, fn)"],description:"Create a matrix by evaluating a generating function at each index.",examples:["f(I) = I[1] - I[2]","matrixFromFunction([3,3], f)","g(I) = I[1] - I[2] == 1 ? 4 : 0",'matrixFromFunction([100, 100], "sparse", g)',"matrixFromFunction([5], random)"],seealso:["matrix","matrixFromRows","matrixFromColumns","zeros"]},tUe={name:"matrixFromRows",category:"Matrix",syntax:["matrixFromRows(...arr)","matrixFromRows(row1, row2)","matrixFromRows(row1, row2, row3)"],description:"Create a dense matrix from vectors as individual rows.",examples:["matrixFromRows([1, 2, 3], [[4],[5],[6]])"],seealso:["matrix","matrixFromColumns","matrixFromFunction","zeros"]},nUe={name:"ones",category:"Matrix",syntax:["ones(m)","ones(m, n)","ones(m, n, p, ...)","ones([m])","ones([m, n])","ones([m, n, p, ...])"],description:"Create a matrix containing ones.",examples:["ones(3)","ones(3, 5)","ones([2,3]) * 4.5","a = [1, 2, 3; 4, 5, 6]","ones(size(a))"],seealso:["concat","det","diag","identity","inv","range","size","squeeze","subset","trace","transpose","zeros"]},rUe={name:"partitionSelect",category:"Matrix",syntax:["partitionSelect(x, k)","partitionSelect(x, k, compare)"],description:"Partition-based selection of an array or 1D matrix. Will find the kth smallest value, and mutates the input array. Uses Quickselect.",examples:["partitionSelect([5, 10, 1], 2)",'partitionSelect(["C", "B", "A", "D"], 1, compareText)',"arr = [5, 2, 1]","partitionSelect(arr, 0) # returns 1, arr is now: [1, 2, 5]","arr","partitionSelect(arr, 1, 'desc') # returns 2, arr is now: [5, 2, 1]","arr"],seealso:["sort"]},iUe={name:"range",category:"Type",syntax:["start:end","start:step:end","range(start, end)","range(start, end, step)","range(string)"],description:"Create a range. Lower bound of the range is included, upper bound is excluded.",examples:["1:5","3:-1:-3","range(3, 7)","range(0, 12, 2)",'range("4:10")',"range(1m, 1m, 3m)","a = [1, 2, 3, 4; 5, 6, 7, 8]","a[1:2, 1:2]"],seealso:["concat","det","diag","identity","inv","ones","size","squeeze","subset","trace","transpose","zeros"]},sUe={name:"reshape",category:"Matrix",syntax:["reshape(x, sizes)"],description:"Reshape a multi dimensional array to fit the specified dimensions.",examples:["reshape([1, 2, 3, 4, 5, 6], [2, 3])","reshape([[1, 2], [3, 4]], [1, 4])","reshape([[1, 2], [3, 4]], [4])","reshape([1, 2, 3, 4], [-1, 2])"],seealso:["size","squeeze","resize"]},aUe={name:"resize",category:"Matrix",syntax:["resize(x, size)","resize(x, size, defaultValue)"],description:"Resize a matrix.",examples:["resize([1,2,3,4,5], [3])","resize([1,2,3], [5])","resize([1,2,3], [5], -1)","resize(2, [2, 3])",'resize("hello", [8], "!")'],seealso:["size","subset","squeeze","reshape"]},oUe={name:"rotate",category:"Matrix",syntax:["rotate(w, theta)","rotate(w, theta, v)"],description:"Returns a 2-D rotation matrix (2x2) for a given angle (in radians). Returns a 2-D rotation matrix (3x3) of a given angle (in radians) around given axis.",examples:["rotate([1, 0], pi / 2)",'rotate(matrix([1, 0]), unit("35deg"))','rotate([1, 0, 0], unit("90deg"), [0, 0, 1])','rotate(matrix([1, 0, 0]), unit("90deg"), matrix([0, 0, 1]))'],seealso:["matrix","rotationMatrix"]},lUe={name:"rotationMatrix",category:"Matrix",syntax:["rotationMatrix(theta)","rotationMatrix(theta, v)","rotationMatrix(theta, v, format)"],description:"Returns a 2-D rotation matrix (2x2) for a given angle (in radians). Returns a 2-D rotation matrix (3x3) of a given angle (in radians) around given axis.",examples:["rotationMatrix(pi / 2)",'rotationMatrix(unit("45deg"), [0, 0, 1])','rotationMatrix(1, matrix([0, 0, 1]), "sparse")'],seealso:["cos","sin"]},uUe={name:"row",category:"Matrix",syntax:["row(x, index)"],description:"Return a row from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","row(A, 1)","row(A, 2)"],seealso:["column","matrixFromRows"]},cUe={name:"size",category:"Matrix",syntax:["size(x)"],description:"Calculate the size of a matrix.",examples:["size(2.3)",'size("hello world")',"a = [1, 2; 3, 4; 5, 6]","size(a)","size(1:6)"],seealso:["concat","count","det","diag","identity","inv","ones","range","squeeze","subset","trace","transpose","zeros"]},hUe={name:"sort",category:"Matrix",syntax:["sort(x)","sort(x, compare)"],description:'Sort the items in a matrix. Compare can be a string "asc", "desc", "natural", or a custom sort function.',examples:["sort([5, 10, 1])",'sort(["C", "B", "A", "D"], "natural")',"sortByLength(a, b) = size(a)[1] - size(b)[1]",'sort(["Langdon", "Tom", "Sara"], sortByLength)','sort(["10", "1", "2"], "natural")'],seealso:["map","filter","forEach"]},dUe={name:"squeeze",category:"Matrix",syntax:["squeeze(x)"],description:"Remove inner and outer singleton dimensions from a matrix.",examples:["a = zeros(3,2,1)","size(squeeze(a))","b = zeros(1,1,3)","size(squeeze(b))"],seealso:["concat","det","diag","identity","inv","ones","range","size","subset","trace","transpose","zeros"]},fUe={name:"subset",category:"Matrix",syntax:["value(index)","value(index) = replacement","subset(value, [index])","subset(value, [index], replacement)"],description:"Get or set a subset of the entries of a matrix or characters of a string. Indexes are one-based. There should be one index specification for each dimension of the target. Each specification can be a single index, a list of indices, or a range in colon notation `l:u`. In a range, both the lower bound l and upper bound u are included; and if a bound is omitted it defaults to the most extreme valid value. The cartesian product of the indices specified in each dimension determines the target of the operation.",examples:["d = [1, 2; 3, 4]","e = []","e[1, 1:2] = [5, 6]","e[2, :] = [7, 8]","f = d * e","f[2, 1]","f[:, 1]","f[[1,2], [1,3]] = [9, 10; 11, 12]","f"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","trace","transpose","zeros"]},pUe={name:"trace",category:"Matrix",syntax:["trace(A)"],description:"Calculate the trace of a matrix: the sum of the elements on the main diagonal of a square matrix.",examples:["A = [1, 2, 3; -1, 2, 3; 2, 0, 3]","trace(A)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","transpose","zeros"]},mUe={name:"transpose",category:"Matrix",syntax:["x'","transpose(x)"],description:"Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","transpose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},gUe={name:"zeros",category:"Matrix",syntax:["zeros(m)","zeros(m, n)","zeros(m, n, p, ...)","zeros([m])","zeros([m, n])","zeros([m, n, p, ...])"],description:"Create a matrix containing zeros.",examples:["zeros(3)","zeros(3, 5)","a = [1, 2, 3; 4, 5, 6]","zeros(size(a))"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose"]},vUe={name:"fft",category:"Matrix",syntax:["fft(x)"],description:"Calculate N-dimensional Fourier transform",examples:["fft([[1, 0], [1, 0]])"],seealso:["ifft"]},yUe={name:"ifft",category:"Matrix",syntax:["ifft(x)"],description:"Calculate N-dimensional inverse Fourier transform",examples:["ifft([[2, 2], [0, 0]])"],seealso:["fft"]},xUe={name:"bernoulli",category:"Probability",syntax:["bernoulli(n)"],description:"The nth Bernoulli number",examples:["bernoulli(4)","bernoulli(fraction(12))"],seealso:["combinations","gamma","stirlingS2"]},bUe={name:"combinations",category:"Probability",syntax:["combinations(n, k)"],description:"Compute the number of combinations of n items taken k at a time",examples:["combinations(7, 5)"],seealso:["combinationsWithRep","permutations","factorial"]},_Ue={name:"combinationsWithRep",category:"Probability",syntax:["combinationsWithRep(n, k)"],description:"Compute the number of combinations of n items taken k at a time with replacements.",examples:["combinationsWithRep(7, 5)"],seealso:["combinations","permutations","factorial"]},wUe={name:"factorial",category:"Probability",syntax:["n!","factorial(n)"],description:"Compute the factorial of a value",examples:["5!","5 * 4 * 3 * 2 * 1","3!"],seealso:["combinations","combinationsWithRep","permutations","gamma"]},EUe={name:"gamma",category:"Probability",syntax:["gamma(n)"],description:"Compute the gamma function. For small values, the Lanczos approximation is used, and for large values the extended Stirling approximation.",examples:["gamma(4)","3!","gamma(1/2)","sqrt(pi)"],seealso:["factorial"]},SUe={name:"lgamma",category:"Probability",syntax:["lgamma(n)"],description:"Logarithm of the gamma function for real, positive numbers and complex numbers, using Lanczos approximation for numbers and Stirling series for complex numbers.",examples:["lgamma(4)","lgamma(1/2)","lgamma(i)","lgamma(complex(1.1, 2))"],seealso:["gamma"]},AUe={name:"kldivergence",category:"Probability",syntax:["kldivergence(x, y)"],description:"Calculate the Kullback-Leibler (KL) divergence  between two distributions.",examples:["kldivergence([0.7,0.5,0.4], [0.2,0.9,0.5])"],seealso:[]},TUe={name:"multinomial",category:"Probability",syntax:["multinomial(A)"],description:"Multinomial Coefficients compute the number of ways of picking a1, a2, ..., ai unordered outcomes from `n` possibilities. multinomial takes one array of integers as an argument. The following condition must be enforced: every ai > 0.",examples:["multinomial([1, 2, 1])"],seealso:["combinations","factorial"]},MUe={name:"permutations",category:"Probability",syntax:["permutations(n)","permutations(n, k)"],description:"Compute the number of permutations of n items taken k at a time",examples:["permutations(5)","permutations(5, 3)"],seealso:["combinations","combinationsWithRep","factorial"]},CUe={name:"pickRandom",category:"Probability",syntax:["pickRandom(array)","pickRandom(array, number)","pickRandom(array, weights)","pickRandom(array, number, weights)","pickRandom(array, weights, number)"],description:"Pick a random entry from a given array.",examples:["pickRandom(0:10)","pickRandom([1, 3, 1, 6])","pickRandom([1, 3, 1, 6], 2)","pickRandom([1, 3, 1, 6], [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], 2, [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], [2, 3, 2, 1], 2)"],seealso:["random","randomInt"]},DUe={name:"random",category:"Probability",syntax:["random()","random(max)","random(min, max)","random(size)","random(size, max)","random(size, min, max)"],description:"Return a random number.",examples:["random()","random(10, 20)","random([2, 3])"],seealso:["pickRandom","randomInt"]},NUe={name:"randomInt",category:"Probability",syntax:["randomInt(max)","randomInt(min, max)","randomInt(size)","randomInt(size, max)","randomInt(size, min, max)"],description:"Return a random integer number",examples:["randomInt(10, 20)","randomInt([2, 3], 10)"],seealso:["pickRandom","random"]},RUe={name:"compare",category:"Relational",syntax:["compare(x, y)"],description:"Compare two values. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compare(2, 3)","compare(3, 2)","compare(2, 2)","compare(5cm, 40mm)","compare(2, [1, 2, 3])"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compareNatural","compareText"]},IUe={name:"compareNatural",category:"Relational",syntax:["compareNatural(x, y)"],description:"Compare two values of any type in a deterministic, natural way. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compareNatural(2, 3)","compareNatural(3, 2)","compareNatural(2, 2)","compareNatural(5cm, 40mm)",'compareNatural("2", "10")',"compareNatural(2 + 3i, 2 + 4i)","compareNatural([1, 2, 4], [1, 2, 3])","compareNatural([1, 5], [1, 2, 3])","compareNatural([1, 2], [1, 2])","compareNatural({a: 2}, {a: 4})"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare","compareText"]},PUe={name:"compareText",category:"Relational",syntax:["compareText(x, y)"],description:"Compare two strings lexically. Comparison is case sensitive. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:['compareText("B", "A")','compareText("A", "B")','compareText("A", "A")','compareText("2", "10")','compare("2", "10")',"compare(2, 10)",'compareNatural("2", "10")','compareText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural"]},FUe={name:"deepEqual",category:"Relational",syntax:["deepEqual(x, y)"],description:"Check equality of two matrices element wise. Returns true if the size of both matrices is equal and when and each of the elements are equal.",examples:["deepEqual([1,3,4], [1,3,4])","deepEqual([1,3,4], [1,3])"],seealso:["equal","unequal","smaller","larger","smallerEq","largerEq","compare"]},LUe={name:"equal",category:"Relational",syntax:["x == y","equal(x, y)"],description:"Check equality of two values. Returns true if the values are equal, and false if not.",examples:["2+2 == 3","2+2 == 4","a = 3.2","b = 6-2.8","a == b","50cm == 0.5m"],seealso:["unequal","smaller","larger","smallerEq","largerEq","compare","deepEqual","equalText"]},OUe={name:"equalText",category:"Relational",syntax:["equalText(x, y)"],description:"Check equality of two strings. Comparison is case sensitive. Returns true if the values are equal, and false if not.",examples:['equalText("Hello", "Hello")','equalText("a", "A")','equal("2e3", "2000")','equalText("2e3", "2000")','equalText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural","compareText","equal"]},kUe={name:"larger",category:"Relational",syntax:["x > y","larger(x, y)"],description:"Check if value x is larger than y. Returns true if x is larger than y, and false if not. Comparing a value with NaN returns false.",examples:["2 > 3","5 > 2*2","a = 3.3","b = 6-2.8","(a > b)","(b < a)","5 cm > 2 inch"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare"]},BUe={name:"largerEq",category:"Relational",syntax:["x >= y","largerEq(x, y)"],description:"Check if value x is larger or equal to y. Returns true if x is larger or equal to y, and false if not.",examples:["2 >= 1+1","2 > 1+1","a = 3.2","b = 6-2.8","(a >= b)"],seealso:["equal","unequal","smallerEq","smaller","compare"]},UUe={name:"smaller",category:"Relational",syntax:["x < y","smaller(x, y)"],description:"Check if value x is smaller than value y. Returns true if x is smaller than y, and false if not. Comparing a value with NaN returns false.",examples:["2 < 3","5 < 2*2","a = 3.3","b = 6-2.8","(a < b)","5 cm < 2 inch"],seealso:["equal","unequal","larger","smallerEq","largerEq","compare"]},VUe={name:"smallerEq",category:"Relational",syntax:["x <= y","smallerEq(x, y)"],description:"Check if value x is smaller or equal to value y. Returns true if x is smaller than y, and false if not.",examples:["2 <= 1+1","2 < 1+1","a = 3.2","b = 6-2.8","(a <= b)"],seealso:["equal","unequal","larger","smaller","largerEq","compare"]},zUe={name:"unequal",category:"Relational",syntax:["x != y","unequal(x, y)"],description:"Check unequality of two values. Returns true if the values are unequal, and false if they are equal.",examples:["2+2 != 3","2+2 != 4","a = 3.2","b = 6-2.8","a != b","50cm != 0.5m","5 cm != 2 inch"],seealso:["equal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]},$Ue={name:"setCartesian",category:"Set",syntax:["setCartesian(set1, set2)"],description:"Create the cartesian product of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays and the values will be sorted in ascending order before the operation.",examples:["setCartesian([1, 2], [3, 4])"],seealso:["setUnion","setIntersect","setDifference","setPowerset"]},HUe={name:"setDifference",category:"Set",syntax:["setDifference(set1, set2)"],description:"Create the difference of two (multi)sets: every element of set1, that is not the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setDifference([1, 2, 3, 4], [3, 4, 5, 6])","setDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setSymDifference"]},GUe={name:"setDistinct",category:"Set",syntax:["setDistinct(set)"],description:"Collect the distinct elements of a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setDistinct([1, 1, 1, 2, 2, 3])"],seealso:["setMultiplicity"]},jUe={name:"setIntersect",category:"Set",syntax:["setIntersect(set1, set2)"],description:"Create the intersection of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIntersect([1, 2, 3, 4], [3, 4, 5, 6])","setIntersect([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setDifference"]},qUe={name:"setIsSubset",category:"Set",syntax:["setIsSubset(set1, set2)"],description:"Check whether a (multi)set is a subset of another (multi)set: every element of set1 is the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIsSubset([1, 2], [3, 4, 5, 6])","setIsSubset([3, 4], [3, 4, 5, 6])"],seealso:["setUnion","setIntersect","setDifference"]},WUe={name:"setMultiplicity",category:"Set",syntax:["setMultiplicity(element, set)"],description:"Count the multiplicity of an element in a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setMultiplicity(1, [1, 2, 2, 4])","setMultiplicity(2, [1, 2, 2, 4])"],seealso:["setDistinct","setSize"]},XUe={name:"setPowerset",category:"Set",syntax:["setPowerset(set)"],description:"Create the powerset of a (multi)set: the powerset contains very possible subsets of a (multi)set. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setPowerset([1, 2, 3])"],seealso:["setCartesian"]},KUe={name:"setSize",category:"Set",syntax:["setSize(set)","setSize(set, unique)"],description:'Count the number of elements of a (multi)set. When the second parameter "unique" is true, count only the unique values. A multi-dimension array will be converted to a single-dimension array before the operation.',examples:["setSize([1, 2, 2, 4])","setSize([1, 2, 2, 4], true)"],seealso:["setUnion","setIntersect","setDifference"]},YUe={name:"setSymDifference",category:"Set",syntax:["setSymDifference(set1, set2)"],description:"Create the symmetric difference of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setSymDifference([1, 2, 3, 4], [3, 4, 5, 6])","setSymDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setDifference"]},QUe={name:"setUnion",category:"Set",syntax:["setUnion(set1, set2)"],description:"Create the union of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setUnion([1, 2, 3, 4], [3, 4, 5, 6])","setUnion([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setIntersect","setDifference"]},ZUe={name:"zpk2tf",category:"Signal",syntax:["zpk2tf(z, p, k)"],description:"Compute the transfer function of a zero-pole-gain model.",examples:["zpk2tf([1, 2], [-1, -2], 1)","zpk2tf([1, 2], [-1, -2])","zpk2tf([1 - 3i, 2 + 2i], [-1, -2])"],seealso:[]},JUe={name:"freqz",category:"Signal",syntax:["freqz(b, a)","freqz(b, a, w)"],description:"Calculates the frequency response of a filter given its numerator and denominator coefficients.",examples:["freqz([1, 2], [1, 2, 3])","freqz([1, 2], [1, 2, 3], [0, 1])","freqz([1, 2], [1, 2, 3], 512)"],seealso:[]},e5e={name:"erf",category:"Special",syntax:["erf(x)"],description:"Compute the erf function of a value using a rational Chebyshev approximations for different intervals of x",examples:["erf(0.2)","erf(-0.5)","erf(4)"],seealso:[]},t5e={name:"zeta",category:"Special",syntax:["zeta(s)"],description:"Compute the Riemann Zeta Function using an infinite series and Riemann's Functional Equation for the entire complex plane",examples:["zeta(0.2)","zeta(-0.5)","zeta(4)"],seealso:[]},n5e={name:"mad",category:"Statistics",syntax:["mad(a, b, c, ...)","mad(A)"],description:"Compute the median absolute deviation of a matrix or a list with values. The median absolute deviation is defined as the median of the absolute deviations from the median.",examples:["mad(10, 20, 30)","mad([1, 2, 3])"],seealso:["mean","median","std","abs"]},r5e={name:"max",category:"Statistics",syntax:["max(a, b, c, ...)","max(A)","max(A, dimension)"],description:"Compute the maximum value of a list of values. If any NaN values are found, the function yields the last NaN in the input.",examples:["max(2, 3, 4, 1)","max([2, 3, 4, 1])","max([2, 5; 4, 3])","max([2, 5; 4, 3], 1)","max([2, 5; 4, 3], 2)","max(2.7, 7.1, -4.5, 2.0, 4.1)","min(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["mean","median","min","prod","std","sum","variance"]},i5e={name:"mean",category:"Statistics",syntax:["mean(a, b, c, ...)","mean(A)","mean(A, dimension)"],description:"Compute the arithmetic mean of a list of values.",examples:["mean(2, 3, 4, 1)","mean([2, 3, 4, 1])","mean([2, 5; 4, 3])","mean([2, 5; 4, 3], 1)","mean([2, 5; 4, 3], 2)","mean([1.0, 2.7, 3.2, 4.0])"],seealso:["max","median","min","prod","std","sum","variance"]},s5e={name:"median",category:"Statistics",syntax:["median(a, b, c, ...)","median(A)"],description:"Compute the median of all values. The values are sorted and the middle value is returned. In case of an even number of values, the average of the two middle values is returned.",examples:["median(5, 2, 7)","median([3, -1, 5, 7])"],seealso:["max","mean","min","prod","std","sum","variance","quantileSeq"]},a5e={name:"min",category:"Statistics",syntax:["min(a, b, c, ...)","min(A)","min(A, dimension)"],description:"Compute the minimum value of a list of values. If any NaN values are found, the function yields the last NaN in the input.",examples:["min(2, 3, 4, 1)","min([2, 3, 4, 1])","min([2, 5; 4, 3])","min([2, 5; 4, 3], 1)","min([2, 5; 4, 3], 2)","min(2.7, 7.1, -4.5, 2.0, 4.1)","max(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["max","mean","median","prod","std","sum","variance"]},o5e={name:"mode",category:"Statistics",syntax:["mode(a, b, c, ...)","mode(A)","mode(A, a, b, B, c, ...)"],description:"Computes the mode of all values as an array. In case mode being more than one, multiple values are returned in an array.",examples:["mode(2, 1, 4, 3, 1)","mode([1, 2.7, 3.2, 4, 2.7])","mode(1, 4, 6, 1, 6)"],seealso:["max","mean","min","median","prod","std","sum","variance"]},l5e={name:"prod",category:"Statistics",syntax:["prod(a, b, c, ...)","prod(A)"],description:"Compute the product of all values.",examples:["prod(2, 3, 4)","prod([2, 3, 4])","prod([2, 5; 4, 3])"],seealso:["max","mean","min","median","min","std","sum","variance"]},u5e={name:"quantileSeq",category:"Statistics",syntax:["quantileSeq(A, prob[, sorted])","quantileSeq(A, [prob1, prob2, ...][, sorted])","quantileSeq(A, N[, sorted])"],description:`Compute the prob order quantile of a matrix or a list with values. The sequence is sorted and the middle value is returned. Supported types of sequence values are: Number, BigNumber, Unit Supported types of probability are: Number, BigNumber. 

In case of a (multi dimensional) array or matrix, the prob order quantile of all elements will be calculated.`,examples:["quantileSeq([3, -1, 5, 7], 0.5)","quantileSeq([3, -1, 5, 7], [1/3, 2/3])","quantileSeq([3, -1, 5, 7], 2)","quantileSeq([-1, 3, 5, 7], 0.5, true)"],seealso:["mean","median","min","max","prod","std","sum","variance"]},c5e={name:"std",category:"Statistics",syntax:["std(a, b, c, ...)","std(A)","std(A, dimension)","std(A, normalization)","std(A, dimension, normalization)"],description:'Compute the standard deviation of all values, defined as std(A) = sqrt(variance(A)). Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["std(2, 4, 6)","std([2, 4, 6, 8])",'std([2, 4, 6, 8], "uncorrected")','std([2, 4, 6, 8], "biased")',"std([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","prod","sum","variance"]},h5e={name:"cumsum",category:"Statistics",syntax:["cumsum(a, b, c, ...)","cumsum(A)"],description:"Compute the cumulative sum of all values.",examples:["cumsum(2, 3, 4, 1)","cumsum([2, 3, 4, 1])","cumsum([1, 2; 3, 4])","cumsum([1, 2; 3, 4], 1)","cumsum([1, 2; 3, 4], 2)"],seealso:["max","mean","median","min","prod","std","sum","variance"]},d5e={name:"sum",category:"Statistics",syntax:["sum(a, b, c, ...)","sum(A)","sum(A, dimension)"],description:"Compute the sum of all values.",examples:["sum(2, 3, 4, 1)","sum([2, 3, 4, 1])","sum([2, 5; 4, 3])"],seealso:["max","mean","median","min","prod","std","variance"]},f5e={name:"variance",category:"Statistics",syntax:["variance(a, b, c, ...)","variance(A)","variance(A, dimension)","variance(A, normalization)","variance(A, dimension, normalization)"],description:'Compute the variance of all values. Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["variance(2, 4, 6)","variance([2, 4, 6, 8])",'variance([2, 4, 6, 8], "uncorrected")','variance([2, 4, 6, 8], "biased")',"variance([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","std","sum"]},p5e={name:"corr",category:"Statistics",syntax:["corr(A,B)"],description:"Compute the correlation coefficient of a two list with values, For matrices, the matrix correlation coefficient is calculated.",examples:["corr([2, 4, 6, 8],[1, 2, 3, 6])","corr(matrix([[1, 2.2, 3, 4.8, 5], [1, 2, 3, 4, 5]]), matrix([[4, 5.3, 6.6, 7, 8], [1, 2, 3, 4, 5]]))"],seealso:["max","mean","min","median","min","prod","std","sum"]},m5e={name:"acos",category:"Trigonometry",syntax:["acos(x)"],description:"Compute the inverse cosine of a value in radians.",examples:["acos(0.5)","acos(cos(2.3))"],seealso:["cos","atan","asin"]},g5e={name:"acosh",category:"Trigonometry",syntax:["acosh(x)"],description:"Calculate the hyperbolic arccos of a value, defined as `acosh(x) = ln(sqrt(x^2 - 1) + x)`.",examples:["acosh(1.5)"],seealso:["cosh","asinh","atanh"]},v5e={name:"acot",category:"Trigonometry",syntax:["acot(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acot(0.5)","acot(cot(0.5))","acot(2)"],seealso:["cot","atan"]},y5e={name:"acoth",category:"Trigonometry",syntax:["acoth(x)"],description:"Calculate the inverse hyperbolic tangent of a value, defined as `acoth(x) = (ln((x+1)/x) + ln(x/(x-1))) / 2`.",examples:["acoth(2)","acoth(0.5)"],seealso:["acsch","asech"]},x5e={name:"acsc",category:"Trigonometry",syntax:["acsc(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acsc(2)","acsc(csc(0.5))","acsc(0.5)"],seealso:["csc","asin","asec"]},b5e={name:"acsch",category:"Trigonometry",syntax:["acsch(x)"],description:"Calculate the inverse hyperbolic cosecant of a value, defined as `acsch(x) = ln(1/x + sqrt(1/x^2 + 1))`.",examples:["acsch(0.5)"],seealso:["asech","acoth"]},_5e={name:"asec",category:"Trigonometry",syntax:["asec(x)"],description:"Calculate the inverse secant of a value.",examples:["asec(0.5)","asec(sec(0.5))","asec(2)"],seealso:["acos","acot","acsc"]},w5e={name:"asech",category:"Trigonometry",syntax:["asech(x)"],description:"Calculate the inverse secant of a value.",examples:["asech(0.5)"],seealso:["acsch","acoth"]},E5e={name:"asin",category:"Trigonometry",syntax:["asin(x)"],description:"Compute the inverse sine of a value in radians.",examples:["asin(0.5)","asin(sin(0.5))"],seealso:["sin","acos","atan"]},S5e={name:"asinh",category:"Trigonometry",syntax:["asinh(x)"],description:"Calculate the hyperbolic arcsine of a value, defined as `asinh(x) = ln(x + sqrt(x^2 + 1))`.",examples:["asinh(0.5)"],seealso:["acosh","atanh"]},A5e={name:"atan",category:"Trigonometry",syntax:["atan(x)"],description:"Compute the inverse tangent of a value in radians.",examples:["atan(0.5)","atan(tan(0.5))"],seealso:["tan","acos","asin"]},T5e={name:"atan2",category:"Trigonometry",syntax:["atan2(y, x)"],description:"Computes the principal value of the arc tangent of y/x in radians.",examples:["atan2(2, 2) / pi","angle = 60 deg in rad","x = cos(angle)","y = sin(angle)","atan2(y, x)"],seealso:["sin","cos","tan"]},M5e={name:"atanh",category:"Trigonometry",syntax:["atanh(x)"],description:"Calculate the hyperbolic arctangent of a value, defined as `atanh(x) = ln((1 + x)/(1 - x)) / 2`.",examples:["atanh(0.5)"],seealso:["acosh","asinh"]},C5e={name:"cos",category:"Trigonometry",syntax:["cos(x)"],description:"Compute the cosine of x in radians.",examples:["cos(2)","cos(pi / 4) ^ 2","cos(180 deg)","cos(60 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["acos","sin","tan"]},D5e={name:"cosh",category:"Trigonometry",syntax:["cosh(x)"],description:"Compute the hyperbolic cosine of x in radians.",examples:["cosh(0.5)"],seealso:["sinh","tanh","coth"]},N5e={name:"cot",category:"Trigonometry",syntax:["cot(x)"],description:"Compute the cotangent of x in radians. Defined as 1/tan(x)",examples:["cot(2)","1 / tan(2)"],seealso:["sec","csc","tan"]},R5e={name:"coth",category:"Trigonometry",syntax:["coth(x)"],description:"Compute the hyperbolic cotangent of x in radians.",examples:["coth(2)","1 / tanh(2)"],seealso:["sech","csch","tanh"]},I5e={name:"csc",category:"Trigonometry",syntax:["csc(x)"],description:"Compute the cosecant of x in radians. Defined as 1/sin(x)",examples:["csc(2)","1 / sin(2)"],seealso:["sec","cot","sin"]},P5e={name:"csch",category:"Trigonometry",syntax:["csch(x)"],description:"Compute the hyperbolic cosecant of x in radians. Defined as 1/sinh(x)",examples:["csch(2)","1 / sinh(2)"],seealso:["sech","coth","sinh"]},F5e={name:"sec",category:"Trigonometry",syntax:["sec(x)"],description:"Compute the secant of x in radians. Defined as 1/cos(x)",examples:["sec(2)","1 / cos(2)"],seealso:["cot","csc","cos"]},L5e={name:"sech",category:"Trigonometry",syntax:["sech(x)"],description:"Compute the hyperbolic secant of x in radians. Defined as 1/cosh(x)",examples:["sech(2)","1 / cosh(2)"],seealso:["coth","csch","cosh"]},O5e={name:"sin",category:"Trigonometry",syntax:["sin(x)"],description:"Compute the sine of x in radians.",examples:["sin(2)","sin(pi / 4) ^ 2","sin(90 deg)","sin(30 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["asin","cos","tan"]},k5e={name:"sinh",category:"Trigonometry",syntax:["sinh(x)"],description:"Compute the hyperbolic sine of x in radians.",examples:["sinh(0.5)"],seealso:["cosh","tanh"]},B5e={name:"tan",category:"Trigonometry",syntax:["tan(x)"],description:"Compute the tangent of x in radians.",examples:["tan(0.5)","sin(0.5) / cos(0.5)","tan(pi / 4)","tan(45 deg)"],seealso:["atan","sin","cos"]},U5e={name:"tanh",category:"Trigonometry",syntax:["tanh(x)"],description:"Compute the hyperbolic tangent of x in radians.",examples:["tanh(0.5)","sinh(0.5) / cosh(0.5)"],seealso:["sinh","cosh"]},V5e={name:"to",category:"Units",syntax:["x to unit","to(x, unit)"],description:"Change the unit of a value.",examples:["5 inch to cm","3.2kg to g","16 bytes in bits"],seealso:[]},z5e={name:"toBest",category:"Units",syntax:["toBest(x)","toBest(x, unitList)","toBest(x, unitList, options)"],description:"Converts to the most appropriate display unit.",examples:['toBest(unit(5000, "m"))','toBest(unit(3500000, "W"))','toBest(unit(0.000000123, "A"))','toBest(unit(10, "m"), "cm")','toBest(unit(10, "m"), "mm,km", {offset: 1.5})'],seealso:[]},$5e={name:"bin",category:"Utils",syntax:["bin(value)"],description:"Format a number as binary",examples:["bin(2)"],seealso:["oct","hex"]},H5e={name:"clone",category:"Utils",syntax:["clone(x)"],description:"Clone a variable. Creates a copy of primitive variables, and a deep copy of matrices",examples:["clone(3.5)","clone(2 - 4i)","clone(45 deg)","clone([1, 2; 3, 4])",'clone("hello world")'],seealso:[]},G5e={name:"format",category:"Utils",syntax:["format(value)","format(value, precision)"],description:"Format a value of any type as string.",examples:["format(2.3)","format(3 - 4i)","format([])","format(pi, 3)"],seealso:["print"]},j5e={name:"hasNumericValue",category:"Utils",syntax:["hasNumericValue(x)"],description:"Test whether a value is an numeric value. In case of a string, true is returned if the string contains a numeric value.",examples:["hasNumericValue(2)",'hasNumericValue("2")','isNumeric("2")',"hasNumericValue(0)","hasNumericValue(bignumber(500))","hasNumericValue(fraction(0.125))","hasNumericValue(2 + 3i)",'hasNumericValue([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","isNumeric"]},q5e={name:"hex",category:"Utils",syntax:["hex(value)"],description:"Format a number as hexadecimal",examples:["hex(240)"],seealso:["bin","oct"]},W5e={name:"isInteger",category:"Utils",syntax:["isInteger(x)"],description:"Test whether a value is an integer number.",examples:["isInteger(2)","isInteger(3.5)","isInteger([3, 0.5, -2])"],seealso:["isNegative","isNumeric","isPositive","isZero"]},X5e={name:"isNaN",category:"Utils",syntax:["isNaN(x)"],description:"Test whether a value is NaN (not a number)",examples:["isNaN(2)","isNaN(0 / 0)","isNaN(NaN)","isNaN(Infinity)"],seealso:["isNegative","isNumeric","isPositive","isZero","isFinite","isBounded"]},K5e={name:"isBounded",category:"Utils",syntax:["isBounded(x)"],description:"Test whether a value or its entries are bounded.",examples:["isBounded(Infinity)","isBounded(bigint(3))","isBounded([3, -Infinity, -3])"],seealso:["isFinite","isNumeric","isNaN","isNegative","isPositive"]},Y5e={name:"isFinite",category:"Utils",syntax:["isFinite(x)"],description:"Test whether a value is finite, elementwise on collections.",examples:["isFinite(Infinity)","isFinite(bigint(3))","isFinite([3, -Infinity, -3])"],seealso:["isBounded","isNumeric","isNaN","isNegative","isPositive"]},Q5e={name:"isNegative",category:"Utils",syntax:["isNegative(x)"],description:"Test whether a value is negative: smaller than zero.",examples:["isNegative(2)","isNegative(0)","isNegative(-4)","isNegative([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isPositive","isZero"]},Z5e={name:"isNumeric",category:"Utils",syntax:["isNumeric(x)"],description:"Test whether a value is a numeric value. Returns true when the input is a number, BigNumber, Fraction, or boolean.",examples:["isNumeric(2)",'isNumeric("2")','hasNumericValue("2")',"isNumeric(0)","isNumeric(bignumber(500))","isNumeric(fraction(0.125))","isNumeric(2 + 3i)",'isNumeric([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","hasNumericValue","isFinite","isBounded"]},J5e={name:"isPositive",category:"Utils",syntax:["isPositive(x)"],description:"Test whether a value is positive: larger than zero.",examples:["isPositive(2)","isPositive(0)","isPositive(-4)","isPositive([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},eVe={name:"isPrime",category:"Utils",syntax:["isPrime(x)"],description:"Test whether a value is prime: has no divisors other than itself and one.",examples:["isPrime(3)","isPrime(-2)","isPrime([2, 17, 100])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},tVe={name:"isZero",category:"Utils",syntax:["isZero(x)"],description:"Test whether a value is zero.",examples:["isZero(2)","isZero(0)","isZero(-4)","isZero([3, 0, -2, 0])"],seealso:["isInteger","isNumeric","isNegative","isPositive"]},nVe={name:"numeric",category:"Utils",syntax:["numeric(x)"],description:"Convert a numeric input to a specific numeric type: number, BigNumber, bigint, or Fraction.",examples:['numeric("4")','numeric("4", "number")','numeric("4", "bigint")','numeric("4", "BigNumber")','numeric("4", "Fraction")','numeric(4, "Fraction")','numeric(fraction(2, 5), "number")'],seealso:["number","bigint","fraction","bignumber","string","format"]},rVe={name:"oct",category:"Utils",syntax:["oct(value)"],description:"Format a number as octal",examples:["oct(56)"],seealso:["bin","hex"]},iVe={name:"print",category:"Utils",syntax:["print(template, values)","print(template, values, precision)"],description:"Interpolate values into a string template.",examples:['print("Lucy is $age years old", {age: 5})','print("The value of pi is $pi", {pi: pi}, 3)','print("Hello, $user.name!", {user: {name: "John"}})','print("Values: $1, $2, $3", [6, 9, 4])'],seealso:["format"]},sVe={name:"typeOf",category:"Utils",syntax:["typeOf(x)"],description:"Get the type of a variable.",examples:["typeOf(3.5)","typeOf(2 - 4i)","typeOf(45 deg)",'typeOf("hello world")'],seealso:["getMatrixDataType"]},aVe={name:"solveODE",category:"Numeric",syntax:["solveODE(func, tspan, y0)","solveODE(func, tspan, y0, options)"],description:"Numerical Integration of Ordinary Differential Equations.",examples:["f(t,y) = y","tspan = [0, 4]","solveODE(f, tspan, 1)","solveODE(f, tspan, [1, 2])",'solveODE(f, tspan, 1, { method:"RK23", maxStep:0.1 })'],seealso:["derivative","simplifyCore"]},oVe={bignumber:zke,bigint:$ke,boolean:Hke,complex:Gke,createUnit:jke,fraction:qke,index:Wke,matrix:Xke,number:Kke,sparse:Yke,splitUnit:Qke,string:Zke,unit:Jke,e:SG,E:SG,false:Tke,i:Mke,Infinity:Cke,LN2:Nke,LN10:Dke,LOG2E:Ike,LOG10E:Rke,NaN:Pke,null:Fke,pi:AG,PI:AG,phi:Lke,SQRT1_2:Oke,SQRT2:kke,tau:Bke,true:Uke,version:Vke,speedOfLight:{description:"Speed of light in vacuum",examples:["speedOfLight"]},gravitationConstant:{description:"Newtonian constant of gravitation",examples:["gravitationConstant"]},planckConstant:{description:"Planck constant",examples:["planckConstant"]},reducedPlanckConstant:{description:"Reduced Planck constant",examples:["reducedPlanckConstant"]},magneticConstant:{description:"Magnetic constant (vacuum permeability)",examples:["magneticConstant"]},electricConstant:{description:"Electric constant (vacuum permeability)",examples:["electricConstant"]},vacuumImpedance:{description:"Characteristic impedance of vacuum",examples:["vacuumImpedance"]},coulomb:{description:"Coulomb's constant. Deprecated in favor of coulombConstant",examples:["coulombConstant"]},coulombConstant:{description:"Coulomb's constant",examples:["coulombConstant"]},elementaryCharge:{description:"Elementary charge",examples:["elementaryCharge"]},bohrMagneton:{description:"Bohr magneton",examples:["bohrMagneton"]},conductanceQuantum:{description:"Conductance quantum",examples:["conductanceQuantum"]},inverseConductanceQuantum:{description:"Inverse conductance quantum",examples:["inverseConductanceQuantum"]},magneticFluxQuantum:{description:"Magnetic flux quantum",examples:["magneticFluxQuantum"]},nuclearMagneton:{description:"Nuclear magneton",examples:["nuclearMagneton"]},klitzing:{description:"Von Klitzing constant",examples:["klitzing"]},bohrRadius:{description:"Bohr radius",examples:["bohrRadius"]},classicalElectronRadius:{description:"Classical electron radius",examples:["classicalElectronRadius"]},electronMass:{description:"Electron mass",examples:["electronMass"]},fermiCoupling:{description:"Fermi coupling constant",examples:["fermiCoupling"]},fineStructure:{description:"Fine-structure constant",examples:["fineStructure"]},hartreeEnergy:{description:"Hartree energy",examples:["hartreeEnergy"]},protonMass:{description:"Proton mass",examples:["protonMass"]},deuteronMass:{description:"Deuteron Mass",examples:["deuteronMass"]},neutronMass:{description:"Neutron mass",examples:["neutronMass"]},quantumOfCirculation:{description:"Quantum of circulation",examples:["quantumOfCirculation"]},rydberg:{description:"Rydberg constant",examples:["rydberg"]},thomsonCrossSection:{description:"Thomson cross section",examples:["thomsonCrossSection"]},weakMixingAngle:{description:"Weak mixing angle",examples:["weakMixingAngle"]},efimovFactor:{description:"Efimov factor",examples:["efimovFactor"]},atomicMass:{description:"Atomic mass constant",examples:["atomicMass"]},avogadro:{description:"Avogadro's number",examples:["avogadro"]},boltzmann:{description:"Boltzmann constant",examples:["boltzmann"]},faraday:{description:"Faraday constant",examples:["faraday"]},firstRadiation:{description:"First radiation constant",examples:["firstRadiation"]},loschmidt:{description:"Loschmidt constant at T=273.15 K and p=101.325 kPa",examples:["loschmidt"]},gasConstant:{description:"Gas constant",examples:["gasConstant"]},molarPlanckConstant:{description:"Molar Planck constant",examples:["molarPlanckConstant"]},molarVolume:{description:"Molar volume of an ideal gas at T=273.15 K and p=101.325 kPa",examples:["molarVolume"]},sackurTetrode:{description:"Sackur-Tetrode constant at T=1 K and p=101.325 kPa",examples:["sackurTetrode"]},secondRadiation:{description:"Second radiation constant",examples:["secondRadiation"]},stefanBoltzmann:{description:"Stefan-Boltzmann constant",examples:["stefanBoltzmann"]},wienDisplacement:{description:"Wien displacement law constant",examples:["wienDisplacement"]},molarMass:{description:"Molar mass constant",examples:["molarMass"]},molarMassC12:{description:"Molar mass constant of carbon-12",examples:["molarMassC12"]},gravity:{description:"Standard acceleration of gravity (standard acceleration of free-fall on Earth)",examples:["gravity"]},planckLength:{description:"Planck length",examples:["planckLength"]},planckMass:{description:"Planck mass",examples:["planckMass"]},planckTime:{description:"Planck time",examples:["planckTime"]},planckCharge:{description:"Planck charge",examples:["planckCharge"]},planckTemperature:{description:"Planck temperature",examples:["planckTemperature"]},derivative:rBe,lsolve:sBe,lsolveAll:aBe,lup:oBe,lusolve:lBe,leafCount:iBe,polynomialRoot:uBe,resolve:dBe,simplify:fBe,simplifyConstant:pBe,simplifyCore:mBe,symbolicEqual:vBe,rationalize:hBe,slu:gBe,usolve:yBe,usolveAll:xBe,qr:cBe,abs:bBe,add:_Be,cbrt:wBe,ceil:EBe,cube:SBe,divide:ABe,dotDivide:TBe,dotMultiply:MBe,dotPow:CBe,exp:DBe,expm:NBe,expm1:RBe,fix:IBe,floor:PBe,gcd:FBe,hypot:LBe,lcm:kBe,log:BBe,log2:zBe,log1p:VBe,log10:UBe,mod:$Be,multiply:HBe,norm:GBe,nthRoot:jBe,nthRoots:qBe,pow:WBe,round:XBe,sign:KBe,sqrt:YBe,sqrtm:QBe,square:t4e,subtract:n4e,unaryMinus:r4e,unaryPlus:i4e,xgcd:s4e,invmod:OBe,bitAnd:a4e,bitNot:o4e,bitOr:l4e,bitXor:u4e,leftShift:c4e,rightArithShift:h4e,rightLogShift:d4e,bellNumbers:f4e,catalan:p4e,composition:m4e,stirlingS2:g4e,config:eBe,import:tBe,typed:nBe,arg:v4e,conj:y4e,re:b4e,im:x4e,evaluate:_4e,help:A4e,parse:E4e,parser:w4e,compile:S4e,distance:T4e,intersect:M4e,and:C4e,not:D4e,nullish:N4e,or:R4e,xor:I4e,mapSlices:P4e,concat:L4e,count:O4e,cross:k4e,column:F4e,ctranspose:B4e,det:U4e,diag:V4e,diff:z4e,dot:$4e,getMatrixDataType:W4e,identity:X4e,filter:G4e,flatten:j4e,forEach:q4e,inv:K4e,pinv:Y4e,eigs:H4e,kron:Q4e,matrixFromFunction:eUe,matrixFromRows:tUe,matrixFromColumns:J4e,map:Z4e,ones:nUe,partitionSelect:rUe,range:iUe,resize:aUe,reshape:sUe,rotate:oUe,rotationMatrix:lUe,row:uUe,size:cUe,sort:hUe,squeeze:dUe,subset:fUe,trace:pUe,transpose:mUe,zeros:gUe,fft:vUe,ifft:yUe,sylvester:ZBe,schur:JBe,lyap:e4e,solveODE:aVe,bernoulli:xUe,combinations:bUe,combinationsWithRep:_Ue,factorial:wUe,gamma:EUe,kldivergence:AUe,lgamma:SUe,multinomial:TUe,permutations:MUe,pickRandom:CUe,random:DUe,randomInt:NUe,compare:RUe,compareNatural:IUe,compareText:PUe,deepEqual:FUe,equal:LUe,equalText:OUe,larger:kUe,largerEq:BUe,smaller:UUe,smallerEq:VUe,unequal:zUe,setCartesian:$Ue,setDifference:HUe,setDistinct:GUe,setIntersect:jUe,setIsSubset:qUe,setMultiplicity:WUe,setPowerset:XUe,setSize:KUe,setSymDifference:YUe,setUnion:QUe,zpk2tf:ZUe,freqz:JUe,erf:e5e,zeta:t5e,cumsum:h5e,mad:n5e,max:r5e,mean:i5e,median:s5e,min:a5e,mode:o5e,prod:l5e,quantileSeq:u5e,std:c5e,sum:d5e,variance:f5e,corr:p5e,acos:m5e,acosh:g5e,acot:v5e,acoth:y5e,acsc:x5e,acsch:b5e,asec:_5e,asech:w5e,asin:E5e,asinh:S5e,atan:A5e,atanh:M5e,atan2:T5e,cos:C5e,cosh:D5e,cot:N5e,coth:R5e,csc:I5e,csch:P5e,sec:F5e,sech:L5e,sin:O5e,sinh:k5e,tan:B5e,tanh:U5e,to:V5e,toBest:z5e,clone:H5e,format:G5e,bin:$5e,oct:rVe,hex:q5e,isNaN:X5e,isBounded:K5e,isFinite:Y5e,isInteger:W5e,isNegative:Q5e,isNumeric:Z5e,hasNumericValue:j5e,isPositive:J5e,isPrime:eVe,isZero:tVe,print:iVe,typeOf:sVe,numeric:nVe},TG="help",lVe=["typed","mathWithTransform","Help"],uVe=ie(TG,lVe,n=>{var{typed:e,mathWithTransform:t,Help:r}=n;return e(TG,{any:function(s){var a,o=s;if(typeof s!="string"){for(a in t)if(vt(t,a)&&s===t[a]){o=a;break}}var l=Ea(oVe,o);if(!l){var u=typeof o=="function"?o.name:o;throw new Error('No documentation found on "'+u+'"')}return new r(l)}})}),MG="chain",cVe=["typed","Chain"],hVe=ie(MG,cVe,n=>{var{typed:e,Chain:t}=n;return e(MG,{"":function(){return new t},any:function(i){return new t(i)}})}),CG="det",dVe=["typed","matrix","subtractScalar","multiply","divideScalar","isZero","unaryMinus"],fVe=ie(CG,dVe,n=>{var{typed:e,matrix:t,subtractScalar:r,multiply:i,divideScalar:s,isZero:a,unaryMinus:o}=n;return e(CG,{any:function(c){return Ut(c)},"Array | Matrix":function(c){var h;switch(Dt(c)?h=c.size():Array.isArray(c)?(c=t(c),h=c.size()):h=[],h.length){case 0:return Ut(c);case 1:if(h[0]===1)return Ut(c.valueOf()[0]);if(h[0]===0)return 1;throw new RangeError("Matrix must be square (size: "+nn(h)+")");case 2:{var d=h[0],f=h[1];if(d===f)return l(c.clone().valueOf(),d);if(f===0)return 1;throw new RangeError("Matrix must be square (size: "+nn(h)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+nn(h)+")")}}});function l(u,c,h){if(c===1)return Ut(u[0][0]);if(c===2)return r(i(u[0][0],u[1][1]),i(u[1][0],u[0][1]));for(var d=!1,f=new Array(c).fill(0).map((A,T)=>T),p=0;p<c;p++){var m=f[p];if(a(u[m][p])){var y=void 0;for(y=p+1;y<c;y++)if(!a(u[f[y]][p])){m=f[y],f[y]=f[p],f[p]=m,d=!d;break}if(y===c)return u[m][p]}for(var v=u[m][p],b=p===0?1:u[f[p-1]][p-1],x=p+1;x<c;x++)for(var w=f[x],_=p+1;_<c;_++)u[w][_]=s(r(i(u[w][_],v),i(u[w][p],u[m][_])),b)}var E=u[f[c-1]][c-1];return d?o(E):E}}),DG="inv",pVe=["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],mVe=ie(DG,pVe,n=>{var{typed:e,matrix:t,divideScalar:r,addScalar:i,multiply:s,unaryMinus:a,det:o,identity:l,abs:u}=n;return e(DG,{"Array | Matrix":function(d){var f=Dt(d)?d.size():Vt(d);switch(f.length){case 1:if(f[0]===1)return Dt(d)?t([r(1,d.valueOf()[0])]):[r(1,d[0])];throw new RangeError("Matrix must be square (size: "+nn(f)+")");case 2:{var p=f[0],m=f[1];if(p===m)return Dt(d)?t(c(d.valueOf(),p,m),d.storage()):c(d,p,m);throw new RangeError("Matrix must be square (size: "+nn(f)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+nn(f)+")")}},any:function(d){return r(1,d)}});function c(h,d,f){var p,m,y,v,b;if(d===1){if(v=h[0][0],v===0)throw Error("Cannot calculate inverse, determinant is zero");return[[r(1,v)]]}else if(d===2){var x=o(h);if(x===0)throw Error("Cannot calculate inverse, determinant is zero");return[[r(h[1][1],x),r(a(h[0][1]),x)],[r(a(h[1][0]),x),r(h[0][0],x)]]}else{var w=h.concat();for(p=0;p<d;p++)w[p]=w[p].concat();for(var _=l(d).valueOf(),E=0;E<f;E++){var A=u(w[E][E]),T=E;for(p=E+1;p<d;)u(w[p][E])>A&&(A=u(w[p][E]),T=p),p++;if(A===0)throw Error("Cannot calculate inverse, determinant is zero");p=T,p!==E&&(b=w[E],w[E]=w[p],w[p]=b,b=_[E],_[E]=_[p],_[p]=b);var S=w[E],M=_[E];for(p=0;p<d;p++){var D=w[p],N=_[p];if(p!==E){if(D[E]!==0){for(y=r(a(D[E]),S[E]),m=E;m<f;m++)D[m]=i(D[m],s(y,S[m]));for(m=0;m<f;m++)N[m]=i(N[m],s(y,M[m]))}}else{for(y=S[E],m=E;m<f;m++)D[m]=r(D[m],y);for(m=0;m<f;m++)N[m]=r(N[m],y)}}}return _}}}),NG="pinv",gVe=["typed","matrix","inv","deepEqual","equal","dotDivide","dot","ctranspose","divideScalar","multiply","add","Complex"],vVe=ie(NG,gVe,n=>{var{typed:e,matrix:t,inv:r,deepEqual:i,equal:s,dotDivide:a,dot:o,ctranspose:l,divideScalar:u,multiply:c,add:h,Complex:d}=n;return e(NG,{"Array | Matrix":function(x){var w=Dt(x)?x.size():Vt(x);switch(w.length){case 1:return v(x)?l(x):w[0]===1?r(x):a(l(x),o(x,x));case 2:{if(v(x))return l(x);var _=w[0],E=w[1];if(_===E)try{return r(x)}catch(A){if(!(A instanceof Error&&A.message.match(/Cannot calculate inverse, determinant is zero/)))throw A}return Dt(x)?t(f(x.valueOf(),_,E),x.storage()):f(x,_,E)}default:throw new RangeError("Matrix must be two dimensional (size: "+nn(w)+")")}},any:function(x){return s(x,0)?Ut(x):u(1,x)}});function f(b,x,w){var{C:_,F:E}=m(b,x,w),A=c(r(c(l(_),_)),l(_)),T=c(l(E),r(c(E,l(E))));return c(T,A)}function p(b,x,w){for(var _=Ut(b),E=0,A=0;A<x;A++){if(w<=E)return _;for(var T=A;y(_[T][E]);)if(T++,x===T&&(T=A,E++,w===E))return _;[_[T],_[A]]=[_[A],_[T]];for(var S=_[A][E],M=0;M<w;M++)_[A][M]=a(_[A][M],S);for(var D=0;D<x;D++)if(D!==A){S=_[D][E];for(var N=0;N<w;N++)_[D][N]=h(_[D][N],c(-1,c(S,_[A][N])))}E++}return _}function m(b,x,w){var _=p(b,x,w),E=b.map((T,S)=>T.filter((M,D)=>D<x&&!y(o(_[D],_[D])))),A=_.filter((T,S)=>!y(o(_[S],_[S])));return{C:E,F:A}}function y(b){return s(h(b,d(1,1)),h(0,d(1,1)))}function v(b){return i(h(b,d(1,1)),h(c(b,0),d(1,1)))}});function yVe(n){var{addScalar:e,subtract:t,flatten:r,multiply:i,multiplyScalar:s,divideScalar:a,sqrt:o,abs:l,bignumber:u,diag:c,size:h,reshape:d,inv:f,qr:p,usolve:m,usolveAll:y,equal:v,complex:b,larger:x,smaller:w,matrixFromColumns:_,dot:E}=n;function A(ee,O,ue,Q){var re=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,le=T(ee,O,ue,Q,re);S(ee,O,ue,Q,re,le);var{values:te,C:Y}=M(ee,O,ue,Q,re);if(re){var oe=D(ee,O,Y,le,te,ue,Q);return{values:te,eigenvectors:oe}}return{values:te}}function T(ee,O,ue,Q,re){var le=Q==="BigNumber",te=Q==="Complex",Y=le?u(0):0,oe=le?u(1):te?b(1):1,ve=le?u(1):1,me=le?u(10):2,be=s(me,me),_e;re&&(_e=Array(O).fill(oe));for(var Be=!1;!Be;){Be=!0;for(var ze=0;ze<O;ze++){for(var tt=Y,de=Y,Xe=0;Xe<O;Xe++)ze!==Xe&&(tt=e(tt,l(ee[Xe][ze])),de=e(de,l(ee[ze][Xe])));if(!v(tt,0)&&!v(de,0)){for(var Ke=ve,se=tt,fe=a(de,me),L=s(de,me);w(se,fe);)se=s(se,be),Ke=s(Ke,me);for(;x(se,L);)se=a(se,be),Ke=a(Ke,me);var P=w(a(e(se,de),Ke),s(e(tt,de),.95));if(P){Be=!1;for(var K=a(1,Ke),ae=0;ae<O;ae++)ze!==ae&&(ee[ze][ae]=s(ee[ze][ae],K),ee[ae][ze]=s(ee[ae][ze],Ke));re&&(_e[ze]=s(_e[ze],K))}}}}return re?c(_e):null}function S(ee,O,ue,Q,re,le){var te=Q==="BigNumber",Y=Q==="Complex",oe=te?u(0):Y?b(0):0;te&&(ue=u(ue));for(var ve=0;ve<O-2;ve++){for(var me=0,be=oe,_e=ve+1;_e<O;_e++){var Be=ee[_e][ve];w(l(be),l(Be))&&(be=Be,me=_e)}if(!w(l(be),ue)){if(me!==ve+1){var ze=ee[me];ee[me]=ee[ve+1],ee[ve+1]=ze;for(var tt=0;tt<O;tt++){var de=ee[tt][me];ee[tt][me]=ee[tt][ve+1],ee[tt][ve+1]=de}if(re){var Xe=le[me];le[me]=le[ve+1],le[ve+1]=Xe}}for(var Ke=ve+2;Ke<O;Ke++){var se=a(ee[Ke][ve],be);if(se!==0){for(var fe=0;fe<O;fe++)ee[Ke][fe]=t(ee[Ke][fe],s(se,ee[ve+1][fe]));for(var L=0;L<O;L++)ee[L][ve+1]=e(ee[L][ve+1],s(se,ee[L][Ke]));if(re)for(var P=0;P<O;P++)le[Ke][P]=t(le[Ke][P],s(se,le[ve+1][P]))}}}}return le}function M(ee,O,ue,Q,re){var le=Q==="BigNumber",te=Q==="Complex",Y=le?u(1):te?b(1):1;le&&(ue=u(ue));for(var oe=Ut(ee),ve=[],me=O,be=[],_e=re?c(Array(O).fill(Y)):void 0,Be=re?c(Array(me).fill(Y)):void 0,ze=0;ze<=100;){ze+=1;for(var tt=oe[me-1][me-1],de=0;de<me;de++)oe[de][de]=t(oe[de][de],tt);var{Q:Xe,R:Ke}=p(oe);oe=i(Ke,Xe);for(var se=0;se<me;se++)oe[se][se]=e(oe[se][se],tt);if(re&&(Be=i(Be,Xe)),me===1||w(l(oe[me-1][me-2]),ue)){ze=0,ve.push(oe[me-1][me-1]),re&&(be.unshift([[1]]),z(Be,O),_e=i(_e,Be),me>1&&(Be=c(Array(me-1).fill(Y)))),me-=1,oe.pop();for(var fe=0;fe<me;fe++)oe[fe].pop()}else if(me===2||w(l(oe[me-2][me-3]),ue)){ze=0;var L=N(oe[me-2][me-2],oe[me-2][me-1],oe[me-1][me-2],oe[me-1][me-1]);ve.push(...L),re&&(be.unshift(R(oe[me-2][me-2],oe[me-2][me-1],oe[me-1][me-2],oe[me-1][me-1],L[0],L[1],ue,Q)),z(Be,O),_e=i(_e,Be),me>2&&(Be=c(Array(me-2).fill(Y)))),me-=2,oe.pop(),oe.pop();for(var P=0;P<me;P++)oe[P].pop(),oe[P].pop()}if(me===0)break}if(ve.sort((pe,ce)=>+t(l(pe),l(ce))),ze>100){var K=Error("The eigenvalues failed to converge. Only found these eigenvalues: "+ve.join(", "));throw K.values=ve,K.vectors=[],K}var ae=re?i(_e,j(be,O)):void 0;return{values:ve,C:ae}}function D(ee,O,ue,Q,re,le,te){var Y=f(ue),oe=i(Y,ee,ue),ve=te==="BigNumber",me=te==="Complex",be=ve?u(0):me?b(0):0,_e=ve?u(1):me?b(1):1,Be=[],ze=[];for(var tt of re){var de=I(Be,tt,v);de===-1?(Be.push(tt),ze.push(1)):ze[de]+=1}for(var Xe=[],Ke=Be.length,se=Array(O).fill(be),fe=c(Array(O).fill(_e)),L=function(){var ae=Be[P],pe=t(oe,i(ae,fe)),ce=y(pe,se);for(ce.shift();ce.length<ze[P];){var Ae=F(pe,O,ce,le,te);if(Ae===null)break;ce.push(Ae)}var we=i(f(Q),ue);ce=ce.map(Pe=>i(we,Pe)),Xe.push(...ce.map(Pe=>({value:ae,vector:r(Pe)})))},P=0;P<Ke;P++)L();return Xe}function N(ee,O,ue,Q){var re=e(ee,Q),le=t(s(ee,Q),s(O,ue)),te=s(re,.5),Y=s(o(t(s(re,re),s(4,le))),.5);return[e(te,Y),t(te,Y)]}function R(ee,O,ue,Q,re,le,te,Y){var oe=Y==="BigNumber",ve=Y==="Complex",me=oe?u(0):ve?b(0):0,be=oe?u(1):ve?b(1):1;if(w(l(ue),te))return[[be,me],[me,be]];if(x(l(t(re,le)),te))return[[t(re,Q),t(le,Q)],[ue,ue]];var _e=t(ee,re),Be=t(Q,re);return w(l(O),te)&&w(l(Be),te)?[[_e,be],[ue,me]]:[[O,me],[Be,be]]}function z(ee,O){for(var ue=0;ue<ee.length;ue++)ee[ue].push(...Array(O-ee[ue].length).fill(0));for(var Q=ee.length;Q<O;Q++)ee.push(Array(O).fill(0)),ee[Q][Q]=1;return ee}function j(ee,O){for(var ue=[],Q=0;Q<O;Q++)ue[Q]=Array(O).fill(0);var re=0;for(var le of ee){for(var te=le.length,Y=0;Y<te;Y++)for(var oe=0;oe<te;oe++)ue[re+Y][re+oe]=le[Y][oe];re+=te}return ue}function I(ee,O,ue){for(var Q=0;Q<ee.length;Q++)if(ue(ee[Q],O))return Q;return-1}function F(ee,O,ue,Q,re){for(var le=re==="BigNumber"?u(1e3):1e3,te,Y=0;Y<5;++Y){te=$(O,ue,re);try{te=m(ee,te)}catch{continue}if(x(Z(te),le))break}if(Y>=5)return null;for(Y=0;;){var oe=m(ee,te);if(w(Z(H(te,[oe])),Q))break;if(++Y>=10)return null;te=J(oe)}return te}function $(ee,O,ue){var Q=ue==="BigNumber",re=ue==="Complex",le=Array(ee).fill(0).map(te=>2*Math.random()-1);return Q&&(le=le.map(te=>u(te))),re&&(le=le.map(te=>b(te))),le=H(le,O),J(le,ue)}function H(ee,O){var ue=h(ee);for(var Q of O)Q=d(Q,ue),ee=t(ee,i(a(E(Q,ee),E(Q,Q)),Q));return ee}function Z(ee){return l(o(E(ee,ee)))}function J(ee,O){var ue=O==="BigNumber",Q=O==="Complex",re=ue?u(1):Q?b(1):1;return i(a(re,Z(ee)),ee)}return A}function xVe(n){var{config:e,addScalar:t,subtract:r,abs:i,atan:s,cos:a,sin:o,multiplyScalar:l,inv:u,bignumber:c,multiply:h,add:d}=n;function f(S,M){var D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.relTol,N=arguments.length>3?arguments[3]:void 0,R=arguments.length>4?arguments[4]:void 0;if(N==="number")return p(S,D,R);if(N==="BigNumber")return m(S,D,R);throw TypeError("Unsupported data type: "+N)}function p(S,M,D){var N=S.length,R=Math.abs(M/N),z,j;if(D){j=new Array(N);for(var I=0;I<N;I++)j[I]=Array(N).fill(0),j[I][I]=1}for(var F=E(S);Math.abs(F[1])>=Math.abs(R);){var $=F[0][0],H=F[0][1];z=y(S[$][$],S[H][H],S[$][H]),S=_(S,z,$,H),D&&(j=b(j,z,$,H)),F=E(S)}for(var Z=Array(N).fill(0),J=0;J<N;J++)Z[J]=S[J][J];return T(Ut(Z),j,D)}function m(S,M,D){var N=S.length,R=i(M/N),z,j;if(D){j=new Array(N);for(var I=0;I<N;I++)j[I]=Array(N).fill(0),j[I][I]=1}for(var F=A(S);i(F[1])>=i(R);){var $=F[0][0],H=F[0][1];z=v(S[$][$],S[H][H],S[$][H]),S=w(S,z,$,H),D&&(j=x(j,z,$,H)),F=A(S)}for(var Z=Array(N).fill(0),J=0;J<N;J++)Z[J]=S[J][J];return T(Ut(Z),j,D)}function y(S,M,D){var N=M-S;return Math.abs(N)<=e.relTol?Math.PI/4:.5*Math.atan(2*D/(M-S))}function v(S,M,D){var N=r(M,S);return i(N)<=e.relTol?c(-1).acos().div(4):l(.5,s(h(2,D,u(N))))}function b(S,M,D,N){for(var R=S.length,z=Math.cos(M),j=Math.sin(M),I=Array(R).fill(0),F=Array(R).fill(0),$=0;$<R;$++)I[$]=z*S[$][D]-j*S[$][N],F[$]=j*S[$][D]+z*S[$][N];for(var H=0;H<R;H++)S[H][D]=I[H],S[H][N]=F[H];return S}function x(S,M,D,N){for(var R=S.length,z=a(M),j=o(M),I=Array(R).fill(c(0)),F=Array(R).fill(c(0)),$=0;$<R;$++)I[$]=r(l(z,S[$][D]),l(j,S[$][N])),F[$]=t(l(j,S[$][D]),l(z,S[$][N]));for(var H=0;H<R;H++)S[H][D]=I[H],S[H][N]=F[H];return S}function w(S,M,D,N){for(var R=S.length,z=c(a(M)),j=c(o(M)),I=l(z,z),F=l(j,j),$=Array(R).fill(c(0)),H=Array(R).fill(c(0)),Z=h(c(2),z,j,S[D][N]),J=t(r(l(I,S[D][D]),Z),l(F,S[N][N])),ee=d(l(F,S[D][D]),Z,l(I,S[N][N])),O=0;O<R;O++)$[O]=r(l(z,S[D][O]),l(j,S[N][O])),H[O]=t(l(j,S[D][O]),l(z,S[N][O]));S[D][D]=J,S[N][N]=ee,S[D][N]=c(0),S[N][D]=c(0);for(var ue=0;ue<R;ue++)ue!==D&&ue!==N&&(S[D][ue]=$[ue],S[ue][D]=$[ue],S[N][ue]=H[ue],S[ue][N]=H[ue]);return S}function _(S,M,D,N){for(var R=S.length,z=Math.cos(M),j=Math.sin(M),I=z*z,F=j*j,$=Array(R).fill(0),H=Array(R).fill(0),Z=I*S[D][D]-2*z*j*S[D][N]+F*S[N][N],J=F*S[D][D]+2*z*j*S[D][N]+I*S[N][N],ee=0;ee<R;ee++)$[ee]=z*S[D][ee]-j*S[N][ee],H[ee]=j*S[D][ee]+z*S[N][ee];S[D][D]=Z,S[N][N]=J,S[D][N]=0,S[N][D]=0;for(var O=0;O<R;O++)O!==D&&O!==N&&(S[D][O]=$[O],S[O][D]=$[O],S[N][O]=H[O],S[O][N]=H[O]);return S}function E(S){for(var M=S.length,D=0,N=[0,1],R=0;R<M;R++)for(var z=R+1;z<M;z++)Math.abs(D)<Math.abs(S[R][z])&&(D=Math.abs(S[R][z]),N=[R,z]);return[N,D]}function A(S){for(var M=S.length,D=0,N=[0,1],R=0;R<M;R++)for(var z=R+1;z<M;z++)i(D)<i(S[R][z])&&(D=i(S[R][z]),N=[R,z]);return[N,D]}function T(S,M,D){var N=S.length,R=Array(N),z;if(D){z=Array(N);for(var j=0;j<N;j++)z[j]=Array(N)}for(var I=0;I<N;I++){for(var F=0,$=S[0],H=0;H<S.length;H++)i(S[H])<i($)&&(F=H,$=S[F]);if(R[I]=S.splice(F,1)[0],D)for(var Z=0;Z<N;Z++)z[I][Z]=M[Z][F],M[Z].splice(F,1)}if(!D)return{values:R};var J=z.map((ee,O)=>({value:R[O],vector:ee}));return{values:R,eigenvectors:J}}return f}var bVe="eigs",_Ve=["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","divideScalar","inv","bignumber","multiply","add","larger","column","flatten","number","complex","sqrt","diag","size","reshape","qr","usolve","usolveAll","im","re","smaller","matrixFromColumns","dot"],wVe=ie(bVe,_Ve,n=>{var{config:e,typed:t,matrix:r,addScalar:i,subtract:s,equal:a,abs:o,atan:l,cos:u,sin:c,multiplyScalar:h,divideScalar:d,inv:f,bignumber:p,multiply:m,add:y,larger:v,column:b,flatten:x,number:w,complex:_,sqrt:E,diag:A,size:T,reshape:S,qr:M,usolve:D,usolveAll:N,im:R,re:z,smaller:j,matrixFromColumns:I,dot:F}=n,$=xVe({config:e,addScalar:i,subtract:s,abs:o,atan:l,cos:u,sin:c,multiplyScalar:h,inv:f,bignumber:p,multiply:m,add:y}),H=yVe({addScalar:i,subtract:s,multiply:m,multiplyScalar:h,flatten:x,divideScalar:d,sqrt:E,abs:o,bignumber:p,diag:A,size:T,reshape:S,qr:M,inv:f,usolve:D,usolveAll:N,equal:a,complex:_,larger:v,smaller:j,matrixFromColumns:I,dot:F});return t("eigs",{Array:function(le){return Z(r(le))},"Array, number|BigNumber":function(le,te){return Z(r(le),{precision:te})},"Array, Object"(re,le){return Z(r(re),le)},Matrix:function(le){return Z(le,{matricize:!0})},"Matrix, number|BigNumber":function(le,te){return Z(le,{precision:te,matricize:!0})},"Matrix, Object":function(le,te){var Y={matricize:!0};return ai(Y,te),Z(le,Y)}});function Z(re){var le,te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Y="eigenvectors"in te?te.eigenvectors:!0,oe=(le=te.precision)!==null&&le!==void 0?le:e.relTol,ve=J(re,oe,Y);return te.matricize&&(ve.values=r(ve.values),Y&&(ve.eigenvectors=ve.eigenvectors.map(me=>{var{value:be,vector:_e}=me;return{value:be,vector:r(_e)}}))),Y&&Object.defineProperty(ve,"vectors",{enumerable:!1,get:()=>{throw new Error("eigs(M).vectors replaced with eigs(M).eigenvectors")}}),ve}function J(re,le,te){var Y=re.toArray(),oe=re.size();if(oe.length!==2||oe[0]!==oe[1])throw new RangeError("Matrix must be square (size: ".concat(nn(oe),")"));var ve=oe[0];if(O(Y,ve,le)&&(ue(Y,ve),ee(Y,ve,le))){var me=Q(re,Y,ve);return $(Y,ve,le,me,te)}var be=Q(re,Y,ve);return H(Y,ve,le,be,te)}function ee(re,le,te){for(var Y=0;Y<le;Y++)for(var oe=Y;oe<le;oe++)if(v(p(o(s(re[Y][oe],re[oe][Y]))),te))return!1;return!0}function O(re,le,te){for(var Y=0;Y<le;Y++)for(var oe=0;oe<le;oe++)if(v(p(o(R(re[Y][oe]))),te))return!1;return!0}function ue(re,le){for(var te=0;te<le;te++)for(var Y=0;Y<le;Y++)re[te][Y]=z(re[te][Y])}function Q(re,le,te){var Y=re.datatype();if(Y==="number"||Y==="BigNumber"||Y==="Complex")return Y;for(var oe=!1,ve=!1,me=!1,be=0;be<te;be++)for(var _e=0;_e<te;_e++){var Be=le[be][_e];if(Tt(Be)||iA(Be))oe=!0;else if(jt(Be))ve=!0;else if(Qh(Be))me=!0;else throw TypeError("Unsupported type in Matrix: "+Kn(Be))}if(ve&&me&&console.warn("Complex BigNumbers not supported, this operation will lose precission."),me){for(var ze=0;ze<te;ze++)for(var tt=0;tt<te;tt++)le[ze][tt]=_(le[ze][tt]);return"Complex"}if(ve){for(var de=0;de<te;de++)for(var Xe=0;Xe<te;Xe++)le[de][Xe]=p(le[de][Xe]);return"BigNumber"}if(oe){for(var Ke=0;Ke<te;Ke++)for(var se=0;se<te;se++)le[Ke][se]=w(le[Ke][se]);return"number"}else throw TypeError("Matrix contains unsupported types only.")}}),RG="expm",EVe=["typed","abs","add","identity","inv","multiply"],SVe=ie(RG,EVe,n=>{var{typed:e,abs:t,add:r,identity:i,inv:s,multiply:a}=n;return e(RG,{Matrix:function(h){var d=h.size();if(d.length!==2||d[0]!==d[1])throw new RangeError("Matrix must be square (size: "+nn(d)+")");for(var f=d[0],p=1e-15,m=o(h),y=l(m,p),v=y.q,b=y.j,x=a(h,Math.pow(2,-b)),w=i(f),_=i(f),E=1,A=x,T=-1,S=1;S<=v;S++)S>1&&(A=a(A,x),T=-T),E=E*(v-S+1)/((2*v-S+1)*S),w=r(w,a(E,A)),_=r(_,a(E*T,A));for(var M=a(s(_),w),D=0;D<b;D++)M=a(M,M);return jm(h)?h.createSparseMatrix(M):M}});function o(c){for(var h=c.size()[0],d=0,f=0;f<h;f++){for(var p=0,m=0;m<h;m++)p+=t(c.get([f,m]));d=Math.max(p,d)}return d}function l(c,h){for(var d=30,f=0;f<d;f++)for(var p=0;p<=f;p++){var m=f-p;if(u(c,p,m)<h)return{q:p,j:m}}throw new Error("Could not find acceptable parameters to compute the matrix exponential (try increasing maxSearchSize in expm.js)")}function u(c,h,d){for(var f=1,p=2;p<=h;p++)f*=p;for(var m=f,y=h+1;y<=2*h;y++)m*=y;var v=m*(2*h+1);return 8*Math.pow(c/Math.pow(2,d),2*h)*f*f/(m*v)}}),IG="sqrtm",AVe=["typed","abs","add","multiply","map","sqrt","subtract","inv","size","max","identity"],TVe=ie(IG,AVe,n=>{var{typed:e,abs:t,add:r,multiply:i,map:s,sqrt:a,subtract:o,inv:l,size:u,max:c,identity:h}=n,d=1e3,f=1e-6;function p(m){var y,v=0,b=m,x=h(u(m));do{var w=b;if(b=i(.5,r(w,l(x))),x=i(.5,r(x,l(w))),y=c(t(o(b,w))),y>f&&++v>d)throw new Error("computing square root of matrix: iterative method could not converge")}while(y>f);return b}return e(IG,{"Array | Matrix":function(y){var v=Dt(y)?y.size():Vt(y);switch(v.length){case 1:if(v[0]===1)return s(y,a);throw new RangeError("Matrix must be square (size: "+nn(v)+")");case 2:{var b=v[0],x=v[1];if(b===x)return p(y);throw new RangeError("Matrix must be square (size: "+nn(v)+")")}default:throw new RangeError("Matrix must be at most two dimensional (size: "+nn(v)+")")}}})}),PG="sylvester",MVe=["typed","schur","matrixFromColumns","matrix","multiply","range","concat","transpose","index","subset","add","subtract","identity","lusolve","abs"],CVe=ie(PG,MVe,n=>{var{typed:e,schur:t,matrixFromColumns:r,matrix:i,multiply:s,range:a,concat:o,transpose:l,index:u,subset:c,add:h,subtract:d,identity:f,lusolve:p,abs:m,config:y}=n;return e(PG,{"Matrix, Matrix, Matrix":v,"Array, Matrix, Matrix":function(x,w,_){return v(i(x),w,_)},"Array, Array, Matrix":function(x,w,_){return v(i(x),i(w),_)},"Array, Matrix, Array":function(x,w,_){return v(i(x),w,i(_))},"Matrix, Array, Matrix":function(x,w,_){return v(x,i(w),_)},"Matrix, Array, Array":function(x,w,_){return v(x,i(w),i(_))},"Matrix, Matrix, Array":function(x,w,_){return v(x,w,i(_))},"Array, Array, Array":function(x,w,_){return v(i(x),i(w),i(_)).toArray()}});function v(b,x,w){for(var _=x.size()[0],E=b.size()[0],A=t(b),T=A.T,S=A.U,M=t(s(-1,x)),D=M.T,N=M.U,R=s(s(l(S),w),N),z=a(0,E),j=[],I=(be,_e)=>o(be,_e,1),F=(be,_e)=>o(be,_e,0),$=0;$<_;$++)if($<_-1&&m(c(D,u($+1,$)))>1e-5){for(var H=F(c(R,u(z,[$])),c(R,u(z,[$+1]))),Z=0;Z<$;Z++)H=h(H,F(s(j[Z],c(D,u(Z,$))),s(j[Z],c(D,u(Z,$+1)))));var J=s(f(E),s(-1,c(D,u($,$)))),ee=s(f(E),s(-1,c(D,u($+1,$)))),O=s(f(E),s(-1,c(D,u($,$+1)))),ue=s(f(E),s(-1,c(D,u($+1,$+1)))),Q=F(I(h(T,J),ee),I(O,h(T,ue))),re=p(Q,H);j[$]=re.subset(u(a(0,E),[0])),j[$+1]=re.subset(u(a(E,2*E),[0])),$++}else{for(var le=c(R,u(z,[$])),te=0;te<$;te++)le=h(le,s(j[te],c(D,u(te,$))));var Y=c(D,u($,$)),oe=d(T,s(Y,f(E)));j[$]=p(oe,le)}var ve=i(r(...j)),me=s(S,s(ve,l(N)));return me}}),FG="schur",DVe=["typed","matrix","identity","multiply","qr","norm","subtract"],NVe=ie(FG,DVe,n=>{var{typed:e,matrix:t,identity:r,multiply:i,qr:s,norm:a,subtract:o}=n;return e(FG,{Array:function(c){var h=l(t(c));return{U:h.U.valueOf(),T:h.T.valueOf()}},Matrix:function(c){return l(c)}});function l(u){var c=u.size()[0],h=u,d=r(c),f=0,p;do{p=h;var m=s(h),y=m.Q,v=m.R;if(h=i(v,y),d=i(d,y),f++>100)break}while(a(o(h,p))>1e-4);return{U:d,T:h}}}),LG="lyap",RVe=["typed","matrix","sylvester","multiply","transpose"],IVe=ie(LG,RVe,n=>{var{typed:e,matrix:t,sylvester:r,multiply:i,transpose:s}=n;return e(LG,{"Matrix, Matrix":function(o,l){return r(o,s(o),i(-1,l))},"Array, Matrix":function(o,l){return r(t(o),s(t(o)),i(-1,l))},"Matrix, Array":function(o,l){return r(o,s(t(o)),t(i(-1,l)))},"Array, Array":function(o,l){return r(t(o),s(t(o)),t(i(-1,l))).toArray()}})}),PVe="divide",FVe=["typed","matrix","multiply","equalScalar","divideScalar","inv"],LVe=ie(PVe,FVe,n=>{var{typed:e,matrix:t,multiply:r,equalScalar:i,divideScalar:s,inv:a}=n,o=Rs({typed:e,equalScalar:i}),l=Rl({typed:e});return e("divide",ute({"Array | Matrix, Array | Matrix":function(c,h){return r(c,a(h))},"DenseMatrix, any":function(c,h){return l(c,h,s,!1)},"SparseMatrix, any":function(c,h){return o(c,h,s,!1)},"Array, any":function(c,h){return l(t(c),h,s,!1).valueOf()},"any, Array | Matrix":function(c,h){return r(c,a(h))}},s.signatures))}),OG="distance",OVe=["typed","addScalar","subtractScalar","divideScalar","multiplyScalar","deepEqual","sqrt","abs"],kVe=ie(OG,OVe,n=>{var{typed:e,addScalar:t,subtractScalar:r,multiplyScalar:i,divideScalar:s,deepEqual:a,sqrt:o,abs:l}=n;return e(OG,{"Array, Array, Array":function(_,E,A){if(_.length===2&&E.length===2&&A.length===2){if(!c(_))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!c(E))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!c(A))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(a(E,A))throw new TypeError("LinePoint1 should not be same with LinePoint2");var T=r(A[1],E[1]),S=r(E[0],A[0]),M=r(i(A[0],E[1]),i(E[0],A[1]));return y(_[0],_[1],T,S,M)}else throw new TypeError("Invalid Arguments: Try again")},"Object, Object, Object":function(_,E,A){if(Object.keys(_).length===2&&Object.keys(E).length===2&&Object.keys(A).length===2){if(!c(_))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!c(E))throw new TypeError("Values of lineOnePtX and lineOnePtY should be numbers or BigNumbers");if(!c(A))throw new TypeError("Values of lineTwoPtX and lineTwoPtY should be numbers or BigNumbers");if(a(p(E),p(A)))throw new TypeError("LinePoint1 should not be same with LinePoint2");if("pointX"in _&&"pointY"in _&&"lineOnePtX"in E&&"lineOnePtY"in E&&"lineTwoPtX"in A&&"lineTwoPtY"in A){var T=r(A.lineTwoPtY,E.lineOnePtY),S=r(E.lineOnePtX,A.lineTwoPtX),M=r(i(A.lineTwoPtX,E.lineOnePtY),i(E.lineOnePtX,A.lineTwoPtY));return y(_.pointX,_.pointY,T,S,M)}else throw new TypeError("Key names do not match")}else throw new TypeError("Invalid Arguments: Try again")},"Array, Array":function(_,E){if(_.length===2&&E.length===3){if(!c(_))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!h(E))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");return y(_[0],_[1],E[0],E[1],E[2])}else if(_.length===3&&E.length===6){if(!h(_))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!f(E))throw new TypeError("Array with 6 numbers or BigNumbers expected for second argument");return v(_[0],_[1],_[2],E[0],E[1],E[2],E[3],E[4],E[5])}else if(_.length===E.length&&_.length>0){if(!d(_))throw new TypeError("All values of an array should be numbers or BigNumbers");if(!d(E))throw new TypeError("All values of an array should be numbers or BigNumbers");return b(_,E)}else throw new TypeError("Invalid Arguments: Try again")},"Object, Object":function(_,E){if(Object.keys(_).length===2&&Object.keys(E).length===3){if(!c(_))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!h(E))throw new TypeError("Values of xCoeffLine, yCoeffLine and constant should be numbers or BigNumbers");if("pointX"in _&&"pointY"in _&&"xCoeffLine"in E&&"yCoeffLine"in E&&"constant"in E)return y(_.pointX,_.pointY,E.xCoeffLine,E.yCoeffLine,E.constant);throw new TypeError("Key names do not match")}else if(Object.keys(_).length===3&&Object.keys(E).length===6){if(!h(_))throw new TypeError("Values of pointX, pointY and pointZ should be numbers or BigNumbers");if(!f(E))throw new TypeError("Values of x0, y0, z0, a, b and c should be numbers or BigNumbers");if("pointX"in _&&"pointY"in _&&"x0"in E&&"y0"in E&&"z0"in E&&"a"in E&&"b"in E&&"c"in E)return v(_.pointX,_.pointY,_.pointZ,E.x0,E.y0,E.z0,E.a,E.b,E.c);throw new TypeError("Key names do not match")}else if(Object.keys(_).length===2&&Object.keys(E).length===2){if(!c(_))throw new TypeError("Values of pointOneX and pointOneY should be numbers or BigNumbers");if(!c(E))throw new TypeError("Values of pointTwoX and pointTwoY should be numbers or BigNumbers");if("pointOneX"in _&&"pointOneY"in _&&"pointTwoX"in E&&"pointTwoY"in E)return b([_.pointOneX,_.pointOneY],[E.pointTwoX,E.pointTwoY]);throw new TypeError("Key names do not match")}else if(Object.keys(_).length===3&&Object.keys(E).length===3){if(!h(_))throw new TypeError("Values of pointOneX, pointOneY and pointOneZ should be numbers or BigNumbers");if(!h(E))throw new TypeError("Values of pointTwoX, pointTwoY and pointTwoZ should be numbers or BigNumbers");if("pointOneX"in _&&"pointOneY"in _&&"pointOneZ"in _&&"pointTwoX"in E&&"pointTwoY"in E&&"pointTwoZ"in E)return b([_.pointOneX,_.pointOneY,_.pointOneZ],[E.pointTwoX,E.pointTwoY,E.pointTwoZ]);throw new TypeError("Key names do not match")}else throw new TypeError("Invalid Arguments: Try again")},Array:function(_){if(!m(_))throw new TypeError("Incorrect array format entered for pairwise distance calculation");return x(_)}});function u(w){return typeof w=="number"||jt(w)}function c(w){return w.constructor!==Array&&(w=p(w)),u(w[0])&&u(w[1])}function h(w){return w.constructor!==Array&&(w=p(w)),u(w[0])&&u(w[1])&&u(w[2])}function d(w){return Array.isArray(w)||(w=p(w)),w.every(u)}function f(w){return w.constructor!==Array&&(w=p(w)),u(w[0])&&u(w[1])&&u(w[2])&&u(w[3])&&u(w[4])&&u(w[5])}function p(w){for(var _=Object.keys(w),E=[],A=0;A<_.length;A++)E.push(w[_[A]]);return E}function m(w){if(w[0].length===2&&u(w[0][0])&&u(w[0][1])){if(w.some(_=>_.length!==2||!u(_[0])||!u(_[1])))return!1}else if(w[0].length===3&&u(w[0][0])&&u(w[0][1])&&u(w[0][2])){if(w.some(_=>_.length!==3||!u(_[0])||!u(_[1])||!u(_[2])))return!1}else return!1;return!0}function y(w,_,E,A,T){var S=l(t(t(i(E,w),i(A,_)),T)),M=o(t(i(E,E),i(A,A)));return s(S,M)}function v(w,_,E,A,T,S,M,D,N){var R=[r(i(r(T,_),N),i(r(S,E),D)),r(i(r(S,E),M),i(r(A,w),N)),r(i(r(A,w),D),i(r(T,_),M))];R=o(t(t(i(R[0],R[0]),i(R[1],R[1])),i(R[2],R[2])));var z=o(t(t(i(M,M),i(D,D)),i(N,N)));return s(R,z)}function b(w,_){for(var E=w.length,A=0,T=0,S=0;S<E;S++)T=r(w[S],_[S]),A=t(i(T,T),A);return o(A)}function x(w){for(var _=[],E=[],A=[],T=0;T<w.length-1;T++)for(var S=T+1;S<w.length;S++)w[0].length===2?(E=[w[T][0],w[T][1]],A=[w[S][0],w[S][1]]):w[0].length===3&&(E=[w[T][0],w[T][1],w[T][2]],A=[w[S][0],w[S][1],w[S][2]]),_.push(b(E,A));return _}}),BVe="intersect",UVe=["typed","config","abs","add","addScalar","matrix","multiply","multiplyScalar","divideScalar","subtract","smaller","equalScalar","flatten","isZero","isNumeric"],VVe=ie(BVe,UVe,n=>{var{typed:e,config:t,abs:r,add:i,addScalar:s,matrix:a,multiply:o,multiplyScalar:l,divideScalar:u,subtract:c,smaller:h,equalScalar:d,flatten:f,isZero:p,isNumeric:m}=n;return e("intersect",{"Array, Array, Array":y,"Array, Array, Array, Array":v,"Matrix, Matrix, Matrix":function(D,N,R){var z=y(D.valueOf(),N.valueOf(),R.valueOf());return z===null?null:a(z)},"Matrix, Matrix, Matrix, Matrix":function(D,N,R,z){var j=v(D.valueOf(),N.valueOf(),R.valueOf(),z.valueOf());return j===null?null:a(j)}});function y(M,D,N){if(M=b(M),D=b(D),N=b(N),!w(M))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!w(D))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!_(N))throw new TypeError("Array with 4 numbers expected as third argument");return S(M[0],M[1],M[2],D[0],D[1],D[2],N[0],N[1],N[2],N[3])}function v(M,D,N,R){if(M=b(M),D=b(D),N=b(N),R=b(R),M.length===2){if(!x(M))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!x(D))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!x(N))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(!x(R))throw new TypeError("Array with 2 numbers or BigNumbers expected for fourth argument");return E(M,D,N,R)}else if(M.length===3){if(!w(M))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!w(D))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!w(N))throw new TypeError("Array with 3 numbers or BigNumbers expected for third argument");if(!w(R))throw new TypeError("Array with 3 numbers or BigNumbers expected for fourth argument");return T(M[0],M[1],M[2],D[0],D[1],D[2],N[0],N[1],N[2],R[0],R[1],R[2])}else throw new TypeError("Arrays with two or thee dimensional points expected")}function b(M){return M.length===1?M[0]:M.length>1&&Array.isArray(M[0])&&M.every(D=>Array.isArray(D)&&D.length===1)?f(M):M}function x(M){return M.length===2&&m(M[0])&&m(M[1])}function w(M){return M.length===3&&m(M[0])&&m(M[1])&&m(M[2])}function _(M){return M.length===4&&m(M[0])&&m(M[1])&&m(M[2])&&m(M[3])}function E(M,D,N,R){var z=M,j=N,I=c(z,D),F=c(j,R),$=c(l(I[0],F[1]),l(F[0],I[1]));if(p($)||h(r($),t.relTol))return null;var H=l(F[0],z[1]),Z=l(F[1],z[0]),J=l(F[0],j[1]),ee=l(F[1],j[0]),O=u(s(c(c(H,Z),J),ee),$);return i(o(I,O),z)}function A(M,D,N,R,z,j,I,F,$,H,Z,J){var ee=l(c(M,D),c(N,R)),O=l(c(z,j),c(I,F)),ue=l(c($,H),c(Z,J));return s(s(ee,O),ue)}function T(M,D,N,R,z,j,I,F,$,H,Z,J){var ee=A(M,I,H,I,D,F,Z,F,N,$,J,$),O=A(H,I,R,M,Z,F,z,D,J,$,j,N),ue=A(M,I,R,M,D,F,z,D,N,$,j,N),Q=A(H,I,H,I,Z,F,Z,F,J,$,J,$),re=A(R,M,R,M,z,D,z,D,j,N,j,N),le=c(l(ee,O),l(ue,Q)),te=c(l(re,Q),l(O,O));if(p(te))return null;var Y=u(le,te),oe=u(s(ee,l(Y,O)),Q),ve=s(M,l(Y,c(R,M))),me=s(D,l(Y,c(z,D))),be=s(N,l(Y,c(j,N))),_e=s(I,l(oe,c(H,I))),Be=s(F,l(oe,c(Z,F))),ze=s($,l(oe,c(J,$)));return d(ve,_e)&&d(me,Be)&&d(be,ze)?[ve,me,be]:null}function S(M,D,N,R,z,j,I,F,$,H){var Z=l(M,I),J=l(R,I),ee=l(D,F),O=l(z,F),ue=l(N,$),Q=l(j,$),re=c(c(c(H,Z),ee),ue),le=c(c(c(s(s(J,O),Q),Z),ee),ue),te=u(re,le),Y=s(M,l(te,c(R,M))),oe=s(D,l(te,c(z,D))),ve=s(N,l(te,c(j,N)));return[Y,oe,ve]}}),kG="sum",zVe=["typed","config","add","numeric"],tre=ie(kG,zVe,n=>{var{typed:e,config:t,add:r,numeric:i}=n;return e(kG,{"Array | Matrix":s,"Array | Matrix, number | BigNumber":a,"...":function(l){if(Wb(l))throw new TypeError("Scalar values expected in function sum");return s(l)}});function s(o){var l;return kp(o,function(u){try{l=l===void 0?u:r(l,u)}catch(c){throw Ca(c,"sum",u)}}),l===void 0&&(l=i(0,t.number)),typeof l=="string"&&(l=i(l,Kp(l,t))),l}function a(o,l){try{var u=ON(o,l,r);return u}catch(c){throw Ca(c,"sum")}}}),QT="cumsum",$Ve=["typed","add","unaryPlus"],nre=ie(QT,$Ve,n=>{var{typed:e,add:t,unaryPlus:r}=n;return e(QT,{Array:i,Matrix:function(u){return u.create(i(u.valueOf(),u.datatype()))},"Array, number | BigNumber":a,"Matrix, number | BigNumber":function(u,c){return u.create(a(u.valueOf(),c),u.datatype())},"...":function(u){if(Wb(u))throw new TypeError("All values expected to be scalar in function cumsum");return i(u)}});function i(l){try{return s(l)}catch(u){throw Ca(u,QT)}}function s(l){if(l.length===0)return[];for(var u=[r(l[0])],c=1;c<l.length;++c)u.push(t(u[c-1],l[c]));return u}function a(l,u){var c=Vt(l);if(u<0||u>=c.length)throw new yu(u,c.length);try{return o(l,u)}catch(h){throw Ca(h,QT)}}function o(l,u){var c,h,d;if(u<=0){var f=l[0][0];if(Array.isArray(f)){for(d=kte(l),h=[],c=0;c<d.length;c++)h[c]=o(d[c],u-1);return h}else return s(l)}else{for(h=[],c=0;c<l.length;c++)h[c]=o(l[c],u-1);return h}}}),BG="mean",HVe=["typed","add","divide"],rre=ie(BG,HVe,n=>{var{typed:e,add:t,divide:r}=n;return e(BG,{"Array | Matrix":s,"Array | Matrix, number | BigNumber":i,"...":function(o){if(Wb(o))throw new TypeError("Scalar values expected in function mean");return s(o)}});function i(a,o){try{var l=ON(a,o,t),u=Array.isArray(a)?Vt(a):a.size();return r(l,u[o])}catch(c){throw Ca(c,"mean")}}function s(a){var o,l=0;if(kp(a,function(u){try{o=o===void 0?u:t(o,u),l++}catch(c){throw Ca(c,"mean",u)}}),l===0)throw new Error("Cannot calculate the mean of an empty array");return r(o,l)}}),UG="median",GVe=["typed","add","divide","compare","partitionSelect"],jVe=ie(UG,GVe,n=>{var{typed:e,add:t,divide:r,compare:i,partitionSelect:s}=n;function a(u){try{u=Tn(u.valueOf());var c=u.length;if(c===0)throw new Error("Cannot calculate median of an empty array");if(c%2===0){for(var h=c/2-1,d=s(u,h+1),f=u[h],p=0;p<h;++p)i(u[p],f)>0&&(f=u[p]);return l(f,d)}else{var m=s(u,(c-1)/2);return o(m)}}catch(y){throw Ca(y,"median")}}var o=e({"number | BigNumber | Complex | Unit":function(c){return c}}),l=e({"number | BigNumber | Complex | Unit, number | BigNumber | Complex | Unit":function(c,h){return r(t(c,h),2)}});return e(UG,{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(c,h){throw new Error("median(A, dim) is not yet supported")},"...":function(c){if(Wb(c))throw new TypeError("Scalar values expected in function median");return a(c)}})}),VG="mad",qVe=["typed","abs","map","median","subtract"],WVe=ie(VG,qVe,n=>{var{typed:e,abs:t,map:r,median:i,subtract:s}=n;return e(VG,{"Array | Matrix":a,"...":function(l){return a(l)}});function a(o){if(o=Tn(o.valueOf()),o.length===0)throw new Error("Cannot calculate median absolute deviation (mad) of an empty array");try{var l=i(o);return i(r(o,function(u){return t(s(u,l))}))}catch(u){throw u instanceof TypeError&&u.message.includes("median")?new TypeError(u.message.replace("median","mad")):Ca(u,"mad")}}}),eP="unbiased",zG="variance",XVe=["typed","add","subtract","multiply","divide","mapSlices","isNaN"],ire=ie(zG,XVe,n=>{var{typed:e,add:t,subtract:r,multiply:i,divide:s,mapSlices:a,isNaN:o}=n;return e(zG,{"Array | Matrix":function(h){return l(h,eP)},"Array | Matrix, string":l,"Array | Matrix, number | BigNumber":function(h,d){return u(h,d,eP)},"Array | Matrix, number | BigNumber, string":u,"...":function(h){return l(h,eP)}});function l(c,h){var d,f=0;if(c.length===0)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");if(kp(c,function(y){try{d=d===void 0?y:t(d,y),f++}catch(v){throw Ca(v,"variance",y)}}),f===0)throw new Error("Cannot calculate variance of an empty array");var p=s(d,f);if(d=void 0,kp(c,function(y){var v=r(y,p);d=d===void 0?i(v,v):t(d,i(v,v))}),o(d))return d;switch(h){case"uncorrected":return s(d,f);case"biased":return s(d,f+1);case"unbiased":{var m=jt(d)?d.mul(0):0;return f===1?m:s(d,f-1)}default:throw new Error('Unknown normalization "'+h+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}function u(c,h,d){try{if(c.length===0)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");return a(c,h,f=>l(f,d))}catch(f){throw Ca(f,"variance")}}}),$G="quantileSeq",KVe=["typed","?bignumber","add","subtract","divide","multiply","partitionSelect","compare","isInteger","smaller","smallerEq","larger","mapSlices"],sre=ie($G,KVe,n=>{var{typed:e,bignumber:t,add:r,subtract:i,divide:s,multiply:a,partitionSelect:o,compare:l,isInteger:u,smaller:c,smallerEq:h,larger:d,mapSlices:f}=n;return e($G,{"Array | Matrix, number | BigNumber":(b,x)=>m(b,x,!1),"Array | Matrix, number | BigNumber, number":(b,x,w)=>p(b,x,!1,w,m),"Array | Matrix, number | BigNumber, boolean":m,"Array | Matrix, number | BigNumber, boolean, number":(b,x,w,_)=>p(b,x,w,_,m),"Array | Matrix, Array | Matrix":(b,x)=>y(b,x,!1),"Array | Matrix, Array | Matrix, number":(b,x,w)=>p(b,x,!1,w,y),"Array | Matrix, Array | Matrix, boolean":y,"Array | Matrix, Array | Matrix, boolean, number":(b,x,w,_)=>p(b,x,w,_,y)});function p(b,x,w,_,E){return f(b,_,A=>E(A,x,w))}function m(b,x,w){var _,E=b.valueOf();if(c(x,0))throw new Error("N/prob must be non-negative");if(h(x,1))return Tt(x)?v(E,x,w):t(v(E,x,w));if(d(x,1)){if(!u(x))throw new Error("N must be a positive integer");if(d(x,4294967295))throw new Error("N must be less than or equal to 2^32-1, as that is the maximum length of an Array");var A=r(x,1);_=[];for(var T=0;c(T,x);T++){var S=s(T+1,A);_.push(v(E,S,w))}return Tt(x)?_:t(_)}}function y(b,x,w){for(var _=b.valueOf(),E=x.valueOf(),A=[],T=0;T<E.length;++T)A.push(v(_,E[T],w));return A}function v(b,x,w){var _=Tn(b),E=_.length;if(E===0)throw new Error("Cannot calculate quantile of an empty sequence");var A=Tt(x)?x*(E-1):x.times(E-1),T=Tt(x)?Math.floor(A):A.floor().toNumber(),S=Tt(x)?A%1:A.minus(T);if(u(A))return w?_[A]:o(_,Tt(x)?A:A.valueOf());var M,D;if(w)M=_[T],D=_[T+1];else{D=o(_,T+1),M=_[T];for(var N=0;N<T;++N)l(_[N],M)>0&&(M=_[N])}return r(a(M,i(1,S)),a(D,S))}}),HG="std",YVe=["typed","map","sqrt","variance"],are=ie(HG,YVe,n=>{var{typed:e,map:t,sqrt:r,variance:i}=n;return e(HG,{"Array | Matrix":s,"Array | Matrix, string":s,"Array | Matrix, number | BigNumber":s,"Array | Matrix, number | BigNumber, string":s,"...":function(o){return s(o)}});function s(a,o){if(a.length===0)throw new SyntaxError("Function std requires one or more parameters (0 provided)");try{var l=i.apply(null,arguments);return zo(l)?t(l,r):r(l)}catch(u){throw u instanceof TypeError&&u.message.includes(" variance")?new TypeError(u.message.replace(" variance"," std")):u}}}),GG="corr",QVe=["typed","matrix","mean","sqrt","sum","add","subtract","multiply","pow","divide"],ZVe=ie(GG,QVe,n=>{var{typed:e,matrix:t,sqrt:r,sum:i,add:s,subtract:a,multiply:o,pow:l,divide:u}=n;return e(GG,{"Array, Array":function(f,p){return c(f,p)},"Matrix, Matrix":function(f,p){var m=c(f.toArray(),p.toArray());return Array.isArray(m)?t(m):m}});function c(d,f){var p=[];if(Array.isArray(d[0])&&Array.isArray(f[0])){if(d.length!==f.length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same length.");for(var m=0;m<d.length;m++){if(d[m].length!==f[m].length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same number of elements.");p.push(h(d[m],f[m]))}return p}else{if(d.length!==f.length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same number of elements.");return h(d,f)}}function h(d,f){var p=d.length,m=i(d),y=i(f),v=d.reduce((E,A,T)=>s(E,o(A,f[T])),0),b=i(d.map(E=>l(E,2))),x=i(f.map(E=>l(E,2))),w=a(o(p,v),o(m,y)),_=r(o(a(o(p,b),l(m,2)),a(o(p,x),l(y,2))));return u(w,_)}}),jG="bernoulli",JVe=["typed","config","isInteger","number","?BigNumber","?Fraction"],e6e=ie(jG,JVe,n=>{var{typed:e,config:t,number:r,BigNumber:i,Fraction:s}=n,a=[void 0],o=[void 0],l=[void 0],u=50;return e(jG,{number:c=>tP(c,h=>h,a,(h,d)=>h+d,(h,d)=>h*d,(h,d)=>h/d),"bigint | Fraction":c=>tP(r(c),h=>new s(h),o,(h,d)=>h.add(d),(h,d)=>h.mul(d),(h,d)=>h.div(d)),BigNumber:c=>(t.precision!==u&&(l=[void 0],u=t.precision),tP(r(c),h=>new i(h),l,(h,d)=>h.add(d),(h,d)=>h.mul(d),(h,d)=>h.div(d)))})});function tP(n,e,t,r,i,s){if(n<0||!bt(n))throw new RangeError("Bernoulli index must be nonnegative integer");if(n===0)return e(1);if(n===1)return s(e(-1),e(2));if(n%2===1)return e(0);var a=e(1);t.length===1&&t.push([s(a,e(-3)),s(a,e(-2)),s(a,e(6))]);for(var o=n/2,l=e(0),u=e(2);t.length<=o;){for(var c=t.length,h=Math.floor((c+1)/2),d=l,f=1;f<h;++f)d=r(d,i(t[f][0],t[c-f][0]));d=i(d,u),c%2===0&&(d=r(d,i(t[h][0],t[h][0]))),d=s(d,e(-(2*c+1)));var p=s(i(t[c-1][1],e(-c*(2*c-1))),u);t.push([d,p,i(p,d)])}return t[o][2]}var qG="combinations",t6e=["typed"],n6e=ie(qG,t6e,n=>{var{typed:e}=n;return e(qG,{"number, number":ine,"BigNumber, BigNumber":function(r,i){var s=r.constructor,a,o,l=r.minus(i),u=new s(1);if(!WG(r)||!WG(i))throw new TypeError("Positive integer value expected in function combinations");if(i.gt(r))throw new TypeError("k must be less than n in function combinations");if(a=u,i.lt(l))for(o=u;o.lte(l);o=o.plus(u))a=a.times(i.plus(o)).dividedBy(o);else for(o=u;o.lte(i);o=o.plus(u))a=a.times(l.plus(o)).dividedBy(o);return a}})});function WG(n){return n.isInteger()&&n.gte(0)}var XG="combinationsWithRep",r6e=["typed"],i6e=ie(XG,r6e,n=>{var{typed:e}=n;return e(XG,{"number, number":function(r,i){if(!bt(r)||r<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(!bt(i)||i<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(r<1)throw new TypeError("k must be less than or equal to n + k - 1");if(i<r-1){var s=Gh(r,r+i-1);return s/Gh(1,i)}var a=Gh(i+1,r+i-1);return a/Gh(1,r-1)},"BigNumber, BigNumber":function(r,i){var s=r.constructor,a,o,l=new s(1),u=r.minus(l);if(!KG(r)||!KG(i))throw new TypeError("Positive integer value expected in function combinationsWithRep");if(r.lt(l))throw new TypeError("k must be less than or equal to n + k - 1 in function combinationsWithRep");if(a=l,i.lt(u))for(o=l;o.lte(u);o=o.plus(l))a=a.times(i.plus(o)).dividedBy(o);else for(o=l;o.lte(i);o=o.plus(l))a=a.times(u.plus(o)).dividedBy(o);return a}})});function KG(n){return n.isInteger()&&n.gte(0)}var YG="gamma",s6e=["typed","config","multiplyScalar","pow","BigNumber","Complex"],a6e=ie(YG,s6e,n=>{var{typed:e,config:t,multiplyScalar:r,pow:i,BigNumber:s,Complex:a}=n;function o(u){if(u.im===0)return HD(u.re);if(u.re<.5){var c=new a(1-u.re,-u.im),h=new a(Math.PI*u.re,Math.PI*u.im);return new a(Math.PI).div(h.sin()).div(o(c))}u=new a(u.re-1,u.im);for(var d=new a(Cy[0],0),f=1;f<Cy.length;++f){var p=new a(Cy[f],0);d=d.add(p.div(u.add(f)))}var m=new a(u.re+ane+.5,u.im),y=Math.sqrt(2*Math.PI),v=m.pow(u.add(.5)),b=m.neg().exp();return d.mul(y).mul(v).mul(b)}return e(YG,{number:HD,Complex:o,BigNumber:function(c){if(c.isInteger())return c.isNegative()||c.isZero()?new s(1/0):l(c.minus(1));if(!c.isFinite())return new s(c.isNegative()?NaN:1/0);throw new Error("Integer BigNumber expected")}});function l(u){if(u<8)return new s([1,1,2,6,24,120,720,5040][u]);var c=t.precision+(Math.log(u.toNumber())|0),h=s.clone({precision:c});if(u%2===1)return u.times(l(new s(u-1)));for(var d=u,f=new h(u),p=u.toNumber();d>2;)d-=2,p+=d,f=f.times(p);return new s(f.toPrecision(s.precision))}}),QG="lgamma",o6e=["Complex","typed"],l6e=ie(QG,o6e,n=>{var{Complex:e,typed:t}=n,r=7,i=7,s=[-.029550653594771242,.00641025641025641,-.0019175269175269176,.0008417508417508417,-.0005952380952380953,.0007936507936507937,-.002777777777777778,.08333333333333333];return t(QG,{number:GD,Complex:a,BigNumber:function(){throw new Error("mathjs doesn't yet provide an implementation of the algorithm lgamma for BigNumber")}});function a(u){var c=6.283185307179586,h=1.1447298858494002,d=.1;if(u.isNaN())return new e(NaN,NaN);if(u.im===0)return new e(GD(u.re),0);if(u.re>=r||Math.abs(u.im)>=i)return o(u);if(u.re<=d){var f=PMe(c,u.im)*Math.floor(.5*u.re+.25),p=u.mul(Math.PI).sin().log(),m=a(new e(1-u.re,-u.im));return new e(h,f).sub(p).sub(m)}else return u.im>=0?l(u):l(u.conjugate()).conjugate()}function o(u){for(var c=u.sub(.5).mul(u.log()).sub(u).add(one),h=new e(1,0).div(u),d=h.div(u),f=s[0],p=s[1],m=2*d.re,y=d.re*d.re+d.im*d.im,v=2;v<8;v++){var b=p;p=-y*f+s[v],f=m*f+b}var x=h.mul(d.mul(f).add(p));return c.add(x)}function l(u){var c=0,h=0,d=u;for(u=u.add(1);u.re<=r;){d=d.mul(u);var f=d.im<0?1:0;f!==0&&h===0&&c++,h=f,u=u.add(1)}return o(u).sub(d.log()).sub(new e(0,c*2*Math.PI*1))}}),ZG="factorial",u6e=["typed","gamma"],c6e=ie(ZG,u6e,n=>{var{typed:e,gamma:t}=n;return e(ZG,{number:function(i){if(i<0)throw new Error("Value must be non-negative");return t(i+1)},BigNumber:function(i){if(i.isNegative())throw new Error("Value must be non-negative");return t(i.plus(1))},"Array | Matrix":e.referToSelf(r=>i=>qt(i,r))})}),JG="kldivergence",h6e=["typed","matrix","divide","sum","multiply","map","dotDivide","log","isNumeric"],d6e=ie(JG,h6e,n=>{var{typed:e,matrix:t,divide:r,sum:i,multiply:s,map:a,dotDivide:o,log:l,isNumeric:u}=n;return e(JG,{"Array, Array":function(d,f){return c(t(d),t(f))},"Matrix, Array":function(d,f){return c(d,t(f))},"Array, Matrix":function(d,f){return c(t(d),f)},"Matrix, Matrix":function(d,f){return c(d,f)}});function c(h,d){var f=d.size().length,p=h.size().length;if(f>1)throw new Error("first object must be one dimensional");if(p>1)throw new Error("second object must be one dimensional");if(f!==p)throw new Error("Length of two vectors must be equal");var m=i(h);if(m===0)throw new Error("Sum of elements in first object must be non zero");var y=i(d);if(y===0)throw new Error("Sum of elements in second object must be non zero");var v=r(h,i(h)),b=r(d,i(d)),x=i(s(v,a(o(v,b),w=>l(w))));return u(x)?x:Number.NaN}}),ej="multinomial",f6e=["typed","add","divide","multiply","factorial","isInteger","isPositive"],p6e=ie(ej,f6e,n=>{var{typed:e,add:t,divide:r,multiply:i,factorial:s,isInteger:a,isPositive:o}=n;return e(ej,{"Array | Matrix":function(u){var c=0,h=1;return kp(u,function(d){if(!a(d)||!o(d))throw new TypeError("Positive integer value expected in function multinomial");c=t(c,d),h=i(h,s(d))}),r(s(c),h)}})}),tj="permutations",m6e=["typed","factorial"],g6e=ie(tj,m6e,n=>{var{typed:e,factorial:t}=n;return e(tj,{"number | BigNumber":t,"number, number":function(i,s){if(!bt(i)||i<0)throw new TypeError("Positive integer value expected in function permutations");if(!bt(s)||s<0)throw new TypeError("Positive integer value expected in function permutations");if(s>i)throw new TypeError("second argument k must be less than or equal to first argument n");return Gh(i-s+1,i)},"BigNumber, BigNumber":function(i,s){var a,o;if(!nj(i)||!nj(s))throw new TypeError("Positive integer value expected in function permutations");if(s.gt(i))throw new TypeError("second argument k must be less than or equal to first argument n");var l=i.mul(0).add(1);for(a=l,o=i.minus(s).plus(1);o.lte(i);o=o.plus(1))a=a.times(o);return a}})});function nj(n){return n.isInteger()&&n.gte(0)}var aU={exports:{}};aU.exports;(function(n){(function(e,t,r){function i(l){var u=this,c=o();u.next=function(){var h=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=h|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function s(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function a(l,u){var c=new i(l),h=u&&u.state,d=c.next;return d.int32=function(){return c.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,h&&(typeof h=="object"&&s(h,c),d.state=function(){return s(c,{})}),d}function o(){var l=4022871197,u=function(c){c=String(c);for(var h=0;h<c.length;h++){l+=c.charCodeAt(h);var d=.02519603282416938*l;l=d>>>0,d-=l,d*=l,l=d>>>0,d-=l,l+=d*4294967296}return(l>>>0)*23283064365386963e-26};return u}t&&t.exports?t.exports=a:this.alea=a})(Iv,n)})(aU);var v6e=aU.exports,oU={exports:{}};oU.exports;(function(n){(function(e,t,r){function i(o){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},o===(o|0)?l.x=o:u+=o;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function s(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function a(o,l){var u=new i(o),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&s(c,u),h.state=function(){return s(u,{})}),h}t&&t.exports?t.exports=a:this.xor128=a})(Iv,n)})(oU);var y6e=oU.exports,lU={exports:{}};lU.exports;(function(n){(function(e,t,r){function i(o){var l=this,u="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:u+=o;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function s(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function a(o,l){var u=new i(o),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&s(c,u),h.state=function(){return s(u,{})}),h}t&&t.exports?t.exports=a:this.xorwow=a})(Iv,n)})(lU);var x6e=lU.exports,uU={exports:{}};uU.exports;(function(n){(function(e,t,r){function i(o){var l=this;l.next=function(){var c=l.x,h=l.i,d,f;return d=c[h],d^=d>>>7,f=d^d<<24,d=c[h+1&7],f^=d^d>>>10,d=c[h+3&7],f^=d^d>>>3,d=c[h+4&7],f^=d^d<<7,d=c[h+7&7],d=d^d<<13,f^=d^d<<9,c[h]=f,l.i=h+1&7,f};function u(c,h){var d,f=[];if(h===(h|0))f[0]=h;else for(h=""+h,d=0;d<h.length;++d)f[d&7]=f[d&7]<<15^h.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],c.x=f,c.i=0,d=256;d>0;--d)c.next()}u(l,o)}function s(o,l){return l.x=o.x.slice(),l.i=o.i,l}function a(o,l){o==null&&(o=+new Date);var u=new i(o),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(c.x&&s(c,u),h.state=function(){return s(u,{})}),h}t&&t.exports?t.exports=a:this.xorshift7=a})(Iv,n)})(uU);var b6e=uU.exports,cU={exports:{}};cU.exports;(function(n){(function(e,t,r){function i(o){var l=this;l.next=function(){var c=l.w,h=l.X,d=l.i,f,p;return l.w=c=c+1640531527|0,p=h[d+34&127],f=h[d=d+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=h[d]=p^f,l.i=d,p+(c^c>>>16)|0};function u(c,h){var d,f,p,m,y,v=[],b=128;for(h===(h|0)?(f=h,h=null):(h=h+"\0",f=0,b=Math.max(b,h.length)),p=0,m=-32;m<b;++m)h&&(f^=h.charCodeAt((m+32)%h.length)),m===0&&(y=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(y=y+1640531527|0,d=v[m&127]^=f+y,p=d==0?p+1:0);for(p>=128&&(v[(h&&h.length||0)&127]=-1),p=127,m=4*128;m>0;--m)f=v[p+34&127],d=v[p=p+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,v[p]=f^d;c.w=y,c.X=v,c.i=p}u(l,o)}function s(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function a(o,l){o==null&&(o=+new Date);var u=new i(o),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(c.X&&s(c,u),h.state=function(){return s(u,{})}),h}t&&t.exports?t.exports=a:this.xor4096=a})(Iv,n)})(cU);var _6e=cU.exports,hU={exports:{}};hU.exports;(function(n){(function(e,t,r){function i(o){var l=this,u="";l.next=function(){var h=l.b,d=l.c,f=l.d,p=l.a;return h=h<<25^h>>>7^d,d=d-f|0,f=f<<24^f>>>8^p,p=p-h|0,l.b=h=h<<20^h>>>12^d,l.c=d=d-f|0,l.d=f<<16^d>>>16^p,l.a=p-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):u+=o;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function s(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function a(o,l){var u=new i(o),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&s(c,u),h.state=function(){return s(u,{})}),h}t&&t.exports?t.exports=a:this.tychei=a})(Iv,n)})(hU);var w6e=hU.exports,ore={exports:{}};const E6e={},S6e=Object.freeze(Object.defineProperty({__proto__:null,default:E6e},Symbol.toStringTag,{value:"Module"})),A6e=mie(S6e);(function(n){(function(e,t,r){var i=256,s=6,a=52,o="random",l=r.pow(i,s),u=r.pow(2,a),c=u*2,h=i-1,d;function f(w,_,E){var A=[];_=_==!0?{entropy:!0}:_||{};var T=v(y(_.entropy?[w,x(t)]:w??b(),3),A),S=new p(A),M=function(){for(var D=S.g(s),N=l,R=0;D<u;)D=(D+R)*i,N*=i,R=S.g(1);for(;D>=c;)D/=2,N/=2,R>>>=1;return(D+R)/N};return M.int32=function(){return S.g(4)|0},M.quick=function(){return S.g(4)/4294967296},M.double=M,v(x(S.S),t),(_.pass||E||function(D,N,R,z){return z&&(z.S&&m(z,S),D.state=function(){return m(S,{})}),R?(r[o]=D,N):D})(M,T,"global"in _?_.global:this==r,_.state)}function p(w){var _,E=w.length,A=this,T=0,S=A.i=A.j=0,M=A.S=[];for(E||(w=[E++]);T<i;)M[T]=T++;for(T=0;T<i;T++)M[T]=M[S=h&S+w[T%E]+(_=M[T])],M[S]=_;(A.g=function(D){for(var N,R=0,z=A.i,j=A.j,I=A.S;D--;)N=I[z=h&z+1],R=R*i+I[h&(I[z]=I[j=h&j+N])+(I[j]=N)];return A.i=z,A.j=j,R})(i)}function m(w,_){return _.i=w.i,_.j=w.j,_.S=w.S.slice(),_}function y(w,_){var E=[],A=typeof w,T;if(_&&A=="object")for(T in w)try{E.push(y(w[T],_-1))}catch{}return E.length?E:A=="string"?w:w+"\0"}function v(w,_){for(var E=w+"",A,T=0;T<E.length;)_[h&T]=h&(A^=_[h&T]*19)+E.charCodeAt(T++);return x(_)}function b(){try{var w;return d&&(w=d.randomBytes)?w=w(i):(w=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(w)),x(w)}catch{var _=e.navigator,E=_&&_.plugins;return[+new Date,e,E,e.screen,x(t)]}}function x(w){return String.fromCharCode.apply(0,w)}if(v(r.random(),t),n.exports){n.exports=f;try{d=A6e}catch{}}else r["seed"+o]=f})(typeof self<"u"?self:Iv,[],Math)})(ore);var T6e=ore.exports,M6e=v6e,C6e=y6e,D6e=x6e,N6e=b6e,R6e=_6e,I6e=w6e,Gv=T6e;Gv.alea=M6e;Gv.xor128=C6e;Gv.xorwow=D6e;Gv.xorshift7=N6e;Gv.xor4096=R6e;Gv.tychei=I6e;var P6e=Gv;const lre=w2(P6e);var F6e=lre(Date.now());function Ab(n){var e;function t(i){e=i===null?F6e:lre(String(i))}t(n);function r(){return e()}return r}var rj="pickRandom",L6e=["typed","config","?on"],O6e=ie(rj,L6e,n=>{var{typed:e,config:t,on:r}=n,i=Ab(t.randomSeed);return r&&r("config",function(a,o){a.randomSeed!==o.randomSeed&&(i=Ab(a.randomSeed))}),e(rj,{"Array | Matrix":function(o){return s(o,{})},"Array | Matrix, Object":function(o,l){return s(o,l)},"Array | Matrix, number":function(o,l){return s(o,{number:l})},"Array | Matrix, Array | Matrix":function(o,l){return s(o,{weights:l})},"Array | Matrix, Array | Matrix, number":function(o,l,u){return s(o,{number:u,weights:l})},"Array | Matrix, number, Array | Matrix":function(o,l,u){return s(o,{number:l,weights:u})}});function s(a,o){var{number:l,weights:u,elementWise:c=!0}=o,h=typeof l>"u";h&&(l=1);var d=Dt(a)?a.create:Dt(u)?u.create:null;a=a.valueOf(),u&&(u=u.valueOf()),c===!0&&(a=Tn(a),u=Tn(u));var f=0;if(typeof u<"u"){if(u.length!==a.length)throw new Error("Weights must have the same length as possibles");for(var p=0,m=u.length;p<m;p++){if(!Tt(u[p])||u[p]<0)throw new Error("Weights must be an array of positive numbers");f+=u[p]}}for(var y=a.length,v=[],b;v.length<l;){if(typeof u>"u")b=a[Math.floor(i()*y)];else for(var x=i()*f,w=0,_=a.length;w<_;w++)if(x-=u[w],x<0){b=a[w];break}v.push(b)}return h?v[0]:d?d(v):v}});function dU(n,e){var t=[];if(n=n.slice(0),n.length>1)for(var r=0,i=n.shift();r<i;r++)t.push(dU(n,e));else for(var s=0,a=n.shift();s<a;s++)t.push(e());return t}var ij="random",k6e=["typed","config","?on"],B6e=ie(ij,k6e,n=>{var{typed:e,config:t,on:r}=n,i=Ab(t.randomSeed);return r&&r("config",function(o,l){o.randomSeed!==l.randomSeed&&(i=Ab(o.randomSeed))}),e(ij,{"":()=>a(0,1),number:o=>a(0,o),"number, number":(o,l)=>a(o,l),"Array | Matrix":o=>s(o,0,1),"Array | Matrix, number":(o,l)=>s(o,0,l),"Array | Matrix, number, number":(o,l,u)=>s(o,l,u)});function s(o,l,u){var c=dU(o.valueOf(),()=>a(l,u));return Dt(o)?o.create(c,"number"):c}function a(o,l){return o+i()*(l-o)}}),sj="randomInt",U6e=["typed","config","log2","?on"],V6e=ie(sj,U6e,n=>{var{typed:e,config:t,log2:r,on:i}=n,s=Ab(t.randomSeed);return i&&i("config",function(u,c){u.randomSeed!==c.randomSeed&&(s=Ab(u.randomSeed))}),e(sj,{"":()=>o(0,2),number:u=>o(0,u),"number, number":(u,c)=>o(u,c),bigint:u=>l(0n,u),"bigint, bigint":l,"Array | Matrix":u=>a(u,0,1),"Array | Matrix, number":(u,c)=>a(u,0,c),"Array | Matrix, number, number":(u,c,h)=>a(u,c,h)});function a(u,c,h){var d=dU(u.valueOf(),()=>o(c,h));return Dt(u)?u.create(d,"number"):d}function o(u,c){return Math.floor(u+s()*(c-u))}function l(u,c){var h=2n**30n,d=c-u;if(d<=h)return u+BigInt(o(0,Number(d)));for(var f=r(d),p=d;p>=d;){p=0n;for(var m=0;m<f;++m)p=2n*p+(s()<.5?0n:1n)}return u+p}}),aj="stirlingS2",z6e=["typed","addScalar","subtractScalar","multiplyScalar","divideScalar","pow","factorial","combinations","isNegative","isInteger","number","?bignumber","larger"],$6e=ie(aj,z6e,n=>{var{typed:e,addScalar:t,subtractScalar:r,multiplyScalar:i,divideScalar:s,pow:a,factorial:o,combinations:l,isNegative:u,isInteger:c,number:h,bignumber:d,larger:f}=n,p=[],m=[];return e(aj,{"number | BigNumber, number | BigNumber":function(v,b){if(!c(v)||u(v)||!c(b)||u(b))throw new TypeError("Non-negative integer value expected in function stirlingS2");if(f(b,v))throw new TypeError("k must be less than or equal to n in function stirlingS2");var x=!(Tt(v)&&Tt(b)),w=x?m:p,_=x?d:h,E=h(v),A=h(b);if(w[E]&&w[E].length>A)return w[E][A];for(var T=0;T<=E;++T)if(w[T]||(w[T]=[_(T===0?1:0)]),T!==0)for(var S=w[T],M=w[T-1],D=S.length;D<=T&&D<=A;++D)D===T?S[D]=1:S[D]=t(i(_(D),M[D]),M[D-1]);return w[E][A]}})}),oj="bellNumbers",H6e=["typed","addScalar","isNegative","isInteger","stirlingS2"],G6e=ie(oj,H6e,n=>{var{typed:e,addScalar:t,isNegative:r,isInteger:i,stirlingS2:s}=n;return e(oj,{"number | BigNumber":function(o){if(!i(o)||r(o))throw new TypeError("Non-negative integer value expected in function bellNumbers");for(var l=0,u=0;u<=o;u++)l=t(l,s(o,u));return l}})}),lj="catalan",j6e=["typed","addScalar","divideScalar","multiplyScalar","combinations","isNegative","isInteger"],q6e=ie(lj,j6e,n=>{var{typed:e,addScalar:t,divideScalar:r,multiplyScalar:i,combinations:s,isNegative:a,isInteger:o}=n;return e(lj,{"number | BigNumber":function(u){if(!o(u)||a(u))throw new TypeError("Non-negative integer value expected in function catalan");return r(s(i(u,2),u),t(u,1))}})}),uj="composition",W6e=["typed","addScalar","combinations","isNegative","isPositive","isInteger","larger"],X6e=ie(uj,W6e,n=>{var{typed:e,addScalar:t,combinations:r,isPositive:i,isNegative:s,isInteger:a,larger:o}=n;return e(uj,{"number | BigNumber, number | BigNumber":function(u,c){if(!a(u)||!i(u)||!a(c)||!i(c))throw new TypeError("Positive integer value expected in function composition");if(o(c,u))throw new TypeError("k must be less than or equal to n in function composition");return r(t(u,-1),t(c,-1))}})}),cj="leafCount",K6e=["parse","typed"],Y6e=ie(cj,K6e,n=>{var{parse:e,typed:t}=n;function r(i){var s=0;return i.forEach(a=>{s+=r(a)}),s||1}return t(cj,{Node:function(s){return r(s)}})});function hj(n){return pn(n)||ii(n)&&n.isUnary()&&pn(n.args[0])}function e2(n){return!!(pn(n)||(Fp(n)||ii(n))&&n.args.every(e2)||vd(n)&&e2(n.content))}function dj(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function nP(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?dj(Object(t),!0).forEach(function(r){bi(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):dj(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var Q6e="simplifyUtil",Z6e=["FunctionNode","OperatorNode","SymbolNode"],fU=ie(Q6e,Z6e,n=>{var{FunctionNode:e,OperatorNode:t,SymbolNode:r}=n,i=!0,s=!1,a="defaultF",o={add:{trivial:i,total:i,commutative:i,associative:i},unaryPlus:{trivial:i,total:i,commutative:i,associative:i},subtract:{trivial:s,total:i,commutative:s,associative:s},multiply:{trivial:i,total:i,commutative:i,associative:i},divide:{trivial:s,total:i,commutative:s,associative:s},paren:{trivial:i,total:i,commutative:i,associative:s},defaultF:{trivial:s,total:i,commutative:s,associative:s}},l={divide:{total:s},log:{total:s}},u={subtract:{total:s},abs:{trivial:i},log:{total:i}};function c(x,w){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:o,E=a;if(typeof x=="string"?E=x:ii(x)?E=x.fn.toString():Fp(x)?E=x.name:vd(x)&&(E="paren"),vt(_,E)){var A=_[E];if(vt(A,w))return A[w];if(vt(o,E))return o[E][w]}if(vt(_,a)){var T=_[a];return vt(T,w)?T[w]:o[a][w]}if(vt(o,E)){var S=o[E];if(vt(S,w))return S[w]}return o[a][w]}function h(x){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;return c(x,"commutative",w)}function d(x){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o;return c(x,"associative",w)}function f(x,w){var _=nP({},x);for(var E in w)vt(x,E)?_[E]=nP(nP({},w[E]),x[E]):_[E]=w[E];return _}function p(x,w){if(!x.args||x.args.length===0)return x;x.args=m(x,w);for(var _=0;_<x.args.length;_++)p(x.args[_],w)}function m(x,w){var _,E=[],A=function(S){for(var M=0;M<S.args.length;M++){var D=S.args[M];ii(D)&&_===D.op?A(D):E.push(D)}};return d(x,w)?(_=x.op,A(x),E):x.args}function y(x,w){if(!(!x.args||x.args.length===0)){for(var _=b(x),E=x.args.length,A=0;A<E;A++)y(x.args[A],w);if(E>2&&d(x,w)){for(var T=x.args.pop();x.args.length>0;)T=_([x.args.pop(),T]);x.args=T.args}}}function v(x,w){if(!(!x.args||x.args.length===0)){for(var _=b(x),E=x.args.length,A=0;A<E;A++)v(x.args[A],w);if(E>2&&d(x,w)){for(var T=x.args.shift();x.args.length>0;)T=_([T,x.args.shift()]);x.args=T.args}}}function b(x){return ii(x)?function(w){try{return new t(x.op,x.fn,w,x.implicit)}catch(_){return console.error(_),[]}}:function(w){return new e(new r(x.name),w)}}return{createMakeNodeFunction:b,hasProperty:c,isCommutative:h,isAssociative:d,mergeContext:f,flatten:p,allChildren:m,unflattenr:y,unflattenl:v,defaultContext:o,realContext:l,positiveContext:u}}),J6e="simplify",eze=["typed","parse","equal","resolve","simplifyConstant","simplifyCore","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","SymbolNode","replacer"],tze=ie(J6e,eze,n=>{var{typed:e,parse:t,equal:r,resolve:i,simplifyConstant:s,simplifyCore:a,AccessorNode:o,ArrayNode:l,ConstantNode:u,FunctionNode:c,IndexNode:h,ObjectNode:d,OperatorNode:f,ParenthesisNode:p,SymbolNode:m,replacer:y}=n,{hasProperty:v,isCommutative:b,isAssociative:x,mergeContext:w,flatten:_,unflattenr:E,unflattenl:A,createMakeNodeFunction:T,defaultContext:S,realContext:M,positiveContext:D}=fU({FunctionNode:c,OperatorNode:f,SymbolNode:m});e.addConversion({from:"Object",to:"Map",convert:Ty});var N=e("simplify",{Node:H,"Node, Map":(te,Y)=>H(te,!1,Y),"Node, Map, Object":(te,Y,oe)=>H(te,!1,Y,oe),"Node, Array":H,"Node, Array, Map":H,"Node, Array, Map, Object":H});e.removeConversion({from:"Object",to:"Map",convert:Ty}),N.defaultContext=S,N.realContext=M,N.positiveContext=D;function R(te){return te.transform(function(Y){return vd(Y)?R(Y.content):Y})}var z={true:!0,false:!0,e:!0,i:!0,Infinity:!0,LN2:!0,LN10:!0,LOG2E:!0,LOG10E:!0,NaN:!0,phi:!0,pi:!0,SQRT1_2:!0,SQRT2:!0,tau:!0};N.rules=[a,{l:"log(e)",r:"1"},{s:"n-n1 -> n+-n1",assuming:{subtract:{total:!0}}},{s:"n-n -> 0",assuming:{subtract:{total:!1}}},{s:"-(cl*v) -> v * (-cl)",assuming:{multiply:{commutative:!0},subtract:{total:!0}}},{s:"-(cl*v) -> (-cl) * v",assuming:{multiply:{commutative:!1},subtract:{total:!0}}},{s:"-(v*cl) -> v * (-cl)",assuming:{multiply:{commutative:!1},subtract:{total:!0}}},{l:"-(n1/n2)",r:"-n1/n2"},{l:"-v",r:"v * (-1)"},{l:"(n1 + n2)*(-1)",r:"n1*(-1) + n2*(-1)",repeat:!0},{l:"n/n1^n2",r:"n*n1^-n2"},{l:"n/n1",r:"n*n1^-1"},{s:"(n1*n2)^n3 -> n1^n3 * n2^n3",assuming:{multiply:{commutative:!0}}},{s:"(n1*n2)^(-1) -> n2^(-1) * n1^(-1)",assuming:{multiply:{commutative:!1}}},{s:"(n ^ n1) ^ n2 -> n ^ (n1 * n2)",assuming:{divide:{total:!0}}},{l:" vd   * ( vd   * n1 + n2)",r:"vd^2       * n1 +  vd   * n2"},{s:" vd   * (vd^n4 * n1 + n2)   ->  vd^(1+n4)  * n1 +  vd   * n2",assuming:{divide:{total:!0}}},{s:"vd^n3 * ( vd   * n1 + n2)   ->  vd^(n3+1)  * n1 + vd^n3 * n2",assuming:{divide:{total:!0}}},{s:"vd^n3 * (vd^n4 * n1 + n2)   ->  vd^(n3+n4) * n1 + vd^n3 * n2",assuming:{divide:{total:!0}}},{l:"n*n",r:"n^2"},{s:"n * n^n1 -> n^(n1+1)",assuming:{divide:{total:!0}}},{s:"n^n1 * n^n2 -> n^(n1+n2)",assuming:{divide:{total:!0}}},s,{s:"n+n -> 2*n",assuming:{add:{total:!0}}},{l:"n+-n",r:"0"},{l:"vd*n + vd",r:"vd*(n+1)"},{l:"n3*n1 + n3*n2",r:"n3*(n1+n2)"},{l:"n3^(-n4)*n1 +   n3  * n2",r:"n3^(-n4)*(n1 + n3^(n4+1) *n2)"},{l:"n3^(-n4)*n1 + n3^n5 * n2",r:"n3^(-n4)*(n1 + n3^(n4+n5)*n2)"},{s:"n*vd + vd -> (n+1)*vd",assuming:{multiply:{commutative:!1}}},{s:"vd + n*vd -> (1+n)*vd",assuming:{multiply:{commutative:!1}}},{s:"n1*n3 + n2*n3 -> (n1+n2)*n3",assuming:{multiply:{commutative:!1}}},{s:"n^n1 * n -> n^(n1+1)",assuming:{divide:{total:!0},multiply:{commutative:!1}}},{s:"n1*n3^(-n4) + n2 * n3    -> (n1 + n2*n3^(n4 +  1))*n3^(-n4)",assuming:{multiply:{commutative:!1}}},{s:"n1*n3^(-n4) + n2 * n3^n5 -> (n1 + n2*n3^(n4 + n5))*n3^(-n4)",assuming:{multiply:{commutative:!1}}},{l:"n*cd + cd",r:"(n+1)*cd"},{s:"cd*n + cd -> cd*(n+1)",assuming:{multiply:{commutative:!1}}},{s:"cd + cd*n -> cd*(1+n)",assuming:{multiply:{commutative:!1}}},s,{s:"(-n)*n1 -> -(n*n1)",assuming:{subtract:{total:!0}}},{s:"n1*(-n) -> -(n1*n)",assuming:{subtract:{total:!0},multiply:{commutative:!1}}},{s:"ce+ve -> ve+ce",assuming:{add:{commutative:!0}},imposeContext:{add:{commutative:!1}}},{s:"vd*cd -> cd*vd",assuming:{multiply:{commutative:!0}},imposeContext:{multiply:{commutative:!1}}},{l:"n+-n1",r:"n-n1"},{l:"n+-(n1)",r:"n-(n1)"},{s:"n*(n1^-1) -> n/n1",assuming:{multiply:{commutative:!0}}},{s:"n*n1^-n2 -> n/n1^n2",assuming:{multiply:{commutative:!0}}},{s:"n^-1 -> 1/n",assuming:{multiply:{commutative:!0}}},{l:"n^1",r:"n"},{s:"n*(n1/n2) -> (n*n1)/n2",assuming:{multiply:{associative:!0}}},{s:"n-(n1+n2) -> n-n1-n2",assuming:{addition:{associative:!0,commutative:!0}}},{l:"1*n",r:"n",imposeContext:{multiply:{commutative:!0}}},{s:"n1/(n2/n3) -> (n1*n3)/n2",assuming:{multiply:{associative:!0}}},{l:"n1/(-n2)",r:"-n1/n2"}];function j(te,Y){var oe={};if(te.s){var ve=te.s.split("->");if(ve.length===2)oe.l=ve[0],oe.r=ve[1];else throw SyntaxError("Could not parse rule: "+te.s)}else oe.l=te.l,oe.r=te.r;oe.l=R(t(oe.l)),oe.r=R(t(oe.r));for(var me of["imposeContext","repeat","assuming"])me in te&&(oe[me]=te[me]);if(te.evaluate&&(oe.evaluate=t(te.evaluate)),x(oe.l,Y)){var be=!b(oe.l,Y),_e;be&&(_e=$());var Be=T(oe.l),ze=$();oe.expanded={},oe.expanded.l=Be([oe.l,ze]),_(oe.expanded.l,Y),E(oe.expanded.l,Y),oe.expanded.r=Be([oe.r,ze]),be&&(oe.expandedNC1={},oe.expandedNC1.l=Be([_e,oe.l]),oe.expandedNC1.r=Be([_e,oe.r]),oe.expandedNC2={},oe.expandedNC2.l=Be([_e,oe.expanded.l]),oe.expandedNC2.r=Be([_e,oe.expanded.r]))}return oe}function I(te,Y){for(var oe=[],ve=0;ve<te.length;ve++){var me=te[ve],be=void 0,_e=typeof me;switch(_e){case"string":me={s:me};case"object":be=j(me,Y);break;case"function":be=me;break;default:throw TypeError("Unsupported type of rule: "+_e)}oe.push(be)}return oe}var F=0;function $(){return new m("_p"+F++)}function H(te,Y){var oe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Dw(),ve=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},me=ve.consoleDebug;Y=I(Y||N.rules,ve.context);var be=i(te,oe);be=R(be);for(var _e={},Be=be.toString({parenthesis:"all"});!_e[Be];){_e[Be]=!0,F=0;var ze=Be;me&&console.log("Working on: ",Be);for(var tt=0;tt<Y.length;tt++){var de="";if(typeof Y[tt]=="function"?(be=Y[tt](be,ve),me&&(de=Y[tt].name)):(_(be,ve.context),be=J(be,Y[tt],ve.context),me&&(de="".concat(Y[tt].l.toString()," -> ").concat(Y[tt].r.toString()))),me){var Xe=be.toString({parenthesis:"all"});Xe!==ze&&(console.log("Applying",de,"produced",Xe),ze=Xe)}A(be,ve.context)}Be=be.toString({parenthesis:"all"})}return be}function Z(te,Y,oe){var ve=te;if(te)for(var me=0;me<te.length;++me){var be=J(te[me],Y,oe);be!==te[me]&&(ve===te&&(ve=te.slice()),ve[me]=be)}return ve}function J(te,Y,oe){if(Y.assuming){for(var ve in Y.assuming)for(var me in Y.assuming[ve])if(v(ve,me,oe)!==Y.assuming[ve][me])return te}var be=w(Y.imposeContext,oe),_e=te;if(_e instanceof f||_e instanceof c){var Be=Z(_e.args,Y,oe);Be!==_e.args&&(_e=_e.clone(),_e.args=Be)}else if(_e instanceof p){if(_e.content){var ze=J(_e.content,Y,oe);ze!==_e.content&&(_e=new p(ze))}}else if(_e instanceof l){var tt=Z(_e.items,Y,oe);tt!==_e.items&&(_e=new l(tt))}else if(_e instanceof o){var de=_e.object;_e.object&&(de=J(_e.object,Y,oe));var Xe=_e.index;_e.index&&(Xe=J(_e.index,Y,oe)),(de!==_e.object||Xe!==_e.index)&&(_e=new o(de,Xe))}else if(_e instanceof h){var Ke=Z(_e.dimensions,Y,oe);Ke!==_e.dimensions&&(_e=new h(Ke))}else if(_e instanceof d){var se=!1,fe={};for(var L in _e.properties)fe[L]=J(_e.properties[L],Y,oe),fe[L]!==_e.properties[L]&&(se=!0);se&&(_e=new d(fe))}var P=Y.r,K=re(Y.l,_e,be)[0];if(!K&&Y.expanded&&(P=Y.expanded.r,K=re(Y.expanded.l,_e,be)[0]),!K&&Y.expandedNC1&&(P=Y.expandedNC1.r,K=re(Y.expandedNC1.l,_e,be)[0],K||(P=Y.expandedNC2.r,K=re(Y.expandedNC2.l,_e,be)[0])),K){var ae=_e.implicit;_e=P.clone(),ae&&"implicit"in P&&(_e.implicit=!0),_e=_e.transform(function(pe){return pe.isSymbolNode&&vt(K.placeholders,pe.name)?K.placeholders[pe.name].clone():pe})}return Y.repeat&&_e!==te&&(_e=J(_e,Y,oe)),_e}function ee(te,Y){var oe=[],ve,me,be=T(te);if(b(te,Y))for(var _e=0;_e<te.args.length;_e++)me=te.args.slice(0),me.splice(_e,1),ve=me.length===1?me[0]:be(me),oe.push(be([te.args[_e],ve]));else for(var Be=1;Be<te.args.length;Be++){var ze=te.args[0];Be>1&&(ze=be(te.args.slice(0,Be))),me=te.args.slice(Be),ve=me.length===1?me[0]:be(me),oe.push(be([ze,ve]))}return oe}function O(te,Y){var oe={placeholders:{}};if(!te.placeholders&&!Y.placeholders)return oe;if(te.placeholders){if(!Y.placeholders)return te}else return Y;for(var ve in te.placeholders)if(vt(te.placeholders,ve)&&(oe.placeholders[ve]=te.placeholders[ve],vt(Y.placeholders,ve)&&!le(te.placeholders[ve],Y.placeholders[ve])))return null;for(var me in Y.placeholders)vt(Y.placeholders,me)&&(oe.placeholders[me]=Y.placeholders[me]);return oe}function ue(te,Y){var oe=[];if(te.length===0||Y.length===0)return oe;for(var ve,me=0;me<te.length;me++)for(var be=0;be<Y.length;be++)ve=O(te[me],Y[be]),ve&&oe.push(ve);return oe}function Q(te){if(te.length===0)return te;for(var Y=te.reduce(ue),oe=[],ve={},me=0;me<Y.length;me++){var be=JSON.stringify(Y[me],y);ve[be]||(ve[be]=!0,oe.push(Y[me]))}return oe}function re(te,Y,oe,ve){var me=[{placeholders:{}}];if(te instanceof f&&Y instanceof f||te instanceof c&&Y instanceof c){if(te instanceof f){if(te.op!==Y.op||te.fn!==Y.fn)return[]}else if(te instanceof c&&te.name!==Y.name)return[];if(Y.args.length===1&&te.args.length===1||!x(Y,oe)&&Y.args.length===te.args.length||ve){for(var be=[],_e=0;_e<te.args.length;_e++){var Be=re(te.args[_e],Y.args[_e],oe);if(Be.length===0)break;be.push(Be)}if(be.length!==te.args.length){if(!b(Y,oe)||te.args.length===1)return[];if(te.args.length>2)throw new Error("permuting >2 commutative non-associative rule arguments not yet implemented");var ze=re(te.args[0],Y.args[1],oe);if(ze.length===0)return[];var tt=re(te.args[1],Y.args[0],oe);if(tt.length===0)return[];be=[ze,tt]}me=Q(be)}else if(Y.args.length>=2&&te.args.length===2){for(var de=ee(Y,oe),Xe=[],Ke=0;Ke<de.length;Ke++){var se=re(te,de[Ke],oe,!0);Xe=Xe.concat(se)}return Xe}else{if(te.args.length>2)throw Error("Unexpected non-binary associative function: "+te.toString());return[]}}else if(te instanceof m){if(te.name.length===0)throw new Error("Symbol in rule has 0 length...!?");if(z[te.name]){if(te.name!==Y.name)return[]}else switch(te.name[1]>="a"&&te.name[1]<="z"?te.name.substring(0,2):te.name[0]){case"n":case"_p":me[0].placeholders[te.name]=Y;break;case"c":case"cl":if(pn(Y))me[0].placeholders[te.name]=Y;else return[];break;case"v":if(!pn(Y))me[0].placeholders[te.name]=Y;else return[];break;case"vl":if(is(Y))me[0].placeholders[te.name]=Y;else return[];break;case"cd":if(hj(Y))me[0].placeholders[te.name]=Y;else return[];break;case"vd":if(!hj(Y))me[0].placeholders[te.name]=Y;else return[];break;case"ce":if(e2(Y))me[0].placeholders[te.name]=Y;else return[];break;case"ve":if(!e2(Y))me[0].placeholders[te.name]=Y;else return[];break;default:throw new Error("Invalid symbol in rule: "+te.name)}}else if(te instanceof u){if(!r(te.value,Y.value))return[]}else return[];return me}function le(te,Y){if(te instanceof u&&Y instanceof u){if(!r(te.value,Y.value))return!1}else if(te instanceof m&&Y instanceof m){if(te.name!==Y.name)return!1}else if(te instanceof f&&Y instanceof f||te instanceof c&&Y instanceof c){if(te instanceof f){if(te.op!==Y.op||te.fn!==Y.fn)return!1}else if(te instanceof c&&te.name!==Y.name)return!1;if(te.args.length!==Y.args.length)return!1;for(var oe=0;oe<te.args.length;oe++)if(!le(te.args[oe],Y.args[oe]))return!1}else return!1;return!0}return N}),nze="simplifyConstant",rze=["typed","config","mathWithTransform","matrix","isBounded","?fraction","?bignumber","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","SymbolNode"],ize=ie(nze,rze,n=>{var{typed:e,config:t,mathWithTransform:r,matrix:i,isBounded:s,fraction:a,bignumber:o,AccessorNode:l,ArrayNode:u,ConstantNode:c,FunctionNode:h,IndexNode:d,ObjectNode:f,OperatorNode:p,SymbolNode:m}=n,{isCommutative:y,isAssociative:v,allChildren:b,createMakeNodeFunction:x}=fU({FunctionNode:h,OperatorNode:p,SymbolNode:m}),w=e("simplifyConstant",{Node:I=>T(j(I,{})),"Node, Object":function(F,$){return T(j(F,$))}});function _(I){return iA(I)?I.valueOf():I instanceof Array?I.map(_):Dt(I)?i(_(I.valueOf())):I}function E(I,F,$){try{return r[I].apply(null,F)}catch{return F=F.map(_),M(r[I].apply(null,F),$)}}var A=e({Fraction:N,number:function(F){return F<0?D(new c(-F)):new c(F)},BigNumber:function(F){return F<0?D(new c(-F)):new c(F)},bigint:function(F){return F<0n?D(new c(-F)):new c(F)},Complex:function(F){throw new Error("Cannot convert Complex number to Node")},string:function(F){return new c(F)},Matrix:function(F){return new u(F.valueOf().map($=>A($)))}});function T(I){return zn(I)?I:A(I)}function S(I,F){var $=F&&F.exactFractions!==!1;if($&&s(I)&&a){var H=a(I),Z=F&&typeof F.fractionsLimit=="number"?F.fractionsLimit:1/0;if(H.valueOf()===I&&H.n<Z&&H.d<Z)return H}return I}var M=e({"string, Object":function(F,$){var H=Kp(F,t);if(H==="BigNumber")return o===void 0&&nU(),o(F);if(H==="bigint")return BigInt(F);if(H==="Fraction")return a===void 0&&zne(),a(F);var Z=parseFloat(F);return S(Z,$)},"Fraction, Object":function(F,$){return F},"BigNumber, Object":function(F,$){return F},"number, Object":function(F,$){return S(F,$)},"bigint, Object":function(F,$){return F},"Complex, Object":function(F,$){return F.im!==0?F:S(F.re,$)},"Matrix, Object":function(F,$){return i(S(F.valueOf()))},"Array, Object":function(F,$){return F.map(S)}});function D(I){return new p("-","unaryMinus",[I])}function N(I){var F=Z=>t.number==="BigNumber"&&o?o(Z):Number(Z),$=I.s*I.n,H=$<0n?new p("-","unaryMinus",[new c(-F($))]):new c(F($));return I.d===1n?H:new p("/","divide",[H,new c(F(I.d))])}function R(I,F,$){if(!qb(F))return new l(T(I),T(F));if(fl(I)||Dt(I)){for(var H=Array.from(F.dimensions);H.length>0;)if(pn(H[0])&&typeof H[0].value!="string"){var Z=M(H.shift().value,$);fl(I)?I=I.items[Z-1]:(I=I.valueOf()[Z-1],I instanceof Array&&(I=i(I)))}else if(H.length>1&&pn(H[1])&&typeof H[1].value!="string"){var J=M(H[1].value,$),ee=[],O=fl(I)?I.items:I.valueOf();for(var ue of O)if(fl(ue))ee.push(ue.items[J-1]);else if(Dt(I))ee.push(ue[J-1]);else break;if(ee.length===O.length)fl(I)?I=new u(ee):I=i(ee),H.splice(1,1);else break}else break;return H.length===F.dimensions.length?new l(T(I),F):H.length>0?(F=new d(H),new l(T(I),F)):I}if(NN(I)&&F.dimensions.length===1&&pn(F.dimensions[0])){var Q=F.dimensions[0].value;return Q in I.properties?I.properties[Q]:new c}return new l(T(I),F)}function z(I,F,$,H){var Z=F.shift(),J=F.reduce((ee,O)=>{if(!zn(O)){var ue=ee.pop();if(zn(ue))return[ue,O];try{return ee.push(E(I,[ue,O],H)),ee}catch{ee.push(ue)}}ee.push(T(ee.pop()));var Q=ee.length===1?ee[0]:$(ee);return[$([Q,T(O)])]},[Z]);return J.length===1?J[0]:$([J[0],A(J[1])])}function j(I,F){switch(I.type){case"SymbolNode":return I;case"ConstantNode":switch(typeof I.value){case"number":return M(I.value,F);case"bigint":return M(I.value,F);case"string":return I.value;default:if(!isNaN(I.value))return M(I.value,F)}return I;case"FunctionNode":if(r[I.name]&&r[I.name].rawArgs)return I;{var $=["add","multiply"];if(!$.includes(I.name)){var H=I.args.map(me=>j(me,F));if(!H.some(zn))try{return E(I.name,H,F)}catch{}if(I.name==="size"&&H.length===1&&fl(H[0])){for(var Z=[],J=H[0];fl(J);)Z.push(J.items.length),J=J.items[0];return i(Z)}return new h(I.name,H.map(T))}}case"OperatorNode":{var ee=I.fn.toString(),O,ue,Q=x(I);if(ii(I)&&I.isUnary())O=[j(I.args[0],F)],zn(O[0])?ue=Q(O):ue=E(ee,O,F);else if(v(I,F.context))if(O=b(I,F.context),O=O.map(me=>j(me,F)),y(ee,F.context)){for(var re=[],le=[],te=0;te<O.length;te++)zn(O[te])?le.push(O[te]):re.push(O[te]);re.length>1?(ue=z(ee,re,Q,F),le.unshift(ue),ue=z(ee,le,Q,F)):ue=z(ee,O,Q,F)}else ue=z(ee,O,Q,F);else O=I.args.map(me=>j(me,F)),ue=z(ee,O,Q,F);return ue}case"ParenthesisNode":return j(I.content,F);case"AccessorNode":return R(j(I.object,F),j(I.index,F),F);case"ArrayNode":{var Y=I.items.map(me=>j(me,F));return Y.some(zn)?new u(Y.map(T)):i(Y)}case"IndexNode":return new d(I.dimensions.map(me=>w(me,F)));case"ObjectNode":{var oe={};for(var ve in I.properties)oe[ve]=w(I.properties[ve],F);return new f(oe)}case"AssignmentNode":case"BlockNode":case"FunctionAssignmentNode":case"RangeNode":case"ConditionalNode":default:throw new Error("Unimplemented node type in simplifyConstant: ".concat(I.type))}}return w}),fj="simplifyCore",sze=["typed","parse","equal","isZero","add","subtract","multiply","divide","pow","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","SymbolNode"],aze=ie(fj,sze,n=>{var{typed:e,parse:t,equal:r,isZero:i,add:s,subtract:a,multiply:o,divide:l,pow:u,AccessorNode:c,ArrayNode:h,ConstantNode:d,FunctionNode:f,IndexNode:p,ObjectNode:m,OperatorNode:y,ParenthesisNode:v,SymbolNode:b}=n,x=new d(0),w=new d(1),_=new d(!0),E=new d(!1);function A(D){return ii(D)&&["and","not","or"].includes(D.op)}var{hasProperty:T,isCommutative:S}=fU({FunctionNode:f,OperatorNode:y,SymbolNode:b});function M(D){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R=N?N.context:void 0;if(T(D,"trivial",R)){if(Fp(D)&&D.args.length===1)return M(D.args[0],N);var z=!1,j=0;if(D.forEach(re=>{++j,j===1&&(z=M(re,N))}),j===1)return z}var I=D;if(Fp(I)){var F=YLe(I.name);if(F){if(I.args.length>2&&T(I,"associative",R))for(;I.args.length>2;){var $=I.args.pop(),H=I.args.pop();I.args.push(new y(F,I.name,[$,H]))}I=new y(F,I.name,I.args)}else return new f(M(I.fn),I.args.map(re=>M(re,N)))}if(ii(I)&&I.isUnary()){var Z=M(I.args[0],N);if(I.op==="~"&&ii(Z)&&Z.isUnary()&&Z.op==="~"||I.op==="not"&&ii(Z)&&Z.isUnary()&&Z.op==="not"&&A(Z.args[0]))return Z.args[0];var J=!0;if(I.op==="-"&&ii(Z)&&(Z.isBinary()&&Z.fn==="subtract"&&(I=new y("-","subtract",[Z.args[1],Z.args[0]]),J=!1),Z.isUnary()&&Z.op==="-"))return Z.args[0];if(J)return new y(I.op,I.fn,[Z])}if(ii(I)&&I.isBinary()){var ee=M(I.args[0],N),O=M(I.args[1],N);if(I.op==="+"){if(pn(ee)&&i(ee.value))return O;if(pn(O)&&i(O.value))return ee;ii(O)&&O.isUnary()&&O.op==="-"&&(O=O.args[0],I=new y("-","subtract",[ee,O]))}if(I.op==="-")return ii(O)&&O.isUnary()&&O.op==="-"?M(new y("+","add",[ee,O.args[0]]),N):pn(ee)&&i(ee.value)?M(new y("-","unaryMinus",[O])):pn(O)&&i(O.value)?ee:new y(I.op,I.fn,[ee,O]);if(I.op==="*"){if(pn(ee)){if(i(ee.value))return x;if(r(ee.value,1))return O}if(pn(O)){if(i(O.value))return x;if(r(O.value,1))return ee;if(S(I,R))return new y(I.op,I.fn,[O,ee],I.implicit)}return new y(I.op,I.fn,[ee,O],I.implicit)}if(I.op==="/")return pn(ee)&&i(ee.value)?x:pn(O)&&r(O.value,1)?ee:new y(I.op,I.fn,[ee,O]);if(I.op==="^"&&pn(O)){if(i(O.value))return w;if(r(O.value,1))return ee}if(I.op==="and"){if(pn(ee))if(ee.value){if(A(O))return O;if(pn(O))return O.value?_:E}else return E;if(pn(O))if(O.value){if(A(ee))return ee}else return E}if(I.op==="or"){if(pn(ee)){if(ee.value)return _;if(A(O))return O}if(pn(O)){if(O.value)return _;if(A(ee))return ee}}return new y(I.op,I.fn,[ee,O])}if(ii(I))return new y(I.op,I.fn,I.args.map(re=>M(re,N)));if(fl(I))return new h(I.items.map(re=>M(re,N)));if(gd(I))return new c(M(I.object,N),M(I.index,N));if(qb(I))return new p(I.dimensions.map(re=>M(re,N)));if(NN(I)){var ue={};for(var Q in I.properties)ue[Q]=M(I.properties[Q],N);return new m(ue)}return I}return e(fj,{Node:M,"Node,Object":M})}),oze="resolve",lze=["typed","parse","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode"],uze=ie(oze,lze,n=>{var{typed:e,parse:t,ConstantNode:r,FunctionNode:i,OperatorNode:s,ParenthesisNode:a}=n;function o(l,u){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new Set;if(!u)return l;if(is(l)){if(c.has(l.name)){var h=Array.from(c).join(", ");throw new ReferenceError("recursive loop of variable definitions among {".concat(h,"}"))}var d=u.get(l.name);if(zn(d)){var f=new Set(c);return f.add(l.name),o(d,u,f)}else return typeof d=="number"?t(String(d)):d!==void 0?new r(d):l}else if(ii(l)){var p=l.args.map(function(y){return o(y,u,c)});return new s(l.op,l.fn,p,l.implicit)}else{if(vd(l))return new a(o(l.content,u,c));if(Fp(l)){var m=l.args.map(function(y){return o(y,u,c)});return new i(l.name,m)}}return l.map(y=>o(y,u,c))}return e("resolve",{Node:o,"Node, Map | null | undefined":o,"Node, Object":(l,u)=>o(l,Ty(u)),"Array | Matrix":e.referToSelf(l=>u=>u.map(c=>l(c))),"Array | Matrix, null | undefined":e.referToSelf(l=>u=>u.map(c=>l(c))),"Array, Object":e.referTo("Array,Map",l=>(u,c)=>l(u,Ty(c))),"Matrix, Object":e.referTo("Matrix,Map",l=>(u,c)=>l(u,Ty(c))),"Array | Matrix, Map":e.referToSelf(l=>(u,c)=>u.map(h=>l(h,c)))})}),pj="symbolicEqual",cze=["parse","simplify","typed","OperatorNode"],hze=ie(pj,cze,n=>{var{parse:e,simplify:t,typed:r,OperatorNode:i}=n;function s(a,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},u=new i("-","subtract",[a,o]),c=t(u,{},l);return pn(c)&&!c.value}return r(pj,{"Node, Node":s,"Node, Node, Object":s})}),mj="derivative",dze=["typed","config","parse","simplify","equal","isZero","numeric","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode","SymbolNode"],fze=ie(mj,dze,n=>{var{typed:e,config:t,parse:r,simplify:i,equal:s,isZero:a,numeric:o,ConstantNode:l,FunctionNode:u,OperatorNode:c,ParenthesisNode:h,SymbolNode:d}=n;function f(w,_){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{simplify:!0},A=new Map,T=_.name;function S(D){var N=A.get(D);if(N!==void 0)return N;var R=v(S,D,T);return A.set(D,R),R}var M=b(w,S);return E.simplify?i(M):M}function p(w){var _=r(w);if(!_.isSymbolNode)throw new TypeError("Invalid variable. "+"Cannot parse ".concat(JSON.stringify(w)," into a variable in function derivative"));return _}var m=e(mj,{"Node, SymbolNode":f,"Node, SymbolNode, Object":f,"Node, string":(w,_)=>f(w,p(_)),"Node, string, Object":(w,_,E)=>f(w,p(_),E)});m._simplify=!0,m.toTex=function(w){return y.apply(null,w.args)};var y=e("_derivTex",{"Node, SymbolNode":function(_,E){return pn(_)&&Kn(_.value)==="string"?y(r(_.value).toString(),E.toString(),1):y(_.toTex(),E.toString(),1)},"Node, ConstantNode":function(_,E){if(Kn(E.value)==="string")return y(_,r(E.value));throw new Error("The second parameter to 'derivative' is a non-string constant")},"Node, SymbolNode, ConstantNode":function(_,E,A){return y(_.toString(),E.name,A.value)},"string, string, number":function(_,E,A){var T;return A===1?T="{d\\over d"+E+"}":T="{d^{"+A+"}\\over d"+E+"^{"+A+"}}",T+"\\left[".concat(_,"\\right]")}}),v=e("_isConst",{"function, ConstantNode, string":function(){return!0},"function, SymbolNode, string":function(_,E,A){return E.name!==A},"function, ParenthesisNode, string":function(_,E,A){return _(E.content,A)},"function, FunctionAssignmentNode, string":function(_,E,A){return E.params.includes(A)?_(E.expr,A):!0},"function, FunctionNode | OperatorNode, string":function(_,E,A){return E.args.every(T=>_(T,A))}}),b=e("_derivative",{"ConstantNode, function":function(){return x(0)},"SymbolNode, function":function(_,E){return E(_)?x(0):x(1)},"ParenthesisNode, function":function(_,E){return new h(b(_.content,E))},"FunctionAssignmentNode, function":function(_,E){return E(_)?x(0):b(_.expr,E)},"FunctionNode, function":function(_,E){if(E(_))return x(0);var A=_.args[0],T,S=!1,M=!1,D;switch(_.name){case"cbrt":S=!0,D=new c("*","multiply",[x(3),new c("^","pow",[A,new c("/","divide",[x(2),x(3)])])]);break;case"sqrt":case"nthRoot":if(_.args.length===1)S=!0,D=new c("*","multiply",[x(2),new u("sqrt",[A])]);else if(_.args.length===2)return T=new c("/","divide",[x(1),_.args[1]]),b(new c("^","pow",[A,T]),E);break;case"log10":T=x(10);case"log":if(!T&&_.args.length===1)D=A.clone(),S=!0;else if(_.args.length===1&&T||_.args.length===2&&E(_.args[1]))D=new c("*","multiply",[A.clone(),new u("log",[T||_.args[1]])]),S=!0;else if(_.args.length===2)return b(new c("/","divide",[new u("log",[A]),new u("log",[_.args[1]])]),E);break;case"pow":if(_.args.length===2)return b(new c("^","pow",[A,_.args[1]]),E);break;case"exp":D=new u("exp",[A.clone()]);break;case"sin":D=new u("cos",[A.clone()]);break;case"cos":D=new c("-","unaryMinus",[new u("sin",[A.clone()])]);break;case"tan":D=new c("^","pow",[new u("sec",[A.clone()]),x(2)]);break;case"sec":D=new c("*","multiply",[_,new u("tan",[A.clone()])]);break;case"csc":M=!0,D=new c("*","multiply",[_,new u("cot",[A.clone()])]);break;case"cot":M=!0,D=new c("^","pow",[new u("csc",[A.clone()]),x(2)]);break;case"asin":S=!0,D=new u("sqrt",[new c("-","subtract",[x(1),new c("^","pow",[A.clone(),x(2)])])]);break;case"acos":S=!0,M=!0,D=new u("sqrt",[new c("-","subtract",[x(1),new c("^","pow",[A.clone(),x(2)])])]);break;case"atan":S=!0,D=new c("+","add",[new c("^","pow",[A.clone(),x(2)]),x(1)]);break;case"asec":S=!0,D=new c("*","multiply",[new u("abs",[A.clone()]),new u("sqrt",[new c("-","subtract",[new c("^","pow",[A.clone(),x(2)]),x(1)])])]);break;case"acsc":S=!0,M=!0,D=new c("*","multiply",[new u("abs",[A.clone()]),new u("sqrt",[new c("-","subtract",[new c("^","pow",[A.clone(),x(2)]),x(1)])])]);break;case"acot":S=!0,M=!0,D=new c("+","add",[new c("^","pow",[A.clone(),x(2)]),x(1)]);break;case"sinh":D=new u("cosh",[A.clone()]);break;case"cosh":D=new u("sinh",[A.clone()]);break;case"tanh":D=new c("^","pow",[new u("sech",[A.clone()]),x(2)]);break;case"sech":M=!0,D=new c("*","multiply",[_,new u("tanh",[A.clone()])]);break;case"csch":M=!0,D=new c("*","multiply",[_,new u("coth",[A.clone()])]);break;case"coth":M=!0,D=new c("^","pow",[new u("csch",[A.clone()]),x(2)]);break;case"asinh":S=!0,D=new u("sqrt",[new c("+","add",[new c("^","pow",[A.clone(),x(2)]),x(1)])]);break;case"acosh":S=!0,D=new u("sqrt",[new c("-","subtract",[new c("^","pow",[A.clone(),x(2)]),x(1)])]);break;case"atanh":S=!0,D=new c("-","subtract",[x(1),new c("^","pow",[A.clone(),x(2)])]);break;case"asech":S=!0,M=!0,D=new c("*","multiply",[A.clone(),new u("sqrt",[new c("-","subtract",[x(1),new c("^","pow",[A.clone(),x(2)])])])]);break;case"acsch":S=!0,M=!0,D=new c("*","multiply",[new u("abs",[A.clone()]),new u("sqrt",[new c("+","add",[new c("^","pow",[A.clone(),x(2)]),x(1)])])]);break;case"acoth":S=!0,M=!0,D=new c("-","subtract",[x(1),new c("^","pow",[A.clone(),x(2)])]);break;case"abs":D=new c("/","divide",[new u(new d("abs"),[A.clone()]),A.clone()]);break;case"gamma":default:throw new Error('Cannot process function "'+_.name+'" in derivative: the function is not supported, undefined, or the number of arguments passed to it are not supported')}var N,R;S?(N="/",R="divide"):(N="*",R="multiply");var z=b(A,E);return M&&(z=new c("-","unaryMinus",[z])),new c(N,R,[z,D])},"OperatorNode, function":function(_,E){if(E(_))return x(0);if(_.op==="+")return new c(_.op,_.fn,_.args.map(function(I){return b(I,E)}));if(_.op==="-"){if(_.isUnary())return new c(_.op,_.fn,[b(_.args[0],E)]);if(_.isBinary())return new c(_.op,_.fn,[b(_.args[0],E),b(_.args[1],E)])}if(_.op==="*"){var A=_.args.filter(function(I){return E(I)});if(A.length>0){var T=_.args.filter(function(I){return!E(I)}),S=T.length===1?T[0]:new c("*","multiply",T),M=A.concat(b(S,E));return new c("*","multiply",M)}return new c("+","add",_.args.map(function(I){return new c("*","multiply",_.args.map(function(F){return F===I?b(F,E):F.clone()}))}))}if(_.op==="/"&&_.isBinary()){var D=_.args[0],N=_.args[1];return E(N)?new c("/","divide",[b(D,E),N]):E(D)?new c("*","multiply",[new c("-","unaryMinus",[D]),new c("/","divide",[b(N,E),new c("^","pow",[N.clone(),x(2)])])]):new c("/","divide",[new c("-","subtract",[new c("*","multiply",[b(D,E),N.clone()]),new c("*","multiply",[D.clone(),b(N,E)])]),new c("^","pow",[N.clone(),x(2)])])}if(_.op==="^"&&_.isBinary()){var R=_.args[0],z=_.args[1];if(E(R))return pn(R)&&(a(R.value)||s(R.value,1))?x(0):new c("*","multiply",[_,new c("*","multiply",[new u("log",[R.clone()]),b(z.clone(),E)])]);if(E(z)){if(pn(z)){if(a(z.value))return x(0);if(s(z.value,1))return b(R,E)}var j=new c("^","pow",[R.clone(),new c("-","subtract",[z,x(1)])]);return new c("*","multiply",[z.clone(),new c("*","multiply",[b(R,E),j])])}return new c("*","multiply",[new c("^","pow",[R.clone(),z.clone()]),new c("+","add",[new c("*","multiply",[b(R,E),new c("/","divide",[z.clone(),R.clone()])]),new c("*","multiply",[b(z,E),new u("log",[R.clone()])])])])}throw new Error('Cannot process operator "'+_.op+'" in derivative: the operator is not supported, undefined, or the number of arguments passed to it are not supported')}});function x(w,_){return new l(o(w,Kp(String(w),t)))}return m}),gj="rationalize",pze=["config","typed","equal","isZero","add","subtract","multiply","divide","pow","parse","simplifyConstant","simplifyCore","simplify","?bignumber","?fraction","mathWithTransform","matrix","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","SymbolNode","ParenthesisNode"],mze=ie(gj,pze,n=>{var{config:e,typed:t,equal:r,isZero:i,add:s,subtract:a,multiply:o,divide:l,pow:u,parse:c,simplifyConstant:h,simplifyCore:d,simplify:f,fraction:p,bignumber:m,mathWithTransform:y,matrix:v,AccessorNode:b,ArrayNode:x,ConstantNode:w,FunctionNode:_,IndexNode:E,ObjectNode:A,OperatorNode:T,SymbolNode:S,ParenthesisNode:M}=n;function D(I){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},$=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,H=R(),Z=N(I,F,!0,H.firstRules),J=Z.variables.length,ee={exactFractions:!1},O={exactFractions:!0};if(I=Z.expression,J>=1){I=z(I);var ue,Q,re=!0,le=!1;I=f(I,H.firstRules,{},ee);for(var te;Q=re?H.distrDivRules:H.sucDivRules,I=f(I,Q,{},O),re=!re,te=I.toString(),te!==ue;)le=!0,ue=te;le&&(I=f(I,H.firstRulesAgain,{},ee)),I=f(I,H.finalRules,{},ee)}var Y=[],oe={};return I.type==="OperatorNode"&&I.isBinary()&&I.op==="/"?(J===1&&(I.args[0]=j(I.args[0],Y),I.args[1]=j(I.args[1])),$&&(oe.numerator=I.args[0],oe.denominator=I.args[1])):(J===1&&(I=j(I,Y)),$&&(oe.numerator=I,oe.denominator=null)),$?(oe.coefficients=Y,oe.variables=Z.variables,oe.expression=I,oe):I}return t(gj,{Node:D,"Node, boolean":(I,F)=>D(I,{},F),"Node, Object":D,"Node, Object, boolean":D});function N(I,F,$,H){var Z=[],J=f(I,H,F,{exactFractions:!1});$=!!$;var ee="+-*"+($?"/":"");ue(J);var O={};return O.expression=J,O.variables=Z,O;function ue(Q){var re=Q.type;if(re==="FunctionNode")throw new Error("There is an unsolved function call");if(re==="OperatorNode")if(Q.op==="^"){if(Q.args[1].type!=="ConstantNode"||!bt(parseFloat(Q.args[1].value)))throw new Error("There is a non-integer exponent");ue(Q.args[0])}else{if(!ee.includes(Q.op))throw new Error("Operator "+Q.op+" invalid in polynomial expression");for(var le=0;le<Q.args.length;le++)ue(Q.args[le])}else if(re==="SymbolNode"){var te=Q.name,Y=Z.indexOf(te);Y===-1&&Z.push(te)}else if(re==="ParenthesisNode")ue(Q.content);else if(re!=="ConstantNode")throw new Error("type "+re+" is not allowed in polynomial expression")}}function R(){var I=[d,{l:"n+n",r:"2*n"},{l:"n+-n",r:"0"},h,{l:"n*(n1^-1)",r:"n/n1"},{l:"n*n1^-n2",r:"n/n1^n2"},{l:"n1^-1",r:"1/n1"},{l:"n*(n1/n2)",r:"(n*n1)/n2"},{l:"1*n",r:"n"}],F=[{l:"(-n1)/(-n2)",r:"n1/n2"},{l:"(-n1)*(-n2)",r:"n1*n2"},{l:"n1--n2",r:"n1+n2"},{l:"n1-n2",r:"n1+(-n2)"},{l:"(n1+n2)*n3",r:"(n1*n3 + n2*n3)"},{l:"n1*(n2+n3)",r:"(n1*n2+n1*n3)"},{l:"c1*n + c2*n",r:"(c1+c2)*n"},{l:"c1*n + n",r:"(c1+1)*n"},{l:"c1*n - c2*n",r:"(c1-c2)*n"},{l:"c1*n - n",r:"(c1-1)*n"},{l:"v/c",r:"(1/c)*v"},{l:"v/-c",r:"-(1/c)*v"},{l:"-v*-c",r:"c*v"},{l:"-v*c",r:"-c*v"},{l:"v*-c",r:"-c*v"},{l:"v*c",r:"c*v"},{l:"-(-n1*n2)",r:"(n1*n2)"},{l:"-(n1*n2)",r:"(-n1*n2)"},{l:"-(-n1+n2)",r:"(n1-n2)"},{l:"-(n1+n2)",r:"(-n1-n2)"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"},{l:"-(-n1/n2)",r:"(n1/n2)"},{l:"-(n1/n2)",r:"(-n1/n2)"}],$=[{l:"(n1/n2 + n3/n4)",r:"((n1*n4 + n3*n2)/(n2*n4))"},{l:"(n1/n2 + n3)",r:"((n1 + n3*n2)/n2)"},{l:"(n1 + n2/n3)",r:"((n1*n3 + n2)/n3)"}],H=[{l:"(n1/(n2/n3))",r:"((n1*n3)/n2)"},{l:"(n1/n2/n3)",r:"(n1/(n2*n3))"}],Z={};return Z.firstRules=I.concat(F,H),Z.distrDivRules=$,Z.sucDivRules=H,Z.firstRulesAgain=I.concat(F),Z.finalRules=[d,{l:"n*-n",r:"-n^2"},{l:"n*n",r:"n^2"},h,{l:"n*-n^n1",r:"-n^(n1+1)"},{l:"n*n^n1",r:"n^(n1+1)"},{l:"n^n1*-n^n2",r:"-n^(n1+n2)"},{l:"n^n1*n^n2",r:"n^(n1+n2)"},{l:"n^n1*-n",r:"-n^(n1+1)"},{l:"n^n1*n",r:"n^(n1+1)"},{l:"n^n1/-n",r:"-n^(n1-1)"},{l:"n^n1/n",r:"n^(n1-1)"},{l:"n/-n^n1",r:"-n^(1-n1)"},{l:"n/n^n1",r:"n^(1-n1)"},{l:"n^n1/-n^n2",r:"n^(n1-n2)"},{l:"n^n1/n^n2",r:"n^(n1-n2)"},{l:"n1+(-n2*n3)",r:"n1-n2*n3"},{l:"v*(-c)",r:"-c*v"},{l:"n1+-n2",r:"n1-n2"},{l:"v*c",r:"c*v"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"}],Z}function z(I,F,$){var H=I.type,Z=arguments.length>1;if(H==="OperatorNode"&&I.isBinary()){var J=!1,ee;if(I.op==="^"&&(I.args[0].type==="ParenthesisNode"||I.args[0].type==="OperatorNode")&&I.args[1].type==="ConstantNode"&&(ee=parseFloat(I.args[1].value),J=ee>=2&&bt(ee)),J){if(ee>2){var O=I.args[0],ue=new T("^","pow",[I.args[0].cloneDeep(),new w(ee-1)]);I=new T("*","multiply",[O,ue])}else I=new T("*","multiply",[I.args[0],I.args[0].cloneDeep()]);Z&&($==="content"?F.content=I:F.args[$]=I)}}if(H==="ParenthesisNode")z(I.content,I,"content");else if(H!=="ConstantNode"&&H!=="SymbolNode")for(var Q=0;Q<I.args.length;Q++)z(I.args[Q],I,Q);if(!Z)return I}function j(I,F){F===void 0&&(F=[]),F[0]=0;var $={};$.cte=1,$.oper="+",$.fire="";var H=0,Z="";te(I,null,$),H=F.length-1;for(var J=!0,ee,O=H;O>=0;O--)if(F[O]!==0){var ue=new w(J?F[O]:Math.abs(F[O])),Q=F[O]<0?"-":"+";if(O>0){var re=new S(Z);if(O>1){var le=new w(O);re=new T("^","pow",[re,le])}F[O]===-1&&J?ue=new T("-","unaryMinus",[re]):Math.abs(F[O])===1?ue=re:ue=new T("*","multiply",[ue,re])}J?ee=ue:Q==="+"?ee=new T("+","add",[ee,ue]):ee=new T("-","subtract",[ee,ue]),J=!1}if(J)return new w(0);return ee;function te(Y,oe,ve){var me=Y.type;if(me==="FunctionNode")throw new Error("There is an unsolved function call");if(me==="OperatorNode"){if(!"+-*^".includes(Y.op))throw new Error("Operator "+Y.op+" invalid");if(oe!==null){if((Y.fn==="unaryMinus"||Y.fn==="pow")&&oe.fn!=="add"&&oe.fn!=="subtract"&&oe.fn!=="multiply")throw new Error("Invalid "+Y.op+" placing");if((Y.fn==="subtract"||Y.fn==="add"||Y.fn==="multiply")&&oe.fn!=="add"&&oe.fn!=="subtract")throw new Error("Invalid "+Y.op+" placing");if((Y.fn==="subtract"||Y.fn==="add"||Y.fn==="unaryMinus")&&ve.noFil!==0)throw new Error("Invalid "+Y.op+" placing")}(Y.op==="^"||Y.op==="*")&&(ve.fire=Y.op);for(var be=0;be<Y.args.length;be++)Y.fn==="unaryMinus"&&(ve.oper="-"),(Y.op==="+"||Y.fn==="subtract")&&(ve.fire="",ve.cte=1,ve.oper=be===0?"+":Y.op),ve.noFil=be,te(Y.args[be],Y,ve)}else if(me==="SymbolNode"){if(Y.name!==Z&&Z!=="")throw new Error("There is more than one variable");if(Z=Y.name,oe===null){F[1]=1;return}if(oe.op==="^"&&ve.noFil!==0)throw new Error("In power the variable should be the first parameter");if(oe.op==="*"&&ve.noFil!==1)throw new Error("In multiply the variable should be the second parameter");(ve.fire===""||ve.fire==="*")&&(H<1&&(F[1]=0),F[1]+=ve.cte*(ve.oper==="+"?1:-1),H=Math.max(1,H))}else if(me==="ConstantNode"){var _e=parseFloat(Y.value);if(oe===null){F[0]=_e;return}if(oe.op==="^"){if(ve.noFil!==1)throw new Error("Constant cannot be powered");if(!bt(_e)||_e<=0)throw new Error("Non-integer exponent is not allowed");for(var Be=H+1;Be<_e;Be++)F[Be]=0;_e>H&&(F[_e]=0),F[_e]+=ve.cte*(ve.oper==="+"?1:-1),H=Math.max(_e,H);return}ve.cte=_e,ve.fire===""&&(F[0]+=ve.cte*(ve.oper==="+"?1:-1))}else throw new Error("Type "+me+" is not allowed")}}}),vj="zpk2tf",gze=["typed","add","multiply","Complex","number"],vze=ie(vj,gze,n=>{var{typed:e,add:t,multiply:r,Complex:i,number:s}=n;return e(vj,{"Array,Array,number":function(u,c,h){return a(u,c,h)},"Array,Array":function(u,c){return a(u,c,1)},"Matrix,Matrix,number":function(u,c,h){return a(u.valueOf(),c.valueOf(),h)},"Matrix,Matrix":function(u,c){return a(u.valueOf(),c.valueOf(),1)}});function a(l,u,c){l.some(b=>b.type==="BigNumber")&&(l=l.map(b=>s(b))),u.some(b=>b.type==="BigNumber")&&(u=u.map(b=>s(b)));for(var h=[i(1,0)],d=[i(1,0)],f=0;f<l.length;f++){var p=l[f];typeof p=="number"&&(p=i(p,0)),h=o(h,[i(1,0),i(-p.re,-p.im)])}for(var m=0;m<u.length;m++){var y=u[m];typeof y=="number"&&(y=i(y,0)),d=o(d,[i(1,0),i(-y.re,-y.im)])}for(var v=0;v<h.length;v++)h[v]=r(h[v],c);return[h,d]}function o(l,u){for(var c=[],h=0;h<l.length+u.length-1;h++){c[h]=i(0,0);for(var d=0;d<l.length;d++)h-d>=0&&h-d<u.length&&(c[h]=t(c[h],r(l[d],u[h-d])))}return c}}),yj="freqz",yze=["typed","add","multiply","Complex","divide","matrix"],xze=ie(yj,yze,n=>{var{typed:e,add:t,multiply:r,Complex:i,divide:s,matrix:a}=n;return e(yj,{"Array, Array":function(c,h){var d=l(512);return o(c,h,d)},"Array, Array, Array":function(c,h,d){return o(c,h,d)},"Array, Array, number":function(c,h,d){if(d<0)throw new Error("w must be a positive number");var f=l(d);return o(c,h,f)},"Matrix, Matrix":function(c,h){var d=l(512),{w:f,h:p}=o(c.valueOf(),h.valueOf(),d);return{w:a(f),h:a(p)}},"Matrix, Matrix, Matrix":function(c,h,d){var{h:f}=o(c.valueOf(),h.valueOf(),d.valueOf());return{h:a(f),w:a(d)}},"Matrix, Matrix, number":function(c,h,d){if(d<0)throw new Error("w must be a positive number");var f=l(d),{h:p}=o(c.valueOf(),h.valueOf(),f);return{h:a(p),w:a(f)}}});function o(u,c,h){for(var d=[],f=[],p=0;p<h.length;p++){for(var m=i(0,0),y=i(0,0),v=0;v<u.length;v++)m=t(m,r(u[v],i(Math.cos(-v*h[p]),Math.sin(-v*h[p]))));for(var b=0;b<c.length;b++)y=t(y,r(c[b],i(Math.cos(-b*h[p]),Math.sin(-b*h[p]))));d.push(m),f.push(y)}for(var x=[],w=0;w<d.length;w++)x.push(s(d[w],f[w]));return{h:x,w:h}}function l(u){for(var c=[],h=0;h<u;h++)c.push(h/u*Math.PI);return c}}),bze="reviver",_ze=["classes"],wze=ie(bze,_ze,n=>{var{classes:e}=n;return function(r,i){var s=e[i&&i.mathjs];return s&&typeof s.fromJSON=="function"?s.fromJSON(i):i}}),Eze="replacer",Sze=[],Aze=ie(Eze,Sze,()=>function(e,t){return typeof t=="number"&&(!Number.isFinite(t)||isNaN(t))?{mathjs:"number",value:String(t)}:typeof t=="bigint"?{mathjs:"bigint",value:String(t)}:t}),Tze="15.1.0",Mze=ie("true",[],()=>!0),Cze=ie("false",[],()=>!1),Dze=ie("null",[],()=>null),Nze=Go("Infinity",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?new t(1/0):1/0}),Rze=Go("NaN",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?new t(NaN):NaN}),Ize=Go("pi",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?sU(t):wDe}),Pze=Go("tau",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?eFe(t):EDe}),Fze=Go("e",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?Z3e(t):SDe}),Lze=Go("phi",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?J3e(t):ADe}),Oze=Go("LN2",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?new t(2).ln():Math.LN2}),kze=Go("LN10",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?new t(10).ln():Math.LN10}),Bze=Go("LOG2E",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?new t(1).div(new t(2).ln()):Math.LOG2E}),Uze=Go("LOG10E",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?new t(1).div(new t(10).ln()):Math.LOG10E}),Vze=Go("SQRT1_2",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?new t("0.5").sqrt():Math.SQRT1_2}),zze=Go("SQRT2",["config","?BigNumber"],n=>{var{config:e,BigNumber:t}=n;return e.number==="BigNumber"?new t(2).sqrt():Math.SQRT2}),$ze=Go("i",["Complex"],n=>{var{Complex:e}=n;return e.I}),Hze=ie("version",[],()=>Tze);function Go(n,e,t){return ie(n,e,t,{recreateOnConfigChange:!0})}var Gze=zt("speedOfLight","299792458","m s^-1"),jze=zt("gravitationConstant","6.67430e-11","m^3 kg^-1 s^-2"),qze=zt("planckConstant","6.62607015e-34","J s"),Wze=zt("reducedPlanckConstant","1.0545718176461565e-34","J s"),Xze=zt("magneticConstant","1.25663706212e-6","N A^-2"),Kze=zt("electricConstant","8.8541878128e-12","F m^-1"),Yze=zt("vacuumImpedance","376.730313667","ohm"),Qze=zt("coulomb","8.987551792261171e9","N m^2 C^-2"),Zze=zt("coulombConstant","8.987551792261171e9","N m^2 C^-2"),Jze=zt("elementaryCharge","1.602176634e-19","C"),e8e=zt("bohrMagneton","9.2740100783e-24","J T^-1"),t8e=zt("conductanceQuantum","7.748091729863649e-5","S"),n8e=zt("inverseConductanceQuantum","12906.403729652257","ohm"),r8e=zt("magneticFluxQuantum","2.0678338484619295e-15","Wb"),i8e=zt("nuclearMagneton","5.0507837461e-27","J T^-1"),s8e=zt("klitzing","25812.807459304513","ohm"),a8e=zt("bohrRadius","5.29177210903e-11","m"),o8e=zt("classicalElectronRadius","2.8179403262e-15","m"),l8e=zt("electronMass","9.1093837015e-31","kg"),u8e=zt("fermiCoupling","1.1663787e-5","GeV^-2"),c8e=VN("fineStructure",.0072973525693),h8e=zt("hartreeEnergy","4.3597447222071e-18","J"),d8e=zt("protonMass","1.67262192369e-27","kg"),f8e=zt("deuteronMass","3.3435830926e-27","kg"),p8e=zt("neutronMass","1.6749271613e-27","kg"),m8e=zt("quantumOfCirculation","3.6369475516e-4","m^2 s^-1"),g8e=zt("rydberg","10973731.568160","m^-1"),v8e=zt("thomsonCrossSection","6.6524587321e-29","m^2"),y8e=VN("weakMixingAngle",.2229),x8e=VN("efimovFactor",22.7),b8e=zt("atomicMass","1.66053906660e-27","kg"),_8e=zt("avogadro","6.02214076e23","mol^-1"),w8e=zt("boltzmann","1.380649e-23","J K^-1"),E8e=zt("faraday","96485.33212331001","C mol^-1"),S8e=zt("firstRadiation","3.7417718521927573e-16","W m^2"),A8e=zt("loschmidt","2.686780111798444e25","m^-3"),T8e=zt("gasConstant","8.31446261815324","J K^-1 mol^-1"),M8e=zt("molarPlanckConstant","3.990312712893431e-10","J s mol^-1"),C8e=zt("molarVolume","0.022413969545014137","m^3 mol^-1"),D8e=VN("sackurTetrode",-1.16487052358),N8e=zt("secondRadiation","0.014387768775039337","m K"),R8e=zt("stefanBoltzmann","5.67037441918443e-8","W m^-2 K^-4"),I8e=zt("wienDisplacement","2.897771955e-3","m K"),P8e=zt("molarMass","0.99999999965e-3","kg mol^-1"),F8e=zt("molarMassC12","11.9999999958e-3","kg mol^-1"),L8e=zt("gravity","9.80665","m s^-2"),O8e=zt("planckLength","1.616255e-35","m"),k8e=zt("planckMass","2.176435e-8","kg"),B8e=zt("planckTime","5.391245e-44","s"),U8e=zt("planckCharge","1.87554603778e-18","C"),V8e=zt("planckTemperature","1.416785e+32","K");function zt(n,e,t){var r=["config","Unit","BigNumber"];return ie(n,r,i=>{var{config:s,Unit:a,BigNumber:o}=i,l=s.number==="BigNumber"?new o(e):parseFloat(e),u=new a(l,t);return u.fixPrefix=!0,u})}function VN(n,e){var t=["config","BigNumber"];return ie(n,t,r=>{var{config:i,BigNumber:s}=r;return i.number==="BigNumber"?new s(e):e})}function xj(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function z8e(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?xj(Object(t),!0).forEach(function(r){bi(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):xj(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}var $8e="mapSlices",H8e=["typed","isInteger"],G8e=ie($8e,H8e,n=>{var{typed:e,isInteger:t}=n,r=NO({typed:e,isInteger:t});return e("mapSlices",{"...any":function(s){var a=s[1];Tt(a)?s[1]=a-1:jt(a)&&(s[1]=a.minus(1));try{return r.apply(null,s)}catch(o){throw Ra(o)}}})},z8e({isTransformFunction:!0},NO.meta)),j8e="column",q8e=["typed","Index","matrix","range"],W8e=ie(j8e,q8e,n=>{var{typed:e,Index:t,matrix:r,range:i}=n,s=One({typed:e,Index:t,matrix:r,range:i});return e("column",{"...any":function(o){var l=o.length-1,u=o[l];Tt(u)&&(o[l]=u-1);try{return s.apply(null,o)}catch(c){throw Ra(c)}}})},{isTransformFunction:!0});function pU(n,e,t){var r=n.filter(function(l){return is(l)&&!(l.name in e)&&!t.has(l.name)})[0];if(!r)throw new Error('No undefined variable found in inline expression "'+n+'"');var i=r.name,s=new Map,a=new rte(t,s,new Set([i])),o=n.compile();return function(u){return s.set(i,u),o.evaluate(a)}}var X8e="transformCallback",K8e=["typed"],mU=ie(X8e,K8e,n=>{var{typed:e}=n;return function(r,i){return e.isTypedFunction(r)?t(r,i):bj(r,r.length,i)};function t(r,i){var s=Object.fromEntries(Object.entries(r.signatures).map(a=>{var[o,l]=a,u=o.split(",").length;return e.isTypedFunction(l)?[o,t(l,i)]:[o,bj(l,u,i)]}));return typeof r.name=="string"?e(r.name,s):e(s)}});function bj(n,e,t){return e===t?n:e===t+1?function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];var a=i.slice(0,t),o=_j(i[t]);return n(...a,o)}:e>t+1?function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];var a=i.slice(0,t),o=_j(i[t]),l=i.slice(t+1);return n(...a,o,...l)}:n}function _j(n){return n.map(e=>e+1)}var Y8e="filter",Q8e=["typed"],Z8e=ie(Y8e,Q8e,n=>{var{typed:e}=n;function t(i,s,a){var o=kne({typed:e}),l=mU({typed:e});if(i.length===0)return o();var u=i[0];if(i.length===1)return o(u);var c=i.length-1,h=i[c];return u&&(u=r(u,a)),h&&(is(h)||sA(h)?h=r(h,a):h=pU(h,s,a)),o(u,l(h,c))}t.rawArgs=!0;function r(i,s){return i.compile().evaluate(s)}return t},{isTransformFunction:!0}),J8e="forEach",e9e=["typed"],t9e=ie(J8e,e9e,n=>{var{typed:e}=n,t=Bne({typed:e}),r=mU({typed:e});function i(a,o,l){if(a.length===0)return t();var u=a[0];if(a.length===1)return t(u);var c=a.length-1,h=a[c];return u&&(u=s(u,l)),h&&(is(h)||sA(h)?h=s(h,l):h=pU(h,o,l)),t(u,r(h,c))}i.rawArgs=!0;function s(a,o){return a.compile().evaluate(o)}return i},{isTransformFunction:!0}),n9e="index",r9e=["Index","getMatrixDataType"],i9e=ie(n9e,r9e,n=>{var{Index:e,getMatrixDataType:t}=n;return function(){for(var i=[],s=0,a=arguments.length;s<a;s++){var o=arguments[s];if(q4(o))o.start--,o.end-=o.step>0?0:2;else if(o&&o.isSet===!0)o=o.map(function(u){return u-1});else if(Wn(o)||Dt(o))t(o)!=="boolean"&&(o=o.map(function(u){return u-1}));else if(Tt(o)||L1(o))o--;else if(jt(o))o=o.toNumber()-1;else if(typeof o!="string")throw new TypeError("Dimension must be an Array, Matrix, number, bigint, string, or Range");i[s]=o}var l=new e;return e.apply(l,i),l}},{isTransformFunction:!0}),s9e="map",a9e=["typed"],o9e=ie(s9e,a9e,n=>{var{typed:e}=n,t=Une({typed:e}),r=mU({typed:e});function i(s,a,o){if(s.length===0)return t();if(s.length===1)return t(s[0]);var l=s.length-1,u=s.slice(0,l),c=s[l];return u=u.map(d=>h(d,o)),c&&(is(c)||sA(c)?c=h(c,o):c=pU(c,a,o)),t(...u,r(c,l));function h(d,f){return d.compile().evaluate(f)}}return i.rawArgs=!0,i},{isTransformFunction:!0});function l9e(n){return Tt(n)?n-1:jt(n)?n.minus(1):n}function u9e(n){return Tt(n)||jt(n)}function Zp(n){if(n.length===2&&zo(n[0])){n=n.slice();var e=n[1];u9e(e)&&(n[1]=l9e(e))}return n}var c9e="max",h9e=["typed","config","numeric","larger","isNaN"],d9e=ie(c9e,h9e,n=>{var{typed:e,config:t,numeric:r,larger:i,isNaN:s}=n,a=Xne({typed:e,config:t,numeric:r,larger:i,isNaN:s});return e("max",{"...any":function(l){l=Zp(l);try{return a.apply(null,l)}catch(u){throw Ra(u)}}})},{isTransformFunction:!0}),f9e="mean",p9e=["typed","add","divide"],m9e=ie(f9e,p9e,n=>{var{typed:e,add:t,divide:r}=n,i=rre({typed:e,add:t,divide:r});return e("mean",{"...any":function(a){a=Zp(a);try{return i.apply(null,a)}catch(o){throw Ra(o)}}})},{isTransformFunction:!0}),g9e="min",v9e=["typed","config","numeric","smaller","isNaN"],y9e=ie(g9e,v9e,n=>{var{typed:e,config:t,numeric:r,smaller:i,isNaN:s}=n,a=Kne({typed:e,config:t,numeric:r,smaller:i,isNaN:s});return e("min",{"...any":function(l){l=Zp(l);try{return a.apply(null,l)}catch(u){throw Ra(u)}}})},{isTransformFunction:!0}),x9e="range",b9e=["typed","config","?matrix","?bignumber","equal","smaller","smallerEq","larger","largerEq","add","isZero","isPositive"],_9e=ie(x9e,b9e,n=>{var{typed:e,config:t,matrix:r,bignumber:i,equal:s,smaller:a,smallerEq:o,larger:l,largerEq:u,add:c,isZero:h,isPositive:d}=n,f=$ne({typed:e,config:t,matrix:r,bignumber:i,equal:s,smaller:a,smallerEq:o,larger:l,largerEq:u,add:c,isZero:h,isPositive:d});return e("range",{"...any":function(m){var y=m.length-1,v=m[y];return typeof v!="boolean"&&m.push(!0),f.apply(null,m)}})},{isTransformFunction:!0}),w9e="row",E9e=["typed","Index","matrix","range"],S9e=ie(w9e,E9e,n=>{var{typed:e,Index:t,matrix:r,range:i}=n,s=Hne({typed:e,Index:t,matrix:r,range:i});return e("row",{"...any":function(o){var l=o.length-1,u=o[l];Tt(u)&&(o[l]=u-1);try{return s.apply(null,o)}catch(c){throw Ra(c)}}})},{isTransformFunction:!0}),A9e="subset",T9e=["typed","matrix","zeros","add"],M9e=ie(A9e,T9e,n=>{var{typed:e,matrix:t,zeros:r,add:i}=n,s=Gne({typed:e,matrix:t,zeros:r,add:i});return e("subset",{"...any":function(o){try{return s.apply(null,o)}catch(l){throw Ra(l)}}})},{isTransformFunction:!0}),C9e="concat",D9e=["typed","matrix","isInteger"],N9e=ie(C9e,D9e,n=>{var{typed:e,matrix:t,isInteger:r}=n,i=Lne({typed:e,matrix:t,isInteger:r});return e("concat",{"...any":function(a){var o=a.length-1,l=a[o];Tt(l)?a[o]=l-1:jt(l)&&(a[o]=l.minus(1));try{return i.apply(null,a)}catch(u){throw Ra(u)}}})},{isTransformFunction:!0}),wj="diff",R9e=["typed","matrix","subtract","number","bignumber"],I9e=ie(wj,R9e,n=>{var{typed:e,matrix:t,subtract:r,number:i,bignumber:s}=n,a=Vne({typed:e,matrix:t,subtract:r,number:i,bignumber:s});return e(wj,{"...any":function(l){l=Zp(l);try{return a.apply(null,l)}catch(u){throw Ra(u)}}})},{isTransformFunction:!0}),P9e="std",F9e=["typed","map","sqrt","variance"],L9e=ie(P9e,F9e,n=>{var{typed:e,map:t,sqrt:r,variance:i}=n,s=are({typed:e,map:t,sqrt:r,variance:i});return e("std",{"...any":function(o){o=Zp(o);try{return s.apply(null,o)}catch(l){throw Ra(l)}}})},{isTransformFunction:!0}),Ej="sum",O9e=["typed","config","add","numeric"],k9e=ie(Ej,O9e,n=>{var{typed:e,config:t,add:r,numeric:i}=n,s=tre({typed:e,config:t,add:r,numeric:i});return e(Ej,{"...any":function(o){o=Zp(o);try{return s.apply(null,o)}catch(l){throw Ra(l)}}})},{isTransformFunction:!0}),B9e="quantileSeq",U9e=["typed","bignumber","add","subtract","divide","multiply","partitionSelect","compare","isInteger","smaller","smallerEq","larger","mapSlices"],V9e=ie(B9e,U9e,n=>{var{typed:e,bignumber:t,add:r,subtract:i,divide:s,multiply:a,partitionSelect:o,compare:l,isInteger:u,smaller:c,smallerEq:h,larger:d,mapSlices:f}=n,p=sre({typed:e,bignumber:t,add:r,subtract:i,divide:s,multiply:a,partitionSelect:o,compare:l,isInteger:u,smaller:c,smallerEq:h,larger:d,mapSlices:f});return e("quantileSeq",{"Array | Matrix, number | BigNumber":p,"Array | Matrix, number | BigNumber, number":(y,v,b)=>p(y,v,m(b)),"Array | Matrix, number | BigNumber, boolean":p,"Array | Matrix, number | BigNumber, boolean, number":(y,v,b,x)=>p(y,v,b,m(x)),"Array | Matrix, Array | Matrix":p,"Array | Matrix, Array | Matrix, number":(y,v,b)=>p(y,v,m(b)),"Array | Matrix, Array | Matrix, boolean":p,"Array | Matrix, Array | Matrix, boolean, number":(y,v,b,x)=>p(y,v,b,m(x))});function m(y){return Zp([[],y])[1]}},{isTransformFunction:!0}),Sj="cumsum",z9e=["typed","add","unaryPlus"],$9e=ie(Sj,z9e,n=>{var{typed:e,add:t,unaryPlus:r}=n,i=nre({typed:e,add:t,unaryPlus:r});return e(Sj,{"...any":function(a){if(a.length===2&&zo(a[0])){var o=a[1];Tt(o)?a[1]=o-1:jt(o)&&(a[1]=o.minus(1))}try{return i.apply(null,a)}catch(l){throw Ra(l)}}})},{isTransformFunction:!0}),Aj="variance",H9e=["typed","add","subtract","multiply","divide","mapSlices","isNaN"],G9e=ie(Aj,H9e,n=>{var{typed:e,add:t,subtract:r,multiply:i,divide:s,mapSlices:a,isNaN:o}=n,l=ire({typed:e,add:t,subtract:r,multiply:i,divide:s,mapSlices:a,isNaN:o});return e(Aj,{"...any":function(c){c=Zp(c);try{return l.apply(null,c)}catch(h){throw Ra(h)}}})},{isTransformFunction:!0}),Tj="print",j9e=["typed","matrix","zeros","add"],q9e=ie(Tj,j9e,n=>{var{typed:e,matrix:t,zeros:r,add:i}=n,s=qne({typed:e,matrix:t,zeros:r,add:i});return e(Tj,{"string, Object | Array":function(l,u){return s(a(l),u)},"string, Object | Array, number | Object":function(l,u,c){return s(a(l),u,c)}});function a(o){return o.replace(jne,l=>{var u=l.slice(1).split("."),c=u.map(function(h){return!isNaN(h)&&h.length>0?parseInt(h)-1:h});return"$"+c.join(".")})}},{isTransformFunction:!0}),W9e="and",X9e=["typed","matrix","zeros","add","equalScalar","not","concat"],K9e=ie(W9e,X9e,n=>{var{typed:e,matrix:t,equalScalar:r,zeros:i,not:s,concat:a}=n,o=Wne({typed:e,matrix:t,equalScalar:r,zeros:i,not:s,concat:a});function l(u,c,h){var d=u[0].compile().evaluate(h);if(!zo(d)&&!o(d,!0))return!1;var f=u[1].compile().evaluate(h);return o(d,f)}return l.rawArgs=!0,l},{isTransformFunction:!0}),Y9e="or",Q9e=["typed","matrix","equalScalar","DenseMatrix","concat"],Z9e=ie(Y9e,Q9e,n=>{var{typed:e,matrix:t,equalScalar:r,DenseMatrix:i,concat:s}=n,a=Fne({typed:e,matrix:t,equalScalar:r,DenseMatrix:i,concat:s});function o(l,u,c){var h=l[0].compile().evaluate(c);if(!zo(h)&&a(h,!1))return!0;var d=l[1].compile().evaluate(c);return a(h,d)}return o.rawArgs=!0,o},{isTransformFunction:!0}),J9e="nullish",e$e=["typed","matrix","size","flatten","deepEqual"],t$e=ie(J9e,e$e,n=>{var{typed:e,matrix:t,size:r,flatten:i,deepEqual:s}=n,a=Pne({typed:e,matrix:t,size:r,flatten:i,deepEqual:s});function o(l,u,c){var h=l[0].compile().evaluate(c);if(!zo(h)&&h!=null&&h!==void 0)return h;var d=l[1].compile().evaluate(c);return a(h,d)}return o.rawArgs=!0,o},{isTransformFunction:!0}),n$e="bitAnd",r$e=["typed","matrix","zeros","add","equalScalar","not","concat"],i$e=ie(n$e,r$e,n=>{var{typed:e,matrix:t,equalScalar:r,zeros:i,not:s,concat:a}=n,o=Rne({typed:e,matrix:t,equalScalar:r,zeros:i,not:s,concat:a});function l(u,c,h){var d=u[0].compile().evaluate(h);if(!zo(d)){if(isNaN(d))return NaN;if(d===0||d===!1)return 0}var f=u[1].compile().evaluate(h);return o(d,f)}return l.rawArgs=!0,l},{isTransformFunction:!0}),s$e="bitOr",a$e=["typed","matrix","equalScalar","DenseMatrix","concat"],o$e=ie(s$e,a$e,n=>{var{typed:e,matrix:t,equalScalar:r,DenseMatrix:i,concat:s}=n,a=Ine({typed:e,matrix:t,equalScalar:r,DenseMatrix:i,concat:s});function o(l,u,c){var h=l[0].compile().evaluate(c);if(!zo(h)){if(isNaN(h))return NaN;if(h===-1)return-1;if(h===!0)return 1}var d=l[1].compile().evaluate(c);return a(h,d)}return o.rawArgs=!0,o},{isTransformFunction:!0}),Je=LCe({config:Ve}),Qn=VCe({}),Mj=Fze({BigNumber:Je,config:Ve}),l$e=Cze({}),u$e=c8e({BigNumber:Je,config:Ve}),Jp=XCe({}),ure=$ze({Complex:Qn}),c$e=Nze({BigNumber:Je,config:Ve}),h$e=kze({BigNumber:Je,config:Ve}),d$e=Uze({BigNumber:Je,config:Ve}),zN=eDe({}),f$e=Rze({BigNumber:Je,config:Ve}),p$e=Dze({}),m$e=Lze({BigNumber:Je,config:Ve}),g$e=QCe({}),cre=UMe({}),v$e=Vze({BigNumber:Je,config:Ve}),y$e=D8e({BigNumber:Je,config:Ve}),hre=Pze({BigNumber:Je,config:Ve}),x$e=Mze({}),b$e=Hze({}),Qt=gDe({Matrix:zN,config:Ve}),_$e=x8e({BigNumber:Je,config:Ve}),w$e=Oze({BigNumber:Je,config:Ve}),UO=Ize({BigNumber:Je,config:Ve}),dre=Aze({}),E$e=zze({BigNumber:Je,config:Ve}),ge=LMe({BigNumber:Je,Complex:Qn,DenseMatrix:Qt,Fraction:Jp}),S$e=y8e({BigNumber:Je,config:Ve}),Ns=L2e({typed:ge}),A$e=hFe({Complex:Qn,config:Ve,typed:ge}),T$e=mFe({BigNumber:Je,typed:ge}),M$e=xFe({BigNumber:Je,Complex:Qn,config:Ve,typed:ge}),Ui=U2e({typed:ge}),C$e=TRe({typed:ge}),D$e=AFe({BigNumber:Je,Complex:Qn,config:Ve,typed:ge}),N$e=NFe({typed:ge}),fre=PFe({typed:ge}),R$e=kFe({Complex:Qn,config:Ve,typed:ge}),I$e=a2e({typed:ge}),P$e=xRe({typed:ge}),F$e=c2e({typed:ge}),L$e=yDe({typed:ge}),$N=n6e({typed:ge}),mv=g2e({Complex:Qn,typed:ge}),jv=CRe({typed:ge}),gU=UFe({typed:ge}),O$e=HFe({BigNumber:Je,typed:ge}),k$e=WFe({BigNumber:Je,typed:ge}),B$e=tNe({typed:ge}),rn=KDe({config:Ve,typed:ge}),U$e=XIe({typed:ge}),pre=rNe({typed:ge}),V$e=sNe({Complex:Qn,typed:ge}),z$e=kne({typed:ge}),qv=YRe({typed:ge}),$$e=Bne({typed:ge}),uA=sPe({typed:ge}),vU=eIe({typed:ge}),H$e=hPe({format:uA,typed:ge}),yU=NRe({typed:ge}),cA=$De({typed:ge}),Zh=VDe({typed:ge}),Wv=IDe({typed:ge}),G$e=yPe({typed:ge}),j$e=Bze({BigNumber:Je,config:Ve}),q$e=l6e({Complex:Qn,typed:ge}),W$e=UNe({Complex:Qn,config:Ve,typed:ge}),xU=zNe({Complex:Qn,config:Ve,typed:ge}),em=Une({typed:ge}),X$e=tPe({isNaN:Zh,isNumeric:Wv,typed:ge}),ei=GNe({typed:ge}),t2=FRe({typed:ge}),Lc=r2e({typed:ge}),K$e=uPe({format:uA,typed:ge}),Y$e=O6e({config:Ve,typed:ge}),Q$e=qne({typed:ge}),Z$e=B6e({config:Ve,typed:ge}),bU=IRe({typed:ge}),J$e=QFe({BigNumber:Je,typed:ge}),mre=YNe({BigNumber:Je,Fraction:Jp,complex:mv,typed:ge}),HN=tLe({typed:ge}),Vi=EIe({typed:ge}),zi=ZDe({Matrix:zN,equalScalar:rn,typed:ge}),e7e=D2e({typed:ge}),t7e=tRe({typed:ge}),n7e=l2e({typed:ge}),Il=z2e({typed:ge}),r7e=sLe({typed:ge}),i7e=gPe({typed:ge}),GN=qDe({typed:ge}),s7e=fFe({Complex:Qn,config:Ve,typed:ge}),a7e=_Fe({BigNumber:Je,typed:ge}),o7e=EFe({BigNumber:Je,Complex:Qn,config:Ve,typed:ge}),no=f2e({BigNumber:Je,typed:ge}),l7e=i6e({typed:ge}),u7e=zFe({typed:ge}),c7e=KFe({BigNumber:Je,typed:ge}),jN=OLe({addScalar:Ui,conj:jv,multiplyScalar:ei,size:Vi,typed:ge}),h7e=FDe({isNumeric:Wv,typed:ge}),d7e=GDe({isBounded:cA,map:em,typed:ge}),tm=NDe({config:Ve,typed:ge}),Pl=BDe({equalScalar:rn,typed:ge}),Ze=_2e({DenseMatrix:Qt,Matrix:zN,SparseMatrix:zi,typed:ge}),f7e=E2e({isZero:Pl,matrix:Ze,typed:ge}),On=qNe({addScalar:Ui,dot:jN,equalScalar:rn,matrix:Ze,multiplyScalar:ei,typed:ge}),p7e=uIe({BigNumber:Je,config:Ve,matrix:Ze,typed:ge}),m7e=V6e({config:Ve,log2:xU,typed:ge}),g7e=gIe({config:Ve,matrix:Ze}),v7e=JFe({BigNumber:Je,typed:ge}),y7e=rLe({typed:ge}),x7e=oFe({SparseMatrix:zi,typed:ge}),_u=JNe({Complex:Qn,config:Ve,typed:ge}),b7e=AIe({typed:ge}),_7e=lLe({typed:ge}),hA=RIe({matrix:Ze,typed:ge}),gre=sRe({BigNumber:Je,config:Ve,matrix:Ze,typed:ge}),Ss=LIe({BigNumber:Je,config:Ve,matrix:Ze,typed:ge}),w7e=vFe({BigNumber:Je,Complex:Qn,config:Ve,typed:ge}),E7e=MFe({Complex:Qn,config:Ve,typed:ge}),S7e=oPe({format:uA,typed:ge}),A7e=jFe({BigNumber:Je,typed:ge}),_U=PIe({conj:jv,transpose:hA,typed:ge}),vre=qRe({DenseMatrix:Qt,SparseMatrix:zi,matrix:Ze,typed:ge}),sa=d3e({DenseMatrix:Qt,SparseMatrix:zi,equalScalar:rn,matrix:Ze,typed:ge}),dA=x2e({Fraction:Jp,typed:ge}),nm=nIe({BigNumber:Je,DenseMatrix:Qt,SparseMatrix:zi,config:Ve,matrix:Ze,typed:ge}),Sa=bDe({equal:sa,typed:ge}),T7e=iIe({matrix:Ze,multiplyScalar:ei,typed:ge}),Pw=NO({isInteger:Sa,typed:ge}),wU=M2e({flatten:qv,matrix:Ze,size:Vi,typed:ge}),Sl=_Pe({bignumber:no,fraction:dA,number:Lc}),yre=rPe({config:Ve,multiplyScalar:ei,numeric:Sl,typed:ge}),xre=fIe({isInteger:Sa,matrix:Ze,typed:ge}),Zb=MPe({BigNumber:Je,DenseMatrix:Qt,config:Ve,equalScalar:rn,matrix:Ze,typed:ge,zeros:Ss}),Oc=R2e({typed:ge}),M7e=e6e({BigNumber:Je,Fraction:Jp,config:Ve,isInteger:Sa,number:Lc,typed:ge}),bre=H2e({BigNumber:Je,Complex:Qn,Fraction:Jp,config:Ve,isNegative:tm,matrix:Ze,typed:ge,unaryMinus:Oc}),Mn=Lne({isInteger:Sa,matrix:Ze,typed:ge}),C7e=$Re({prod:yre,size:Vi,typed:ge}),fA=D3e({equal:sa,typed:ge}),Ir=EPe({numeric:Sl,typed:ge}),D7e=hRe({concat:Mn,equalScalar:rn,matrix:Ze,multiplyScalar:ei,typed:ge}),_re=Mne({DenseMatrix:Qt,config:Ve,equalScalar:rn,matrix:Ze,round:Zb,typed:ge,zeros:Ss}),N7e=INe({BigNumber:Je,DenseMatrix:Qt,concat:Mn,config:Ve,equalScalar:rn,matrix:Ze,round:Zb,typed:ge,zeros:Ss}),Xv=ODe({config:Ve,typed:ge}),Aa=E3e({DenseMatrix:Qt,SparseMatrix:zi,bignumber:no,concat:Mn,config:Ve,matrix:Ze,typed:ge}),R7e=ONe({concat:Mn,equalScalar:rn,matrix:Ze,typed:ge}),I7e=YPe({DenseMatrix:Qt,concat:Mn,equalScalar:rn,matrix:Ze,typed:ge,zeros:Ss}),wre=VPe({DenseMatrix:Qt,divideScalar:Ir,equalScalar:rn,matrix:Ze,multiplyScalar:ei,subtractScalar:Il,typed:ge}),EU=Xne({config:Ve,isNaN:Zh,larger:Aa,numeric:Sl,typed:ge}),Ere=Dne({DenseMatrix:Qt,concat:Mn,config:Ve,equalScalar:rn,matrix:Ze,round:Zb,typed:ge,zeros:Ss}),P7e=XNe({BigNumber:Je,concat:Mn,equalScalar:rn,matrix:Ze,typed:ge}),F7e=Pne({deepEqual:fA,flatten:qv,matrix:Ze,size:Vi,typed:ge}),L7e=Fne({DenseMatrix:Qt,concat:Mn,equalScalar:rn,matrix:Ze,typed:ge}),SU=jOe({addScalar:Ui,complex:mv,conj:jv,divideScalar:Ir,equal:sa,identity:nm,isZero:Pl,matrix:Ze,multiplyScalar:ei,sign:mre,sqrt:_u,subtractScalar:Il,typed:ge,unaryMinus:Oc,zeros:Ss}),O7e=ZPe({DenseMatrix:Qt,concat:Mn,equalScalar:rn,matrix:Ze,typed:ge,zeros:Ss}),Ta=v3e({DenseMatrix:Qt,SparseMatrix:zi,bignumber:no,concat:Mn,config:Ve,matrix:Ze,typed:ge}),Ur=rRe({DenseMatrix:Qt,concat:Mn,equalScalar:rn,matrix:Ze,subtractScalar:Il,typed:ge,unaryMinus:Oc}),k7e=pPe({concat:Mn,matrix:Ze,typed:ge}),AU=P2e({config:Ve,numeric:Sl,typed:ge}),TU=$Pe({DenseMatrix:Qt,divideScalar:Ir,equalScalar:rn,matrix:Ze,multiplyScalar:ei,subtractScalar:Il,typed:ge}),B7e=BRe({DenseMatrix:Qt,SparseMatrix:zi,concat:Mn,matrix:Ze,typed:ge}),hn=NLe({DenseMatrix:Qt,SparseMatrix:zi,addScalar:Ui,concat:Mn,equalScalar:rn,matrix:Ze,typed:ge}),U7e=LFe({BigNumber:Je,DenseMatrix:Qt,concat:Mn,equalScalar:rn,matrix:Ze,typed:ge}),V7e=Rne({concat:Mn,equalScalar:rn,matrix:Ze,typed:ge}),z7e=Ine({DenseMatrix:Qt,concat:Mn,equalScalar:rn,matrix:Ze,typed:ge}),$7e=SRe({DenseMatrix:Qt,SparseMatrix:zi,concat:Mn,matrix:Ze,typed:ge}),H7e=q6e({addScalar:Ui,combinations:$N,divideScalar:Ir,isInteger:Sa,isNegative:tm,multiplyScalar:ei,typed:ge}),Kv=r3e({BigNumber:Je,DenseMatrix:Qt,Fraction:Jp,concat:Mn,config:Ve,equalScalar:rn,matrix:Ze,typed:ge}),Sre=c3e({concat:Mn,matrix:Ze,typed:ge}),G7e=X6e({addScalar:Ui,combinations:$N,isInteger:Sa,isNegative:tm,isPositive:Xv,larger:Aa,typed:ge}),j7e=GRe({matrix:Ze,multiply:On,subtract:Ur,typed:ge}),Are=fVe({divideScalar:Ir,isZero:Pl,matrix:Ze,multiply:On,subtractScalar:Il,typed:ge,unaryMinus:Oc}),q7e=Vne({matrix:Ze,number:Lc,subtract:Ur,typed:ge}),W7e=kVe({abs:Ns,addScalar:Ui,deepEqual:fA,divideScalar:Ir,multiplyScalar:ei,sqrt:_u,subtractScalar:Il,typed:ge}),pA=BPe({DenseMatrix:Qt,SparseMatrix:zi,concat:Mn,divideScalar:Ir,equalScalar:rn,matrix:Ze,typed:ge}),X7e=m3e({compareText:Sre,isZero:Pl,typed:ge}),Tre=W3e({larger:Aa,smaller:Ta}),K7e=ILe({abs:Ns,addScalar:Ui,divideScalar:Ir,isPositive:Xv,multiplyScalar:ei,smaller:Ta,sqrt:_u,typed:ge}),Mre=z3e({DenseMatrix:Qt,smaller:Ta}),Js=G3e({ImmutableDenseMatrix:Mre,getMatrixDataType:vU}),Y7e=VVe({abs:Ns,add:hn,addScalar:Ui,config:Ve,divideScalar:Ir,equalScalar:rn,flatten:qv,isNumeric:Wv,isZero:Pl,matrix:Ze,multiply:On,multiplyScalar:ei,smaller:Ta,subtract:Ur,typed:ge}),Q7e=oRe({BigNumber:Je,add:hn,config:Ve,equal:sa,isInteger:Sa,mod:Ere,smaller:Ta,typed:ge,xgcd:gre}),qN=T3e({DenseMatrix:Qt,SparseMatrix:zi,concat:Mn,config:Ve,matrix:Ze,typed:ge}),MU=NPe({Complex:Qn,config:Ve,divideScalar:Ir,typeOf:GN,typed:ge}),Z7e=GPe({DenseMatrix:Qt,divideScalar:Ir,equalScalar:rn,matrix:Ze,multiplyScalar:ei,subtractScalar:Il,typed:ge}),J7e=A2e({flatten:qv,matrix:Ze,size:Vi,typed:ge}),eHe=Kne({config:Ve,isNaN:Zh,numeric:Sl,smaller:Ta,typed:ge}),tHe=FPe({Complex:Qn,config:Ve,divideScalar:Ir,typed:ge}),WN=F3e({compare:Kv,isNaN:Zh,isNumeric:Wv,typed:ge}),nHe=e3e({DenseMatrix:Qt,concat:Mn,equalScalar:rn,matrix:Ze,typed:ge,zeros:Ss}),Cre=mke({SparseMatrix:zi,abs:Ns,add:hn,divideScalar:Ir,larger:Aa,largerEq:qN,multiply:On,subtract:Ur,transpose:hA,typed:ge}),Dre=Y3e({FibonacciHeap:Tre,addScalar:Ui,equalScalar:rn}),jo=Gne({add:hn,matrix:Ze,typed:ge,zeros:Ss}),CU=tre({add:hn,config:Ve,numeric:Sl,typed:ge}),rHe=ULe({add:hn,matrix:Ze,typed:ge}),Nre=qPe({DenseMatrix:Qt,divideScalar:Ir,equalScalar:rn,matrix:Ze,multiplyScalar:ei,subtractScalar:Il,typed:ge}),iHe=vze({Complex:Qn,add:hn,multiply:On,number:Lc,typed:ge}),DU=J2e({DenseMatrix:Qt,config:Ve,equalScalar:rn,matrix:Ze,round:Zb,typed:ge,zeros:Ss}),kc=o3e({compare:Kv,typed:ge}),sHe=nre({add:hn,typed:ge,unaryPlus:AU}),Rre=lNe({Complex:Qn,DenseMatrix:Qt,ceil:DU,equalScalar:rn,floor:_re,matrix:Ze,typed:ge,zeros:Ss}),Ire=zLe({Index:Js,typed:ge}),Yv=mVe({abs:Ns,addScalar:Ui,det:Are,divideScalar:Ir,identity:nm,matrix:Ze,multiply:On,typed:ge,unaryMinus:Oc}),aHe=IPe({Complex:Qn,config:Ve,divideScalar:Ir,log:MU,typed:ge}),Pre=HOe({DenseMatrix:Qt,Spa:Dre,SparseMatrix:zi,abs:Ns,addScalar:Ui,divideScalar:Ir,equalScalar:rn,larger:Aa,matrix:Ze,multiplyScalar:ei,subtractScalar:Il,typed:ge,unaryMinus:Oc}),oHe=vVe({Complex:Qn,add:hn,ctranspose:_U,deepEqual:fA,divideScalar:Ir,dot:jN,dotDivide:pA,equal:sa,inv:Yv,matrix:Ze,multiply:On,typed:ge}),wu=APe({Complex:Qn,config:Ve,fraction:dA,identity:nm,inv:Yv,matrix:Ze,multiply:On,number:Lc,typed:ge}),lHe=cLe({DenseMatrix:Qt,Index:Js,compareNatural:kc,size:Vi,subset:jo,typed:ge}),uHe=pLe({DenseMatrix:Qt,Index:Js,compareNatural:kc,size:Vi,subset:jo,typed:ge}),cHe=yLe({Index:Js,compareNatural:kc,size:Vi,subset:jo,typed:ge}),hHe=wLe({Index:Js,compareNatural:kc,size:Vi,subset:jo,typed:ge}),Tb=b3e({DenseMatrix:Qt,SparseMatrix:zi,concat:Mn,config:Ve,matrix:Ze,typed:ge}),dHe=O3e({compare:Kv,compareNatural:kc,matrix:Ze,typed:ge}),fHe=TVe({abs:Ns,add:hn,identity:nm,inv:Yv,map:em,max:EU,multiply:On,size:Vi,sqrt:_u,subtract:Ur,typed:ge}),pHe=R3e({DenseMatrix:Qt,SparseMatrix:zi,concat:Mn,config:Ve,equalScalar:rn,matrix:Ze,typed:ge}),mHe=Wne({concat:Mn,equalScalar:rn,matrix:Ze,not:t2,typed:ge,zeros:Ss}),Fi=LVe({divideScalar:Ir,equalScalar:rn,inv:Yv,matrix:Ze,multiply:On,typed:ge}),gHe=SVe({abs:Ns,add:hn,identity:nm,inv:Yv,multiply:On,typed:ge}),Fre=kIe({addScalar:Ui,ceil:DU,conj:jv,divideScalar:Ir,dotDivide:pA,exp:pre,i:ure,log2:xU,matrix:Ze,multiplyScalar:ei,pow:wu,tau:hre,typed:ge}),vHe=xze({Complex:Qn,add:hn,divide:Fi,matrix:Ze,multiply:On,typed:ge}),NU=a6e({BigNumber:Je,Complex:Qn,config:Ve,multiplyScalar:ei,pow:wu,typed:ge}),yHe=UIe({conj:jv,dotDivide:pA,fft:Fre,typed:ge}),xHe=d6e({divide:Fi,dotDivide:pA,isNumeric:Wv,log:MU,map:em,matrix:Ze,multiply:On,sum:CU,typed:ge}),Lre=vke({DenseMatrix:Qt,lsolve:wre,lup:Pre,matrix:Ze,slu:Cre,typed:ge,usolve:TU}),Ore=rre({add:hn,divide:Fi,typed:ge}),kre=jVe({add:hn,compare:Kv,divide:Fi,partitionSelect:WN,typed:ge}),bHe=xke({add:hn,cbrt:bre,divide:Fi,equalScalar:rn,im:yU,isZero:Pl,multiply:On,re:bU,sqrt:_u,subtract:Ur,typeOf:GN,typed:ge,unaryMinus:Oc}),_He=sre({bignumber:no,add:hn,compare:Kv,divide:Fi,isInteger:Sa,larger:Aa,mapSlices:Pw,multiply:On,partitionSelect:WN,smaller:Ta,smallerEq:Tb,subtract:Ur,typed:ge}),Mb=$ne({bignumber:no,matrix:Ze,add:hn,config:Ve,equal:sa,isPositive:Xv,isZero:Pl,larger:Aa,largerEq:qN,smaller:Ta,smallerEq:Tb,typed:ge}),wHe=Hne({Index:Js,matrix:Ze,range:Mb,typed:ge}),Bre=dLe({DenseMatrix:Qt,Index:Js,compareNatural:kc,size:Vi,subset:jo,typed:ge}),EHe=bLe({Index:Js,compareNatural:kc,size:Vi,subset:jo,typed:ge}),Ure=TLe({Index:Js,concat:Mn,setDifference:Bre,size:Vi,subset:jo,typed:ge}),SHe=jIe({abs:Ns,add:hn,bignumber:no,divide:Fi,isNegative:tm,isPositive:Xv,larger:Aa,map:em,matrix:Ze,max:EU,multiply:On,smaller:Ta,subtract:Ur,typed:ge,unaryMinus:Oc}),It=rFe({BigNumber:Je,Complex:Qn,Fraction:Jp,abs:Ns,addScalar:Ui,config:Ve,divideScalar:Ir,equal:sa,fix:Rre,format:uA,isNumeric:Wv,multiplyScalar:ei,number:Lc,pow:wu,round:Zb,subtractScalar:Il}),AHe=Yze({BigNumber:Je,Unit:It,config:Ve}),THe=b8e({BigNumber:Je,Unit:It,config:Ve}),MHe=e8e({BigNumber:Je,Unit:It,config:Ve}),CHe=w8e({BigNumber:Je,Unit:It,config:Ve}),Vre=One({Index:Js,matrix:Ze,range:Mb,typed:ge}),DHe=t8e({BigNumber:Je,Unit:It,config:Ve}),NHe=Qze({BigNumber:Je,Unit:It,config:Ve}),RHe=uFe({Unit:It,typed:ge}),IHe=f8e({BigNumber:Je,Unit:It,config:Ve}),zre=wVe({abs:Ns,add:hn,addScalar:Ui,atan:fre,bignumber:no,column:Vre,complex:mv,config:Ve,cos:gU,diag:vre,divideScalar:Ir,dot:jN,equal:sa,flatten:qv,im:yU,inv:Yv,larger:Aa,matrix:Ze,matrixFromColumns:wU,multiply:On,multiplyScalar:ei,number:Lc,qr:SU,re:bU,reshape:xre,sin:HN,size:Vi,smaller:Ta,sqrt:_u,subtract:Ur,typed:ge,usolve:TU,usolveAll:Nre}),PHe=l8e({BigNumber:Je,Unit:It,config:Ve}),mA=c6e({gamma:NU,typed:ge}),FHe=u8e({BigNumber:Je,Unit:It,config:Ve}),LHe=T8e({BigNumber:Je,Unit:It,config:Ve}),OHe=L8e({BigNumber:Je,Unit:It,config:Ve}),kHe=s8e({BigNumber:Je,Unit:It,config:Ve}),BHe=A8e({BigNumber:Je,Unit:It,config:Ve}),UHe=WVe({abs:Ns,map:em,median:kre,subtract:Ur,typed:ge}),VHe=r8e({BigNumber:Je,Unit:It,config:Ve}),zHe=P8e({BigNumber:Je,Unit:It,config:Ve}),$He=M8e({BigNumber:Je,Unit:It,config:Ve}),HHe=p6e({add:hn,divide:Fi,factorial:mA,isInteger:Sa,isPositive:Xv,multiply:On,typed:ge}),RU=FLe({abs:Ns,add:hn,conj:jv,ctranspose:_U,eigs:zre,equalScalar:rn,larger:Aa,matrix:Ze,multiply:On,pow:wu,smaller:Ta,sqrt:_u,typed:ge}),GHe=g6e({factorial:mA,typed:ge}),jHe=qze({BigNumber:Je,Unit:It,config:Ve}),qHe=k8e({BigNumber:Je,Unit:It,config:Ve}),WHe=B8e({BigNumber:Je,Unit:It,config:Ve}),XHe=Wze({BigNumber:Je,Unit:It,config:Ve}),$re=bIe({BigNumber:Je,DenseMatrix:Qt,SparseMatrix:zi,addScalar:Ui,config:Ve,cos:gU,matrix:Ze,multiplyScalar:ei,norm:RU,sin:HN,typed:ge,unaryMinus:Oc}),KHe=g8e({BigNumber:Je,Unit:It,config:Ve}),YHe=N8e({BigNumber:Je,Unit:It,config:Ve}),QHe=SLe({compareNatural:kc,typed:ge}),ZHe=Gze({BigNumber:Je,Unit:It,config:Ve}),JHe=R8e({BigNumber:Je,Unit:It,config:Ve}),eGe=v8e({BigNumber:Je,Unit:It,config:Ve}),IU=ire({add:hn,divide:Fi,isNaN:Zh,mapSlices:Pw,multiply:On,subtract:Ur,typed:ge}),tGe=JIe({BigNumber:Je,Complex:Qn,add:hn,config:Ve,divide:Fi,equal:sa,factorial:mA,gamma:NU,isBounded:cA,isNegative:tm,multiply:On,pi:UO,pow:wu,sin:HN,smallerEq:Tb,subtract:Ur,typed:ge}),nGe=_8e({BigNumber:Je,Unit:It,config:Ve}),rGe=a8e({BigNumber:Je,Unit:It,config:Ve}),iGe=ZVe({add:hn,divide:Fi,matrix:Ze,mean:Ore,multiply:On,pow:wu,sqrt:_u,subtract:Ur,sum:CU,typed:ge}),sGe=OPe({DenseMatrix:Qt,SparseMatrix:zi,concat:Mn,equalScalar:rn,matrix:Ze,pow:wu,typed:ge}),aGe=Jze({BigNumber:Je,Unit:It,config:Ve}),oGe=E8e({BigNumber:Je,Unit:It,config:Ve}),lGe=h8e({BigNumber:Je,Unit:It,config:Ve}),uGe=n8e({BigNumber:Je,Unit:It,config:Ve}),cGe=Xze({BigNumber:Je,Unit:It,config:Ve}),hGe=F8e({BigNumber:Je,Unit:It,config:Ve}),dGe=p8e({BigNumber:Je,Unit:It,config:Ve}),fGe=U8e({BigNumber:Je,Unit:It,config:Ve}),pGe=V8e({BigNumber:Je,Unit:It,config:Ve}),mGe=m8e({BigNumber:Je,Unit:It,config:Ve}),Hre=gLe({DenseMatrix:Qt,Index:Js,compareNatural:kc,size:Vi,subset:jo,typed:ge}),gGe=are({map:em,sqrt:_u,typed:ge,variance:IU}),Gre=$6e({bignumber:no,addScalar:Ui,combinations:$N,divideScalar:Ir,factorial:mA,isInteger:Sa,isNegative:tm,larger:Aa,multiplyScalar:ei,number:Lc,pow:wu,subtractScalar:Il,typed:ge}),vGe=sFe({Unit:It,typed:ge}),yGe=G6e({addScalar:Ui,isInteger:Sa,isNegative:tm,stirlingS2:Gre,typed:ge}),xGe=Kze({BigNumber:Je,Unit:It,config:Ve}),bGe=S8e({BigNumber:Je,Unit:It,config:Ve}),_Ge=i8e({BigNumber:Je,Unit:It,config:Ve}),wGe=O8e({BigNumber:Je,Unit:It,config:Ve}),EGe=yIe({multiply:On,rotationMatrix:$re,typed:ge}),SGe=CLe({Index:Js,concat:Mn,setIntersect:Hre,setSymDifference:Ure,size:Vi,subset:jo,typed:ge}),AGe=I8e({BigNumber:Je,Unit:It,config:Ve}),TGe=o8e({BigNumber:Je,Unit:It,config:Ve}),MGe=C8e({BigNumber:Je,Unit:It,config:Ve}),jre=NVe({identity:nm,matrix:Ze,multiply:On,norm:RU,qr:SU,subtract:Ur,typed:ge}),CGe=Zze({BigNumber:Je,Unit:It,config:Ve}),DGe=jze({BigNumber:Je,Unit:It,config:Ve}),NGe=d8e({BigNumber:Je,Unit:It,config:Ve}),qre=CVe({abs:Ns,add:hn,concat:Mn,identity:nm,index:Ire,lusolve:Lre,matrix:Ze,matrixFromColumns:wU,multiply:On,range:Mb,schur:jre,subset:jo,subtract:Ur,transpose:hA,typed:ge}),RGe=IVe({matrix:Ze,multiply:On,sylvester:qre,transpose:hA,typed:ge}),Jb={},gA={},Wre={},aa=GLe({mathWithTransform:gA}),e_=gOe({Node:aa}),Ed=yOe({Node:aa}),Qv=bOe({Node:aa}),Xre=SOe({Node:aa}),t_=XLe({Node:aa}),Kre=eOe({Node:aa,ResultSet:cre}),Yre=nOe({Node:aa}),Qre=wOe({Node:aa}),IGe=wze({classes:Wre}),PU=Ake({math:Jb,typed:ge}),Zre=dOe({Node:aa,typed:ge}),PGe=hVe({Chain:PU,typed:ge}),rm=cOe({Node:aa,isBounded:cA}),n_=pOe({Node:aa,size:Vi}),r_=qLe({Node:aa,subset:jo}),Jre=ZLe({matrix:Ze,Node:aa,subset:jo}),im=MOe({Unit:It,Node:aa,math:Jb}),sm=DOe({Node:aa,SymbolNode:im,math:Jb}),Eu=ROe({AccessorNode:r_,ArrayNode:t_,AssignmentNode:Jre,BlockNode:Kre,ConditionalNode:Yre,ConstantNode:rm,FunctionAssignmentNode:Zre,FunctionNode:sm,IndexNode:n_,ObjectNode:e_,OperatorNode:Ed,ParenthesisNode:Qv,RangeNode:Qre,RelationalNode:Xre,SymbolNode:im,config:Ve,numeric:Sl,typed:ge}),eie=uze({ConstantNode:rm,FunctionNode:sm,OperatorNode:Ed,ParenthesisNode:Qv,parse:Eu,typed:ge}),FU=ize({bignumber:no,fraction:dA,AccessorNode:r_,ArrayNode:t_,ConstantNode:rm,FunctionNode:sm,IndexNode:n_,ObjectNode:e_,OperatorNode:Ed,SymbolNode:im,config:Ve,isBounded:cA,mathWithTransform:gA,matrix:Ze,typed:ge}),FGe=POe({parse:Eu,typed:ge}),LGe=Y6e({parse:Eu,typed:ge}),LU=aze({AccessorNode:r_,ArrayNode:t_,ConstantNode:rm,FunctionNode:sm,IndexNode:n_,ObjectNode:e_,OperatorNode:Ed,ParenthesisNode:Qv,SymbolNode:im,add:hn,divide:Fi,equal:sa,isZero:Pl,multiply:On,parse:Eu,pow:wu,subtract:Ur,typed:ge}),vA=LOe({parse:Eu,typed:ge}),tie=wke({evaluate:vA}),nie=BOe({evaluate:vA,parse:Eu}),OGe=zOe({Parser:nie,typed:ge}),XN=tze({AccessorNode:r_,ArrayNode:t_,ConstantNode:rm,FunctionNode:sm,IndexNode:n_,ObjectNode:e_,OperatorNode:Ed,ParenthesisNode:Qv,SymbolNode:im,equal:sa,parse:Eu,replacer:dre,resolve:eie,simplifyConstant:FU,simplifyCore:LU,typed:ge}),kGe=hze({OperatorNode:Ed,parse:Eu,simplify:XN,typed:ge}),rie=fze({ConstantNode:rm,FunctionNode:sm,OperatorNode:Ed,ParenthesisNode:Qv,SymbolNode:im,config:Ve,equal:sa,isZero:Pl,numeric:Sl,parse:Eu,simplify:XN,typed:ge}),BGe=uVe({Help:tie,mathWithTransform:gA,typed:ge}),UGe=mze({bignumber:no,fraction:dA,AccessorNode:r_,ArrayNode:t_,ConstantNode:rm,FunctionNode:sm,IndexNode:n_,ObjectNode:e_,OperatorNode:Ed,ParenthesisNode:Qv,SymbolNode:im,add:hn,config:Ve,divide:Fi,equal:sa,isZero:Pl,mathWithTransform:gA,matrix:Ze,multiply:On,parse:Eu,pow:wu,simplify:XN,simplifyConstant:FU,simplifyCore:LU,subtract:Ur,typed:ge});ai(Jb,{e:Mj,false:l$e,fineStructure:u$e,i:ure,Infinity:c$e,LN10:h$e,LOG10E:d$e,NaN:f$e,null:p$e,phi:m$e,SQRT1_2:v$e,sackurTetrode:y$e,tau:hre,true:x$e,E:Mj,version:b$e,efimovFactor:_$e,LN2:w$e,pi:UO,replacer:dre,reviver:IGe,SQRT2:E$e,typed:ge,PI:UO,weakMixingAngle:S$e,abs:Ns,acos:A$e,acot:T$e,acsc:M$e,addScalar:Ui,arg:C$e,asech:D$e,asinh:N$e,atan:fre,atanh:R$e,bigint:I$e,bitNot:P$e,boolean:F$e,clone:L$e,combinations:$N,complex:mv,conj:jv,cos:gU,cot:O$e,csc:k$e,cube:B$e,equalScalar:rn,erf:U$e,exp:pre,expm1:V$e,filter:z$e,flatten:qv,forEach:$$e,format:uA,getMatrixDataType:vU,hex:H$e,im:yU,isBounded:cA,isNaN:Zh,isNumeric:Wv,isPrime:G$e,LOG2E:j$e,lgamma:q$e,log10:W$e,log2:xU,map:em,mode:X$e,multiplyScalar:ei,not:t2,number:Lc,oct:K$e,pickRandom:Y$e,print:Q$e,random:Z$e,re:bU,sec:J$e,sign:mre,sin:HN,size:Vi,splitUnit:e7e,square:t7e,string:n7e,subtractScalar:Il,tan:r7e,toBest:i7e,typeOf:GN,acosh:s7e,acsch:a7e,asec:o7e,bignumber:no,chain:PGe,combinationsWithRep:l7e,cosh:u7e,csch:c7e,dot:jN,hasNumericValue:h7e,isFinite:d7e,isNegative:tm,isZero:Pl,matrix:Ze,matrixFromFunction:f7e,multiply:On,ones:p7e,randomInt:m7e,resize:g7e,sech:v7e,sinh:y7e,sparse:x7e,sqrt:_u,squeeze:b7e,tanh:_7e,transpose:hA,xgcd:gre,zeros:Ss,acoth:w7e,asin:E7e,bin:S7e,coth:A7e,ctranspose:_U,diag:vre,equal:sa,fraction:dA,identity:nm,isInteger:Sa,kron:T7e,mapSlices:Pw,matrixFromColumns:wU,numeric:Sl,prod:yre,reshape:xre,round:Zb,unaryMinus:Oc,bernoulli:M7e,cbrt:bre,concat:Mn,count:C7e,deepEqual:fA,divideScalar:Ir,dotMultiply:D7e,floor:_re,gcd:N7e,isPositive:Xv,larger:Aa,lcm:R7e,leftShift:I7e,lsolve:wre,max:EU,mod:Ere,nthRoot:P7e,nullish:F7e,or:L7e,qr:SU,rightArithShift:O7e,smaller:Ta,subtract:Ur,to:k7e,unaryPlus:AU,usolve:TU,xor:B7e,add:hn,atan2:U7e,bitAnd:V7e,bitOr:z7e,bitXor:$7e,catalan:H7e,compare:Kv,compareText:Sre,composition:G7e,cross:j7e,det:Are,diff:q7e,distance:W7e,dotDivide:pA,equalText:X7e,hypot:K7e,intersect:Y7e,invmod:Q7e,largerEq:qN,log:MU,lsolveAll:Z7e,matrixFromRows:J7e,min:eHe,nthRoots:tHe,partitionSelect:WN,rightLogShift:nHe,slu:Cre,subset:jo,sum:CU,trace:rHe,usolveAll:Nre,zpk2tf:iHe,ceil:DU,compareNatural:kc,cumsum:sHe,fix:Rre,index:Ire,inv:Yv,log1p:aHe,lup:Pre,pinv:oHe,pow:wu,setCartesian:lHe,setDistinct:uHe,setIsSubset:cHe,setPowerset:hHe,smallerEq:Tb,sort:dHe,sqrtm:fHe,unequal:pHe,and:mHe,divide:Fi,expm:gHe,fft:Fre,freqz:vHe,gamma:NU,ifft:yHe,kldivergence:xHe,lusolve:Lre,mean:Ore,median:kre,polynomialRoot:bHe,quantileSeq:_He,range:Mb,row:wHe,setDifference:Bre,setMultiplicity:EHe,setSymDifference:Ure,solveODE:SHe,vacuumImpedance:AHe,atomicMass:THe,bohrMagneton:MHe,boltzmann:CHe,column:Vre,conductanceQuantum:DHe,coulomb:NHe,createUnit:RHe,deuteronMass:IHe,eigs:zre,electronMass:PHe,factorial:mA,fermiCoupling:FHe,gasConstant:LHe,gravity:OHe,klitzing:kHe,loschmidt:BHe,mad:UHe,magneticFluxQuantum:VHe,molarMass:zHe,molarPlanckConstant:$He,multinomial:HHe,norm:RU,permutations:GHe,planckConstant:jHe,planckMass:qHe,planckTime:WHe,reducedPlanckConstant:XHe,rotationMatrix:$re,rydberg:KHe,secondRadiation:YHe,setSize:QHe,speedOfLight:ZHe,stefanBoltzmann:JHe,thomsonCrossSection:eGe,variance:IU,zeta:tGe,avogadro:nGe,bohrRadius:rGe,corr:iGe,dotPow:sGe,elementaryCharge:aGe,faraday:oGe,hartreeEnergy:lGe,inverseConductanceQuantum:uGe,magneticConstant:cGe,molarMassC12:hGe,neutronMass:dGe,parse:Eu,planckCharge:fGe,planckTemperature:pGe,quantumOfCirculation:mGe,resolve:eie,setIntersect:Hre,simplifyConstant:FU,std:gGe,stirlingS2:Gre,unit:vGe,bellNumbers:yGe,compile:FGe,electricConstant:xGe,firstRadiation:bGe,leafCount:LGe,nuclearMagneton:_Ge,planckLength:wGe,rotate:EGe,setUnion:SGe,simplifyCore:LU,wienDisplacement:AGe,classicalElectronRadius:TGe,evaluate:vA,molarVolume:MGe,schur:jre,coulombConstant:CGe,gravitationConstant:DGe,parser:OGe,simplify:XN,symbolicEqual:kGe,derivative:rie,protonMass:NGe,sylvester:qre,help:BGe,rationalize:UGe,lyap:RGe,config:Ve});ai(gA,Jb,{map:o9e({typed:ge}),filter:Z8e({typed:ge}),forEach:t9e({typed:ge}),mapSlices:G8e({isInteger:Sa,typed:ge}),and:K9e({add:hn,concat:Mn,equalScalar:rn,matrix:Ze,not:t2,typed:ge,zeros:Ss}),cumsum:$9e({add:hn,typed:ge,unaryPlus:AU}),nullish:t$e({deepEqual:fA,flatten:qv,matrix:Ze,size:Vi,typed:ge}),print:q9e({add:hn,matrix:Ze,typed:ge,zeros:Ss}),bitAnd:i$e({add:hn,concat:Mn,equalScalar:rn,matrix:Ze,not:t2,typed:ge,zeros:Ss}),concat:N9e({isInteger:Sa,matrix:Ze,typed:ge}),diff:I9e({bignumber:no,matrix:Ze,number:Lc,subtract:Ur,typed:ge}),max:d9e({config:Ve,isNaN:Zh,larger:Aa,numeric:Sl,typed:ge}),min:y9e({config:Ve,isNaN:Zh,numeric:Sl,smaller:Ta,typed:ge}),or:Z9e({DenseMatrix:Qt,concat:Mn,equalScalar:rn,matrix:Ze,typed:ge}),subset:M9e({add:hn,matrix:Ze,typed:ge,zeros:Ss}),bitOr:o$e({DenseMatrix:Qt,concat:Mn,equalScalar:rn,matrix:Ze,typed:ge}),sum:k9e({add:hn,config:Ve,numeric:Sl,typed:ge}),variance:G9e({add:hn,divide:Fi,isNaN:Zh,mapSlices:Pw,multiply:On,subtract:Ur,typed:ge}),index:i9e({Index:Js,getMatrixDataType:vU}),quantileSeq:V9e({add:hn,bignumber:no,compare:Kv,divide:Fi,isInteger:Sa,larger:Aa,mapSlices:Pw,multiply:On,partitionSelect:WN,smaller:Ta,smallerEq:Tb,subtract:Ur,typed:ge}),range:_9e({bignumber:no,matrix:Ze,add:hn,config:Ve,equal:sa,isPositive:Xv,isZero:Pl,larger:Aa,largerEq:qN,smaller:Ta,smallerEq:Tb,typed:ge}),column:W8e({Index:Js,matrix:Ze,range:Mb,typed:ge}),row:S9e({Index:Js,matrix:Ze,range:Mb,typed:ge}),mean:m9e({add:hn,divide:Fi,typed:ge}),std:L9e({map:em,sqrt:_u,typed:ge,variance:IU})});ai(Wre,{BigNumber:Je,Complex:Qn,Fraction:Jp,Matrix:zN,Node:aa,ObjectNode:e_,OperatorNode:Ed,ParenthesisNode:Qv,Range:g$e,RelationalNode:Xre,ResultSet:cre,ArrayNode:t_,BlockNode:Kre,ConditionalNode:Yre,DenseMatrix:Qt,RangeNode:Qre,Chain:PU,FunctionAssignmentNode:Zre,SparseMatrix:zi,ConstantNode:rm,IndexNode:n_,FibonacciHeap:Tre,ImmutableDenseMatrix:Mre,Index:Js,Spa:Dre,AccessorNode:r_,AssignmentNode:Jre,Unit:It,SymbolNode:im,FunctionNode:sm,Help:tie,Parser:nie});PU.createProxy(Jb);const VGe=[["7","8","9","/"],["4","5","6","*"],["1","2","3","-"],["0",".","=","+"],["(",")","ANS","DEL"]],zGe=[["sin(","cos(","tan(","asin(","acos("],["log(","ln(","exp(","sqrt(","^"],["pi","e","i","abs(","pow("]],$Ge=[{label:"det 2x2",snippet:"det([[3,-1],[2,5]])"},{label:"dot ",snippet:"dot([1,2,3],[4,5,6])"},{label:"cross ",snippet:"cross([1,0,0],[0,1,0])"},{label:"|z|",snippet:"abs(3 + 4i)"},{label:"exp(-jw t)",snippet:"exp(-i*2*pi*60*t)"},{label:"sqrt(3)",snippet:"sqrt(3)"}],HGe=[{id:"standard",label:" ",description:"  + ",badge:"Standard"},{id:"roots",label:" ",description:"  ",badge:" "},{id:"derivative",label:" ",description:"/ ",badge:""},{id:"integral",label:" ",description:"Simpson Rule",badge:""},{id:"guide",label:" ",description:"  & ",badge:""}],GGe=(n,e)=>n.reduce((t,r)=>hn(On(t,e),r)),Cj=n=>{if(typeof n=="number")return n.toFixed(6).replace(/\.0+$/,"");const e=n.re||0,t=n.im||0,r=Math.abs(e)<1e-9?"0":e.toFixed(6).replace(/\.0+$/,""),i=Math.abs(t)<1e-9?"0":t.toFixed(6).replace(/\.0+$/,"");if(Math.abs(t)<1e-9)return r;const s=t>=0?"+":"-";return`${r} ${s} ${Math.abs(i)}i`},jGe=n=>{const e=n.map(o=>mv(o,0)),t=e[0];if(sa(t,0))throw new Error("  0   .");const r=e.map(o=>Fi(o,t)),i=r.length-1,s=1+Math.max(...r.slice(1).map(o=>Ns(o))),a=Array.from({length:i},(o,l)=>mv({r:s,phi:2*Math.PI*l/i}));for(let o=0;o<80;o++){let l=0;for(let u=0;u<a.length;u++){let c=GGe(r,a[u]),h=mv(1,0);for(let f=0;f<a.length;f++)u!==f&&(h=On(h,Ur(a[u],a[f])));const d=Fi(c,h);a[u]=Ur(a[u],d),l=Math.max(l,Ns(d))}if(l<1e-9)break}return a},qGe=(n,e,t,r,i=600)=>{i%2!==0&&(i+=1);const s={},a=(r-t)/i;let o=0;for(let l=0;l<=i;l++){const u=t+l*a;s[e]=u;const c=vA(n,s);l===0||l===i?o+=c:l%2===0?o+=2*c:o+=4*c}return a/3*o};function WGe(){const{isDark:n}=Nl(),[e,t]=xe.useState(""),[r,i]=xe.useState(""),[s,a]=xe.useState([]),[o,l]=xe.useState("1,-3,2"),[u,c]=xe.useState([]),[h,d]=xe.useState(""),[f,p]=xe.useState("x^3 + 2*x"),[m,y]=xe.useState("x"),[v,b]=xe.useState(""),[x,w]=xe.useState("sin(x)"),[_,E]=xe.useState("x"),[A,T]=xe.useState({from:"0",to:"3.14159"}),[S,M]=xe.useState(""),[D,N]=xe.useState(""),[R,z]=xe.useState("standard"),j=n?"bg-gray-900 border-gray-800 text-white":"bg-white border-gray-200 text-gray-900",I=n?"bg-gray-800 hover:bg-gray-700 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900",F=n?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white",$=O=>{if(O==="DEL"){t(ue=>ue.slice(0,-1));return}if(O==="="){H();return}if(O==="ANS"){s.length>0&&t(ue=>ue+s[s.length-1].result);return}t(ue=>ue+O)},H=()=>{if(e.trim())try{const O=e.replace(//g,"pi").replace(//g,"sqrt");let ue=vA(O);typeof ue=="number"?ue=ue.toPrecision(10).replace(/\.0+$/,""):GN(ue)==="Complex"&&(ue=Cj(ue)),i(String(ue)),a(Q=>[...Q.slice(-9),{expression:e,result:String(ue)}])}catch(O){i(`: ${O.message}`)}},Z=()=>{d("");try{const O=o.split(",").map(Q=>Q.trim()).filter(Q=>Q.length>0).map(Q=>Number(Q));if(O.length<2)throw new Error(" 2  . (: 1,-3,2)");if(O.some(Q=>Number.isNaN(Q)))throw new Error("   .");const ue=jGe(O);c(ue.map(Q=>Cj(Q)))}catch(O){d(O.message),c([])}},J=()=>{try{const O=rie(f,m).toString();b(`d/d${m} = ${O}`)}catch(O){b(` : ${O.message}`)}},ee=()=>{N("");try{const O=Number(A.from),ue=Number(A.to);if(Number.isNaN(O)||Number.isNaN(ue))throw new Error("  .");if(O===ue)throw new Error("  0.");const Q=qGe(x,_,O,ue);M(` ${x} d${_} = ${Number(Q).toPrecision(8)}`)}catch(O){N(O.message),M("")}};return k.jsxs("div",{className:"space-y-10",children:[k.jsxs(ct.div,{initial:{opacity:0,y:-30},animate:{opacity:1,y:0},transition:{duration:.5},children:[k.jsx("h1",{className:"text-4xl sm:text-5xl font-bold mb-4 bg-gradient-to-r from-indigo-500 to-blue-500 dark:from-indigo-300 dark:to-blue-300 bg-clip-text text-transparent",children:"  "}),k.jsx("p",{className:`text-sm sm:text-base ${n?"text-gray-300":"text-gray-600"}`,children:"  ,   , /      ."}),k.jsx("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-4 mt-6",children:[{label:" ",value:"  + "},{label:" ",value:" 10 Durand-Kerner"},{label:"/ ",value:"math.js  + Simpson"},{label:"  ",value:"i, det, dot/cross "}].map(O=>k.jsxs("div",{className:`p-4 rounded-2xl border text-sm ${n?"bg-gray-900/70 border-gray-700 text-gray-200":"bg-white border-gray-200 text-gray-700"}`,children:[k.jsx("p",{className:"font-semibold text-xs uppercase tracking-wide text-blue-500",children:O.label}),k.jsx("p",{className:"mt-2 text-base font-medium",children:O.value})]},O.label))})]}),k.jsx("div",{className:"space-y-6",children:k.jsxs(ct.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5},className:`p-6 rounded-3xl border shadow-sm ${j}`,children:[k.jsx("div",{className:"flex flex-wrap gap-3",children:HGe.map(O=>k.jsxs("button",{onClick:()=>z(O.id),className:`flex-1 min-w-[140px] p-4 rounded-2xl border text-left transition ${R===O.id?n?"bg-blue-900/40 border-blue-500 text-white":"bg-blue-50 border-blue-400 text-blue-900":n?"bg-gray-800 border-gray-700 text-gray-200":"bg-white border-gray-200 text-gray-700"}`,children:[k.jsx("p",{className:"text-xs uppercase tracking-wide text-blue-400",children:O.badge}),k.jsx("p",{className:"text-lg font-semibold mt-1",children:O.label}),k.jsx("p",{className:"text-sm mt-1 opacity-80",children:O.description})]},O.id))}),k.jsxs("div",{className:"mt-8",children:[R==="standard"&&k.jsxs("div",{className:"space-y-6",children:[k.jsxs("div",{className:`relative overflow-hidden rounded-2xl p-6 ${n?"bg-gradient-to-br from-gray-900 via-slate-900 to-gray-800":"bg-gradient-to-br from-white via-blue-50 to-blue-100 border border-blue-100"}`,children:[k.jsx("span",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-blue-300",children:"Expression"}),k.jsx("input",{className:`w-full bg-transparent text-right text-3xl font-semibold mt-3 focus:outline-none ${n?"text-white placeholder:text-gray-500":"text-gray-900 placeholder:text-gray-500"}`,value:e,onChange:O=>t(O.target.value),placeholder:"  (: (3+4i)*(2-i) + sin(pi/3))"}),r&&k.jsxs("p",{className:`text-right text-lg font-mono mt-2 ${r.startsWith("")?"text-red-300":"text-emerald-300"}`,children:["= ",r]}),k.jsx("button",{onClick:H,className:`mt-4 px-4 py-2 rounded-full text-sm font-semibold ${F}`,children:" / ENTER"})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx("p",{className:`text-xs font-semibold tracking-wide ${n?"text-gray-400":"text-gray-500"}`,children:"   "}),k.jsx("div",{className:"flex flex-wrap gap-2",children:$Ge.map(O=>k.jsx("button",{onClick:()=>$(O.snippet),className:`px-3 py-1.5 rounded-full text-xs font-medium border ${n?"border-gray-700 text-gray-200 hover:bg-gray-800":"border-gray-300 text-gray-700 hover:bg-gray-100"}`,children:O.label},O.label))})]}),k.jsxs("div",{className:"grid gap-5 md:grid-cols-2",children:[k.jsxs("div",{className:`p-4 rounded-2xl border ${n?"border-gray-700 bg-gray-900/40":"border-gray-200 bg-white"}`,children:[k.jsxs("div",{className:"flex items-center justify-between mb-3",children:[k.jsx("h3",{className:"text-lg font-semibold",children:" "}),k.jsx("span",{className:"text-xs text-blue-500",children:"   "})]}),k.jsx("div",{className:"grid grid-cols-4 gap-3",children:VGe.map((O,ue)=>k.jsx("div",{className:"contents",children:O.map(Q=>k.jsx("button",{onClick:()=>$(Q==="pi"?"":Q),className:`py-3 rounded-xl font-semibold text-lg transition ${["/","*","-","+","=","ANS"].includes(Q)?F:I}`,children:Q},Q))},`basic-${ue}`))})]}),k.jsxs("div",{className:`p-4 rounded-2xl border ${n?"border-gray-700 bg-gray-900/40":"border-gray-200 bg-white"}`,children:[k.jsxs("div",{className:"flex items-center justify-between mb-3",children:[k.jsx("h3",{className:"text-lg font-semibold",children:" "}),k.jsx("span",{className:"text-xs text-blue-500",children:"    "})]}),k.jsx("div",{className:"grid grid-cols-5 gap-3",children:zGe.map((O,ue)=>k.jsx("div",{className:"contents",children:O.map(Q=>k.jsx("button",{onClick:()=>$(Q==="pi"?"":Q),className:`py-3 rounded-xl font-semibold text-sm transition ${F}`,children:Q},Q))},`sci-${ue}`))}),k.jsx("button",{onClick:H,className:`w-full mt-3 py-3 rounded-xl font-semibold text-lg ${F}`,children:" (=)"})]})]}),k.jsxs("div",{className:`p-5 rounded-2xl border ${n?"border-gray-700 bg-gray-900/40":"border-gray-200 bg-white"}`,children:[k.jsxs("div",{className:"flex items-center justify-between mb-2",children:[k.jsx("p",{className:"font-semibold",children:" 10 "}),k.jsx("button",{onClick:()=>a([]),className:`text-sm ${n?"text-red-300":"text-red-500"}`,children:" "})]}),k.jsxs("div",{className:"max-h-64 overflow-y-auto space-y-2",children:[s.length===0&&k.jsx("p",{className:"text-sm text-gray-500",children:" "}),s.map((O,ue)=>k.jsxs("button",{onClick:()=>{t(O.expression),i(O.result)},className:`w-full text-left p-3 rounded-xl ${n?"bg-gray-800 hover:bg-gray-700":"bg-gray-100 hover:bg-gray-200"}`,children:[k.jsx("p",{className:"text-sm break-words",children:O.expression}),k.jsxs("p",{className:"text-sm font-semibold text-green-500",children:["= ",O.result]})]},`${O.expression}-${ue}`))]})]})]}),R==="roots"&&k.jsxs("div",{children:[k.jsx("h2",{className:"text-xl font-bold mb-4",children:"  "}),k.jsxs("p",{className:`text-sm mb-3 ${n?"text-gray-300":"text-gray-600"}`,children:["   (: x - 3x + 2  ",k.jsx("span",{className:"font-mono",children:"1,-3,2"}),")"]}),k.jsx("input",{value:o,onChange:O=>l(O.target.value),className:`w-full mb-3 px-4 py-2 rounded-xl border ${n?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`}),k.jsx("button",{onClick:Z,className:`w-full py-3 rounded-xl font-semibold ${F}`,children:" "}),h&&k.jsx("p",{className:"text-sm text-red-400 mt-3",children:h}),u.length>0&&k.jsx("ul",{className:"mt-4 space-y-1 text-sm font-mono",children:u.map((O,ue)=>k.jsxs("li",{children:["x",ue+1," = ",O]},ue))})]}),R==="derivative"&&k.jsxs("div",{children:[k.jsx("h2",{className:"text-xl font-bold mb-4",children:" "}),k.jsx("input",{value:f,onChange:O=>p(O.target.value),className:`w-full mb-3 px-4 py-2 rounded-xl border ${n?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"f(x) = "}),k.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-3",children:[k.jsx("label",{className:"text-sm",children:""}),k.jsx("input",{value:m,onChange:O=>y(O.target.value),className:`w-20 text-center px-2 py-2 rounded-xl border ${n?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`}),k.jsxs("button",{onClick:J,className:`flex-1 min-w-[140px] py-2 rounded-xl font-semibold ${F}`,children:["d/d",m]})]}),v&&k.jsx("p",{className:"text-sm font-mono text-green-400",children:v})]}),R==="integral"&&k.jsxs("div",{children:[k.jsx("h2",{className:"text-xl font-bold mb-4",children:" "}),k.jsx("input",{value:x,onChange:O=>w(O.target.value),className:`w-full mb-3 px-4 py-2 rounded-xl border ${n?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"f(x)"}),k.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-3",children:[k.jsx("label",{className:"text-sm",children:""}),k.jsx("input",{value:_,onChange:O=>E(O.target.value),className:`w-24 text-center px-3 py-2 rounded-xl border ${n?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`}),k.jsx("input",{value:A.from,onChange:O=>T(ue=>({...ue,from:O.target.value})),className:`flex-1 min-w-[140px] px-3 py-2 rounded-xl border ${n?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:""}),k.jsx("input",{value:A.to,onChange:O=>T(ue=>({...ue,to:O.target.value})),className:`flex-1 min-w-[140px] px-3 py-2 rounded-xl border ${n?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:""})]}),k.jsx("button",{onClick:ee,className:`w-full py-3 rounded-xl font-semibold ${F}`,children:" "}),D&&k.jsx("p",{className:"text-sm text-red-400 mt-3",children:D}),S&&k.jsx("p",{className:"text-sm font-mono text-green-400 mt-3",children:S})]}),R==="guide"&&k.jsxs("div",{children:[k.jsx("h2",{className:"text-xl font-bold mb-3",children:"  "}),k.jsxs("ul",{className:`text-sm space-y-2 ${n?"text-gray-300":"text-gray-600"}`,children:[k.jsx("li",{children:"   (: (3+4i)*(2-i))"}),k.jsx("li",{children:"   ( 10, Durand-Kerner )"}),k.jsx("li",{children:"   (math.js )"}),k.jsx("li",{children:"   (Simpson rule)"}),k.jsx("li",{children:"    : , e, i, trig/log, pow"})]})]})]})]})})]})}const n2=n=>{const e=n.code||n.message;return{"auth/email-already-in-use":"  .","auth/invalid-email":"   .","auth/weak-password":"  . ( 6)","auth/user-not-found":"  .","auth/wrong-password":" .","auth/too-many-requests":"   .    .","auth/network-request-failed":"  ."}[e]||n.message||"  ."},XGe=async(n,e,t)=>{try{const r=JSON.parse(localStorage.getItem("firebaseUsers")||"{}"),i=btoa(n);if(r[i])throw new Error("  .");await lee(SD,A4);let s=null,a=!1;try{s=(await Promise.race([Fxe(SD,n,e),new Promise((u,c)=>setTimeout(()=>c(new Error("Firebase timeout")),5e3))])).user}catch(l){if(console.warn("Firebase  :",n2(l)),l.code==="auth/email-already-in-use")throw l;a=!0}const o={uid:(s==null?void 0:s.uid)||"local-"+Date.now(),email:n,password:btoa(e),username:t.username,affiliation:t.affiliation||"",bio:"",created_at:new Date().toISOString(),isLocal:a||!s};return r[i]=o,localStorage.setItem("firebaseUsers",JSON.stringify(r)),{uid:o.uid,email:o.email,username:o.username,isLocal:o.isLocal}}catch(r){throw console.error(" :",r),new Error(n2(r))}},KGe=async(n,e)=>{try{await lee(SD,A4);let t=null,r=!1;try{t=(await Promise.race([Lxe(SD,n,e),new Promise((s,a)=>setTimeout(()=>a(new Error("Firebase timeout")),5e3))])).user}catch(i){console.warn("Firebase  ,   :",n2(i));const s=JSON.parse(localStorage.getItem("firebaseUsers")||"{}"),a=btoa(n);if(s[a]){const o=s[a];if(btoa(e)===o.password)r=!0,t={uid:o.uid,email:o.email,displayName:o.username};else throw new Error(" .")}else throw new Error("  .")}if(!t)throw new Error(" ");return{uid:t.uid,email:t.email,username:t.displayName||n.split("@")[0],isLocal:r}}catch(t){throw console.error(" :",t),new Error(n2(t))}},YGe=n=>{localStorage.setItem("currentUser",JSON.stringify(n)),localStorage.setItem("authToken",n.uid)};function QGe(){const n=Fb(),{isDark:e}=Nl(),[t,r]=xe.useState({email:"",password:""}),[i,s]=xe.useState(""),[a,o]=xe.useState(!1),l="auto",u=h=>{const{name:d,value:f}=h.target;r(p=>({...p,[d]:f})),s("")},c=async h=>{h.preventDefault(),o(!0),s("");try{if(!t.email||!t.password){s("  ."),o(!1);return}if(!t.email.includes("@")){s("   ."),o(!1);return}let d=null;if(l==="auto"||l==="firebase")try{d=await KGe(t.email,t.password);const f={uid:d.uid,email:d.email,username:d.username,role:"user",authProvider:d.isLocal?"firebase-local":"firebase"};YGe(f),localStorage.setItem("user",JSON.stringify(f)),localStorage.setItem("authToken",d.uid),localStorage.setItem("isAuthenticated","true"),console.log(`   (${d.isLocal?" ":"Firebase"}):`),window.dispatchEvent(new Event("auth-change")),setTimeout(()=>n("/"),500);return}catch(f){console.warn("Firebase  :",f.message)}s(" :     .")}catch(d){console.error(" :",d),s("   .")}finally{o(!1)}};return k.jsx("div",{className:`min-h-screen flex items-center justify-center px-4 sm:px-6 lg:px-8 transition-colors duration-200 ${e?"bg-gray-900":"bg-gray-50"}`,children:k.jsxs(ct.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6},className:`w-full max-w-md space-y-8 rounded-lg shadow-lg p-8 transition-colors duration-200 ${e?"bg-gray-800":"bg-white"}`,children:[k.jsxs("div",{className:"text-center",children:[k.jsx(ct.h1,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.1},className:`text-3xl font-bold mb-2 transition-colors duration-200 ${e?"text-white":"text-gray-900"}`,children:""}),k.jsx(ct.p,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.2},className:`transition-colors duration-200 ${e?"text-gray-400":"text-gray-600"}`,children:"   "})]}),i&&k.jsx(ct.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:`p-3 rounded-lg text-sm border-l-4 transition-colors duration-200 ${e?"bg-red-900/30 border-red-600 text-red-200":"bg-red-50 border-red-500 text-red-800"}`,children:i}),k.jsxs(ct.form,{onSubmit:c,className:"space-y-6",initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.3},children:[k.jsxs("div",{children:[k.jsx("label",{htmlFor:"email",className:`block text-sm font-medium mb-2 transition-colors duration-200 ${e?"text-gray-300":"text-gray-700"}`,children:""}),k.jsx(ct.input,{whileFocus:{scale:1.02},type:"email",id:"email",name:"email",value:t.email,onChange:u,placeholder:"your@example.com",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 ${e?"bg-gray-700 border-gray-600 text-white placeholder-gray-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-400"}`})]}),k.jsxs("div",{children:[k.jsx("label",{htmlFor:"password",className:`block text-sm font-medium mb-2 transition-colors duration-200 ${e?"text-gray-300":"text-gray-700"}`,children:""}),k.jsx(ct.input,{whileFocus:{scale:1.02},type:"password",id:"password",name:"password",value:t.password,onChange:u,placeholder:"",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 ${e?"bg-gray-700 border-gray-600 text-white placeholder-gray-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-400"}`})]}),k.jsx(ct.button,{type:"submit",disabled:a,whileHover:{scale:1.02},whileTap:{scale:.98},className:`w-full py-2 px-4 rounded-lg font-medium text-white transition-all duration-200 ${a?"bg-blue-400 cursor-not-allowed opacity-50":"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800"}`,children:a?" ...":""})]}),k.jsxs(ct.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.4},className:`text-center text-sm transition-colors duration-200 ${e?"text-gray-400":"text-gray-600"}`,children:[" ?"," ",k.jsx(hr,{to:"/signup",className:"text-blue-600 hover:text-blue-700 font-medium",children:""})]})]})})}function ZGe(){const n=Fb(),{isDark:e}=Nl(),[t,r]=xe.useState({username:"",email:"",password:"",confirmPassword:"",affiliation:"",agreeTerms:!1}),[i,s]=xe.useState({}),[a,o]=xe.useState(!1),[l,u]=xe.useState(""),c="auto",h=p=>{const{name:m,value:y,type:v,checked:b}=p.target;r(x=>({...x,[m]:v==="checkbox"?b:y})),i[m]&&s(x=>({...x,[m]:""}))},d=()=>{const p={};return t.username.trim()?t.username.length<3&&(p.username=" 3  ."):p.username=" .",t.email?t.email.includes("@")||(p.email="   ."):p.email=" .",t.password?t.password.length<8?p.password=" 8  .":/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(t.password)||(p.password=" , ,   ."):p.password=" .",t.password!==t.confirmPassword&&(p.confirmPassword="  ."),t.agreeTerms||(p.agreeTerms=" ."),p},f=async p=>{p.preventDefault();const m=d();if(Object.keys(m).length>0){s(m);return}o(!0),u("");try{let y=!1,v=null;if(c==="auto"||c==="firebase")try{const b=await XGe(t.email,t.password,{username:t.username,affiliation:t.affiliation});console.log("  :",b.username),y=!0}catch(b){console.warn("Firebase  :",b.message),v=b.message}if(!y&&(c==="auto"||c==="local")){const b=JSON.parse(localStorage.getItem("firebaseUsers")||"{}"),x=btoa(t.email);if(b[x]){s({submit:"  ."}),o(!1);return}const w={uid:"local-"+Date.now(),email:t.email,password:btoa(t.password),username:t.username,affiliation:t.affiliation||"",bio:"",created_at:new Date().toISOString(),isLocal:!0};b[x]=w,localStorage.setItem("firebaseUsers",JSON.stringify(b)),console.log("    "),y=!0}y&&(u(" .   ..."),setTimeout(()=>{n("/login")},2e3))}catch(y){console.error(" :",y),s({submit:"   .  ."})}finally{o(!1)}};return k.jsx("div",{className:`min-h-screen flex items-center justify-center px-4 sm:px-6 lg:px-8 transition-colors duration-200 ${e?"bg-gray-900":"bg-gray-50"}`,children:k.jsxs(ct.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6},className:`w-full max-w-md space-y-8 rounded-lg shadow-lg p-8 transition-colors duration-200 ${e?"bg-gray-800":"bg-white"}`,children:[k.jsxs("div",{className:"text-center",children:[k.jsx(ct.h1,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.1},className:`text-3xl font-bold mb-2 transition-colors duration-200 ${e?"text-white":"text-gray-900"}`,children:""}),k.jsx(ct.p,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.2},className:`transition-colors duration-200 ${e?"text-gray-400":"text-gray-600"}`,children:"   "})]}),l&&k.jsx(ct.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg dark:bg-green-900 dark:border-green-700 dark:text-green-200",children:l}),i.submit&&k.jsx(ct.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg dark:bg-red-900 dark:border-red-700 dark:text-red-200",children:i.submit}),k.jsxs(ct.form,{onSubmit:f,className:"space-y-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.3},children:[k.jsxs("div",{children:[k.jsx("label",{htmlFor:"username",className:`block text-sm font-medium mb-2 transition-colors duration-200 ${e?"text-gray-300":"text-gray-700"}`,children:""}),k.jsx(ct.input,{whileFocus:{scale:1.02},type:"text",id:"username",name:"username",value:t.username,onChange:h,placeholder:"  ",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 ${e?"bg-gray-700 border-gray-600 text-white placeholder-gray-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-400"} ${i.username?"border-red-500":""}`}),i.username&&k.jsx("p",{className:"text-red-600 text-sm mt-1 dark:text-red-400",children:i.username})]}),k.jsxs("div",{children:[k.jsx("label",{htmlFor:"email",className:`block text-sm font-medium mb-2 transition-colors duration-200 ${e?"text-gray-300":"text-gray-700"}`,children:""}),k.jsx(ct.input,{whileFocus:{scale:1.02},type:"email",id:"email",name:"email",value:t.email,onChange:h,placeholder:"your@institution.edu",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 ${e?"bg-gray-700 border-gray-600 text-white placeholder-gray-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-400"} ${i.email?"border-red-500":""}`}),i.email&&k.jsx("p",{className:"text-red-600 text-sm mt-1 dark:text-red-400",children:i.email})]}),k.jsxs("div",{children:[k.jsx("label",{htmlFor:"affiliation",className:`block text-sm font-medium mb-2 transition-colors duration-200 ${e?"text-gray-300":"text-gray-700"}`,children:"  ()"}),k.jsx(ct.input,{whileFocus:{scale:1.02},type:"text",id:"affiliation",name:"affiliation",value:t.affiliation,onChange:h,placeholder:",  ",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 ${e?"bg-gray-700 border-gray-600 text-white placeholder-gray-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-400"}`})]}),k.jsxs("div",{children:[k.jsx("label",{htmlFor:"password",className:`block text-sm font-medium mb-2 transition-colors duration-200 ${e?"text-gray-300":"text-gray-700"}`,children:""}),k.jsx(ct.input,{whileFocus:{scale:1.02},type:"password",id:"password",name:"password",value:t.password,onChange:h,placeholder:"",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 ${e?"bg-gray-700 border-gray-600 text-white placeholder-gray-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-400"} ${i.password?"border-red-500":""}`}),k.jsx("p",{className:`text-xs mt-1 transition-colors duration-200 ${e?"text-gray-400":"text-gray-500"}`,children:" 8, // "}),i.password&&k.jsx("p",{className:"text-red-600 text-sm mt-1 dark:text-red-400",children:i.password})]}),k.jsxs("div",{children:[k.jsx("label",{htmlFor:"confirmPassword",className:`block text-sm font-medium mb-2 transition-colors duration-200 ${e?"text-gray-300":"text-gray-700"}`,children:" "}),k.jsx(ct.input,{whileFocus:{scale:1.02},type:"password",id:"confirmPassword",name:"confirmPassword",value:t.confirmPassword,onChange:h,placeholder:"",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 ${e?"bg-gray-700 border-gray-600 text-white placeholder-gray-500":"bg-white border-gray-300 text-gray-900 placeholder-gray-400"} ${i.confirmPassword?"border-red-500":""}`}),i.confirmPassword&&k.jsx("p",{className:"text-red-600 text-sm mt-1 dark:text-red-400",children:i.confirmPassword})]}),k.jsxs("div",{className:"flex items-center",children:[k.jsx("input",{type:"checkbox",id:"agreeTerms",name:"agreeTerms",checked:t.agreeTerms,onChange:h,className:"h-4 w-4 rounded"}),k.jsx("label",{htmlFor:"agreeTerms",className:`ml-3 text-sm transition-colors duration-200 ${e?"text-gray-300":"text-gray-700"}`,children:"   "})]}),i.agreeTerms&&k.jsx("p",{className:"text-red-600 text-sm mt-1 dark:text-red-400",children:i.agreeTerms}),k.jsx(ct.button,{type:"submit",disabled:a,whileHover:{scale:1.02},whileTap:{scale:.98},className:`w-full py-2 px-4 rounded-lg font-medium text-white transition-all duration-200 ${a?"bg-blue-400 cursor-not-allowed opacity-50":"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800"}`,children:a?" ...":""})]}),k.jsxs(ct.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.4},className:`text-center text-sm transition-colors duration-200 ${e?"text-gray-400":"text-gray-600"}`,children:["  ?"," ",k.jsx(hr,{to:"/login",className:"text-blue-600 hover:text-blue-700 font-medium",children:""})]})]})})}const I_=({children:n})=>JP()?n:k.jsx(Loe,{to:"/login",replace:!0});function JGe(){return k.jsx(Koe,{children:k.jsx(joe,{basename:"/1201-project/",children:k.jsxs(Boe,{children:[k.jsx(ls,{path:"/login",element:k.jsx(QGe,{})}),k.jsx(ls,{path:"/signup",element:k.jsx(ZGe,{})}),k.jsxs(ls,{element:k.jsx(nle,{}),children:[k.jsx(ls,{path:"/",element:k.jsx(Ode,{})}),k.jsx(ls,{path:"/concepts",element:k.jsx(kde,{})}),k.jsx(ls,{path:"/concepts/:slug",element:k.jsx(Ude,{})}),k.jsx(ls,{path:"/papers",element:k.jsx(M_e,{})}),k.jsx(ls,{path:"/visualizations",element:k.jsx(XTe,{})}),k.jsx(ls,{path:"/calculator",element:k.jsx(WGe,{})}),k.jsx(ls,{path:"/forum",element:k.jsx(I_,{children:k.jsx(C_e,{})})}),k.jsx(ls,{path:"/forum/:postId",element:k.jsx(I_,{children:k.jsx(D_e,{})})}),k.jsx(ls,{path:"/profile",element:k.jsx(I_,{children:k.jsx(I_e,{})})}),k.jsx(ls,{path:"/bookmarks",element:k.jsx(I_,{children:k.jsx(P_e,{})})}),k.jsx(ls,{path:"/notes",element:k.jsx(I_,{children:k.jsx(F_e,{})})}),k.jsx(ls,{path:"/glossary",element:k.jsx(N_e,{})}),k.jsx(ls,{path:"/references",element:k.jsx(R_e,{})})]})]})})})}rP.createRoot(document.getElementById("root")).render(k.jsx(Vj.StrictMode,{children:k.jsx(JGe,{})}));
